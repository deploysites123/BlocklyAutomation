var iS=Object.defineProperty,nS=Object.defineProperties,oS=Object.getOwnPropertyDescriptors,Xy=Object.getOwnPropertySymbols,rS=Object.prototype.hasOwnProperty,sS=Object.prototype.propertyIsEnumerable,Ky=(B,X,_)=>X in B?iS(B,X,{enumerable:!0,configurable:!0,writable:!0,value:_}):B[X]=_,x_=(B,X)=>{for(var _ in X||(X={}))rS.call(X,_)&&Ky(B,_,X[_]);if(Xy)for(var _ of Xy(X))sS.call(X,_)&&Ky(B,_,X[_]);return B},L_=(B,X)=>nS(B,oS(X));(self.webpackChunkAutoBlocklyApp=self.webpackChunkAutoBlocklyApp||[]).push([[179],{91677:(B,X,_)=>{"use strict";var C=_(22313),m=_(5e3),e=_(93075),t=_(91083),n=_(15861),o=_(47423),r=_(63874),a=_(53251),h=_(69808);const R=["vcr"];function L(N,G){if(1&N&&(m.TgZ(0,"mat-icon",9),m._uU(1),m.qZA()),2&N){const T=m.oxw(2).$implicit;m.xp6(1),m.hij(" filter_",T+1,"")}}function W(N,G){1&N&&(m.TgZ(0,"span"),m._uU(1,"W:{{number+1}"),m.qZA())}function nt(N,G){if(1&N&&(m.YNc(0,L,2,1,"mat-icon",7),m.YNc(1,W,2,0,"span",8)),2&N){const T=m.oxw().$implicit;m.Q6J("ngIf",T<10),m.xp6(1),m.Q6J("ngIf",T>9)}}function et(N,G){}function Et(N,G){1&N&&(m.TgZ(0,"mat-tab",4),m.YNc(1,nt,2,2,"ng-template",5),m.YNc(2,et,0,0,"ng-template",null,6,m.W1O),m.qZA()),2&N&&m.Q6J("label","W:"+(G.$implicit+1))}let It=(()=>{class N{constructor(T,x){this.fooInjector=T,this.resolver=x,this.data=[],this.selectedTabIndex=0,this.numbers=[0]}addTab(){this.numbers.push(this.numbers.length),this.selectedTabIndex=this.numbers.length-1}changeSelected(T){this.data.filter(x=>x==T).length>0||(this.data.push(T),this.loadBar(T).then(x=>{}))}ngAfterViewInit(){this.data.push(0),this.loadBar(0).then(T=>{})}loadBar(T){var x=this;return(0,n.Z)(function*(){var tt;try{const Ke=yield Promise.resolve().then(_.bind(_,57387)),wi=x.resolver.resolveComponentFactory(Ke.DisplayBlocklyComponent);var Nt=null===(tt=x.components)||void 0===tt?void 0:tt.get(T);null!=Nt&&Nt.createComponent(wi)}catch(Ke){console.error("loading"+T,Ke)}return T})()}ngOnInit(){}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(m.zs3),m.Y36(m._Vd))},N.\u0275cmp=m.Xpm({type:N,selectors:[["app-blockly-studio"]],viewQuery:function(T,x){if(1&T&&m.Gf(R,5,m.s_b),2&T){let tt;m.iGM(tt=m.CRH())&&(x.components=tt)}},decls:7,vars:2,consts:[["mat-icon-button","","color","primary",3,"click"],[3,"selectedIndex","selectedIndexChange"],[3,"label",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"click"],[3,"label"],["mat-tab-label",""],["vcr",""],["aria-hidden","false",4,"ngIf"],[4,"ngIf"],["aria-hidden","false"]],template:function(T,x){1&T&&(m.TgZ(0,"button",0),m.NdJ("click",function(){return x.addTab()}),m.TgZ(1,"mat-icon"),m._uU(2,"add_circle"),m.qZA(),m.qZA(),m.TgZ(3,"mat-tab-group",1),m.NdJ("selectedIndexChange",function(Nt){return x.changeSelected(Nt)}),m.YNc(4,Et,4,1,"mat-tab",2),m.qZA(),m.TgZ(5,"button",3),m.NdJ("click",function(){return x.addTab()}),m._uU(6,"Add"),m.qZA()),2&T&&(m.xp6(3),m.Q6J("selectedIndex",x.selectedTabIndex),m.xp6(1),m.Q6J("ngForOf",x.numbers))},directives:[o.lW,r.Hw,a.SP,h.sg,a.uX,a.uD,h.O5],styles:[""]}),N})();var gt=_(57387);const wt=[{path:"",redirectTo:"automation/main",pathMatch:"full"},{path:"automation/main",component:gt.DisplayBlocklyComponent},{path:"automation/studio",component:It},{path:"automation/loadexample/:demoblock",component:gt.DisplayBlocklyComponent},{path:"**",component:gt.DisplayBlocklyComponent}];let Ut=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[t.Bz.forRoot(wt)],t.Bz]}),N})();var Jt=_(95240),Ct=_(95113),bt=_(54004),at=_(77579),ft=_(26063);class lt extends at.x{constructor(G=1/0,T=1/0,x=ft.l){super(),this._bufferSize=G,this._windowTime=T,this._timestampProvider=x,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=T===1/0,this._bufferSize=Math.max(1,G),this._windowTime=Math.max(1,T)}next(G){const{isStopped:T,_buffer:x,_infiniteTimeWindow:tt,_timestampProvider:Nt,_windowTime:Ke}=this;T||(x.push(G),!tt&&x.push(Nt.now()+Ke)),this._trimBuffer(),super.next(G)}_subscribe(G){this._throwIfClosed(),this._trimBuffer();const T=this._innerSubscribe(G),{_infiniteTimeWindow:x,_buffer:tt}=this,Nt=tt.slice();for(let Ke=0;Ke<Nt.length&&!G.closed;Ke+=x?1:2)G.next(Nt[Ke]);return this._checkFinalizedStatuses(G),T}_trimBuffer(){const{_bufferSize:G,_timestampProvider:T,_buffer:x,_infiniteTimeWindow:tt}=this,Nt=(tt?1:2)*G;if(G<1/0&&Nt<x.length&&x.splice(0,x.length-Nt),!tt){const Ke=T.now();let wi=0;for(let qi=1;qi<x.length&&x[qi]<=Ke;qi+=2)wi=qi;wi&&x.splice(0,wi+1)}}}var Ft=_(13099);let yt=(()=>{class N{constructor(){this.title="",this.footer="",this.startBlocks=[],this.tourSteps=[],this.latestVersion="",this.localAPI=""}}return N.version="2021.12.30.1600",N})();var ct=_(20549),rt=_(70925),se=_(30495),xt=_(90508),Lt=_(63191),de=_(91159),_e=_(54968),ce=_(56451),Ae=_(39300),Ne=_(69718),qe=_(82722),Di=_(71884),ei=_(95698),Me=_(68675),ri=_(78372),Bt=_(41777),Ie=_(76360),Xt=_(15664),he=_(50226);const Dt=["*"];function ve(N,G){if(1&N){const T=m.EpF();m.TgZ(0,"div",2),m.NdJ("click",function(){return m.CHM(T),m.oxw()._onBackdropClicked()}),m.qZA()}if(2&N){const T=m.oxw();m.ekj("mat-drawer-shown",T._isShowingBackdrop())}}function je(N,G){1&N&&(m.TgZ(0,"mat-drawer-content"),m.Hsn(1,2),m.qZA())}const gi=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],Ee=["mat-drawer","mat-drawer-content","*"];function ne(N,G){if(1&N){const T=m.EpF();m.TgZ(0,"div",2),m.NdJ("click",function(){return m.CHM(T),m.oxw()._onBackdropClicked()}),m.qZA()}if(2&N){const T=m.oxw();m.ekj("mat-drawer-shown",T._isShowingBackdrop())}}function ee(N,G){1&N&&(m.TgZ(0,"mat-sidenav-content",3),m.Hsn(1,2),m.qZA())}const Oe=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],le=["mat-sidenav","mat-sidenav-content","*"],ye={transformDrawer:(0,Bt.X$)("transform",[(0,Bt.SB)("open, open-instant",(0,Bt.oB)({transform:"none",visibility:"visible"})),(0,Bt.SB)("void",(0,Bt.oB)({"box-shadow":"none",visibility:"hidden"})),(0,Bt.eR)("void => open-instant",(0,Bt.jt)("0ms")),(0,Bt.eR)("void <=> open, open-instant => void",(0,Bt.jt)("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},Zt=new m.OlP("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function $e(){return!1}}),We=new m.OlP("MAT_DRAWER_CONTAINER");let Ti=(()=>{class N extends se.PQ{constructor(T,x,tt,Nt,Ke){super(tt,Nt,Ke),this._changeDetectorRef=T,this._container=x}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(m.sBO),m.Y36((0,m.Gpc)(()=>di)),m.Y36(m.SBq),m.Y36(se.mF),m.Y36(m.R0b))},N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(T,x){2&T&&m.Udp("margin-left",x._container._contentMargins.left,"px")("margin-right",x._container._contentMargins.right,"px")},features:[m.qOj],ngContentSelectors:Dt,decls:1,vars:0,template:function(T,x){1&T&&(m.F$t(),m.Hsn(0))},encapsulation:2,changeDetection:0}),N})(),vi=(()=>{class N{constructor(T,x,tt,Nt,Ke,wi,qi,Fn){this._elementRef=T,this._focusTrapFactory=x,this._focusMonitor=tt,this._platform=Nt,this._ngZone=Ke,this._interactivityChecker=wi,this._doc=qi,this._container=Fn,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new at.x,this._animationEnd=new at.x,this._animationState="void",this.openedChange=new m.vpe(!0),this._openedStream=this.openedChange.pipe((0,Ae.h)(dn=>dn),(0,bt.U)(()=>{})),this.openedStart=this._animationStarted.pipe((0,Ae.h)(dn=>dn.fromState!==dn.toState&&0===dn.toState.indexOf("open")),(0,Ne.h)(void 0)),this._closedStream=this.openedChange.pipe((0,Ae.h)(dn=>!dn),(0,bt.U)(()=>{})),this.closedStart=this._animationStarted.pipe((0,Ae.h)(dn=>dn.fromState!==dn.toState&&"void"===dn.toState),(0,Ne.h)(void 0)),this._destroyed=new at.x,this.onPositionChanged=new m.vpe,this._modeChanged=new at.x,this.openedChange.subscribe(dn=>{dn?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{(0,_e.R)(this._elementRef.nativeElement,"keydown").pipe((0,Ae.h)(dn=>dn.keyCode===de.hY&&!this.disableClose&&!(0,de.Vb)(dn)),(0,qe.R)(this._destroyed)).subscribe(dn=>this._ngZone.run(()=>{this.close(),dn.stopPropagation(),dn.preventDefault()}))}),this._animationEnd.pipe((0,Di.x)((dn,_o)=>dn.fromState===_o.fromState&&dn.toState===_o.toState)).subscribe(dn=>{const{fromState:_o,toState:or}=dn;(0===or.indexOf("open")&&"void"===_o||"void"===or&&0===_o.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(T){(T="end"===T?"end":"start")!=this._position&&(this._position=T,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(T){this._mode=T,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(T){this._disableClose=(0,Lt.Ig)(T)}get autoFocus(){const T=this._autoFocus;return null==T?"side"===this.mode?"dialog":"first-tabbable":T}set autoFocus(T){("true"===T||"false"===T)&&(T=(0,Lt.Ig)(T)),this._autoFocus=T}get opened(){return this._opened}set opened(T){this.toggle((0,Lt.Ig)(T))}_forceFocus(T,x){this._interactivityChecker.isFocusable(T)||(T.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{T.addEventListener("blur",()=>T.removeAttribute("tabindex")),T.addEventListener("mousedown",()=>T.removeAttribute("tabindex"))})),T.focus(x)}_focusByCssSelector(T,x){let tt=this._elementRef.nativeElement.querySelector(T);tt&&this._forceFocus(tt,x)}_takeFocus(){if(!this._focusTrap)return;const T=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(x=>{!x&&"function"==typeof this._elementRef.nativeElement.focus&&T.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(T){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,T):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){var T;const x=null===(T=this._doc)||void 0===T?void 0:T.activeElement;return!!x&&this._elementRef.nativeElement.contains(x)}ngAfterContentInit(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(T){return this.toggle(!0,T)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(T=!this.opened,x){T&&x&&(this._openedVia=x);const tt=this._setOpen(T,!T&&this._isFocusWithinDrawer(),this._openedVia||"program");return T||(this._openedVia=null),tt}_setOpen(T,x,tt){return this._opened=T,T?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",x&&this._restoreFocus(tt)),this._updateFocusTrapState(),new Promise(Nt=>{this.openedChange.pipe((0,ei.q)(1)).subscribe(Ke=>Nt(Ke?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(m.SBq),m.Y36(Xt.qV),m.Y36(Xt.tE),m.Y36(rt.t4),m.Y36(m.R0b),m.Y36(Xt.ic),m.Y36(h.K0,8),m.Y36(We,8))},N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(T,x){1&T&&m.WFA("@transform.start",function(Nt){return x._animationStarted.next(Nt)})("@transform.done",function(Nt){return x._animationEnd.next(Nt)}),2&T&&(m.uIk("align",null),m.d8E("@transform",x._animationState),m.ekj("mat-drawer-end","end"===x.position)("mat-drawer-over","over"===x.mode)("mat-drawer-push","push"===x.mode)("mat-drawer-side","side"===x.mode)("mat-drawer-opened",x.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:Dt,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(T,x){1&T&&(m.F$t(),m.TgZ(0,"div",0),m.Hsn(1),m.qZA())},directives:[se.PQ],encapsulation:2,data:{animation:[ye.transformDrawer]},changeDetection:0}),N})(),di=(()=>{class N{constructor(T,x,tt,Nt,Ke,wi=!1,qi){this._dir=T,this._element=x,this._ngZone=tt,this._changeDetectorRef=Nt,this._animationMode=qi,this._drawers=new m.n_E,this.backdropClick=new m.vpe,this._destroyed=new at.x,this._doCheckSubject=new at.x,this._contentMargins={left:null,right:null},this._contentMarginChanges=new at.x,T&&T.change.pipe((0,qe.R)(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),Ke.change().pipe((0,qe.R)(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=wi}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(T){this._autosize=(0,Lt.Ig)(T)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(T){this._backdropOverride=null==T?null:(0,Lt.Ig)(T)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe((0,Me.O)(this._allDrawers),(0,qe.R)(this._destroyed)).subscribe(T=>{this._drawers.reset(T.filter(x=>!x._container||x._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe((0,Me.O)(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(T=>{this._watchDrawerToggle(T),this._watchDrawerPosition(T),this._watchDrawerMode(T)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe((0,ri.b)(10),(0,qe.R)(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(T=>T.open())}close(){this._drawers.forEach(T=>T.close())}updateContentMargins(){let T=0,x=0;if(this._left&&this._left.opened)if("side"==this._left.mode)T+=this._left._getWidth();else if("push"==this._left.mode){const tt=this._left._getWidth();T+=tt,x-=tt}if(this._right&&this._right.opened)if("side"==this._right.mode)x+=this._right._getWidth();else if("push"==this._right.mode){const tt=this._right._getWidth();x+=tt,T-=tt}T=T||null,x=x||null,(T!==this._contentMargins.left||x!==this._contentMargins.right)&&(this._contentMargins={left:T,right:x},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(T){T._animationStarted.pipe((0,Ae.h)(x=>x.fromState!==x.toState),(0,qe.R)(this._drawers.changes)).subscribe(x=>{"open-instant"!==x.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==T.mode&&T.openedChange.pipe((0,qe.R)(this._drawers.changes)).subscribe(()=>this._setContainerClass(T.opened))}_watchDrawerPosition(T){!T||T.onPositionChanged.pipe((0,qe.R)(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe((0,ei.q)(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(T){T&&T._modeChanged.pipe((0,qe.R)((0,ce.T)(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(T){const x=this._element.nativeElement.classList,tt="mat-drawer-container-has-open";T?x.add(tt):x.remove(tt)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(T=>{"end"==T.position?this._end=T:this._start=T}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(T=>T&&!T.disableClose&&this._canHaveBackdrop(T)).forEach(T=>T._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(T){return"side"!==T.mode||!!this._backdropOverride}_isDrawerOpen(T){return null!=T&&T.opened}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(he.Is,8),m.Y36(m.SBq),m.Y36(m.R0b),m.Y36(m.sBO),m.Y36(se.rL),m.Y36(Zt),m.Y36(Ie.Qb,8))},N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-drawer-container"]],contentQueries:function(T,x,tt){if(1&T&&(m.Suo(tt,Ti,5),m.Suo(tt,vi,5)),2&T){let Nt;m.iGM(Nt=m.CRH())&&(x._content=Nt.first),m.iGM(Nt=m.CRH())&&(x._allDrawers=Nt)}},viewQuery:function(T,x){if(1&T&&m.Gf(Ti,5),2&T){let tt;m.iGM(tt=m.CRH())&&(x._userContent=tt.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(T,x){2&T&&m.ekj("mat-drawer-container-explicit-backdrop",x._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[m._Bn([{provide:We,useExisting:N}])],ngContentSelectors:Ee,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(T,x){1&T&&(m.F$t(gi),m.YNc(0,ve,1,2,"div",0),m.Hsn(1),m.Hsn(2,1),m.YNc(3,je,2,0,"mat-drawer-content",1)),2&T&&(m.Q6J("ngIf",x.hasBackdrop),m.xp6(3),m.Q6J("ngIf",!x._content))},directives:[h.O5,Ti],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),N})(),Gi=(()=>{class N extends Ti{constructor(T,x,tt,Nt,Ke){super(T,x,tt,Nt,Ke)}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(m.sBO),m.Y36((0,m.Gpc)(()=>rn)),m.Y36(m.SBq),m.Y36(se.mF),m.Y36(m.R0b))},N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(T,x){2&T&&m.Udp("margin-left",x._container._contentMargins.left,"px")("margin-right",x._container._contentMargins.right,"px")},features:[m.qOj],ngContentSelectors:Dt,decls:1,vars:0,template:function(T,x){1&T&&(m.F$t(),m.Hsn(0))},encapsulation:2,changeDetection:0}),N})(),Ri=(()=>{class N extends vi{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(T){this._fixedInViewport=(0,Lt.Ig)(T)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(T){this._fixedTopGap=(0,Lt.su)(T)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(T){this._fixedBottomGap=(0,Lt.su)(T)}}return N.\u0275fac=function(){let G;return function(x){return(G||(G=m.n5z(N)))(x||N)}}(),N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(T,x){2&T&&(m.uIk("align",null),m.Udp("top",x.fixedInViewport?x.fixedTopGap:null,"px")("bottom",x.fixedInViewport?x.fixedBottomGap:null,"px"),m.ekj("mat-drawer-end","end"===x.position)("mat-drawer-over","over"===x.mode)("mat-drawer-push","push"===x.mode)("mat-drawer-side","side"===x.mode)("mat-drawer-opened",x.opened)("mat-sidenav-fixed",x.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[m.qOj],ngContentSelectors:Dt,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(T,x){1&T&&(m.F$t(),m.TgZ(0,"div",0),m.Hsn(1),m.qZA())},directives:[se.PQ],encapsulation:2,data:{animation:[ye.transformDrawer]},changeDetection:0}),N})(),rn=(()=>{class N extends di{}return N.\u0275fac=function(){let G;return function(x){return(G||(G=m.n5z(N)))(x||N)}}(),N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-sidenav-container"]],contentQueries:function(T,x,tt){if(1&T&&(m.Suo(tt,Gi,5),m.Suo(tt,Ri,5)),2&T){let Nt;m.iGM(Nt=m.CRH())&&(x._content=Nt.first),m.iGM(Nt=m.CRH())&&(x._allDrawers=Nt)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(T,x){2&T&&m.ekj("mat-drawer-container-explicit-backdrop",x._backdropOverride)},exportAs:["matSidenavContainer"],features:[m._Bn([{provide:We,useExisting:N}]),m.qOj],ngContentSelectors:le,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],["cdkScrollable","",4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"],["cdkScrollable",""]],template:function(T,x){1&T&&(m.F$t(Oe),m.YNc(0,ne,1,2,"div",0),m.Hsn(1),m.Hsn(2,1),m.YNc(3,ee,2,0,"mat-sidenav-content",1)),2&T&&(m.Q6J("ngIf",x.hasBackdrop),m.xp6(3),m.Q6J("ngIf",!x._content))},directives:[h.O5,Gi,se.PQ],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),N})(),ge=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[h.ez,xt.BQ,rt.ud,se.ZD],se.ZD,xt.BQ]}),N})();const De=["*",[["mat-toolbar-row"]]],_i=["*","mat-toolbar-row"],yi=(0,xt.pj)(class{constructor(N){this._elementRef=N}});let Fi=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275dir=m.lG2({type:N,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),N})(),Ni=(()=>{class N extends yi{constructor(T,x,tt){super(T),this._platform=x,this._document=tt}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(m.SBq),m.Y36(rt.t4),m.Y36(h.K0))},N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-toolbar"]],contentQueries:function(T,x,tt){if(1&T&&m.Suo(tt,Fi,5),2&T){let Nt;m.iGM(Nt=m.CRH())&&(x._toolbarRows=Nt)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(T,x){2&T&&m.ekj("mat-toolbar-multiple-rows",x._toolbarRows.length>0)("mat-toolbar-single-row",0===x._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[m.qOj],ngContentSelectors:_i,decls:2,vars:0,template:function(T,x){1&T&&(m.F$t(De),m.Hsn(0),m.Hsn(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}\n"],encapsulation:2,changeDetection:0}),N})(),si=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[xt.BQ],xt.BQ]}),N})(),tn=(()=>{class N{constructor(){this._listeners=[]}notify(T,x){for(let tt of this._listeners)tt(T,x)}listen(T){return this._listeners.push(T),()=>{this._listeners=this._listeners.filter(x=>T!==x)}}ngOnDestroy(){this._listeners=[]}}return N.\u0275fac=function(T){return new(T||N)},N.\u0275prov=m.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})();var no=_(4834);const li=["*"],xe=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],hi=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],Do=(0,xt.Id)((0,xt.Kr)(class{})),Zo=(0,xt.Kr)(class{}),qo=new m.OlP("MatList"),yr=new m.OlP("MatNavList");let xo=(()=>{class N extends Do{constructor(){super(...arguments),this._stateChanges=new at.x}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return N.\u0275fac=function(){let G;return function(x){return(G||(G=m.n5z(N)))(x||N)}}(),N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-nav-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matNavList"],features:[m._Bn([{provide:yr,useExisting:N}]),m.qOj,m.TTD],ngContentSelectors:li,decls:1,vars:0,template:function(T,x){1&T&&(m.F$t(),m.Hsn(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent;text-align:left}[dir=rtl] mat-action-list button{text-align:right}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-selection-list:focus{outline-style:dotted}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-list-option:focus,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:focus,.cdk-high-contrast-active mat-action-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:focus{outline:dotted 1px;z-index:1}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}\n'],encapsulation:2,changeDetection:0}),N})(),Fr=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275dir=m.lG2({type:N,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),N})(),co=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275dir=m.lG2({type:N,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),N})(),Gn=(()=>{class N extends Zo{constructor(T,x,tt,Nt){super(),this._element=T,this._isInteractiveList=!1,this._destroyed=new at.x,this._disabled=!1,this._isInteractiveList=!!(tt||Nt&&"action-list"===Nt._getListType()),this._list=tt||Nt;const Ke=this._getHostElement();"button"===Ke.nodeName.toLowerCase()&&!Ke.hasAttribute("type")&&Ke.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe((0,qe.R)(this._destroyed)).subscribe(()=>{x.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(T){this._disabled=(0,Lt.Ig)(T)}ngAfterContentInit(){(0,xt.E0)(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(m.SBq),m.Y36(m.sBO),m.Y36(yr,8),m.Y36(qo,8))},N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(T,x,tt){if(1&T&&(m.Suo(tt,Fr,5),m.Suo(tt,co,5),m.Suo(tt,xt.X2,5)),2&T){let Nt;m.iGM(Nt=m.CRH())&&(x._avatar=Nt.first),m.iGM(Nt=m.CRH())&&(x._icon=Nt.first),m.iGM(Nt=m.CRH())&&(x._lines=Nt)}},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:6,hostBindings:function(T,x){2&T&&m.ekj("mat-list-item-disabled",x.disabled)("mat-list-item-avatar",x._avatar||x._icon)("mat-list-item-with-avatar",x._avatar||x._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[m.qOj],ngContentSelectors:hi,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(T,x){1&T&&(m.F$t(xe),m.TgZ(0,"div",0),m._UZ(1,"div",1),m.Hsn(2),m.TgZ(3,"div",2),m.Hsn(4,1),m.qZA(),m.Hsn(5,2),m.qZA()),2&T&&(m.xp6(1),m.Q6J("matRippleTrigger",x._getHostElement())("matRippleDisabled",x._isRippleDisabled()))},directives:[xt.wG],encapsulation:2,changeDetection:0}),N})(),Bi=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[xt.uc,xt.si,xt.BQ,xt.us,h.ez],xt.uc,xt.BQ,xt.us,no.t]}),N})();var On=_(50727);const ae=new m.OlP("CdkAccordion");let Mi=0,Yi=(()=>{class N{constructor(T,x,tt){this.accordion=T,this._changeDetectorRef=x,this._expansionDispatcher=tt,this._openCloseAllSubscription=On.w0.EMPTY,this.closed=new m.vpe,this.opened=new m.vpe,this.destroyed=new m.vpe,this.expandedChange=new m.vpe,this.id="cdk-accordion-child-"+Mi++,this._expanded=!1,this._disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=tt.listen((Nt,Ke)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===Ke&&this.id!==Nt&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}get expanded(){return this._expanded}set expanded(T){T=(0,Lt.Ig)(T),this._expanded!==T&&(this._expanded=T,this.expandedChange.emit(T),T?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(T){this._disabled=(0,Lt.Ig)(T)}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(T=>{this.disabled||(this.expanded=T)})}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(ae,12),m.Y36(m.sBO),m.Y36(tn))},N.\u0275dir=m.lG2({type:N,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:"expanded",disabled:"disabled"},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[m._Bn([{provide:ae,useValue:void 0}])]}),N})(),Ki=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({}),N})();var qn=_(47429),ao=_(60515);const lo=["body"];function Rn(N,G){}const Kr=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],_r=["mat-expansion-panel-header","*","mat-action-row"];function rr(N,G){if(1&N&&m._UZ(0,"span",2),2&N){const T=m.oxw();m.Q6J("@indicatorRotate",T._getExpandedState())}}const Or=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],uo=["mat-panel-title","mat-panel-description","*"],Os=new m.OlP("MAT_ACCORDION"),Wr="225ms cubic-bezier(0.4,0.0,0.2,1)",sr={indicatorRotate:(0,Bt.X$)("indicatorRotate",[(0,Bt.SB)("collapsed, void",(0,Bt.oB)({transform:"rotate(0deg)"})),(0,Bt.SB)("expanded",(0,Bt.oB)({transform:"rotate(180deg)"})),(0,Bt.eR)("expanded <=> collapsed, void => collapsed",(0,Bt.jt)(Wr))]),bodyExpansion:(0,Bt.X$)("bodyExpansion",[(0,Bt.SB)("collapsed, void",(0,Bt.oB)({height:"0px",visibility:"hidden"})),(0,Bt.SB)("expanded",(0,Bt.oB)({height:"*",visibility:"visible"})),(0,Bt.eR)("expanded <=> collapsed, void => collapsed",(0,Bt.jt)(Wr))])};let wr=(()=>{class N{constructor(T){this._template=T}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(m.Rgc))},N.\u0275dir=m.lG2({type:N,selectors:[["ng-template","matExpansionPanelContent",""]]}),N})(),Ua=0;const Cr=new m.OlP("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let us=(()=>{class N extends Yi{constructor(T,x,tt,Nt,Ke,wi,qi){super(T,x,tt),this._viewContainerRef=Nt,this._animationMode=wi,this._hideToggle=!1,this.afterExpand=new m.vpe,this.afterCollapse=new m.vpe,this._inputChanges=new at.x,this._headerId="mat-expansion-panel-header-"+Ua++,this._bodyAnimationDone=new at.x,this.accordion=T,this._document=Ke,this._bodyAnimationDone.pipe((0,Di.x)((Fn,dn)=>Fn.fromState===dn.fromState&&Fn.toState===dn.toState)).subscribe(Fn=>{"void"!==Fn.fromState&&("expanded"===Fn.toState?this.afterExpand.emit():"collapsed"===Fn.toState&&this.afterCollapse.emit())}),qi&&(this.hideToggle=qi.hideToggle)}get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(T){this._hideToggle=(0,Lt.Ig)(T)}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(T){this._togglePosition=T}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this.opened.pipe((0,Me.O)(null),(0,Ae.h)(()=>this.expanded&&!this._portal),(0,ei.q)(1)).subscribe(()=>{this._portal=new qn.UE(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(T){this._inputChanges.next(T)}ngOnDestroy(){super.ngOnDestroy(),this._bodyAnimationDone.complete(),this._inputChanges.complete()}_containsFocus(){if(this._body){const T=this._document.activeElement,x=this._body.nativeElement;return T===x||x.contains(T)}return!1}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(Os,12),m.Y36(m.sBO),m.Y36(tn),m.Y36(m.s_b),m.Y36(h.K0),m.Y36(Ie.Qb,8),m.Y36(Cr,8))},N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-expansion-panel"]],contentQueries:function(T,x,tt){if(1&T&&m.Suo(tt,wr,5),2&T){let Nt;m.iGM(Nt=m.CRH())&&(x._lazyContent=Nt.first)}},viewQuery:function(T,x){if(1&T&&m.Gf(lo,5),2&T){let tt;m.iGM(tt=m.CRH())&&(x._body=tt.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(T,x){2&T&&m.ekj("mat-expanded",x.expanded)("_mat-animation-noopable","NoopAnimations"===x._animationMode)("mat-expansion-panel-spacing",x._hasSpacing())},inputs:{disabled:"disabled",expanded:"expanded",hideToggle:"hideToggle",togglePosition:"togglePosition"},outputs:{opened:"opened",closed:"closed",expandedChange:"expandedChange",afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[m._Bn([{provide:Os,useValue:void 0}]),m.qOj,m.TTD],ngContentSelectors:_r,decls:7,vars:4,consts:[["role","region",1,"mat-expansion-panel-content",3,"id"],["body",""],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(T,x){1&T&&(m.F$t(Kr),m.Hsn(0),m.TgZ(1,"div",0,1),m.NdJ("@bodyExpansion.done",function(Nt){return x._bodyAnimationDone.next(Nt)}),m.TgZ(3,"div",2),m.Hsn(4,1),m.YNc(5,Rn,0,0,"ng-template",3),m.qZA(),m.Hsn(6,2),m.qZA()),2&T&&(m.xp6(1),m.Q6J("@bodyExpansion",x._getExpandedState())("id",x.id),m.uIk("aria-labelledby",x._headerId),m.xp6(4),m.Q6J("cdkPortalOutlet",x._portal))},directives:[qn.Pl],styles:[".mat-expansion-panel{box-sizing:content-box;display:block;margin:0;border-radius:4px;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:4px;border-top-left-radius:4px}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px}.mat-action-row button.mat-button-base,.mat-action-row button.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row button.mat-button-base,[dir=rtl] .mat-action-row button.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[sr.bodyExpansion]},changeDetection:0}),N})();class Vo{}const Ma=(0,xt.sb)(Vo);let dl=(()=>{class N extends Ma{constructor(T,x,tt,Nt,Ke,wi,qi){super(),this.panel=T,this._element=x,this._focusMonitor=tt,this._changeDetectorRef=Nt,this._animationMode=wi,this._parentChangeSubscription=On.w0.EMPTY;const Fn=T.accordion?T.accordion._stateChanges.pipe((0,Ae.h)(dn=>!(!dn.hideToggle&&!dn.togglePosition))):ao.E;this.tabIndex=parseInt(qi||"")||0,this._parentChangeSubscription=(0,ce.T)(T.opened,T.closed,Fn,T._inputChanges.pipe((0,Ae.h)(dn=>!!(dn.hideToggle||dn.disabled||dn.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),T.closed.pipe((0,Ae.h)(()=>T._containsFocus())).subscribe(()=>tt.focusVia(x,"program")),Ke&&(this.expandedHeight=Ke.expandedHeight,this.collapsedHeight=Ke.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const T=this._isExpanded();return T&&this.expandedHeight?this.expandedHeight:!T&&this.collapsedHeight?this.collapsedHeight:null}_keydown(T){switch(T.keyCode){case de.L_:case de.K5:(0,de.Vb)(T)||(T.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(T))}}focus(T,x){T?this._focusMonitor.focusVia(this._element,T,x):this._element.nativeElement.focus(x)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(T=>{T&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(us,1),m.Y36(m.SBq),m.Y36(Xt.tE),m.Y36(m.sBO),m.Y36(Cr,8),m.Y36(Ie.Qb,8),m.$8M("tabindex"))},N.\u0275cmp=m.Xpm({type:N,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(T,x){1&T&&m.NdJ("click",function(){return x._toggle()})("keydown",function(Nt){return x._keydown(Nt)}),2&T&&(m.uIk("id",x.panel._headerId)("tabindex",x.tabIndex)("aria-controls",x._getPanelId())("aria-expanded",x._isExpanded())("aria-disabled",x.panel.disabled),m.Udp("height",x._getHeaderHeight()),m.ekj("mat-expanded",x._isExpanded())("mat-expansion-toggle-indicator-after","after"===x._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===x._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===x._animationMode))},inputs:{tabIndex:"tabIndex",expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight"},features:[m.qOj],ngContentSelectors:uo,decls:5,vars:1,consts:[[1,"mat-content"],["class","mat-expansion-indicator",4,"ngIf"],[1,"mat-expansion-indicator"]],template:function(T,x){1&T&&(m.F$t(Or),m.TgZ(0,"span",0),m.Hsn(1),m.Hsn(2,1),m.Hsn(3,2),m.qZA(),m.YNc(4,rr,1,1,"span",1)),2&T&&(m.xp6(4),m.Q6J("ngIf",x._showToggle()))},directives:[h.O5],styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;margin-right:16px}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header-description{flex-grow:2}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle}.cdk-high-contrast-active .mat-expansion-panel .mat-expansion-panel-header.cdk-keyboard-focused:not([aria-disabled=true])::before,.cdk-high-contrast-active .mat-expansion-panel .mat-expansion-panel-header.cdk-program-focused:not([aria-disabled=true])::before,.cdk-high-contrast-active .mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:hover:not([aria-disabled=true])::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;border:3px solid;border-radius:4px;content:""}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}\n'],encapsulation:2,data:{animation:[sr.indicatorRotate]},changeDetection:0}),N})(),ia=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275dir=m.lG2({type:N,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"]}),N})(),Va=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[h.ez,xt.BQ,Ki,qn.eL]]}),N})();var Ys=_(92181);const ol=function(N){return["/","automation","loadexample",N]};function Xs(N,G){if(1&N&&(m.TgZ(0,"a",24),m.TgZ(1,"mat-icon"),m._uU(2," https "),m.qZA(),m._uU(3),m.qZA()),2&N){const T=G.index,x=G.$implicit;m.Q6J("routerLink",m.VKq(3,ol,x.id)),m.xp6(3),m.AsE(" ",T+1," ",x.description,"")}}function ts(N,G){if(1&N){const T=m.EpF();m.TgZ(0,"button",26),m.NdJ("click",function(){return m.CHM(T),m.oxw(),m.MAs(2).toggle()}),m.TgZ(1,"mat-icon",27),m._uU(2,"menu"),m.qZA(),m.qZA()}}function rl(N,G){if(1&N&&(m.TgZ(0,"span",28),m._uU(1),m.qZA()),2&N){const T=m.oxw();m.xp6(1),m.AsE(" ",T.version," => ",T.latestVersion," ")}}const Ga=function(){return["/","automation","studio"]},es=function(){return["/","automation","main"]};let Go=(()=>{class N{constructor(T,x,tt){this.breakpointObserver=T,this.details=x,this.ta=tt,this.demoBlocks=[],this.isHandset$=this.breakpointObserver.observe(Ct.u3.Handset).pipe((0,bt.U)(Nt=>Nt.matches||!0),function Mt(N,G,T){var x,tt;let Nt,Ke=!1;return N&&"object"==typeof N?(Nt=null!==(x=N.bufferSize)&&void 0!==x?x:1/0,G=null!==(tt=N.windowTime)&&void 0!==tt?tt:1/0,Ke=!!N.refCount,T=N.scheduler):Nt=null!=N?N:1/0,(0,Ft.B)({connector:()=>new lt(Nt,G,T),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:Ke})}()),this.version=yt.version,this.latestVersion="",this.title="Blockly Automation",this.footer="",this.standalone=!1}ngOnInit(){var T,x,tt,Nt,Ke;this.latestVersion=null===(T=this.details.settings)||void 0===T?void 0:T.latestVersion,this.demoBlocks=this.details.demoBlocks.sort((wi,qi)=>wi.description.localeCompare(qi.description)),this.title=(null===(tt=null===(x=this.details)||void 0===x?void 0:x.settings)||void 0===tt?void 0:tt.title)||"Blockly Automation",this.footer=(null===(Ke=null===(Nt=this.details)||void 0===Nt?void 0:Nt.settings)||void 0===Ke?void 0:Ke.footer)||"",(navigator.standalone||window.matchMedia("(display-mode: standalone)").matches)&&(this.standalone=!0)}executeOnDisplayBlockly(T){this.ta.sendDataToServer("DisplayBlocklyComponent",T)}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(Ct.Yg),m.Y36(Jt.d),m.Y36(ct.v))},N.\u0275cmp=m.Xpm({type:N,selectors:[["app-primary-navig"]],decls:84,vars:27,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"mode","opened"],["drawer",""],["mat-list-item","","routerLink","/"],["mat-list-item","","href","https://github.com/ignatandrei/BlocklyAutomation","target","_blank"],["mat-list-item","","href","https://ignatandrei.github.io/BlocklyAutomation","target","_blank"],["mat-list-item","","target","_blank",3,"routerLink",4,"ngFor","ngForOf"],["color","primary",1,"nav-bar"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click",4,"ngIf"],[3,"title"],[1,"example-spacer"],["mat-mini-fab","","color","primary",3,"click"],["id","download","mat-button","",3,"matMenuTriggerFor"],["download","matMenu"],["mat-list-item","",4,"ngIf"],["mat-list-item","","href","https://github.com/ignatandrei/BlocklyAutomation/releases/latest/download/releaseBlocklyAutomation.zip/","target","_blank"],["mat-list-item","","href","https://github.com/ignatandrei/BlocklyAutomation/releases/latest/download/releaseLin.zip/","target","_blank"],["mat-list-item","","href","https://github.com/ignatandrei/BlocklyAutomation/releases/latest/download/releaseWin.zip/","target","_blank"],["mat-list-item","","href","https://github.com/ignatandrei/BlocklyAutomation/releases/latest/download/releaseIISWin.zip/","target","_blank"],["mat-list-item","","href","https://github.com/ignatandrei/BlocklyAutomation/releases/latest/download/releaseLocalAPI.zip/","target","_blank"],["mat-list-item","","href","http://ba.serviciipeweb.ro/","target","_blank"],["mat-list-item","","href","https://www.microsoft.com/en-us/p/blocklyautomation/9mxnwjt6zpd0","target","_blank"],["mat-button","",3,"matMenuTriggerFor"],["examples","matMenu"],["mat-list-item","","target","_blank",3,"routerLink"],[1,"main-content"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],["mat-list-item",""]],template:function(T,x){if(1&T&&(m.TgZ(0,"mat-sidenav-container",0),m.TgZ(1,"mat-sidenav",1,2),m.ALo(3,"async"),m.ALo(4,"async"),m.ALo(5,"async"),m.TgZ(6,"mat-toolbar"),m.TgZ(7,"a",3),m._uU(8,"Menu"),m.qZA(),m.qZA(),m.TgZ(9,"mat-nav-list"),m.TgZ(10,"a",4),m.TgZ(11,"mat-icon"),m._uU(12," source "),m.qZA(),m._uU(13," Github"),m.qZA(),m._UZ(14,"mat-divider"),m.TgZ(15,"a",5),m.TgZ(16,"mat-icon"),m._uU(17," https "),m.qZA(),m._uU(18," Demo online"),m.qZA(),m._UZ(19,"mat-divider"),m.TgZ(20,"mat-expansion-panel"),m.TgZ(21,"mat-expansion-panel-header"),m.TgZ(22,"mat-panel-title"),m._uU(23),m.qZA(),m.qZA(),m.YNc(24,Xs,4,5,"a",6),m.qZA(),m.qZA(),m.qZA(),m.TgZ(25,"mat-sidenav-content"),m.TgZ(26,"mat-toolbar",7),m.YNc(27,ts,3,0,"button",8),m.ALo(28,"async"),m.TgZ(29,"span",9),m._uU(30),m.qZA(),m._UZ(31,"span",10),m.TgZ(32,"button",11),m.NdJ("click",function(){return x.executeOnDisplayBlockly("createIntro")}),m.TgZ(33,"mat-icon"),m._uU(34," help_outline "),m.qZA(),m.qZA(),m.TgZ(35,"button",12),m.TgZ(36,"mat-icon"),m._uU(37," file_download "),m.qZA(),m.qZA(),m.TgZ(38,"mat-menu",null,13),m.YNc(40,rl,2,2,"span",14),m.TgZ(41,"a",15),m._uU(42," Download HTML"),m.qZA(),m.TgZ(43,"a",16),m._uU(44," Download Linux"),m.qZA(),m.TgZ(45,"a",17),m._uU(46," Download Windows"),m.qZA(),m.TgZ(47,"a",18),m._uU(48," Download IIS"),m.qZA(),m.TgZ(49,"a",19),m._uU(50," Download LocalAPI"),m.qZA(),m.TgZ(51,"a",20),m._uU(52," Download WPF"),m.qZA(),m.TgZ(53,"a",21),m._uU(54," Store"),m.qZA(),m.qZA(),m.TgZ(55,"button",22),m.TgZ(56,"mat-icon"),m._uU(57," source "),m.qZA(),m.qZA(),m.TgZ(58,"mat-menu",null,23),m.TgZ(60,"a",24),m.TgZ(61,"mat-icon"),m._uU(62," star "),m.qZA(),m._uU(63,"Studio "),m.qZA(),m.TgZ(64,"a",24),m.TgZ(65,"mat-icon"),m._uU(66," star_half "),m.qZA(),m._uU(67,"Single "),m.qZA(),m.TgZ(68,"a",4),m.TgZ(69,"mat-icon"),m._uU(70," source "),m.qZA(),m._uU(71," Github"),m.qZA(),m._UZ(72,"mat-divider"),m.TgZ(73,"a",5),m.TgZ(74,"mat-icon"),m._uU(75," https "),m.qZA(),m._uU(76," Demo online"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(77,"div",25),m._UZ(78,"router-outlet"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(79,"footer"),m.TgZ(80,"small"),m._uU(81),m.qZA(),m.TgZ(82,"small"),m._uU(83),m.qZA(),m.qZA()),2&T){const tt=m.MAs(39),Nt=m.MAs(59);m.xp6(1),m.Q6J("mode",m.lcZ(4,19,x.isHandset$)?"over":"side")("opened",!1===m.lcZ(5,21,x.isHandset$)),m.uIk("role",m.lcZ(3,17,x.isHandset$)?"dialog":"navigation"),m.xp6(22),m.hij(" Demos ",x.demoBlocks.length," "),m.xp6(1),m.Q6J("ngForOf",x.demoBlocks),m.xp6(3),m.Q6J("ngIf",m.lcZ(28,23,x.isHandset$)),m.xp6(2),m.s9C("title",x.version),m.xp6(1),m.Oqu(x.title),m.xp6(5),m.Q6J("matMenuTriggerFor",tt),m.xp6(5),m.Q6J("ngIf",x.version!=x.latestVersion),m.xp6(15),m.Q6J("matMenuTriggerFor",Nt),m.xp6(5),m.Q6J("routerLink",m.DdM(25,Ga)),m.xp6(4),m.Q6J("routerLink",m.DdM(26,es)),m.xp6(17),m.Oqu(x.footer),m.xp6(2),m.lnq("",x.standalone?"standalone":"browser"," ",x.version," -> ",x.latestVersion,"")}},directives:[rn,Ri,Ni,Gn,t.yS,xo,r.Hw,no.d,us,dl,ia,h.sg,Gi,h.O5,o.lW,Ys.p6,Ys.VK,t.lC],pipes:[h.Ov],styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;width:100%}.sidenav-container[_ngcontent-%COMP%]{height:100%}.sidenav[_ngcontent-%COMP%]{width:200px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}.example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.main-content[_ngcontent-%COMP%]{height:97%;width:100%}.nav-bar[_ngcontent-%COMP%]{height:3%;width:100%}"]}),N})(),Bo=(()=>{class N{constructor(T,x){var tt,Nt;this.titleService=T,this.title="AutoBlocklyApp",console.log(null===(tt=x.settings)||void 0===tt?void 0:tt.title),this.titleService.setTitle((null===(Nt=x.settings)||void 0===Nt?void 0:Nt.title)||"")}}return N.\u0275fac=function(T){return new(T||N)(m.Y36(C.Dx),m.Y36(Jt.d))},N.\u0275cmp=m.Xpm({type:N,selectors:[["app-root"]],decls:1,vars:0,template:function(T,x){1&T&&m._UZ(0,"app-primary-navig")},directives:[Go],styles:[""]}),N})();var na=_(40520),Ar=_(91079);let kr=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[Xt.rt,xt.BQ],xt.BQ]}),N})();var tr=_(91314);let hr=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[tr.U8,xt.BQ,qn.eL],xt.BQ]}),N})(),Be=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[xt.BQ,xt.si],xt.BQ]}),N})(),z=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[xt.BQ],xt.BQ]}),N})();var J=_(17144);let oo=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({}),N})(),Ko=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[xt.si,xt.BQ,J.Q8,oo],xt.BQ,oo]}),N})();var dr=_(67322);const ja=new m.OlP("mat-chips-default-options");let Ps=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({providers:[xt.rD,{provide:ja,useValue:{separatorKeyCodes:[de.K5]}}],imports:[[xt.BQ]]}),N})(),sa=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[he.vT]]}),N})(),ot=(()=>{class N{constructor(){this.changes=new at.x,this.optionalLabel="Optional",this.completedLabel="Completed",this.editableLabel="Editable"}}return N.\u0275fac=function(T){return new(T||N)},N.\u0275prov=m.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})();const At={provide:ot,deps:[[new m.FiY,new m.tp0,ot]],useFactory:function q(N){return N||new ot}};let fs=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({providers:[At,xt.rD],imports:[[xt.BQ,h.ez,qn.eL,o.ot,sa,r.Ps,xt.si],xt.BQ]}),N})();var Vs=_(77531);let Ao=(()=>{class N{constructor(){this.changes=new at.x,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year"}formatYearRange(T,x){return`${T} \u2013 ${x}`}}return N.\u0275fac=function(T){return new(T||N)},N.\u0275prov=m.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})();const Iu={provide:new m.OlP("mat-datepicker-scroll-strategy"),deps:[tr.aV],useFactory:function Mr(N){return()=>N.scrollStrategies.reposition()}};let Ic=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({providers:[Ao,Iu],imports:[[h.ez,o.ot,tr.U8,Xt.rt,qn.eL,xt.BQ],se.ZD]}),N})();var uc=_(48966),cr=_(43954);const ms={provide:new m.OlP("mat-select-scroll-strategy"),deps:[tr.aV],useFactory:function Nl(N){return()=>N.scrollStrategies.reposition()}};let ci=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({providers:[ms],imports:[[h.ez,tr.U8,xt.Ng,xt.BQ],se.ZD,dr.lN,xt.Ng,xt.BQ]}),N})();const br={provide:new m.OlP("mat-tooltip-scroll-strategy"),deps:[tr.aV],useFactory:function Ur(N){return()=>N.scrollStrategies.reposition({scrollThrottle:20})}};let ws=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({providers:[br],imports:[[Xt.rt,h.ez,tr.U8,xt.BQ],xt.BQ,se.ZD]}),N})(),Ac=(()=>{class N{constructor(){this.changes=new at.x,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(T,x,tt)=>{if(0==tt||0==x)return`0 of ${tt}`;const Nt=T*x;return`${Nt+1} \u2013 ${Nt<(tt=Math.max(tt,0))?Math.min(Nt+x,tt):Nt+x} of ${tt}`}}}return N.\u0275fac=function(T){return new(T||N)},N.\u0275prov=m.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})();const dc={provide:Ac,deps:[[new m.FiY,new m.tp0,Ac]],useFactory:function Jc(N){return N||new Ac}};let pc=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({providers:[dc],imports:[[h.ez,o.ot,ci,ws,xt.BQ]]}),N})(),ah=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[h.ez,xt.BQ],xt.BQ]}),N})();var Rh=_(20773);let kc=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[xt.si,xt.BQ],xt.BQ]}),N})(),gc=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[h.ez,xt.BQ],xt.BQ]}),N})(),f=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({}),N})(),E=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[f,xt.si,xt.BQ,J.Q8],f,xt.BQ]}),N})();var M=_(57261);let pi=(()=>{class N{constructor(){this.changes=new at.x}}return N.\u0275fac=function(T){return new(T||N)},N.\u0275prov=m.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"}),N})();const xi={provide:pi,deps:[[new m.FiY,new m.tp0,pi]],useFactory:function ui(N){return N||new pi}};let eo=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({providers:[xi],imports:[[h.ez,xt.BQ]]}),N})();_(32076),_(61135),_(68306),_(30576),_(39646);let Xh=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[se.Cl]]}),N})(),Dd=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[Xh,xt.BQ],xt.BQ]}),N})(),Nu=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({}),N})(),Td=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N}),N.\u0275inj=m.cJS({imports:[[Nu,xt.BQ],xt.BQ]}),N})();var hp=_(33);class bd extends t.sz{parse(G){return super.parse(G.toLowerCase())}}let ed=(()=>{class N{}return N.\u0275fac=function(T){return new(T||N)},N.\u0275mod=m.oAB({type:N,bootstrap:[Bo]}),N.\u0275inj=m.cJS({providers:[Jt.d,ct.v,{provide:m.ip1,useFactory:Ed,deps:[Jt.d],multi:!0},{provide:t.Hx,useClass:bd}],imports:[[C.b2,hp.k,Ut,e.u5,e.UX,Ie.PW,gc,o.ot,na.JF,Ar.Bb,kr,hr,o.ot,Be,z,Ko,Ps,fs,Ic,uc.Is,no.t,Va,cr.N6,r.Ps,Vs.c,Bi,Ys.Tx,xt.XK,pc,ah,Rh.Cq,kc,xt.si,ci,ge,gc,E,M.ZX,eo,Dd,a.Nh,si,ws,Td,si,o.ot,ge,r.Ps,Bi]]}),N})();function Ed(N){return()=>N.Init()}(0,m.G48)(),C.q6().bootstrapModule(ed).catch(N=>console.error(N))},51707:(B,X,_)=>{"use strict";_.d(X,{L:()=>e});var C=_(15861),m=_(68699);class e{constructor(n){this.swaggerUrl=n,this.GenerateBlocks=[],this.GenerateFunctions=[],this.fieldXMLObjects=[],this.fieldXMLFunctions=[],this.hasError=!0,this.paths=[],this.name="",this.operations=[],this.basePath="",this.tagsSwagger=[],this.openApiDocument=null,this.cacheCategSwaggerFromPaths=[]}ParseSwagger(){var n=this;return(0,C.Z)(function*(){var o,r=n;r.fieldXMLObjects.push(`<label text="${r.swaggerUrl}"></label>`),r.fieldXMLFunctions.push({id:"",gui:`<label text="${r.swaggerUrl}"></label>`,methodAPI:null});var a=null;try{var h=yield _(10695).default(n.swaggerUrl);a=h.spec}catch(W){return console.error(`parseSwagger ${n.swaggerUrl}`,W),r.fieldXMLObjects.push("<label text='Error parsing!'></label>"),n}n.hasError=!1,n.basePath=a.basePath||"",0==n.basePath.length&&a.servers&&a.servers.length>0&&(n.basePath=a.servers[0].url);var R=null===(o=a.components)||void 0===o?void 0:o.schemas;return(null==R||null==R)&&(R=a.definitions),R?Object.keys(R).sort().forEach(function(W){var nt=R[W],et=r.findProperties(nt),Et=`<block type="${W}">`;et.forEach(function(It){if(It.value&&It.value.type){var gt=r.GenerateShadowField(It.value.type,It.key,null);gt.length>0&&(Et+=`<value name="val_${It.key}">${gt}</value>`)}}),r.fieldXMLObjects.push(Et+="</block>"),r.GenerateBlocks.push(r.GenerateBlock(nt,W))}):console.log("_A",a),a.paths&&Object.keys(a.paths).forEach(function(W){var nt=a.paths[W];r.paths.push({id:W,nrOps:Object.keys(nt).length}),Object.keys(nt).forEach(function(et){r.GenerateFunctions.push(r.GenerateFunction(nt,W,nt[et],et))})}),r.openApiDocument=a,r})()}categSwagger(){var n=this.findHostNameRegular();(n=n.split(".").join("")).length>5&&n.substring(0,5);var a=this.nameCategSwagger();return'<category name="Objects" custom="objects_'+a+'"></category><category name="AllApi" custom="AllApi_'+a+'"></category>'}GenerateBlock(n,o){var r=this,a=o,R=r.findProperties(n);return function(L,W,nt){m.getMainWorkspace()||(console.log("fix for #38 set mainWorkspace"),m.mainWorkspace=nt,console.log("fix for #38  after focus",m.getMainWorkspace())),L[a]={init:function(){var et=!1,Et=[];n.enum&&(et=!0,Et=Object.keys(n.enum).map(n["x-enumNames"]?wt=>[n["x-enumNames"][wt],wt]:wt=>[n.enum[wt],wt]));var gt=this.appendDummyInput().appendField(o);et?(Et=Et.map(wt=>{var Ut,Jt;return[null===(Ut=wt[0])||void 0===Ut?void 0:Ut.toString(),null===(Jt=wt[1])||void 0===Jt?void 0:Jt.toString()]}),gt.appendField(new m.FieldDropdown(Et),`val_${o}`)):R.forEach(wt=>{var Ut,Jt=wt.key;if(wt.value.nullable&&0==wt.value.nullable&&(Jt+="*"),null===(Ut=wt.value)||void 0===Ut?void 0:Ut.type){var Ct=wt.value.type||"";if("object"==Ct){var bt=wt.value.$$ref||"";bt.length>0&&(Ct=bt.substring(bt.lastIndexOf("/")+1))}Jt+=":"+Ct}wt.value.$ref&&(Jt+="->"+wt.value.$ref.replaceAll("#/components/schemas/","")),this.appendValueInput(`val_${wt.key}`).appendField(`${Jt}`)}),this.setOutput(!0,a)}},W[a]=function(et){{var Et=!1;n.enum&&(Et=!0);var It=r.findProperties(n);const Jt=99,Ct=0;var wt="",gt=[];return It.forEach(bt=>{let at=W.valueToCode(et,`val_${bt.key}`,Ct);""===at&&(at="null"),null==at&&(at="null"),gt.push(`"${bt.key}":${at}`)}),wt="{ "+gt.join(",")+" }",Et&&(wt=et.getFieldValue(`val_${o}`)),[wt,Jt]}}}}findRootSite(){var n,o,r="";if((null===(o=null===(n=this.openApiDocument)||void 0===n?void 0:n.host)||void 0===o?void 0:o.length)>0){var a=this.openApiDocument.host;if(Array.isArray(a))r=this.openApiDocument.schemes[0]+"://"+a[0];else if(Array.isArray(this.openApiDocument.schemes))r=this.openApiDocument.schemes[0]+"://"+a;else try{const L=new URL(this.swaggerUrl);r=L.protocol+"//"+L.host}catch(L){r="/"}}else r=this.swaggerUrl;var h="";if(r.startsWith("http://")||r.startsWith("https://")){var R=new URL(r);h=R.protocol+"//"+R.hostname,R.port.length>0&&(h+=":"+R.port)}return h}GenerateShadowField(n,o,r){switch(n){case"integer":case"number":return`<block type='math_number'><field name='NUM'>${r||0}</field></block>`;case"string":return`<block type='text'><field name='TEXT'>${r||`please enter ${o}`}</field></block>`;case"boolean":return`<block type='logic_boolean'><field name='BOOL'>${r||"FALSE"}</field></block>`;case"array":return'<block type="lists_create_with"> <mutation items="0"></mutation></block>';default:return""}}GenerateNameFunction(n,o,r,a){return a+"_"+o.replaceAll("/","_").replaceAll("{","__").replaceAll("}","")}GenerateFunction(n,o,r,a){var h=this,R=h.GenerateNameFunction(n,o,r,a),W=r,nt=`<block type="text_print"> <value name="TEXT"><block type="${R}">`;W.parameters&&W.parameters.forEach(Ut=>{if(Ut.type)(Jt=h.GenerateShadowField(Ut.type,Ut.name,null)).length>0&&(nt+=`<value name="val_${Ut.name}">${Jt}</value>`);else if(Ut.schema&&Ut.schema.type){var Jt;(Jt=h.GenerateShadowField(Ut.schema.type,Ut.name,null)).length>0&&(nt+=`<value name="val_${Ut.name}">${Jt}</value>`)}});var et="",Et="";try{var It=h.findRootSite();if((It||"").length>0){var gt=new URL(It);et=gt.hostname,Et=gt.port}}catch(Ut){console.log("find root error",Ut)}var wt=h.GenerateShadowField("string","override_host",et=et||" ");return nt+=`<value name="override_Host">${wt}</value>`,wt=h.GenerateShadowField("integer","override_port",Et=Et||"0"),nt+=`<value name="override_Port">${wt}</value>`,nt+="</block></value>",h.fieldXMLFunctions.push({id:o,gui:nt+="</block>",methodAPI:a}),function(Ut,Jt){Ut[R]={init:function(){var Ct=a;switch(a.toString().toLowerCase()){case"get":Ct="",this.setColour(210);break;case"post":Ct="",this.setColour(165);break;case"put":Ct="",this.setColour(40);break;case"delete":Ct="",this.setColour(10);break;default:console.log(`not found ${a}`),this.setColour(10)}for(var bt=o,at="",ft=h.findCategSwaggerFromPaths(),lt=0;lt<ft.length;lt++){var Ft="/"+ft[lt]+"/",Mt=o.indexOf(Ft);if(Mt>-1){at=ft[lt];var yt=o.substring(Mt+Ft.length);yt.length<bt.length&&(bt=yt)}}at.length>5&&(at=at.substring(0,5)+"..."),bt.length>25&&(bt=bt.substring(0,25)+"..."),this.appendDummyInput().appendField(new m.FieldImage(`assets/httpImages/${a}.png`,90,20,a)).appendField(`${at} ${Ct} ${bt}`);var ct=h.findRootSite();if(W.parameters&&W.parameters.forEach(Lt=>{var de=Lt.name;if(Lt.required&&(de+="*"),Lt.type)de+=":"+Lt.type;else if(Lt.schema)if(Lt.schema.enum&&"$$ref"in Lt.schema){var _e=Lt.schema.$$ref.split("/");de+="=>"+_e[_e.length-1]}else if(Lt.schema.type)if("object"==Lt.schema.type){var ce=Lt.schema.$$ref||"";ce.length>0&&(de+=":"+(ce=ce.substring(ce.lastIndexOf("/")+1)))}else de+=":"+Lt.schema.type;this.appendValueInput(`val_${Lt.name}`).appendField(de)}),W.requestBody){var rt="";if(W.requestBody.content){var se=W.requestBody.content["application/json"];if(se&&se.schema){var xt=se.schema.$$ref;xt&&(rt="=>"+xt.substring(xt.lastIndexOf("/")+1))}}this.appendValueInput("val_values").appendField("values"+rt).setCheck()}this.appendValueInput("override_Host").appendField("override Host"),this.appendValueInput("override_Port").appendField("override Port"),this.setTooltip(`${a} ${ct}${o}`),this.setOutput(!0,"")}},Jt[R]=function(Ct){var lt=h.openApiDocument.paths[o][a],Ft=[];"parameters"in lt&&(Ft=lt.parameters);var Mt=!1,yt=Ft.filter(ri=>"body"==ri.in).length>0;(yt||"requestBody"in lt)&&(Mt=!0);var ct={},rt={};Mt&&(ct.val_values=Jt.valueToCode(Ct,"val_values",0),rt.val_values=ct.val_values),Ft.forEach(ri=>{ct[`val_${ri.name}`]=Jt.valueToCode(Ct,`val_${ri.name}`,0)});var se=Ft.map(ri=>ri.name);Mt&&!yt&&se.push("values"),se.push("extraData"),Ft.map(ri=>`\${obj['val_${ri.name}']},`);var Lt="function(";Lt+=se.join(",");var de=h.findRootSite();Lt+="){\n",Lt+='var rootSite="'+de+'";\n',Lt+="if(extraData){\n",Lt+="if(extraData.url && extraData.url.host && extraData.url.host.length>0 ){\n",Lt+="rootSite =  changeHost(rootSite, extraData.url.host);\n",Lt+="};\n",Lt+="if(extraData.url && extraData.url.port && extraData.url.port.toString().length>0 ){\n",Lt+="rootSite  =changePort(rootSite , extraData.url.port);\n",Lt+="};\n",Lt+="};\n";var _e=h.basePath+o;_e.startsWith("//")&&(_e=_e.replace("//","/")),(de=de||"").length>0&&_e.startsWith(de)&&(Lt+='\n rootSite="";//the root site is in url;\n'),Lt+='var strUrl =rootSite +"'+_e+'";\n';var ce=Ft.filter(ri=>"query"==ri.in);if(ce.length>0){Lt+='strUrl+="?";\n;';var Ae=ce.map(ri=>`${ri.name}={`+ri.name+"}").join("&");Lt+='strUrl += "'+Ae+'";\n;'}var Ne=Ft.filter(ri=>"path"==ri.in||"query"==ri.in).map(ri=>`\n          //this gives error cannot read property 'call' of undefined in acorn\n          //strUrl = strUrl.replace("{${ri.name}}",${ri.name});\n          {\n            var replaceFInd = "{${ri.name}}";\n            var index= strUrl.indexOf(replaceFInd);\n            if(index>=0){\n              var strUrlReplace = strUrl.substring(0,index)+ ${ri.name} + strUrl.substring(index+replaceFInd.length);\n              strUrl = strUrlReplace;\n            }\n\n          };`);if(Lt+=Ne.join("\n"),Lt+=`\n{var res= ${a}Xhr(strUrl`,Mt){var qe="values";yt&&(qe=Ft.filter(ri=>"body"==ri.in)[0].name),Lt+=`,JSON.stringify(${qe})`}Lt+=");\n",Lt+="var resJS=JSON.parse(res);\n",Lt+="if(resJS.statusOK) return resJS.text;\n",Lt+="errHandler(res);\n}\n",Lt+="}",Lt+="(",Ft.forEach(ri=>{Lt+=ct[`val_${ri.name}`]+","}),Mt&&!yt&&(Lt+=rt.val_values+",");var Di="url:{notImportant:1",ei=Jt.valueToCode(Ct,"override_Host",0);(ei=ei||"").length>0&&(Di+=`,host:${ei}`);var Me=Jt.valueToCode(Ct,"override_Port",0);return(Me=Me||"").length>0&&(Di+=`,port:${Me}`),Lt+=`{${Di+="}"}}\n`,[Lt+=")",99]}}}findProperties(n){var o=[];return n.properties&&Object.keys(n.properties).forEach(r=>{o.push({key:r,value:n.properties[r]})}),o}TranslateToBlocklyType(n){return"integer"==n?"Number":"string"==n?"String":"bool"==n?"Boolean":"array"==n?"Array":(console.error("not found TranslateToBlocklyType item"+n),"not found type"+n)}nameCategSwagger(){return`catSwagger${this.findHostNameRegular()}_${this.name}`}findHostNameRegular(){var n,o,r,a="";if((null===(o=null===(n=this.openApiDocument)||void 0===n?void 0:n.host)||void 0===o?void 0:o.length)>0){var h=this.openApiDocument.host;if(Array.isArray(h))a=this.openApiDocument.schemes[0]+"://"+h[0];else if(Array.isArray(this.openApiDocument.schemes))a=this.openApiDocument.schemes[0]+"://"+h;else try{const nt=new URL(this.swaggerUrl);a=nt.protocol+"//"+nt.host}catch(nt){a="/"}}else a=this.swaggerUrl;var R="(localSite)";if(a.startsWith("http://")||a.startsWith("https://")){var L=new URL(a),W=null!==(r=L.port)&&void 0!==r?r:80;R=L.hostname+W}return R.split(".").join("")}metaBlocks(){var n=this;return function(o,r){var a;o[a=`meta_swagger_controllers_${n.name}`]={init:function(){this.appendDummyInput().appendField("categories_"+n.name),this.setOutput(!0,null),this.setColour(30),this.setTooltip(""),this.setHelpUrl(n.swaggerUrl)}},r[a]=function(h){var L=n.findCategSwaggerFromPaths().map(et=>({name:et}));return[JSON.stringify({name:n.name,categories:L}),r.ORDER_NONE]},o[a=`meta_swagger_controllers_actions_${n.name}`]={init:function(){this.appendDummyInput().appendField("categories_actions"+n.name),this.setOutput(!0,null),this.setColour(30),this.setTooltip(""),this.setHelpUrl(n.swaggerUrl)}},r[a]=function(h){var L=n.findCategSwaggerFromPaths().map(et=>({name:et,ops:n.findfieldXMLFunctions(et).filter(Et=>Et.id.length>0)}));return[JSON.stringify({name:n.name,categories:L}),r.ORDER_NONE]}}}findCategsFromTags(){var n=this.openApiDocument.paths;console.log("x",this.openApiDocument);var o=Object.keys(n),r=this;o.forEach(function(a){var h=n[a];h&&Object.keys(h).forEach(function(L){var W=h[L].tags;W&&W.length>0&&W.forEach(function(nt){r.cacheCategSwaggerFromPaths.includes(nt)||r.cacheCategSwaggerFromPaths.push(nt),r.operations.push({controller:nt,id:a})})})})}findCategSwaggerFromPaths(){if(this.findCategsFromTags(),this.cacheCategSwaggerFromPaths.length>0)return this.cacheCategSwaggerFromPaths;var n=this.paths.filter(r=>r&&r.id&&r.id.length>0).map(r=>{for(var a=r.id.length,h=r.id.indexOf("{");h>0;){var R=r.id.indexOf("}",h);if(a-R<2){r.id=r.id.substring(0,h);break}h=r.id.indexOf("{",R)}return r}).map(r=>(r.id.lastIndexOf("/")!=r.id.length-1&&(r.id+="/"),r));this.operations=n.filter(r=>r.nrOps>1).map(r=>({arr:r.id.split("/").filter(h=>h.length>0),id:r.id})).map(r=>({controller:r.arr[r.arr.length-1],id:r.id}));var o=n.filter(r=>1==r.nrOps).map(r=>({arr:r.id.split("/").filter(a=>a.length>0),id:r.id})).map(r=>1==r.arr.length?{controller:r.arr[0],id:r.id}:{controller:r.arr[r.arr.length-2],id:r.id});return this.operations.push(...o),this.cacheCategSwaggerFromPaths=[...new Set(this.operations.map(r=>r.controller))],this.cacheCategSwaggerFromPaths}findfieldXMLFunctions(n){var o=this.operations.filter(a=>a.controller==n);return this.fieldXMLFunctions.filter(a=>{if(""==a.id)return!0;var h=a.id+"/",R=!1;return o.forEach(L=>{h.startsWith(L.id)&&(R=!0)}),!!R||(o.forEach(L=>{var W=L.id.substring(0,L.id.lastIndexOf("/"))+"{";h.startsWith(W)&&(R=!0)}),R)})}}},95240:(B,X,_)=>{"use strict";_.d(X,{d:()=>at});var C=_(68306),m=_(38421);const{isArray:e}=Array;var n=_(60515),o=_(25403),r=_(63269);var h=_(39646),R=_(4128),L=_(32076),W=_(91005),nt=_(18505),et=_(63900),Et=_(70262),It=_(54004),gt=_(5533),wt=_(51707);class Ut{constructor(lt,Ft){this.urL=lt,this.http=Ft,this.WasAlive=!1}download(){window.location.href="https://github.com/ignatandrei/BlocklyAutomation/releases/latest/download/releaseLocalAPI.zip"}IsAlive(){this.WasAlive=!1;var lt=this,Ft=(new Date).toISOString();return this.http.get(this.urL+`api/v1/Management/CurrentDate?${Ft}`,{responseType:"text"}).pipe((0,Et.K)(Mt=>(0,h.of)("")),(0,It.U)(Mt=>(null==Mt?void 0:Mt.length)>0&&(Date.parse(Mt),lt.WasAlive=!0,!0)))}LoadBlockContent(lt){return(new Date).toISOString(),this.http.post(this.urL+"api/v1/BASave/GetBlocksContent",{id:lt},{responseType:"text"}).pipe((0,It.U)(Mt=>null==Mt?void 0:Mt.toString()))}LoadBlocks(){return(new Date).toISOString(),this.http.post(this.urL+"api/v1/BASave/GetBlocks",null).pipe((0,It.U)(Ft=>Ft.map(yt=>{var ct=new gt.q(yt);return ct.Source="LocalAPI",ct})))}SaveBlock(lt,Ft){return this.http.post(this.urL+"api/v1/BASave/SaveNewBlock",{b:lt,content:Ft},{responseType:"text"}).pipe((0,It.U)(Mt=>Number.parseInt(null==Mt?void 0:Mt.toString(),10)))}}var Jt=_(5e3),Ct=_(40520),bt=_(5137);let at=(()=>{class ft{constructor(Ft,Mt){this.http=Ft,this.loadShowUsageService=Mt,this.settings=null,this.linksSwagger=[],this.demoBlocks=[],this.swaggersDict=new Map,this.customCategories="",this.LocalAPI=null,this.Init()}CreateLocalApis(Ft,Mt){return new Ut(Mt,Ft)}Init(){return function a(...ft){const lt=(0,r.jO)(ft),Ft=function t(ft){return 1===ft.length&&e(ft[0])?ft[0]:ft}(ft);return Ft.length?new C.y(Mt=>{let yt=Ft.map(()=>[]),ct=Ft.map(()=>!1);Mt.add(()=>{yt=ct=null});for(let rt=0;!Mt.closed&&rt<Ft.length;rt++)(0,m.Xf)(Ft[rt]).subscribe(new o.Q(Mt,se=>{if(yt[rt].push(se),yt.every(xt=>xt.length)){const xt=yt.map(Lt=>Lt.shift());Mt.next(lt?lt(...xt):xt),yt.some((Lt,de)=>!Lt.length&&ct[de])&&Mt.complete()}},()=>{ct[rt]=!0,!yt[rt].length&&Mt.complete()}));return()=>{yt=ct=null}}):n.E}(this.getSettings(),this.loadShowUsageService.getSwaggerLinks(),this.loadShowUsageService.getDemoBlocks(),this.loadShowUsageService.getCustomCategories(),this.getLatestVersion()).pipe((0,W.g)(1e3),(0,nt.b)(([Ft,Mt,yt,ct,rt])=>{this.settings=Ft,this.settings.latestVersion=rt,this.linksSwagger=Mt,this.demoBlocks=yt.map(se=>{var xt=new gt.q(se);return xt.Source="Demos",xt}),this.customCategories=ct,this.LocalAPI=this.CreateLocalApis(this.http,this.settings.localAPI),this.LocalAPI.IsAlive().subscribe(se=>{console.log("LocalAPI is alive",se)})}),(0,et.w)(()=>this.obtainSwaggers(this.linksSwagger)),(0,et.w)(()=>(0,h.of)("")))}obtainSwaggers(Ft){var Mt=Ft.map(ct=>this.LoadSwaggersFromUrl(ct));return(0,R.D)(Mt)}LoadSwaggersFromUrl(Ft){var Mt=Ft.link,yt=Ft.id||Ft.link,ct=new wt.L(Mt);return(0,L.D)(ct.ParseSwagger()).pipe((0,nt.b)(se=>{console.log("swagger loaded:"+Mt,se),se.name=yt,this.swaggersDict.set(Mt,se)},se=>{console.error("swagger error:"+Mt,se)}))}getLatestVersion(){return this.http.get("https://ignatandrei.github.io/BlocklyAutomation/version.txt",{responseType:"text"}).pipe((0,Et.K)(Ft=>(console.error("error getting latest version",Ft),(0,h.of)("vcannot get latest version"))),(0,It.U)(Ft=>Ft.toString().trim().substr(1)))}getSettings(){var Ft=(new Date).toISOString();return this.http.get(`assets/settings.json?${Ft}`,{responseType:"text"}).pipe((0,It.U)(Mt=>JSON.parse(Mt)))}}return ft.\u0275fac=function(Ft){return new(Ft||ft)(Jt.LFG(Ct.eN),Jt.LFG(bt.F))},ft.\u0275prov=Jt.Yz7({token:ft,factory:ft.\u0275fac}),ft})()},5533:(B,X,_)=>{"use strict";_.d(X,{q:()=>C});class C{constructor(e={}){this.id="",this.description="",this.categories="",this.blocks="",this.Source="None",Object.assign(this,e)}}},20549:(B,X,_)=>{"use strict";_.d(X,{v:()=>e});var C=_(77579),m=_(5e3);let e=(()=>{class t{constructor(){this.sendData=new C.x}receiveData(){return this.sendData.asObservable()}sendDataToServer(o,r){this.sendData.next([o,r])}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=m.Yz7({token:t,factory:t.\u0275fac}),t})()},57387:(B,X,_)=>{"use strict";_.r(X),_.d(X,{DisplayBlocklyComponent:()=>yg});var C=_(15861),e=(_(64166),_(76279)),t=_(30069);const n=[e.Events.VIEWPORT_CHANGE,e.Events.BLOCK_MOVE,e.Events.BLOCK_DELETE];class a{constructor(c){this.workspace_=c,this.width_=0,this.height_=0,this.top_=0,this.left_=0,this.lastScale_=1,this.cachedContentMetrics_=void 0}init(c){c=Number(c),this.padding_=isNaN(c)?10:c,this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"contentAreaHighlight"},null);const s=String(Math.random()).substring(2),l=e.utils.dom.createSvgElement(new e.utils.Svg("mask"),{id:"contentAreaHighlightMask"+s},this.svgGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{x:0,y:0,width:"100%",height:"100%",fill:"white"},l),this.rect_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{x:0,y:0,rx:e.Bubble.BORDER_WIDTH,ry:e.Bubble.BORDER_WIDTH,fill:"black"},l),this.background_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{x:0,y:0,width:"100%",height:"100%",mask:"url(#contentAreaHighlightMask"+s+")"},this.svgGroup_),this.applyColor_();const u=this.workspace_.getMetricsManager();this.cachedContentMetrics_=u.getContentMetrics(!0),this.resize_(this.cachedContentMetrics_);const g=u.getAbsoluteMetrics();this.position_(this.cachedContentMetrics_,g),this.svgGroup_.style.transition="opacity 0.25s";const b=this.workspace_.getParentSvg();b.firstChild?b.insertBefore(this.svgGroup_,b.firstChild):b.appendChild(this.svgGroup_),this.onChangeWrapper_=this.onChange_.bind(this),this.workspace_.addChangeListener(this.onChangeWrapper_)}dispose(){this.svgGroup_&&e.utils.dom.removeNode(this.svgGroup_),this.onChangeWrapper_&&e.unbindEvent_(this.onChangeWrapper_)}onChange_(c){if(c.type===e.Events.THEME_CHANGE)this.applyColor_();else if(-1!==n.indexOf(c.type)){const s=this.workspace_.getMetricsManager();c.type!==e.Events.VIEWPORT_CHANGE&&(this.cachedContentMetrics_=s.getContentMetrics(!0),this.resize_(this.cachedContentMetrics_));const l=s.getAbsoluteMetrics();this.position_(this.cachedContentMetrics_,l)}else c.type===e.Events.BLOCK_DRAG&&this.handleBlockDrag_(c)}handleBlockDrag_(c){this.svgGroup_.setAttribute("opacity",c.isStart?"0":"1")}applyColor_(){const s=this.workspace_.getTheme().getComponentStyle("workspaceBackgroundColour")||"#ffffff",l=e.utils.colour.blend("#000",s,.1),u=e.utils.colour.blend("#fff",s,.1);this.background_.setAttribute("fill","#ffffff"===s||"#fff"===s?l:u)}resize_(c){const s=c.width?c.width+2*this.padding_:0,l=c.height?c.height+2*this.padding_:0;s!==this.width_&&(this.width_=s,this.rect_.setAttribute("width",s)),l!==this.height_&&(this.height_=l,this.rect_.setAttribute("height",l))}position_(c,s){const g=this.workspace_.scale,b=s.top+c.top*g- -this.workspace_.scrollY-this.padding_*g,w=s.left+c.left*g- -this.workspace_.scrollX-this.padding_*g;(b!==this.top_||w!==this.left_||this.lastScale_!==g)&&(this.top_=b,this.left_=w,this.lastScale_=g,this.rect_.setAttribute("transform","translate("+w+","+b+") scale("+g+")"))}}var h=_(5533),R=_(51707),L=_(70697);const nt="undefined"==typeof window?function(v){return v()}:window.requestAnimationFrame;function et(v,c,s){const l=s||(b=>Array.prototype.slice.call(b));let u=!1,g=[];return function(...b){g=l(b),u||(u=!0,nt.call(window,()=>{u=!1,v.apply(c,g)}))}}const It=v=>"start"===v?"left":"end"===v?"right":"center",gt=(v,c,s)=>"start"===v?c:"end"===v?s:(c+s)/2;function Ut(){}const Jt=function(){let v=0;return function(){return v++}}();function Ct(v){return null==v}function bt(v){if(Array.isArray&&Array.isArray(v))return!0;const c=Object.prototype.toString.call(v);return"[object"===c.substr(0,7)&&"Array]"===c.substr(-6)}function at(v){return null!==v&&"[object Object]"===Object.prototype.toString.call(v)}const ft=v=>("number"==typeof v||v instanceof Number)&&isFinite(+v);function lt(v,c){return ft(v)?v:c}function Ft(v,c){return void 0===v?c:v}const yt=(v,c)=>"string"==typeof v&&v.endsWith("%")?parseFloat(v)/100*c:+v;function ct(v,c,s){if(v&&"function"==typeof v.call)return v.apply(s,c)}function rt(v,c,s,l){let u,g,b;if(bt(v))if(g=v.length,l)for(u=g-1;u>=0;u--)c.call(s,v[u],u);else for(u=0;u<g;u++)c.call(s,v[u],u);else if(at(v))for(b=Object.keys(v),g=b.length,u=0;u<g;u++)c.call(s,v[b[u]],b[u])}function se(v,c){let s,l,u,g;if(!v||!c||v.length!==c.length)return!1;for(s=0,l=v.length;s<l;++s)if(u=v[s],g=c[s],u.datasetIndex!==g.datasetIndex||u.index!==g.index)return!1;return!0}function xt(v){if(bt(v))return v.map(xt);if(at(v)){const c=Object.create(null),s=Object.keys(v),l=s.length;let u=0;for(;u<l;++u)c[s[u]]=xt(v[s[u]]);return c}return v}function Lt(v){return-1===["__proto__","prototype","constructor"].indexOf(v)}function de(v,c,s,l){if(!Lt(v))return;const u=c[v],g=s[v];at(u)&&at(g)?_e(u,g,l):c[v]=xt(g)}function _e(v,c,s){const l=bt(c)?c:[c],u=l.length;if(!at(v))return v;const g=(s=s||{}).merger||de;for(let b=0;b<u;++b){if(!at(c=l[b]))continue;const w=Object.keys(c);for(let k=0,H=w.length;k<H;++k)g(w[k],v,c,s)}return v}function ce(v,c){return _e(v,c,{merger:Ae})}function Ae(v,c,s){if(!Lt(v))return;const l=c[v],u=s[v];at(l)&&at(u)?ce(l,u):Object.prototype.hasOwnProperty.call(c,v)||(c[v]=xt(u))}function ei(v,c){const s=v.indexOf(".",c);return-1===s?v.length:s}function Me(v,c){if(""===c)return v;let s=0,l=ei(c,s);for(;v&&l>s;)v=v[c.substr(s,l-s)],s=l+1,l=ei(c,s);return v}function ri(v){return v.charAt(0).toUpperCase()+v.slice(1)}const Bt=v=>void 0!==v,Ie=v=>"function"==typeof v,Xt=(v,c)=>{if(v.size!==c.size)return!1;for(const s of v)if(!c.has(s))return!1;return!0},he=Math.PI,Dt=2*he,ve=Dt+he,je=Number.POSITIVE_INFINITY,gi=he/180,Ee=he/2,ne=he/4,ee=2*he/3,Oe=Math.log10,le=Math.sign;function me(v){const c=Math.round(v);v=Zt(v,c,v/1e3)?c:v;const s=Math.pow(10,Math.floor(Oe(v))),l=v/s;return(l<=1?1:l<=2?2:l<=5?5:10)*s}function Kt(v){return!isNaN(parseFloat(v))&&isFinite(v)}function Zt(v,c,s){return Math.abs(v-c)<s}function $e(v,c,s){let l,u,g;for(l=0,u=v.length;l<u;l++)g=v[l][s],isNaN(g)||(c.min=Math.min(c.min,g),c.max=Math.max(c.max,g))}function Ti(v){return v*(he/180)}function vi(v){return v*(180/he)}function di(v){if(!ft(v))return;let c=1,s=0;for(;Math.round(v*c)/c!==v;)c*=10,s++;return s}function Ri(v,c){return Math.sqrt(Math.pow(c.x-v.x,2)+Math.pow(c.y-v.y,2))}function rn(v,c){return(v-c+ve)%Dt-he}function ge(v){return(v%Dt+Dt)%Dt}function De(v,c,s,l){const u=ge(v),g=ge(c),b=ge(s),w=ge(g-u),k=ge(b-u),H=ge(u-g),Z=ge(u-b);return u===g||u===b||l&&g===b||w>k&&H<Z}function _i(v,c,s){return Math.max(c,Math.min(s,v))}function Fi(v,c,s,l=1e-6){return v>=Math.min(c,s)-l&&v<=Math.max(c,s)+l}const Ni=v=>0===v||1===v,mn=(v,c,s)=>-Math.pow(2,10*(v-=1))*Math.sin((v-c)*Dt/s),si=(v,c,s)=>Math.pow(2,-10*v)*Math.sin((v-c)*Dt/s)+1,Ce={linear:v=>v,easeInQuad:v=>v*v,easeOutQuad:v=>-v*(v-2),easeInOutQuad:v=>(v/=.5)<1?.5*v*v:-.5*(--v*(v-2)-1),easeInCubic:v=>v*v*v,easeOutCubic:v=>(v-=1)*v*v+1,easeInOutCubic:v=>(v/=.5)<1?.5*v*v*v:.5*((v-=2)*v*v+2),easeInQuart:v=>v*v*v*v,easeOutQuart:v=>-((v-=1)*v*v*v-1),easeInOutQuart:v=>(v/=.5)<1?.5*v*v*v*v:-.5*((v-=2)*v*v*v-2),easeInQuint:v=>v*v*v*v*v,easeOutQuint:v=>(v-=1)*v*v*v*v+1,easeInOutQuint:v=>(v/=.5)<1?.5*v*v*v*v*v:.5*((v-=2)*v*v*v*v+2),easeInSine:v=>1-Math.cos(v*Ee),easeOutSine:v=>Math.sin(v*Ee),easeInOutSine:v=>-.5*(Math.cos(he*v)-1),easeInExpo:v=>0===v?0:Math.pow(2,10*(v-1)),easeOutExpo:v=>1===v?1:1-Math.pow(2,-10*v),easeInOutExpo:v=>Ni(v)?v:v<.5?.5*Math.pow(2,10*(2*v-1)):.5*(2-Math.pow(2,-10*(2*v-1))),easeInCirc:v=>v>=1?v:-(Math.sqrt(1-v*v)-1),easeOutCirc:v=>Math.sqrt(1-(v-=1)*v),easeInOutCirc:v=>(v/=.5)<1?-.5*(Math.sqrt(1-v*v)-1):.5*(Math.sqrt(1-(v-=2)*v)+1),easeInElastic:v=>Ni(v)?v:mn(v,.075,.3),easeOutElastic:v=>Ni(v)?v:si(v,.075,.3),easeInOutElastic:v=>Ni(v)?v:v<.5?.5*mn(2*v,.1125,.45):.5+.5*si(2*v-1,.1125,.45),easeInBack:v=>v*v*(2.70158*v-1.70158),easeOutBack:v=>(v-=1)*v*(2.70158*v+1.70158)+1,easeInOutBack(v){let c=1.70158;return(v/=.5)<1?v*v*((1+(c*=1.525))*v-c)*.5:.5*((v-=2)*v*((1+(c*=1.525))*v+c)+2)},easeInBounce:v=>1-Ce.easeOutBounce(1-v),easeOutBounce:v=>v<1/2.75?7.5625*v*v:v<2/2.75?7.5625*(v-=1.5/2.75)*v+.75:v<2.5/2.75?7.5625*(v-=2.25/2.75)*v+.9375:7.5625*(v-=2.625/2.75)*v+.984375,easeInOutBounce:v=>v<.5?.5*Ce.easeInBounce(2*v):.5*Ce.easeOutBounce(2*v-1)+.5},Vt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},vt="0123456789ABCDEF",Gt=v=>vt[15&v],fe=v=>vt[(240&v)>>4]+vt[15&v],He=v=>(240&v)>>4==(15&v);function no(v){return v+.5|0}const li=(v,c,s)=>Math.max(Math.min(v,s),c);function Je(v){return li(no(2.55*v),0,255)}function xe(v){return li(no(255*v),0,255)}function hi(v){return li(no(v/2.55)/100,0,1)}function Oi(v){return li(no(100*v),0,100)}const gn=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,Do=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Zo(v,c,s){const l=c*Math.min(s,1-s),u=(g,b=(g+v/30)%12)=>s-l*Math.max(Math.min(b-3,9-b,1),-1);return[u(0),u(8),u(4)]}function qo(v,c,s){const l=(u,g=(u+v/60)%6)=>s-s*c*Math.max(Math.min(g,4-g,1),0);return[l(5),l(3),l(1)]}function yr(v,c,s){const l=Zo(v,1,.5);let u;for(c+s>1&&(u=1/(c+s),c*=u,s*=u),u=0;u<3;u++)l[u]*=1-c-s,l[u]+=c;return l}function xo(v){const s=v.r/255,l=v.g/255,u=v.b/255,g=Math.max(s,l,u),b=Math.min(s,l,u),w=(g+b)/2;let k,H,Z;return g!==b&&(Z=g-b,H=w>.5?Z/(2-g-b):Z/(g+b),k=g===s?(l-u)/Z+(l<u?6:0):g===l?(u-s)/Z+2:(s-l)/Z+4,k=60*k+.5),[0|k,H||0,w]}function vo(v,c,s,l){return(Array.isArray(c)?v(c[0],c[1],c[2]):v(c,s,l)).map(xe)}function Fr(v,c,s){return vo(Zo,v,c,s)}function Gn(v){return(v%360+360)%360}const Mo={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Qo={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Bi;function Wn(v,c,s){if(v){let l=xo(v);l[c]=Math.max(0,Math.min(l[c]+l[c]*s,0===c?360:1)),l=Fr(l),v.r=l[0],v.g=l[1],v.b=l[2]}}function ae(v,c){return v&&Object.assign(c||{},v)}function Fe(v){var c={r:0,g:0,b:0,a:255};return Array.isArray(v)?v.length>=3&&(c={r:v[0],g:v[1],b:v[2],a:255},v.length>3&&(c.a=xe(v[3]))):(c=ae(v,{r:0,g:0,b:0,a:1})).a=xe(c.a),c}function Mi(v){return"r"===v.charAt(0)?function kn(v){const c=gn.exec(v);let l,u,g,s=255;if(c){if(c[7]!==l){const b=+c[7];s=255&(c[8]?Je(b):255*b)}return l=+c[1],u=+c[3],g=+c[5],l=255&(c[2]?Je(l):l),u=255&(c[4]?Je(u):u),g=255&(c[6]?Je(g):g),{r:l,g:u,b:g,a:s}}}(v):function To(v){const c=Do.exec(v);let l,s=255;if(!c)return;c[5]!==l&&(s=c[6]?Je(+c[5]):xe(+c[5]));const u=Gn(+c[2]),g=+c[3]/100,b=+c[4]/100;return l="hwb"===c[1]?function co(v,c,s){return vo(yr,v,c,s)}(u,g,b):"hsv"===c[1]?function Ii(v,c,s){return vo(qo,v,c,s)}(u,g,b):Fr(u,g,b),{r:l[0],g:l[1],b:l[2],a:s}}(v)}class Yi{constructor(c){if(c instanceof Yi)return c;const s=typeof c;let l;"object"===s?l=Fe(c):"string"===s&&(l=function tn(v){var s,c=v.length;return"#"===v[0]&&(4===c||5===c?s={r:255&17*Vt[v[1]],g:255&17*Vt[v[2]],b:255&17*Vt[v[3]],a:5===c?17*Vt[v[4]]:255}:(7===c||9===c)&&(s={r:Vt[v[1]]<<4|Vt[v[2]],g:Vt[v[3]]<<4|Vt[v[4]],b:Vt[v[5]]<<4|Vt[v[6]],a:9===c?Vt[v[7]]<<4|Vt[v[8]]:255})),s}(c)||function On(v){Bi||(Bi=function Oo(){const v={},c=Object.keys(Qo),s=Object.keys(Mo);let l,u,g,b,w;for(l=0;l<c.length;l++){for(b=w=c[l],u=0;u<s.length;u++)g=s[u],w=w.replace(g,Mo[g]);g=parseInt(Qo[b],16),v[w]=[g>>16&255,g>>8&255,255&g]}return v}(),Bi.transparent=[0,0,0,0]);const c=Bi[v.toLowerCase()];return c&&{r:c[0],g:c[1],b:c[2],a:4===c.length?c[3]:255}}(c)||Mi(c)),this._rgb=l,this._valid=!!l}get valid(){return this._valid}get rgb(){var c=ae(this._rgb);return c&&(c.a=hi(c.a)),c}set rgb(c){this._rgb=Fe(c)}rgbString(){return this._valid?function so(v){return v&&(v.a<255?`rgba(${v.r}, ${v.g}, ${v.b}, ${hi(v.a)})`:`rgb(${v.r}, ${v.g}, ${v.b})`)}(this._rgb):this._rgb}hexString(){return this._valid?function In(v){var c=function $i(v){return He(v.r)&&He(v.g)&&He(v.b)&&He(v.a)}(v)?Gt:fe;return v&&"#"+c(v.r)+c(v.g)+c(v.b)+(v.a<255?c(v.a):"")}(this._rgb):this._rgb}hslString(){return this._valid?function yo(v){if(!v)return;const c=xo(v),s=c[0],l=Oi(c[1]),u=Oi(c[2]);return v.a<255?`hsla(${s}, ${l}%, ${u}%, ${hi(v.a)})`:`hsl(${s}, ${l}%, ${u}%)`}(this._rgb):this._rgb}mix(c,s){const l=this;if(c){const u=l.rgb,g=c.rgb;let b;const w=s===b?.5:s,k=2*w-1,H=u.a-g.a,Z=((k*H==-1?k:(k+H)/(1+k*H))+1)/2;b=1-Z,u.r=255&Z*u.r+b*g.r+.5,u.g=255&Z*u.g+b*g.g+.5,u.b=255&Z*u.b+b*g.b+.5,u.a=w*u.a+(1-w)*g.a,l.rgb=u}return l}clone(){return new Yi(this.rgb)}alpha(c){return this._rgb.a=xe(c),this}clearer(c){return this._rgb.a*=1-c,this}greyscale(){const c=this._rgb,s=no(.3*c.r+.59*c.g+.11*c.b);return c.r=c.g=c.b=s,this}opaquer(c){return this._rgb.a*=1+c,this}negate(){const c=this._rgb;return c.r=255-c.r,c.g=255-c.g,c.b=255-c.b,this}lighten(c){return Wn(this._rgb,2,c),this}darken(c){return Wn(this._rgb,2,-c),this}saturate(c){return Wn(this._rgb,1,c),this}desaturate(c){return Wn(this._rgb,1,-c),this}rotate(c){return function Uo(v,c){var s=xo(v);s[0]=Gn(s[0]+c),s=Fr(s),v.r=s[0],v.g=s[1],v.b=s[2]}(this._rgb,c),this}}function Ki(v){return new Yi(v)}const qn=v=>v instanceof CanvasGradient||v instanceof CanvasPattern;function ao(v){return qn(v)?v:Ki(v)}function lo(v){return qn(v)?v:Ki(v).saturate(.5).darken(.1).hexString()}const Rn=Object.create(null),Kr=Object.create(null);function _r(v,c){if(!c)return v;const s=c.split(".");for(let l=0,u=s.length;l<u;++l){const g=s[l];v=v[g]||(v[g]=Object.create(null))}return v}function rr(v,c,s){return"string"==typeof c?_e(_r(v,c),s):_e(_r(v,""),c)}var uo=new class Or{constructor(c){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,l)=>lo(l.backgroundColor),this.hoverBorderColor=(s,l)=>lo(l.borderColor),this.hoverColor=(s,l)=>lo(l.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.describe(c)}set(c,s){return rr(this,c,s)}get(c){return _r(this,c)}describe(c,s){return rr(Kr,c,s)}override(c,s){return rr(Rn,c,s)}route(c,s,l,u){const g=_r(this,c),b=_r(this,l),w="_"+s;Object.defineProperties(g,{[w]:{value:g[s],writable:!0},[s]:{enumerable:!0,get(){const k=this[w],H=b[u];return at(k)?Object.assign({},H,k):Ft(k,H)},set(k){this[w]=k}}})}}({_scriptable:v=>!v.startsWith("on"),_indexable:v=>"events"!==v,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function Wr(v,c,s,l,u){let g=c[u];return g||(g=c[u]=v.measureText(u).width,s.push(u)),g>l&&(l=g),l}function sr(v,c,s,l){let u=(l=l||{}).data=l.data||{},g=l.garbageCollect=l.garbageCollect||[];l.font!==c&&(u=l.data={},g=l.garbageCollect=[],l.font=c),v.save(),v.font=c;let b=0;const w=s.length;let k,H,Z,ht,Pt;for(k=0;k<w;k++)if(ht=s[k],null!=ht&&!0!==bt(ht))b=Wr(v,u,g,b,ht);else if(bt(ht))for(H=0,Z=ht.length;H<Z;H++)Pt=ht[H],null!=Pt&&!bt(Pt)&&(b=Wr(v,u,g,b,Pt));v.restore();const qt=g.length/2;if(qt>s.length){for(k=0;k<qt;k++)delete u[g[k]];g.splice(0,qt)}return b}function wr(v,c,s){const l=v.currentDevicePixelRatio,u=0!==s?Math.max(s/2,.5):0;return Math.round((c-u)*l)/l+u}function Ua(v,c){(c=c||v.getContext("2d")).save(),c.resetTransform(),c.clearRect(0,0,v.width,v.height),c.restore()}function Cr(v,c,s,l){let u,g,b,w,k;const H=c.pointStyle,Z=c.rotation,ht=c.radius;let Pt=(Z||0)*gi;if(H&&"object"==typeof H&&(u=H.toString(),"[object HTMLImageElement]"===u||"[object HTMLCanvasElement]"===u))return v.save(),v.translate(s,l),v.rotate(Pt),v.drawImage(H,-H.width/2,-H.height/2,H.width,H.height),void v.restore();if(!(isNaN(ht)||ht<=0)){switch(v.beginPath(),H){default:v.arc(s,l,ht,0,Dt),v.closePath();break;case"triangle":v.moveTo(s+Math.sin(Pt)*ht,l-Math.cos(Pt)*ht),Pt+=ee,v.lineTo(s+Math.sin(Pt)*ht,l-Math.cos(Pt)*ht),Pt+=ee,v.lineTo(s+Math.sin(Pt)*ht,l-Math.cos(Pt)*ht),v.closePath();break;case"rectRounded":k=.516*ht,w=ht-k,g=Math.cos(Pt+ne)*w,b=Math.sin(Pt+ne)*w,v.arc(s-g,l-b,k,Pt-he,Pt-Ee),v.arc(s+b,l-g,k,Pt-Ee,Pt),v.arc(s+g,l+b,k,Pt,Pt+Ee),v.arc(s-b,l+g,k,Pt+Ee,Pt+he),v.closePath();break;case"rect":if(!Z){w=Math.SQRT1_2*ht,v.rect(s-w,l-w,2*w,2*w);break}Pt+=ne;case"rectRot":g=Math.cos(Pt)*ht,b=Math.sin(Pt)*ht,v.moveTo(s-g,l-b),v.lineTo(s+b,l-g),v.lineTo(s+g,l+b),v.lineTo(s-b,l+g),v.closePath();break;case"crossRot":Pt+=ne;case"cross":g=Math.cos(Pt)*ht,b=Math.sin(Pt)*ht,v.moveTo(s-g,l-b),v.lineTo(s+g,l+b),v.moveTo(s+b,l-g),v.lineTo(s-b,l+g);break;case"star":g=Math.cos(Pt)*ht,b=Math.sin(Pt)*ht,v.moveTo(s-g,l-b),v.lineTo(s+g,l+b),v.moveTo(s+b,l-g),v.lineTo(s-b,l+g),Pt+=ne,g=Math.cos(Pt)*ht,b=Math.sin(Pt)*ht,v.moveTo(s-g,l-b),v.lineTo(s+g,l+b),v.moveTo(s+b,l-g),v.lineTo(s-b,l+g);break;case"line":g=Math.cos(Pt)*ht,b=Math.sin(Pt)*ht,v.moveTo(s-g,l-b),v.lineTo(s+g,l+b);break;case"dash":v.moveTo(s,l),v.lineTo(s+Math.cos(Pt)*ht,l+Math.sin(Pt)*ht)}v.fill(),c.borderWidth>0&&v.stroke()}}function us(v,c,s){return s=s||.5,!c||v&&v.x>c.left-s&&v.x<c.right+s&&v.y>c.top-s&&v.y<c.bottom+s}function ya(v,c){v.save(),v.beginPath(),v.rect(c.left,c.top,c.right-c.left,c.bottom-c.top),v.clip()}function Vo(v){v.restore()}function Ma(v,c,s,l,u){if(!c)return v.lineTo(s.x,s.y);if("middle"===u){const g=(c.x+s.x)/2;v.lineTo(g,c.y),v.lineTo(g,s.y)}else"after"===u!=!!l?v.lineTo(c.x,s.y):v.lineTo(s.x,c.y);v.lineTo(s.x,s.y)}function dl(v,c,s,l){if(!c)return v.lineTo(s.x,s.y);v.bezierCurveTo(l?c.cp1x:c.cp2x,l?c.cp1y:c.cp2y,l?s.cp2x:s.cp1x,l?s.cp2y:s.cp1y,s.x,s.y)}function js(v,c,s,l,u,g={}){const b=bt(c)?c:[c],w=g.strokeWidth>0&&""!==g.strokeColor;let k,H;for(v.save(),v.font=u.string,function ia(v,c){c.translation&&v.translate(c.translation[0],c.translation[1]),Ct(c.rotation)||v.rotate(c.rotation),c.color&&(v.fillStyle=c.color),c.textAlign&&(v.textAlign=c.textAlign),c.textBaseline&&(v.textBaseline=c.textBaseline)}(v,g),k=0;k<b.length;++k)H=b[k],w&&(g.strokeColor&&(v.strokeStyle=g.strokeColor),Ct(g.strokeWidth)||(v.lineWidth=g.strokeWidth),v.strokeText(H,s,l,g.maxWidth)),v.fillText(H,s,l,g.maxWidth),nl(v,s,l,H,g),l+=u.lineHeight;v.restore()}function nl(v,c,s,l,u){if(u.strikethrough||u.underline){const g=v.measureText(l),b=c-g.actualBoundingBoxLeft,w=c+g.actualBoundingBoxRight,k=s-g.actualBoundingBoxAscent,H=s+g.actualBoundingBoxDescent,Z=u.strikethrough?(k+H)/2:H;v.strokeStyle=v.fillStyle,v.beginPath(),v.lineWidth=u.decorationWidth||2,v.moveTo(b,Z),v.lineTo(w,Z),v.stroke()}}function Va(v,c){const{x:s,y:l,w:u,h:g,radius:b}=c;v.arc(s+b.topLeft,l+b.topLeft,b.topLeft,-Ee,he,!0),v.lineTo(s,l+g-b.bottomLeft),v.arc(s+b.bottomLeft,l+g-b.bottomLeft,b.bottomLeft,he,Ee,!0),v.lineTo(s+u-b.bottomRight,l+g),v.arc(s+u-b.bottomRight,l+g-b.bottomRight,b.bottomRight,Ee,0,!0),v.lineTo(s+u,l+b.topRight),v.arc(s+u-b.topRight,l+b.topRight,b.topRight,0,-Ee,!0),v.lineTo(s+b.topLeft,l)}const Ys=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),ol=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function Xs(v,c){const s=(""+v).match(Ys);if(!s||"normal"===s[1])return 1.2*c;switch(v=+s[2],s[3]){case"px":return v;case"%":v/=100}return c*v}const ts=v=>+v||0;function rl(v,c){const s={},l=at(c),u=l?Object.keys(c):c,g=at(v)?l?b=>Ft(v[b],v[c[b]]):b=>v[b]:()=>v;for(const b of u)s[b]=ts(g(b));return s}function Ga(v){return rl(v,{top:"y",right:"x",bottom:"y",left:"x"})}function es(v){return rl(v,["topLeft","topRight","bottomLeft","bottomRight"])}function Go(v){const c=Ga(v);return c.width=c.left+c.right,c.height=c.top+c.bottom,c}function Bo(v,c){let s=Ft((v=v||{}).size,(c=c||uo.font).size);"string"==typeof s&&(s=parseInt(s,10));let l=Ft(v.style,c.style);l&&!(""+l).match(ol)&&(console.warn('Invalid font style specified: "'+l+'"'),l="");const u={family:Ft(v.family,c.family),lineHeight:Xs(Ft(v.lineHeight,c.lineHeight),s),size:s,style:l,weight:Ft(v.weight,c.weight),string:""};return u.string=function Os(v){return!v||Ct(v.size)||Ct(v.family)?null:(v.style?v.style+" ":"")+(v.weight?v.weight+" ":"")+v.size+"px "+v.family}(u),u}function na(v,c,s,l){let g,b,w,u=!0;for(g=0,b=v.length;g<b;++g)if(w=v[g],void 0!==w&&(void 0!==c&&"function"==typeof w&&(w=w(c),u=!1),void 0!==s&&bt(w)&&(w=w[s%w.length],u=!1),void 0!==w))return l&&!u&&(l.cacheable=!1),w}function zr(v,c){return Object.assign(Object.create(v),c)}function oa(v,c,s){s=s||(b=>v[b]<c);let g,l=v.length-1,u=0;for(;l-u>1;)g=u+l>>1,s(g)?u=g:l=g;return{lo:u,hi:l}}const Br=(v,c,s)=>oa(v,s,l=>v[l][c]<s),pa=(v,c,s)=>oa(v,s,l=>v[l][c]>=s),tr=["push","pop","shift","splice","unshift"];function ar(v,c){const s=v._chartjs;if(!s)return;const l=s.listeners,u=l.indexOf(c);-1!==u&&l.splice(u,1),!(l.length>0)&&(tr.forEach(g=>{delete v[g]}),delete v._chartjs)}function As(v){const c=new Set;let s,l;for(s=0,l=v.length;s<l;++s)c.add(v[s]);return c.size===l?v:Array.from(c)}function Lo(v,c=[""],s=v,l,u=(()=>v[0])){Bt(l)||(l=Ot("_fallback",v));const g={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:v,_rootScopes:s,_fallback:l,_getTarget:u,override:b=>Lo([b,...v],c,s,l)};return new Proxy(g,{deleteProperty:(b,w)=>(delete b[w],delete b._keys,delete v[0][w],!0),get:(b,w)=>hs(b,w,()=>function j(v,c,s,l){let u;for(const g of c)if(u=Ot(Oa(g,v),s),Bt(u))return Wa(v,u)?kt(s,l,v,u):u}(w,c,v,b)),getOwnPropertyDescriptor:(b,w)=>Reflect.getOwnPropertyDescriptor(b._scopes[0],w),getPrototypeOf:()=>Reflect.getPrototypeOf(v[0]),has:(b,w)=>Be(b).includes(w),ownKeys:b=>Be(b),set(b,w,k){const H=b._storage||(b._storage=u());return b[w]=H[w]=k,delete b._keys,!0}})}function Cs(v,c,s,l){const u={_cacheable:!1,_proxy:v,_context:c,_subProxy:s,_stack:new Set,_descriptors:hr(v,l),setContext:g=>Cs(v,g,s,l),override:g=>Cs(v.override(g),c,s,l)};return new Proxy(u,{deleteProperty:(g,b)=>(delete g[b],delete v[b],!0),get:(g,b,w)=>hs(g,b,()=>function Jr(v,c,s){const{_proxy:l,_context:u,_subProxy:g,_descriptors:b}=v;let w=l[c];return Ie(w)&&b.isScriptable(c)&&(w=function ks(v,c,s,l){const{_proxy:u,_context:g,_subProxy:b,_stack:w}=s;if(w.has(v))throw new Error("Recursion detected: "+Array.from(w).join("->")+"->"+v);return w.add(v),c=c(g,b||l),w.delete(v),Wa(v,c)&&(c=kt(u._scopes,u,v,c)),c}(c,w,v,s)),bt(w)&&w.length&&(w=function pl(v,c,s,l){const{_proxy:u,_context:g,_subProxy:b,_descriptors:w}=s;if(Bt(g.index)&&l(v))c=c[g.index%c.length];else if(at(c[0])){const k=c,H=u._scopes.filter(Z=>Z!==k);c=[];for(const Z of k){const ht=kt(H,u,v,Z);c.push(Cs(ht,g,b&&b[v],w))}}return c}(c,w,v,b.isIndexable)),Wa(c,w)&&(w=Cs(w,u,g&&g[c],b)),w}(g,b,w)),getOwnPropertyDescriptor:(g,b)=>g._descriptors.allKeys?Reflect.has(v,b)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(v,b),getPrototypeOf:()=>Reflect.getPrototypeOf(v),has:(g,b)=>Reflect.has(v,b),ownKeys:()=>Reflect.ownKeys(v),set:(g,b,w)=>(v[b]=w,delete g[b],!0)})}function hr(v,c={scriptable:!0,indexable:!0}){const{_scriptable:s=c.scriptable,_indexable:l=c.indexable,_allKeys:u=c.allKeys}=v;return{allKeys:u,scriptable:s,indexable:l,isScriptable:Ie(s)?s:()=>s,isIndexable:Ie(l)?l:()=>l}}const Oa=(v,c)=>v?v+ri(c):c,Wa=(v,c)=>at(c)&&"adapters"!==v&&(null===Object.getPrototypeOf(c)||c.constructor===Object);function hs(v,c,s){if(Object.prototype.hasOwnProperty.call(v,c))return v[c];const l=s();return v[c]=l,l}function No(v,c,s){return Ie(v)?v(c,s):v}const Pn=(v,c)=>!0===v?c:"string"==typeof v?Me(c,v):void 0;function fa(v,c,s,l){for(const u of c){const g=Pn(s,u);if(g){v.add(g);const b=No(g._fallback,s,g);if(Bt(b)&&b!==s&&b!==l)return b}else if(!1===g&&Bt(l)&&s!==l)return null}return!1}function kt(v,c,s,l){const u=c._rootScopes,g=No(c._fallback,s,l),b=[...v,...u],w=new Set;w.add(l);let k=Q(w,b,s,g||s);return!(null===k||Bt(g)&&g!==s&&(k=Q(w,b,g,k),null===k))&&Lo(Array.from(w),[""],u,g,()=>function V(v,c,s){const l=v._getTarget();c in l||(l[c]={});const u=l[c];return bt(u)&&at(s)?s:u}(c,s,l))}function Q(v,c,s,l){for(;s;)s=fa(v,c,s,l);return s}function Ot(v,c){for(const s of c){if(!s)continue;const l=s[v];if(Bt(l))return l}}function Be(v){let c=v._keys;return c||(c=v._keys=function bi(v){const c=new Set;for(const s of v)for(const l of Object.keys(s).filter(u=>!u.startsWith("_")))c.add(l);return Array.from(c)}(v._scopes)),c}const un=Number.EPSILON||1e-14,Hn=(v,c)=>c<v.length&&!v[c].skip&&v[c],Po=v=>"x"===v?"y":"x";function Yo(v,c,s,l){const u=v.skip?c:v,g=c,b=s.skip?c:s,w=Ri(g,u),k=Ri(b,g);let H=w/(w+k),Z=k/(w+k);H=isNaN(H)?0:H,Z=isNaN(Z)?0:Z;const ht=l*H,Pt=l*Z;return{previous:{x:g.x-ht*(b.x-u.x),y:g.y-ht*(b.y-u.y)},next:{x:g.x+Pt*(b.x-u.x),y:g.y+Pt*(b.y-u.y)}}}function xr(v,c,s){return Math.max(Math.min(v,s),c)}function Ks(v,c,s,l,u){let g,b,w,k;if(c.spanGaps&&(v=v.filter(H=>!H.skip)),"monotone"===c.cubicInterpolationMode)!function fo(v,c="x"){const s=Po(c),l=v.length,u=Array(l).fill(0),g=Array(l);let b,w,k,H=Hn(v,0);for(b=0;b<l;++b)if(w=k,k=H,H=Hn(v,b+1),k){if(H){const Z=H[c]-k[c];u[b]=0!==Z?(H[s]-k[s])/Z:0}g[b]=w?H?le(u[b-1])!==le(u[b])?0:(u[b-1]+u[b])/2:u[b-1]:u[b]}(function Fo(v,c,s){const l=v.length;let u,g,b,w,k,H=Hn(v,0);for(let Z=0;Z<l-1;++Z)if(k=H,H=Hn(v,Z+1),k&&H){if(Zt(c[Z],0,un)){s[Z]=s[Z+1]=0;continue}u=s[Z]/c[Z],g=s[Z+1]/c[Z],w=Math.pow(u,2)+Math.pow(g,2),!(w<=9)&&(b=3/Math.sqrt(w),s[Z]=u*b*c[Z],s[Z+1]=g*b*c[Z])}})(v,u,g),function er(v,c,s="x"){const l=Po(s),u=v.length;let g,b,w,k=Hn(v,0);for(let H=0;H<u;++H){if(b=w,w=k,k=Hn(v,H+1),!w)continue;const Z=w[s],ht=w[l];b&&(g=(Z-b[s])/3,w[`cp1${s}`]=Z-g,w[`cp1${l}`]=ht-g*c[H]),k&&(g=(k[s]-Z)/3,w[`cp2${s}`]=Z+g,w[`cp2${l}`]=ht+g*c[H])}}(v,g,c)}(v,u);else{let H=l?v[v.length-1]:v[0];for(g=0,b=v.length;g<b;++g)w=v[g],k=Yo(H,w,v[Math.min(g+1,b-(l?0:1))%b],c.tension),w.cp1x=k.previous.x,w.cp1y=k.previous.y,w.cp2x=k.next.x,w.cp2y=k.next.y,H=w}c.capBezierPoints&&function Jn(v,c){let s,l,u,g,b,w=us(v[0],c);for(s=0,l=v.length;s<l;++s)b=g,g=w,w=s<l-1&&us(v[s+1],c),g&&(u=v[s],b&&(u.cp1x=xr(u.cp1x,c.left,c.right),u.cp1y=xr(u.cp1y,c.top,c.bottom)),w&&(u.cp2x=xr(u.cp2x,c.left,c.right),u.cp2y=xr(u.cp2y,c.top,c.bottom)))}(v,s)}function sl(){return"undefined"!=typeof window&&"undefined"!=typeof document}function $r(v){let c=v.parentNode;return c&&"[object ShadowRoot]"===c.toString()&&(c=c.host),c}function za(v,c,s){let l;return"string"==typeof v?(l=parseInt(v,10),-1!==v.indexOf("%")&&(l=l/100*c.parentNode[s])):l=v,l}const xs=v=>window.getComputedStyle(v,null),yc=["top","right","bottom","left"];function Xi(v,c,s){const l={};s=s?"-"+s:"";for(let u=0;u<4;u++){const g=yc[u];l[g]=parseFloat(v[c+"-"+g+s])||0}return l.width=l.left+l.right,l.height=l.top+l.bottom,l}function z(v,c){const{canvas:s,currentDevicePixelRatio:l}=c,u=xs(s),g="border-box"===u.boxSizing,b=Xi(u,"padding"),w=Xi(u,"border","width"),{x:k,y:H,box:Z}=function ie(v,c){const s=v.native||v,l=s.touches,u=l&&l.length?l[0]:s,{offsetX:g,offsetY:b}=u;let k,H,w=!1;if(((v,c,s)=>(v>0||c>0)&&(!s||!s.shadowRoot))(g,b,s.target))k=g,H=b;else{const Z=c.getBoundingClientRect();k=u.clientX-Z.left,H=u.clientY-Z.top,w=!0}return{x:k,y:H,box:w}}(v,s),ht=b.left+(Z&&w.left),Pt=b.top+(Z&&w.top);let{width:qt,height:be}=c;return g&&(qt-=b.width+w.width,be-=b.height+w.height),{x:Math.round((k-ht)/qt*s.width/l),y:Math.round((H-Pt)/be*s.height/l)}}const _t=v=>Math.round(10*v)/10;function Te(v,c,s){const l=c||1,u=Math.floor(v.height*l),g=Math.floor(v.width*l);v.height=u/l,v.width=g/l;const b=v.canvas;return b.style&&(s||!b.style.height&&!b.style.width)&&(b.style.height=`${v.height}px`,b.style.width=`${v.width}px`),(v.currentDevicePixelRatio!==l||b.height!==u||b.width!==g)&&(v.currentDevicePixelRatio=l,b.height=u,b.width=g,v.ctx.setTransform(l,0,0,l,0,0),!0)}const Ye=function(){let v=!1;try{const c={get passive(){return v=!0,!1}};window.addEventListener("test",null,c),window.removeEventListener("test",null,c)}catch(c){}return v}();function Qe(v,c){const s=function Ta(v,c){return xs(v).getPropertyValue(c)}(v,c),l=s&&s.match(/^(\d+)(\.\d+)?px$/);return l?+l[1]:void 0}function mi(v,c,s,l){return{x:v.x+s*(c.x-v.x),y:v.y+s*(c.y-v.y)}}function Ui(v,c,s,l){return{x:v.x+s*(c.x-v.x),y:"middle"===l?s<.5?v.y:c.y:"after"===l?s<1?v.y:c.y:s>0?c.y:v.y}}function hn(v,c,s,l){const u={x:v.cp2x,y:v.cp2y},g={x:c.cp1x,y:c.cp1y},b=mi(v,u,s),w=mi(u,g,s),k=mi(g,c,s),H=mi(b,w,s),Z=mi(w,k,s);return mi(H,Z,s)}const Tn=new Map;function po(v,c,s){return function $n(v,c){c=c||{};const s=v+JSON.stringify(c);let l=Tn.get(s);return l||(l=new Intl.NumberFormat(v,c),Tn.set(s,l)),l}(c,s).format(v)}function oo(v,c,s){return v?function(v,c){return{x:s=>v+v+c-s,setWidth(s){c=s},textAlign:s=>"center"===s?s:"right"===s?"left":"right",xPlus:(s,l)=>s-l,leftForLtr:(s,l)=>s-l}}(c,s):{x:v=>v,setWidth(v){},textAlign:v=>v,xPlus:(v,c)=>v+c,leftForLtr:(v,c)=>v}}function Ko(v,c){let s,l;("ltr"===c||"rtl"===c)&&(s=v.canvas.style,l=[s.getPropertyValue("direction"),s.getPropertyPriority("direction")],s.setProperty("direction",c,"important"),v.prevTextDirection=l)}function dr(v,c){void 0!==c&&(delete v.prevTextDirection,v.canvas.style.setProperty("direction",c[0],c[1]))}function is(v){return"angle"===v?{between:De,compare:rn,normalize:ge}:{between:Fi,compare:(c,s)=>c-s,normalize:c=>c}}function Hr({start:v,end:c,count:s,loop:l,style:u}){return{start:v%s,end:c%s,loop:l&&(c-v+1)%s==0,style:u}}function ds(v,c,s){if(!s)return[v];const{property:l,start:u,end:g}=s,b=c.length,{compare:w,between:k,normalize:H}=is(l),{start:Z,end:ht,loop:Pt,style:qt}=function Ls(v,c,s){const{property:l,start:u,end:g}=s,{between:b,normalize:w}=is(l),k=c.length;let Pt,qt,{start:H,end:Z,loop:ht}=v;if(ht){for(H+=k,Z+=k,Pt=0,qt=k;Pt<qt&&b(w(c[H%k][l]),u,g);++Pt)H--,Z--;H%=k,Z%=k}return Z<H&&(Z+=k),{start:H,end:Z,loop:ht,style:v.style}}(v,c,s),be=[];let Xe,Ei,an,Le=!1,Ge=null;for(let An=Z,Bn=Z;An<=ht;++An)Ei=c[An%b],!Ei.skip&&(Xe=H(Ei[l]),Xe!==an&&(Le=k(Xe,u,g),null===Ge&&(Le||k(u,an,Xe)&&0!==w(u,an))&&(Ge=0===w(Xe,u)?An:Bn),null!==Ge&&(!Le||0===w(g,Xe)||k(g,an,Xe))&&(be.push(Hr({start:Ge,end:An,loop:Pt,count:b,style:qt})),Ge=null),Bn=An,an=Xe));return null!==Ge&&be.push(Hr({start:Ge,end:ht,loop:Pt,count:b,style:qt})),be}function Sr(v,c){const s=[],l=v.segments;for(let u=0;u<l.length;u++){const g=ds(l[u],v.points,c);g.length&&s.push(...g)}return s}function Qs(v){return{backgroundColor:v.backgroundColor,borderCapStyle:v.borderCapStyle,borderDash:v.borderDash,borderDashOffset:v.borderDashOffset,borderJoinStyle:v.borderJoinStyle,borderWidth:v.borderWidth,borderColor:v.borderColor}}function ja(v,c){return c&&JSON.stringify(v)!==JSON.stringify(c)}var Sn=new class ps{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(c,s,l,u){const b=s.duration;s.listeners[u].forEach(w=>w({chart:c,initial:s.initial,numSteps:b,currentStep:Math.min(l-s.start,b)}))}_refresh(){this._request||(this._running=!0,this._request=nt.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(c=Date.now()){let s=0;this._charts.forEach((l,u)=>{if(!l.running||!l.items.length)return;const g=l.items;let k,b=g.length-1,w=!1;for(;b>=0;--b)k=g[b],k._active?(k._total>l.duration&&(l.duration=k._total),k.tick(c),w=!0):(g[b]=g[g.length-1],g.pop());w&&(u.draw(),this._notify(u,l,c,"progress")),g.length||(l.running=!1,this._notify(u,l,c,"complete"),l.initial=!1),s+=g.length}),this._lastDate=c,0===s&&(this._running=!1)}_getAnims(c){const s=this._charts;let l=s.get(c);return l||(l={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},s.set(c,l)),l}listen(c,s,l){this._getAnims(c).listeners[s].push(l)}add(c,s){!s||!s.length||this._getAnims(c).items.push(...s)}has(c){return this._getAnims(c).items.length>0}start(c){const s=this._charts.get(c);!s||(s.running=!0,s.start=Date.now(),s.duration=s.items.reduce((l,u)=>Math.max(l,u._duration),0),this._refresh())}running(c){if(!this._running)return!1;const s=this._charts.get(c);return!(!s||!s.running||!s.items.length)}stop(c){const s=this._charts.get(c);if(!s||!s.items.length)return;const l=s.items;let u=l.length-1;for(;u>=0;--u)l[u].cancel();s.items=[],this._notify(c,s,Date.now(),"complete")}remove(c){return this._charts.delete(c)}};const Xn="transparent",Nn={boolean:(v,c,s)=>s>.5?c:v,color(v,c,s){const l=ao(v||Xn),u=l.valid&&ao(c||Xn);return u&&u.valid?u.mix(l,s).hexString():c},number:(v,c,s)=>v+(c-v)*s};class bo{constructor(c,s,l,u){const g=s[l];u=na([c.to,u,g,c.from]);const b=na([c.from,g,u]);this._active=!0,this._fn=c.fn||Nn[c.type||typeof b],this._easing=Ce[c.easing]||Ce.linear,this._start=Math.floor(Date.now()+(c.delay||0)),this._duration=this._total=Math.floor(c.duration),this._loop=!!c.loop,this._target=s,this._prop=l,this._from=b,this._to=u,this._promises=void 0}active(){return this._active}update(c,s,l){if(this._active){this._notify(!1);const u=this._target[this._prop],g=l-this._start,b=this._duration-g;this._start=l,this._duration=Math.floor(Math.max(b,c.duration)),this._total+=g,this._loop=!!c.loop,this._to=na([c.to,s,u,c.from]),this._from=na([c.from,u,s])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(c){const s=c-this._start,l=this._duration,u=this._prop,g=this._from,b=this._loop,w=this._to;let k;if(this._active=g!==w&&(b||s<l),!this._active)return this._target[u]=w,void this._notify(!0);s<0?this._target[u]=g:(k=s/l%2,k=b&&k>1?2-k:k,k=this._easing(Math.min(1,Math.max(0,k))),this._target[u]=this._fn(g,w,k))}wait(){const c=this._promises||(this._promises=[]);return new Promise((s,l)=>{c.push({res:s,rej:l})})}_notify(c){const s=c?"res":"rej",l=this._promises||[];for(let u=0;u<l.length;u++)l[u][s]()}}uo.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const Ps=Object.keys(uo.animation);uo.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:v=>"onProgress"!==v&&"onComplete"!==v&&"fn"!==v}),uo.set("animations",{colors:{type:"color",properties:["color","borderColor","backgroundColor"]},numbers:{type:"number",properties:["x","y","borderWidth","radius","tension"]}}),uo.describe("animations",{_fallback:"animation"}),uo.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:v=>0|v}}}});class ra{constructor(c,s){this._chart=c,this._properties=new Map,this.configure(s)}configure(c){if(!at(c))return;const s=this._properties;Object.getOwnPropertyNames(c).forEach(l=>{const u=c[l];if(!at(u))return;const g={};for(const b of Ps)g[b]=u[b];(bt(u.properties)&&u.properties||[l]).forEach(b=>{(b===l||!s.has(b))&&s.set(b,g)})})}_animateOptions(c,s){const l=s.options,u=function Lr(v,c){if(!c)return;let s=v.options;if(s)return s.$shared&&(v.options=s=Object.assign({},s,{$shared:!1,$animations:{}})),s;v.options=c}(c,l);if(!u)return[];const g=this._createAnimations(u,l);return l.$shared&&function lr(v,c){const s=[],l=Object.keys(c);for(let u=0;u<l.length;u++){const g=v[l[u]];g&&g.active()&&s.push(g.wait())}return Promise.all(s)}(c.options.$animations,l).then(()=>{c.options=l},()=>{}),g}_createAnimations(c,s){const l=this._properties,u=[],g=c.$animations||(c.$animations={}),b=Object.keys(s),w=Date.now();let k;for(k=b.length-1;k>=0;--k){const H=b[k];if("$"===H.charAt(0))continue;if("options"===H){u.push(...this._animateOptions(c,s));continue}const Z=s[H];let ht=g[H];const Pt=l.get(H);if(ht){if(Pt&&ht.active()){ht.update(Pt,Z,w);continue}ht.cancel()}Pt&&Pt.duration?(g[H]=ht=new bo(Pt,c,H,Z),u.push(ht)):c[H]=Z}return u}update(c,s){if(0===this._properties.size)return void Object.assign(c,s);const l=this._createAnimations(c,s);return l.length?(Sn.add(this._chart,l),!0):void 0}}function ns(v,c){const s=v&&v.options||{},l=s.reverse,u=void 0===s.min?c:0,g=void 0===s.max?c:0;return{start:l?g:u,end:l?u:g}}function jr(v,c){const s=[],l=v._getSortedDatasetMetas(c);let u,g;for(u=0,g=l.length;u<g;++u)s.push(l[u].index);return s}function Fs(v,c,s,l={}){const u=v.keys,g="single"===l.mode;let b,w,k,H;if(null!==c){for(b=0,w=u.length;b<w;++b){if(k=+u[b],k===s){if(l.all)continue;break}H=v.values[k],ft(H)&&(g||0===c||le(c)===le(H))&&(c+=H)}return c}}function al(v,c){const s=v&&v.options.stacked;return s||void 0===s&&void 0!==c.stack}function sa(v,c,s){const l=v[c]||(v[c]={});return l[s]||(l[s]={})}function Ya(v,c,s,l){for(const u of c.getMatchingVisibleMetas(l).reverse()){const g=v[u.index];if(s&&g>0||!s&&g<0)return u.index}return null}function ka(v,c){const{chart:s,_cachedMeta:l}=v,u=s._stacks||(s._stacks={}),{iScale:g,vScale:b,index:w}=l,k=g.axis,H=b.axis,Z=function Bs(v,c,s){return`${v.id}.${c.id}.${s.stack||s.type}`}(g,b,l),ht=c.length;let Pt;for(let qt=0;qt<ht;++qt){const be=c[qt],{[k]:Le,[H]:Ge}=be;Pt=(be._stacks||(be._stacks={}))[H]=sa(u,Z,Le),Pt[w]=Ge,Pt._top=Ya(Pt,b,!0,l.type),Pt._bottom=Ya(Pt,b,!1,l.type)}}function Ql(v,c){const s=v.scales;return Object.keys(s).filter(l=>s[l].axis===c).shift()}function cl(v,c){const s=v.controller.index,l=v.vScale&&v.vScale.axis;if(l){c=c||v._parsed;for(const u of c){const g=u._stacks;if(!g||void 0===g[l]||void 0===g[l][s])return;delete g[l][s]}}}const fl=v=>"reset"===v||"none"===v,gl=(v,c)=>c?v:Object.assign({},v);let ga=(()=>{class v{constructor(s,l){this.chart=s,this._ctx=s.ctx,this.index=l,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const s=this._cachedMeta;this.configure(),this.linkScales(),s._stacked=al(s.vScale,s),this.addElements()}updateIndex(s){this.index!==s&&cl(this._cachedMeta),this.index=s}linkScales(){const s=this.chart,l=this._cachedMeta,u=this.getDataset(),g=(Pt,qt,be,Le)=>"x"===Pt?qt:"r"===Pt?Le:be,b=l.xAxisID=Ft(u.xAxisID,Ql(s,"x")),w=l.yAxisID=Ft(u.yAxisID,Ql(s,"y")),k=l.rAxisID=Ft(u.rAxisID,Ql(s,"r")),H=l.indexAxis,Z=l.iAxisID=g(H,b,w,k),ht=l.vAxisID=g(H,w,b,k);l.xScale=this.getScaleForId(b),l.yScale=this.getScaleForId(w),l.rScale=this.getScaleForId(k),l.iScale=this.getScaleForId(Z),l.vScale=this.getScaleForId(ht)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(s){return this.chart.scales[s]}_getOtherScale(s){const l=this._cachedMeta;return s===l.iScale?l.vScale:l.iScale}reset(){this._update("reset")}_destroy(){const s=this._cachedMeta;this._data&&ar(this._data,this),s._stacked&&cl(s)}_dataCheck(){const s=this.getDataset(),l=s.data||(s.data=[]),u=this._data;if(at(l))this._data=function Zl(v){const c=Object.keys(v),s=new Array(c.length);let l,u,g;for(l=0,u=c.length;l<u;++l)g=c[l],s[l]={x:g,y:v[g]};return s}(l);else if(u!==l){if(u){ar(u,this);const g=this._cachedMeta;cl(g),g._parsed=[]}l&&Object.isExtensible(l)&&function Es(v,c){v._chartjs?v._chartjs.listeners.push(c):(Object.defineProperty(v,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[c]}}),tr.forEach(s=>{const l="_onData"+ri(s),u=v[s];Object.defineProperty(v,s,{configurable:!0,enumerable:!1,value(...g){const b=u.apply(this,g);return v._chartjs.listeners.forEach(w=>{"function"==typeof w[l]&&w[l](...g)}),b}})}))}(l,this),this._syncList=[],this._data=l}}addElements(){const s=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(s.dataset=new this.datasetElementType)}buildOrUpdateElements(s){const l=this._cachedMeta,u=this.getDataset();let g=!1;this._dataCheck();const b=l._stacked;l._stacked=al(l.vScale,l),l.stack!==u.stack&&(g=!0,cl(l),l.stack=u.stack),this._resyncElements(s),(g||b!==l._stacked)&&ka(this,l._parsed)}configure(){const s=this.chart.config,l=s.datasetScopeKeys(this._type),u=s.getOptionScopes(this.getDataset(),l,!0);this.options=s.createResolver(u,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(s,l){const{_cachedMeta:u,_data:g}=this,{iScale:b,_stacked:w}=u,k=b.axis;let ht,Pt,qt,H=0===s&&l===g.length||u._sorted,Z=s>0&&u._parsed[s-1];if(!1===this._parsing)u._parsed=g,u._sorted=!0,qt=g;else{qt=bt(g[s])?this.parseArrayData(u,g,s,l):at(g[s])?this.parseObjectData(u,g,s,l):this.parsePrimitiveData(u,g,s,l);const be=()=>null===Pt[k]||Z&&Pt[k]<Z[k];for(ht=0;ht<l;++ht)u._parsed[ht+s]=Pt=qt[ht],H&&(be()&&(H=!1),Z=Pt);u._sorted=H}w&&ka(this,qt)}parsePrimitiveData(s,l,u,g){const{iScale:b,vScale:w}=s,k=b.axis,H=w.axis,Z=b.getLabels(),ht=b===w,Pt=new Array(g);let qt,be,Le;for(qt=0,be=g;qt<be;++qt)Le=qt+u,Pt[qt]={[k]:ht||b.parse(Z[Le],Le),[H]:w.parse(l[Le],Le)};return Pt}parseArrayData(s,l,u,g){const{xScale:b,yScale:w}=s,k=new Array(g);let H,Z,ht,Pt;for(H=0,Z=g;H<Z;++H)ht=H+u,Pt=l[ht],k[H]={x:b.parse(Pt[0],ht),y:w.parse(Pt[1],ht)};return k}parseObjectData(s,l,u,g){const{xScale:b,yScale:w}=s,{xAxisKey:k="x",yAxisKey:H="y"}=this._parsing,Z=new Array(g);let ht,Pt,qt,be;for(ht=0,Pt=g;ht<Pt;++ht)qt=ht+u,be=l[qt],Z[ht]={x:b.parse(Me(be,k),qt),y:w.parse(Me(be,H),qt)};return Z}getParsed(s){return this._cachedMeta._parsed[s]}getDataElement(s){return this._cachedMeta.data[s]}applyStack(s,l,u){const b=this._cachedMeta,w=l[s.axis];return Fs({keys:jr(this.chart,!0),values:l._stacks[s.axis]},w,b.index,{mode:u})}updateRangeFromParsed(s,l,u,g){const b=u[l.axis];let w=null===b?NaN:b;const k=g&&u._stacks[l.axis];g&&k&&(g.values=k,w=Fs(g,b,this._cachedMeta.index)),s.min=Math.min(s.min,w),s.max=Math.max(s.max,w)}getMinMax(s,l){const u=this._cachedMeta,g=u._parsed,b=u._sorted&&s===u.iScale,w=g.length,k=this._getOtherScale(s),H=((v,c,s)=>v&&!c.hidden&&c._stacked&&{keys:jr(this.chart,!0),values:null})(l,u),Z={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:ht,max:Pt}=function Zr(v){const{min:c,max:s,minDefined:l,maxDefined:u}=v.getUserBounds();return{min:l?c:Number.NEGATIVE_INFINITY,max:u?s:Number.POSITIVE_INFINITY}}(k);let qt,be;function Le(){be=g[qt];const Ge=be[k.axis];return!ft(be[s.axis])||ht>Ge||Pt<Ge}for(qt=0;qt<w&&(Le()||(this.updateRangeFromParsed(Z,s,be,H),!b));++qt);if(b)for(qt=w-1;qt>=0;--qt)if(!Le()){this.updateRangeFromParsed(Z,s,be,H);break}return Z}getAllParsedValues(s){const l=this._cachedMeta._parsed,u=[];let g,b,w;for(g=0,b=l.length;g<b;++g)w=l[g][s.axis],ft(w)&&u.push(w);return u}getMaxOverflow(){return!1}getLabelAndValue(s){const l=this._cachedMeta,u=l.iScale,g=l.vScale,b=this.getParsed(s);return{label:u?""+u.getLabelForValue(b[u.axis]):"",value:g?""+g.getLabelForValue(b[g.axis]):""}}_update(s){const l=this._cachedMeta;this.update(s||"default"),l._clip=function ba(v){let c,s,l,u;return at(v)?(c=v.top,s=v.right,l=v.bottom,u=v.left):c=s=l=u=v,{top:c,right:s,bottom:l,left:u,disabled:!1===v}}(Ft(this.options.clip,function Ss(v,c,s){if(!1===s)return!1;const l=ns(v,s),u=ns(c,s);return{top:u.end,right:l.end,bottom:u.start,left:l.start}}(l.xScale,l.yScale,this.getMaxOverflow())))}update(s){}draw(){const s=this._ctx,u=this._cachedMeta,g=u.data||[],b=this.chart.chartArea,w=[],k=this._drawStart||0,H=this._drawCount||g.length-k;let Z;for(u.dataset&&u.dataset.draw(s,b,k,H),Z=k;Z<k+H;++Z){const ht=g[Z];ht.hidden||(ht.active?w.push(ht):ht.draw(s,b))}for(Z=0;Z<w.length;++Z)w[Z].draw(s,b)}getStyle(s,l){const u=l?"active":"default";return void 0===s&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(u):this.resolveDataElementOptions(s||0,u)}getContext(s,l,u){const g=this.getDataset();let b;if(s>=0&&s<this._cachedMeta.data.length){const w=this._cachedMeta.data[s];b=w.$context||(w.$context=function Ul(v,c,s){return zr(v,{active:!1,dataIndex:c,parsed:void 0,raw:void 0,element:s,index:c,mode:"default",type:"data"})}(this.getContext(),s,w)),b.parsed=this.getParsed(s),b.raw=g.data[s],b.index=b.dataIndex=s}else b=this.$context||(this.$context=function ll(v,c){return zr(v,{active:!1,dataset:void 0,datasetIndex:c,index:c,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),b.dataset=g,b.index=b.datasetIndex=this.index;return b.active=!!l,b.mode=u,b}resolveDatasetElementOptions(s){return this._resolveElementOptions(this.datasetElementType.id,s)}resolveDataElementOptions(s,l){return this._resolveElementOptions(this.dataElementType.id,l,s)}_resolveElementOptions(s,l="default",u){const g="active"===l,b=this._cachedDataOpts,w=s+"-"+l,k=b[w],H=this.enableOptionSharing&&Bt(u);if(k)return gl(k,H);const Z=this.chart.config,ht=Z.datasetElementScopeKeys(this._type,s),Pt=g?[`${s}Hover`,"hover",s,""]:[s,""],qt=Z.getOptionScopes(this.getDataset(),ht),be=Object.keys(uo.elements[s]),Ge=Z.resolveNamedOptions(qt,be,()=>this.getContext(u,g),Pt);return Ge.$shared&&(Ge.$shared=H,b[w]=Object.freeze(gl(Ge,H))),Ge}_resolveAnimations(s,l,u){const g=this.chart,b=this._cachedDataOpts,w=`animation-${l}`,k=b[w];if(k)return k;let H;if(!1!==g.options.animation){const ht=this.chart.config,Pt=ht.datasetAnimationScopeKeys(this._type,l),qt=ht.getOptionScopes(this.getDataset(),Pt);H=ht.createResolver(qt,this.getContext(s,u,l))}const Z=new ra(g,H&&H.animations);return H&&H._cacheable&&(b[w]=Object.freeze(Z)),Z}getSharedOptions(s){if(s.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},s))}includeOptions(s,l){return!l||fl(s)||this.chart._animationsDisabled}updateElement(s,l,u,g){fl(g)?Object.assign(s,u):this._resolveAnimations(l,g).update(s,u)}updateSharedOptions(s,l,u){s&&!fl(l)&&this._resolveAnimations(void 0,l).update(s,u)}_setStyle(s,l,u,g){s.active=g;const b=this.getStyle(l,g);this._resolveAnimations(l,u,g).update(s,{options:!g&&this.getSharedOptions(b)||b})}removeHoverStyle(s,l,u){this._setStyle(s,u,"active",!1)}setHoverStyle(s,l,u){this._setStyle(s,u,"active",!0)}_removeDatasetHoverStyle(){const s=this._cachedMeta.dataset;s&&this._setStyle(s,void 0,"active",!1)}_setDatasetHoverStyle(){const s=this._cachedMeta.dataset;s&&this._setStyle(s,void 0,"active",!0)}_resyncElements(s){const l=this._data,u=this._cachedMeta.data;for(const[k,H,Z]of this._syncList)this[k](H,Z);this._syncList=[];const g=u.length,b=l.length,w=Math.min(b,g);w&&this.parse(0,w),b>g?this._insertElements(g,b-g,s):b<g&&this._removeElements(b,g-b)}_insertElements(s,l,u=!0){const g=this._cachedMeta,b=g.data,w=s+l;let k;const H=Z=>{for(Z.length+=l,k=Z.length-1;k>=w;k--)Z[k]=Z[k-l]};for(H(b),k=s;k<w;++k)b[k]=new this.dataElementType;this._parsing&&H(g._parsed),this.parse(s,l),u&&this.updateElements(b,s,l,"reset")}updateElements(s,l,u,g){}_removeElements(s,l){const u=this._cachedMeta;if(this._parsing){const g=u._parsed.splice(s,l);u._stacked&&cl(u,g)}u.data.splice(s,l)}_sync(s){if(this._parsing)this._syncList.push(s);else{const[l,u,g]=s;this[l](u,g)}this.chart._dataChanges.push([this.index,...s])}_onDataPush(){const s=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-s,s])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(s,l){l&&this._sync(["_removeElements",s,l]);const u=arguments.length-2;u&&this._sync(["_insertElements",s,u])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return v.defaults={},v})();function Xa(v){const c=v.iScale,s=function ql(v,c){if(!v._cache.$bar){const s=v.getMatchingVisibleMetas(c);let l=[];for(let u=0,g=s.length;u<g;u++)l=l.concat(s[u].controller.getAllParsedValues(v));v._cache.$bar=As(l.sort((u,g)=>u-g))}return v._cache.$bar}(c,v.type);let u,g,b,w,l=c._length;const k=()=>{32767===b||-32768===b||(Bt(w)&&(l=Math.min(l,Math.abs(b-w)||l)),w=b)};for(u=0,g=s.length;u<g;++u)b=c.getPixelForValue(s[u]),k();for(w=void 0,u=0,g=c.ticks.length;u<g;++u)b=c.getPixelForTick(u),k();return l}function Ea(v,c,s,l){return bt(v)?function Hs(v,c,s,l){const u=s.parse(v[0],l),g=s.parse(v[1],l),b=Math.min(u,g),w=Math.max(u,g);let k=b,H=w;Math.abs(b)>Math.abs(w)&&(k=w,H=b),c[s.axis]=H,c._custom={barStart:k,barEnd:H,start:u,end:g,min:b,max:w}}(v,c,s,l):c[s.axis]=s.parse(v,l),c}function Cl(v,c,s,l){const u=v.iScale,g=v.vScale,b=u.getLabels(),w=u===g,k=[];let H,Z,ht,Pt;for(H=s,Z=s+l;H<Z;++H)Pt=c[H],ht={},ht[u.axis]=w||u.parse(b[H],H),k.push(Ea(Pt,ht,g,H));return k}function tc(v){return v&&void 0!==v.barStart&&void 0!==v.barEnd}function Bc(v,c,s,l){let u=c.borderSkipped;const g={};if(!u)return void(v.borderSkipped=g);const{start:b,end:w,reverse:k,top:H,bottom:Z}=function Tc(v){let c,s,l,u,g;return v.horizontal?(c=v.base>v.x,s="left",l="right"):(c=v.base<v.y,s="bottom",l="top"),c?(u="end",g="start"):(u="start",g="end"),{start:s,end:l,reverse:c,top:u,bottom:g}}(v);"middle"===u&&s&&(v.enableBorderRadius=!0,(s._top||0)===l?u=H:(s._bottom||0)===l?u=Z:(g[dt(Z,b,w,k)]=!0,u=H)),g[dt(u,b,w,k)]=!0,v.borderSkipped=g}function dt(v,c,s,l){return l?(v=function ot(v,c,s){return v===c?s:v===s?c:v}(v,c,s),v=q(v,s,c)):v=q(v,c,s),v}function q(v,c,s){return"start"===v?c:"end"===v?s:v}function At(v,{inflateAmount:c},s){v.inflateAmount="auto"===c?1===s?.33:0:c}ga.prototype.datasetElementType=null,ga.prototype.dataElementType=null;let Wt=(()=>{class v extends ga{parsePrimitiveData(s,l,u,g){return Cl(s,l,u,g)}parseArrayData(s,l,u,g){return Cl(s,l,u,g)}parseObjectData(s,l,u,g){const{iScale:b,vScale:w}=s,{xAxisKey:k="x",yAxisKey:H="y"}=this._parsing,Z="x"===b.axis?k:H,ht="x"===w.axis?k:H,Pt=[];let qt,be,Le,Ge;for(qt=u,be=u+g;qt<be;++qt)Ge=l[qt],Le={},Le[b.axis]=b.parse(Me(Ge,Z),qt),Pt.push(Ea(Me(Ge,ht),Le,w,qt));return Pt}updateRangeFromParsed(s,l,u,g){super.updateRangeFromParsed(s,l,u,g);const b=u._custom;b&&l===this._cachedMeta.vScale&&(s.min=Math.min(s.min,b.min),s.max=Math.max(s.max,b.max))}getMaxOverflow(){return 0}getLabelAndValue(s){const l=this._cachedMeta,{iScale:u,vScale:g}=l,b=this.getParsed(s),w=b._custom,k=tc(w)?"["+w.start+", "+w.end+"]":""+g.getLabelForValue(b[g.axis]);return{label:""+u.getLabelForValue(b[u.axis]),value:k}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(s){const l=this._cachedMeta;this.updateElements(l.data,0,l.data.length,s)}updateElements(s,l,u,g){const b="reset"===g,{index:w,_cachedMeta:{vScale:k}}=this,H=k.getBasePixel(),Z=k.isHorizontal(),ht=this._getRuler(),Pt=this.resolveDataElementOptions(l,g),qt=this.getSharedOptions(Pt),be=this.includeOptions(g,qt);this.updateSharedOptions(qt,g,Pt);for(let Le=l;Le<l+u;Le++){const Ge=this.getParsed(Le),Xe=b||Ct(Ge[k.axis])?{base:H,head:H}:this._calculateBarValuePixels(Le),Ei=this._calculateBarIndexPixels(Le,ht),an=(Ge._stacks||{})[k.axis],Hi={horizontal:Z,base:Xe.base,enableBorderRadius:!an||tc(Ge._custom)||w===an._top||w===an._bottom,x:Z?Xe.head:Ei.center,y:Z?Ei.center:Xe.head,height:Z?Ei.size:Math.abs(Xe.size),width:Z?Math.abs(Xe.size):Ei.size};be&&(Hi.options=qt||this.resolveDataElementOptions(Le,s[Le].active?"active":g));const Wi=Hi.options||s[Le].options;Bc(Hi,Wi,an,w),At(Hi,Wi,ht.ratio),this.updateElement(s[Le],Le,Hi,g)}}_getStacks(s,l){const g=this._cachedMeta.iScale,b=g.getMatchingVisibleMetas(this._type),w=g.options.stacked,k=b.length,H=[];let Z,ht;for(Z=0;Z<k;++Z)if(ht=b[Z],ht.controller.options.grouped){if(void 0!==l){const Pt=ht.controller.getParsed(l)[ht.controller._cachedMeta.vScale.axis];if(Ct(Pt)||isNaN(Pt))continue}if((!1===w||-1===H.indexOf(ht.stack)||void 0===w&&void 0===ht.stack)&&H.push(ht.stack),ht.index===s)break}return H.length||H.push(void 0),H}_getStackCount(s){return this._getStacks(void 0,s).length}_getStackIndex(s,l,u){const g=this._getStacks(s,u),b=void 0!==l?g.indexOf(l):-1;return-1===b?g.length-1:b}_getRuler(){const s=this.options,l=this._cachedMeta,u=l.iScale,g=[];let b,w;for(b=0,w=l.data.length;b<w;++b)g.push(u.getPixelForValue(this.getParsed(b)[u.axis],b));const k=s.barThickness;return{min:k||Xa(l),pixels:g,start:u._startPixel,end:u._endPixel,stackCount:this._getStackCount(),scale:u,grouped:s.grouped,ratio:k?1:s.categoryPercentage*s.barPercentage}}_calculateBarValuePixels(s){const{_cachedMeta:{vScale:l,_stacked:u},options:{base:g,minBarLength:b}}=this,w=g||0,k=this.getParsed(s),H=k._custom,Z=tc(H);let be,Le,ht=k[l.axis],Pt=0,qt=u?this.applyStack(l,k,u):ht;qt!==ht&&(Pt=qt-ht,qt=ht),Z&&(ht=H.barStart,qt=H.barEnd-H.barStart,0!==ht&&le(ht)!==le(H.barEnd)&&(Pt=0),Pt+=ht);const Ge=Ct(g)||Z?Pt:g;let Xe=l.getPixelForValue(Ge);if(be=this.chart.getDataVisibility(s)?l.getPixelForValue(Pt+qt):Xe,Le=be-Xe,Math.abs(Le)<b&&(Le=function sc(v,c,s){return 0!==v?le(v):(c.isHorizontal()?1:-1)*(c.min>=s?1:-1)}(Le,l,w)*b,ht===w&&(Xe-=Le/2),be=Xe+Le),Xe===l.getPixelForValue(w)){const Ei=le(Le)*l.getLineWidthForValue(w)/2;Xe+=Ei,Le-=Ei}return{size:Le,base:Xe,head:be,center:be+Le/2}}_calculateBarIndexPixels(s,l){const u=l.scale,g=this.options,b=g.skipNull,w=Ft(g.maxBarThickness,1/0);let k,H;if(l.grouped){const Z=b?this._getStackCount(s):l.stackCount,ht="flex"===g.barThickness?function xa(v,c,s,l){const u=c.pixels,g=u[v];let b=v>0?u[v-1]:null,w=v<u.length-1?u[v+1]:null;const k=s.categoryPercentage;null===b&&(b=g-(null===w?c.end-c.start:w-g)),null===w&&(w=g+g-b);const H=g-(g-Math.min(b,w))/2*k;return{chunk:Math.abs(w-b)/2*k/l,ratio:s.barPercentage,start:H}}(s,l,g,Z):function qs(v,c,s,l){const u=s.barThickness;let g,b;return Ct(u)?(g=c.min*s.categoryPercentage,b=s.barPercentage):(g=u*l,b=1),{chunk:g/l,ratio:b,start:c.pixels[v]-g/2}}(s,l,g,Z),Pt=this._getStackIndex(this.index,this._cachedMeta.stack,b?s:void 0);k=ht.start+ht.chunk*Pt+ht.chunk/2,H=Math.min(w,ht.chunk*ht.ratio)}else k=u.getPixelForValue(this.getParsed(s)[u.axis],s),H=Math.min(w,l.min*l.ratio);return{base:k-H/2,head:k+H/2,center:k,size:H}}draw(){const s=this._cachedMeta,l=s.vScale,u=s.data,g=u.length;let b=0;for(;b<g;++b)null!==this.getParsed(b)[l.axis]&&u[b].draw(this._ctx)}}return v.id="bar",v.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},v.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}},v})(),pe=(()=>{class v extends ga{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(s,l,u,g){const b=super.parsePrimitiveData(s,l,u,g);for(let w=0;w<b.length;w++)b[w]._custom=this.resolveDataElementOptions(w+u).radius;return b}parseArrayData(s,l,u,g){const b=super.parseArrayData(s,l,u,g);for(let w=0;w<b.length;w++)b[w]._custom=Ft(l[u+w][2],this.resolveDataElementOptions(w+u).radius);return b}parseObjectData(s,l,u,g){const b=super.parseObjectData(s,l,u,g);for(let w=0;w<b.length;w++){const k=l[u+w];b[w]._custom=Ft(k&&k.r&&+k.r,this.resolveDataElementOptions(w+u).radius)}return b}getMaxOverflow(){const s=this._cachedMeta.data;let l=0;for(let u=s.length-1;u>=0;--u)l=Math.max(l,s[u].size(this.resolveDataElementOptions(u))/2);return l>0&&l}getLabelAndValue(s){const l=this._cachedMeta,{xScale:u,yScale:g}=l,b=this.getParsed(s),w=u.getLabelForValue(b.x),k=g.getLabelForValue(b.y),H=b._custom;return{label:l.label,value:"("+w+", "+k+(H?", "+H:"")+")"}}update(s){const l=this._cachedMeta.data;this.updateElements(l,0,l.length,s)}updateElements(s,l,u,g){const b="reset"===g,{iScale:w,vScale:k}=this._cachedMeta,H=this.resolveDataElementOptions(l,g),Z=this.getSharedOptions(H),ht=this.includeOptions(g,Z),Pt=w.axis,qt=k.axis;for(let be=l;be<l+u;be++){const Le=s[be],Ge=!b&&this.getParsed(be),Xe={},Ei=Xe[Pt]=b?w.getPixelForDecimal(.5):w.getPixelForValue(Ge[Pt]),an=Xe[qt]=b?k.getBasePixel():k.getPixelForValue(Ge[qt]);Xe.skip=isNaN(Ei)||isNaN(an),ht&&(Xe.options=this.resolveDataElementOptions(be,Le.active?"active":g),b&&(Xe.options.radius=0)),this.updateElement(Le,be,Xe,g)}this.updateSharedOptions(Z,g,H)}resolveDataElementOptions(s,l){const u=this.getParsed(s);let g=super.resolveDataElementOptions(s,l);g.$shared&&(g=Object.assign({},g,{$shared:!1}));const b=g.radius;return"active"!==l&&(g.radius=0),g.radius+=Ft(u&&u._custom,b),g}}return v.id="bubble",v.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},v.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title:()=>""}}}},v})(),ti=(()=>{class v extends ga{constructor(s,l){super(s,l),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(s,l){const u=this.getDataset().data,g=this._cachedMeta;if(!1===this._parsing)g._parsed=u;else{let w,k,b=H=>+u[H];if(at(u[s])){const{key:H="value"}=this._parsing;b=Z=>+Me(u[Z],H)}for(w=s,k=s+l;w<k;++w)g._parsed[w]=b(w)}}_getRotation(){return Ti(this.options.rotation-90)}_getCircumference(){return Ti(this.options.circumference)}_getRotationExtents(){let s=Dt,l=-Dt;for(let u=0;u<this.chart.data.datasets.length;++u)if(this.chart.isDatasetVisible(u)){const g=this.chart.getDatasetMeta(u).controller,b=g._getRotation(),w=g._getCircumference();s=Math.min(s,b),l=Math.max(l,b+w)}return{rotation:s,circumference:l-s}}update(s){const l=this.chart,{chartArea:u}=l,g=this._cachedMeta,b=g.data,w=this.getMaxBorderWidth()+this.getMaxOffset(b)+this.options.spacing,k=Math.max((Math.min(u.width,u.height)-w)/2,0),H=Math.min(((v,c)=>"string"==typeof v&&v.endsWith("%")?parseFloat(v)/100:v/c)(this.options.cutout,k),1),Z=this._getRingWeight(this.index),{circumference:ht,rotation:Pt}=this._getRotationExtents(),{ratioX:qt,ratioY:be,offsetX:Le,offsetY:Ge}=function Ve(v,c,s){let l=1,u=1,g=0,b=0;if(c<Dt){const w=v,k=w+c,H=Math.cos(w),Z=Math.sin(w),ht=Math.cos(k),Pt=Math.sin(k),qt=(an,Hi,Wi)=>De(an,w,k,!0)?1:Math.max(Hi,Hi*s,Wi,Wi*s),be=(an,Hi,Wi)=>De(an,w,k,!0)?-1:Math.min(Hi,Hi*s,Wi,Wi*s),Le=qt(0,H,ht),Ge=qt(Ee,Z,Pt),Xe=be(he,H,ht),Ei=be(he+Ee,Z,Pt);l=(Le-Xe)/2,u=(Ge-Ei)/2,g=-(Le+Xe)/2,b=-(Ge+Ei)/2}return{ratioX:l,ratioY:u,offsetX:g,offsetY:b}}(Pt,ht,H),an=Math.max(Math.min((u.width-w)/qt,(u.height-w)/be)/2,0),Hi=yt(this.options.radius,an),yn=(Hi-Math.max(Hi*H,0))/this._getVisibleDatasetWeightTotal();this.offsetX=Le*Hi,this.offsetY=Ge*Hi,g.total=this.calculateTotal(),this.outerRadius=Hi-yn*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-yn*Z,0),this.updateElements(b,0,b.length,s)}_circumference(s,l){const u=this.options,g=this._cachedMeta,b=this._getCircumference();return l&&u.animation.animateRotate||!this.chart.getDataVisibility(s)||null===g._parsed[s]||g.data[s].hidden?0:this.calculateCircumference(g._parsed[s]*b/Dt)}updateElements(s,l,u,g){const b="reset"===g,w=this.chart,k=w.chartArea,ht=(k.left+k.right)/2,Pt=(k.top+k.bottom)/2,qt=b&&w.options.animation.animateScale,be=qt?0:this.innerRadius,Le=qt?0:this.outerRadius,Ge=this.resolveDataElementOptions(l,g),Xe=this.getSharedOptions(Ge),Ei=this.includeOptions(g,Xe);let Hi,an=this._getRotation();for(Hi=0;Hi<l;++Hi)an+=this._circumference(Hi,b);for(Hi=l;Hi<l+u;++Hi){const Wi=this._circumference(Hi,b),yn=s[Hi],fn={x:ht+this.offsetX,y:Pt+this.offsetY,startAngle:an,endAngle:an+Wi,circumference:Wi,outerRadius:Le,innerRadius:be};Ei&&(fn.options=Xe||this.resolveDataElementOptions(Hi,yn.active?"active":g)),an+=Wi,this.updateElement(yn,Hi,fn,g)}this.updateSharedOptions(Xe,g,Ge)}calculateTotal(){const s=this._cachedMeta,l=s.data;let g,u=0;for(g=0;g<l.length;g++){const b=s._parsed[g];null!==b&&!isNaN(b)&&this.chart.getDataVisibility(g)&&!l[g].hidden&&(u+=Math.abs(b))}return u}calculateCircumference(s){const l=this._cachedMeta.total;return l>0&&!isNaN(s)?Dt*(Math.abs(s)/l):0}getLabelAndValue(s){const u=this.chart,g=u.data.labels||[],b=po(this._cachedMeta._parsed[s],u.options.locale);return{label:g[s]||"",value:b}}getMaxBorderWidth(s){let l=0;const u=this.chart;let g,b,w,k,H;if(!s)for(g=0,b=u.data.datasets.length;g<b;++g)if(u.isDatasetVisible(g)){w=u.getDatasetMeta(g),s=w.data,k=w.controller;break}if(!s)return 0;for(g=0,b=s.length;g<b;++g)H=k.resolveDataElementOptions(g),"inner"!==H.borderAlign&&(l=Math.max(l,H.borderWidth||0,H.hoverBorderWidth||0));return l}getMaxOffset(s){let l=0;for(let u=0,g=s.length;u<g;++u){const b=this.resolveDataElementOptions(u);l=Math.max(l,b.offset||0,b.hoverOffset||0)}return l}_getRingWeightOffset(s){let l=0;for(let u=0;u<s;++u)this.chart.isDatasetVisible(u)&&(l+=this._getRingWeight(u));return l}_getRingWeight(s){return Math.max(Ft(this.chart.data.datasets[s].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return v.id="doughnut",v.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},v.descriptors={_scriptable:c=>"spacing"!==c,_indexable:c=>"spacing"!==c},v.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(c){const s=c.data;if(s.labels.length&&s.datasets.length){const{labels:{pointStyle:l}}=c.legend.options;return s.labels.map((u,g)=>{const w=c.getDatasetMeta(0).controller.getStyle(g);return{text:u,fillStyle:w.backgroundColor,strokeStyle:w.borderColor,lineWidth:w.borderWidth,pointStyle:l,hidden:!c.getDataVisibility(g),index:g}})}return[]}},onClick(c,s,l){l.chart.toggleDataVisibility(s.index),l.chart.update()}},tooltip:{callbacks:{title:()=>"",label(c){let s=c.label;const l=": "+c.formattedValue;return bt(s)?(s=s.slice(),s[0]+=l):s+=l,s}}}}},v})(),Li=(()=>{class v extends ga{initialize(){this.enableOptionSharing=!0,super.initialize()}update(s){const l=this._cachedMeta,{dataset:u,data:g=[],_dataset:b}=l,w=this.chart._animationsDisabled;let{start:k,count:H}=function wn(v,c,s){const l=c.length;let u=0,g=l;if(v._sorted){const{iScale:b,_parsed:w}=v,k=b.axis,{min:H,max:Z,minDefined:ht,maxDefined:Pt}=b.getUserBounds();ht&&(u=_i(Math.min(Br(w,b.axis,H).lo,s?l:Br(c,k,b.getPixelForValue(H)).lo),0,l-1)),g=Pt?_i(Math.max(Br(w,b.axis,Z).hi+1,s?0:Br(c,k,b.getPixelForValue(Z)).hi+1),u,l)-u:l-u}return{start:u,count:g}}(l,g,w);this._drawStart=k,this._drawCount=H,function Co(v){const{xScale:c,yScale:s,_scaleRanges:l}=v,u={xmin:c.min,xmax:c.max,ymin:s.min,ymax:s.max};if(!l)return v._scaleRanges=u,!0;const g=l.xmin!==c.min||l.xmax!==c.max||l.ymin!==s.min||l.ymax!==s.max;return Object.assign(l,u),g}(l)&&(k=0,H=g.length),u._chart=this.chart,u._datasetIndex=this.index,u._decimated=!!b._decimated,u.points=g;const Z=this.resolveDatasetElementOptions(s);this.options.showLine||(Z.borderWidth=0),Z.segment=this.options.segment,this.updateElement(u,void 0,{animated:!w,options:Z},s),this.updateElements(g,k,H,s)}updateElements(s,l,u,g){const b="reset"===g,{iScale:w,vScale:k,_stacked:H,_dataset:Z}=this._cachedMeta,ht=this.resolveDataElementOptions(l,g),Pt=this.getSharedOptions(ht),qt=this.includeOptions(g,Pt),be=w.axis,Le=k.axis,{spanGaps:Ge,segment:Xe}=this.options,Ei=Kt(Ge)?Ge:Number.POSITIVE_INFINITY,an=this.chart._animationsDisabled||b||"none"===g;let Hi=l>0&&this.getParsed(l-1);for(let Wi=l;Wi<l+u;++Wi){const yn=s[Wi],fn=this.getParsed(Wi),An=an?yn:{},Bn=Ct(fn[Le]),Cn=An[be]=w.getPixelForValue(fn[be],Wi),Qi=An[Le]=b||Bn?k.getBasePixel():k.getPixelForValue(H?this.applyStack(k,fn,H):fn[Le],Wi);An.skip=isNaN(Cn)||isNaN(Qi)||Bn,An.stop=Wi>0&&fn[be]-Hi[be]>Ei,Xe&&(An.parsed=fn,An.raw=Z.data[Wi]),qt&&(An.options=Pt||this.resolveDataElementOptions(Wi,yn.active?"active":g)),an||this.updateElement(yn,Wi,An,g),Hi=fn}this.updateSharedOptions(Pt,g,ht)}getMaxOverflow(){const s=this._cachedMeta,l=s.dataset,u=l.options&&l.options.borderWidth||0,g=s.data||[];if(!g.length)return u;const b=g[0].size(this.resolveDataElementOptions(0)),w=g[g.length-1].size(this.resolveDataElementOptions(g.length-1));return Math.max(u,b,w)/2}draw(){const s=this._cachedMeta;s.dataset.updateControlPoints(this.chart.chartArea,s.iScale.axis),super.draw()}}return v.id="line",v.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},v.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}},v})();var Us=Object.freeze({__proto__:null,BarController:Wt,BubbleController:pe,DoughnutController:ti,LineController:Li,PolarAreaController:(()=>{class v extends ga{constructor(s,l){super(s,l),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(s){const u=this.chart,g=u.data.labels||[],b=po(this._cachedMeta._parsed[s].r,u.options.locale);return{label:g[s]||"",value:b}}update(s){const l=this._cachedMeta.data;this._updateRadius(),this.updateElements(l,0,l.length,s)}_updateRadius(){const s=this.chart,l=s.chartArea,u=s.options,g=Math.min(l.right-l.left,l.bottom-l.top),b=Math.max(g/2,0),k=(b-Math.max(u.cutoutPercentage?b/100*u.cutoutPercentage:1,0))/s.getVisibleDatasetCount();this.outerRadius=b-k*this.index,this.innerRadius=this.outerRadius-k}updateElements(s,l,u,g){const b="reset"===g,w=this.chart,k=this.getDataset(),Z=w.options.animation,ht=this._cachedMeta.rScale,Pt=ht.xCenter,qt=ht.yCenter,be=ht.getIndexAngle(0)-.5*he;let Ge,Le=be;const Xe=360/this.countVisibleElements();for(Ge=0;Ge<l;++Ge)Le+=this._computeAngle(Ge,g,Xe);for(Ge=l;Ge<l+u;Ge++){const Ei=s[Ge];let an=Le,Hi=Le+this._computeAngle(Ge,g,Xe),Wi=w.getDataVisibility(Ge)?ht.getDistanceFromCenterForValue(k.data[Ge]):0;Le=Hi,b&&(Z.animateScale&&(Wi=0),Z.animateRotate&&(an=Hi=be));const yn={x:Pt,y:qt,innerRadius:0,outerRadius:Wi,startAngle:an,endAngle:Hi,options:this.resolveDataElementOptions(Ge,Ei.active?"active":g)};this.updateElement(Ei,Ge,yn,g)}}countVisibleElements(){const s=this.getDataset();let u=0;return this._cachedMeta.data.forEach((g,b)=>{!isNaN(s.data[b])&&this.chart.getDataVisibility(b)&&u++}),u}_computeAngle(s,l,u){return this.chart.getDataVisibility(s)?Ti(this.resolveDataElementOptions(s,l).angle||u):0}}return v.id="polarArea",v.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},v.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(c){const s=c.data;if(s.labels.length&&s.datasets.length){const{labels:{pointStyle:l}}=c.legend.options;return s.labels.map((u,g)=>{const w=c.getDatasetMeta(0).controller.getStyle(g);return{text:u,fillStyle:w.backgroundColor,strokeStyle:w.borderColor,lineWidth:w.borderWidth,pointStyle:l,hidden:!c.getDataVisibility(g),index:g}})}return[]}},onClick(c,s,l){l.chart.toggleDataVisibility(s.index),l.chart.update()}},tooltip:{callbacks:{title:()=>"",label:c=>c.chart.data.labels[c.dataIndex]+": "+c.formattedValue}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}},v})(),PieController:(()=>{class v extends ti{}return v.id="pie",v.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"},v})(),RadarController:(()=>{class v extends ga{getLabelAndValue(s){const l=this._cachedMeta.vScale,u=this.getParsed(s);return{label:l.getLabels()[s],value:""+l.getLabelForValue(u[l.axis])}}update(s){const l=this._cachedMeta,u=l.dataset,g=l.data||[],b=l.iScale.getLabels();if(u.points=g,"resize"!==s){const w=this.resolveDatasetElementOptions(s);this.options.showLine||(w.borderWidth=0),this.updateElement(u,void 0,{_loop:!0,_fullLoop:b.length===g.length,options:w},s)}this.updateElements(g,0,g.length,s)}updateElements(s,l,u,g){const b=this.getDataset(),w=this._cachedMeta.rScale,k="reset"===g;for(let H=l;H<l+u;H++){const Z=s[H],ht=this.resolveDataElementOptions(H,Z.active?"active":g),Pt=w.getPointPositionForValue(H,b.data[H]),qt=k?w.xCenter:Pt.x,be=k?w.yCenter:Pt.y,Le={x:qt,y:be,angle:Pt.angle,skip:isNaN(qt)||isNaN(be),options:ht};this.updateElement(Z,H,Le,g)}}}return v.id="radar",v.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},v.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}},v})(),ScatterController:(()=>{class v extends Li{}return v.id="scatter",v.defaults={showLine:!1,fill:!1},v.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title:()=>"",label:c=>"("+c.label+", "+c.formattedValue+")"}}},scales:{x:{type:"linear"},y:{type:"linear"}}},v})()});function fs(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var Ka={_date:(()=>{class v{constructor(s){this.options=s||{}}formats(){return fs()}parse(s,l){return fs()}format(s,l){return fs()}add(s,l,u){return fs()}diff(s,l,u){return fs()}startOf(s,l,u){return fs()}endOf(s,l){return fs()}}return v.override=function(c){Object.assign(v.prototype,c)},v})()};function os(v,c){return"native"in v?{x:v.x,y:v.y}:z(v,c)}function Ja(v,c,s,l){const{controller:u,data:g,_sorted:b}=v,w=u._cachedMeta.iScale;if(w&&c===w.axis&&b&&g.length){const k=w._reversePixels?pa:Br;if(!l)return k(g,c,s);if(u._sharedOptions){const H=g[0],Z="function"==typeof H.getRange&&H.getRange(c);if(Z){const ht=k(g,c,s-Z),Pt=k(g,c,s+Z);return{lo:ht.lo,hi:Pt.hi}}}}return{lo:0,hi:g.length-1}}function nu(v,c,s,l,u){const g=v.getSortedVisibleDatasetMetas(),b=s[c];for(let w=0,k=g.length;w<k;++w){const{index:H,data:Z}=g[w],{lo:ht,hi:Pt}=Ja(g[w],c,b,u);for(let qt=ht;qt<=Pt;++qt){const be=Z[qt];be.skip||l(be,H,qt)}}}function Vl(v,c,s,l){const u=[];return us(c,v.chartArea,v._minPadding)&&nu(v,s,c,function(b,w,k){b.inRange(c.x,c.y,l)&&u.push({element:b,datasetIndex:w,index:k})},!0),u}function gs(v,c,s,l,u){const g=function _a(v){const c=-1!==v.indexOf("x"),s=-1!==v.indexOf("y");return function(l,u){const g=c?Math.abs(l.x-u.x):0,b=s?Math.abs(l.y-u.y):0;return Math.sqrt(Math.pow(g,2)+Math.pow(b,2))}}(s);let b=Number.POSITIVE_INFINITY,w=[];return us(c,v.chartArea,v._minPadding)&&nu(v,s,c,function(H,Z,ht){if(l&&!H.inRange(c.x,c.y,u))return;const Pt=H.getCenterPoint(u);if(!us(Pt,v.chartArea,v._minPadding)&&!H.inRange(c.x,c.y,u))return;const qt=g(c,Pt);qt<b?(w=[{element:H,datasetIndex:Z,index:ht}],b=qt):qt===b&&w.push({element:H,datasetIndex:Z,index:ht})}),w}function Rr(v,c,s,l){const u=os(c,v),g=[],b=s.axis,w="x"===b?"inXRange":"inYRange";let k=!1;return function _l(v,c){const s=v.getSortedVisibleDatasetMetas();let l,u,g;for(let b=0,w=s.length;b<w;++b){({index:l,data:u}=s[b]);for(let k=0,H=u.length;k<H;++k)g=u[k],g.skip||c(g,l,k)}}(v,(H,Z,ht)=>{H[w](u[b],l)&&g.push({element:H,datasetIndex:Z,index:ht}),H.inRange(u.x,u.y,l)&&(k=!0)}),s.intersect&&!k?[]:g}var Dr={modes:{index(v,c,s,l){const u=os(c,v),g=s.axis||"x",b=s.intersect?Vl(v,u,g,l):gs(v,u,g,!1,l),w=[];return b.length?(v.getSortedVisibleDatasetMetas().forEach(k=>{const H=b[0].index,Z=k.data[H];Z&&!Z.skip&&w.push({element:Z,datasetIndex:k.index,index:H})}),w):[]},dataset(v,c,s,l){const u=os(c,v),g=s.axis||"xy";let b=s.intersect?Vl(v,u,g,l):gs(v,u,g,!1,l);if(b.length>0){const w=b[0].datasetIndex,k=v.getDatasetMeta(w).data;b=[];for(let H=0;H<k.length;++H)b.push({element:k[H],datasetIndex:w,index:H})}return b},point:(v,c,s,l)=>Vl(v,os(c,v),s.axis||"xy",l),nearest:(v,c,s,l)=>gs(v,os(c,v),s.axis||"xy",s.intersect,l),x:(v,c,s,l)=>Rr(v,c,{axis:"x",intersect:s.intersect},l),y:(v,c,s,l)=>Rr(v,c,{axis:"y",intersect:s.intersect},l)}};const nr=["left","top","right","bottom"];function Rl(v,c){return v.filter(s=>s.pos===c)}function ou(v,c){return v.filter(s=>-1===nr.indexOf(s.pos)&&s.box.axis===c)}function Tr(v,c){return v.sort((s,l)=>{const u=c?l:s,g=c?s:l;return u.weight===g.weight?u.index-g.index:u.weight-g.weight})}function Bu(v,c,s,l){return Math.max(v[s],c[s])+Math.max(v[l],c[l])}function Su(v,c){v.top=Math.max(v.top,c.top),v.left=Math.max(v.left,c.left),v.bottom=Math.max(v.bottom,c.bottom),v.right=Math.max(v.right,c.right)}function eh(v,c,s,l){const{pos:u,box:g}=s,b=v.maxPadding;if(!at(u)){s.size&&(v[u]-=s.size);const ht=l[s.stack]||{size:0,count:1};ht.size=Math.max(ht.size,s.horizontal?g.height:g.width),s.size=ht.size/ht.count,v[u]+=s.size}g.getPadding&&Su(b,g.getPadding());const w=Math.max(0,c.outerWidth-Bu(b,v,"left","right")),k=Math.max(0,c.outerHeight-Bu(b,v,"top","bottom")),H=w!==v.w,Z=k!==v.h;return v.w=w,v.h=k,s.horizontal?{same:H,other:Z}:{same:Z,other:H}}function Ru(v,c){const s=c.maxPadding;return function l(u){const g={left:0,top:0,right:0,bottom:0};return u.forEach(b=>{g[b]=Math.max(c[b],s[b])}),g}(v?["left","right"]:["top","bottom"])}function Nr(v,c,s,l){const u=[];let g,b,w,k,H,Z;for(g=0,b=v.length,H=0;g<b;++g){w=v[g],k=w.box,k.update(w.width||c.w,w.height||c.h,Ru(w.horizontal,c));const{same:ht,other:Pt}=eh(c,s,w,l);H|=ht&&u.length,Z=Z||Pt,k.fullSize||u.push(w)}return H&&Nr(u,c,s,l)||Z}function Gl(v,c,s,l,u){v.top=s,v.left=c,v.right=c+l,v.bottom=s+u,v.width=l,v.height=u}function ec(v,c,s,l){const u=s.padding;let{x:g,y:b}=c;for(const w of v){const k=w.box,H=l[w.stack]||{count:1,placed:0,weight:1},Z=w.stackWeight/H.weight||1;if(w.horizontal){const ht=c.w*Z,Pt=H.size||k.height;Bt(H.start)&&(b=H.start),k.fullSize?Gl(k,u.left,b,s.outerWidth-u.right-u.left,Pt):Gl(k,c.left+H.placed,b,ht,Pt),H.start=b,H.placed+=ht,b=k.bottom}else{const ht=c.h*Z,Pt=H.size||k.width;Bt(H.start)&&(g=H.start),k.fullSize?Gl(k,g,u.top,Pt,s.outerHeight-u.bottom-u.top):Gl(k,g,c.top+H.placed,Pt,ht),H.start=g,H.placed+=ht,g=k.right}}c.x=g,c.y=b}uo.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var Rs={addBox(v,c){v.boxes||(v.boxes=[]),c.fullSize=c.fullSize||!1,c.position=c.position||"top",c.weight=c.weight||0,c._layers=c._layers||function(){return[{z:0,draw(s){c.draw(s)}}]},v.boxes.push(c)},removeBox(v,c){const s=v.boxes?v.boxes.indexOf(c):-1;-1!==s&&v.boxes.splice(s,1)},configure(v,c,s){c.fullSize=s.fullSize,c.position=s.position,c.weight=s.weight},update(v,c,s,l){if(!v)return;const u=Go(v.options.layout.padding),g=Math.max(c-u.width,0),b=Math.max(s-u.height,0),w=function bc(v){const c=function th(v){const c=[];let s,l,u,g,b,w;for(s=0,l=(v||[]).length;s<l;++s)u=v[s],({position:g,options:{stack:b,stackWeight:w=1}}=u),c.push({index:s,box:u,pos:g,horizontal:u.isHorizontal(),weight:u.weight,stack:b&&g+b,stackWeight:w});return c}(v),s=Tr(c.filter(H=>H.box.fullSize),!0),l=Tr(Rl(c,"left"),!0),u=Tr(Rl(c,"right")),g=Tr(Rl(c,"top"),!0),b=Tr(Rl(c,"bottom")),w=ou(c,"x"),k=ou(c,"y");return{fullSize:s,leftAndTop:l.concat(g),rightAndBottom:u.concat(k).concat(b).concat(w),chartArea:Rl(c,"chartArea"),vertical:l.concat(u).concat(k),horizontal:g.concat(b).concat(w)}}(v.boxes),k=w.vertical,H=w.horizontal;rt(v.boxes,Le=>{"function"==typeof Le.beforeLayout&&Le.beforeLayout()});const Z=k.reduce((Le,Ge)=>Ge.box.options&&!1===Ge.box.options.display?Le:Le+1,0)||1,ht=Object.freeze({outerWidth:c,outerHeight:s,padding:u,availableWidth:g,availableHeight:b,vBoxMaxWidth:g/2/Z,hBoxMaxHeight:b/2}),Pt=Object.assign({},u);Su(Pt,Go(l));const qt=Object.assign({maxPadding:Pt,w:g,h:b,x:u.left,y:u.top},u),be=function Cu(v,c){const s=function Fu(v){const c={};for(const s of v){const{stack:l,pos:u,stackWeight:g}=s;if(!l||!nr.includes(u))continue;const b=c[l]||(c[l]={count:0,placed:0,weight:0,size:0});b.count++,b.weight+=g}return c}(v),{vBoxMaxWidth:l,hBoxMaxHeight:u}=c;let g,b,w;for(g=0,b=v.length;g<b;++g){w=v[g];const{fullSize:k}=w.box,H=s[w.stack],Z=H&&w.stackWeight/H.weight;w.horizontal?(w.width=Z?Z*l:k&&c.availableWidth,w.height=u):(w.width=l,w.height=Z?Z*u:k&&c.availableHeight)}return s}(k.concat(H),ht);Nr(w.fullSize,qt,ht,be),Nr(k,qt,ht,be),Nr(H,qt,ht,be)&&Nr(k,qt,ht,be),function ac(v){const c=v.maxPadding;function s(l){const u=Math.max(c[l]-v[l],0);return v[l]+=u,u}v.y+=s("top"),v.x+=s("left"),s("right"),s("bottom")}(qt),ec(w.leftAndTop,qt,ht,be),qt.x+=qt.w,qt.y+=qt.h,ec(w.rightAndBottom,qt,ht,be),v.chartArea={left:qt.left,top:qt.top,right:qt.left+qt.w,bottom:qt.top+qt.h,height:qt.h,width:qt.w},rt(w.chartArea,Le=>{const Ge=Le.box;Object.assign(Ge,v.chartArea),Ge.update(qt.w,qt.h,{left:0,top:0,right:0,bottom:0})})}};class $a{acquireContext(c,s){}releaseContext(c){return!1}addEventListener(c,s,l){}removeEventListener(c,s,l){}getDevicePixelRatio(){return 1}getMaximumSize(c,s,l,u){return s=Math.max(0,s||c.width),l=l||c.height,{width:s,height:Math.max(0,u?Math.floor(s/u):l)}}isAttached(c){return!0}updateConfig(c){}}class Ca extends $a{acquireContext(c){return c&&c.getContext&&c.getContext("2d")||null}updateConfig(c){c.options.animation=!1}}const aa="$chartjs",Za={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},La=v=>null===v||""===v,Hc=!!Ye&&{passive:!0};function Wo(v,c,s){v.canvas.removeEventListener(c,s,Hc)}function Il(v,c){for(const s of v)if(s===c||s.contains(c))return!0}function Wl(v,c,s){const l=v.canvas,u=new MutationObserver(g=>{let b=!1;for(const w of g)b=b||Il(w.addedNodes,l),b=b&&!Il(w.removedNodes,l);b&&s()});return u.observe(document,{childList:!0,subtree:!0}),u}function Is(v,c,s){const l=v.canvas,u=new MutationObserver(g=>{let b=!1;for(const w of g)b=b||Il(w.removedNodes,l),b=b&&!Il(w.addedNodes,l);b&&s()});return u.observe(document,{childList:!0,subtree:!0}),u}const Qa=new Map;let ic=0;function ih(){const v=window.devicePixelRatio;v!==ic&&(ic=v,Qa.forEach((c,s)=>{s.currentDevicePixelRatio!==v&&c()}))}function Cc(v,c,s){const l=v.canvas,u=l&&$r(l);if(!u)return;const g=et((w,k)=>{const H=u.clientWidth;s(w,k),H<u.clientWidth&&s()},window),b=new ResizeObserver(w=>{const k=w[0],H=k.contentRect.width,Z=k.contentRect.height;0===H&&0===Z||g(H,Z)});return b.observe(u),function wl(v,c){Qa.size||window.addEventListener("resize",ih),Qa.set(v,c)}(v,g),b}function _s(v,c,s){s&&s.disconnect(),"resize"===c&&function nc(v){Qa.delete(v),Qa.size||window.removeEventListener("resize",ih)}(v)}function ml(v,c,s){const l=v.canvas,u=et(g=>{null!==v.ctx&&s(function Na(v,c){const s=Za[v.type]||v.type,{x:l,y:u}=z(v,c);return{type:s,chart:c,native:v,x:void 0!==l?l:null,y:void 0!==u?u:null}}(g,v))},v,g=>{const b=g[0];return[b,b.offsetX,b.offsetY]});return function ma(v,c,s){v.addEventListener(c,s,Hc)}(l,c,u),u}class Ao extends $a{acquireContext(c,s){const l=c&&c.getContext&&c.getContext("2d");return l&&l.canvas===c?(function Ec(v,c){const s=v.style,l=v.getAttribute("height"),u=v.getAttribute("width");if(v[aa]={initial:{height:l,width:u,style:{display:s.display,height:s.height,width:s.width}}},s.display=s.display||"block",s.boxSizing=s.boxSizing||"border-box",La(u)){const g=Qe(v,"width");void 0!==g&&(v.width=g)}if(La(l))if(""===v.style.height)v.height=v.width/(c||2);else{const g=Qe(v,"height");void 0!==g&&(v.height=g)}}(c,s),l):null}releaseContext(c){const s=c.canvas;if(!s[aa])return!1;const l=s[aa].initial;["height","width"].forEach(g=>{const b=l[g];Ct(b)?s.removeAttribute(g):s.setAttribute(g,b)});const u=l.style||{};return Object.keys(u).forEach(g=>{s.style[g]=u[g]}),s.width=s.width,delete s[aa],!0}addEventListener(c,s,l){this.removeEventListener(c,s),(c.$proxies||(c.$proxies={}))[s]=({attach:Wl,detach:Is,resize:Cc}[s]||ml)(c,s,l)}removeEventListener(c,s){const l=c.$proxies||(c.$proxies={}),u=l[s];u&&(({attach:_s,detach:_s,resize:_s}[s]||Wo)(c,s,u),l[s]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(c,s,l,u){return function Qt(v,c,s,l){const u=xs(v),g=Xi(u,"margin"),b=za(u.maxWidth,v,"clientWidth")||je,w=za(u.maxHeight,v,"clientHeight")||je,k=function J(v,c,s){let l,u;if(void 0===c||void 0===s){const g=$r(v);if(g){const b=g.getBoundingClientRect(),w=xs(g),k=Xi(w,"border","width"),H=Xi(w,"padding");c=b.width-H.width-k.width,s=b.height-H.height-k.height,l=za(w.maxWidth,g,"clientWidth"),u=za(w.maxHeight,g,"clientHeight")}else c=v.clientWidth,s=v.clientHeight}return{width:c,height:s,maxWidth:l||je,maxHeight:u||je}}(v,c,s);let{width:H,height:Z}=k;if("content-box"===u.boxSizing){const ht=Xi(u,"border","width"),Pt=Xi(u,"padding");H-=Pt.width+ht.width,Z-=Pt.height+ht.height}return H=Math.max(0,H-g.width),Z=Math.max(0,l?Math.floor(H/l):Z-g.height),H=_t(Math.min(H,b,k.maxWidth)),Z=_t(Math.min(Z,w,k.maxHeight)),H&&!Z&&(Z=_t(H/2)),{width:H,height:Z}}(c,s,l,u)}isAttached(c){const s=$r(c);return!(!s||!s.isConnected)}}class la{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(c){const{x:s,y:l}=this.getProps(["x","y"],c);return{x:s,y:l}}hasValue(){return Kt(this.x)&&Kt(this.y)}getProps(c,s){const l=this.$animations;if(!s||!l)return this;const u={};return c.forEach(g=>{u[g]=l[g]&&l[g].active()?l[g]._to:this[g]}),u}}la.defaults={},la.defaultRoutes=void 0;const lc={values:v=>bt(v)?v:""+v,numeric(v,c,s){if(0===v)return"0";const l=this.chart.options.locale;let u,g=v;if(s.length>1){const H=Math.max(Math.abs(s[0].value),Math.abs(s[s.length-1].value));(H<1e-4||H>1e15)&&(u="scientific"),g=function Vc(v,c){let s=c.length>3?c[2].value-c[1].value:c[1].value-c[0].value;return Math.abs(s)>=1&&v!==Math.floor(v)&&(s=v-Math.floor(v)),s}(v,s)}const b=Oe(Math.abs(g)),w=Math.max(Math.min(-1*Math.floor(b),20),0),k={notation:u,minimumFractionDigits:w,maximumFractionDigits:w};return Object.assign(k,this.options.ticks.format),po(v,l,k)},logarithmic(v,c,s){if(0===v)return"0";const l=v/Math.pow(10,Math.floor(Oe(v)));return 1===l||2===l||5===l?lc.numeric.call(this,v,c,s):""}};var Dl={formatters:lc};function Ml(v,c,s,l,u){const g=Ft(l,0),b=Math.min(Ft(u,v.length),v.length);let k,H,Z,w=0;for(s=Math.ceil(s),u&&(k=u-l,s=k/Math.floor(k/s)),Z=g;Z<0;)w++,Z=Math.round(g+w*s);for(H=Math.max(g,0);H<b;H++)H===Z&&(c.push(v[H]),w++,Z=Math.round(g+w*s))}uo.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(v,c)=>c.lineWidth,tickColor:(v,c)=>c.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Dl.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),uo.route("scale.ticks","color","","color"),uo.route("scale.grid","color","","borderColor"),uo.route("scale.grid","borderColor","","borderColor"),uo.route("scale.title","color","","color"),uo.describe("scale",{_fallback:!1,_scriptable:v=>!v.startsWith("before")&&!v.startsWith("after")&&"callback"!==v&&"parser"!==v,_indexable:v=>"borderDash"!==v&&"tickBorderDash"!==v}),uo.describe("scales",{_fallback:"scale"}),uo.describe("scale.ticks",{_scriptable:v=>"backdropPadding"!==v&&"callback"!==v,_indexable:v=>"backdropPadding"!==v});const Wc=(v,c,s)=>"top"===c||"left"===c?v[c]+s:v[c]-s;function ul(v,c){const s=[],l=v.length/c,u=v.length;let g=0;for(;g<u;g+=l)s.push(v[Math.floor(g)]);return s}function Yr(v,c,s){const l=v.ticks.length,u=Math.min(c,l-1),g=v._startPixel,b=v._endPixel,w=1e-6;let H,k=v.getPixelForTick(u);if(!(s&&(H=1===l?Math.max(k-g,b-k):0===c?(v.getPixelForTick(1)-k)/2:(k-v.getPixelForTick(u-1))/2,k+=u<c?H:-H,k<g-w||k>b+w)))return k}function Sa(v){return v.drawTicks?v.tickLength:0}function oc(v,c){if(!v.display)return 0;const s=Bo(v.font,c),l=Go(v.padding);return(bt(v.text)?v.text.length:1)*s.lineHeight+l.height}function wu(v,c,s){let l=It(v);return(s&&"right"!==c||!s&&"right"===c)&&(l=(v=>"left"===v?"right":"right"===v?"left":v)(l)),l}class Ra extends la{constructor(c){super(),this.id=c.id,this.type=c.type,this.options=void 0,this.ctx=c.ctx,this.chart=c.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(c){this.options=c.setContext(this.getContext()),this.axis=c.axis,this._userMin=this.parse(c.min),this._userMax=this.parse(c.max),this._suggestedMin=this.parse(c.suggestedMin),this._suggestedMax=this.parse(c.suggestedMax)}parse(c,s){return c}getUserBounds(){let{_userMin:c,_userMax:s,_suggestedMin:l,_suggestedMax:u}=this;return c=lt(c,Number.POSITIVE_INFINITY),s=lt(s,Number.NEGATIVE_INFINITY),l=lt(l,Number.POSITIVE_INFINITY),u=lt(u,Number.NEGATIVE_INFINITY),{min:lt(c,l),max:lt(s,u),minDefined:ft(c),maxDefined:ft(s)}}getMinMax(c){let b,{min:s,max:l,minDefined:u,maxDefined:g}=this.getUserBounds();if(u&&g)return{min:s,max:l};const w=this.getMatchingVisibleMetas();for(let k=0,H=w.length;k<H;++k)b=w[k].controller.getMinMax(this,c),u||(s=Math.min(s,b.min)),g||(l=Math.max(l,b.max));return s=g&&s>l?l:s,l=u&&s>l?s:l,{min:lt(s,lt(l,s)),max:lt(l,lt(s,l))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const c=this.chart.data;return this.options.labels||(this.isHorizontal()?c.xLabels:c.yLabels)||c.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){ct(this.options.beforeUpdate,[this])}update(c,s,l){const{beginAtZero:u,grace:g,ticks:b}=this.options,w=b.sampleSize;this.beforeUpdate(),this.maxWidth=c,this.maxHeight=s,this._margins=l=Object.assign({left:0,right:0,top:0,bottom:0},l),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+l.left+l.right:this.height+l.top+l.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function Ar(v,c,s){const{min:l,max:u}=v,g=yt(c,(u-l)/2),b=(w,k)=>s&&0===w?0:w+k;return{min:b(l,-Math.abs(g)),max:b(u,g)}}(this,g,u),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const k=w<this.ticks.length;this._convertTicksToLabels(k?ul(this.ticks,w):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),b.display&&(b.autoSkip||"auto"===b.source)&&(this.ticks=function Gc(v,c){const s=v.options.ticks,l=s.maxTicksLimit||function Mr(v){const c=v.options.offset,s=v._tickSize();return Math.floor(Math.min(v._length/s+(c?0:1),v._maxLength/s))}(v),u=s.major.enabled?function cc(v){const c=[];let s,l;for(s=0,l=v.length;s<l;s++)v[s].major&&c.push(s);return c}(c):[],g=u.length,b=u[0],w=u[g-1],k=[];if(g>l)return function ru(v,c,s,l){let b,u=0,g=s[0];for(l=Math.ceil(l),b=0;b<v.length;b++)b===g&&(c.push(v[b]),u++,g=s[u*l])}(c,k,u,g/l),k;const H=function Iu(v,c,s){const l=function qa(v){const c=v.length;let s,l;if(c<2)return!1;for(l=v[0],s=1;s<c;++s)if(v[s]-v[s-1]!==l)return!1;return l}(v),u=c.length/s;if(!l)return Math.max(u,1);const g=function ye(v){const c=[],s=Math.sqrt(v);let l;for(l=1;l<s;l++)v%l==0&&(c.push(l),c.push(v/l));return s===(0|s)&&c.push(s),c.sort((u,g)=>u-g).pop(),c}(l);for(let b=0,w=g.length-1;b<w;b++){const k=g[b];if(k>u)return k}return Math.max(u,1)}(u,c,l);if(g>0){let Z,ht;const Pt=g>1?Math.round((w-b)/(g-1)):null;for(Ml(c,k,H,Ct(Pt)?0:b-Pt,b),Z=0,ht=g-1;Z<ht;Z++)Ml(c,k,H,u[Z],u[Z+1]);return Ml(c,k,H,w,Ct(Pt)?c.length:w+Pt),k}return Ml(c,k,H),k}(this,this.ticks),this._labelSizes=null),k&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let s,l,c=this.options.reverse;this.isHorizontal()?(s=this.left,l=this.right):(s=this.top,l=this.bottom,c=!c),this._startPixel=s,this._endPixel=l,this._reversePixels=c,this._length=l-s,this._alignToPixels=this.options.alignToPixels}afterUpdate(){ct(this.options.afterUpdate,[this])}beforeSetDimensions(){ct(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){ct(this.options.afterSetDimensions,[this])}_callHooks(c){this.chart.notifyPlugins(c,this.getContext()),ct(this.options[c],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){ct(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(c){const s=this.options.ticks;let l,u,g;for(l=0,u=c.length;l<u;l++)g=c[l],g.label=ct(s.callback,[g.value,l,c],this)}afterTickToLabelConversion(){ct(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){ct(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const c=this.options,s=c.ticks,l=this.ticks.length,u=s.minRotation||0,g=s.maxRotation;let w,k,H,b=u;if(!this._isVisible()||!s.display||u>=g||l<=1||!this.isHorizontal())return void(this.labelRotation=u);const Z=this._getLabelSizes(),ht=Z.widest.width,Pt=Z.highest.height,qt=_i(this.chart.width-ht,0,this.maxWidth);w=c.offset?this.maxWidth/l:qt/(l-1),ht+6>w&&(w=qt/(l-(c.offset?.5:1)),k=this.maxHeight-Sa(c.grid)-s.padding-oc(c.title,this.chart.options.font),H=Math.sqrt(ht*ht+Pt*Pt),b=vi(Math.min(Math.asin(_i((Z.highest.height+6)/w,-1,1)),Math.asin(_i(k/H,-1,1))-Math.asin(_i(Pt/H,-1,1)))),b=Math.max(u,Math.min(g,b))),this.labelRotation=b}afterCalculateLabelRotation(){ct(this.options.afterCalculateLabelRotation,[this])}beforeFit(){ct(this.options.beforeFit,[this])}fit(){const c={width:0,height:0},{chart:s,options:{ticks:l,title:u,grid:g}}=this,b=this._isVisible(),w=this.isHorizontal();if(b){const k=oc(u,s.options.font);if(w?(c.width=this.maxWidth,c.height=Sa(g)+k):(c.height=this.maxHeight,c.width=Sa(g)+k),l.display&&this.ticks.length){const{first:H,last:Z,widest:ht,highest:Pt}=this._getLabelSizes(),qt=2*l.padding,be=Ti(this.labelRotation),Le=Math.cos(be),Ge=Math.sin(be);w?c.height=Math.min(this.maxHeight,c.height+(l.mirror?0:Ge*ht.width+Le*Pt.height)+qt):c.width=Math.min(this.maxWidth,c.width+(l.mirror?0:Le*ht.width+Ge*Pt.height)+qt),this._calculatePadding(H,Z,Ge,Le)}}this._handleMargins(),w?(this.width=this._length=s.width-this._margins.left-this._margins.right,this.height=c.height):(this.width=c.width,this.height=this._length=s.height-this._margins.top-this._margins.bottom)}_calculatePadding(c,s,l,u){const{ticks:{align:g,padding:b},position:w}=this.options,k=0!==this.labelRotation,H="top"!==w&&"x"===this.axis;if(this.isHorizontal()){const Z=this.getPixelForTick(0)-this.left,ht=this.right-this.getPixelForTick(this.ticks.length-1);let Pt=0,qt=0;k?H?(Pt=u*c.width,qt=l*s.height):(Pt=l*c.height,qt=u*s.width):"start"===g?qt=s.width:"end"===g?Pt=c.width:(Pt=c.width/2,qt=s.width/2),this.paddingLeft=Math.max((Pt-Z+b)*this.width/(this.width-Z),0),this.paddingRight=Math.max((qt-ht+b)*this.width/(this.width-ht),0)}else{let Z=s.height/2,ht=c.height/2;"start"===g?(Z=0,ht=c.height):"end"===g&&(Z=s.height,ht=0),this.paddingTop=Z+b,this.paddingBottom=ht+b}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){ct(this.options.afterFit,[this])}isHorizontal(){const{axis:c,position:s}=this.options;return"top"===s||"bottom"===s||"x"===c}isFullSize(){return this.options.fullSize}_convertTicksToLabels(c){let s,l;for(this.beforeTickToLabelConversion(),this.generateTickLabels(c),s=0,l=c.length;s<l;s++)Ct(c[s].label)&&(c.splice(s,1),l--,s--);this.afterTickToLabelConversion()}_getLabelSizes(){let c=this._labelSizes;if(!c){const s=this.options.ticks.sampleSize;let l=this.ticks;s<l.length&&(l=ul(l,s)),this._labelSizes=c=this._computeLabelSizes(l,l.length)}return c}_computeLabelSizes(c,s){const{ctx:l,_longestTextCache:u}=this,g=[],b=[];let H,Z,ht,Pt,qt,be,Le,Ge,Xe,Ei,an,w=0,k=0;for(H=0;H<s;++H){if(Pt=c[H].label,qt=this._resolveTickFontOptions(H),l.font=be=qt.string,Le=u[be]=u[be]||{data:{},gc:[]},Ge=qt.lineHeight,Xe=Ei=0,Ct(Pt)||bt(Pt)){if(bt(Pt))for(Z=0,ht=Pt.length;Z<ht;++Z)an=Pt[Z],!Ct(an)&&!bt(an)&&(Xe=Wr(l,Le.data,Le.gc,Xe,an),Ei+=Ge)}else Xe=Wr(l,Le.data,Le.gc,Xe,Pt),Ei=Ge;g.push(Xe),b.push(Ei),w=Math.max(Xe,w),k=Math.max(Ei,k)}!function Ol(v,c){rt(v,s=>{const l=s.gc,u=l.length/2;let g;if(u>c){for(g=0;g<u;++g)delete s.data[l[g]];l.splice(0,u)}})}(u,s);const Hi=g.indexOf(w),Wi=b.indexOf(k),yn=fn=>({width:g[fn]||0,height:b[fn]||0});return{first:yn(0),last:yn(s-1),widest:yn(Hi),highest:yn(Wi),widths:g,heights:b}}getLabelForValue(c){return c}getPixelForValue(c,s){return NaN}getValueForPixel(c){}getPixelForTick(c){const s=this.ticks;return c<0||c>s.length-1?null:this.getPixelForValue(s[c].value)}getPixelForDecimal(c){this._reversePixels&&(c=1-c);const s=this._startPixel+c*this._length;return function yi(v){return _i(v,-32768,32767)}(this._alignToPixels?wr(this.chart,s,0):s)}getDecimalForPixel(c){const s=(c-this._startPixel)/this._length;return this._reversePixels?1-s:s}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:c,max:s}=this;return c<0&&s<0?s:c>0&&s>0?c:0}getContext(c){const s=this.ticks||[];if(c>=0&&c<s.length){const l=s[c];return l.$context||(l.$context=function nh(v,c,s){return zr(v,{tick:s,index:c,type:"tick"})}(this.getContext(),c,l))}return this.$context||(this.$context=function Sc(v,c){return zr(v,{scale:c,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const c=this.options.ticks,s=Ti(this.labelRotation),l=Math.abs(Math.cos(s)),u=Math.abs(Math.sin(s)),g=this._getLabelSizes(),b=c.autoSkipPadding||0,w=g?g.widest.width+b:0,k=g?g.highest.height+b:0;return this.isHorizontal()?k*l>w*u?w/l:k/u:k*u<w*l?k/l:w/u}_isVisible(){const c=this.options.display;return"auto"!==c?!!c:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(c){const s=this.axis,l=this.chart,u=this.options,{grid:g,position:b}=u,w=g.offset,k=this.isHorizontal(),Z=this.ticks.length+(w?1:0),ht=Sa(g),Pt=[],qt=g.setContext(this.getContext()),be=qt.drawBorder?qt.borderWidth:0,Le=be/2,Ge=function(bn){return wr(l,bn,be)};let Xe,Ei,an,Hi,Wi,yn,fn,An,Bn,Cn,Qi,Vn;if("top"===b)Xe=Ge(this.bottom),yn=this.bottom-ht,An=Xe-Le,Cn=Ge(c.top)+Le,Vn=c.bottom;else if("bottom"===b)Xe=Ge(this.top),Cn=c.top,Vn=Ge(c.bottom)-Le,yn=Xe+Le,An=this.top+ht;else if("left"===b)Xe=Ge(this.right),Wi=this.right-ht,fn=Xe-Le,Bn=Ge(c.left)+Le,Qi=c.right;else if("right"===b)Xe=Ge(this.left),Bn=c.left,Qi=Ge(c.right)-Le,Wi=Xe+Le,fn=this.left+ht;else if("x"===s){if("center"===b)Xe=Ge((c.top+c.bottom)/2+.5);else if(at(b)){const bn=Object.keys(b)[0];Xe=Ge(this.chart.scales[bn].getPixelForValue(b[bn]))}Cn=c.top,Vn=c.bottom,yn=Xe+Le,An=yn+ht}else if("y"===s){if("center"===b)Xe=Ge((c.left+c.right)/2);else if(at(b)){const bn=Object.keys(b)[0];Xe=Ge(this.chart.scales[bn].getPixelForValue(b[bn]))}Wi=Xe-Le,fn=Wi-ht,Bn=c.left,Qi=c.right}const mo=Ft(u.ticks.maxTicksLimit,Z),_n=Math.max(1,Math.ceil(Z/mo));for(Ei=0;Ei<Z;Ei+=_n){const bn=g.setContext(this.getContext(Ei)),Pi=bn.lineWidth,nn=bn.color,Yn=g.borderDash||[],ro=bn.borderDashOffset,zs=bn.tickWidth,Zi=bn.tickColor,Qn=bn.tickBorderDash||[],Pr=bn.tickBorderDashOffset;an=Yr(this,Ei,w),void 0!==an&&(Hi=wr(l,an,Pi),k?Wi=fn=Bn=Qi=Hi:yn=An=Cn=Vn=Hi,Pt.push({tx1:Wi,ty1:yn,tx2:fn,ty2:An,x1:Bn,y1:Cn,x2:Qi,y2:Vn,width:Pi,color:nn,borderDash:Yn,borderDashOffset:ro,tickWidth:zs,tickColor:Zi,tickBorderDash:Qn,tickBorderDashOffset:Pr}))}return this._ticksLength=Z,this._borderValue=Xe,Pt}_computeLabelItems(c){const s=this.axis,l=this.options,{position:u,ticks:g}=l,b=this.isHorizontal(),w=this.ticks,{align:k,crossAlign:H,padding:Z,mirror:ht}=g,Pt=Sa(l.grid),qt=Pt+Z,be=ht?-Z:qt,Le=-Ti(this.labelRotation),Ge=[];let Xe,Ei,an,Hi,Wi,yn,fn,An,Bn,Cn,Qi,Vn,mo="middle";if("top"===u)yn=this.bottom-be,fn=this._getXAxisLabelAlignment();else if("bottom"===u)yn=this.top+be,fn=this._getXAxisLabelAlignment();else if("left"===u){const bn=this._getYAxisLabelAlignment(Pt);fn=bn.textAlign,Wi=bn.x}else if("right"===u){const bn=this._getYAxisLabelAlignment(Pt);fn=bn.textAlign,Wi=bn.x}else if("x"===s){if("center"===u)yn=(c.top+c.bottom)/2+qt;else if(at(u)){const bn=Object.keys(u)[0];yn=this.chart.scales[bn].getPixelForValue(u[bn])+qt}fn=this._getXAxisLabelAlignment()}else if("y"===s){if("center"===u)Wi=(c.left+c.right)/2-qt;else if(at(u)){const bn=Object.keys(u)[0];Wi=this.chart.scales[bn].getPixelForValue(u[bn])}fn=this._getYAxisLabelAlignment(Pt).textAlign}"y"===s&&("start"===k?mo="top":"end"===k&&(mo="bottom"));const _n=this._getLabelSizes();for(Xe=0,Ei=w.length;Xe<Ei;++Xe){an=w[Xe],Hi=an.label;const bn=g.setContext(this.getContext(Xe));An=this.getPixelForTick(Xe)+g.labelOffset,Bn=this._resolveTickFontOptions(Xe),Cn=Bn.lineHeight,Qi=bt(Hi)?Hi.length:1;const Pi=Qi/2,nn=bn.color,Yn=bn.textStrokeColor,ro=bn.textStrokeWidth;let zs;if(b?(Wi=An,Vn="top"===u?"near"===H||0!==Le?-Qi*Cn+Cn/2:"center"===H?-_n.highest.height/2-Pi*Cn+Cn:Cn/2-_n.highest.height:"near"===H||0!==Le?Cn/2:"center"===H?_n.highest.height/2-Pi*Cn:_n.highest.height-Qi*Cn,ht&&(Vn*=-1)):(yn=An,Vn=(1-Qi)*Cn/2),bn.showLabelBackdrop){const Zi=Go(bn.backdropPadding),Qn=_n.heights[Xe],Pr=_n.widths[Xe];let el=yn+Vn-Zi.top,$u=Wi-Zi.left;switch(mo){case"middle":el-=Qn/2;break;case"bottom":el-=Qn}switch(fn){case"center":$u-=Pr/2;break;case"right":$u-=Pr}zs={left:$u,top:el,width:Pr+Zi.width,height:Qn+Zi.height,color:bn.backdropColor}}Ge.push({rotation:Le,label:Hi,font:Bn,color:nn,strokeColor:Yn,strokeWidth:ro,textOffset:Vn,textAlign:fn,textBaseline:mo,translation:[Wi,yn],backdrop:zs})}return Ge}_getXAxisLabelAlignment(){const{position:c,ticks:s}=this.options;if(-Ti(this.labelRotation))return"top"===c?"left":"right";let u="center";return"start"===s.align?u="left":"end"===s.align&&(u="right"),u}_getYAxisLabelAlignment(c){const{position:s,ticks:{crossAlign:l,mirror:u,padding:g}}=this.options,w=c+g,k=this._getLabelSizes().widest.width;let H,Z;return"left"===s?u?(Z=this.right+g,"near"===l?H="left":"center"===l?(H="center",Z+=k/2):(H="right",Z+=k)):(Z=this.right-w,"near"===l?H="right":"center"===l?(H="center",Z-=k/2):(H="left",Z=this.left)):"right"===s?u?(Z=this.left+g,"near"===l?H="right":"center"===l?(H="center",Z-=k/2):(H="left",Z-=k)):(Z=this.left+w,"near"===l?H="left":"center"===l?(H="center",Z+=k/2):(H="right",Z=this.right)):H="right",{textAlign:H,x:Z}}_computeLabelArea(){if(this.options.ticks.mirror)return;const c=this.chart,s=this.options.position;return"left"===s||"right"===s?{top:0,left:this.left,bottom:c.height,right:this.right}:"top"===s||"bottom"===s?{top:this.top,left:0,bottom:this.bottom,right:c.width}:void 0}drawBackground(){const{ctx:c,options:{backgroundColor:s},left:l,top:u,width:g,height:b}=this;s&&(c.save(),c.fillStyle=s,c.fillRect(l,u,g,b),c.restore())}getLineWidthForValue(c){const s=this.options.grid;if(!this._isVisible()||!s.display)return 0;const u=this.ticks.findIndex(g=>g.value===c);return u>=0?s.setContext(this.getContext(u)).lineWidth:0}drawGrid(c){const s=this.options.grid,l=this.ctx,u=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(c));let g,b;const w=(k,H,Z)=>{!Z.width||!Z.color||(l.save(),l.lineWidth=Z.width,l.strokeStyle=Z.color,l.setLineDash(Z.borderDash||[]),l.lineDashOffset=Z.borderDashOffset,l.beginPath(),l.moveTo(k.x,k.y),l.lineTo(H.x,H.y),l.stroke(),l.restore())};if(s.display)for(g=0,b=u.length;g<b;++g){const k=u[g];s.drawOnChartArea&&w({x:k.x1,y:k.y1},{x:k.x2,y:k.y2},k),s.drawTicks&&w({x:k.tx1,y:k.ty1},{x:k.tx2,y:k.ty2},{color:k.tickColor,width:k.tickWidth,borderDash:k.tickBorderDash,borderDashOffset:k.tickBorderDashOffset})}}drawBorder(){const{chart:c,ctx:s,options:{grid:l}}=this,u=l.setContext(this.getContext()),g=l.drawBorder?u.borderWidth:0;if(!g)return;const b=l.setContext(this.getContext(0)).lineWidth,w=this._borderValue;let k,H,Z,ht;this.isHorizontal()?(k=wr(c,this.left,g)-g/2,H=wr(c,this.right,b)+b/2,Z=ht=w):(Z=wr(c,this.top,g)-g/2,ht=wr(c,this.bottom,b)+b/2,k=H=w),s.save(),s.lineWidth=u.borderWidth,s.strokeStyle=u.borderColor,s.beginPath(),s.moveTo(k,Z),s.lineTo(H,ht),s.stroke(),s.restore()}drawLabels(c){if(!this.options.ticks.display)return;const l=this.ctx,u=this._computeLabelArea();u&&ya(l,u);const g=this._labelItems||(this._labelItems=this._computeLabelItems(c));let b,w;for(b=0,w=g.length;b<w;++b){const k=g[b],H=k.font,Z=k.label;k.backdrop&&(l.fillStyle=k.backdrop.color,l.fillRect(k.backdrop.left,k.backdrop.top,k.backdrop.width,k.backdrop.height)),js(l,Z,0,k.textOffset,H,k)}u&&Vo(l)}drawTitle(){const{ctx:c,options:{position:s,title:l,reverse:u}}=this;if(!l.display)return;const g=Bo(l.font),b=Go(l.padding),w=l.align;let k=g.lineHeight/2;"bottom"===s||"center"===s||at(s)?(k+=b.bottom,bt(l.text)&&(k+=g.lineHeight*(l.text.length-1))):k+=b.top;const{titleX:H,titleY:Z,maxWidth:ht,rotation:Pt}=function ca(v,c,s,l){const{top:u,left:g,bottom:b,right:w,chart:k}=v,{chartArea:H,scales:Z}=k;let Pt,qt,be,ht=0;const Le=b-u,Ge=w-g;if(v.isHorizontal()){if(qt=gt(l,g,w),at(s)){const Xe=Object.keys(s)[0];be=Z[Xe].getPixelForValue(s[Xe])+Le-c}else be="center"===s?(H.bottom+H.top)/2+Le-c:Wc(v,s,c);Pt=w-g}else{if(at(s)){const Xe=Object.keys(s)[0];qt=Z[Xe].getPixelForValue(s[Xe])-Ge+c}else qt="center"===s?(H.left+H.right)/2-Ge+c:Wc(v,s,c);be=gt(l,b,u),ht="left"===s?-Ee:Ee}return{titleX:qt,titleY:be,maxWidth:Pt,rotation:ht}}(this,k,s,w);js(c,l.text,0,0,g,{color:l.color,maxWidth:ht,rotation:Pt,textAlign:wu(w,s,u),textBaseline:"middle",translation:[H,Z]})}draw(c){!this._isVisible()||(this.drawBackground(),this.drawGrid(c),this.drawBorder(),this.drawTitle(),this.drawLabels(c))}_layers(){const c=this.options,s=c.ticks&&c.ticks.z||0,l=Ft(c.grid&&c.grid.z,-1);return this._isVisible()&&this.draw===Ra.prototype.draw?[{z:l,draw:u=>{this.drawBackground(),this.drawGrid(u),this.drawTitle()}},{z:l+1,draw:()=>{this.drawBorder()}},{z:s,draw:u=>{this.drawLabels(u)}}]:[{z:s,draw:u=>{this.draw(u)}}]}getMatchingVisibleMetas(c){const s=this.chart.getSortedVisibleDatasetMetas(),l=this.axis+"AxisID",u=[];let g,b;for(g=0,b=s.length;g<b;++g){const w=s[g];w[l]===this.id&&(!c||w.type===c)&&u.push(w)}return u}_resolveTickFontOptions(c){return Bo(this.options.ticks.setContext(this.getContext(c)).font)}_maxDigits(){const c=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/c}}class vl{constructor(c,s,l){this.type=c,this.scope=s,this.override=l,this.items=Object.create(null)}isForType(c){return Object.prototype.isPrototypeOf.call(this.type.prototype,c.prototype)}register(c){const s=Object.getPrototypeOf(c);let l;(function zl(v){return"id"in v&&"defaults"in v})(s)&&(l=this.register(s));const u=this.items,g=c.id,b=this.scope+"."+g;if(!g)throw new Error("class does not have id: "+c);return g in u||(u[g]=c,function Rc(v,c,s){const l=_e(Object.create(null),[s?uo.get(s):{},uo.get(c),v.defaults]);uo.set(c,l),v.defaultRoutes&&function Al(v,c){Object.keys(c).forEach(s=>{const l=s.split("."),u=l.pop(),g=[v].concat(l).join("."),b=c[s].split("."),w=b.pop(),k=b.join(".");uo.route(g,u,k,w)})}(c,v.defaultRoutes),v.descriptors&&uo.describe(c,v.descriptors)}(c,b,l),this.override&&uo.override(c.id,c.overrides)),b}get(c){return this.items[c]}unregister(c){const s=this.items,l=c.id,u=this.scope;l in s&&delete s[l],u&&l in uo[u]&&(delete uo[u][l],this.override&&delete Rn[l])}}var Ia=new class zc{constructor(){this.controllers=new vl(ga,"datasets",!0),this.elements=new vl(la,"elements"),this.plugins=new vl(Object,"plugins"),this.scales=new vl(Ra,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...c){this._each("register",c)}remove(...c){this._each("unregister",c)}addControllers(...c){this._each("register",c,this.controllers)}addElements(...c){this._each("register",c,this.elements)}addPlugins(...c){this._each("register",c,this.plugins)}addScales(...c){this._each("register",c,this.scales)}getController(c){return this._get(c,this.controllers,"controller")}getElement(c){return this._get(c,this.elements,"element")}getPlugin(c){return this._get(c,this.plugins,"plugin")}getScale(c){return this._get(c,this.scales,"scale")}removeControllers(...c){this._each("unregister",c,this.controllers)}removeElements(...c){this._each("unregister",c,this.elements)}removePlugins(...c){this._each("unregister",c,this.plugins)}removeScales(...c){this._each("unregister",c,this.scales)}_each(c,s,l){[...s].forEach(u=>{const g=l||this._getRegistryForType(u);l||g.isForType(u)||g===this.plugins&&u.id?this._exec(c,g,u):rt(u,b=>{const w=l||this._getRegistryForType(b);this._exec(c,w,b)})})}_exec(c,s,l){const u=ri(c);ct(l["before"+u],[],l),s[c](l),ct(l["after"+u],[],l)}_getRegistryForType(c){for(let s=0;s<this._typedRegistries.length;s++){const l=this._typedRegistries[s];if(l.isForType(c))return l}return this.plugins}_get(c,s,l){const u=s.get(c);if(void 0===u)throw new Error('"'+c+'" is not a registered '+l+".");return u}};class jc{constructor(){this._init=[]}notify(c,s,l,u){"beforeInit"===s&&(this._init=this._createDescriptors(c,!0),this._notify(this._init,c,"install"));const g=u?this._descriptors(c).filter(u):this._descriptors(c),b=this._notify(g,c,s,l);return"destroy"===s&&(this._notify(g,c,"stop"),this._notify(this._init,c,"uninstall")),b}_notify(c,s,l,u){u=u||{};for(const g of c){const b=g.plugin;if(!1===ct(b[l],[s,u,g.options],b)&&u.cancelable)return!1}return!0}invalidate(){Ct(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(c){if(this._cache)return this._cache;const s=this._cache=this._createDescriptors(c);return this._notifyStateChanges(c),s}_createDescriptors(c,s){const l=c&&c.config,u=Ft(l.options&&l.options.plugins,{}),g=function Ic(v){const c=[],s=Object.keys(Ia.plugins.items);for(let u=0;u<s.length;u++)c.push(Ia.getPlugin(s[u]));const l=v.plugins||[];for(let u=0;u<l.length;u++){const g=l[u];-1===c.indexOf(g)&&c.push(g)}return c}(l);return!1!==u||s?function cr(v,c,s,l){const u=[],g=v.getContext();for(let b=0;b<c.length;b++){const w=c[b],H=uc(s[w.id],l);null!==H&&u.push({plugin:w,options:jl(v.config,w,H,g)})}return u}(c,g,u,s):[]}_notifyStateChanges(c){const s=this._oldCache||[],l=this._cache,u=(g,b)=>g.filter(w=>!b.some(k=>w.plugin.id===k.plugin.id));this._notify(u(s,l),c,"stop"),this._notify(u(l,s),c,"start")}}function uc(v,c){return c||!1!==v?!0===v?{}:v:null}function jl(v,c,s,l){const u=v.pluginScopeKeys(c),g=v.getOptionScopes(s,u);return v.createResolver(g,l,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function kl(v,c){return((c.datasets||{})[v]||{}).indexAxis||c.indexAxis||(uo.datasets[v]||{}).indexAxis||"x"}function Yc(v,c){return"x"===v||"y"===v?v:c.axis||function Yl(v){return"top"===v||"bottom"===v?"x":"left"===v||"right"===v?"y":void 0}(c.position)||v.charAt(0).toLowerCase()}function su(v){const c=v.options||(v.options={});c.plugins=Ft(c.plugins,{}),c.scales=function rc(v,c){const s=Rn[v.type]||{scales:{}},l=c.scales||{},u=kl(v.type,c),g=Object.create(null),b=Object.create(null);return Object.keys(l).forEach(w=>{const k=l[w];if(!at(k))return console.error(`Invalid scale configuration for scale: ${w}`);if(k._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${w}`);const H=Yc(w,k),Z=function Du(v,c){return v===c?"_index_":"_value_"}(H,u),ht=s.scales||{};g[H]=g[H]||w,b[w]=ce(Object.create(null),[{axis:H},k,ht[H],ht[Z]])}),v.data.datasets.forEach(w=>{const k=w.type||v.type,H=w.indexAxis||kl(k,c),ht=(Rn[k]||{}).scales||{};Object.keys(ht).forEach(Pt=>{const qt=function wc(v,c){let s=v;return"_index_"===v?s=c:"_value_"===v&&(s="x"===c?"y":"x"),s}(Pt,H),be=w[qt+"AxisID"]||g[qt]||qt;b[be]=b[be]||Object.create(null),ce(b[be],[{axis:qt},l[be],ht[Pt]])})}),Object.keys(b).forEach(w=>{const k=b[w];ce(k,[uo.scales[k.type],uo.scale])}),b}(v,c)}function Dc(v){return(v=v||{}).datasets=v.datasets||[],v.labels=v.labels||[],v}const xl=new Map,Ll=new Set;function tl(v,c){let s=xl.get(v);return s||(s=c(),xl.set(v,s),Ll.add(s)),s}const Kc=(v,c,s)=>{const l=Me(c,s);void 0!==l&&v.add(l)};class Hu{constructor(c){this._config=function Xc(v){return(v=v||{}).data=Dc(v.data),su(v),v}(c),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(c){this._config.type=c}get data(){return this._config.data}set data(c){this._config.data=Dc(c)}get options(){return this._config.options}set options(c){this._config.options=c}get plugins(){return this._config.plugins}update(){const c=this._config;this.clearCache(),su(c)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(c){return tl(c,()=>[[`datasets.${c}`,""]])}datasetAnimationScopeKeys(c,s){return tl(`${c}.transition.${s}`,()=>[[`datasets.${c}.transitions.${s}`,`transitions.${s}`],[`datasets.${c}`,""]])}datasetElementScopeKeys(c,s){return tl(`${c}-${s}`,()=>[[`datasets.${c}.elements.${s}`,`datasets.${c}`,`elements.${s}`,""]])}pluginScopeKeys(c){const s=c.id;return tl(`${this.type}-plugin-${s}`,()=>[[`plugins.${s}`,...c.additionalOptionScopes||[]]])}_cachedScopes(c,s){const l=this._scopeCache;let u=l.get(c);return(!u||s)&&(u=new Map,l.set(c,u)),u}getOptionScopes(c,s,l){const{options:u,type:g}=this,b=this._cachedScopes(c,l),w=b.get(s);if(w)return w;const k=new Set;s.forEach(Z=>{c&&(k.add(c),Z.forEach(ht=>Kc(k,c,ht))),Z.forEach(ht=>Kc(k,u,ht)),Z.forEach(ht=>Kc(k,Rn[g]||{},ht)),Z.forEach(ht=>Kc(k,uo,ht)),Z.forEach(ht=>Kc(k,Kr,ht))});const H=Array.from(k);return 0===H.length&&H.push(Object.create(null)),Ll.has(s)&&b.set(s,H),H}chartOptionScopes(){const{options:c,type:s}=this;return[c,Rn[s]||{},uo.datasets[s]||{},{type:s},uo,Kr]}resolveNamedOptions(c,s,l,u=[""]){const g={$shared:!0},{resolver:b,subPrefixes:w}=yl(this._resolverCache,c,u);let k=b;(function hl(v,c){const{isScriptable:s,isIndexable:l}=hr(v);for(const u of c){const g=s(u),b=l(u),w=(b||g)&&v[u];if(g&&(Ie(w)||Tl(w))||b&&bt(w))return!0}return!1})(b,s)&&(g.$shared=!1,k=Cs(b,l=Ie(l)?l():l,this.createResolver(c,l,w)));for(const H of s)g[H]=k[H];return g}createResolver(c,s,l=[""],u){const{resolver:g}=yl(this._resolverCache,c,l);return at(s)?Cs(g,s,void 0,u):g}}function yl(v,c,s){let l=v.get(c);l||(l=new Map,v.set(c,l));const u=s.join();let g=l.get(u);return g||(g={resolver:Lo(c,s),subPrefixes:s.filter(w=>!w.toLowerCase().includes("hover"))},l.set(u,g)),g}const Tl=v=>at(v)&&Object.getOwnPropertyNames(v).reduce((c,s)=>c||Ie(v[s]),!1),va=["top","bottom","left","right","chartArea"];function au(v,c){return"top"===v||"bottom"===v||-1===va.indexOf(v)&&"x"===c}function Nl(v,c){return function(s,l){return s[v]===l[v]?s[c]-l[c]:s[v]-l[v]}}function Uu(v){const c=v.chart,s=c.options.animation;c.notifyPlugins("afterRender"),ct(s&&s.onComplete,[v],c)}function ms(v){const c=v.chart,s=c.options.animation;ct(s&&s.onProgress,[v],c)}function Mc(v){return sl()&&"string"==typeof v?v=document.getElementById(v):v&&v.length&&(v=v[0]),v&&v.canvas&&(v=v.canvas),v}const mt={},Rt=v=>{const c=Mc(v);return Object.values(mt).filter(s=>s.canvas===c).pop()};function te(v,c,s){const l=Object.keys(v);for(const u of l){const g=+u;if(g>=c){const b=v[u];delete v[u],(s>0||g>c)&&(v[g+s]=b)}}}class Re{constructor(c,s){const l=this.config=new Hu(s),u=Mc(c),g=Rt(u);if(g)throw new Error("Canvas is already in use. Chart with ID '"+g.id+"' must be destroyed before the canvas can be reused.");const b=l.createResolver(l.chartOptionScopes(),this.getContext());this.platform=new(l.platform||function Uc(v){return!sl()||"undefined"!=typeof OffscreenCanvas&&v instanceof OffscreenCanvas?Ca:Ao}(u)),this.platform.updateConfig(l);const w=this.platform.acquireContext(u,b.aspectRatio),k=w&&w.canvas,H=k&&k.height,Z=k&&k.width;this.id=Jt(),this.ctx=w,this.canvas=k,this.width=Z,this.height=H,this._options=b,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new jc,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function Et(v,c){let s;return function(...l){return c?(clearTimeout(s),s=setTimeout(v,c,l)):v.apply(this,l),c}}(ht=>this.update(ht),b.resizeDelay||0),this._dataChanges=[],mt[this.id]=this,w&&k?(Sn.listen(this,"complete",Uu),Sn.listen(this,"progress",ms),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:c,maintainAspectRatio:s},width:l,height:u,_aspectRatio:g}=this;return Ct(c)?s&&g?g:u?l/u:null:c}get data(){return this.config.data}set data(c){this.config.data=c}get options(){return this._options}set options(c){this.config.options=c}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Te(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Ua(this.canvas,this.ctx),this}stop(){return Sn.stop(this),this}resize(c,s){Sn.running(this)?this._resizeBeforeDraw={width:c,height:s}:this._resize(c,s)}_resize(c,s){const l=this.options,b=this.platform.getMaximumSize(this.canvas,c,s,l.maintainAspectRatio&&this.aspectRatio),w=l.devicePixelRatio||this.platform.getDevicePixelRatio(),k=this.width?"resize":"attach";this.width=b.width,this.height=b.height,this._aspectRatio=this.aspectRatio,Te(this,w,!0)&&(this.notifyPlugins("resize",{size:b}),ct(l.onResize,[this,b],this),this.attached&&this._doResize(k)&&this.render())}ensureScalesHaveIDs(){rt(this.options.scales||{},(l,u)=>{l.id=u})}buildOrUpdateScales(){const c=this.options,s=c.scales,l=this.scales,u=Object.keys(l).reduce((b,w)=>(b[w]=!1,b),{});let g=[];s&&(g=g.concat(Object.keys(s).map(b=>{const w=s[b],k=Yc(b,w),H="r"===k,Z="x"===k;return{options:w,dposition:H?"chartArea":Z?"bottom":"left",dtype:H?"radialLinear":Z?"category":"linear"}}))),rt(g,b=>{const w=b.options,k=w.id,H=Yc(k,w),Z=Ft(w.type,b.dtype);(void 0===w.position||au(w.position,H)!==au(b.dposition))&&(w.position=b.dposition),u[k]=!0;let ht=null;k in l&&l[k].type===Z?ht=l[k]:(ht=new(Ia.getScale(Z))({id:k,type:Z,ctx:this.ctx,chart:this}),l[ht.id]=ht),ht.init(w,c)}),rt(u,(b,w)=>{b||delete l[w]}),rt(l,b=>{Rs.configure(this,b,b.options),Rs.addBox(this,b)})}_updateMetasets(){const c=this._metasets,s=this.data.datasets.length,l=c.length;if(c.sort((u,g)=>u.index-g.index),l>s){for(let u=s;u<l;++u)this._destroyDatasetMeta(u);c.splice(s,l-s)}this._sortedMetasets=c.slice(0).sort(Nl("order","index"))}_removeUnreferencedMetasets(){const{_metasets:c,data:{datasets:s}}=this;c.length>s.length&&delete this._stacks,c.forEach((l,u)=>{0===s.filter(g=>g===l._dataset).length&&this._destroyDatasetMeta(u)})}buildOrUpdateControllers(){const c=[],s=this.data.datasets;let l,u;for(this._removeUnreferencedMetasets(),l=0,u=s.length;l<u;l++){const g=s[l];let b=this.getDatasetMeta(l);const w=g.type||this.config.type;if(b.type&&b.type!==w&&(this._destroyDatasetMeta(l),b=this.getDatasetMeta(l)),b.type=w,b.indexAxis=g.indexAxis||kl(w,this.options),b.order=g.order||0,b.index=l,b.label=""+g.label,b.visible=this.isDatasetVisible(l),b.controller)b.controller.updateIndex(l),b.controller.linkScales();else{const k=Ia.getController(w),{datasetElementType:H,dataElementType:Z}=uo.datasets[w];Object.assign(k.prototype,{dataElementType:Ia.getElement(Z),datasetElementType:H&&Ia.getElement(H)}),b.controller=new k(this,l),c.push(b.controller)}}return this._updateMetasets(),c}_resetElements(){rt(this.data.datasets,(c,s)=>{this.getDatasetMeta(s).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(c){const s=this.config;s.update();const l=this._options=s.createResolver(s.chartOptionScopes(),this.getContext()),u=this._animationsDisabled=!l.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:c,cancelable:!0}))return;const g=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let b=0;for(let w=0,k=this.data.datasets.length;w<k;w++){const{controller:H}=this.getDatasetMeta(w),Z=!u&&-1===g.indexOf(H);H.buildOrUpdateElements(Z),b=Math.max(+H.getMaxOverflow(),b)}b=this._minPadding=l.layout.autoPadding?b:0,this._updateLayout(b),u||rt(g,w=>{w.reset()}),this._updateDatasets(c),this.notifyPlugins("afterUpdate",{mode:c}),this._layers.sort(Nl("z","_idx")),this._lastEvent&&this._eventHandler(this._lastEvent,!0),this.render()}_updateScales(){rt(this.scales,c=>{Rs.removeBox(this,c)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const c=this.options,s=new Set(Object.keys(this._listeners)),l=new Set(c.events);(!Xt(s,l)||!!this._responsiveListeners!==c.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:c}=this,s=this._getUniformDataChanges()||[];for(const{method:l,start:u,count:g}of s)te(c,u,"_removeElements"===l?-g:g)}_getUniformDataChanges(){const c=this._dataChanges;if(!c||!c.length)return;this._dataChanges=[];const s=this.data.datasets.length,l=g=>new Set(c.filter(b=>b[0]===g).map((b,w)=>w+","+b.splice(1).join(","))),u=l(0);for(let g=1;g<s;g++)if(!Xt(u,l(g)))return;return Array.from(u).map(g=>g.split(",")).map(g=>({method:g[1],start:+g[2],count:+g[3]}))}_updateLayout(c){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Rs.update(this,this.width,this.height,c);const s=this.chartArea,l=s.width<=0||s.height<=0;this._layers=[],rt(this.boxes,u=>{l&&"chartArea"===u.position||(u.configure&&u.configure(),this._layers.push(...u._layers()))},this),this._layers.forEach((u,g)=>{u._idx=g}),this.notifyPlugins("afterLayout")}_updateDatasets(c){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:c,cancelable:!0})){for(let s=0,l=this.data.datasets.length;s<l;++s)this.getDatasetMeta(s).controller.configure();for(let s=0,l=this.data.datasets.length;s<l;++s)this._updateDataset(s,Ie(c)?c({datasetIndex:s}):c);this.notifyPlugins("afterDatasetsUpdate",{mode:c})}}_updateDataset(c,s){const l=this.getDatasetMeta(c),u={meta:l,index:c,mode:s,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",u)&&(l.controller._update(s),u.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",u))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Sn.has(this)?this.attached&&!Sn.running(this)&&Sn.start(this):(this.draw(),Uu({chart:this})))}draw(){let c;if(this._resizeBeforeDraw){const{width:l,height:u}=this._resizeBeforeDraw;this._resize(l,u),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const s=this._layers;for(c=0;c<s.length&&s[c].z<=0;++c)s[c].draw(this.chartArea);for(this._drawDatasets();c<s.length;++c)s[c].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(c){const s=this._sortedMetasets,l=[];let u,g;for(u=0,g=s.length;u<g;++u){const b=s[u];(!c||b.visible)&&l.push(b)}return l}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const c=this.getSortedVisibleDatasetMetas();for(let s=c.length-1;s>=0;--s)this._drawDataset(c[s]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(c){const s=this.ctx,l=c._clip,u=!l.disabled,g=this.chartArea,b={meta:c,index:c.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",b)&&(u&&ya(s,{left:!1===l.left?0:g.left-l.left,right:!1===l.right?this.width:g.right+l.right,top:!1===l.top?0:g.top-l.top,bottom:!1===l.bottom?this.height:g.bottom+l.bottom}),c.controller.draw(),u&&Vo(s),b.cancelable=!1,this.notifyPlugins("afterDatasetDraw",b))}getElementsAtEventForMode(c,s,l,u){const g=Dr.modes[s];return"function"==typeof g?g(this,c,l,u):[]}getDatasetMeta(c){const s=this.data.datasets[c],l=this._metasets;let u=l.filter(g=>g&&g._dataset===s).pop();return u||(u={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:s&&s.order||0,index:c,_dataset:s,_parsed:[],_sorted:!1},l.push(u)),u}getContext(){return this.$context||(this.$context=zr(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(c){const s=this.data.datasets[c];if(!s)return!1;const l=this.getDatasetMeta(c);return"boolean"==typeof l.hidden?!l.hidden:!s.hidden}setDatasetVisibility(c,s){this.getDatasetMeta(c).hidden=!s}toggleDataVisibility(c){this._hiddenIndices[c]=!this._hiddenIndices[c]}getDataVisibility(c){return!this._hiddenIndices[c]}_updateVisibility(c,s,l){const u=l?"show":"hide",g=this.getDatasetMeta(c),b=g.controller._resolveAnimations(void 0,u);Bt(s)?(g.data[s].hidden=!l,this.update()):(this.setDatasetVisibility(c,l),b.update(g,{visible:l}),this.update(w=>w.datasetIndex===c?u:void 0))}hide(c,s){this._updateVisibility(c,s,!1)}show(c,s){this._updateVisibility(c,s,!0)}_destroyDatasetMeta(c){const s=this._metasets[c];s&&s.controller&&s.controller._destroy(),delete this._metasets[c]}_stop(){let c,s;for(this.stop(),Sn.remove(this),c=0,s=this.data.datasets.length;c<s;++c)this._destroyDatasetMeta(c)}destroy(){const{canvas:c,ctx:s}=this;this._stop(),this.config.clearCache(),c&&(this.unbindEvents(),Ua(c,s),this.platform.releaseContext(s),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete mt[this.id]}toBase64Image(...c){return this.canvas.toDataURL(...c)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const c=this._listeners,s=this.platform,l=(g,b)=>{s.addEventListener(this,g,b),c[g]=b},u=(g,b,w)=>{g.offsetX=b,g.offsetY=w,this._eventHandler(g)};rt(this.options.events,g=>l(g,u))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const c=this._responsiveListeners,s=this.platform,l=(k,H)=>{s.addEventListener(this,k,H),c[k]=H},u=(k,H)=>{c[k]&&(s.removeEventListener(this,k,H),delete c[k])},g=(k,H)=>{this.canvas&&this.resize(k,H)};let b;const w=()=>{u("attach",w),this.attached=!0,this.resize(),l("resize",g),l("detach",b)};b=()=>{this.attached=!1,u("resize",g),this._stop(),this._resize(0,0),l("attach",w)},s.isAttached(this.canvas)?w():b()}unbindEvents(){rt(this._listeners,(c,s)=>{this.platform.removeEventListener(this,s,c)}),this._listeners={},rt(this._responsiveListeners,(c,s)=>{this.platform.removeEventListener(this,s,c)}),this._responsiveListeners=void 0}updateHoverStyle(c,s,l){const u=l?"set":"remove";let g,b,w,k;for("dataset"===s&&(g=this.getDatasetMeta(c[0].datasetIndex),g.controller["_"+u+"DatasetHoverStyle"]()),w=0,k=c.length;w<k;++w){b=c[w];const H=b&&this.getDatasetMeta(b.datasetIndex).controller;H&&H[u+"HoverStyle"](b.element,b.datasetIndex,b.index)}}getActiveElements(){return this._active||[]}setActiveElements(c){const s=this._active||[],l=c.map(({datasetIndex:g,index:b})=>{const w=this.getDatasetMeta(g);if(!w)throw new Error("No dataset found at index "+g);return{datasetIndex:g,element:w.data[b],index:b}});!se(l,s)&&(this._active=l,this._updateHoverStyles(l,s))}notifyPlugins(c,s,l){return this._plugins.notify(this,c,s,l)}_updateHoverStyles(c,s,l){const u=this.options.hover,g=(k,H)=>k.filter(Z=>!H.some(ht=>Z.datasetIndex===ht.datasetIndex&&Z.index===ht.index)),b=g(s,c),w=l?c:g(c,s);b.length&&this.updateHoverStyle(b,u.mode,!1),w.length&&u.mode&&this.updateHoverStyle(w,u.mode,!0)}_eventHandler(c,s){const l={event:c,replay:s,cancelable:!0},u=b=>(b.options.events||this.options.events).includes(c.native.type);if(!1===this.notifyPlugins("beforeEvent",l,u))return;const g=this._handleEvent(c,s);return l.cancelable=!1,this.notifyPlugins("afterEvent",l,u),(g||l.changed)&&this.render(),this}_handleEvent(c,s){const{_active:l=[],options:u}=this,g=u.hover;let w=[],k=!1,H=null;return"mouseout"!==c.type&&(w=this.getElementsAtEventForMode(c,g.mode,g,s),H="click"===c.type?this._lastEvent:c),this._lastEvent=null,us(c,this.chartArea,this._minPadding)&&(ct(u.onHover,[c,w,this],this),("mouseup"===c.type||"click"===c.type||"contextmenu"===c.type)&&ct(u.onClick,[c,w,this],this)),k=!se(w,l),(k||s)&&(this._active=w,this._updateHoverStyles(w,l,s)),this._lastEvent=H,k}}const Ue=()=>rt(Re.instances,v=>v._plugins.invalidate()),ci=!0;function Ze(v,c,s){const{startAngle:l,pixelMargin:u,x:g,y:b,outerRadius:w,innerRadius:k}=c;let H=u/w;v.beginPath(),v.arc(g,b,w,l-H,s+H),k>u?(H=u/k,v.arc(g,b,k,s+H,l-H,!0)):v.arc(g,b,u,s+Ee,l-Ee),v.closePath(),v.clip()}function Ai(v,c,s,l){return{x:s+v*Math.cos(c),y:l+v*Math.sin(c)}}function Vi(v,c,s,l,u){const{x:g,y:b,startAngle:w,pixelMargin:k,innerRadius:H}=c,Z=Math.max(c.outerRadius+l+s-k,0),ht=H>0?H+l+s+k:0;let Pt=0;const qt=u-w;if(l){const Yn=((H>0?H-l:0)+(Z>0?Z-l:0))/2;Pt=(qt-(0!==Yn?qt*Yn/(Yn+l):qt))/2}const Le=(qt-Math.max(.001,qt*Z-s/he)/Z)/2,Ge=w+Le+Pt,Xe=u-Le-Pt,{outerStart:Ei,outerEnd:an,innerStart:Hi,innerEnd:Wi}=function ki(v,c,s,l){const u=function ai(v){return rl(v,["outerStart","outerEnd","innerStart","innerEnd"])}(v.options.borderRadius),g=(s-c)/2,b=Math.min(g,l*c/2),w=k=>{const H=(s-Math.min(g,k))*l/2;return _i(k,0,Math.min(g,H))};return{outerStart:w(u.outerStart),outerEnd:w(u.outerEnd),innerStart:_i(u.innerStart,0,b),innerEnd:_i(u.innerEnd,0,b)}}(c,ht,Z,Xe-Ge),yn=Z-Ei,fn=Z-an,An=Ge+Ei/yn,Bn=Xe-an/fn,Cn=ht+Hi,Qi=ht+Wi,Vn=Ge+Hi/Cn,mo=Xe-Wi/Qi;if(v.beginPath(),v.arc(g,b,Z,An,Bn),an>0){const Pi=Ai(fn,Bn,g,b);v.arc(Pi.x,Pi.y,an,Bn,Xe+Ee)}const _n=Ai(Qi,Xe,g,b);if(v.lineTo(_n.x,_n.y),Wi>0){const Pi=Ai(Qi,mo,g,b);v.arc(Pi.x,Pi.y,Wi,Xe+Ee,mo+Math.PI)}if(v.arc(g,b,ht,Xe-Wi/ht,Ge+Hi/ht,!0),Hi>0){const Pi=Ai(Cn,Vn,g,b);v.arc(Pi.x,Pi.y,Hi,Vn+Math.PI,Ge-Ee)}const bn=Ai(yn,Ge,g,b);if(v.lineTo(bn.x,bn.y),Ei>0){const Pi=Ai(yn,An,g,b);v.arc(Pi.x,Pi.y,Ei,Ge-Ee,An)}v.closePath()}Object.defineProperties(Re,{defaults:{enumerable:ci,value:uo},instances:{enumerable:ci,value:mt},overrides:{enumerable:ci,value:Rn},registry:{enumerable:ci,value:Ia},version:{enumerable:ci,value:"3.6.2"},getChart:{enumerable:ci,value:Rt},register:{enumerable:ci,value:(...v)=>{Ia.add(...v),Ue()}},unregister:{enumerable:ci,value:(...v)=>{Ia.remove(...v),Ue()}}});class Ur extends la{constructor(c){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,c&&Object.assign(this,c)}inRange(c,s,l){const u=this.getProps(["x","y"],l),{angle:g,distance:b}=function Gi(v,c){const s=c.x-v.x,l=c.y-v.y,u=Math.sqrt(s*s+l*l);let g=Math.atan2(l,s);return g<-.5*he&&(g+=Dt),{angle:g,distance:u}}(u,{x:c,y:s}),{startAngle:w,endAngle:k,innerRadius:H,outerRadius:Z,circumference:ht}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],l),Pt=this.options.spacing/2,be=Ft(ht,k-w)>=Dt||De(g,w,k),Le=Fi(b,H+Pt,Z+Pt);return be&&Le}getCenterPoint(c){const{x:s,y:l,startAngle:u,endAngle:g,innerRadius:b,outerRadius:w}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],c),{offset:k,spacing:H}=this.options,Z=(u+g)/2,ht=(b+w+H+k)/2;return{x:s+Math.cos(Z)*ht,y:l+Math.sin(Z)*ht}}tooltipPosition(c){return this.getCenterPoint(c)}draw(c){const{options:s,circumference:l}=this,u=(s.offset||0)/2,g=(s.spacing||0)/2;if(this.pixelMargin="inner"===s.borderAlign?.33:0,this.fullCircles=l>Dt?Math.floor(l/Dt):0,0===l||this.innerRadius<0||this.outerRadius<0)return;c.save();let b=0;if(u){b=u/2;const k=(this.startAngle+this.endAngle)/2;c.translate(Math.cos(k)*b,Math.sin(k)*b),this.circumference>=he&&(b=u)}c.fillStyle=s.backgroundColor,c.strokeStyle=s.borderColor;const w=function to(v,c,s,l){const{fullCircles:u,startAngle:g,circumference:b}=c;let w=c.endAngle;if(u){Vi(v,c,s,l,g+Dt);for(let k=0;k<u;++k)v.fill();isNaN(b)||(w=g+b%Dt,b%Dt==0&&(w+=Dt))}return Vi(v,c,s,l,w),v.fill(),w}(c,this,b,g);(function ho(v,c,s,l,u){const{options:g}=c,b="inner"===g.borderAlign;!g.borderWidth||(b?(v.lineWidth=2*g.borderWidth,v.lineJoin="round"):(v.lineWidth=g.borderWidth,v.lineJoin="bevel"),c.fullCircles&&function zn(v,c,s){const{x:l,y:u,startAngle:g,pixelMargin:b,fullCircles:w}=c,k=Math.max(c.outerRadius-b,0),H=c.innerRadius+b;let Z;for(s&&Ze(v,c,g+Dt),v.beginPath(),v.arc(l,u,H,g+Dt,g,!0),Z=0;Z<w;++Z)v.stroke();for(v.beginPath(),v.arc(l,u,k,g,g+Dt),Z=0;Z<w;++Z)v.stroke()}(v,c,b),b&&Ze(v,c,u),Vi(v,c,s,l,u),v.stroke())})(c,this,b,g,w),c.restore()}}function br(v,c,s=c){v.lineCap=Ft(s.borderCapStyle,c.borderCapStyle),v.setLineDash(Ft(s.borderDash,c.borderDash)),v.lineDashOffset=Ft(s.borderDashOffset,c.borderDashOffset),v.lineJoin=Ft(s.borderJoinStyle,c.borderJoinStyle),v.lineWidth=Ft(s.borderWidth,c.borderWidth),v.strokeStyle=Ft(s.borderColor,c.borderColor)}function $o(v,c,s){v.lineTo(s.x,s.y)}function Xr(v,c,s={}){const l=v.length,{start:u=0,end:g=l-1}=s,{start:b,end:w}=c,k=Math.max(u,b),H=Math.min(g,w);return{count:l,start:k,loop:c.loop,ilen:H<k&&!(u<b&&g<b||u>w&&g>w)?l+H-k:H-k}}function mr(v,c,s,l){const{points:u,options:g}=c,{count:b,start:w,loop:k,ilen:H}=Xr(u,s,l),Z=function fr(v){return v.stepped?Ma:v.tension||"monotone"===v.cubicInterpolationMode?dl:$o}(g);let qt,be,Le,{move:ht=!0,reverse:Pt}=l||{};for(qt=0;qt<=H;++qt)be=u[(w+(Pt?H-qt:qt))%b],!be.skip&&(ht?(v.moveTo(be.x,be.y),ht=!1):Z(v,Le,be,Pt,g.stepped),Le=be);return k&&(be=u[(w+(Pt?H:0))%b],Z(v,Le,be,Pt,g.stepped)),!!k}function ua(v,c,s,l){const u=c.points,{count:g,start:b,ilen:w}=Xr(u,s,l),{move:k=!0,reverse:H}=l||{};let Pt,qt,be,Le,Ge,Xe,Z=0,ht=0;const Ei=Hi=>(b+(H?w-Hi:Hi))%g,an=()=>{Le!==Ge&&(v.lineTo(Z,Ge),v.lineTo(Z,Le),v.lineTo(Z,Xe))};for(k&&(qt=u[Ei(0)],v.moveTo(qt.x,qt.y)),Pt=0;Pt<=w;++Pt){if(qt=u[Ei(Pt)],qt.skip)continue;const Hi=qt.x,Wi=qt.y,yn=0|Hi;yn===be?(Wi<Le?Le=Wi:Wi>Ge&&(Ge=Wi),Z=(ht*Z+Hi)/++ht):(an(),v.lineTo(Hi,Wi),be=yn,ht=0,Le=Ge=Wi),Xe=Wi}an()}function rs(v){const c=v.options;return v._decimated||v._loop||c.tension||"monotone"===c.cubicInterpolationMode||c.stepped||c.borderDash&&c.borderDash.length?mr:ua}Ur.id="arc",Ur.defaults={borderAlign:"center",borderColor:"#fff",borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0},Ur.defaultRoutes={backgroundColor:"backgroundColor"};const Gh="function"==typeof Path2D;let Oc=(()=>{class v extends la{constructor(s){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,s&&Object.assign(this,s)}updateControlPoints(s,l){const u=this.options;!u.tension&&"monotone"!==u.cubicInterpolationMode||u.stepped||this._pointsUpdated||(Ks(this._points,u,s,u.spanGaps?this._loop:this._fullLoop,l),this._pointsUpdated=!0)}set points(s){this._points=s,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function Zs(v,c){const s=v.points,l=v.options.spanGaps,u=s.length;if(!u)return[];const g=!!v._loop,{start:b,end:w}=function Js(v,c,s,l){let u=0,g=c-1;if(s&&!l)for(;u<c&&!v[u].skip;)u++;for(;u<c&&v[u].skip;)u++;for(u%=c,s&&(g+=u);g>u&&v[g%c].skip;)g--;return g%=c,{start:u,end:g}}(s,u,g,l);return function Aa(v,c,s,l){return l&&l.setContext&&s?function ir(v,c,s,l){const u=v._chart.getContext(),g=Qs(v.options),{_datasetIndex:b,options:{spanGaps:w}}=v,k=s.length,H=[];let Z=g,ht=c[0].start,Pt=ht;function qt(be,Le,Ge,Xe){const Ei=w?-1:1;if(be!==Le){for(be+=k;s[be%k].skip;)be-=Ei;for(;s[Le%k].skip;)Le+=Ei;be%k!=Le%k&&(H.push({start:be%k,end:Le%k,loop:Ge,style:Xe}),Z=Xe,ht=Le%k)}}for(const be of c){ht=w?ht:be.start;let Ge,Le=s[ht%k];for(Pt=ht+1;Pt<=be.end;Pt++){const Xe=s[Pt%k];Ge=Qs(l.setContext(zr(u,{type:"segment",p0:Le,p1:Xe,p0DataIndex:(Pt-1)%k,p1DataIndex:Pt%k,datasetIndex:b}))),ja(Ge,Z)&&qt(ht,Pt-1,be.loop,Z),Le=Xe,Z=Ge}ht<Pt-1&&qt(ht,Pt-1,be.loop,Z)}return H}(v,c,s,l):c}(v,!0===l?[{start:b,end:w,loop:g}]:function $s(v,c,s,l){const u=v.length,g=[];let k,b=c,w=v[c];for(k=c+1;k<=s;++k){const H=v[k%u];H.skip||H.stop?w.skip||(g.push({start:c%u,end:(k-1)%u,loop:l=!1}),c=b=H.stop?k:null):(b=k,w.skip&&(c=k)),w=H}return null!==b&&g.push({start:c%u,end:b%u,loop:l}),g}(s,b,w<b?w+u:w,!!v._fullLoop&&0===b&&w===u-1),s,c)}(this,this.options.segment))}first(){const s=this.segments;return s.length&&this.points[s[0].start]}last(){const s=this.segments,u=s.length;return u&&this.points[s[u-1].end]}interpolate(s,l){const u=this.options,g=s[l],b=this.points,w=Sr(this,{property:l,start:g,end:g});if(!w.length)return;const k=[],H=function ws(v){return v.stepped?Ui:v.tension||"monotone"===v.cubicInterpolationMode?hn:mi}(u);let Z,ht;for(Z=0,ht=w.length;Z<ht;++Z){const{start:Pt,end:qt}=w[Z],be=b[Pt],Le=b[qt];if(be===Le){k.push(be);continue}const Xe=H(be,Le,Math.abs((g-be[l])/(Le[l]-be[l])),u.stepped);Xe[l]=s[l],k.push(Xe)}return 1===k.length?k[0]:k}pathSegment(s,l,u){return rs(this)(s,this,l,u)}path(s,l,u){const g=this.segments,b=rs(this);let w=this._loop;l=l||0,u=u||this.points.length-l;for(const k of g)w&=b(s,this,k,{start:l,end:l+u-1});return!!w}draw(s,l,u,g){(this.points||[]).length&&(this.options||{}).borderWidth&&(s.save(),function Vu(v,c,s,l){Gh&&!c.options.segment?function bl(v,c,s,l){let u=c._path;u||(u=c._path=new Path2D,c.path(u,s,l)&&u.closePath()),br(v,c.options),v.stroke(u)}(v,c,s,l):function lu(v,c,s,l){const{segments:u,options:g}=c,b=rs(c);for(const w of u)br(v,g,w.style),v.beginPath(),b(v,c,w,{start:s,end:s+l-1})&&v.closePath(),v.stroke()}(v,c,s,l)}(s,this,u,g),s.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return v.id="line",v.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},v.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},v.descriptors={_scriptable:!0,_indexable:c=>"borderDash"!==c&&"fill"!==c},v})();function Gu(v,c,s,l){const u=v.options,{[s]:g}=v.getProps([s],l);return Math.abs(c-g)<u.radius+u.hitRadius}let Ac=(()=>{class v extends la{constructor(s){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,s&&Object.assign(this,s)}inRange(s,l,u){const g=this.options,{x:b,y:w}=this.getProps(["x","y"],u);return Math.pow(s-b,2)+Math.pow(l-w,2)<Math.pow(g.hitRadius+g.radius,2)}inXRange(s,l){return Gu(this,s,"x",l)}inYRange(s,l){return Gu(this,s,"y",l)}getCenterPoint(s){const{x:l,y:u}=this.getProps(["x","y"],s);return{x:l,y:u}}size(s){let l=(s=s||this.options||{}).radius||0;return l=Math.max(l,l&&s.hoverRadius||0),2*(l+(l&&s.borderWidth||0))}draw(s,l){const u=this.options;this.skip||u.radius<.1||!us(this,l,this.size(u)/2)||(s.strokeStyle=u.borderColor,s.lineWidth=u.borderWidth,s.fillStyle=u.backgroundColor,Cr(s,u,this.x,this.y))}getRange(){const s=this.options||{};return s.radius+s.hitRadius}}return v.id="point",v.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},v.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},v})();function Jc(v,c){const{x:s,y:l,base:u,width:g,height:b}=v.getProps(["x","y","base","width","height"],c);let w,k,H,Z,ht;return v.horizontal?(ht=b/2,w=Math.min(s,u),k=Math.max(s,u),H=l-ht,Z=l+ht):(ht=g/2,w=s-ht,k=s+ht,H=Math.min(l,u),Z=Math.max(l,u)),{left:w,top:H,right:k,bottom:Z}}function dc(v,c,s,l){return v?0:_i(c,s,l)}function Wu(v,c,s,l){const u=null===c,g=null===s,w=v&&!(u&&g)&&Jc(v,l);return w&&(u||Fi(c,w.left,w.right))&&(g||Fi(s,w.top,w.bottom))}function cu(v,c){v.rect(c.x,c.y,c.w,c.h)}function pc(v,c,s={}){const l=v.x!==s.x?-c:0,u=v.y!==s.y?-c:0;return{x:v.x+l,y:v.y+u,w:v.w+((v.x+v.w!==s.x+s.w?c:0)-l),h:v.h+((v.y+v.h!==s.y+s.h?c:0)-u),radius:v.radius}}class uu extends la{constructor(c){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,c&&Object.assign(this,c)}draw(c){const{inflateAmount:s,options:{borderColor:l,backgroundColor:u}}=this,{inner:g,outer:b}=function rh(v){const c=Jc(v),s=c.right-c.left,l=c.bottom-c.top,u=function oh(v,c,s){const u=v.borderSkipped,g=Ga(v.options.borderWidth);return{t:dc(u.top,g.top,0,s),r:dc(u.right,g.right,0,c),b:dc(u.bottom,g.bottom,0,s),l:dc(u.left,g.left,0,c)}}(v,s/2,l/2),g=function Mu(v,c,s){const{enableBorderRadius:l}=v.getProps(["enableBorderRadius"]),u=v.options.borderRadius,g=es(u),b=Math.min(c,s),w=v.borderSkipped,k=l||at(u);return{topLeft:dc(!k||w.top||w.left,g.topLeft,0,b),topRight:dc(!k||w.top||w.right,g.topRight,0,b),bottomLeft:dc(!k||w.bottom||w.left,g.bottomLeft,0,b),bottomRight:dc(!k||w.bottom||w.right,g.bottomRight,0,b)}}(v,s/2,l/2);return{outer:{x:c.left,y:c.top,w:s,h:l,radius:g},inner:{x:c.left+u.l,y:c.top+u.t,w:s-u.l-u.r,h:l-u.t-u.b,radius:{topLeft:Math.max(0,g.topLeft-Math.max(u.t,u.l)),topRight:Math.max(0,g.topRight-Math.max(u.t,u.r)),bottomLeft:Math.max(0,g.bottomLeft-Math.max(u.b,u.l)),bottomRight:Math.max(0,g.bottomRight-Math.max(u.b,u.r))}}}}(this),w=function sh(v){return v.topLeft||v.topRight||v.bottomLeft||v.bottomRight}(b.radius)?Va:cu;c.save(),(b.w!==g.w||b.h!==g.h)&&(c.beginPath(),w(c,pc(b,s,g)),c.clip(),w(c,pc(g,-s,b)),c.fillStyle=l,c.fill("evenodd")),c.beginPath(),w(c,pc(g,s)),c.fillStyle=u,c.fill(),c.restore()}inRange(c,s,l){return Wu(this,c,s,l)}inXRange(c,s){return Wu(this,c,null,s)}inYRange(c,s){return Wu(this,null,c,s)}getCenterPoint(c){const{x:s,y:l,base:u,horizontal:g}=this.getProps(["x","y","base","horizontal"],c);return{x:g?(s+u)/2:s,y:g?l:(l+u)/2}}getRange(c){return"x"===c?this.width/2:this.height/2}}uu.id="bar",uu.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0},uu.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var zu=Object.freeze({__proto__:null,ArcElement:Ur,LineElement:Oc,PointElement:Ac,BarElement:uu});function ju(v){if(v._decimated){const c=v._data;delete v._decimated,delete v._data,Object.defineProperty(v,"data",{value:c})}}function hu(v){v.data.datasets.forEach(c=>{ju(c)})}var Sh={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(v,c,s)=>{if(!s.enabled)return void hu(v);const l=v.width;v.data.datasets.forEach((u,g)=>{const{_data:b,indexAxis:w}=u,k=v.getDatasetMeta(g),H=b||u.data;if("y"===na([w,v.options.indexAxis])||"line"!==k.type)return;const Z=v.scales[k.xAxisID];if("linear"!==Z.type&&"time"!==Z.type||v.options.parsing)return;let be,{start:ht,count:Pt}=function $c(v,c){const s=c.length;let u,l=0;const{iScale:g}=v,{min:b,max:w,minDefined:k,maxDefined:H}=g.getUserBounds();return k&&(l=_i(Br(c,g.axis,b).lo,0,s-1)),u=H?_i(Br(c,g.axis,w).hi+1,l,s)-l:s-l,{start:l,count:u}}(k,H);if(Pt<=(s.threshold||4*l))ju(u);else{switch(Ct(b)&&(u._data=H,delete u.data,Object.defineProperty(u,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(Le){this._data=Le}})),s.algorithm){case"lttb":be=function Ch(v,c,s,l,u){const g=u.samples||l;if(g>=s)return v.slice(c,c+s);const b=[],w=(s-2)/(g-2);let k=0;const H=c+s-1;let ht,Pt,qt,be,Le,Z=c;for(b[k++]=v[Z],ht=0;ht<g-2;ht++){let Ei,Ge=0,Xe=0;const an=Math.floor((ht+1)*w)+1+c,Hi=Math.min(Math.floor((ht+2)*w)+1,s)+c,Wi=Hi-an;for(Ei=an;Ei<Hi;Ei++)Ge+=v[Ei].x,Xe+=v[Ei].y;Ge/=Wi,Xe/=Wi;const yn=Math.floor(ht*w)+1+c,fn=Math.min(Math.floor((ht+1)*w)+1,s)+c,{x:An,y:Bn}=v[Z];for(qt=be=-1,Ei=yn;Ei<fn;Ei++)be=.5*Math.abs((An-Ge)*(v[Ei].y-Bn)-(An-v[Ei].x)*(Xe-Bn)),be>qt&&(qt=be,Pt=v[Ei],Le=Ei);b[k++]=Pt,Z=Le}return b[k++]=v[H],b}(H,ht,Pt,l,s);break;case"min-max":be=function ss(v,c,s,l){let b,w,k,H,Z,ht,Pt,qt,be,Le,u=0,g=0;const Ge=[],Ei=v[c].x,Hi=v[c+s-1].x-Ei;for(b=c;b<c+s;++b){w=v[b],k=(w.x-Ei)/Hi*l,H=w.y;const Wi=0|k;if(Wi===Z)H<be?(be=H,ht=b):H>Le&&(Le=H,Pt=b),u=(g*u+w.x)/++g;else{const yn=b-1;if(!Ct(ht)&&!Ct(Pt)){const fn=Math.min(ht,Pt),An=Math.max(ht,Pt);fn!==qt&&fn!==yn&&Ge.push(L_(x_({},v[fn]),{x:u})),An!==qt&&An!==yn&&Ge.push(L_(x_({},v[An]),{x:u}))}b>0&&yn!==qt&&Ge.push(v[yn]),Ge.push(w),Z=Wi,g=0,be=Le=H,ht=Pt=qt=b}}return Ge}(H,ht,Pt,l);break;default:throw new Error(`Unsupported decimation algorithm '${s.algorithm}'`)}u._decimated=be}})},destroy(v){hu(v)}};function Ih(v,c,s){const l=function Rh(v){const c=v.options,s=c.fill;let l=Ft(s&&s.target,s);return void 0===l&&(l=!!c.backgroundColor),!1!==l&&null!==l&&(!0===l?"origin":l)}(v);if(at(l))return!isNaN(l.value)&&l;let u=parseFloat(l);return ft(u)&&Math.floor(u)===u?(("-"===l[0]||"+"===l[0])&&(u=c+u),!(u===c||u<0||u>=s)&&u):["origin","start","end","stack","shape"].indexOf(l)>=0&&l}class Ou{constructor(c){this.x=c.x,this.y=c.y,this.radius=c.radius}pathSegment(c,s,l){const{x:u,y:g,radius:b}=this;return c.arc(u,g,b,(s=s||{start:0,end:Dt}).end,s.start,!0),!l.bounds}interpolate(c){const{x:s,y:l,radius:u}=this,g=c.angle;return{x:s+Math.cos(g)*u,y:l+Math.sin(g)*u,angle:g}}}function fc(v,c,s){for(;c>v;c--){const l=s[c];if(!isNaN(l.x)&&!isNaN(l.y))break}return c}function lh(v,c,s){const l=[];for(let u=0;u<s.length;u++){const g=s[u],{first:b,last:w,point:k}=ha(g,c,"x");if(!(!k||b&&w))if(b)l.unshift(k);else if(v.push(k),!w)break}v.push(...l)}function ha(v,c,s){const l=v.interpolate(c,s);if(!l)return{};const u=l[s],g=v.segments,b=v.points;let w=!1,k=!1;for(let H=0;H<g.length;H++){const Z=g[H],ht=b[Z.start][s],Pt=b[Z.end][s];if(Fi(u,ht,Pt)){w=u===ht,k=u===Pt;break}}return{first:w,last:k,point:l}}function Pl(v){const{chart:c,fill:s,line:l}=v;if(ft(s))return function ah(v,c){const s=v.getDatasetMeta(c);return s&&v.isDatasetVisible(c)?s.dataset:null}(c,s);if("stack"===s)return function Zc(v){const{scale:c,index:s,line:l}=v,u=[],g=l.segments,b=l.points,w=function Xl(v,c){const s=[],l=v.getMatchingVisibleMetas("line");for(let u=0;u<l.length;u++){const g=l[u];if(g.index===c)break;g.hidden||s.unshift(g.dataset)}return s}(c,s);w.push(Qc({x:null,y:c.bottom},l));for(let k=0;k<g.length;k++){const H=g[k];for(let Z=H.start;Z<=H.end;Z++)lh(u,b[Z],w)}return new Oc({points:u,options:{}})}(v);if("shape"===s)return!0;const u=function Dh(v){return(v.scale||{}).getPointPositionForValue?function Au(v){const{scale:c,fill:s}=v,l=c.options,u=c.getLabels().length,g=[],b=l.reverse?c.max:c.min;let k,H,Z;if(Z="start"===s?b:"end"===s?l.reverse?c.min:c.max:at(s)?s.value:c.getBaseValue(),l.grid.circular)return H=c.getPointPositionForValue(0,b),new Ou({x:H.x,y:H.y,radius:c.getDistanceFromCenterForValue(Z)});for(k=0;k<u;++k)g.push(c.getPointPositionForValue(k,Z));return g}(v):function wh(v){const{scale:c={},fill:s}=v;let u,l=null;return"start"===s?l=c.bottom:"end"===s?l=c.top:at(s)?l=c.getPixelForValue(s.value):c.getBasePixel&&(l=c.getBasePixel()),ft(l)?(u=c.isHorizontal(),{x:u?l:null,y:u?null:l}):null}(v)}(v);return u instanceof Ou?u:Qc(u,l)}function Qc(v,c){let s=[],l=!1;return bt(v)?(l=!0,s=v):s=function wa(v,c){const{x:s=null,y:l=null}=v||{},u=c.points,g=[];return c.segments.forEach(({start:b,end:w})=>{w=fc(b,w,u);const k=u[b],H=u[w];null!==l?(g.push({x:k.x,y:l}),g.push({x:H.x,y:l})):null!==s&&(g.push({x:s,y:k.y}),g.push({x:s,y:H.y}))}),g}(v,c),s.length?new Oc({points:s,options:{tension:0},_loop:l,_fullLoop:l}):null}function du(v,c,s){let u=v[c].fill;const g=[c];let b;if(!s)return u;for(;!1!==u&&-1===g.indexOf(u);){if(!ft(u))return u;if(b=v[u],!b)return!1;if(b.visible)return u;g.push(u),u=b.fill}return!1}function Mh(v,c,s){v.beginPath(),c.path(v),v.lineTo(c.last().x,s),v.lineTo(c.first().x,s),v.closePath(),v.clip()}function kc(v,c,s,l){if(l)return;let u=c[v],g=s[v];return"angle"===v&&(u=ge(u),g=ge(g)),{property:v,start:u,end:g}}function ch(v,c,s,l){return v&&c?l(v[s],c[s]):v?v[s]:c?c[s]:0}function Oh(v,c,s){const{top:l,bottom:u}=c.chart.chartArea,{property:g,start:b,end:w}=s||{};"x"===g&&(v.beginPath(),v.rect(b,l,w-b,u-l),v.clip())}function pu(v,c,s,l){const u=c.interpolate(s,l);u&&v.lineTo(u.x,u.y)}function xc(v,c){const{line:s,target:l,property:u,color:g,scale:b}=c,w=function zo(v,c,s){const l=v.segments,u=v.points,g=c.points,b=[];for(const w of l){let{start:k,end:H}=w;H=fc(k,H,u);const Z=kc(s,u[k],u[H],w.loop);if(!c.segments){b.push({source:w,target:Z,start:u[k],end:u[H]});continue}const ht=Sr(c,Z);for(const Pt of ht){const qt=kc(s,g[Pt.start],g[Pt.end],Pt.loop),be=ds(w,u,qt);for(const Le of be)b.push({source:Le,target:Pt,start:{[s]:ch(Z,qt,"start",Math.max)},end:{[s]:ch(Z,qt,"end",Math.min)}})}}return b}(s,l,u);for(const{source:k,target:H,start:Z,end:ht}of w){const{style:{backgroundColor:Pt=g}={}}=k,qt=!0!==l;v.save(),v.fillStyle=Pt,Oh(v,b,qt&&kc(u,Z,ht)),v.beginPath();const be=!!s.pathSegment(v,k);let Le;if(qt){be?v.closePath():pu(v,l,ht,u);const Ge=!!l.pathSegment(v,H,{move:be,reverse:!0});Le=be&&Ge,Le||pu(v,l,Z,u)}v.closePath(),v.fill(Le?"evenodd":"nonzero"),v.restore()}}function Lc(v,c,s){const l=Pl(c),{line:u,scale:g,axis:b}=c,w=u.options,k=w.fill,H=w.backgroundColor,{above:Z=H,below:ht=H}=k||{};l&&u.points.length&&(ya(v,s),function El(v,c){const{line:s,target:l,above:u,below:g,area:b,scale:w}=c,k=s._loop?"angle":c.axis;v.save(),"x"===k&&g!==u&&(Mh(v,l,b.top),xc(v,{line:s,target:l,color:u,scale:w,property:k}),v.restore(),v.save(),Mh(v,l,b.bottom)),xc(v,{line:s,target:l,color:g,scale:w,property:k}),v.restore()}(v,{line:u,target:l,above:Z,below:ht,area:s,scale:g,axis:b}),Vo(v))}var fu={id:"filler",afterDatasetsUpdate(v,c,s){const l=(v.data.datasets||[]).length,u=[];let g,b,w,k;for(b=0;b<l;++b)g=v.getDatasetMeta(b),w=g.dataset,k=null,w&&w.options&&w instanceof Oc&&(k={visible:v.isDatasetVisible(b),index:b,fill:Ih(w,b,l),chart:v,axis:g.controller.options.indexAxis,scale:g.vScale,line:w}),g.$filler=k,u.push(k);for(b=0;b<l;++b)k=u[b],k&&!1!==k.fill&&(k.fill=du(u,b,s.propagate))},beforeDraw(v,c,s){const l="beforeDraw"===s.drawTime,u=v.getSortedVisibleDatasetMetas(),g=v.chartArea;for(let b=u.length-1;b>=0;--b){const w=u[b].$filler;!w||(w.line.updateControlPoints(g,w.axis),l&&Lc(v.ctx,w,g))}},beforeDatasetsDraw(v,c,s){if("beforeDatasetsDraw"!==s.drawTime)return;const l=v.getSortedVisibleDatasetMetas();for(let u=l.length-1;u>=0;--u){const g=l[u].$filler;g&&Lc(v.ctx,g,v.chartArea)}},beforeDatasetDraw(v,c,s){const l=c.meta.$filler;!l||!1===l.fill||"beforeDatasetDraw"!==s.drawTime||Lc(v.ctx,l,v.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const ku=(v,c)=>{let{boxHeight:s=c,boxWidth:l=c}=v;return v.usePointStyle&&(s=Math.min(s,c),l=Math.min(l,c)),{boxWidth:l,boxHeight:s,itemHeight:Math.max(c,s)}};class Kl extends la{constructor(c){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=c.chart,this.options=c.options,this.ctx=c.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(c,s,l){this.maxWidth=c,this.maxHeight=s,this._margins=l,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const c=this.options.labels||{};let s=ct(c.generateLabels,[this.chart],this)||[];c.filter&&(s=s.filter(l=>c.filter(l,this.chart.data))),c.sort&&(s=s.sort((l,u)=>c.sort(l,u,this.chart.data))),this.options.reverse&&s.reverse(),this.legendItems=s}fit(){const{options:c,ctx:s}=this;if(!c.display)return void(this.width=this.height=0);const l=c.labels,u=Bo(l.font),g=u.size,b=this._computeTitleHeight(),{boxWidth:w,itemHeight:k}=ku(l,g);let H,Z;s.font=u.string,this.isHorizontal()?(H=this.maxWidth,Z=this._fitRows(b,g,w,k)+10):(Z=this.maxHeight,H=this._fitCols(b,g,w,k)+10),this.width=Math.min(H,c.maxWidth||this.maxWidth),this.height=Math.min(Z,c.maxHeight||this.maxHeight)}_fitRows(c,s,l,u){const{ctx:g,maxWidth:b,options:{labels:{padding:w}}}=this,k=this.legendHitBoxes=[],H=this.lineWidths=[0],Z=u+w;let ht=c;g.textAlign="left",g.textBaseline="middle";let Pt=-1,qt=-Z;return this.legendItems.forEach((be,Le)=>{const Ge=l+s/2+g.measureText(be.text).width;(0===Le||H[H.length-1]+Ge+2*w>b)&&(ht+=Z,H[H.length-(Le>0?0:1)]=0,qt+=Z,Pt++),k[Le]={left:0,top:qt,row:Pt,width:Ge,height:u},H[H.length-1]+=Ge+w}),ht}_fitCols(c,s,l,u){const{ctx:g,maxHeight:b,options:{labels:{padding:w}}}=this,k=this.legendHitBoxes=[],H=this.columnSizes=[],Z=b-c;let ht=w,Pt=0,qt=0,be=0,Le=0;return this.legendItems.forEach((Ge,Xe)=>{const Ei=l+s/2+g.measureText(Ge.text).width;Xe>0&&qt+u+2*w>Z&&(ht+=Pt+w,H.push({width:Pt,height:qt}),be+=Pt+w,Le++,Pt=qt=0),k[Xe]={left:be,top:qt,col:Le,width:Ei,height:u},Pt=Math.max(Pt,Ei),qt+=u+w}),ht+=Pt,H.push({width:Pt,height:qt}),ht}adjustHitBoxes(){if(!this.options.display)return;const c=this._computeTitleHeight(),{legendHitBoxes:s,options:{align:l,labels:{padding:u},rtl:g}}=this,b=oo(g,this.left,this.width);if(this.isHorizontal()){let w=0,k=gt(l,this.left+u,this.right-this.lineWidths[w]);for(const H of s)w!==H.row&&(w=H.row,k=gt(l,this.left+u,this.right-this.lineWidths[w])),H.top+=this.top+c+u,H.left=b.leftForLtr(b.x(k),H.width),k+=H.width+u}else{let w=0,k=gt(l,this.top+c+u,this.bottom-this.columnSizes[w].height);for(const H of s)H.col!==w&&(w=H.col,k=gt(l,this.top+c+u,this.bottom-this.columnSizes[w].height)),H.top=k,H.left+=this.left+u,H.left=b.leftForLtr(b.x(H.left),H.width),k+=H.height+u}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const c=this.ctx;ya(c,this),this._draw(),Vo(c)}}_draw(){const{options:c,columnSizes:s,lineWidths:l,ctx:u}=this,{align:g,labels:b}=c,w=uo.color,k=oo(c.rtl,this.left,this.width),H=Bo(b.font),{color:Z,padding:ht}=b,Pt=H.size,qt=Pt/2;let be;this.drawTitle(),u.textAlign=k.textAlign("left"),u.textBaseline="middle",u.lineWidth=.5,u.font=H.string;const{boxWidth:Le,boxHeight:Ge,itemHeight:Xe}=ku(b,Pt),Hi=this.isHorizontal(),Wi=this._computeTitleHeight();be=Hi?{x:gt(g,this.left+ht,this.right-l[0]),y:this.top+ht+Wi,line:0}:{x:this.left+ht,y:gt(g,this.top+Wi+ht,this.bottom-s[0].height),line:0},Ko(this.ctx,c.textDirection);const yn=Xe+ht;this.legendItems.forEach((fn,An)=>{u.strokeStyle=fn.fontColor||Z,u.fillStyle=fn.fontColor||Z;const Bn=u.measureText(fn.text).width,Cn=k.textAlign(fn.textAlign||(fn.textAlign=b.textAlign)),Qi=Le+qt+Bn;let Vn=be.x,mo=be.y;k.setWidth(this.width),Hi?An>0&&Vn+Qi+ht>this.right&&(mo=be.y+=yn,be.line++,Vn=be.x=gt(g,this.left+ht,this.right-l[be.line])):An>0&&mo+yn>this.bottom&&(Vn=be.x=Vn+s[be.line].width+ht,be.line++,mo=be.y=gt(g,this.top+Wi+ht,this.bottom-s[be.line].height)),function(fn,An,Bn){if(isNaN(Le)||Le<=0||isNaN(Ge)||Ge<0)return;u.save();const Cn=Ft(Bn.lineWidth,1);if(u.fillStyle=Ft(Bn.fillStyle,w),u.lineCap=Ft(Bn.lineCap,"butt"),u.lineDashOffset=Ft(Bn.lineDashOffset,0),u.lineJoin=Ft(Bn.lineJoin,"miter"),u.lineWidth=Cn,u.strokeStyle=Ft(Bn.strokeStyle,w),u.setLineDash(Ft(Bn.lineDash,[])),b.usePointStyle){const Qi={radius:Le*Math.SQRT2/2,pointStyle:Bn.pointStyle,rotation:Bn.rotation,borderWidth:Cn},Vn=k.xPlus(fn,Le/2);Cr(u,Qi,Vn,An+qt)}else{const Qi=An+Math.max((Pt-Ge)/2,0),Vn=k.leftForLtr(fn,Le),mo=es(Bn.borderRadius);u.beginPath(),Object.values(mo).some(_n=>0!==_n)?Va(u,{x:Vn,y:Qi,w:Le,h:Ge,radius:mo}):u.rect(Vn,Qi,Le,Ge),u.fill(),0!==Cn&&u.stroke()}u.restore()}(k.x(Vn),mo,fn),Vn=((v,c,s,l)=>v===(l?"left":"right")?s:"center"===v?(c+s)/2:c)(Cn,Vn+Le+qt,Hi?Vn+Qi:this.right,c.rtl),function(fn,An,Bn){js(u,Bn.text,fn,An+Xe/2,H,{strikethrough:Bn.hidden,textAlign:k.textAlign(Bn.textAlign)})}(k.x(Vn),mo,fn),Hi?be.x+=Qi+ht:be.y+=yn}),dr(this.ctx,c.textDirection)}drawTitle(){const c=this.options,s=c.title,l=Bo(s.font),u=Go(s.padding);if(!s.display)return;const g=oo(c.rtl,this.left,this.width),b=this.ctx,w=s.position,H=u.top+l.size/2;let Z,ht=this.left,Pt=this.width;if(this.isHorizontal())Pt=Math.max(...this.lineWidths),Z=this.top+H,ht=gt(c.align,ht,this.right-Pt);else{const be=this.columnSizes.reduce((Le,Ge)=>Math.max(Le,Ge.height),0);Z=H+gt(c.align,this.top,this.bottom-be-c.labels.padding-this._computeTitleHeight())}const qt=gt(w,ht,ht+Pt);b.textAlign=g.textAlign(It(w)),b.textBaseline="middle",b.strokeStyle=s.color,b.fillStyle=s.color,b.font=l.string,js(b,s.text,qt,Z,l)}_computeTitleHeight(){const c=this.options.title,s=Bo(c.font),l=Go(c.padding);return c.display?s.lineHeight+l.height:0}_getLegendItemAt(c,s){let l,u,g;if(Fi(c,this.left,this.right)&&Fi(s,this.top,this.bottom))for(g=this.legendHitBoxes,l=0;l<g.length;++l)if(u=g[l],Fi(c,u.left,u.left+u.width)&&Fi(s,u.top,u.top+u.height))return this.legendItems[l];return null}handleEvent(c){const s=this.options;if(!function gu(v,c){return!!("mousemove"===v&&(c.onHover||c.onLeave)||c.onClick&&("click"===v||"mouseup"===v))}(c.type,s))return;const l=this._getLegendItemAt(c.x,c.y);if("mousemove"===c.type){const u=this._hoveredItem,g=((v,c)=>null!==v&&null!==c&&v.datasetIndex===c.datasetIndex&&v.index===c.index)(u,l);u&&!g&&ct(s.onLeave,[c,u,this],this),this._hoveredItem=l,l&&!g&&ct(s.onHover,[c,l,this],this)}else l&&ct(s.onClick,[c,l,this],this)}}var qc={id:"legend",_element:Kl,start(v,c,s){const l=v.legend=new Kl({ctx:v.ctx,options:s,chart:v});Rs.configure(v,l,s),Rs.addBox(v,l)},stop(v){Rs.removeBox(v,v.legend),delete v.legend},beforeUpdate(v,c,s){const l=v.legend;Rs.configure(v,l,s),l.options=s},afterUpdate(v){const c=v.legend;c.buildLabels(),c.adjustHitBoxes()},afterEvent(v,c){c.replay||v.legend.handleEvent(c.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(v,c,s){const l=c.datasetIndex,u=s.chart;u.isDatasetVisible(l)?(u.hide(l),c.hidden=!0):(u.show(l),c.hidden=!1)},onHover:null,onLeave:null,labels:{color:v=>v.chart.options.color,boxWidth:40,padding:10,generateLabels(v){const c=v.data.datasets,{labels:{usePointStyle:s,pointStyle:l,textAlign:u,color:g}}=v.legend.options;return v._getSortedDatasetMetas().map(b=>{const w=b.controller.getStyle(s?0:void 0),k=Go(w.borderWidth);return{text:c[b.index].label,fillStyle:w.backgroundColor,fontColor:g,hidden:!b.visible,lineCap:w.borderCapStyle,lineDash:w.borderDash,lineDashOffset:w.borderDashOffset,lineJoin:w.borderJoinStyle,lineWidth:(k.width+k.height)/4,strokeStyle:w.borderColor,pointStyle:l||w.pointStyle,rotation:w.rotation,textAlign:u||w.textAlign,borderRadius:0,datasetIndex:b.index}},this)}},title:{color:v=>v.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:v=>!v.startsWith("on"),labels:{_scriptable:v=>!["generateLabels","filter","sort"].includes(v)}}};class Yu extends la{constructor(c){super(),this.chart=c.chart,this.options=c.options,this.ctx=c.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(c,s){const l=this.options;if(this.left=0,this.top=0,!l.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=c,this.height=this.bottom=s;const u=bt(l.text)?l.text.length:1;this._padding=Go(l.padding);const g=u*Bo(l.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=g:this.width=g}isHorizontal(){const c=this.options.position;return"top"===c||"bottom"===c}_drawArgs(c){const{top:s,left:l,bottom:u,right:g,options:b}=this,w=b.align;let H,Z,ht,k=0;return this.isHorizontal()?(Z=gt(w,l,g),ht=s+c,H=g-l):("left"===b.position?(Z=l+c,ht=gt(w,u,s),k=-.5*he):(Z=g-c,ht=gt(w,s,u),k=.5*he),H=u-s),{titleX:Z,titleY:ht,maxWidth:H,rotation:k}}draw(){const c=this.ctx,s=this.options;if(!s.display)return;const l=Bo(s.font),g=l.lineHeight/2+this._padding.top,{titleX:b,titleY:w,maxWidth:k,rotation:H}=this._drawArgs(g);js(c,s.text,0,0,l,{color:s.color,maxWidth:k,rotation:H,textAlign:It(s.align),textBaseline:"middle",translation:[b,w]})}}var _u={id:"title",_element:Yu,start(v,c,s){!function gc(v,c){const s=new Yu({ctx:v.ctx,options:c,chart:v});Rs.configure(v,s,c),Rs.addBox(v,s),v.titleBlock=s}(v,s)},stop(v){Rs.removeBox(v,v.titleBlock),delete v.titleBlock},beforeUpdate(v,c,s){const l=v.titleBlock;Rs.configure(v,l,s),l.options=s},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ur=new WeakMap;var Ah={id:"subtitle",start(v,c,s){const l=new Yu({ctx:v.ctx,options:s,chart:v});Rs.configure(v,l,s),Rs.addBox(v,l),ur.set(v,l)},stop(v){Rs.removeBox(v,ur.get(v)),ur.delete(v)},beforeUpdate(v,c,s){const l=ur.get(v);Rs.configure(v,l,s),l.options=s},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const mu={average(v){if(!v.length)return!1;let c,s,l=0,u=0,g=0;for(c=0,s=v.length;c<s;++c){const b=v[c].element;if(b&&b.hasValue()){const w=b.tooltipPosition();l+=w.x,u+=w.y,++g}}return{x:l/g,y:u/g}},nearest(v,c){if(!v.length)return!1;let g,b,w,s=c.x,l=c.y,u=Number.POSITIVE_INFINITY;for(g=0,b=v.length;g<b;++g){const k=v[g].element;if(k&&k.hasValue()){const Z=Ri(c,k.getCenterPoint());Z<u&&(u=Z,w=k)}}if(w){const k=w.tooltipPosition();s=k.x,l=k.y}return{x:s,y:l}}};function Pa(v,c){return c&&(bt(c)?Array.prototype.push.apply(v,c):v.push(c)),v}function Fl(v){return("string"==typeof v||v instanceof String)&&v.indexOf("\n")>-1?v.split("\n"):v}function xu(v,c){const{element:s,datasetIndex:l,index:u}=c,g=v.getDatasetMeta(l).controller,{label:b,value:w}=g.getLabelAndValue(u);return{chart:v,label:b,parsed:g.getParsed(u),raw:v.data.datasets[l].data[u],formattedValue:w,dataset:g.getDataset(),dataIndex:u,datasetIndex:l,element:s}}function hh(v,c){const s=v._chart.ctx,{body:l,footer:u,title:g}=v,{boxWidth:b,boxHeight:w}=c,k=Bo(c.bodyFont),H=Bo(c.titleFont),Z=Bo(c.footerFont),ht=g.length,Pt=u.length,qt=l.length,be=Go(c.padding);let Le=be.height,Ge=0,Xe=l.reduce((Hi,Wi)=>Hi+Wi.before.length+Wi.lines.length+Wi.after.length,0);Xe+=v.beforeBody.length+v.afterBody.length,ht&&(Le+=ht*H.lineHeight+(ht-1)*c.titleSpacing+c.titleMarginBottom),Xe&&(Le+=qt*(c.displayColors?Math.max(w,k.lineHeight):k.lineHeight)+(Xe-qt)*k.lineHeight+(Xe-1)*c.bodySpacing),Pt&&(Le+=c.footerMarginTop+Pt*Z.lineHeight+(Pt-1)*c.footerSpacing);let Ei=0;const an=function(Hi){Ge=Math.max(Ge,s.measureText(Hi).width+Ei)};return s.save(),s.font=H.string,rt(v.title,an),s.font=k.string,rt(v.beforeBody.concat(v.afterBody),an),Ei=c.displayColors?b+2+c.boxPadding:0,rt(l,Hi=>{rt(Hi.before,an),rt(Hi.lines,an),rt(Hi.after,an)}),Ei=0,s.font=Z.string,rt(v.footer,an),s.restore(),Ge+=be.width,{width:Ge,height:Le}}function ph(v,c,s,l){const{x:u,width:g}=s,{width:b,chartArea:{left:w,right:k}}=v;let H="center";return"center"===l?H=u<=(w+k)/2?"left":"right":u<=g/2?H="left":u>=b-g/2&&(H="right"),function dh(v,c,s,l){const{x:u,width:g}=l,b=s.caretSize+s.caretPadding;if("left"===v&&u+g+b>c.width||"right"===v&&u-g-b<0)return!0}(H,v,c,s)&&(H="center"),H}function fh(v,c,s){const l=c.yAlign||function vs(v,c){const{y:s,height:l}=c;return s<l/2?"top":s>v.height-l/2?"bottom":"center"}(v,s);return{xAlign:c.xAlign||ph(v,c,s,l),yAlign:l}}function E(v,c,s,l){const{caretSize:u,caretPadding:g,cornerRadius:b}=v,{xAlign:w,yAlign:k}=s,H=u+g,{topLeft:Z,topRight:ht,bottomLeft:Pt,bottomRight:qt}=es(b);let be=function Lu(v,c){let{x:s,width:l}=v;return"right"===c?s-=l:"center"===c&&(s-=l/2),s}(c,w);const Le=function f(v,c,s){let{y:l,height:u}=v;return"top"===c?l+=s:l-="bottom"===c?u+s:u/2,l}(c,k,H);return"center"===k?"left"===w?be+=H:"right"===w&&(be-=H):"left"===w?be-=Math.max(Z,Pt)+u:"right"===w&&(be+=Math.max(ht,qt)+u),{x:_i(be,0,l.width-c.width),y:_i(Le,0,l.height-c.height)}}function M(v,c,s){const l=Go(s.padding);return"center"===c?v.x+v.width/2:"right"===c?v.x+v.width-l.right:v.x+l.left}function D(v){return Pa([],Fl(v))}function K(v,c){const s=c&&c.dataset&&c.dataset.tooltip&&c.dataset.tooltip.callbacks;return s?v.override(s):v}let ut=(()=>{class v extends la{constructor(s){super(),this.opacity=0,this._active=[],this._chart=s._chart,this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.options=s.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(s){this.options=s,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const s=this._cachedAnimations;if(s)return s;const l=this._chart,u=this.options.setContext(this.getContext()),g=u.enabled&&l.options.animation&&u.animations,b=new ra(this._chart,g);return g._cacheable&&(this._cachedAnimations=Object.freeze(b)),b}getContext(){return this.$context||(this.$context=function P(v,c,s){return zr(v,{tooltip:c,tooltipItems:s,type:"tooltip"})}(this._chart.getContext(),this,this._tooltipItems))}getTitle(s,l){const{callbacks:u}=l,g=u.beforeTitle.apply(this,[s]),b=u.title.apply(this,[s]),w=u.afterTitle.apply(this,[s]);let k=[];return k=Pa(k,Fl(g)),k=Pa(k,Fl(b)),k=Pa(k,Fl(w)),k}getBeforeBody(s,l){return D(l.callbacks.beforeBody.apply(this,[s]))}getBody(s,l){const{callbacks:u}=l,g=[];return rt(s,b=>{const w={before:[],lines:[],after:[]},k=K(u,b);Pa(w.before,Fl(k.beforeLabel.call(this,b))),Pa(w.lines,k.label.call(this,b)),Pa(w.after,Fl(k.afterLabel.call(this,b))),g.push(w)}),g}getAfterBody(s,l){return D(l.callbacks.afterBody.apply(this,[s]))}getFooter(s,l){const{callbacks:u}=l,g=u.beforeFooter.apply(this,[s]),b=u.footer.apply(this,[s]),w=u.afterFooter.apply(this,[s]);let k=[];return k=Pa(k,Fl(g)),k=Pa(k,Fl(b)),k=Pa(k,Fl(w)),k}_createItems(s){const l=this._active,u=this._chart.data,g=[],b=[],w=[];let H,Z,k=[];for(H=0,Z=l.length;H<Z;++H)k.push(xu(this._chart,l[H]));return s.filter&&(k=k.filter((ht,Pt,qt)=>s.filter(ht,Pt,qt,u))),s.itemSort&&(k=k.sort((ht,Pt)=>s.itemSort(ht,Pt,u))),rt(k,ht=>{const Pt=K(s.callbacks,ht);g.push(Pt.labelColor.call(this,ht)),b.push(Pt.labelPointStyle.call(this,ht)),w.push(Pt.labelTextColor.call(this,ht))}),this.labelColors=g,this.labelPointStyles=b,this.labelTextColors=w,this.dataPoints=k,k}update(s,l){const u=this.options.setContext(this.getContext()),g=this._active;let b,w=[];if(g.length){const k=mu[u.position].call(this,g,this._eventPosition);w=this._createItems(u),this.title=this.getTitle(w,u),this.beforeBody=this.getBeforeBody(w,u),this.body=this.getBody(w,u),this.afterBody=this.getAfterBody(w,u),this.footer=this.getFooter(w,u);const H=this._size=hh(this,u),Z=Object.assign({},k,H),ht=fh(this._chart,u,Z),Pt=E(u,Z,ht,this._chart);this.xAlign=ht.xAlign,this.yAlign=ht.yAlign,b={opacity:1,x:Pt.x,y:Pt.y,width:H.width,height:H.height,caretX:k.x,caretY:k.y}}else 0!==this.opacity&&(b={opacity:0});this._tooltipItems=w,this.$context=void 0,b&&this._resolveAnimations().update(this,b),s&&u.external&&u.external.call(this,{chart:this._chart,tooltip:this,replay:l})}drawCaret(s,l,u,g){const b=this.getCaretPosition(s,u,g);l.lineTo(b.x1,b.y1),l.lineTo(b.x2,b.y2),l.lineTo(b.x3,b.y3)}getCaretPosition(s,l,u){const{xAlign:g,yAlign:b}=this,{caretSize:w,cornerRadius:k}=u,{topLeft:H,topRight:Z,bottomLeft:ht,bottomRight:Pt}=es(k),{x:qt,y:be}=s,{width:Le,height:Ge}=l;let Xe,Ei,an,Hi,Wi,yn;return"center"===b?(Wi=be+Ge/2,"left"===g?(Xe=qt,Ei=Xe-w,Hi=Wi+w,yn=Wi-w):(Xe=qt+Le,Ei=Xe+w,Hi=Wi-w,yn=Wi+w),an=Xe):(Ei="left"===g?qt+Math.max(H,ht)+w:"right"===g?qt+Le-Math.max(Z,Pt)-w:this.caretX,"top"===b?(Hi=be,Wi=Hi-w,Xe=Ei-w,an=Ei+w):(Hi=be+Ge,Wi=Hi+w,Xe=Ei+w,an=Ei-w),yn=Hi),{x1:Xe,x2:Ei,x3:an,y1:Hi,y2:Wi,y3:yn}}drawTitle(s,l,u){const g=this.title,b=g.length;let w,k,H;if(b){const Z=oo(u.rtl,this.x,this.width);for(s.x=M(this,u.titleAlign,u),l.textAlign=Z.textAlign(u.titleAlign),l.textBaseline="middle",w=Bo(u.titleFont),k=u.titleSpacing,l.fillStyle=u.titleColor,l.font=w.string,H=0;H<b;++H)l.fillText(g[H],Z.x(s.x),s.y+w.lineHeight/2),s.y+=w.lineHeight+k,H+1===b&&(s.y+=u.titleMarginBottom-k)}}_drawColorBox(s,l,u,g,b){const w=this.labelColors[u],k=this.labelPointStyles[u],{boxHeight:H,boxWidth:Z,boxPadding:ht}=b,Pt=Bo(b.bodyFont),qt=M(this,"left",b),be=g.x(qt),Ge=l.y+(H<Pt.lineHeight?(Pt.lineHeight-H)/2:0);if(b.usePointStyle){const Xe={radius:Math.min(Z,H)/2,pointStyle:k.pointStyle,rotation:k.rotation,borderWidth:1},Ei=g.leftForLtr(be,Z)+Z/2,an=Ge+H/2;s.strokeStyle=b.multiKeyBackground,s.fillStyle=b.multiKeyBackground,Cr(s,Xe,Ei,an),s.strokeStyle=w.borderColor,s.fillStyle=w.backgroundColor,Cr(s,Xe,Ei,an)}else{s.lineWidth=w.borderWidth||1,s.strokeStyle=w.borderColor,s.setLineDash(w.borderDash||[]),s.lineDashOffset=w.borderDashOffset||0;const Xe=g.leftForLtr(be,Z-ht),Ei=g.leftForLtr(g.xPlus(be,1),Z-ht-2),an=es(w.borderRadius);Object.values(an).some(Hi=>0!==Hi)?(s.beginPath(),s.fillStyle=b.multiKeyBackground,Va(s,{x:Xe,y:Ge,w:Z,h:H,radius:an}),s.fill(),s.stroke(),s.fillStyle=w.backgroundColor,s.beginPath(),Va(s,{x:Ei,y:Ge+1,w:Z-2,h:H-2,radius:an}),s.fill()):(s.fillStyle=b.multiKeyBackground,s.fillRect(Xe,Ge,Z,H),s.strokeRect(Xe,Ge,Z,H),s.fillStyle=w.backgroundColor,s.fillRect(Ei,Ge+1,Z-2,H-2))}s.fillStyle=this.labelTextColors[u]}drawBody(s,l,u){const{body:g}=this,{bodySpacing:b,bodyAlign:w,displayColors:k,boxHeight:H,boxWidth:Z,boxPadding:ht}=u,Pt=Bo(u.bodyFont);let qt=Pt.lineHeight,be=0;const Le=oo(u.rtl,this.x,this.width),Ge=function(Bn){l.fillText(Bn,Le.x(s.x+be),s.y+qt/2),s.y+=qt+b},Xe=Le.textAlign(w);let Ei,an,Hi,Wi,yn,fn,An;for(l.textAlign=w,l.textBaseline="middle",l.font=Pt.string,s.x=M(this,Xe,u),l.fillStyle=u.bodyColor,rt(this.beforeBody,Ge),be=k&&"right"!==Xe?"center"===w?Z/2+ht:Z+2+ht:0,Wi=0,fn=g.length;Wi<fn;++Wi){for(Ei=g[Wi],an=this.labelTextColors[Wi],l.fillStyle=an,rt(Ei.before,Ge),Hi=Ei.lines,k&&Hi.length&&(this._drawColorBox(l,s,Wi,Le,u),qt=Math.max(Pt.lineHeight,H)),yn=0,An=Hi.length;yn<An;++yn)Ge(Hi[yn]),qt=Pt.lineHeight;rt(Ei.after,Ge)}be=0,qt=Pt.lineHeight,rt(this.afterBody,Ge),s.y-=b}drawFooter(s,l,u){const g=this.footer,b=g.length;let w,k;if(b){const H=oo(u.rtl,this.x,this.width);for(s.x=M(this,u.footerAlign,u),s.y+=u.footerMarginTop,l.textAlign=H.textAlign(u.footerAlign),l.textBaseline="middle",w=Bo(u.footerFont),l.fillStyle=u.footerColor,l.font=w.string,k=0;k<b;++k)l.fillText(g[k],H.x(s.x),s.y+w.lineHeight/2),s.y+=w.lineHeight+u.footerSpacing}}drawBackground(s,l,u,g){const{xAlign:b,yAlign:w}=this,{x:k,y:H}=s,{width:Z,height:ht}=u,{topLeft:Pt,topRight:qt,bottomLeft:be,bottomRight:Le}=es(g.cornerRadius);l.fillStyle=g.backgroundColor,l.strokeStyle=g.borderColor,l.lineWidth=g.borderWidth,l.beginPath(),l.moveTo(k+Pt,H),"top"===w&&this.drawCaret(s,l,u,g),l.lineTo(k+Z-qt,H),l.quadraticCurveTo(k+Z,H,k+Z,H+qt),"center"===w&&"right"===b&&this.drawCaret(s,l,u,g),l.lineTo(k+Z,H+ht-Le),l.quadraticCurveTo(k+Z,H+ht,k+Z-Le,H+ht),"bottom"===w&&this.drawCaret(s,l,u,g),l.lineTo(k+be,H+ht),l.quadraticCurveTo(k,H+ht,k,H+ht-be),"center"===w&&"left"===b&&this.drawCaret(s,l,u,g),l.lineTo(k,H+Pt),l.quadraticCurveTo(k,H,k+Pt,H),l.closePath(),l.fill(),g.borderWidth>0&&l.stroke()}_updateAnimationTarget(s){const l=this._chart,u=this.$animations,g=u&&u.x,b=u&&u.y;if(g||b){const w=mu[s.position].call(this,this._active,this._eventPosition);if(!w)return;const k=this._size=hh(this,s),H=Object.assign({},w,this._size),Z=fh(l,s,H),ht=E(s,H,Z,l);(g._to!==ht.x||b._to!==ht.y)&&(this.xAlign=Z.xAlign,this.yAlign=Z.yAlign,this.width=k.width,this.height=k.height,this.caretX=w.x,this.caretY=w.y,this._resolveAnimations().update(this,ht))}}draw(s){const l=this.options.setContext(this.getContext());let u=this.opacity;if(!u)return;this._updateAnimationTarget(l);const g={width:this.width,height:this.height},b={x:this.x,y:this.y};u=Math.abs(u)<.001?0:u;const w=Go(l.padding);l.enabled&&(this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length)&&(s.save(),s.globalAlpha=u,this.drawBackground(b,s,g,l),Ko(s,l.textDirection),b.y+=w.top,this.drawTitle(b,s,l),this.drawBody(b,s,l),this.drawFooter(b,s,l),dr(s,l.textDirection),s.restore())}getActiveElements(){return this._active||[]}setActiveElements(s,l){const u=this._active,g=s.map(({datasetIndex:k,index:H})=>{const Z=this._chart.getDatasetMeta(k);if(!Z)throw new Error("Cannot find a dataset at index "+k);return{datasetIndex:k,element:Z.data[H],index:H}}),b=!se(u,g),w=this._positionChanged(g,l);(b||w)&&(this._active=g,this._eventPosition=l,this.update(!0))}handleEvent(s,l){const u=this.options,g=this._active||[];let b=!1,w=[];"mouseout"!==s.type&&(w=this._chart.getElementsAtEventForMode(s,u.mode,u,l),u.reverse&&w.reverse());const k=this._positionChanged(w,s);return b=l||!se(w,g)||k,b&&(this._active=w,(u.enabled||u.external)&&(this._eventPosition={x:s.x,y:s.y},this.update(!0,l))),b}_positionChanged(s,l){const{caretX:u,caretY:g,options:b}=this,w=mu[b.position].call(this,s,l);return!1!==w&&(u!==w.x||g!==w.y)}}return v.positioners=mu,v})();var Ht=Object.freeze({__proto__:null,Decimation:Sh,Filler:fu,Legend:qc,SubTitle:Ah,Title:_u,Tooltip:{id:"tooltip",_element:ut,positioners:mu,afterInit(v,c,s){s&&(v.tooltip=new ut({_chart:v,options:s}))},beforeUpdate(v,c,s){v.tooltip&&v.tooltip.initialize(s)},reset(v,c,s){v.tooltip&&v.tooltip.initialize(s)},afterDraw(v){const c=v.tooltip,s={tooltip:c};!1!==v.notifyPlugins("beforeTooltipDraw",s)&&(c&&c.draw(v.ctx),v.notifyPlugins("afterTooltipDraw",s))},afterEvent(v,c){v.tooltip&&v.tooltip.handleEvent(c.event,c.replay)&&(c.changed=!0)},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(v,c)=>c.bodyFont.size,boxWidth:(v,c)=>c.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:Ut,title(v){if(v.length>0){const c=v[0],s=c.chart.data.labels,l=s?s.length:0;if(this&&this.options&&"dataset"===this.options.mode)return c.dataset.label||"";if(c.label)return c.label;if(l>0&&c.dataIndex<l)return s[c.dataIndex]}return""},afterTitle:Ut,beforeBody:Ut,beforeLabel:Ut,label(v){if(this&&this.options&&"dataset"===this.options.mode)return v.label+": "+v.formattedValue||v.formattedValue;let c=v.dataset.label||"";c&&(c+=": ");const s=v.formattedValue;return Ct(s)||(c+=s),c},labelColor(v){const s=v.chart.getDatasetMeta(v.datasetIndex).controller.getStyle(v.dataIndex);return{borderColor:s.borderColor,backgroundColor:s.backgroundColor,borderWidth:s.borderWidth,borderDash:s.borderDash,borderDashOffset:s.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(v){const s=v.chart.getDatasetMeta(v.datasetIndex).controller.getStyle(v.dataIndex);return{pointStyle:s.pointStyle,rotation:s.rotation}},afterLabel:Ut,afterBody:Ut,beforeFooter:Ut,footer:Ut,afterFooter:Ut}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:v=>"filter"!==v&&"itemSort"!==v&&"external"!==v,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]}});class pi extends Ra{constructor(c){super(c),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(c){const s=this._addedLabels;if(s.length){const l=this.getLabels();for(const{index:u,label:g}of s)l[u]===g&&l.splice(u,1);this._addedLabels=[]}super.init(c)}parse(c,s){if(Ct(c))return null;const l=this.getLabels();return((v,c)=>null===v?null:_i(Math.round(v),0,c))(s=isFinite(s)&&l[s]===c?s:function ke(v,c,s,l){const u=v.indexOf(c);return-1===u?((v,c,s,l)=>("string"==typeof c?(s=v.push(c)-1,l.unshift({index:s,label:c})):isNaN(c)&&(s=null),s))(v,c,s,l):u!==v.lastIndexOf(c)?s:u}(l,c,Ft(s,c),this._addedLabels),l.length-1)}determineDataLimits(){const{minDefined:c,maxDefined:s}=this.getUserBounds();let{min:l,max:u}=this.getMinMax(!0);"ticks"===this.options.bounds&&(c||(l=0),s||(u=this.getLabels().length-1)),this.min=l,this.max=u}buildTicks(){const c=this.min,s=this.max,l=this.options.offset,u=[];let g=this.getLabels();g=0===c&&s===g.length-1?g:g.slice(c,s+1),this._valueRange=Math.max(g.length-(l?0:1),1),this._startValue=this.min-(l?.5:0);for(let b=c;b<=s;b++)u.push({value:b});return u}getLabelForValue(c){const s=this.getLabels();return c>=0&&c<s.length?s[c]:c}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(c){return"number"!=typeof c&&(c=this.parse(c)),null===c?NaN:this.getPixelForDecimal((c-this._startValue)/this._valueRange)}getPixelForTick(c){const s=this.ticks;return c<0||c>s.length-1?null:this.getPixelForValue(s[c].value)}getValueForPixel(c){return Math.round(this._startValue+this.getDecimalForPixel(c)*this._valueRange)}getBasePixel(){return this.bottom}}function xi(v,c,{horizontal:s,minRotation:l}){const u=Ti(l),g=(s?Math.sin(u):Math.cos(u))||.001;return Math.min(c/g,.75*c*(""+v).length)}pi.id="category",pi.defaults={ticks:{callback:pi.prototype.getLabelForValue}};class ji extends Ra{constructor(c){super(c),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(c,s){return Ct(c)||("number"==typeof c||c instanceof Number)&&!isFinite(+c)?null:+c}handleTickRangeOptions(){const{beginAtZero:c}=this.options,{minDefined:s,maxDefined:l}=this.getUserBounds();let{min:u,max:g}=this;const b=k=>u=s?u:k,w=k=>g=l?g:k;if(c){const k=le(u),H=le(g);k<0&&H<0?w(0):k>0&&H>0&&b(0)}if(u===g){let k=1;(g>=Number.MAX_SAFE_INTEGER||u<=Number.MIN_SAFE_INTEGER)&&(k=Math.abs(.05*g)),w(g+k),c||b(u-k)}this.min=u,this.max=g}getTickLimit(){const c=this.options.ticks;let u,{maxTicksLimit:s,stepSize:l}=c;return l?(u=Math.ceil(this.max/l)-Math.floor(this.min/l)+1,u>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${l} would result generating up to ${u} ticks. Limiting to 1000.`),u=1e3)):(u=this.computeTickLimit(),s=s||11),s&&(u=Math.min(s,u)),u}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const c=this.options,s=c.ticks;let l=this.getTickLimit();l=Math.max(2,l);const b=function ui(v,c){const s=[],{bounds:u,step:g,min:b,max:w,precision:k,count:H,maxTicks:Z,maxDigits:ht,includeBounds:Pt}=v,qt=g||1,be=Z-1,{min:Le,max:Ge}=c,Xe=!Ct(b),Ei=!Ct(w),an=!Ct(H),Hi=(Ge-Le)/(ht+1);let yn,fn,An,Bn,Wi=me((Ge-Le)/be/qt)*qt;if(Wi<1e-14&&!Xe&&!Ei)return[{value:Le},{value:Ge}];Bn=Math.ceil(Ge/Wi)-Math.floor(Le/Wi),Bn>be&&(Wi=me(Bn*Wi/be/qt)*qt),Ct(k)||(yn=Math.pow(10,k),Wi=Math.ceil(Wi*yn)/yn),"ticks"===u?(fn=Math.floor(Le/Wi)*Wi,An=Math.ceil(Ge/Wi)*Wi):(fn=Le,An=Ge),Xe&&Ei&&g&&function We(v,c){const s=Math.round(v);return s-c<=v&&s+c>=v}((w-b)/g,Wi/1e3)?(Bn=Math.round(Math.min((w-b)/Wi,Z)),Wi=(w-b)/Bn,fn=b,An=w):an?(fn=Xe?b:fn,An=Ei?w:An,Bn=H-1,Wi=(An-fn)/Bn):(Bn=(An-fn)/Wi,Bn=Zt(Bn,Math.round(Bn),Wi/1e3)?Math.round(Bn):Math.ceil(Bn));const Cn=Math.max(di(Wi),di(fn));yn=Math.pow(10,Ct(k)?Cn:k),fn=Math.round(fn*yn)/yn,An=Math.round(An*yn)/yn;let Qi=0;for(Xe&&(Pt&&fn!==b?(s.push({value:b}),fn<b&&Qi++,Zt(Math.round((fn+Qi*Wi)*yn)/yn,b,xi(b,Hi,v))&&Qi++):fn<b&&Qi++);Qi<Bn;++Qi)s.push({value:Math.round((fn+Qi*Wi)*yn)/yn});return Ei&&Pt&&An!==w?s.length&&Zt(s[s.length-1].value,w,xi(w,Hi,v))?s[s.length-1].value=w:s.push({value:w}):(!Ei||An===w)&&s.push({value:An}),s}({maxTicks:l,bounds:c.bounds,min:c.min,max:c.max,precision:s.precision,step:s.stepSize,count:s.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:s.minRotation||0,includeBounds:!1!==s.includeBounds},this._range||this);return"ticks"===c.bounds&&$e(b,this,"value"),c.reverse?(b.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),b}configure(){const c=this.ticks;let s=this.min,l=this.max;if(super.configure(),this.options.offset&&c.length){const u=(l-s)/Math.max(c.length-1,1)/2;s-=u,l+=u}this._startValue=s,this._endValue=l,this._valueRange=l-s}getLabelForValue(c){return po(c,this.chart.options.locale,this.options.ticks.format)}}class ln extends ji{determineDataLimits(){const{min:c,max:s}=this.getMinMax(!0);this.min=ft(c)?c:0,this.max=ft(s)?s:1,this.handleTickRangeOptions()}computeTickLimit(){const c=this.isHorizontal(),s=c?this.width:this.height,l=Ti(this.options.ticks.minRotation),u=(c?Math.sin(l):Math.cos(l))||.001,g=this._resolveTickFontOptions(0);return Math.ceil(s/Math.min(40,g.lineHeight/u))}getPixelForValue(c){return null===c?NaN:this.getPixelForDecimal((c-this._startValue)/this._valueRange)}getValueForPixel(c){return this._startValue+this.getDecimalForPixel(c)*this._valueRange}}function vn(v){return v/Math.pow(10,Math.floor(Oe(v)))==1}ln.id="linear",ln.defaults={ticks:{callback:Dl.formatters.numeric}};class pn extends Ra{constructor(c){super(c),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(c,s){const l=ji.prototype.parse.apply(this,[c,s]);if(0!==l)return ft(l)&&l>0?l:null;this._zero=!0}determineDataLimits(){const{min:c,max:s}=this.getMinMax(!0);this.min=ft(c)?Math.max(0,c):null,this.max=ft(s)?Math.max(0,s):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:c,maxDefined:s}=this.getUserBounds();let l=this.min,u=this.max;const g=k=>l=c?l:k,b=k=>u=s?u:k,w=(k,H)=>Math.pow(10,Math.floor(Oe(k))+H);l===u&&(l<=0?(g(1),b(10)):(g(w(l,-1)),b(w(u,1)))),l<=0&&g(w(u,-1)),u<=0&&b(w(l,1)),this._zero&&this.min!==this._suggestedMin&&l===w(this.min,0)&&g(w(l,-1)),this.min=l,this.max=u}buildTicks(){const c=this.options,l=function Dn(v,c){const s=Math.floor(Oe(c.max)),l=Math.ceil(c.max/Math.pow(10,s)),u=[];let g=lt(v.min,Math.pow(10,Math.floor(Oe(c.min)))),b=Math.floor(Oe(g)),w=Math.floor(g/Math.pow(10,b)),k=b<0?Math.pow(10,Math.abs(b)):1;do{u.push({value:g,major:vn(g)}),++w,10===w&&(w=1,++b,k=b>=0?1:k),g=Math.round(w*Math.pow(10,b)*k)/k}while(b<s||b===s&&w<l);const H=lt(v.max,g);return u.push({value:H,major:vn(g)}),u}({min:this._userMin,max:this._userMax},this);return"ticks"===c.bounds&&$e(l,this,"value"),c.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}getLabelForValue(c){return void 0===c?"0":po(c,this.chart.options.locale,this.options.ticks.format)}configure(){const c=this.min;super.configure(),this._startValue=Oe(c),this._valueRange=Oe(this.max)-Oe(c)}getPixelForValue(c){return(void 0===c||0===c)&&(c=this.min),null===c||isNaN(c)?NaN:this.getPixelForDecimal(c===this.min?0:(Oe(c)-this._startValue)/this._valueRange)}getValueForPixel(c){const s=this.getDecimalForPixel(c);return Math.pow(10,this._startValue+s*this._valueRange)}}function Mn(v){const c=v.ticks;if(c.display&&v.display){const s=Go(c.backdropPadding);return Ft(c.font&&c.font.size,uo.font.size)+s.height}return 0}function eo(v,c,s){return s=bt(s)?s:[s],{w:sr(v,c.string,s),h:s.length*c.lineHeight}}function Zn(v,c,s,l,u){return v===l||v===u?{start:c-s/2,end:c+s/2}:v<l||v>u?{start:c-s,end:c}:{start:c,end:c+s}}function Ds(v){return 0===v||180===v?"center":v<180?"left":"right"}function Vr(v,c,s){return"right"===s?v-=c:"center"===s&&(v-=c/2),v}function Da(v,c,s){return 90===s||270===s?v-=c/2:(s>270||s<90)&&(v-=c),v}function ys(v,c,s,l){const{ctx:u}=v;if(s)u.arc(v.xCenter,v.yCenter,c,0,Dt);else{let g=v.getPointPosition(0,c);u.moveTo(g.x,g.y);for(let b=1;b<l;b++)g=v.getPointPosition(b,c),u.lineTo(g.x,g.y)}}function as(v){return Kt(v)?v:0}pn.id="logarithmic",pn.defaults={ticks:{callback:Dl.formatters.logarithmic,major:{enabled:!0}}};class S extends ji{constructor(c){super(c),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){this.width=this.maxWidth,this.height=this.maxHeight,this.paddingTop=Mn(this.options)/2,this.xCenter=Math.floor(this.width/2),this.yCenter=Math.floor((this.height-this.paddingTop)/2),this.drawingArea=Math.min(this.height-this.paddingTop,this.width)/2}determineDataLimits(){const{min:c,max:s}=this.getMinMax(!1);this.min=ft(c)&&!isNaN(c)?c:0,this.max=ft(s)&&!isNaN(s)?s:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Mn(this.options))}generateTickLabels(c){ji.prototype.generateTickLabels.call(this,c),this._pointLabels=this.getLabels().map((s,l)=>{const u=ct(this.options.pointLabels.callback,[s,l],this);return u||0===u?u:""})}fit(){const c=this.options;c.display&&c.pointLabels.display?function Ro(v){const c={l:0,r:v.width,t:0,b:v.height-v.paddingTop},s={},l=[],u=[],g=v.getLabels().length;for(let b=0;b<g;b++){const w=v.options.pointLabels.setContext(v.getPointLabelContext(b));u[b]=w.padding;const k=v.getPointPosition(b,v.drawingArea+u[b]),H=Bo(w.font),Z=eo(v.ctx,H,v._pointLabels[b]);l[b]=Z;const ht=v.getIndexAngle(b),Pt=vi(ht),qt=Zn(Pt,k.x,Z.w,0,180),be=Zn(Pt,k.y,Z.h,90,270);qt.start<c.l&&(c.l=qt.start,s.l=ht),qt.end>c.r&&(c.r=qt.end,s.r=ht),be.start<c.t&&(c.t=be.start,s.t=ht),be.end>c.b&&(c.b=be.end,s.b=ht)}v._setReductions(v.drawingArea,c,s),v._pointLabelItems=function Er(v,c,s){const l=[],u=v.getLabels().length,g=v.options,b=Mn(g),w=v.getDistanceFromCenterForValue(g.ticks.reverse?v.min:v.max);for(let k=0;k<u;k++){const Z=v.getPointPosition(k,w+(0===k?b/2:0)+s[k]),ht=vi(v.getIndexAngle(k)),Pt=c[k],qt=Da(Z.y,Pt.h,ht),be=Ds(ht),Le=Vr(Z.x,Pt.w,be);l.push({x:Z.x,y:qt,textAlign:be,left:Le,top:qt,right:Le+Pt.w,bottom:qt+Pt.h})}return l}(v,l,u)}(this):this.setCenterPoint(0,0,0,0)}_setReductions(c,s,l){let u=s.l/Math.sin(l.l),g=Math.max(s.r-this.width,0)/Math.sin(l.r),b=-s.t/Math.cos(l.t),w=-Math.max(s.b-(this.height-this.paddingTop),0)/Math.cos(l.b);u=as(u),g=as(g),b=as(b),w=as(w),this.drawingArea=Math.max(c/2,Math.min(Math.floor(c-(u+g)/2),Math.floor(c-(b+w)/2))),this.setCenterPoint(u,g,b,w)}setCenterPoint(c,s,l,u){const w=l+this.drawingArea,k=this.height-this.paddingTop-u-this.drawingArea;this.xCenter=Math.floor((c+this.drawingArea+(this.width-s-this.drawingArea))/2+this.left),this.yCenter=Math.floor((w+k)/2+this.top+this.paddingTop)}getIndexAngle(c){return ge(c*(Dt/this.getLabels().length)+Ti(this.options.startAngle||0))}getDistanceFromCenterForValue(c){if(Ct(c))return NaN;const s=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-c)*s:(c-this.min)*s}getValueForDistanceFromCenter(c){if(Ct(c))return NaN;const s=c/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-s:this.min+s}getPointLabelContext(c){const s=this._pointLabels||[];if(c>=0&&c<s.length){const l=s[c];return function ls(v,c,s){return zr(v,{label:s,index:c,type:"pointLabel"})}(this.getContext(),c,l)}}getPointPosition(c,s){const l=this.getIndexAngle(c)-Ee;return{x:Math.cos(l)*s+this.xCenter,y:Math.sin(l)*s+this.yCenter,angle:l}}getPointPositionForValue(c,s){return this.getPointPosition(c,this.getDistanceFromCenterForValue(s))}getBasePosition(c){return this.getPointPositionForValue(c||0,this.getBaseValue())}getPointLabelPosition(c){const{left:s,top:l,right:u,bottom:g}=this._pointLabelItems[c];return{left:s,top:l,right:u,bottom:g}}drawBackground(){const{backgroundColor:c,grid:{circular:s}}=this.options;if(c){const l=this.ctx;l.save(),l.beginPath(),ys(this,this.getDistanceFromCenterForValue(this._endValue),s,this.getLabels().length),l.closePath(),l.fillStyle=c,l.fill(),l.restore()}}drawGrid(){const c=this.ctx,s=this.options,{angleLines:l,grid:u}=s,g=this.getLabels().length;let b,w,k;if(s.pointLabels.display&&function Fa(v,c){const{ctx:s,options:{pointLabels:l}}=v;for(let u=c-1;u>=0;u--){const g=l.setContext(v.getPointLabelContext(u)),b=Bo(g.font),{x:w,y:k,textAlign:H,left:Z,top:ht,right:Pt,bottom:qt}=v._pointLabelItems[u],{backdropColor:be}=g;if(!Ct(be)){const Le=Go(g.backdropPadding);s.fillStyle=be,s.fillRect(Z-Le.left,ht-Le.top,Pt-Z+Le.width,qt-ht+Le.height)}js(s,v._pointLabels[u],w,k+b.lineHeight/2,b,{color:g.color,textAlign:H,textBaseline:"middle"})}}(this,g),u.display&&this.ticks.forEach((H,Z)=>{0!==Z&&(w=this.getDistanceFromCenterForValue(H.value),function Xo(v,c,s,l){const u=v.ctx,g=c.circular,{color:b,lineWidth:w}=c;!g&&!l||!b||!w||s<0||(u.save(),u.strokeStyle=b,u.lineWidth=w,u.setLineDash(c.borderDash),u.lineDashOffset=c.borderDashOffset,u.beginPath(),ys(v,s,g,l),u.closePath(),u.stroke(),u.restore())}(this,u.setContext(this.getContext(Z-1)),w,g))}),l.display){for(c.save(),b=this.getLabels().length-1;b>=0;b--){const H=l.setContext(this.getPointLabelContext(b)),{color:Z,lineWidth:ht}=H;!ht||!Z||(c.lineWidth=ht,c.strokeStyle=Z,c.setLineDash(H.borderDash),c.lineDashOffset=H.borderDashOffset,w=this.getDistanceFromCenterForValue(s.ticks.reverse?this.min:this.max),k=this.getPointPosition(b,w),c.beginPath(),c.moveTo(this.xCenter,this.yCenter),c.lineTo(k.x,k.y),c.stroke())}c.restore()}}drawBorder(){}drawLabels(){const c=this.ctx,s=this.options,l=s.ticks;if(!l.display)return;const u=this.getIndexAngle(0);let g,b;c.save(),c.translate(this.xCenter,this.yCenter),c.rotate(u),c.textAlign="center",c.textBaseline="middle",this.ticks.forEach((w,k)=>{if(0===k&&!s.reverse)return;const H=l.setContext(this.getContext(k)),Z=Bo(H.font);if(g=this.getDistanceFromCenterForValue(this.ticks[k].value),H.showLabelBackdrop){c.font=Z.string,b=c.measureText(w.label).width,c.fillStyle=H.backdropColor;const ht=Go(H.backdropPadding);c.fillRect(-b/2-ht.left,-g-Z.size/2-ht.top,b+ht.width,Z.size+ht.height)}js(c,w.label,0,-g,Z,{color:H.color})}),c.restore()}drawTitle(){}}S.id="radialLinear",S.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Dl.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:v=>v,padding:5}},S.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},S.descriptors={angleLines:{_fallback:"grid"}};const U={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Y=Object.keys(U);function it(v,c){return v-c}function pt(v,c){if(Ct(c))return null;const s=v._adapter,{parser:l,round:u,isoWeekday:g}=v._parseOpts;let b=c;return"function"==typeof l&&(b=l(b)),ft(b)||(b="string"==typeof l?s.parse(b,l):s.parse(b)),null===b?null:(u&&(b="week"!==u||!Kt(g)&&!0!==g?s.startOf(b,u):s.startOf(b,"isoWeek",g)),+b)}function zt(v,c,s,l){const u=Y.length;for(let g=Y.indexOf(v);g<u-1;++g){const b=U[Y[g]],w=b.steps?b.steps:Number.MAX_SAFE_INTEGER;if(b.common&&Math.ceil((s-c)/(w*b.size))<=l)return Y[g]}return Y[u-1]}function Se(v,c,s){if(s){if(s.length){const{lo:l,hi:u}=oa(s,c);v[s[l]>=c?s[l]:s[u]]=!0}}else v[c]=!0}function ii(v,c,s){const l=[],u={},g=c.length;let b,w;for(b=0;b<g;++b)w=c[b],u[w]=b,l.push({value:w,major:!1});return 0!==g&&s?function we(v,c,s,l){const u=v._adapter,g=+u.startOf(c[0].value,l),b=c[c.length-1].value;let w,k;for(w=g;w<=b;w=+u.add(w,1,l))k=s[w],k>=0&&(c[k].major=!0);return c}(v,l,u,s):l}let oi=(()=>{class v extends Ra{constructor(s){super(s),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(s,l){const u=s.time||(s.time={}),g=this._adapter=new Ka._date(s.adapters.date);ce(u.displayFormats,g.formats()),this._parseOpts={parser:u.parser,round:u.round,isoWeekday:u.isoWeekday},super.init(s),this._normalized=l.normalized}parse(s,l){return void 0===s?null:pt(this,s)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const s=this.options,l=this._adapter,u=s.time.unit||"day";let{min:g,max:b,minDefined:w,maxDefined:k}=this.getUserBounds();function H(Z){!w&&!isNaN(Z.min)&&(g=Math.min(g,Z.min)),!k&&!isNaN(Z.max)&&(b=Math.max(b,Z.max))}(!w||!k)&&(H(this._getLabelBounds()),("ticks"!==s.bounds||"labels"!==s.ticks.source)&&H(this.getMinMax(!1))),g=ft(g)&&!isNaN(g)?g:+l.startOf(Date.now(),u),b=ft(b)&&!isNaN(b)?b:+l.endOf(Date.now(),u)+1,this.min=Math.min(g,b-1),this.max=Math.max(g+1,b)}_getLabelBounds(){const s=this.getLabelTimestamps();let l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY;return s.length&&(l=s[0],u=s[s.length-1]),{min:l,max:u}}buildTicks(){const s=this.options,l=s.time,u=s.ticks,g="labels"===u.source?this.getLabelTimestamps():this._generate();"ticks"===s.bounds&&g.length&&(this.min=this._userMin||g[0],this.max=this._userMax||g[g.length-1]);const b=this.min,k=function kr(v,c,s){let l=0,u=v.length;for(;l<u&&v[l]<c;)l++;for(;u>l&&v[u-1]>s;)u--;return l>0||u<v.length?v.slice(l,u):v}(g,b,this.max);return this._unit=l.unit||(u.autoSkip?zt(l.minUnit,this.min,this.max,this._getLabelCapacity(b)):function Yt(v,c,s,l,u){for(let g=Y.length-1;g>=Y.indexOf(s);g--){const b=Y[g];if(U[b].common&&v._adapter.diff(u,l,b)>=c-1)return b}return Y[s?Y.indexOf(s):0]}(this,k.length,l.minUnit,this.min,this.max)),this._majorUnit=u.major.enabled&&"year"!==this._unit?function oe(v){for(let c=Y.indexOf(v)+1,s=Y.length;c<s;++c)if(U[Y[c]].common)return Y[c]}(this._unit):void 0,this.initOffsets(g),s.reverse&&k.reverse(),ii(this,k,this._majorUnit)}initOffsets(s){let g,b,l=0,u=0;this.options.offset&&s.length&&(g=this.getDecimalForValue(s[0]),l=1===s.length?1-g:(this.getDecimalForValue(s[1])-g)/2,b=this.getDecimalForValue(s[s.length-1]),u=1===s.length?b:(b-this.getDecimalForValue(s[s.length-2]))/2);const w=s.length<3?.5:.25;l=_i(l,0,w),u=_i(u,0,w),this._offsets={start:l,end:u,factor:1/(l+1+u)}}_generate(){const s=this._adapter,l=this.min,u=this.max,g=this.options,b=g.time,w=b.unit||zt(b.minUnit,l,u,this._getLabelCapacity(l)),k=Ft(b.stepSize,1),H="week"===w&&b.isoWeekday,Z=Kt(H)||!0===H,ht={};let qt,be,Pt=l;if(Z&&(Pt=+s.startOf(Pt,"isoWeek",H)),Pt=+s.startOf(Pt,Z?"day":w),s.diff(u,l,w)>1e5*k)throw new Error(l+" and "+u+" are too far apart with stepSize of "+k+" "+w);const Le="data"===g.ticks.source&&this.getDataTimestamps();for(qt=Pt,be=0;qt<u;qt=+s.add(qt,k,w),be++)Se(ht,qt,Le);return(qt===u||"ticks"===g.bounds||1===be)&&Se(ht,qt,Le),Object.keys(ht).sort((Ge,Xe)=>Ge-Xe).map(Ge=>+Ge)}getLabelForValue(s){const u=this.options.time;return this._adapter.format(s,u.tooltipFormat?u.tooltipFormat:u.displayFormats.datetime)}_tickFormatFunction(s,l,u,g){const b=this.options,w=b.time.displayFormats,k=this._unit,H=this._majorUnit,ht=H&&w[H],Pt=u[l],be=this._adapter.format(s,g||(H&&ht&&Pt&&Pt.major?ht:k&&w[k])),Le=b.ticks.callback;return Le?ct(Le,[be,l,u],this):be}generateTickLabels(s){let l,u,g;for(l=0,u=s.length;l<u;++l)g=s[l],g.label=this._tickFormatFunction(g.value,l,s)}getDecimalForValue(s){return null===s?NaN:(s-this.min)/(this.max-this.min)}getPixelForValue(s){const l=this._offsets,u=this.getDecimalForValue(s);return this.getPixelForDecimal((l.start+u)*l.factor)}getValueForPixel(s){const l=this._offsets,u=this.getDecimalForPixel(s)/l.factor-l.end;return this.min+u*(this.max-this.min)}_getLabelSize(s){const l=this.options.ticks,u=this.ctx.measureText(s).width,g=Ti(this.isHorizontal()?l.maxRotation:l.minRotation),b=Math.cos(g),w=Math.sin(g),k=this._resolveTickFontOptions(0).size;return{w:u*b+k*w,h:u*w+k*b}}_getLabelCapacity(s){const l=this.options.time,u=l.displayFormats,g=u[l.unit]||u.millisecond,b=this._tickFormatFunction(s,0,ii(this,[s],this._majorUnit),g),w=this._getLabelSize(b),k=Math.floor(this.isHorizontal()?this.width/w.w:this.height/w.h)-1;return k>0?k:1}getDataTimestamps(){let l,u,s=this._cache.data||[];if(s.length)return s;const g=this.getMatchingVisibleMetas();if(this._normalized&&g.length)return this._cache.data=g[0].controller.getAllParsedValues(this);for(l=0,u=g.length;l<u;++l)s=s.concat(g[l].controller.getAllParsedValues(this));return this._cache.data=this.normalize(s)}getLabelTimestamps(){const s=this._cache.labels||[];let l,u;if(s.length)return s;const g=this.getLabels();for(l=0,u=g.length;l<u;++l)s.push(pt(this,g[l]));return this._cache.labels=this._normalized?s:this.normalize(s)}normalize(s){return As(s.sort(it))}}return v.id="time",v.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}},v})();function fi(v,c,s){let g,b,w,k,l=0,u=v.length-1;s?(c>=v[l].pos&&c<=v[u].pos&&({lo:l,hi:u}=Br(v,"pos",c)),({pos:g,time:w}=v[l]),({pos:b,time:k}=v[u])):(c>=v[l].time&&c<=v[u].time&&({lo:l,hi:u}=Br(v,"time",c)),({time:g,pos:w}=v[l]),({time:b,pos:k}=v[u]));const H=b-g;return H?w+(k-w)*(c-g)/H:w}class Si extends oi{constructor(c){super(c),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const c=this._getTimestampsForTable(),s=this._table=this.buildLookupTable(c);this._minPos=fi(s,this.min),this._tableRange=fi(s,this.max)-this._minPos,super.initOffsets(c)}buildLookupTable(c){const{min:s,max:l}=this,u=[],g=[];let b,w,k,H,Z;for(b=0,w=c.length;b<w;++b)H=c[b],H>=s&&H<=l&&u.push(H);if(u.length<2)return[{time:s,pos:0},{time:l,pos:1}];for(b=0,w=u.length;b<w;++b)Z=u[b+1],k=u[b-1],H=u[b],Math.round((Z+k)/2)!==H&&g.push({time:H,pos:b/(w-1)});return g}_getTimestampsForTable(){let c=this._cache.all||[];if(c.length)return c;const s=this.getDataTimestamps(),l=this.getLabelTimestamps();return c=s.length&&l.length?this.normalize(s.concat(l)):s.length?s:l,c=this._cache.all=c,c}getDecimalForValue(c){return(fi(this._table,c)-this._minPos)/this._tableRange}getValueForPixel(c){const s=this._offsets,l=this.getDecimalForPixel(c)/s.factor-s.end;return fi(this._table,l*this._tableRange+this._minPos,!0)}}Si.id="timeseries",Si.defaults=oi.defaults,Re.register(Us,zu,Ht,Object.freeze({__proto__:null,CategoryScale:pi,LinearScale:ln,LogarithmicScale:pn,RadialLinearScale:S,TimeScale:oi,TimeSeriesScale:Si}));const cn=Re;var xn=_(54968),en=_(70262),go=_(93075),ko=_(68675),Qr=_(54004),gr=_(39841),re=_(5e3),qr=_(48966),Ba=_(95240),cs=_(53251),Ms=_(67322),jo=_(77531),Gs=_(91079),ea=_(69808),_c=_(47423),mc=_(63874),Xu=_(90508);function Wh(v,c){if(1&v&&(re.TgZ(0,"mat-option",14),re._uU(1),re.qZA()),2&v){const s=c.$implicit;re.Q6J("value",s),re.xp6(1),re.hij(" ",s," ")}}function od(v,c){if(1&v&&(re.TgZ(0,"mat-option",14),re._uU(1),re.qZA()),2&v){const s=c.$implicit;re.Q6J("value",s),re.xp6(1),re.hij(" ",s," ")}}function Jl(v,c){if(1&v){const s=re.EpF();re.TgZ(0,"tr"),re.TgZ(1,"td"),re._uU(2),re.qZA(),re.TgZ(3,"td"),re.TgZ(4,"button",15),re.NdJ("click",function(){const g=re.CHM(s).$implicit;return re.oxw().chooseDemo(g)}),re._uU(5),re.qZA(),re.qZA(),re.TgZ(6,"td"),re.TgZ(7,"b"),re._uU(8),re.qZA(),re._uU(9),re.qZA(),re.qZA()}if(2&v){const s=c.$implicit,l=c.index;let u,g;re.xp6(2),re.hij(" ",l+1," "),re.xp6(3),re.hij(" ",s.description," "),re.xp6(3),re.Oqu(null==s.categories||null==(u=s.categories.split(";"))?null:u.join(", ")),re.xp6(1),re.hij(" ",null==s.blocks||null==(g=s.blocks.split(";"))?null:g.join(", ")," ")}}function rd(v,c){if(1&v){const s=re.EpF();re.TgZ(0,"button",15),re.NdJ("click",function(){return re.CHM(s),re.oxw().Verify()}),re.TgZ(1,"mat-icon"),re._uU(2,"save"),re.qZA(),re._uU(3," Verify LocalAPI "),re.qZA()}}function Id(v,c){if(1&v){const s=re.EpF();re.TgZ(0,"tr"),re.TgZ(1,"td"),re._uU(2),re.qZA(),re.TgZ(3,"td"),re.TgZ(4,"button",15),re.NdJ("click",function(){const g=re.CHM(s).$implicit;return re.oxw().chooseDemo(g)}),re._uU(5),re.qZA(),re.qZA(),re.TgZ(6,"td"),re.TgZ(7,"b"),re._uU(8),re.qZA(),re._uU(9),re.qZA(),re.qZA()}if(2&v){const s=c.$implicit,l=c.index;let u,g;re.xp6(2),re.hij(" ",l+1," "),re.xp6(3),re.hij(" ",s.description||s.id," "),re.xp6(3),re.Oqu(null==s.categories||null==(u=s.categories.split(";"))?null:u.join(", ")),re.xp6(1),re.hij(" ",null==s.blocks||null==(g=s.blocks.split(";"))?null:g.join(", ")," ")}}let Ha=(()=>{class v{constructor(s,l){this.dialogRef=s,this.DetailsApp=l,this.BlocksLocal=[],this.demos=[],this.demosCategories=new Map,this.demosBlocks=new Map,this.demosArray=null,this.myBlocks=new go.NI,this.optionsBlocks=[],this.filteredOptionsBlocks=null,this.myCategories=new go.NI,this.mySearchText=new go.NI,this.optionsCategories=[],this.filteredOptionsCategories=null,this.InitiateDemos(),this.loadFromLocalAPI()}loadFromLocalAPI(){var s,l;(null===(s=this.DetailsApp.LocalAPI)||void 0===s?void 0:s.WasAlive)&&(null===(l=this.DetailsApp.LocalAPI)||void 0===l||l.LoadBlocks().subscribe(u=>{this.BlocksLocal=u}))}Verify(){var s;null===(s=this.DetailsApp.LocalAPI)||void 0===s||s.IsAlive().subscribe(l=>{l&&this.loadFromLocalAPI()})}InitiateDemos(){var s=this.DetailsApp.demoBlocks;this.demos=s.sort((l,u)=>l.description.localeCompare(u.description)),this.optionsCategories=[...new Set(s.map(l=>l.categories).filter(l=>(null==l?void 0:l.length)>0).flatMap(l=>l.split(";")).filter(l=>(null==l?void 0:l.length)>0).sort((l,u)=>l.toLocaleLowerCase().localeCompare(u.toLocaleLowerCase())))],this.optionsBlocks=[...new Set(s.map(l=>l.blocks).filter(l=>(null==l?void 0:l.length)>0).flatMap(l=>l.split(";")).filter(l=>(null==l?void 0:l.length)>0).sort((l,u)=>l.toLowerCase().localeCompare(u.toLowerCase())))],this.filteredOptionsBlocks=this.myBlocks.valueChanges.pipe((0,ko.O)(""),(0,Qr.U)(l=>{var u=(l||"").trim();return this._filter(u,this.optionsBlocks)})),this.filteredOptionsCategories=this.myCategories.valueChanges.pipe((0,ko.O)(""),(0,Qr.U)(l=>{var u=(l||"").trim();return this._filter(u,this.optionsCategories)})),this.demosArray=(0,gr.a)([this.myBlocks.valueChanges.pipe((0,ko.O)("")),this.myCategories.valueChanges.pipe((0,ko.O)("")),this.mySearchText.valueChanges.pipe((0,ko.O)(""))]).pipe((0,ko.O)(this.demos),(0,Qr.U)(([l,u,g])=>((Array.isArray(l)||"object"==typeof l)&&(l=""),(Array.isArray(u)||"object"==typeof u)&&(u=""),(Array.isArray(g)||"object"==typeof g)&&(g=""),l=(l||"").trim().toLowerCase(),u=(u||"").trim().toLowerCase(),g=(null==g?void 0:g.trim().toLowerCase())||"",this.demos.filter(w=>{var k,H,Z,ht,Pt,qt;return(0==l.length||(null===(k=w.blocks)||void 0===k?void 0:k.toLowerCase().indexOf(l))>-1)&&(0==u.length||(null===(H=w.categories)||void 0===H?void 0:H.toLowerCase().indexOf(u))>-1)&&(0==g.length||(null===(Z=w.description)||void 0===Z?void 0:Z.toLowerCase().indexOf(g))>-1||(null===(ht=w.blocks)||void 0===ht?void 0:ht.toLowerCase().indexOf(g))>-1||(null===(Pt=w.categories)||void 0===Pt?void 0:Pt.toLowerCase().indexOf(g))>-1||(null===(qt=w.id)||void 0===qt?void 0:qt.toLowerCase().indexOf(g))>-1)}))))}ngOnInit(){}_filter(s,l){const u=s.toLowerCase();return 0==u.length?l:l.filter(g=>g.toLowerCase().includes(u))}chooseDemo(s){return this.dialogRef.close(s)}Close(){this.dialogRef.close()}}return v.\u0275fac=function(s){return new(s||v)(re.Y36(qr.so),re.Y36(Ba.d))},v.\u0275cmp=re.Xpm({type:v,selectors:[["app-find-saved-blocks"]],decls:52,vars:16,consts:[["label","Demos"],[1,"example-form"],["appearance","fill",1,"example-full-width"],["type","text","placeholder","Pick one","aria-label","Categories","matInput","",3,"formControl","matAutocomplete"],["autoCategories","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Pick one","aria-label","Blocks","matInput","",3,"formControl","matAutocomplete"],["autoBlocks","matAutocomplete"],["type","text","placeholder","enter text to search","matInput","",3,"formControl"],[4,"ngFor","ngForOf"],["label","Saved on local"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["label","CLOUD","disabled","disabled"],["mat-raised-button","","id","blocks","color","accent",3,"click"],[3,"value"],["mat-raised-button","","color","primary",3,"click"]],template:function(s,l){if(1&s&&(re.TgZ(0,"mat-tab-group"),re.TgZ(1,"mat-tab",0),re.TgZ(2,"form",1),re.TgZ(3,"mat-form-field",2),re.TgZ(4,"mat-label"),re._uU(5,"Categories"),re.qZA(),re._UZ(6,"input",3),re.TgZ(7,"mat-autocomplete",null,4),re.YNc(9,Wh,2,2,"mat-option",5),re.ALo(10,"async"),re.qZA(),re.qZA(),re.TgZ(11,"mat-form-field",2),re.TgZ(12,"mat-label"),re._uU(13,"Blocks"),re.qZA(),re._UZ(14,"input",6),re.TgZ(15,"mat-autocomplete",null,7),re.YNc(17,od,2,2,"mat-option",5),re.ALo(18,"async"),re.qZA(),re.qZA(),re.TgZ(19,"mat-form-field",2),re.TgZ(20,"mat-label"),re._uU(21,"Search"),re.qZA(),re._UZ(22,"input",8),re.qZA(),re.qZA(),re.TgZ(23,"table"),re.TgZ(24,"thead"),re.TgZ(25,"tr"),re.TgZ(26,"th"),re._uU(27,"Number"),re.qZA(),re.TgZ(28,"th"),re._uU(29,"Name"),re.qZA(),re.TgZ(30,"th"),re._uU(31,"Details"),re.qZA(),re.qZA(),re.qZA(),re.YNc(32,Jl,10,4,"tr",9),re.ALo(33,"async"),re.qZA(),re.qZA(),re.TgZ(34,"mat-tab",10),re.YNc(35,rd,4,0,"button",11),re.TgZ(36,"table"),re.TgZ(37,"thead"),re.TgZ(38,"tr"),re.TgZ(39,"th"),re._uU(40,"Number"),re.qZA(),re.TgZ(41,"th"),re._uU(42,"Name"),re.qZA(),re.TgZ(43,"th"),re._uU(44,"Details"),re.qZA(),re.qZA(),re.qZA(),re.YNc(45,Id,10,4,"tr",9),re.qZA(),re.qZA(),re.TgZ(46,"mat-tab",12),re._uU(47," Saved on Cloud "),re.qZA(),re.qZA(),re.TgZ(48,"button",13),re.NdJ("click",function(){return l.Close()}),re.TgZ(49,"mat-icon"),re._uU(50,"close"),re.qZA(),re._uU(51," Close\n"),re.qZA()),2&s){const u=re.MAs(8),g=re.MAs(16);re.xp6(6),re.Q6J("formControl",l.myCategories)("matAutocomplete",u),re.xp6(3),re.Q6J("ngForOf",re.lcZ(10,10,l.filteredOptionsCategories)),re.xp6(5),re.Q6J("formControl",l.myBlocks)("matAutocomplete",g),re.xp6(3),re.Q6J("ngForOf",re.lcZ(18,12,l.filteredOptionsBlocks)),re.xp6(5),re.Q6J("formControl",l.mySearchText),re.xp6(10),re.Q6J("ngForOf",re.lcZ(33,14,l.demosArray)),re.xp6(3),re.Q6J("ngIf",!(null!=l.DetailsApp.LocalAPI&&l.DetailsApp.LocalAPI.WasAlive)),re.xp6(10),re.Q6J("ngForOf",l.BlocksLocal)}},directives:[cs.SP,cs.uX,go._Y,go.JL,go.F,Ms.KE,Ms.hX,jo.Nt,go.Fj,Gs.ZL,go.JJ,go.oH,Gs.XC,ea.sg,ea.O5,_c.lW,mc.Hw,Xu.ey],pipes:[ea.Ov],styles:["table[_ngcontent-%COMP%], th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid}table[_ngcontent-%COMP%]{width:100%;height:480px;margin:0 auto;display:block;overflow-x:auto;border-spacing:0}tbody[_ngcontent-%COMP%]{white-space:nowrap}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:5px 10px;border-top-width:0;border-left-width:0}th[_ngcontent-%COMP%]{position:sticky;top:0;background:#fff;vertical-align:bottom}th[_ngcontent-%COMP%]:last-child, td[_ngcontent-%COMP%]:last-child{border-right-width:0}tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom-width:0}"]}),v})();var Ts=_(67640);class zh{constructor(){}definitionBlocks(c,s){c.headersbeforehttp={init:function(){this.appendDummyInput().appendField("Add Headers"),this.appendValueInput("HttpDomain").setCheck("String").appendField("Domain"),this.appendValueInput("HeaderName").setCheck("String").appendField("Header Name"),this.appendValueInput("HeaderValue").setCheck("String").appendField("Header Value"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("at domain put (localSite) or *")}},s.headersbeforehttp=function(g){var b=s.valueToCode(g,"HttpDomain",0)||"(localSite)",H="\n";return H+="{\n",H+="if(!("+b+" in headersForDomain))\n",H+="{\n",H+="headersForDomain["+b+"]=[];\n",H+="};\n",H+="var arr = headersForDomain["+b+"];\n",H+="arr.push({name:"+s.valueToCode(g,"HeaderName",0)+", value:"+s.valueToCode(g,"HeaderValue",0)+"});\n",H+='//alert("a" + JSON.stringify(arr)+"a");\n',(H+='//alert("a" + JSON.stringify(headersForDomain['+b+'])+"a");\n')+"};\n"},c.httprequest={init:function(){this.appendDummyInput().appendField(new Ts.FieldDropdown([["JSON","JSON"],["Text","Text"]]),"TypeOutput").appendField("HttpRequest"),this.appendValueInput("TheUrl").setCheck(null).appendField(new Ts.FieldDropdown([["GET","GET"],["POST","POST"],["PUT","PUT"],["DELETE","DELETE"]]),"TypeRequest").appendField("URL"),this.appendValueInput("Data").setCheck(null).appendField("Data"),this.setOutput(!0,null)}},s.httprequest=function(g){var b=g.getFieldValue("TypeOutput"),w=g.getFieldValue("TypeRequest"),k=s.valueToCode(g,"TheUrl",0),H=s.valueToCode(g,"Data",0),Z="";switch(w.toString()){case"GET":Z="(function(url){ var res=JSON.parse(getXhr(url)); if(res.statusOK) return res.text;errHandler(JSON.stringify(res)); throw res;}("+k+") )";break;case"POST":Z="(function(url,data){ var res=JSON.parse(postXhr(url,JSON.stringify(data))); if(res.statusOK) return res.text;errHandler(JSON.stringify(res)); throw res;}("+k,H&&(Z+=","+H),Z+=") )";break;case"DELETE":Z="(function(url,data){ var res=JSON.parse(deleteXhr(url,JSON.stringify(data))); if(res.statusOK) return res.text;errHandler(JSON.stringify(res)); throw res;}("+k,H&&(Z+=","+H),Z+=") )";break;case"PUT":Z="(function(url,data){ var res=JSON.parse(putXhr(url,JSON.stringify(data))); if(res.statusOK) return res.text;errHandler(JSON.stringify(res)); throw res;}("+k,H&&(Z+=","+H),Z+=") )";break;default:alert("Do not understand : "+w.toString())}var ht=Z;return"JSON"===b&&(ht="JSON.parse("+ht+")"),[ht,99]}}fieldXML(){return'\n    \n    <block type="headersbeforehttp">\n    <value name="HttpDomain">\n        <shadow type="text">\n            <field name="TEXT">(localSite)</field>\n        </shadow>\n    </value>\n    <value name="HeaderName">\n        <shadow type="text">\n            <field name="TEXT">Authorization</field>\n        </shadow>\n    </value>\n    <value name="HeaderValue">\n        <shadow type="text_join">\n\n        </shadow>\n    </value>\n</block>\n<block type="text_print">\n<value name="TEXT">\n\n    <block type="httprequest">\n    <value name="TheUrl">\n        <shadow type="text">\n            <field name="TEXT">https://httpbin.org/get</field>\n        </shadow>\n    </value>\n</block>\n</value>\n</block>  \n  }\n}\n'}}class jh{fieldXML(){return'\n    \n    <category name="Blockly Core">\n\n    <category id="catLogic" colour="210" name="Logic">\n        <block type="controls_if"></block>\n        <block type="logic_compare"></block>\n        <block type="logic_operation"></block>\n        <block type="logic_negate"></block>\n        <block type="logic_boolean"></block>\n        <block type="logic_null"></block>\n        <block type="logic_ternary"></block>\n    </category>\n    <category id="catLoops" colour="120" name="Loops">\n        <block type="controls_repeat_ext">\n            <value name="TIMES">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_whileUntil"></block>\n        <block type="controls_for">\n            <value name="FROM">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="TO">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n            <value name="BY">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_forEach"></block>\n        <block type="controls_flow_statements"></block>\n    </category>\n    <category id="catMath" colour="230" name="Math">\n        <block type="math_number"></block>\n        <block type="math_arithmetic">\n            <value name="A">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="B">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_single">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">9</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_trig">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">45</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_constant"></block>\n        <block type="math_number_property">\n            <value name="NUMBER_TO_CHECK">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_change">\n            <value name="DELTA">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_round">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">3.1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_on_list"></block>\n        <block type="math_modulo">\n            <value name="DIVIDEND">\n                <shadow type="math_number">\n                    <field name="NUM">64</field>\n                </shadow>\n            </value>\n            <value name="DIVISOR">\n                <shadow type="math_number">\n                    <field name="NUM">10</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_constrain">\n            <value name="VALUE">\n                <shadow type="math_number">\n                    <field name="NUM">50</field>\n                </shadow>\n            </value>\n            <value name="LOW">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="HIGH">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_random_int">\n            <value name="FROM">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n            <value name="TO">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_random_float"></block>\n    </category>\n    <category id="catText" colour="160" name="Text">\n        <block type="text"></block>\n        <block type="text_join"></block>\n        <block type="text_append">\n            <value name="TEXT">\n                <shadow type="text"></shadow>\n            </value>\n        </block>\n        <block type="text_length">\n            <value name="VALUE">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_isEmpty">\n            <value name="VALUE">\n                <shadow type="text">\n                    <field name="TEXT"></field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_indexOf">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n            <value name="FIND">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_charAt">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n        </block>\n        <block type="text_getSubstring">\n            <value name="STRING">\n                <block type="variables_get">\n                    <field name="VAR">text</field>\n                </block>\n            </value>\n        </block>\n        <block type="text_changeCase">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_trim">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_print">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_prompt_ext">\n            <value name="TEXT">\n                <shadow type="text">\n                    <field name="TEXT">abc</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category id="catLists" colour="260" name="Lists">\n        <block type="lists_create_with">\n            <mutation items="0"></mutation>\n        </block>\n        <block type="lists_create_with"></block>\n        <block type="lists_repeat">\n            <value name="NUM">\n                <shadow type="math_number">\n                    <field name="NUM">5</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_length"></block>\n        <block type="lists_isEmpty"></block>\n        <block type="lists_indexOf">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_getIndex">\n            <value name="VALUE">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_setIndex">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_getSublist">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n        </block>\n        <block type="lists_split">\n            <value name="DELIM">\n                <shadow type="text">\n                    <field name="TEXT">,</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_sort"></block>\n    </category>\n    <category id="catColour" colour="20" name="Color">\n        <block type="colour_picker"></block>\n        <block type="colour_random"></block>\n        <block type="colour_rgb">\n            <value name="RED">\n                <shadow type="math_number">\n                    <field name="NUM">100</field>\n                </shadow>\n            </value>\n            <value name="GREEN">\n                <shadow type="math_number">\n                    <field name="NUM">50</field>\n                </shadow>\n            </value>\n            <value name="BLUE">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="colour_blend">\n            <value name="COLOUR1">\n                <shadow type="colour_picker">\n                    <field name="COLOUR">#ff0000</field>\n                </shadow>\n            </value>\n            <value name="COLOUR2">\n                <shadow type="colour_picker">\n                    <field name="COLOUR">#3333ff</field>\n                </shadow>\n            </value>\n            <value name="RATIO">\n                <shadow type="math_number">\n                    <field name="NUM">0.5</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category id="catVariables" colour="330" custom="VARIABLE" name="Variables"></category>\n    <category id="catFunctions" colour="290" custom="PROCEDURE" name="Functions"></category>\n</category>\n\n      '}}class kh{definitionBlocks(c,s){c.trycatchfinally={init:function(){this.appendStatementInput("TRY").appendField("try"),this.appendStatementInput("CATCH").appendField("catch"),this.appendStatementInput("FINALLY").appendField("finally"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null)}},s.trycatchfinally=function(g){var H="try {\n"+s.statementToCode(g,"TRY")+"}\n";return(H+="catch(err){\n "+s.statementToCode(g,"CATCH")+"\n}")+"finally{\n "+s.statementToCode(g,"FINALLY")+"\n}\n"}}fieldXML(){return'\n    \n    <block type="trycatchfinally">\n    \n</block>\n'}}class Yh{definitionBlocks(c,s){c.ttsBlock={init:function(){this.appendValueInput("NAME").setCheck(null).appendField("Voice").appendField(new Ts.FieldDropdown(this.generateOptions),"voiceSelected"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")},generateOptions:function(){if(window.speechSynthesis){var u=window.speechSynthesis.getVoices().map((g,b)=>[g.name,"voice"+b]);if(u.length>0)return u}return[["no voice","NoVoice"]]}},s.ttsBlock=function(l){var u=l.getFieldValue("voiceSelected");return"NoVoice"==(u=u.replace("voice",""))&&(u="-1"),"speakDefault("+s.valueToCode(l,"NAME",s.ORDER_ATOMIC)+","+u+");\n"}}fieldXML(){return'<block type="ttsBlock">\n        <value name="NAME">\n            <shadow type="text">\n            <field name="TEXT">Hello</field></shadow>\n        </value>       \n        </block>\n'}}class Hp{definitionBlocks(c,s){c.pianoBlock={init:function(){this.appendValueInput("Note").setCheck("String").appendField("Note(A-G)"),this.appendValueInput("Sharp").setCheck("Boolean").appendField("#"),this.appendValueInput("Octave").setCheck("Number").appendField("Octave"),this.appendValueInput("Duration").setCheck("Number").appendField("Duration"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("https://github.com/keithwhor/audiosynth")}},s.pianoBlock=function(l){var u=s.valueToCode(l,"Note",s.ORDER_ATOMIC),k="";return"true"==(s.valueToCode(l,"Sharp",s.ORDER_ATOMIC)||!1)&&(k="#"),"playPiano("+u+k+","+s.valueToCode(l,"Octave",s.ORDER_ATOMIC)+","+(s.valueToCode(l,"Duration",s.ORDER_ATOMIC)||2)+");\n"},c.cmajor={init:function(){this.appendDummyInput().appendField("CMajor "),this.setOutput(!0,"Array"),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.cmajor=function(l){return['["C","D","E","F","G","A","B"]',s.ORDER_NONE]}}fieldXML(){return'<block type="pianoBlock">\n        <value name="Note">\n            <shadow type="text">\n            <field name="TEXT">C</field></shadow>\n        </value>       \n        <value name="Octave">\n            <shadow type="math_number">\n            <field name="NUM">4</field></shadow>\n        </value>       \n        <value name="Sharp">\n            <shadow type="logic_boolean">\n            <field name="BOOL">FALSE</field></shadow>\n        </value>       \n        \n        <value name="Duration">\n            <shadow type="math_number">\n            <field name="NUM">2</field></shadow>\n        </value>       \n        </block>\n        <block type="cmajor"></block>\n\n'}}class Up{constructor(){this.definitionBlocks=function(c,s){c.concatList={init:function(){this.appendDummyInput().appendField("concatArray"),this.appendValueInput("LIST1").setCheck("Array"),this.appendValueInput("LIST2").setCheck("Array"),this.setInputsInline(!1),this.setOutput(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.concatList=function(l){var b="";return b+="(function(a1,a2){ return [].concat(a1).concat(a2);})("+(s.valueToCode(l,"LIST1",s.ORDER_MEMBER)||"[]")+","+(s.valueToCode(l,"LIST2",s.ORDER_MEMBER)||"[]")+")",[b+="",s.ORDER_FUNCTION_CALL]},c.filterList={init:function(){this.appendDummyInput().appendField("filterList"),this.appendValueInput("LIST").setCheck("Array"),this.appendValueInput("Logic").setCheck("String").appendField("item=>"),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.filterList=function(l){var u=s.valueToCode(l,"LIST",s.ORDER_MEMBER)||"[]",g=s.valueToCode(l,"Logic",s.ORDER_ATOMIC);"string"==typeof g&&(g=g.substr(1,g.length-2));var b="";return b+='(function(t){ if (typeof t === "string") return JSON.parse(t);  return t;}('+u+")).filter(function (item){ return "+g+";})",[b+="",s.ORDER_FUNCTION_CALL]},c.mapList={init:function(){this.appendDummyInput().appendField("mapList"),this.appendValueInput("LIST").setCheck("Array"),this.appendValueInput("Logic").setCheck("String").appendField("item=>"),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.mapList=function(l){var u=s.valueToCode(l,"LIST",s.ORDER_MEMBER)||"[]",g=s.valueToCode(l,"Logic",s.ORDER_ATOMIC);"string"==typeof g&&(g=g.substr(1,g.length-2));var b="";return b+='(function(t){ if (typeof t === "string") return JSON.parse(t);  return t;}('+u+")).map(function (item){ return "+g+";})",[b+="",s.ORDER_FUNCTION_CALL]},c.reduceList={init:function(){this.appendDummyInput().appendField("reduceList"),this.appendValueInput("LIST").setCheck("Array"),this.appendValueInput("initValue").setCheck(null).appendField("initialValue"),this.appendValueInput("Logic").setCheck("String").appendField("callback(acc,curVal,index, array)=>"),this.setInputsInline(!0),this.setOutput(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.reduceList=function(l){var u=s.valueToCode(l,"LIST",s.ORDER_MEMBER)||"[]",g="";try{g=s.valueToCode(l,"initValue",s.ORDER_ATOMIC)}catch(k){window.alert(k)}var b=s.valueToCode(l,"Logic",s.ORDER_ATOMIC);"string"==typeof b&&(b=b.substr(1,b.length-2));var w="";return w+='(function(t){ if (typeof t === "string") return JSON.parse(t);  return t;}('+u+")).reduce(function (acc,curVal,index,array){ "+b+";}",g&&g.toString().length>0&&(w+=","+g),w+=")",[w+="",s.ORDER_FUNCTION_CALL]}}}fieldXML(){return'\n        <category id="catA" name="Array">\n            <block type="filterList">\n                <value name="LIST">\n                    <block type="variables_get">\n                        <field name="VAR">list</field>\n                    </block>\n                </value>\n                <value name="initValue">\n                    <shadow type="text">\n                        <field name="TEXT"> </field>\n                    </shadow>\n                </value>\n                <value name="Logic">\n                    <shadow type="text">\n                        <field name="TEXT">item.property == "value"</field>\n                    </shadow>\n                </value>\n            </block>\n            <block type="concatList"></block>\n            <block type="mapList">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">list</field>\n                </block>\n            </value>\n            <value name="Logic">\n                <shadow type="text">\n                    <field name="TEXT">item.property</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="reduceList">\n        <value name="LIST">\n        <block type="variables_get">\n                <field name="VAR">list</field>\n            </block>\n            </value>\n            <value name="Logic">\n                <shadow type="text">\n                    <field name="TEXT">...</field>\n                </shadow>\n            </value>\n        </block>\n        </category>\n\n'}}class wo{definitionBlocks(c,s){c.auth0webapidata={init:function(){this.appendDummyInput().appendField("Auth0"),this.appendValueInput("client_id").setCheck(null).appendField("client_id"),this.appendValueInput("client_secret").setCheck(null).appendField("client_secret"),this.appendValueInput("audience").setCheck(null).appendField("audience"),this.appendValueInput("grant_type").setCheck(null).appendField("grant_type"),this.setOutput(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.auth0webapidata=function(g){var Z='{"client_id":'+s.valueToCode(g,"client_id",0);return Z+=',"client_secret":'+s.valueToCode(g,"client_secret",0),Z+=',"audience":'+s.valueToCode(g,"audience",0),Z+=',"grant_type":'+s.valueToCode(g,"grant_type",0),[Z+="}",99]}}fieldXML(){return'<category id="Auth0" name="Auth0">\n    <block type="auth0webapidata">\n        <value name="client_id">\n            <shadow type="text">\n                <field name="TEXT">client_id?</field>\n            </shadow>\n\n        </value>\n        <value name="client_secret">\n            <shadow type="text">\n                <field name="TEXT">client_secret?</field>\n            </shadow>\n\n        </value>\n        <value name="audience">\n            <shadow type="text">\n                <field name="TEXT">audience</field>\n            </shadow>\n\n        </value>\n        <value name="grant_type">\n            <shadow type="text">\n                <field name="TEXT">grant_type?</field>\n            </shadow>\n\n        </value>\n    </block>\n</category>\n'}}class xh{definitionBlocks(c,s){c.converttojson={init:function(){this.appendDummyInput().appendField("ConvertToJSON"),this.appendValueInput("ValueToConvert").setCheck(null),this.setInputsInline(!0),this.setOutput(!0,null),this.setTooltip("Convert to JSON"),this.setHelpUrl("")}},s.converttojson=function(g){return["JSON.parse("+s.valueToCode(g,"ValueToConvert",0)+")",99]},c.converttostring={init:function(){this.appendDummyInput().appendField("ConvertToString"),this.appendValueInput("ValueToConvert").setCheck(null),this.setInputsInline(!0),this.setOutput(!0,null),this.setTooltip("Convert to String"),this.setHelpUrl("")}},s.converttostring=function(g){return["JSON.stringify("+s.valueToCode(g,"ValueToConvert",0)+")",99]},c.convertcsv={init:function(){this.appendDummyInput().appendField("Convert To CSV"),this.appendValueInput("ArrayToConvert").setCheck(null).appendField("Array to convert"),this.setOutput(!0,null),this.setTooltip(""),this.setHelpUrl("")}},s.convertcsv=function(g){return["convertToCSV("+s.valueToCode(g,"ArrayToConvert",s.ORDER_ATOMIC)+")",99]},c.convertToTable={init:function(){this.appendDummyInput().appendField("Convert To Table"),this.appendValueInput("ArrayToConvert").setCheck(null).appendField("Array to convert"),this.setOutput(!0,null),this.setTooltip(""),this.setHelpUrl("")}},s.convertToTable=function(g){return["convertArrToTable("+s.valueToCode(g,"ArrayToConvert",s.ORDER_ATOMIC)+")",99]}}fieldXML(){return'<block type="converttojson"></block>\n <block type="converttostring"></block>\n <block type="convertcsv"></block>\n <block type="convertToTable"></block>\n\n'}}class sd{definitionBlocks(c,s){c.displayCurrentDate={init:function(){this.appendDummyInput().appendField("Current Date"),this.appendDummyInput().appendField("Pick date format:").appendField(new Ts.FieldDropdown([["Unix format","unix"],["ISO format","iso"],["Human format","human"]]),"dateFormat"),this.setOutput(!0,null),this.setColour(100),this.setTooltip("Show current date."),this.setHelpUrl("https://www.w3schools.com/jsref/jsref_obj_date.asp")}};s.displayCurrentDate=g=>{let w="";switch(g.getFieldValue("dateFormat").toString()){case"human":w="displayDateFormatted('human')";break;case"iso":w="displayDateFormatted('iso')";break;case"unix":w="displayDateFormatted('unix')";break;default:console.log("Date time format not suported")}return[w,99]}}fieldXML(){return'<block type="displayCurrentDate"></block>'}}class qd{definitionBlocks(c,s){c.DateFromText={init:function(){this.appendValueInput("VALUE").appendField("Date from "),this.setOutput(!0,null),this.setHelpUrl("https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse#Date_Time_String_Format")}},s.DateFromText=u=>["Date.parse("+(s.valueToCode(u,"VALUE",s.ORDER_ATOMIC)||"")+")",99]}fieldXML(){return'<block type="DateFromText">\n    <value name="VALUE">\n        <shadow type="text">\n            <field name="TEXT">1970-04-16T02:00:00</field>\n        </shadow>\n    </value>\n</block>\n'}}class Xh{definitionBlocks(c,s){c.blockemail={init:function(){this.appendValueInput("from").setCheck(null).appendField("From:"),this.appendValueInput("to").setCheck(null).appendField("To:"),this.appendValueInput("cc").setCheck(null).appendField("CC:"),this.appendValueInput("bcc").setCheck(null).appendField("BCC:"),this.appendValueInput("subject").setCheck(null).appendField("Subject:"),this.appendValueInput("body").setCheck(null).appendField("Body:").appendField(new Ts.FieldDropdown([["HTML","Html"],["TEXT","Text"]]),"NAME"),this.setOutput(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},c.sendinblue={init:function(){this.appendDummyInput().appendField("SendInBlue"),this.appendValueInput("APIKey").setCheck(null).appendField("ApiKey"),this.appendValueInput("email").setCheck("blockemail").appendField("Email"),this.setColour(230),this.setTooltip("Please see https://account.sendinblue.com/advanced/api"),this.setHelpUrl("https://account.sendinblue.com/advanced/api"),this.setOutput(!0,null)}},s.sendinblue=function(u){var w='window.alert("SendInBlue");\n',k="api.sendinblue.com";return w=`(function(apiKey,email){if(!('${k}' in headersForDomain)){ headersForDomain['${k}']=[]; };\n`,w+=`headersForDomain['${k}'].push({"name":"api-key","value":apiKey});\n`,w+=`headersForDomain['${k}'].push({"name":"Content-Type","value":"application/json"});\n`,w+=`headersForDomain['${k}'].push({"name":"Accept","value":"application/json"});\n`,w+='var sendinblueData={"sender":{"email": email.from }, "to":[{"email":email.to }],"subject":email.subject,"htmlContent": email.body} ;\n',w+="\nwindow.alert(JSON.stringify(sendinblueData));\n",w+=`var res=JSON.parse(postXhr("https://${k}/v3/smtp/email",JSON.stringify(sendinblueData)));if(res.statusOK) return res.text;errHandler(JSON.stringify(res)); throw res;\n`,[w+="})("+s.valueToCode(u,"APIKey",s.ORDER_ATOMIC)+","+s.valueToCode(u,"email",s.ORDER_ATOMIC)+")",s.ORDER_NONE]},s.blockemail=function(u){var g=s.valueToCode(u,"from",s.ORDER_ATOMIC),b=s.valueToCode(u,"to",s.ORDER_ATOMIC),w=s.valueToCode(u,"cc",s.ORDER_ATOMIC),k=s.valueToCode(u,"bcc",s.ORDER_ATOMIC),H=s.valueToCode(u,"subject",s.ORDER_ATOMIC),Z=u.getFieldValue("NAME"),Pt="{";return Pt+='"from":'+g+",",Pt+='"to":'+b+",",Pt+='"cc":'+w+",",Pt+='"bcc":'+k+",",Pt+='"subject":'+H+",",Pt+='"body":'+s.valueToCode(u,"body",s.ORDER_ATOMIC)+",",Pt+='"typeEmail":"'+Z+'"',[""+(Pt+="}"),s.ORDER_NONE]}}fieldXML(){return'<block type="blockemail">\n        <value name="from">\n            <shadow type="text">\n                <field name="TEXT">test@test.com</field>\n            </shadow>\n        </value>\n        <value name="to">\n            <shadow type="text">\n                <field name="TEXT">ignatandrei@yahoo.com</field>\n            </shadow>\n        </value>\n        <value name="cc">\n            <shadow type="text">\n                <field name="TEXT"></field>\n            </shadow>\n        </value>\n        <value name="bcc">\n            <shadow type="text">\n                <field name="TEXT"></field>\n            </shadow>\n        </value>\n        <value name="subject">\n            <shadow type="text">\n                <field name="TEXT">My test email</field>\n            </shadow>\n        </value>\n        <value name="body">\n            <shadow type="text">\n                <field name="TEXT">This is the body</field>\n            </shadow>\n        </value>\n            </block>\n        <block type="sendinblue">\n        <value name="APIKey">\n            <shadow type="text">\n                <field name="TEXT">Please put here the API Key from SendInBlue</field>\n            </shadow>\n            \n        </value>\n        <value name="email">\n            <shadow type="blockemail">\n            </shadow>\n            \n        </value>\n        \n        </block>\n'}}class Nc{definitionBlocks(c,s){c.exportfile={init:function(){this.appendDummyInput().appendField("ExportToFile"),this.appendValueInput("fileName").setCheck(null).appendField("FileName"),this.appendValueInput("contentFile").setCheck(null).appendField("Content"),this.appendValueInput("convertToByte").setCheck("Boolean").appendField("ConvertToByteFromBase64"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.exportfile=function(g){return"exportToFile("+s.valueToCode(g,"fileName",0)+","+s.valueToCode(g,"contentFile",0)+","+s.valueToCode(g,"convertToByte",0)+");\n"}}fieldXML(){return'<block type="exportfile">\n    <value name="fileName">\n        <shadow type="text">\n            <field name="TEXT">abc</field>\n        </shadow>\n    </value>\n    <value name="convertToByte">\n        <shadow type="logic_boolean">\n            <field name="BOOL">FALSE</field>\n        </shadow>\n    </value>\n</block>\n'}}class wd{constructor(){this.definitionBlocks=function(c,s){c.window_open={init:function(){this.jsonInit({message0:"Open %1",args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks"})}},s.window_open=function(g){var b=s.valueToCode(g,"TEXT",99)||"''";return"if((typeof "+b+' == "object") && ("to" in '+b+')){open("mailto:'+b.to+'")}else{ open('+b+")};\n"},c.text_message={init:function(){this.jsonInit({message0:"alert %1",args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks"})}},s.text_message=function(g){return"alert1("+(s.valueToCode(g,"TEXT",99)||"''")+");\n"},c.text_print_return={init:function(){this.appendValueInput("TEXT").setCheck(null).appendField("print return").appendField(new Ts.FieldLabelSerializable(""),"NAME"),this.setOutput(!0,null),this.setTooltip(""),this.setHelpUrl("")}},s.text_print_return=function(g){var b=s.valueToCode(g,"TEXT",0)||"''";return["(function(){window.alert("+b+");\n;return ("+b+");}())\n",99]},c.valuefromtext={init:function(){this.appendDummyInput().appendField("InputFromText"),this.appendValueInput("IdOfText").setCheck("String").appendField("Text id"),this.appendValueInput("ValueToObtain").setCheck("String").appendField("Property"),this.setOutput(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.valuefromtext=function(g){return["getIDProp("+s.valueToCode(g,"IdOfText",0)+","+(s.valueToCode(g,"ValueToObtain",0)||'"value"')+")",99]}}}fieldXML(){return'<block type="window_open"></block>\n    <block type="valuefromtext">\n        <value name="IdOfText">\n            <shadow type="text">\n                <field name="TEXT">output</field>\n            </shadow>\n        </value>\n        <value name="ValueToObtain">\n            <shadow type="text">\n                <field name="TEXT">value</field>\n            </shadow>\n        </value>\n    </block>\n    <block type="text_print"></block>\n    <block type="text_print_return"></block>  \n    <block type="text_prompt_ext"></block>\n    <block type="text_message"></block>\n    \n    '}}class tp{definitionBlocks(c,s){c.chart_js={init:function(){this.appendDummyInput().appendField("ChartType").appendField(new Ts.FieldDropdown([["HBar","HBar"],["VBar","VBar"]]),"ChartTypeValue"),this.appendValueInput("ChartTitleValue").setCheck(null).appendField(new Ts.FieldLabelSerializable("Title"),"ChartTitle"),this.appendValueInput("LabelsValue").setCheck("Array").appendField(new Ts.FieldLabelSerializable("Labels"),"ChartLabels"),this.appendValueInput("DataSet1Label").setCheck("String").appendField(new Ts.FieldLabelSerializable("DataSet1 Label"),"DataSetLabel1"),this.appendValueInput("DataSet1Data").setCheck("Array").appendField(new Ts.FieldLabelSerializable("DataSet1 Data"),"DataSetData1"),this.setOutput(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.chart_js=function(l){var u=l.getFieldValue("ChartTypeValue"),b=(s.valueToCode(l,"ChartTitleValue",s.ORDER_ATOMIC),s.valueToCode(l,"LabelsValue",s.ORDER_ATOMIC)),w=s.valueToCode(l,"DataSet1Label",s.ORDER_ATOMIC),k=s.valueToCode(l,"DataSet1Data",s.ORDER_ATOMIC),H="",Z="x";switch(u){case"HBar":H="bar",Z="y";break;case"VBar":H="bar";break;default:throw"Unknown chart type:"+u}return[`JSON.stringify({ 'type': '${H}', 'options':{ 'indexAxis':'${Z}'},  'data': {  'labels': ${b}, 'datasets': [{ 'backgroundColor': ['green','blue'],'label': ${w}, 'data': ${k} }] } })`,s.ORDER_NONE]}}fieldXML(){return'<block type="chart_js"></block>'}}class ad{definitionBlocks(c,s){c.HTMLheaders={init:function(){this.appendValueInput("NAME").setCheck(null).appendField("Header").appendField(new Ts.FieldDropdown([["H1","H1"],["H2","H2"],["H3","H3"]]),"NAME"),this.setOutput(!0,null),this.setColour(240),this.setTooltip("string to Header "),this.setHelpUrl("")}},s.HTMLheaders=function(l){var u=l.getFieldValue("NAME");return[`'<${u}>'+ ${s.valueToCode(l,"NAME",s.ORDER_ATOMIC)} + '</${u}>'`,s.ORDER_NONE]},c.HTMLlist={init:function(){this.appendDummyInput().appendField("List ").appendField(new Ts.FieldDropdown([["OL","ol"],["UL","ul"]]),"listType"),this.appendStatementInput("Content").setCheck(null),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(240),this.setTooltip("list - please add li block "),this.setHelpUrl("")}},s.HTMLlist=function(l){var u=l.getFieldValue("listType");return s.valueToCode(l,"ListType",s.ORDER_ATOMIC),`window.alert('<${u}>');\n;${s.statementToCode(l,"Content")};\n;window.alert('</${u}>');\n`},c.HTMLli={init:function(){this.appendValueInput("NAME").setCheck(null).appendField("LI"),this.setOutput(!0,null),this.setColour(240),this.setTooltip("string to LI"),this.setHelpUrl("")}},s.HTMLli=function(l){return[`'<li>'+ ${s.valueToCode(l,"NAME",s.ORDER_ATOMIC)} + '</li>'`,s.ORDER_NONE]},c.HTMLliStart={init:function(){this.appendDummyInput().appendField("List").appendField(new Ts.FieldDropdown([["OL","OL"],["UL","UL"]]),"NAME"),this.setColour(240),this.setOutput(!0,null),this.setTooltip("LI start"),this.setHelpUrl("")}},s.HTMLliStart=function(l){return[`'<${l.getFieldValue("NAME")}>'`,s.ORDER_NONE]},c.HTMLliStop={init:function(){this.appendDummyInput().appendField("/List").appendField(new Ts.FieldDropdown([["OL","OL"],["UL","UL"]]),"NAME"),this.setColour(240),this.setOutput(!0,null),this.setTooltip("LI stop"),this.setHelpUrl("")}},s.HTMLliStop=function(l){return[`'</${l.getFieldValue("NAME")}>'`,s.ORDER_NONE]},c.HTMLlinkFromObject={init:function(){this.appendDummyInput().appendField("Object=>Link").appendField("target").appendField(new Ts.FieldDropdown([["_blank","_blank"],["_self","_self"],["_parent","_parent"],["_top","_top"]]),"targetDrop"),this.appendValueInput("objectProp").setCheck(null).appendField("objectProp"),this.appendValueInput("textProp").setCheck(null).appendField("textProp"),this.appendValueInput("hrefProp").setCheck(null).appendField("hrefProp"),this.setOutput(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.HTMLlinkFromObject=function(l){var u=l.getFieldValue("targetDrop"),g=s.valueToCode(l,"hrefProp",s.ORDER_MEMBER),b=s.valueToCode(l,"textProp",s.ORDER_ATOMIC),k="(function(obj,text,href){\n";return k+="return '<a href=\"'+ obj[href] ",k+=`+ '" target="${u}"'`,k+="+ '>'+ obj[text] + '</a>' ",[k+="}("+s.valueToCode(l,"objectProp",s.ORDER_ATOMIC)+","+(b=b||g)+","+g+"))",s.ORDER_FUNCTION_CALL]},c.HTMLlink={init:function(){this.appendDummyInput().appendField("A").appendField("target").appendField(new Ts.FieldDropdown([["_blank","_blank"],["_self","_self"],["_parent","_parent"],["_top","_top"]]),"targetDrop"),this.appendValueInput("HREF").setCheck(null).appendField("href"),this.appendValueInput("text").setCheck(null).appendField("text"),this.setOutput(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.HTMLlink=function(l){var u=l.getFieldValue("targetDrop"),g=s.valueToCode(l,"HREF",s.ORDER_ATOMIC),b=s.valueToCode(l,"text",s.ORDER_ATOMIC),w="'<a href=\"'+"+g;return w+=`+ '" target="${u}"'`,[w+="+ '>'+"+(b=b||g)+"+ '</a> '",s.ORDER_NONE]}}fieldXML(){return'\n    <block type=\'text_print\'>" \n               <value name=\'TEXT\'>" \n                 \n    <block type="HTMLheaders">\n        <value name="NAME">\n            <shadow type="text">\n                <field name="TEXT"></field>\n            </shadow>\n        </value>\n    </block>    \n      </value>\n\n\n      </block>\n        \n<block type="HTMLlist"></block>\n\n<block type=\'text_print\'>" \n<value name=\'TEXT\'>" \n  \n<block type="HTMLli">\n</block>    \n</value>\n</block>\n<block type=\'text_print\'>" \n<value name=\'TEXT\'>" \n\n<block type="HTMLliStart"></block>\n</value>\n</block>    \n<block type=\'text_print\'>" \n<value name=\'TEXT\'>" \n\n<block type="HTMLliStop"></block>\n\n</value>\n</block>    \n\n<block type=\'text_print\'>" \n<value name=\'TEXT\'>" \n\n<block type="HTMLlink">\n<value name="HREF">\n<shadow type="text">\n    <field name="TEXT">http://</field>\n</shadow>\n\n</value>\n<value name="text">\n<shadow type="text">\n    <field name="TEXT">My Text</field>\n</shadow>\n\n</value>\n\n</block>\n</value>\n</block>    \n\n\n<block type=\'text_print\'>" \n<value name=\'TEXT\'>" \n\n<block type="HTMLlinkFromObject">\n<value name="hrefProp">\n<shadow type="text">\n    <field name="TEXT">prop</field>\n</shadow>\n\n</value>\n<value name="textProp">\n<shadow type="text">\n    <field name="TEXT">prop</field>\n</shadow>\n\n</value>\n\n</block>\n</value>\n</block>    \n\n'}}class vu{definitionBlocks(c,s){c.simpleHtmlparser={init:function(){this.appendValueInput("NAME").setCheck(null).appendField("Find ").appendField(new Ts.FieldDropdown([["Tables","table"],["Links","a"],["Images","img"],["List","ul,ol"],["Headers","h1,h2,h3,h4,h5,h6"]]),"To"),this.setOutput(!0,null),this.setColour(230),this.setTooltip(""),this.setHelpUrl("")}},s.simpleHtmlparser=function(l){var b="(function(value){ \n";return b+=`var doc  = parseDOMFromStringElements(value,"text/html","${l.getFieldValue("To")}");\n`,b+="return doc;\n",[b+="})("+s.valueToCode(l,"NAME",s.ORDER_ATOMIC)+")",s.ORDER_NONE]}}fieldXML(){return'\n    <block type=\'text_print\'>" \n               <value name=\'TEXT\'>" \n                 \n    <block type="simpleHtmlparser">\n        <value name="NAME">\n            <shadow type="text">\n                <field name="TEXT"></field>\n            </shadow>\n        </value>\n    </block>    \n      </value>\n\n\n      </block>\n        '}}class ld{definitionBlocks(c,s){c.modifyproperty={init:function(){this.appendDummyInput().appendField("Modify "),this.appendValueInput("ObjectToChange").setCheck(null).setAlign(0).appendField(new Ts.FieldLabelSerializable("object"),"objectName"),this.appendValueInput("PropertyName").setCheck(null).setAlign(1).appendField(new Ts.FieldLabelSerializable(",property"),"prop"),this.appendValueInput("NewValue").setCheck(null).setAlign(1).appendField(new Ts.FieldLabelSerializable("toValue"),"newValue"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(""),this.setHelpUrl("")}},s.modifyproperty=function(w){return s.valueToCode(w,"ObjectToChange",0)+"["+s.valueToCode(w,"PropertyName",0)+"]="+s.valueToCode(w,"NewValue",0)+";"},c.getproperty={init:function(){this.appendDummyInput().appendField("Get from"),this.appendValueInput("ObjectToChange").setCheck(null).setAlign(0).appendField(new Ts.FieldLabelSerializable("object"),"objectName"),this.appendValueInput("PropertyName").setCheck(null).setAlign(1).appendField(new Ts.FieldLabelSerializable("property"),"prop"),this.setInputsInline(!0),this.setOutput(!0,null)}},s.getproperty=function(w){var k=s.valueToCode(w,"ObjectToChange",0);return["(function(t, val){   return findPropValue(val,t);})("+s.valueToCode(w,"PropertyName",0)+","+k+")",99]}}fieldXML(){return'\n    \n    <block type="modifyproperty">\n        <value name="PropertyName">\n            <shadow type="text">\n                <field name="TEXT">enter property name</field>\n            </shadow>\n        </value>\n    </block>\n    <block type="getproperty">\n        <value name="PropertyName">\n            <shadow type="text">\n                <field name="TEXT">enter property name</field>\n            </shadow>\n        </value>\n\n    </block>    \n'}}class cd{definitionBlocks(c,s,l,u){s.object_from_json=function(Cn){return[`JSON.parse(${s.valueToCode(Cn,"JSON",0)})`,99]},s.object_to_json=function(Cn){return[`JSON.stringify(${s.valueToCode(Cn,"object",0)})`,99]},s.object_get=function(Cn){const Qi=Cn.getFieldValue("field_name");return[`${s.valueToCode(Cn,"object",0)}['${Qi}']`,99]},s.object_set=function(Cn){const Qi=Cn.getFieldValue("field_name");return`${s.valueToCode(Cn,"object_field",0)}['${Qi}'] = ${s.valueToCode(Cn,"value_field",0)};\n`},s.object_create=function(Cn){if(!Cn.numFields)return["{}",99];let Qi="";for(let mo=1;mo<=Cn.numFields;mo++)Qi+=`"${Cn.getFieldValue("field"+mo)}": ${s.valueToCode(Cn,"field_input"+mo,0)}, `;return[`{ ${Qi} }`,99]};const be="object_field",Le="object_create_mutator_top",Ge="#F99EA3",Xe=Cn=>({object_from_json:"get object from JSON %1",object_from_json_tooltip:"Create object from JSON string.",object_to_json:"generate JSON from object %1",object_to_json_tooltip:"Save object as a JSON string.",object_get_json:"get property %1 %2 of object %3",object_get_json_tooltip:"Get a property of an object.",object_set_json:"set property %1 %2 of object %3 to %4",object_set_json_tooltip:"Set a property of an object.",object_create:"create object",object_create_tooltip:"Create a new object, optionally with some property values.",object_field_name:"property name"}[Cn]),Ei={type:"object_from_json",message0:Xe("object_from_json"),args0:[{type:"input_value",name:"JSON",check:"String"}],output:"Object",colour:Ge,tooltip:Xe("object_from_json_tooltip"),helpUrl:"http://www.json.org/"};c.object_from_json={init:function(){this.jsonInit(Ei)}};const an={type:"object_to_json",message0:Xe("object_to_json"),args0:[{type:"input_value",name:"object",check:"Object"}],output:null,colour:Ge,tooltip:Xe("object_to_json_tooltip"),helpUrl:"http://www.json.org/"};c.object_to_json={init:function(){this.jsonInit(an)}};const Hi={type:"object_get",message0:Xe("object_get_json"),args0:[{type:"field_input",name:"field_name",text:"default"},{type:"input_dummy"},{type:"input_value",name:"object",check:"Object",align:"RIGHT"}],output:null,colour:Ge,tooltip:Xe("object_get_json_tooltip"),helpUrl:""};c.object_get={init:function(){this.jsonInit(Hi)}};const Wi={type:"object_set",message0:Xe("object_set_json"),args0:[{type:"field_input",name:"field_name",text:Xe("object_field_name")},{type:"input_dummy"},{type:"input_value",name:"object_field",check:"Object",align:"RIGHT"},{type:"input_value",name:"value_field",align:"RIGHT"}],previousStatement:null,nextStatement:null,colour:Ge,tooltip:Xe("object_set_json_tooltip"),helpUrl:""};c.object_set={init:function(){this.jsonInit(Wi)}};const yn={type:"object_create",message0:Xe("object_create"),output:"Object",mutator:"controls_create_mutator",colour:15,tooltip:Xe("object_create_tooltip"),helpUrl:""};c.object_create={init:function(){this.jsonInit(yn)}};const fn={type:"object_field",message0:"%1 %2",args0:[{type:"field_input",name:"field_name",text:Xe("object_field_name")},{type:"input_value",name:"field_value"}],previousStatement:null,nextStatement:null,colour:15,tooltip:"",helpUrl:""};c[be]={init:function(){this.jsonInit(fn)}};const An={type:"object_create_mutator",message0:Xe("object_create"),nextStatement:null,colour:15,tooltip:Xe("object_create_tooltip"),helpUrl:""};c[Le]={init:function(){this.jsonInit(An)}};const Bn={numFields:0,fields:new Array,domToMutation:function(Cn){this.fields=[];for(let Vn,Qi=0;Vn=Cn.childNodes[Qi];Qi++)"field"==Vn.nodeName.toLowerCase()&&this.fields.push(Vn.getAttribute("name"));this.numFields=this.fields.length,this.updateShape()},mutationToDom:function(){if(!this.numFields)return null;const Cn=document.createElement("mutation");Cn.setAttribute("num_fields",""+this.numFields);for(let Qi=0;Qi<this.fields.length;Qi++){const Vn=document.createElement("field");Vn.setAttribute("name",this.fields[Qi]),Cn.appendChild(Vn)}return Cn},compose:function(Cn){let Qi=Cn.nextConnection&&Cn.nextConnection.targetBlock();this.numFields=0,this.fields=[];let Vn=[null];for(;Qi;)this.fields.push(Qi.getFieldValue("field_name")),this.numFields++,Vn.push(Qi.savedConnection),Qi=Qi.nextConnection&&Qi.nextConnection.targetBlock();this.updateShape();for(let mo=1;mo<=this.numFields;mo++)u.reconnect(Vn[mo],this,"field_input"+mo)},decompose:function(Cn){const Qi=Cn.newBlock(Le);Qi.initSvg();let Vn=Qi.nextConnection;for(let mo=0;mo<this.fields.length;mo++){const _n=Cn.newBlock(be);_n.initSvg(),_n.setFieldValue(this.fields[mo],"field_name"),Vn.connect(_n.previousConnection),Vn=_n.nextConnection}return Qi},saveConnections:function(Cn){let Qi=Cn.nextConnection&&Cn.nextConnection.targetBlock(),Vn=1;for(;Qi;){const mo=this.getInput("field_input"+Vn);Qi.savedConnection=mo&&mo.connection.targetConnection,Qi.setFieldValue(this.getFieldValue("field"+Vn),"field_name"),Vn++,Qi=Qi.nextConnection&&Qi.nextConnection.targetBlock()}},updateShape:function(){this.getInput("with")&&this.removeInput("with");let Cn=1;for(;this.getInput("field_input"+Cn);)this.removeInput("field_input"+Cn),Cn++;this.numFields>0&&this.appendDummyInput("with").setAlign(1).appendField("with fields");for(let Qi=1;Qi<=this.numFields;Qi++){const Vn=this.fields[Qi-1];this.appendValueInput("field_input"+Qi).setCheck(null).setAlign(1).appendField(new Ts.FieldTextInput(Vn),"field"+Qi)}}};try{l.registerMutator("controls_create_mutator",Bn,null,["object_field"])}catch(Cn){}}fieldXML(){return'    \n    <block type="modifyproperty"></block>\n    <block type="getproperty"></block>\n    <block type="object_create"></block>\n    \x3c!--<block type="object_from_json"></block>\n<block type="object_to_json"></block>\n<block type="object_get"></block>\n<block type="object_set"></block>--\x3e\n\n'}}class Kh{definitionBlocks(c,s){c.credsforhttp={init:function(){this.appendDummyInput().appendField("Http with Creds"),this.appendValueInput("HttpDomain").setCheck("String").appendField("Domain"),this.appendValueInput("WithCreds").setCheck("Boolean").appendField("With Creds ?"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null)}},s.credsforhttp=function(g){return"withCredsForDomain["+(s.valueToCode(g,"HttpDomain",0)||"(localSite)")+"]="+s.valueToCode(g,"WithCreds",0)+";\n"}}fieldXML(){return'<block type="credsforhttp">\n    <value name="HttpDomain">\n        <shadow type="text">\n            <field name="TEXT">(localSite)</field>\n        </shadow>\n    </value>\n    <value name="WithCreds">\n        <shadow type="logic_boolean">\n            <field name="BOOL">FALSE</field>\n        </shadow>\n    </value>\n</block>\n'}}class Vp{definitionBlocks(c,s){c.wait={init:function(){this.appendValueInput("VALUE").appendField("wait secs"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null)}},s.wait=function(u){return"waitTime("+(s.valueToCode(u,"VALUE",s.ORDER_ATOMIC)||"")+");"},c.wait_until={init:function(){this.appendValueInput("VALUE").appendField("wait until date"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null)}},s.wait_until=function(u){return"waitTime(("+(s.valueToCode(u,"VALUE",0)||"")+"-new Date())/1000);"}}fieldXML(){return'\n    <block type="wait">\n\n    <value name="VALUE">\n        <shadow type="math_number">\n            <field name="NUM">10</field>\n        </shadow>\n    </value>\n\n</block>\n<block type="wait_until">\n\n</block>'}}class ud{definitionBlocks(c,s){c([{type:"wait_seconds",message0:" wait %1 seconds",args0:[{type:"field_number",name:"SECONDS",min:0,max:600,value:1}],previousStatement:null,nextStatement:null,colour:"%{BKY_LOOPS_HUE}"}]),s.wait_seconds=function(l){return"waitForSeconds("+Number(l.getFieldValue("SECONDS"))+");\n"}}fieldXML(){return'\n  <block type="wait_seconds"></block>\n'}}class ep{definitionBlocks(c,s){c.comment={init:function(){this.appendValueInput("TEXT").setCheck(null).appendField("comment /* */").appendField(new Ts.FieldLabelSerializable(""),"NAME"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(""),this.setHelpUrl("")}},s.comment=function(u){return"/*\n"+(s.valueToCode(u,"TEXT",0)||"''")+"\n*/;\n"},c.debugger={init:function(){this.appendValueInput("TEXT").setCheck(null).appendField("debugger").appendField(new Ts.FieldLabelSerializable(""),"NAME"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip(""),this.setHelpUrl("")}},s.debugger=function(u){return"startDebugger("+(s.valueToCode(u,"TEXT",0)||"''")+",'"+u.id+"',this);\n"}}fieldXML(){return'<block type="comment">\n    <value name="TEXT">\n        <shadow type="text">\n            <field name="TEXT">Put here comments</field>\n        </shadow>\n    </value>\n</block>\n<block type="debugger">\n    <value name="TEXT">\n        <shadow type="text">\n            <field name="TEXT">my message for debug</field>\n        </shadow>\n    </value>\n</block>\n'}}class Jh{constructor(){this.xhrBlocks=new zh,this.defaultBlocks=new jh,this.trycatchFinBlock=new kh,this.ttsBlock=new Yh,this.pianoBlock=new Hp,this.filterBlocks=new Up,this.auth0Blocks=new wo,this.convertersBlocks=new xh,this.currentDateBlock=new sd,this.dateFromTextBlock=new qd,this.emailBlocks=new Xh,this.exportFileBlock=new Nc,this.guiBlocks=new wd,this.chartBlock=new tp,this.htmlblocks=new ad,this.HTMLParserBlocks=new vu,this.propBlocks=new ld,this.createObjectBlocks=new cd,this.windowsCreds=new Kh,this.waitBlocks1=new Vp,this.waitBlocks2=new ud,this.commentBlock=new ep}}var gh=_(82734);class hd{constructor(){}DownloadBlocks(c,s,l){var u=c.workspaceToDom(s,!0),g=c.domToPrettyText(u),b=new Blob([g],{type:"text/plain;charset=utf-16"});gh.saveAs(b,l)}A(){return 1}LoadFile(c,s,l){s.clear();var u=c.textToDom(l);c.domToWorkspace(u,s)}formatInt(c){return c<10?"0"+c:c.toString(10)}formatDate(c){return`${this.formatInt(c.getFullYear())}${this.formatInt(c.getMonth()+1)}${this.formatInt(c.getDate())}${this.formatInt(c.getHours())}${this.formatInt(c.getMinutes())}${this.formatInt(c.getSeconds())}`}saveState(c,s,l){var u="BlocklyState"+(l||""),g=c.workspaceToDom(s,!0),b=c.domToPrettyText(g);window.localStorage.setItem(u,b)}restoreState(c,s,l){var g=window.localStorage.getItem("BlocklyState"+(l||""));if(((null==g?void 0:g.length)||0)>62){var b=c.textToDom(g);c.clearWorkspaceAndLoadFromXml(b,s)}return""}}const dd=_(86942);class $h{constructor(c,s){this.workspace=c,this.BlocklyJavaScript=s,this.latestCode="",this.step=0,this.highlightPause=!1,this.myInterpreter=null,this.runner=null}generateCodeAndLoadIntoInterpreter(){this.BlocklyJavaScript.STATEMENT_PREFIX="highlightBlock(%1);\n",this.BlocklyJavaScript.addReservedWords("highlightBlock"),this.latestCode=this.BlocklyJavaScript.workspaceToCode(this.workspace),this.resetStepUi(!0)}resetStepUi(c){this.step=0,this.workspace.highlightBlock(null),this.highlightPause=!1}resetInterpreter(){this.myInterpreter=null,this.runner&&(window.clearTimeout(this.runner),this.runner=null)}findPropValue1(c,[s,...l]){return"string"==typeof c&&(c=JSON.parse(c)),c.a&&c.L&&c.O&&(c=c.a),l.length>0?this.findPropValue(c[s],l):c[s]}findPropValue(c,[s,...l]){return console.log("this is",c),l.length?this.findPropValue(c[s],l):c[s]}highlightBlock(c){this.workspace.highlightBlock(c),this.highlightPause=!0}nextStep(c,s){console.log("next step"),c.myInterpreter.step()?setTimeout((l,u)=>{l.nextStep(l,u)},10,c,s):(s?s():console.log("\n\n<< Program complete >>"),c.resetInterpreter(),c.resetStepUi(!1))}runCode(c,s,l,u){""==u&&(u=this.latestCode),this.myInterpreter||this.resetStepUi(!0),this.generateCodeAndLoadIntoInterpreter();var g=this;g.myInterpreter=c(u,(b,w)=>g.initApiJS(b,w,g,s,l)),1!=window.runOneByOne?setTimeout(function(){g.highlightPause=!1,g.runner=function(){g.myInterpreter&&(g.myInterpreter.run()?setTimeout(g.runner,10):(l?l():console.log("\n\n<< Program complete >>"),g.resetInterpreter(),g.resetStepUi(!1)))},g.runner&&g.runner()},100):this.nextStep(g,l)}initInterpreterWaitForSeconds(c,s){this.BlocklyJavaScript.addReservedWords("waitForSeconds");var l=c.createAsyncFunction(function(u,g){setTimeout(g,1e3*u)});c.setProperty(s,"waitForSeconds",l)}getCreds(c,s,l){var u=c.pseudoToNative(s),g="(localSite)";(l.startsWith("http://")||l.startsWith("https://"))&&(g=new URL(l).hostname);var b=!1;return g in u?b=u[g]:"*"in u&&(b=u["*"]),b}getHeaders(c,s,l){var u=c.pseudoToNative(s),g="(localSite)";(l.startsWith("http://")||l.startsWith("https://"))&&(g=new URL(l).hostname);var b=[];return g in u?b=u[g]:"*"in u&&(b=u["*"]),b}doGet(c,s,l,u){let g=new XMLHttpRequest;g.open("GET",c,!0),this.generateDataAndCreds(g,l,u,!1),g.onreadystatechange=function(){if(4==g.readyState){if(g.status>=200&&g.status<300){var b=JSON.stringify({origHref:c,objectToSend:"",status:g.status,statusOK:!0,text:g.responseText});return s(b)}return b=JSON.stringify({origHref:c,objectToSend:"",status:g.status,statusOK:!1,text:g.responseText,headers:g.getAllResponseHeaders()}),s(b)}},g.send(null)}exportToFile(c,s,l){var u;return u=1==l?this.b64toBlob1(s,"",512):new Blob([s],{type:"text/plain;charset=utf-8"}),gh.saveAs(u,c),c}b64toBlob1(c,s="",l=512){const u=atob(c),g=[];for(let w=0;w<u.length;w+=l){const k=u.slice(w,w+l),H=new Array(k.length);for(let ht=0;ht<k.length;ht++)H[ht]=k.charCodeAt(ht);const Z=new Uint8Array(H);g.push(Z)}return new Blob(g,{type:s})}displayDateCurrentAsHuman(){return(new Date).toLocaleDateString(void 0,{day:"numeric",month:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}displayDateCurrentAsIso(){return(new Date).toISOString()}displayDateCurrentAsUnix(){return Date.now()}displayDateFormatted(c){switch(c){case"human":return this.displayDateCurrentAsHuman();case"iso":return this.displayDateCurrentAsIso();case"unix":return this.displayDateCurrentAsUnix();default:return console.log("Date time format not suported"),""}}generateDataAndCreds(c,s,l,u){l&&(c.withCredentials=l);var g=!1;if(s&&s.length>0)for(var b=0;b<s.length;b++){var w=s[b];"Content-Type"==w.name&&(g=!0),c.setRequestHeader(w.name,w.value)}u&&!g&&c.setRequestHeader("Content-Type","application/json;charset=UTF-8")}doPut(c,s,l,u,g){let b=s,w=new XMLHttpRequest;w.open("PUT",c,!0),this.generateDataAndCreds(w,u,g,!!s),w.onreadystatechange=function(){if(4==w.readyState){if(w.status>=200&&w.status<300){var k=JSON.stringify({origHref:c,objectToSend:s,status:w.status,statusOK:!0,text:w.responseText});return l(k)}return k=JSON.stringify({origHref:c,objectToSend:s,status:w.status,statusOK:!1,text:w.responseText,headers:w.getAllResponseHeaders()}),l(k)}},w.send(b)}doDelete(c,s,l,u,g){let b=s;var w=new XMLHttpRequest;w.open("DELETE",c,!0),this.generateDataAndCreds(w,u,g,!!s),w.onreadystatechange=function(){if(4==w.readyState){if(w.status>=200&&w.status<300){var k=JSON.stringify({origHref:c,objectToSend:"",status:w.status,statusOK:!0,text:w.responseText});return l(k)}return k=JSON.stringify({origHref:c,status:w.status,statusOK:!1,text:w.responseText,objectToSend:s,headers:w.getAllResponseHeaders()}),l(k)}},w.send(b)}doPost(c,s,l,u,g){let b=s,w=new XMLHttpRequest;w.open("POST",c,!0),this.generateDataAndCreds(w,u,g,!!s),w.onreadystatechange=function(){if(4==w.readyState){if(w.status>=200&&w.status<300){var k=JSON.stringify({origHref:c,objectToSend:s,status:w.status,statusOK:!0,text:w.responseText});return l(k)}return k=JSON.stringify({origHref:c,objectToSend:s,status:w.status,statusOK:!1,text:w.responseText,headers:w.getAllResponseHeaders()}),l(k)}},w.send(b)}table2array(c){var s=c.rows,l=[];if(!s)return[];if(0==s.length)return[];for(var u=Array.from(s[0].children).map(H=>H.innerText),g=1;g<s.length;g++){for(var b=s[g].children,w={},k=0;k<b.length;k++)w[u[k]]=b[k].innerText;l.push(w)}return l}list2array(c){var s=c.getElementsByTagName("li"),l=[];if(0==s.length)return[];for(var u=0;u<s.length;u++)l.push({li:s[u].innerText});return l}parseDOMFromStringElements(c,s,l){var u,g=(new DOMParser).parseFromString(c,s),b=[];if(l.toString().indexOf(",")>-1)for(var w=l.split(","),k=0;k<w.length;k++)b=b.concat(Array.from(g.getElementsByTagName(w[k])));else b=(b=b.concat(g.getElementsByTagName(l)))[0];var H={};if(0==b.length)return H;switch(l){case"table":for(H={},k=0;k<b.length;k++)H["table"+k]=this.table2array(b[k]);break;case"a":H=[];var Z=(null===(u=null==window?void 0:window.location)||void 0===u?void 0:u.host)||"";for(Z.length>0&&(Z=window.location.protocol+"//"+Z),k=0;k<b.length;k++){var ht=b[k].href;Z.length>0&&ht.startsWith(Z)&&(ht=ht.substring(Z.length)),H.push({href:ht,text:b[k].innerText})}break;case"img":for(H=[],k=0;k<b.length;k++)H.push({src:b[k].src});break;case"ul,ol":for(H={},k=0;k<b.length;k++)H["list"+k]=this.list2array(b[k]);break;case"h1,h2,h3,h4,h5,h6":for(H=[],k=0;k<b.length;k++)H.push({header:b[k].innerText});break;default:throw new Error(`tag !${l}! not supported`)}return JSON.stringify(H)}consoleLog(c,s){return console.log(c,s)}initApiJS(c,s,l,u,g){var b=Pi=>{u?u("\n error --\n"+Pi+"\n error --"):console.log(Pi)};c.setProperty(s,"errHandler",c.createNativeFunction(b)),c.setProperty(s,"consoleLog",c.createNativeFunction(function(Pi,nn){return c.createPrimitive(l.consoleLog(Pi,nn))})),c.setProperty(s,"parseDOMFromStringElements",c.createNativeFunction(function(Pi,nn,Yn){return Pi=Pi?Pi.toString():"",c.createPrimitive(l.parseDOMFromStringElements(Pi,nn,Yn))})),c.setProperty(s,"parseDomNative",c.createNativeFunction(b));var H=c.nativeToPseudo({"(localSite)":!1});c.setProperty(s,"withCredsForDomain",H);var Z=c.nativeToPseudo({"(localSite)":[]});c.setProperty(s,"headersForDomain",Z),c.setProperty(s,"alert1",c.createNativeFunction(function(Pi){Pi=Pi?Pi.toString():"",window.alert(Pi)})),c.setProperty(s,"playPiano",c.createNativeFunction(function(Pi,nn,Yn){dd.Synth.createInstrument("piano").play(Pi,nn,Yn)})),c.setProperty(s,"startDebugger",c.createNativeFunction(function(Pi,nn,Yn){l.highlightBlock(nn),console.log(Pi,nn,Yn)})),c.setProperty(s,"alert",c.createNativeFunction(function(Pi){Pi=Pi?Pi.toString():"",u?u(Pi):console.log(Pi)})),c.setProperty(s,"waitTime",c.createAsyncFunction((Pi,nn)=>{console.log(`waiting seconds ${Pi}`),setTimeout(nn,1e3*Pi)})),c.setProperty(s,"displayDateFormatted",c.createNativeFunction(Pi=>l.displayDateFormatted(Pi))),c.setProperty(s,"exportToFile",c.createNativeFunction((Pi,nn,Yn)=>l.exportToFile(Pi,nn,Yn))),c.setProperty(s,"convertToCSV",c.createNativeFunction(Pi=>{var nn=null;return Array.isArray(Pi)?nn=Pi:((nn="object"!=typeof Pi?JSON.parse(Pi):{})&&nn.table0&&(nn=nn.table0),nn&&nn.list0&&(nn=nn.list0)),0==nn.length?"":(nn=[Object.keys(nn[0])].concat(nn)).map(ro=>Object.values(ro).toString()).join("\n")})),c.setProperty(s,"convertArrToTable",c.createNativeFunction(Pi=>{var nn=null;if(Array.isArray(Pi)?nn=Pi:((nn="object"!=typeof Pi?JSON.parse(Pi):{})&&nn.table0&&(nn=nn.table0),nn&&nn.list0&&(nn=nn.list0)),0==nn.length)return"";var ro="<table><tr>";return ro+=Object.keys(nn[0]).map(zs=>`<th>${zs}</th>\n`).join(""),ro+="</tr>",(ro+=nn.map(zs=>`<tr>${Object.values(zs).map(Zi=>`<td>${Zi}</td>`).join("")}</tr>`).join(""))+"</table>"})),c.setProperty(s,"open",c.createNativeFunction(function(Pi){window.open(Pi,"_blank")})),c.setProperty(s,"changeHost",c.createNativeFunction(function(Pi,nn){if(0==(nn=(nn=nn?nn.toString():"").trim()).length)return Pi;if(0==(Pi=(Pi=Pi||"").trim()).length&&!(Pi=nn).startsWith("http"))throw`please put in front of ${nn} http:// or https://`;var Yn=new URL(Pi);if(nn.startsWith("http")){var ro=new URL(nn);Yn.hostname=ro.hostname,Yn.protocol=ro.protocol}else Yn.hostname=nn.replace("https://","").replace("http://","");var zs=Yn.href;return zs.endsWith("/")&&(zs=zs.substring(0,zs.length-1)),zs})),c.setProperty(s,"changePort",c.createNativeFunction(function(Pi,nn){var Yn=new URL(Pi);console.log(`url ${Yn.href}`),Yn.port=nn,console.log(`url ${Yn.href}`);var ro=Yn.href;return ro.endsWith("/")&&(ro=ro.substring(0,ro.length-1)),ro})),c.setProperty(s,"speakDefault",c.createNativeFunction(function(Pi,nn,Yn,ro,zs){var Zi=new SpeechSynthesisUtterance(Pi),Qn=parseInt(nn);if(Qn<0)console.log(" no voice selected");else{var Pr=window.speechSynthesis.getVoices()[Qn];Zi.voice=Pr,window.speechSynthesis.speak(Zi)}})),c.setProperty(s,"prompt",c.createAsyncFunction(function(Pi,nn,Yn){Pi=Pi?Pi.toString():"",nn=nn?nn.toString():"",Yn(window.prompt(Pi,nn))})),l.BlocklyJavaScript.addReservedWords("waitForSeconds");var Bn=c.createAsyncFunction(function(Pi,nn){setTimeout(nn,1e3*Pi)});c.setProperty(s,"waitForSeconds",Bn),c.setProperty(s,"getXhr",c.createAsyncFunction((Pi,nn)=>{var Yn=l.getHeaders(c,Z,Pi),ro=l.getCreds(c,H,Pi);return l.doGet(Pi,nn,Yn,ro)})),c.setProperty(s,"postXhr",c.createAsyncFunction((Pi,nn,Yn)=>{try{var ro=l.getHeaders(c,Z,Pi),zs=l.getCreds(c,H,Pi);l.doPost(Pi,nn,Yn,ro,zs)}catch(Zi){alert("is an error"+Zi)}})),c.setProperty(s,"deleteXhr",c.createAsyncFunction((Pi,nn,Yn)=>{try{var ro=l.getHeaders(c,Z,Pi),zs=l.getCreds(c,H,Pi);l.doDelete(Pi,nn,Yn,ro,zs)}catch(Zi){alert("is an error"+Zi)}})),c.setProperty(s,"putXhr",c.createAsyncFunction((Pi,nn,Yn)=>{try{var ro=c.pseudoToNative(Z),zs="(localSite)";(Pi.startsWith("http://")||Pi.startsWith("https://"))&&(zs=new URL(Pi).hostname);var Zi=[];zs in ro&&(Zi=ro[zs]),l.doPut(Pi,nn,Yn,Zi,!1)}catch(Pr){alert("is an error"+Pr)}})),c.setProperty(s,"highlightBlock",c.createNativeFunction(function(Pi){return Pi=Pi?Pi.toString():"",c.createPrimitive(l.highlightBlock(Pi))})),c.setProperty(s,"findPropValue",c.createNativeFunction(function(Pi,nn){return c.createPrimitive(l.findPropValue1(Pi,nn.split(".")))}))}}class tu{constructor(c){this.table=c}reloadData(c,s){return this.table.dataLoader.load(c,void 0,void 0,void 0,s)}langText(){return this.table.modules.localize.getText(...arguments)}langBind(){return this.table.modules.localize.bind(...arguments)}langLocale(){return this.table.modules.localize.getLocale(...arguments)}commsConnections(){return this.table.modules.comms.getConnections(...arguments)}commsSend(){return this.table.modules.comms.send(...arguments)}layoutMode(){return this.table.modules.layout.getMode()}layoutRefresh(){return this.table.modules.layout.layout()}subscribe(){return this.table.eventBus.subscribe(...arguments)}unsubscribe(){return this.table.eventBus.unsubscribe(...arguments)}subscribed(c){return this.table.eventBus.subscribed(c)}subscriptionChange(){return this.table.eventBus.subscriptionChange(...arguments)}dispatch(){return this.table.eventBus.dispatch(...arguments)}chain(){return this.table.eventBus.chain(...arguments)}confirm(){return this.table.eventBus.confirm(...arguments)}dispatchExternal(){return this.table.externalEvents.dispatch(...arguments)}subscribedExternal(c){return this.table.externalEvents.subscribed(c)}subscriptionChangeExternal(){return this.table.externalEvents.subscriptionChange(...arguments)}options(c,s){return void 0!==s&&(this.table.options[c]=s),this.table.options[c]}setOption(c,s){return void 0!==s&&(this.table.options[c]=s),this.table.options[c]}module(c){return this.table.module(c)}}class vr extends tu{constructor(c,s){super(c),this._handler=null}initialize(){}registerTableOption(c,s){this.table.optionsList.register(c,s)}registerColumnOption(c,s){this.table.columnManager.optionsList.register(c,s)}registerTableFunction(c,s){void 0===this.table[c]?this.table[c]=s:console.warn("Unable to bind table function, name already in use",c)}registerComponentFunction(c,s,l){return this.table.componentFunctionBinder.bind(c,s,l)}registerDataHandler(c,s){this.table.rowManager.registerDataPipelineHandler(c,s),this._handler=c}registerDisplayHandler(c,s){this.table.rowManager.registerDisplayPipelineHandler(c,s),this._handler=c}refreshData(c,s){s||(s=this._handler),s&&this.table.rowManager.refreshActiveData(s,!1,c)}}class Ws{static elVisible(c){return!(c.offsetWidth<=0&&c.offsetHeight<=0)}static elOffset(c){var s=c.getBoundingClientRect();return{top:s.top+window.pageYOffset-document.documentElement.clientTop,left:s.left+window.pageXOffset-document.documentElement.clientLeft}}static deepClone(c,s,l=[]){var u={}.__proto__,g=[].__proto__;for(var b in s||(s=Object.assign(Array.isArray(c)?[]:{},c)),c){let k,H,w=c[b];null!=w&&"object"==typeof w&&(w.__proto__===u||w.__proto__===g)&&(k=l.findIndex(Z=>Z.subject===w),k>-1?s[b]=l[k].copy:(H=Object.assign(Array.isArray(w)?[]:{},w),l.unshift({subject:w,copy:H}),s[b]=this.deepClone(w,H,l)))}return s}}var ip={};let np=(()=>{class v extends vr{constructor(s){super(s),this.allowedTypes=["","data","download","clipboard","print","htmlOutput"],this.registerColumnOption("accessor"),this.registerColumnOption("accessorParams"),this.registerColumnOption("accessorData"),this.registerColumnOption("accessorDataParams"),this.registerColumnOption("accessorDownload"),this.registerColumnOption("accessorDownloadParams"),this.registerColumnOption("accessorClipboard"),this.registerColumnOption("accessorClipboardParams"),this.registerColumnOption("accessorPrint"),this.registerColumnOption("accessorPrintParams"),this.registerColumnOption("accessorHtmlOutput"),this.registerColumnOption("accessorHtmlOutputParams")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-retrieve",this.transformRow.bind(this))}initializeColumn(s){var l=!1,u={};this.allowedTypes.forEach(g=>{var w,b="accessor"+(g.charAt(0).toUpperCase()+g.slice(1));s.definition[b]&&(w=this.lookupAccessor(s.definition[b]))&&(l=!0,u[b]={accessor:w,params:s.definition[b+"Params"]||{}})}),l&&(s.modules.accessor=u)}lookupAccessor(s){var l=!1;switch(typeof s){case"string":v.accessors[s]?l=v.accessors[s]:console.warn("Accessor Error - No such accessor found, ignoring: ",s);break;case"function":l=s}return l}transformRow(s,l){var u="accessor"+(l.charAt(0).toUpperCase()+l.slice(1)),g=s.getComponent(),b=Ws.deepClone(s.data||{});return this.table.columnManager.traverse(function(w){var k,H,Z,ht;w.modules.accessor&&(H=w.modules.accessor[u]||w.modules.accessor.accessor||!1)&&"undefined"!=(k=w.getFieldValue(b))&&(ht=w.getComponent(),Z="function"==typeof H.params?H.params(k,b,l,ht,g):H.params,w.setFieldValue(b,H.accessor(k,b,l,Z,ht,g)))}),b}}return v.moduleName="accessor",v.accessors=ip,v})();var op={method:"GET"};function Dd(v,c){var s=[];if(c=c||"",Array.isArray(v))v.forEach((u,g)=>{s=s.concat(Dd(u,c?c+"["+g+"]":g))});else if("object"==typeof v)for(var l in v)s=s.concat(Dd(v[l],c?c+"["+l+"]":l));else s.push({key:c,value:v});return s}function rp(v){var c=Dd(v),s=[];return c.forEach(function(l){s.push(encodeURIComponent(l.key)+"="+encodeURIComponent(l.value))}),s.join("&")}function Vf(v,c,s){return v&&s&&Object.keys(s).length&&(!c.method||"get"==c.method.toLowerCase())&&(c.method="get",v+=(v.includes("?")?"&":"?")+rp(s)),v}function sp(v,c,s){var l;return new Promise((u,g)=>{if(v=this.urlGenerator.call(this.table,v,c,s),"GET"!=c.method.toUpperCase())if(l="object"==typeof this.table.options.ajaxContentType?this.table.options.ajaxContentType:this.contentTypeFormatters[this.table.options.ajaxContentType]){for(var b in l.headers)c.headers||(c.headers={}),void 0===c.headers[b]&&(c.headers[b]=l.headers[b]);c.body=l.body.call(this,v,c,s)}else console.warn("Ajax Error - Invalid ajaxContentType value:",this.table.options.ajaxContentType);v?(void 0===c.headers&&(c.headers={}),void 0===c.headers.Accept&&(c.headers.Accept="application/json"),void 0===c.headers["X-Requested-With"]&&(c.headers["X-Requested-With"]="XMLHttpRequest"),void 0===c.mode&&(c.mode="cors"),"cors"==c.mode?(void 0===c.headers.Origin&&(c.headers.Origin=window.location.origin),void 0===c.credentials&&(c.credentials="same-origin")):void 0===c.credentials&&(c.credentials="include"),fetch(v,c).then(w=>{w.ok?w.json().then(k=>{u(k)}).catch(k=>{g(k),console.warn("Ajax Load Error - Invalid JSON returned",k)}):(console.error("Ajax Load Error - Connection Error: "+w.status,w.statusText),g(w))}).catch(w=>{console.error("Ajax Load Error - Connection Error: ",w),g(w)})):(console.warn("Ajax Load Error - No URL Set"),u([]))})}function pd(v,c){var s=[];if(c=c||"",Array.isArray(v))v.forEach((u,g)=>{s=s.concat(pd(u,c?c+"["+g+"]":g))});else if("object"==typeof v)for(var l in v)s=s.concat(pd(v[l],c?c+"["+l+"]":l));else s.push({key:c,value:v});return s}var Gp={json:{headers:{"Content-Type":"application/json"},body:function(v,c,s){return JSON.stringify(s)}},form:{headers:{},body:function(v,c,s){var l=pd(s),u=new FormData;return l.forEach(function(g){u.append(g.key,g.value)}),u}}};let Md=(()=>{class v extends vr{constructor(s){super(s),this.config=!1,this.url="",this.urlGenerator=!1,this.params=!1,this.loaderPromise=!1,this.registerTableOption("ajaxURL",!1),this.registerTableOption("ajaxURLGenerator",!1),this.registerTableOption("ajaxParams",{}),this.registerTableOption("ajaxConfig","get"),this.registerTableOption("ajaxContentType","form"),this.registerTableOption("ajaxRequestFunc",!1),this.registerTableOption("ajaxRequesting",function(){}),this.registerTableOption("ajaxResponse",!1),this.contentTypeFormatters=v.contentTypeFormatters}initialize(){this.loaderPromise=this.table.options.ajaxRequestFunc||v.defaultLoaderPromise,this.urlGenerator=this.table.options.ajaxURLGenerator||v.defaultURLGenerator,this.table.options.ajaxParams&&this.setParams(this.table.options.ajaxParams),this.table.options.ajaxConfig&&this.setConfig(this.table.options.ajaxConfig),this.table.options.ajaxURL&&this.setUrl(this.table.options.ajaxURL),this.registerTableFunction("getAjaxUrl",this.getUrl.bind(this)),this.subscribe("data-loading",this.requestDataCheck.bind(this)),this.subscribe("data-load",this.requestData.bind(this))}requestDataCheck(s,l,u,g){return!((s||!this.url)&&"string"!=typeof s)}requestData(s,l,u,g,b){return this.requestDataCheck(s)?(s&&this.setUrl(s),l&&this.setParams(l,!0),u&&this.setConfig(u),this.sendRequest()):b}setParams(s,l){if(l){this.params=this.params||{};for(let u in s)this.params[u]=s[u]}else this.params=s}getParams(){return this.params||{}}setConfig(s){if(this._loadDefaultConfig(),"string"==typeof s)this.config.method=s;else for(let l in s)this.config[l]=s[l]}_loadDefaultConfig(s){if(!this.config||s){this.config={};for(let l in v.defaultConfig)this.config[l]=v.defaultConfig[l]}}setUrl(s){this.url=s}getUrl(){return this.url}sendRequest(s){var l=this.url;return this._loadDefaultConfig(),!1!==this.table.options.ajaxRequesting.call(this.table,this.url,this.params)?this.loaderPromise(l,this.config,this.params).then(u=>(this.table.options.ajaxResponse&&(u=this.table.options.ajaxResponse.call(this.table,this.url,this.params,u)),u)):Promise.reject()}}return v.moduleName="ajax",v.defaultConfig=op,v.defaultURLGenerator=Vf,v.defaultLoaderPromise=sp,v.contentTypeFormatters=Gp,v})();var fd={replace:function(v){return this.table.setData(v)},update:function(v){return this.table.updateOrAddData(v)},insert:function(v){return this.table.addData(v)}},Zh={table:function(v){var c=[],s=!0,l=this.table.columnManager.columns,u=[],g=[];return(v=v.split("\n")).forEach(function(b){c.push(b.split("\t"))}),!(!c.length||1===c.length&&c[0].length<2)&&(c[0].forEach(function(b){var w=l.find(function(k){return b&&k.definition.title&&b.trim()&&k.definition.title.trim()===b.trim()});w?u.push(w):s=!1}),s||(s=!0,u=[],c[0].forEach(function(b){var w=l.find(function(k){return b&&k.field&&b.trim()&&k.field.trim()===b.trim()});w?u.push(w):s=!1}),s||(u=this.table.columnManager.columnsByIndex)),s&&c.shift(),c.forEach(function(b){var w={};b.forEach(function(k,H){u[H]&&(w[u[H].field]=k)}),g.push(w)}),g)}};let ap=(()=>{class v extends vr{constructor(s){super(s),this.mode=!0,this.pasteParser=function(){},this.pasteAction=function(){},this.customSelection=!1,this.rowRange=!1,this.blocked=!0,this.registerTableOption("clipboard",!1),this.registerTableOption("clipboardCopyStyled",!0),this.registerTableOption("clipboardCopyConfig",!1),this.registerTableOption("clipboardCopyFormatter",!1),this.registerTableOption("clipboardCopyRowRange","active"),this.registerTableOption("clipboardPasteParser","table"),this.registerTableOption("clipboardPasteAction","insert"),this.registerColumnOption("clipboard"),this.registerColumnOption("titleClipboard")}initialize(){this.mode=this.table.options.clipboard,this.rowRange=this.table.options.clipboardCopyRowRange,(!0===this.mode||"copy"===this.mode)&&this.table.element.addEventListener("copy",s=>{var l,u;if(!this.blocked){if(s.preventDefault(),this.customSelection)l=this.customSelection,this.table.options.clipboardCopyFormatter&&(l=this.table.options.clipboardCopyFormatter("plain",l));else{var g=this.table.modules.export.generateExportList(this.table.options.clipboardCopyConfig,this.table.options.clipboardCopyStyled,this.rowRange,"clipboard");l=(u=this.table.modules.export.genereateHTMLTable(g))?this.generatePlainContent(g):"",this.table.options.clipboardCopyFormatter&&(l=this.table.options.clipboardCopyFormatter("plain",l),u=this.table.options.clipboardCopyFormatter("html",u))}window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",l):s.clipboardData&&s.clipboardData.setData?(s.clipboardData.setData("text/plain",l),u&&s.clipboardData.setData("text/html",u)):s.originalEvent&&s.originalEvent.clipboardData.setData&&(s.originalEvent.clipboardData.setData("text/plain",l),u&&s.originalEvent.clipboardData.setData("text/html",u)),this.dispatchExternal("clipboardCopied",l,u),this.reset()}}),(!0===this.mode||"paste"===this.mode)&&this.table.element.addEventListener("paste",s=>{this.paste(s)}),this.setPasteParser(this.table.options.clipboardPasteParser),this.setPasteAction(this.table.options.clipboardPasteAction),this.registerTableFunction("copyToClipboard",this.copy.bind(this))}reset(){this.blocked=!0,this.customSelection=!1}generatePlainContent(s){var l=[];return s.forEach(u=>{var g=[];u.columns.forEach(b=>{var w="";if(b)if("group"===u.type&&(b.value=b.component.getKey()),null===b.value)w="";else switch(typeof b.value){case"object":w=JSON.stringify(b.value);break;case"undefined":w="";break;default:w=b.value}g.push(w)}),l.push(g.join("\t"))}),l.join("\n")}copy(u,l){var g,b;this.blocked=!1,this.customSelection=!1,(!0===this.mode||"copy"===this.mode)&&(this.rowRange=u||this.table.options.clipboardCopyRowRange,void 0!==window.getSelection&&void 0!==document.createRange?((u=document.createRange()).selectNodeContents(this.table.element),(g=window.getSelection()).toString()&&l&&(this.customSelection=g.toString()),g.removeAllRanges(),g.addRange(u)):void 0!==document.selection&&void 0!==document.body.createTextRange&&((b=document.body.createTextRange()).moveToElementText(this.table.element),b.select()),document.execCommand("copy"),g&&g.removeAllRanges())}setPasteAction(s){switch(typeof s){case"string":this.pasteAction=v.pasteActions[s],this.pasteAction||console.warn("Clipboard Error - No such paste action found:",s);break;case"function":this.pasteAction=s}}setPasteParser(s){switch(typeof s){case"string":this.pasteParser=v.pasteParsers[s],this.pasteParser||console.warn("Clipboard Error - No such paste parser found:",s);break;case"function":this.pasteParser=s}}paste(s){var l,u,g;this.checkPaseOrigin(s)&&(l=this.getPasteData(s),(u=this.pasteParser.call(this,l))?(s.preventDefault(),this.table.modExists("mutator")&&(u=this.mutateData(u)),g=this.pasteAction.call(this,u),this.dispatchExternal("clipboardPasted",l,u,g)):this.dispatchExternal("clipboardPasteError",l))}mutateData(s){var l=[];return Array.isArray(s)?s.forEach(u=>{l.push(this.table.modules.mutator.transformRow(u,"clipboard"))}):l=s,l}checkPaseOrigin(s){var l=!0;return("DIV"!=s.target.tagName||this.table.modules.edit.currentCell)&&(l=!1),l}getPasteData(s){var l;return window.clipboardData&&window.clipboardData.getData?l=window.clipboardData.getData("Text"):s.clipboardData&&s.clipboardData.getData?l=s.clipboardData.getData("text/plain"):s.originalEvent&&s.originalEvent.clipboardData.getData&&(l=s.originalEvent.clipboardData.getData("text/plain")),l}}return v.moduleName="clipboard",v.pasteActions=fd,v.pasteParsers=Zh,v})();class gd{constructor(c){return this._row=c,new Proxy(this,{get:function(s,l,u){return void 0!==s[l]?s[l]:s._row.table.componentFunctionBinder.handle("row",s._row,l)}})}getData(c){return this._row.getData(c)}getElement(){return this._row.getElement()}getTable(){return this._row.table}getCells(){var c=[];return this._row.getCells().forEach(function(s){c.push(s.getComponent())}),c}getCell(c){var s=this._row.getCell(c);return!!s&&s.getComponent()}_getSelf(){return this._row}}class Wp{constructor(c){return this._cell=c,new Proxy(this,{get:function(s,l,u){return void 0!==s[l]?s[l]:s._cell.table.componentFunctionBinder.handle("cell",s._cell,l)}})}getValue(){return this._cell.getValue()}getOldValue(){return this._cell.getOldValue()}getInitialValue(){return this._cell.initialValue}getElement(){return this._cell.getElement()}getRow(){return this._cell.row.getComponent()}getData(){return this._cell.row.getData()}getField(){return this._cell.column.getField()}getColumn(){return this._cell.column.getComponent()}setValue(c,s){void 0===s&&(s=!0),this._cell.setValue(c,s)}restoreOldValue(){this._cell.setValueActual(this._cell.getOldValue())}restoreInitialValue(){this._cell.setValueActual(this._cell.initialValue)}checkHeight(){this._cell.checkHeight()}getTable(){return this._cell.table}_getSelf(){return this._cell}}class Od extends tu{constructor(c,s){super(c.table),this.table=c.table,this.column=c,this.row=s,this.element=null,this.value=null,this.oldValue=null,this.modules={},this.height=null,this.width=null,this.minWidth=null,this.component=null,this.loaded=!1,this.build()}build(){this.generateElement(),this.setWidth(),this._configureCell(),this.setValueActual(this.column.getFieldValue(this.row.data)),this.initialValue=this.value}generateElement(){this.element=document.createElement("div"),this.element.className="tabulator-cell",this.element.setAttribute("role","gridcell"),this.element=this.element}_configureCell(){var c=this.element,s=this.column.getField();c.style.textAlign=this.column.hozAlign,this.column.vertAlign&&(c.style.display="inline-flex",c.style.alignItems={top:"flex-start",bottom:"flex-end",middle:"center"}[this.column.vertAlign]||"",this.column.hozAlign&&(c.style.justifyContent={left:"flex-start",right:"flex-end",center:"center"}[this.column.hozAlign]||"")),s&&c.setAttribute("tabulator-field",s),this.column.definition.cssClass&&this.column.definition.cssClass.split(" ").forEach(b=>{c.classList.add(b)}),"hover"===this.table.options.tooltipGenerationMode&&c.addEventListener("mouseenter",b=>{this._generateTooltip()}),this.dispatch("cell-init",this),this.column.visible||this.hide()}_generateContents(){var c;switch(typeof(c=this.chain("cell-format",this,null,()=>this.element.innerHTML=this.value))){case"object":if(c instanceof Node){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.appendChild(c)}else this.element.innerHTML="",null!=c&&console.warn("Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",c);break;case"undefined":case"null":this.element.innerHTML="";break;default:this.element.innerHTML=c}}cellRendered(){this.dispatch("cell-rendered",this)}_generateTooltip(){var c=this.column.tooltip;c?(!0===c?c=this.value:"function"==typeof c&&!1===(c=c(this.getComponent()))&&(c=""),void 0===c&&(c=""),this.element.setAttribute("title",c)):this.element.setAttribute("title","")}getElement(c){return this.loaded||(this.loaded=!0,c||this.layoutElement()),this.element}getValue(){return this.value}getOldValue(){return this.oldValue}setValue(c,s){this.setValueProcessData(c,s)&&(this.dispatch("cell-value-updated",this),this.cellRendered(),this.dispatchExternal("cellEdited",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()))}setValueProcessData(c,s){var l=!1;return this.value!=c&&(l=!0,s&&(c=this.chain("cell-value-changing",[this,c],null,c))),this.setValueActual(c),l&&this.dispatch("cell-value-changed",this),l}setValueActual(c){this.oldValue=this.value,this.value=c,this.dispatch("cell-value-save-before",this),this.column.setFieldValue(this.row.data,c),this.dispatch("cell-value-save-after",this),this.loaded&&this.layoutElement()}layoutElement(){this._generateContents(),this._generateTooltip(),this.dispatch("cell-layout",this)}setWidth(){this.width=this.column.width,this.element.style.width=this.column.widthStyled}clearWidth(){this.width="",this.element.style.width=""}getWidth(){return this.width||this.element.offsetWidth}setMinWidth(){this.minWidth=this.column.minWidth,this.element.style.minWidth=this.column.minWidthStyled}setMaxWidth(){this.maxWidth=this.column.maxWidth,this.element.style.maxWidth=this.column.maxWidthStyled}checkHeight(){this.row.reinitializeHeight()}clearHeight(){this.element.style.height="",this.height=null}setHeight(){this.height=this.row.height,this.element.style.height=this.row.heightStyled}getHeight(){return this.height||this.element.offsetHeight}show(){this.element.style.display=this.column.vertAlign?"inline-flex":""}hide(){this.element.style.display="none"}delete(){this.dispatch("cell-delete",this),!this.table.rowManager.redrawBlock&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.column.deleteCell(this),this.row.deleteCell(this),this.calcs={}}getIndex(){return this.row.getCellIndex(this)}getComponent(){return this.component||(this.component=new Wp(this)),this.component}}class zp{constructor(c){return this._column=c,this.type="ColumnComponent",new Proxy(this,{get:function(s,l,u){return void 0!==s[l]?s[l]:s._column.table.componentFunctionBinder.handle("column",s._column,l)}})}getElement(){return this._column.getElement()}getDefinition(){return this._column.getDefinition()}getField(){return this._column.getField()}getCells(){var c=[];return this._column.cells.forEach(function(s){c.push(s.getComponent())}),c}isVisible(){return this._column.visible}show(){this._column.isGroup?this._column.columns.forEach(function(c){c.show()}):this._column.show()}hide(){this._column.isGroup?this._column.columns.forEach(function(c){c.hide()}):this._column.hide()}toggle(){this._column.visible?this.hide():this.show()}delete(){return this._column.delete()}getSubColumns(){var c=[];return this._column.columns.length&&this._column.columns.forEach(function(s){c.push(s.getComponent())}),c}getParentColumn(){return this._column.parent instanceof Column&&this._column.parent.getComponent()}_getSelf(){return this._column}scrollTo(){return this._column.table.columnManager.scrollToColumn(this._column)}getTable(){return this._column.table}move(c,s){var l=this._column.table.columnManager.findColumn(c);l?this._column.table.columnManager.moveColumn(this._column,l,s):console.warn("Move Error - No matching column found:",l)}getNextColumn(){var c=this._column.nextColumn();return!!c&&c.getComponent()}getPrevColumn(){var c=this._column.prevColumn();return!!c&&c.getComponent()}updateDefinition(c){return this._column.updateDefinition(c)}getWidth(){return this._column.getWidth()}setWidth(c){var s;return s=!0===c?this._column.reinitializeWidth(!0):this._column.setWidth(c),this._column.table.columnManager.renderer.rerenderColumns(!0),s}}var Gf={title:void 0,field:void 0,columns:void 0,visible:void 0,hozAlign:void 0,vertAlign:void 0,width:void 0,minWidth:40,maxWidth:void 0,tooltip:void 0,cssClass:void 0,variableHeight:void 0,headerTooltip:void 0,headerVertical:void 0,headerHozAlign:void 0,editableTitle:void 0};let _d=(()=>{class v extends tu{constructor(s,l){super(l.table),this.definition=s,this.parent=l,this.type="column",this.columns=[],this.cells=[],this.element=this.createElement(),this.contentElement=!1,this.titleHolderElement=!1,this.titleElement=!1,this.groupElement=this.createGroupElement(),this.isGroup=!1,this.tooltip=!1,this.hozAlign="",this.vertAlign="",this.field="",this.fieldStructure="",this.getFieldValue="",this.setFieldValue="",this.titleFormatterRendered=!1,this.mapDefinitions(),this.setField(this.definition.field),this.modules={},this.width=null,this.widthStyled="",this.maxWidth=null,this.maxWidthStyled="",this.minWidth=null,this.minWidthStyled="",this.widthFixed=!1,this.visible=!0,this.component=null,this.definition.columns?(this.isGroup=!0,this.definition.columns.forEach((u,g)=>{var b=new v(u,this);this.attachColumn(b)}),this.checkColumnVisibility()):l.registerColumnField(this),this._initialize(),this.bindModuleColumns()}createElement(){var s=document.createElement("div");return s.classList.add("tabulator-col"),s.setAttribute("role","columnheader"),s.setAttribute("aria-sort","none"),s}createGroupElement(){var s=document.createElement("div");return s.classList.add("tabulator-col-group-cols"),s}mapDefinitions(){var s=this.table.options.columnDefaults;if(s)for(let l in s)void 0===this.definition[l]&&(this.definition[l]=s[l]);this.definition=this.table.columnManager.optionsList.generate(v.defaultOptionList,this.definition)}checkDefinition(){Object.keys(this.definition).forEach(s=>{-1===v.defaultOptionList.indexOf(s)&&console.warn("Invalid column definition option in '"+(this.field||this.definition.title)+"' column:",s)})}setField(s){this.field=s,this.fieldStructure=s?this.table.options.nestedFieldSeparator?s.split(this.table.options.nestedFieldSeparator):[s]:[],this.getFieldValue=this.fieldStructure.length>1?this._getNestedData:this._getFlatData,this.setFieldValue=this.fieldStructure.length>1?this._setNestedData:this._setFlatData}registerColumnPosition(s){this.parent.registerColumnPosition(s)}registerColumnField(s){this.parent.registerColumnField(s)}reRegisterPosition(){this.isGroup?this.columns.forEach(function(s){s.reRegisterPosition()}):this.registerColumnPosition(this)}_mapDepricatedFunctionality(){}setTooltip(){var s=this.definition,l=void 0===s.headerTooltip?s.tooltip:s.headerTooltip;l?!0===l?s.field?this.langBind("columns|"+s.field,u=>{this.element.setAttribute("title",u||s.title)}):this.element.setAttribute("title",s.title):("function"==typeof l&&!1===(l=l(this.getComponent()))&&(l=""),this.element.setAttribute("title",l)):this.element.setAttribute("title","")}_initialize(){for(var s=this.definition;this.element.firstChild;)this.element.removeChild(this.element.firstChild);s.headerVertical&&(this.element.classList.add("tabulator-col-vertical"),"flip"===s.headerVertical&&this.element.classList.add("tabulator-col-vertical-flip")),this.contentElement=this._bindEvents(),this.contentElement=this._buildColumnHeaderContent(),this.element.appendChild(this.contentElement),this.isGroup?this._buildGroupHeader():this._buildColumnHeader(),this.setTooltip(),this.dispatch("column-init",this),this.element.addEventListener("mouseenter",l=>{this.setTooltip()})}_bindEvents(){var l,u,g,s=this.definition;"function"==typeof s.headerClick&&this.element.addEventListener("click",b=>{s.headerClick(b,this.getComponent())}),"function"==typeof s.headerDblClick&&this.element.addEventListener("dblclick",b=>{s.headerDblClick(b,this.getComponent())}),"function"==typeof s.headerContext&&this.element.addEventListener("contextmenu",b=>{s.headerContext(b,this.getComponent())}),"function"==typeof s.headerTap&&(g=!1,this.element.addEventListener("touchstart",b=>{g=!0},{passive:!0}),this.element.addEventListener("touchend",b=>{g&&s.headerTap(b,this.getComponent()),g=!1})),"function"==typeof s.headerDblTap&&(l=null,this.element.addEventListener("touchend",b=>{l?(clearTimeout(l),l=null,s.headerDblTap(b,this.getComponent())):l=setTimeout(()=>{clearTimeout(l),l=null},300)})),"function"==typeof s.headerTapHold&&(u=null,this.element.addEventListener("touchstart",b=>{clearTimeout(u),u=setTimeout(function(){clearTimeout(u),u=null,g=!1,s.headerTapHold(b,this.getComponent())},1e3)},{passive:!0}),this.element.addEventListener("touchend",b=>{clearTimeout(u),u=null}))}_buildColumnHeader(){var s=this.definition;this.dispatch("column-layout",this),void 0!==s.visible&&(s.visible?this.show(!0):this.hide(!0)),s.cssClass&&s.cssClass.split(" ").forEach(g=>{this.element.classList.add(g)}),s.field&&this.element.setAttribute("tabulator-field",s.field),this.setMinWidth(parseInt(s.minWidth)),s.maxWidth&&this.setMaxWidth(parseInt(s.maxWidth)),this.reinitializeWidth(),this.tooltip=this.definition.tooltip,this.hozAlign=this.definition.hozAlign,this.vertAlign=this.definition.vertAlign,this.titleElement.style.textAlign=this.definition.headerHozAlign}_buildColumnHeaderContent(){var u=document.createElement("div");return u.classList.add("tabulator-col-content"),this.titleHolderElement=document.createElement("div"),this.titleHolderElement.classList.add("tabulator-col-title-holder"),u.appendChild(this.titleHolderElement),this.titleElement=this._buildColumnHeaderTitle(),this.titleHolderElement.appendChild(this.titleElement),u}_buildColumnHeaderTitle(){var s=this.definition,l=document.createElement("div");if(l.classList.add("tabulator-col-title"),s.editableTitle){var u=document.createElement("input");u.classList.add("tabulator-title-editor"),u.addEventListener("click",g=>{g.stopPropagation(),u.focus()}),u.addEventListener("change",()=>{s.title=u.value,this.dispatchExternal("columnTitleChanged",this.getComponent())}),l.appendChild(u),s.field?this.langBind("columns|"+s.field,g=>{u.value=g||s.title||"&nbsp;"}):u.value=s.title||"&nbsp;"}else s.field?this.langBind("columns|"+s.field,g=>{this._formatColumnHeaderTitle(l,g||s.title||"&nbsp;")}):this._formatColumnHeaderTitle(l,s.title||"&nbsp;");return l}_formatColumnHeaderTitle(s,l){var u=this.chain("column-format",[this,l,s],null,()=>l);switch(typeof u){case"object":u instanceof Node?s.appendChild(u):(s.innerHTML="",console.warn("Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:",u));break;case"undefined":case"null":s.innerHTML="";break;default:s.innerHTML=u}}_buildGroupHeader(){this.element.classList.add("tabulator-col-group"),this.element.setAttribute("role","columngroup"),this.element.setAttribute("aria-title",this.definition.title),this.definition.cssClass&&this.definition.cssClass.split(" ").forEach(l=>{this.element.classList.add(l)}),this.titleElement.style.textAlign=this.definition.headerHozAlign,this.element.appendChild(this.groupElement)}_getFlatData(s){return s[this.field]}_getNestedData(s){var b,l=s,u=this.fieldStructure,g=u.length;for(let w=0;w<g&&(b=l=l[u[w]],l);w++);return b}_setFlatData(s,l){this.field&&(s[this.field]=l)}_setNestedData(s,l){var u=s,g=this.fieldStructure,b=g.length;for(let w=0;w<b;w++)if(w==b-1)u[g[w]]=l;else{if(!u[g[w]]){if(void 0===l)break;u[g[w]]={}}u=u[g[w]]}}attachColumn(s){this.groupElement?(this.columns.push(s),this.groupElement.appendChild(s.getElement())):console.warn("Column Warning - Column being attached to another column instead of column group")}verticalAlign(s,l){var u=this.parent.isGroup?this.parent.getGroupElement().clientHeight:l||this.parent.getHeadersElement().clientHeight;this.element.style.height=u+"px",this.isGroup&&(this.groupElement.style.minHeight=u-this.contentElement.offsetHeight+"px"),!this.isGroup&&"top"!==s&&(this.element.style.paddingTop="bottom"===s?this.element.clientHeight-this.contentElement.offsetHeight+"px":(this.element.clientHeight-this.contentElement.offsetHeight)/2+"px"),this.columns.forEach(function(g){g.verticalAlign(s)})}clearVerticalAlign(){this.element.style.paddingTop="",this.element.style.height="",this.element.style.minHeight="",this.groupElement.style.minHeight="",this.columns.forEach(function(s){s.clearVerticalAlign()})}bindModuleColumns(){"rownum"==this.definition.formatter&&(this.table.rowManager.rowNumColumn=this)}getElement(){return this.element}getGroupElement(){return this.groupElement}getField(){return this.field}getFirstColumn(){return this.isGroup?!!this.columns.length&&this.columns[0].getFirstColumn():this}getLastColumn(){return this.isGroup?!!this.columns.length&&this.columns[this.columns.length-1].getLastColumn():this}getColumns(){return this.columns}getCells(){return this.cells}getTopColumn(){return this.parent.isGroup?this.parent.getTopColumn():this}getDefinition(s){var l=[];return this.isGroup&&s&&(this.columns.forEach(function(u){l.push(u.getDefinition(!0))}),this.definition.columns=l),this.definition}checkColumnVisibility(){var s=!1;this.columns.forEach(function(l){l.visible&&(s=!0)}),s?(this.show(),this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1)):this.hide()}show(s,l){this.visible||(this.visible=!0,this.element.style.display="",this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(u){u.show()}),!this.isGroup&&null===this.width&&this.reinitializeWidth(),this.table.columnManager.verticalAlignHeaders(),this.dispatch("column-show",this,l),s||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!0),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.renderer.rerenderColumns())}hide(s,l){this.visible&&(this.visible=!1,this.element.style.display="none",this.table.columnManager.verticalAlignHeaders(),this.parent.isGroup&&this.parent.checkColumnVisibility(),this.cells.forEach(function(u){u.hide()}),this.dispatch("column-hide",this),s||this.dispatchExternal("columnVisibilityChanged",this.getComponent(),!1),this.parent.isGroup&&this.parent.matchChildWidths(),this.silent||this.table.columnManager.renderer.rerenderColumns())}matchChildWidths(){var s=0;this.contentElement&&this.columns.length&&(this.columns.forEach(function(l){l.visible&&(s+=l.getWidth())}),this.contentElement.style.maxWidth=s-1+"px",this.parent.isGroup&&this.parent.matchChildWidths())}removeChild(s){var l=this.columns.indexOf(s);l>-1&&this.columns.splice(l,1),this.columns.length||this.delete()}setWidth(s){this.widthFixed=!0,this.setWidthActual(s)}setWidthActual(s){isNaN(s)&&(s=Math.floor(this.table.element.clientWidth/100*parseInt(s))),s=Math.max(this.minWidth,s),this.maxWidth&&(s=Math.min(this.maxWidth,s)),this.width=s,this.widthStyled=s?s+"px":"",this.element.style.width=this.widthStyled,this.isGroup||this.cells.forEach(function(l){l.setWidth()}),this.parent.isGroup&&this.parent.matchChildWidths(),this.dispatch("column-width",this)}checkCellHeights(){var s=[];this.cells.forEach(function(l){l.row.heightInitialized&&(null!==l.row.getElement().offsetParent?(s.push(l.row),l.row.clearCellHeight()):l.row.heightInitialized=!1)}),s.forEach(function(l){l.calcHeight()}),s.forEach(function(l){l.setCellHeight()})}getWidth(){var s=0;return this.isGroup?this.columns.forEach(function(l){l.visible&&(s+=l.getWidth())}):s=this.width,s}getHeight(){return this.element.offsetHeight}setMinWidth(s){this.minWidth=s,this.minWidthStyled=s?s+"px":"",this.element.style.minWidth=this.minWidthStyled,this.cells.forEach(function(l){l.setMinWidth()})}setMaxWidth(s){this.maxWidth=s,this.maxWidthStyled=s?s+"px":"",this.element.style.maxWidth=this.maxWidthStyled,this.cells.forEach(function(l){l.setMaxWidth()})}delete(){return new Promise((s,l)=>{this.isGroup&&this.columns.forEach(function(g){g.delete()}),this.dispatch("column-delete",this);var u=this.cells.length;for(let g=0;g<u;g++)this.cells[0].delete();this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=!1,this.contentElement=!1,this.titleElement=!1,this.groupElement=!1,this.parent.isGroup&&this.parent.removeChild(this),this.table.columnManager.deregisterColumn(this),this.table.columnManager.renderer.rerenderColumns(!0),s()})}columnRendered(){this.titleFormatterRendered&&this.titleFormatterRendered()}generateCell(s){var l=new Od(this,s);return this.cells.push(l),l}nextColumn(){var s=this.table.columnManager.findColumnIndex(this);return s>-1&&this._nextVisibleColumn(s+1)}_nextVisibleColumn(s){var l=this.table.columnManager.getColumnByIndex(s);return!l||l.visible?l:this._nextVisibleColumn(s+1)}prevColumn(){var s=this.table.columnManager.findColumnIndex(this);return s>-1&&this._prevVisibleColumn(s-1)}_prevVisibleColumn(s){var l=this.table.columnManager.getColumnByIndex(s);return!l||l.visible?l:this._prevVisibleColumn(s-1)}reinitializeWidth(s){this.widthFixed=!1,void 0!==this.definition.width&&!s&&this.setWidth(this.definition.width),this.dispatch("column-width-fit-before",this),this.fitToData(),this.dispatch("column-width-fit-after",this)}fitToData(){if(!this.isGroup){this.widthFixed||(this.element.style.width="",this.cells.forEach(l=>{l.clearWidth()}));var s=this.element.offsetWidth;(!this.width||!this.widthFixed)&&(this.cells.forEach(l=>{var u=l.getWidth();u>s&&(s=u)}),s&&this.setWidthActual(s+1))}}updateDefinition(s){var l;return this.isGroup||this.parent.isGroup?(console.error("Column Update Error - The updateDefinition function is only available on ungrouped columns"),Promise.reject("Column Update Error - The updateDefinition function is only available on columns, not column groups")):(l=Object.assign({},this.getDefinition()),l=Object.assign(l,s),this.table.columnManager.addColumn(l,!1,this).then(u=>(l.field==this.field&&(this.field=!1),this.delete().then(()=>u.getComponent()))))}deleteCell(s){var l=this.cells.indexOf(s);l>-1&&this.cells.splice(l,1)}getComponent(){return this.component||(this.component=new zp(this)),this.component}}return v.defaultOptionList=Gf,v})();class eu{constructor(c){return this._row=c,new Proxy(this,{get:function(s,l,u){return void 0!==s[l]?s[l]:s._row.table.componentFunctionBinder.handle("row",s._row,l)}})}getData(c){return this._row.getData(c)}getElement(){return this._row.getElement()}getCells(){var c=[];return this._row.getCells().forEach(function(s){c.push(s.getComponent())}),c}getCell(c){var s=this._row.getCell(c);return!!s&&s.getComponent()}getIndex(){return this._row.getData("data")[this._row.table.options.index]}getPosition(c){return this._row.table.rowManager.getRowPosition(this._row,c)}delete(){return this._row.delete()}scrollTo(){return this._row.table.rowManager.scrollToRow(this._row)}move(c,s){this._row.moveToRow(c,s)}update(c){return this._row.updateData(c)}normalizeHeight(){this._row.normalizeHeight(!0)}_getSelf(){return this._row}reformat(){return this._row.reinitialize()}getTable(){return this._row.table}getNextRow(){var c=this._row.nextRow();return c&&c.getComponent()}getPrevRow(){var c=this._row.prevRow();return c&&c.getComponent()}}class Gr extends tu{constructor(c,s,l="row"){super(s.table),this.parent=s,this.data={},this.type=l,this.element=!1,this.modules={},this.cells=[],this.height=0,this.heightStyled="",this.manualHeight=!1,this.outerHeight=0,this.initialized=!1,this.heightInitialized=!1,this.component=null,this.created=!1,this.setData(c)}create(){this.created||(this.created=!0,this.generateElement())}createElement(){var c=document.createElement("div");c.classList.add("tabulator-row"),c.setAttribute("role","row"),this.element=c}getElement(){return this.create(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}generateElement(){this.createElement(),this.dispatch("row-init",this)}generateCells(){this.cells=this.table.columnManager.generateCells(this)}initialize(c){if(this.create(),!this.initialized||c){for(this.deleteCells();this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.dispatch("row-layout-before",this),this.generateCells(),this.table.columnManager.renderer.renderRowCells(this),c&&this.normalizeHeight(),this.dispatch("row-layout",this),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent()),this.initialized=!0,this.dispatch("row-layout-after",this)}else this.table.columnManager.renderer.rerenderRowCells(this)}reinitializeHeight(){this.heightInitialized=!1,this.element&&null!==this.element.offsetParent&&this.normalizeHeight(!0)}deinitializeHeight(){this.heightInitialized=!1}reinitialize(c){this.initialized=!1,this.heightInitialized=!1,this.manualHeight||(this.height=0,this.heightStyled=""),this.element&&null!==this.element.offsetParent&&this.initialize(!0),this.dispatch("row-relayout",this)}calcHeight(c){var s=0,l=this.table.options.resizableRows?this.element.clientHeight:0;this.cells.forEach(function(u){var g=u.getHeight();g>s&&(s=g)}),this.height=c?Math.max(s,l):this.manualHeight?this.height:Math.max(s,l),this.heightStyled=this.height?this.height+"px":"",this.outerHeight=this.element.offsetHeight}setCellHeight(){this.cells.forEach(function(c){c.setHeight()}),this.heightInitialized=!0}clearCellHeight(){this.cells.forEach(function(c){c.clearHeight()})}normalizeHeight(c){c&&this.clearCellHeight(),this.calcHeight(c),this.setCellHeight()}setHeight(c,s){(this.height!=c||s)&&(this.manualHeight=!0,this.height=c,this.heightStyled=c?c+"px":"",this.setCellHeight(),this.outerHeight=this.element.offsetHeight)}getHeight(){return this.outerHeight}getWidth(){return this.element.offsetWidth}deleteCell(c){var s=this.cells.indexOf(c);s>-1&&this.cells.splice(s,1)}setData(c){this.data=this.chain("row-data-init-before",[this,c],void 0,c),this.dispatch("row-data-init-after",this)}updateData(c){var u,s=this.element&&Ws.elVisible(this.element),l={};return new Promise((g,b)=>{for(var w in"string"==typeof c&&(c=JSON.parse(c)),this.dispatch("row-data-save-before",this),this.subscribed("row-data-changing")&&(l=Object.assign(l,this.data),l=Object.assign(l,c)),u=this.chain("row-data-changing",[this,l,c],null,c))this.data[w]=u[w];for(var w in this.dispatch("row-data-save-after",this),c)this.table.columnManager.getColumnsByFieldRoot(w).forEach(Z=>{let ht=this.getCell(Z.getField());if(ht){let Pt=Z.getFieldValue(u);ht.getValue()!=Pt&&(ht.setValueProcessData(Pt),s&&ht.cellRendered())}});s?(this.normalizeHeight(!0),this.table.options.rowFormatter&&this.table.options.rowFormatter(this.getComponent())):(this.initialized=!1,this.height=0,this.heightStyled=""),this.dispatch("row-data-changed",this,s,c),this.dispatchExternal("rowUpdated",this.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),g()})}getData(c){return c?this.chain("row-data-retrieve",[this,c],null,this.data):this.data}getCell(c){return c=this.table.columnManager.findColumn(c),this.initialized||this.generateCells(),this.cells.find(function(l){return l.column===c})}getCellIndex(c){return this.cells.findIndex(function(s){return s===c})}findCell(c){return this.cells.find(s=>s.element===c)}getCells(){return this.initialized||this.generateCells(),this.cells}nextRow(){return this.table.rowManager.nextDisplayRow(this,!0)||!1}prevRow(){return this.table.rowManager.prevDisplayRow(this,!0)||!1}moveToRow(c,s){var l=this.table.rowManager.findRow(c);l?(this.table.rowManager.moveRowActual(this,l,!s),this.table.rowManager.refreshActiveData("display",!1,!0)):console.warn("Move Error - No matching row found:",c)}delete(){return this.dispatch("row-delete",this),this.deleteActual(),Promise.resolve()}deleteActual(c){this.table.rowManager.getRowIndex(this),this.detatchModules(),this.table.rowManager.deleteRow(this,c),this.deleteCells(),this.initialized=!1,this.heightInitialized=!1,this.element=!1,this.dispatch("row-deleted",this)}detatchModules(){this.dispatch("row-deleting",this)}deleteCells(){var c=this.cells.length;for(let s=0;s<c;s++)this.cells[0].delete()}wipe(){if(this.detatchModules(),this.deleteCells(),this.element){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.parentNode&&this.element.parentNode.removeChild(this.element)}this.element=!1,this.modules={}}getGroup(){return this.modules.group||!1}getComponent(){return this.component||(this.component=new eu(this)),this.component}}var md={avg:function(v,c,s){var l=0,u=void 0!==s.precision?s.precision:2;return v.length&&(l=v.reduce(function(g,b){return Number(g)+Number(b)}),l/=v.length,l=!1!==u?l.toFixed(u):l),parseFloat(l).toString()},max:function(v,c,s){var l=null,u=void 0!==s.precision&&s.precision;return v.forEach(function(g){((g=Number(g))>l||null===l)&&(l=g)}),null!==l?!1!==u?l.toFixed(u):l:""},min:function(v,c,s){var l=null,u=void 0!==s.precision&&s.precision;return v.forEach(function(g){((g=Number(g))<l||null===l)&&(l=g)}),null!==l?!1!==u?l.toFixed(u):l:""},sum:function(v,c,s){var l=0,u=void 0!==s.precision&&s.precision;return v.length&&v.forEach(function(g){g=Number(g),l+=isNaN(g)?0:Number(g)}),!1!==u?l.toFixed(u):l},concat:function(v,c,s){var l=0;return v.length&&(l=v.reduce(function(u,g){return String(u)+String(g)})),l},count:function(v,c,s){var l=0;return v.length&&v.forEach(function(u){u&&l++}),l}};let lp=(()=>{class v extends vr{constructor(s){super(s),this.topCalcs=[],this.botCalcs=[],this.genColumn=!1,this.topElement=this.createElement(),this.botElement=this.createElement(),this.topRow=!1,this.botRow=!1,this.topInitialized=!1,this.botInitialized=!1,this.registerTableOption("columnCalcs",!0),this.registerColumnOption("topCalc"),this.registerColumnOption("topCalcParams"),this.registerColumnOption("topCalcFormatter"),this.registerColumnOption("topCalcFormatterParams"),this.registerColumnOption("bottomCalc"),this.registerColumnOption("bottomCalcParams"),this.registerColumnOption("bottomCalcFormatter"),this.registerColumnOption("bottomCalcFormatterParams")}createElement(){var s=document.createElement("div");return s.classList.add("tabulator-calcs-holder"),s}initialize(){this.genColumn=new _d({field:"value"},this),this.subscribe("cell-value-changed",this.cellValueChanged.bind(this)),this.subscribe("column-init",this.initializeColumnCheck.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("column-moved",this.recalcActiveRows.bind(this)),this.subscribe("column-add",this.recalcActiveRows.bind(this)),this.subscribe("data-refeshed",this.recalcActiveRows.bind(this)),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.registerTableFunction("getCalcResults",this.getResults.bind(this)),this.registerTableFunction("recalc",this.userRecalc.bind(this))}tableRedraw(s){this.recalc(this.table.rowManager.activeRows),s&&this.redraw()}userRecalc(){this.recalc(this.table.rowManager.activeRows)}rowsUpdated(s){this.table.options.groupBy?this.recalcRowGroup(this):this.recalcActiveRows()}recalcActiveRows(){this.recalc(this.table.rowManager.activeRows)}cellValueChanged(s){(s.column.definition.topCalc||s.column.definition.bottomCalc)&&(this.table.options.groupBy?(("table"==this.table.options.columnCalcs||"both"==this.table.options.columnCalcs)&&this.recalcActiveRows(),"table"!=this.table.options.columnCalcs&&this.recalcRowGroup(s.row)):this.recalcActiveRows())}initializeColumnCheck(s){(s.definition.topCalc||s.definition.bottomCalc)&&this.initializeColumn(s)}initializeColumn(s){var l=s.definition,u={topCalcParams:l.topCalcParams||{},botCalcParams:l.bottomCalcParams||{}};if(l.topCalc){switch(typeof l.topCalc){case"string":v.calculations[l.topCalc]?u.topCalc=v.calculations[l.topCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",l.topCalc);break;case"function":u.topCalc=l.topCalc}u.topCalc&&(s.modules.columnCalcs=u,this.topCalcs.push(s),"group"!=this.table.options.columnCalcs&&this.initializeTopRow())}if(l.bottomCalc){switch(typeof l.bottomCalc){case"string":v.calculations[l.bottomCalc]?u.botCalc=v.calculations[l.bottomCalc]:console.warn("Column Calc Error - No such calculation found, ignoring: ",l.bottomCalc);break;case"function":u.botCalc=l.bottomCalc}u.botCalc&&(s.modules.columnCalcs=u,this.botCalcs.push(s),"group"!=this.table.options.columnCalcs&&this.initializeBottomRow())}}registerColumnField(){}removeCalcs(){var s=!1;this.topInitialized&&(this.topInitialized=!1,this.topElement.parentNode.removeChild(this.topElement),s=!0),this.botInitialized&&(this.botInitialized=!1,this.table.footerManager.remove(this.botElement),s=!0),s&&this.table.rowManager.adjustTableSize()}initializeTopRow(){this.topInitialized||(this.table.columnManager.getElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling),this.topInitialized=!0)}initializeBottomRow(){this.botInitialized||(this.table.footerManager.prepend(this.botElement),this.botInitialized=!0)}scrollHorizontal(s){this.botInitialized&&this.botRow&&(this.botRow.getElement().style.marginLeft=-s+"px")}recalc(s){var l;if(this.topInitialized||this.botInitialized){if(this.rowsToData(s),this.topInitialized){for(this.topRow&&this.topRow.deleteCells(),l=this.generateRow("top",this.rowsToData(s)),this.topRow=l;this.topElement.firstChild;)this.topElement.removeChild(this.topElement.firstChild);this.topElement.appendChild(l.getElement()),l.initialize(!0)}if(this.botInitialized){for(this.botRow&&this.botRow.deleteCells(),l=this.generateRow("bottom",this.rowsToData(s)),this.botRow=l;this.botElement.firstChild;)this.botElement.removeChild(this.botElement.firstChild);this.botElement.appendChild(l.getElement()),l.initialize(!0)}this.table.rowManager.adjustTableSize(),this.table.modExists("frozenColumns")&&this.table.modules.frozenColumns.layout()}}recalcRowGroup(s){this.recalcGroup(this.table.modules.groupRows.getRowGroup(s))}recalcAll(){(this.topCalcs.length||this.botCalcs.length)&&("group"!==this.table.options.columnCalcs&&this.recalcActiveRows(),this.table.options.groupBy&&"table"!==this.table.options.columnCalcs)&&this.table.modules.groupRows.getChildGroups().forEach(l=>{this.recalcGroup(l)})}recalcGroup(s){var l,u;s&&s.calcs&&(s.calcs.bottom&&(l=this.rowsToData(s.rows),u=this.generateRowData("bottom",l),s.calcs.bottom.updateData(u),s.calcs.bottom.reinitialize()),s.calcs.top&&(l=this.rowsToData(s.rows),u=this.generateRowData("top",l),s.calcs.top.updateData(u),s.calcs.top.reinitialize()))}generateTopRow(s){return this.generateRow("top",this.rowsToData(s))}generateBottomRow(s){return this.generateRow("bottom",this.rowsToData(s))}rowsToData(s){var l=[];return s.forEach(u=>{if(l.push(u.getData()),this.table.options.dataTree&&this.table.options.dataTreeChildColumnCalcs&&u.modules.dataTree.open){var g=this.rowsToData(this.table.modules.dataTree.getFilteredTreeChildren(u));l=l.concat(g)}}),l}generateRow(s,l){var g,u=this.generateRowData(s,l);return this.table.modExists("mutator")&&this.table.modules.mutator.disable(),g=new Gr(u,this,"calc"),this.table.modExists("mutator")&&this.table.modules.mutator.enable(),g.getElement().classList.add("tabulator-calcs","tabulator-calcs-"+s),g.component=!1,g.getComponent=()=>(g.component||(g.component=new gd(this)),g.component),g.generateCells=()=>{var b=[];this.table.columnManager.columnsByIndex.forEach(w=>{this.genColumn.setField(w.getField()),this.genColumn.hozAlign=w.hozAlign,this.genColumn.modules.format=w.definition[s+"CalcFormatter"]&&this.table.modExists("format")?{formatter:this.table.modules.format.getFormatter(w.definition[s+"CalcFormatter"]),params:w.definition[s+"CalcFormatterParams"]||{}}:{formatter:this.table.modules.format.getFormatter("plaintext"),params:{}},this.genColumn.definition.cssClass=w.definition.cssClass;var k=new Od(this.genColumn,g);k.getElement(),k.column=w,k.setWidth(),w.cells.push(k),b.push(k),w.visible||k.hide()}),g.cells=b},g}generateRowData(s,l){var w,k,u={},b="top"==s?"topCalc":"botCalc";return("top"==s?this.topCalcs:this.botCalcs).forEach(function(H){var Z=[];H.modules.columnCalcs&&H.modules.columnCalcs[b]&&(l.forEach(function(ht){Z.push(H.getFieldValue(ht))}),w="function"==typeof H.modules.columnCalcs[k=b+"Params"]?H.modules.columnCalcs[k](Z,l):H.modules.columnCalcs[k],H.setFieldValue(u,H.modules.columnCalcs[b](Z,l,w)))}),u}hasTopCalcs(){return!!this.topCalcs.length}hasBottomCalcs(){return!!this.botCalcs.length}redraw(){this.topRow&&this.topRow.normalizeHeight(!0),this.botRow&&this.botRow.normalizeHeight(!0)}getResults(){var s={};return this.table.options.groupBy&&this.table.modExists("groupRows")?this.table.modules.groupRows.getGroups(!0).forEach(u=>{s[u.getKey()]=this.getGroupResults(u)}):s={top:this.topRow?this.topRow.getData():{},bottom:this.botRow?this.botRow.getData():{}},s}getGroupResults(s){var l=s._getSelf(),u=s.getSubGroups(),g={};return u.forEach(w=>{g[w.getKey()]=this.getGroupResults(w)}),{top:l.calcs.top?l.calcs.top.getData():{},bottom:l.calcs.bottom?l.calcs.bottom.getData():{},groups:g}}}return v.moduleName="columnCalcs",v.calculations=md,v})(),Qh=(()=>{class v extends vr{constructor(s){super(s),this.indent=10,this.field="",this.collapseEl=null,this.expandEl=null,this.branchEl=null,this.elementField=!1,this.startOpen=function(){},this.displayIndex=0,this.registerTableOption("dataTree",!1),this.registerTableOption("dataTreeFilter",!0),this.registerTableOption("dataTreeSort",!0),this.registerTableOption("dataTreeElementColumn",!1),this.registerTableOption("dataTreeBranchElement",!0),this.registerTableOption("dataTreeChildIndent",9),this.registerTableOption("dataTreeChildField","_children"),this.registerTableOption("dataTreeCollapseElement",!1),this.registerTableOption("dataTreeExpandElement",!1),this.registerTableOption("dataTreeStartExpanded",!1),this.registerTableOption("dataTreeChildColumnCalcs",!1),this.registerTableOption("dataTreeSelectPropagate",!1),this.registerComponentFunction("row","treeCollapse",this.collapseRow.bind(this)),this.registerComponentFunction("row","treeExpand",this.expandRow.bind(this)),this.registerComponentFunction("row","treeToggle",this.toggleRow.bind(this)),this.registerComponentFunction("row","getTreeParent",this.getTreeParent.bind(this)),this.registerComponentFunction("row","getTreeChildren",this.getRowChildren.bind(this)),this.registerComponentFunction("row","addTreeChild",this.addTreeChildRow.bind(this))}initialize(){if(this.table.options.dataTree){var s=null,l=this.table.columnManager.getFirstVisibileColumn(),u=this.table.options;switch(this.field=u.dataTreeChildField,this.indent=u.dataTreeChildIndent,this.elementField=u.dataTreeElementColumn||!!l&&l.field,u.dataTreeBranchElement&&(!0===u.dataTreeBranchElement?(this.branchEl=document.createElement("div"),this.branchEl.classList.add("tabulator-data-tree-branch")):"string"==typeof u.dataTreeBranchElement?((s=document.createElement("div")).innerHTML=u.dataTreeBranchElement,this.branchEl=s.firstChild):this.branchEl=u.dataTreeBranchElement),u.dataTreeCollapseElement?"string"==typeof u.dataTreeCollapseElement?((s=document.createElement("div")).innerHTML=u.dataTreeCollapseElement,this.collapseEl=s.firstChild):this.collapseEl=u.dataTreeCollapseElement:(this.collapseEl=document.createElement("div"),this.collapseEl.classList.add("tabulator-data-tree-control"),this.collapseEl.tabIndex=0,this.collapseEl.innerHTML="<div class='tabulator-data-tree-control-collapse'></div>"),u.dataTreeExpandElement?"string"==typeof u.dataTreeExpandElement?((s=document.createElement("div")).innerHTML=u.dataTreeExpandElement,this.expandEl=s.firstChild):this.expandEl=u.dataTreeExpandElement:(this.expandEl=document.createElement("div"),this.expandEl.classList.add("tabulator-data-tree-control"),this.expandEl.tabIndex=0,this.expandEl.innerHTML="<div class='tabulator-data-tree-control-expand'></div>"),typeof u.dataTreeStartExpanded){case"boolean":this.startOpen=function(g,b){return u.dataTreeStartExpanded};break;case"function":this.startOpen=u.dataTreeStartExpanded;break;default:this.startOpen=function(g,b){return u.dataTreeStartExpanded[b]}}this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout-after",this.layoutRow.bind(this)),this.subscribe("row-relayout",this.layoutRow.bind(this)),this.subscribe("row-deleted",this.rowDelete.bind(this),0),this.subscribe("row-data-changed",this.rowDataChanged.bind(this),10),this.subscribe("column-moving-rows",this.columnMoving.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),30)}}getRowChildren(s){return this.getTreeChildren(s,!0)}columnMoving(){var s=[];return this.table.rowManager.rows.forEach(l=>{s=s.concat(this.getTreeChildren(l,!1,!0))}),s}rowDataChanged(s,l,u){this.redrawNeeded(u)&&(this.initializeRow(s),l&&(this.layoutRow(s),this.refreshData(!0)))}initializeRow(s){var l=s.getData()[this.field],u=Array.isArray(l),g=u||!u&&"object"==typeof l&&null!==l;!g&&s.modules.dataTree&&s.modules.dataTree.branchEl&&s.modules.dataTree.branchEl.parentNode.removeChild(s.modules.dataTree.branchEl),!g&&s.modules.dataTree&&s.modules.dataTree.controlEl&&s.modules.dataTree.controlEl.parentNode.removeChild(s.modules.dataTree.controlEl),s.modules.dataTree={index:s.modules.dataTree?s.modules.dataTree.index:0,open:!!g&&(s.modules.dataTree?s.modules.dataTree.open:this.startOpen(s.getComponent(),0)),controlEl:!(!s.modules.dataTree||!g)&&s.modules.dataTree.controlEl,branchEl:!(!s.modules.dataTree||!g)&&s.modules.dataTree.branchEl,parent:!!s.modules.dataTree&&s.modules.dataTree.parent,children:g}}reinitializeRowChildren(s){this.getTreeChildren(s,!1,!0).forEach(function(u){u.reinitialize(!0)})}layoutRow(s){var u=(this.elementField?s.getCell(this.elementField):s.getCells()[0]).getElement(),g=s.modules.dataTree;g.branchEl&&(g.branchEl.parentNode&&g.branchEl.parentNode.removeChild(g.branchEl),g.branchEl=!1),g.controlEl&&(g.controlEl.parentNode&&g.controlEl.parentNode.removeChild(g.controlEl),g.controlEl=!1),this.generateControlElement(s,u),s.getElement().classList.add("tabulator-tree-level-"+g.index),g.index&&(this.branchEl?(g.branchEl=this.branchEl.cloneNode(!0),u.insertBefore(g.branchEl,u.firstChild),this.table.rtl?g.branchEl.style.marginRight=(g.branchEl.offsetWidth+g.branchEl.style.marginLeft)*(g.index-1)+g.index*this.indent+"px":g.branchEl.style.marginLeft=(g.branchEl.offsetWidth+g.branchEl.style.marginRight)*(g.index-1)+g.index*this.indent+"px"):this.table.rtl?u.style.paddingRight=parseInt(window.getComputedStyle(u,null).getPropertyValue("padding-right"))+g.index*this.indent+"px":u.style.paddingLeft=parseInt(window.getComputedStyle(u,null).getPropertyValue("padding-left"))+g.index*this.indent+"px")}generateControlElement(s,g){var u=s.modules.dataTree,b=(g=g||s.getCells()[0].getElement(),u.controlEl);!1!==u.children&&(u.open?(u.controlEl=this.collapseEl.cloneNode(!0),u.controlEl.addEventListener("click",w=>{w.stopPropagation(),this.collapseRow(s)})):(u.controlEl=this.expandEl.cloneNode(!0),u.controlEl.addEventListener("click",w=>{w.stopPropagation(),this.expandRow(s)})),u.controlEl.addEventListener("mousedown",w=>{w.stopPropagation()}),b&&b.parentNode===g?b.parentNode.replaceChild(u.controlEl,b):g.insertBefore(u.controlEl,g.firstChild))}setDisplayIndex(s){this.displayIndex=s}getDisplayIndex(){return this.displayIndex}getRows(s){var l=[];return s.forEach((u,g)=>{var b;l.push(u),u instanceof Gr&&(u.create(),!(b=u.modules.dataTree.children).index&&!1!==b.children&&this.getChildren(u).forEach(k=>{k.create(),l.push(k)}))}),l}getChildren(s,l){var u=s.modules.dataTree,g=[],b=[];return!1!==u.children&&(u.open||l)&&(Array.isArray(u.children)||(u.children=this.generateChildren(s)),g=this.table.modExists("filter")&&this.table.options.dataTreeFilter?this.table.modules.filter.filter(u.children):u.children,this.table.modExists("sort")&&this.table.options.dataTreeSort&&this.table.modules.sort.sort(g),g.forEach(w=>{b.push(w),this.getChildren(w).forEach(H=>{b.push(H)})})),b}generateChildren(s){var l=[],u=s.getData()[this.field];return Array.isArray(u)||(u=[u]),u.forEach(g=>{var b=new Gr(g||{},this.table.rowManager);b.create(),b.modules.dataTree.index=s.modules.dataTree.index+1,b.modules.dataTree.parent=s,b.modules.dataTree.children&&(b.modules.dataTree.open=this.startOpen(b.getComponent(),b.modules.dataTree.index)),l.push(b)}),l}expandRow(s,l){var u=s.modules.dataTree;!1!==u.children&&(u.open=!0,s.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowExpanded",s.getComponent(),s.modules.dataTree.index))}collapseRow(s){var l=s.modules.dataTree;!1!==l.children&&(l.open=!1,s.reinitialize(),this.refreshData(!0),this.dispatchExternal("dataTreeRowCollapsed",s.getComponent(),s.modules.dataTree.index))}toggleRow(s){var l=s.modules.dataTree;!1!==l.children&&(l.open?this.collapseRow(s):this.expandRow(s))}getTreeParent(s){return!!s.modules.dataTree.parent&&s.modules.dataTree.parent.getComponent()}getFilteredTreeChildren(s){var l=s.modules.dataTree,u=[];return l.children&&(Array.isArray(l.children)||(l.children=this.generateChildren(s)),(this.table.modExists("filter")&&this.table.options.dataTreeFilter?this.table.modules.filter.filter(l.children):l.children).forEach(b=>{b instanceof Gr&&u.push(b)})),u}rowDelete(s){var u,l=s.modules.dataTree.parent;l&&(!1!==(u=this.findChildIndex(s,l))&&l.data[this.field].splice(u,1),l.data[this.field].length||delete l.data[this.field],this.initializeRow(l),this.layoutRow(l)),this.refreshData(!0)}addTreeChildRow(s,l,u,g){var b=!1;"string"==typeof l&&(l=JSON.parse(l)),Array.isArray(s.data[this.field])||(s.data[this.field]=[],s.modules.dataTree.open=this.startOpen(s.getComponent(),s.modules.dataTree.index)),void 0!==g&&!1!==(b=this.findChildIndex(g,s))&&s.data[this.field].splice(u?b:b+1,0,l),!1===b&&(u?s.data[this.field].unshift(l):s.data[this.field].push(l)),this.initializeRow(s),this.layoutRow(s),this.refreshData(!0)}findChildIndex(s,l){var u=!1;return"object"==typeof s?s instanceof Gr?u=s.data:s instanceof RowComponent?u=s._getSelf().data:"undefined"!=typeof HTMLElement&&s instanceof HTMLElement&&l.modules.dataTree&&(u=l.modules.dataTree.children.find(g=>g instanceof Gr&&g.element===s))&&(u=u.data):u=null!=s&&l.data[this.field].find(g=>g.data[this.table.options.index]==s),u&&(Array.isArray(l.data[this.field])&&(u=l.data[this.field].indexOf(u)),-1==u&&(u=!1)),u}getTreeChildren(s,l,u){var g=s.modules.dataTree,b=[];return g.children&&(Array.isArray(g.children)||(g.children=this.generateChildren(s)),g.children.forEach(w=>{w instanceof Gr&&(b.push(l?w.getComponent():w),u&&(b=b.concat(this.getTreeChildren(w,l,u))))})),b}checkForRestyle(s){s.row.cells.indexOf(s)||this.layoutRow(s.row)}getChildField(){return this.field}redrawNeeded(s){return!!this.field&&void 0!==s[this.field]||!!this.elementField&&void 0!==s[this.elementField]}}return v.moduleName="dataTree",v})();var Ad={csv:function vd(v,c,s){var l=c&&c.delimiter?c.delimiter:",",u=[],g=[];v.forEach(b=>{var w=[];switch(b.type){case"group":console.warn("Download Warning - CSV downloader cannot process row groups");break;case"calc":console.warn("Download Warning - CSV downloader cannot process column calculations");break;case"header":b.columns.forEach((k,H)=>{k&&1===k.depth&&(g[H]=null==k.value?"":'"'+String(k.value).split('"').join('""')+'"')});break;case"row":b.columns.forEach(k=>{if(k){switch(typeof k.value){case"object":k.value=JSON.stringify(k.value);break;case"undefined":case"null":k.value=""}w.push('"'+String(k.value).split('"').join('""')+'"')}}),u.push(w.join(l))}}),g.length&&u.unshift(g.join(l)),u=u.join("\n"),c.bom&&(u="\ufeff"+u),s(u,"text/csv")},json:function qh(v,c,s){var l=[];v.forEach(u=>{var g={};switch(u.type){case"header":break;case"group":console.warn("Download Warning - JSON downloader cannot process row groups");break;case"calc":console.warn("Download Warning - JSON downloader cannot process column calculations");break;case"row":u.columns.forEach(b=>{b&&(g[b.component.getField()]=b.value)}),l.push(g)}}),s(l=JSON.stringify(l,null,"\t"),"application/json")},pdf:function Lh(v,c,s){var l=[],u=[],g={},b=c.rowGroupStyles||{fontStyle:"bold",fontSize:12,cellPadding:6,fillColor:220},w=c.rowCalcStyles||{fontStyle:"bold",fontSize:10,cellPadding:4,fillColor:232},k=c.jsPDF||{},H=c&&c.title?c.title:"";function Z(Pt,qt){var be=[];return Pt.columns.forEach(Le=>{var Ge;if(Le){switch(typeof Le.value){case"object":Le.value=JSON.stringify(Le.value);break;case"undefined":case"null":Le.value=""}Ge={content:Le.value,colSpan:Le.width,rowSpan:Le.height},qt&&(Ge.styles=qt),be.push(Ge)}else be.push("")}),be}k.orientation||(k.orientation=c.orientation||"landscape"),k.unit||(k.unit="pt"),v.forEach(Pt=>{switch(Pt.type){case"header":l.push(Z(Pt));break;case"group":u.push(Z(Pt,b));break;case"calc":u.push(Z(Pt,w));break;case"row":u.push(Z(Pt))}});var ht=new jspdf.jsPDF(k);c&&c.autoTable&&(g="function"==typeof c.autoTable?c.autoTable(ht)||{}:c.autoTable),H&&(g.didDrawPage=function(Pt){ht.text(H,40,30)}),g.head=l,g.body=u,ht.autoTable(g),c&&c.documentProcessing&&c.documentProcessing(ht),s(ht.output("arraybuffer"),"application/pdf")},xlsx:function jp(v,c,s){var u=c.sheetName||"Sheet1",g=XLSX.utils.book_new(),b=new tu(this);function k(){var ht=[],Pt=[],qt={},be={s:{c:0,r:0},e:{c:v[0]?v[0].columns.reduce((Le,Ge)=>Le+(Ge&&Ge.width?Ge.width:1),0):0,r:v.length}};return v.forEach((Le,Ge)=>{var Xe=[];Le.columns.forEach(function(Ei,an){Ei?(Xe.push(Ei.value instanceof Date||"object"!=typeof Ei.value?Ei.value:JSON.stringify(Ei.value)),(Ei.width>1||Ei.height>-1)&&Pt.push({s:{r:Ge,c:an},e:{r:Ge+Ei.height-1,c:an+Ei.width-1}})):Xe.push("")}),ht.push(Xe)}),XLSX.utils.sheet_add_aoa(qt,ht),qt["!ref"]=XLSX.utils.encode_range(be),Pt.length&&(qt["!merges"]=Pt),qt}if(g.SheetNames=[],g.Sheets={},c.sheetOnly)s(k());else{if(c.sheets)for(var H in c.sheets)!0===c.sheets[H]?(g.SheetNames.push(H),g.Sheets[H]=k()):(g.SheetNames.push(H),b.commsSend(c.sheets[H],"download","intercept",{type:"xlsx",options:{sheetOnly:!0},active:this.active,intercept:function(ht){g.Sheets[H]=ht}}));else g.SheetNames.push(u),g.Sheets[u]=k();c.documentProcessing&&(g=c.documentProcessing(g)),s(function Z(ht){for(var Pt=new ArrayBuffer(ht.length),qt=new Uint8Array(Pt),be=0;be!=ht.length;++be)qt[be]=255&ht.charCodeAt(be);return Pt}(XLSX.write(g,{bookType:"xlsx",bookSST:!0,type:"binary"})),"application/octet-stream")}},html:function Nu(v,c,s){this.modExists("export",!0)&&s(this.modules.export.genereateHTMLTable(v),"text/html")}};let kd=(()=>{class v extends vr{constructor(s){super(s),this.registerTableOption("downloadReady",function(l,u){return u}),this.registerTableOption("downloadConfig",{}),this.registerTableOption("downloadRowRange","active"),this.registerColumnOption("download"),this.registerColumnOption("titleDownload")}initialize(){this.registerTableFunction("download",this.download.bind(this)),this.registerTableFunction("downloadToTab",this.downloadToTab.bind(this))}downloadToTab(s,l,u,g){this.download(s,l,u,g,!0)}download(s,l,u,g,b){var w=!1;if("function"==typeof s?w=s:v.downloaders[s]?w=v.downloaders[s]:console.warn("Download Error - No such download type found: ",s),w){var H=this.generateExportList(g);w.call(this.table,H,u||{},function k(Z,ht){b?!0===b?this.triggerDownload(Z,ht,s,l,!0):b(Z):this.triggerDownload(Z,ht,s,l)}.bind(this))}}generateExportList(s){var l=this.table.modules.export.generateExportList(this.table.options.downloadConfig,!1,s||this.table.options.downloadRowRange,"download"),u=this.table.options.groupHeaderDownload;return u&&!Array.isArray(u)&&(u=[u]),l.forEach(g=>{var b;"group"===g.type&&(b=g.columns[0],u&&u[g.indent]&&(b.value=u[g.indent](b.value,g.component._group.getRowCount(),g.component._group.getData(),g.component)))}),l}triggerDownload(s,l,u,H,b){var w=document.createElement("a"),k=new Blob([s],{type:l});H=H||"Tabulator."+("function"==typeof u?"txt":u),(k=this.table.options.downloadReady(s,k))&&(b?window.open(window.URL.createObjectURL(k)):navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(k,H):(w.setAttribute("href",window.URL.createObjectURL(k)),w.setAttribute("download",H),w.style.display="none",document.body.appendChild(w),w.click(),document.body.removeChild(w)),this.dispatchExternal("downloadComplete"))}commsReceived(s,l,u){"intercept"===l&&this.download(u.type,"",u.options,u.active,u.intercept)}}return v.moduleName="download",v.downloaders=Ad,v})();function _h(v,c){var s=c.mask,l=void 0!==c.maskLetterChar?c.maskLetterChar:"A",u=void 0!==c.maskNumberChar?c.maskNumberChar:"9",g=void 0!==c.maskWildcardChar?c.maskWildcardChar:"*";function b(w){var k=s[w];void 0!==k&&k!==g&&k!==l&&k!==u&&(v.value=v.value+""+k,b(w+1))}v.addEventListener("keydown",w=>{var k=v.value.length,H=w.key;if(w.keyCode>46){if(k>=s.length)return w.preventDefault(),w.stopPropagation(),!1;switch(s[k]){case l:if(H.toUpperCase()==H.toLowerCase())return w.preventDefault(),w.stopPropagation(),!1;break;case u:if(isNaN(H))return w.preventDefault(),w.stopPropagation(),!1;break;case g:break;default:if(H!==s[k])return w.preventDefault(),w.stopPropagation(),!1}}}),v.addEventListener("keyup",w=>{w.keyCode>46&&c.maskAutoFill&&b(v.value.length)}),v.placeholder||(v.placeholder=s),c.maskAutoFill&&b(v.value.length)}var Bh={input:function cp(v,c,s,l,u){var g=v.getValue(),b=document.createElement("input");if(b.setAttribute("type",u.search?"search":"text"),b.style.padding="4px",b.style.width="100%",b.style.boxSizing="border-box",u.elementAttributes&&"object"==typeof u.elementAttributes)for(let k in u.elementAttributes)"+"==k.charAt(0)?(k=k.slice(1),b.setAttribute(k,b.getAttribute(k)+u.elementAttributes["+"+k])):b.setAttribute(k,u.elementAttributes[k]);function w(k){null==g&&""!==b.value||b.value!==g?s(b.value)&&(g=b.value):l()}return b.value=void 0!==g?g:"",c(function(){b.focus({preventScroll:!0}),b.style.height="100%"}),b.addEventListener("change",w),b.addEventListener("blur",w),b.addEventListener("keydown",function(k){switch(k.keyCode){case 13:w();break;case 27:l();break;case 35:case 36:k.stopPropagation()}}),u.mask&&_h(b,u),b},textarea:function xd(v,c,s,l,u){var g=v.getValue(),b=u.verticalNavigation||"hybrid",w=String(null!=g?g:""),H=(w.match(/(?:\r\n|\r|\n)/g),document.createElement("textarea")),Z=0;if(H.style.display="block",H.style.padding="2px",H.style.height="100%",H.style.width="100%",H.style.boxSizing="border-box",H.style.whiteSpace="pre-wrap",H.style.resize="none",u.elementAttributes&&"object"==typeof u.elementAttributes)for(let Pt in u.elementAttributes)"+"==Pt.charAt(0)?(Pt=Pt.slice(1),H.setAttribute(Pt,H.getAttribute(Pt)+u.elementAttributes["+"+Pt])):H.setAttribute(Pt,u.elementAttributes[Pt]);function ht(Pt){null==g&&""!==H.value||H.value!==g?(s(H.value)&&(g=H.value),setTimeout(function(){v.getRow().normalizeHeight()},300)):l()}return H.value=w,c(function(){H.focus({preventScroll:!0}),H.style.height="100%",H.style.height=H.scrollHeight+"px",v.getRow().normalizeHeight()}),H.addEventListener("change",ht),H.addEventListener("blur",ht),H.addEventListener("keyup",function(){H.style.height="";var Pt=H.scrollHeight;H.style.height=Pt+"px",Pt!=Z&&(Z=Pt,v.getRow().normalizeHeight())}),H.addEventListener("keydown",function(Pt){switch(Pt.keyCode){case 27:l();break;case 38:("editor"==b||"hybrid"==b&&H.selectionStart)&&(Pt.stopImmediatePropagation(),Pt.stopPropagation());break;case 40:("editor"==b||"hybrid"==b&&H.selectionStart!==H.value.length)&&(Pt.stopImmediatePropagation(),Pt.stopPropagation());break;case 35:case 36:Pt.stopPropagation()}}),u.mask&&_h(H,u),H},number:function yd(v,c,s,l,u){var g=v.getValue(),b=u.verticalNavigation||"editor",w=document.createElement("input");if(w.setAttribute("type","number"),void 0!==u.max&&w.setAttribute("max",u.max),void 0!==u.min&&w.setAttribute("min",u.min),void 0!==u.step&&w.setAttribute("step",u.step),w.style.padding="4px",w.style.width="100%",w.style.boxSizing="border-box",u.elementAttributes&&"object"==typeof u.elementAttributes)for(let Z in u.elementAttributes)"+"==Z.charAt(0)?(Z=Z.slice(1),w.setAttribute(Z,w.getAttribute(Z)+u.elementAttributes["+"+Z])):w.setAttribute(Z,u.elementAttributes[Z]);w.value=g;var k=function(Z){H()};function H(){var Z=w.value;!isNaN(Z)&&""!==Z&&(Z=Number(Z)),Z!==g?s(Z)&&(g=Z):l()}return c(function(){w.removeEventListener("blur",k),w.focus({preventScroll:!0}),w.style.height="100%",w.addEventListener("blur",k)}),w.addEventListener("keydown",function(Z){switch(Z.keyCode){case 13:H();break;case 27:l();break;case 38:case 40:"editor"==b&&(Z.stopImmediatePropagation(),Z.stopPropagation());break;case 35:case 36:Z.stopPropagation()}}),u.mask&&_h(w,u),w},range:function up(v,c,s,l,u){var g=v.getValue(),b=document.createElement("input");if(b.setAttribute("type","range"),void 0!==u.max&&b.setAttribute("max",u.max),void 0!==u.min&&b.setAttribute("min",u.min),void 0!==u.step&&b.setAttribute("step",u.step),b.style.padding="4px",b.style.width="100%",b.style.boxSizing="border-box",u.elementAttributes&&"object"==typeof u.elementAttributes)for(let k in u.elementAttributes)"+"==k.charAt(0)?(k=k.slice(1),b.setAttribute(k,b.getAttribute(k)+u.elementAttributes["+"+k])):b.setAttribute(k,u.elementAttributes[k]);function w(){var k=b.value;!isNaN(k)&&""!==k&&(k=Number(k)),k!=g?s(k)&&(g=k):l()}return b.value=g,c(function(){b.focus({preventScroll:!0}),b.style.height="100%"}),b.addEventListener("blur",function(k){w()}),b.addEventListener("keydown",function(k){switch(k.keyCode){case 13:w();break;case 27:l()}}),b},select:function Nh(v,c,s,l,u){var g=this,b=v.getElement(),w=v.getValue(),k=u.verticalNavigation||"editor",H=void 0!==w||null===w?Array.isArray(w)?w:[w]:void 0!==u.defaultValue?u.defaultValue:[],Z=document.createElement("input"),ht=document.createElement("div"),Pt=u.multiselect,qt=[],be={},Le=[],Ge=[],Xe=!0,Ei=!1,an="",Hi=null;function Wi(Zi){var el,Qn={},Pr=g.table.getData();return(el=Zi?g.table.columnManager.getColumnByField(Zi):v.getColumn()._getSelf())?Pr.forEach(function($u){var yh=el.getFieldValue($u);null!=yh&&""!==yh&&(Qn[yh]=!0)}):console.warn("unable to find matching column to create select lookup list:",Zi),Object.keys(Qn)}function An(Zi,Qn){!Pt&&be&&be.element&&be.element.classList.remove("active"),be&&be.element&&be.element.classList.remove("focused"),be=Zi,Zi.element&&(Zi.element.classList.add("focused"),Qn&&Zi.element.classList.add("active")),Zi&&Zi.element&&Zi.element.scrollIntoView&&Zi.element.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}function Bn(Zi){-1==Ge.indexOf(Zi)&&(Ge.push(Zi),An(Zi,!0)),_n()}function Cn(Zi){var Qn=Ge[Zi];Zi>-1&&(Ge.splice(Zi,1),Qn.element&&Qn.element.classList.remove("active"))}function Qi(Zi){Zi||(Zi=be);var Qn=Ge.indexOf(Zi);Qn>-1?Cn(Qn):(!0!==Pt&&Ge.length>=Pt&&Cn(0),Bn(Zi)),_n()}function Vn(Zi){Yn(),Zi||(Zi=be),Zi&&(Z.value=Zi.label,s(Zi.value)),H=[Zi.value]}function mo(Zi){Zi||Yn();var Qn=[];Ge.forEach(Pr=>{Qn.push(Pr.value)}),H=Qn,s(Qn)}function _n(){var Zi=[];Ge.forEach(Qn=>{Zi.push(Qn.label)}),Z.value=Zi.join(", "),!1===g.currentCell&&mo(!0)}function Pi(){Yn(),l()}function Yn(){ht.parentNode&&ht.parentNode.removeChild(ht),function ro(){g.table.rowManager.element.removeEventListener("scroll",Pi)}()}if((Array.isArray(u)||!Array.isArray(u)&&"object"==typeof u&&!u.values)&&(console.warn("DEPRECATION WARNING - values for the select editor must now be passed into the values property of the editorParams object, not as the editorParams object"),u={values:u}),Z.setAttribute("type","text"),Z.style.padding="4px",Z.style.width="100%",Z.style.boxSizing="border-box",Z.style.cursor="default",Z.readOnly=0!=this.currentCell,u.elementAttributes&&"object"==typeof u.elementAttributes)for(let Zi in u.elementAttributes)"+"==Zi.charAt(0)?(Zi=Zi.slice(1),Z.setAttribute(Zi,Z.getAttribute(Zi)+u.elementAttributes["+"+Zi])):Z.setAttribute(Zi,u.elementAttributes[Zi]);return Z.value=void 0!==w||null===w?w:"",Z.addEventListener("search",function(Zi){Z.value||(function bn(){var Zi=Ge.length;for(let Qn=0;Qn<Zi;Qn++)Cn(0)}(),mo())}),Z.addEventListener("keydown",function(Zi){var Qn;switch(Zi.keyCode){case 38:Qn=qt.indexOf(be),("editor"==k||"hybrid"==k&&Qn)&&(Zi.stopImmediatePropagation(),Zi.stopPropagation(),Zi.preventDefault(),Qn>0&&An(qt[Qn-1],!Pt));break;case 40:Qn=qt.indexOf(be),("editor"==k||"hybrid"==k&&Qn<qt.length-1)&&(Zi.stopImmediatePropagation(),Zi.stopPropagation(),Zi.preventDefault(),Qn<qt.length-1&&An(-1==Qn?qt[0]:qt[Qn+1],!Pt));break;case 37:case 39:Zi.stopImmediatePropagation(),Zi.stopPropagation(),Zi.preventDefault();break;case 13:Pt?Qi():Vn();break;case 27:Pi();break;case 9:break;default:!1===g.currentCell&&Zi.preventDefault(),Zi.keyCode>=38&&Zi.keyCode<=90&&function zs(Zi){clearTimeout(Hi);var Qn=String.fromCharCode(event.keyCode).toLowerCase();an+=Qn.toLowerCase();var Pr=qt.find(el=>void 0!==el.label&&el.label.toLowerCase().startsWith(an));Pr&&An(Pr,!Pt),Hi=setTimeout(()=>{an=""},800)}()}}),Z.addEventListener("blur",function(Zi){Xe&&(Pt?mo():Pi())}),Z.addEventListener("focus",function(Zi){Ei||function nn(){if(Ge=[],!ht.parentNode){!function yn(Zi,Qn){var Pr=[],el=[];function $u(da){return Qn.indexOf((da={label:da.label,value:da.value,itemParams:da.itemParams,elementAttributes:da.elementAttributes,element:!1}).value)>-1&&Bn(da),Pr.push(da),el.push(da),da}if("function"==typeof Zi&&(Zi=Zi(v)),Array.isArray(Zi))Zi.forEach(function($l){var da;"object"==typeof $l?$l.options?(el.push(da={label:$l.label,group:!0,itemParams:$l.itemParams,elementAttributes:$l.elementAttributes,element:!1}),$l.options.forEach(function(bf){$u(bf)})):$u($l):(Qn.indexOf((da={label:$l,value:$l,element:!1}).value)>-1&&Bn(da),Pr.push(da),el.push(da))});else for(var yh in Zi){var Wd={label:Zi[yh],value:yh,element:!1};Qn.indexOf(Wd.value)>-1&&Bn(Wd),Pr.push(Wd),el.push(Wd)}u.sortValuesList&&(Pr.sort(($l,da)=>$l.label<da.label?-1:$l.label>da.label?1:0),el.sort(($l,da)=>$l.label<da.label?-1:$l.label>da.label?1:0),"asc"!==u.sortValuesList&&(Pr.reverse(),el.reverse())),qt=Pr,Le=el,function fn(){for(;ht.firstChild;)ht.removeChild(ht.firstChild);Le.forEach(function(Zi){var Qn=Zi.element;if(!Qn){if(Qn=document.createElement("div"),Zi.label=u.listItemFormatter?u.listItemFormatter(Zi.value,Zi.label,v,Qn,Zi.itemParams):Zi.label,Zi.group?(Qn.classList.add("tabulator-edit-select-list-group"),Qn.tabIndex=0,Qn.innerHTML=""===Zi.label?"&nbsp;":Zi.label):(Qn.classList.add("tabulator-edit-select-list-item"),Qn.tabIndex=0,Qn.innerHTML=""===Zi.label?"&nbsp;":Zi.label,Qn.addEventListener("click",function(){Ei=!0,setTimeout(()=>{Ei=!1},10),Pt?(Qi(Zi),Z.focus()):Vn(Zi)}),Ge.indexOf(Zi)>-1&&Qn.classList.add("active")),Zi.elementAttributes&&"object"==typeof Zi.elementAttributes)for(let Pr in Zi.elementAttributes)"+"==Pr.charAt(0)?(Pr=Pr.slice(1),Qn.setAttribute(Pr,Z.getAttribute(Pr)+Zi.elementAttributes["+"+Pr])):Qn.setAttribute(Pr,Zi.elementAttributes[Pr]);Qn.addEventListener("mousedown",function(){Xe=!1,setTimeout(function(){Xe=!0},10)}),Zi.element=Qn}ht.appendChild(Qn)})}()}(!0===u.values?Wi():"string"==typeof u.values?Wi(u.values):u.values||[],H);var Zi=Ws.elOffset(b);ht.style.minWidth=b.offsetWidth+"px",ht.style.top=Zi.top+b.offsetHeight+"px",ht.style.left=Zi.left+"px",ht.addEventListener("mousedown",function(Qn){Xe=!1,setTimeout(function(){Xe=!0},10)}),document.body.appendChild(ht)}}()}),(ht=document.createElement("div")).classList.add("tabulator-edit-select-list"),c(function(){Z.style.height="100%",Z.focus({preventScroll:!0})}),setTimeout(()=>{this.table.rowManager.element.addEventListener("scroll",Pi)},10),Z},autocomplete:function Ph(v,c,s,l,u){var g=this,b=v.getElement(),w=v.getValue(),k=u.verticalNavigation||"editor",H=void 0!==w||null===w?w:void 0!==u.defaultValue?u.defaultValue:"",Z=document.createElement("input"),ht=document.createElement("div"),Pt=[],qt=!1,be=!0,Le=!1;if(Z.setAttribute("type","search"),Z.style.padding="4px",Z.style.width="100%",Z.style.boxSizing="border-box",u.elementAttributes&&"object"==typeof u.elementAttributes)for(let _n in u.elementAttributes)"+"==_n.charAt(0)?(_n=_n.slice(1),Z.setAttribute(_n,Z.getAttribute(_n)+u.elementAttributes["+"+_n])):Z.setAttribute(_n,u.elementAttributes[_n]);function Ge(){!0===u.values?Le=Xe():"string"==typeof u.values&&(Le=Xe(u.values))}function Xe(_n){var nn,bn={},Pi=g.table.getData();return(nn=_n?g.table.columnManager.getColumnByField(_n):v.getColumn()._getSelf())?(Pi.forEach(function(Yn){var ro=nn.getFieldValue(Yn);null!=ro&&""!==ro&&(bn[ro]=!0)}),bn=u.sortValuesList?"asc"==u.sortValuesList?Object.keys(bn).sort():Object.keys(bn).sort().reverse():Object.keys(bn)):console.warn("unable to find matching column to create autocomplete lookup list:",_n),bn}function Ei(_n,bn){var nn,Yn,Pi=[];nn=Le||u.values||[],u.searchFunc?(Pi=u.searchFunc(_n,nn))instanceof Promise?(an(void 0!==u.searchingPlaceholder?u.searchingPlaceholder:"Searching..."),Pi.then(ro=>{yn(Hi(ro),bn)}).catch(ro=>{console.err("error in autocomplete search promise:",ro)})):yn(Hi(Pi),bn):(Yn=Hi(nn),""===_n?u.showListOnEmpty&&(Pi=Yn):Yn.forEach(function(ro){(null!==ro.value||void 0!==ro.value)&&(String(ro.value).toLowerCase().indexOf(String(_n).toLowerCase())>-1||String(ro.title).toLowerCase().indexOf(String(_n).toLowerCase())>-1)&&Pi.push(ro)}),yn(Pi,bn))}function an(_n){var bn=document.createElement("div");Wi(),!1!==_n&&(bn.classList.add("tabulator-edit-select-list-notice"),bn.tabIndex=0,_n instanceof Node?bn.appendChild(_n):bn.innerHTML=_n,ht.appendChild(bn))}function Hi(_n){var bn=[];if(Array.isArray(_n))_n.forEach(function(Yn){var ro={};"object"==typeof Yn?(ro.title=u.listItemFormatter?u.listItemFormatter(Yn.value,Yn.label):Yn.label,ro.value=Yn.value):(ro.title=u.listItemFormatter?u.listItemFormatter(Yn,Yn):Yn,ro.value=Yn),bn.push(ro)});else for(var Pi in _n){var nn={title:u.listItemFormatter?u.listItemFormatter(Pi,_n[Pi]):_n[Pi],value:Pi};bn.push(nn)}return bn}function Wi(){for(;ht.firstChild;)ht.removeChild(ht.firstChild)}function yn(_n,bn){_n.length?function fn(_n,bn){var Pi=!1;Wi(),(Pt=_n).forEach(function(nn){var Yn=nn.element;Yn||((Yn=document.createElement("div")).classList.add("tabulator-edit-select-list-item"),Yn.tabIndex=0,Yn.innerHTML=nn.title,Yn.addEventListener("click",function(ro){Cn(nn),An()}),Yn.addEventListener("mousedown",function(ro){be=!1,setTimeout(function(){be=!0},10)}),nn.element=Yn,bn&&nn.value==w&&(Z.value=nn.title,nn.element.classList.add("active"),Pi=!0),nn===qt&&(nn.element.classList.add("active"),Pi=!0)),ht.appendChild(Yn)}),Pi||Cn(!1)}(_n,bn):u.emptyPlaceholder&&an(u.emptyPlaceholder)}function An(){Qi(),qt?w!==qt.value?(w=qt.value,Z.value=qt.title,s(qt.value)):l():u.freetext||u.allowEmpty&&""===Z.value?(w=Z.value,s(Z.value)):l()}function Cn(_n,bn){qt&&qt.element&&qt.element.classList.remove("active"),qt=_n,_n&&_n.element&&_n.element.classList.add("active"),_n&&_n.element&&_n.element.scrollIntoView&&_n.element.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}function Qi(){ht.parentNode&&ht.parentNode.removeChild(ht),function mo(){g.table.rowManager.element.removeEventListener("scroll",Vn)}()}function Vn(){Qi(),l()}return ht.classList.add("tabulator-edit-select-list"),ht.addEventListener("mousedown",function(_n){be=!1,setTimeout(function(){be=!0},10)}),Z.addEventListener("keydown",function(_n){var bn;switch(_n.keyCode){case 38:bn=Pt.indexOf(qt),("editor"==k||"hybrid"==k&&bn)&&(_n.stopImmediatePropagation(),_n.stopPropagation(),_n.preventDefault(),Cn(bn>0&&Pt[bn-1]));break;case 40:bn=Pt.indexOf(qt),("editor"==k||"hybrid"==k&&bn<Pt.length-1)&&(_n.stopImmediatePropagation(),_n.stopPropagation(),_n.preventDefault(),bn<Pt.length-1&&Cn(-1==bn?Pt[0]:Pt[bn+1]));break;case 37:case 39:_n.stopImmediatePropagation(),_n.stopPropagation();break;case 13:An();break;case 27:Vn();break;case 36:case 35:_n.stopImmediatePropagation()}}),Z.addEventListener("keyup",function(_n){switch(_n.keyCode){case 38:case 37:case 39:case 40:case 13:case 27:break;default:Ei(Z.value)}}),Z.addEventListener("search",function(_n){Ei(Z.value)}),Z.addEventListener("blur",function(_n){be&&An()}),Z.addEventListener("focus",function(_n){var bn=H;Ge(),function Bn(){if(!ht.parentNode){for(;ht.firstChild;)ht.removeChild(ht.firstChild);var _n=Ws.elOffset(b);ht.style.minWidth=b.offsetWidth+"px",ht.style.top=_n.top+b.offsetHeight+"px",ht.style.left=_n.left+"px",document.body.appendChild(ht)}}(),Z.value=bn,Ei(bn,!0)}),c(function(){Z.style.height="100%",Z.focus({preventScroll:!0})}),u.mask&&_h(Z,u),setTimeout(()=>{this.table.rowManager.element.addEventListener("scroll",Vn)},10),Ge(),Z.value=H,Ei(H,!0),Z},star:function Td(v,c,s,l,u){var g=this,b=v.getElement(),w=v.getValue(),k=b.getElementsByTagName("svg").length||5,H=b.getElementsByTagName("svg")[0]?b.getElementsByTagName("svg")[0].getAttribute("width"):14,Z=[],ht=document.createElement("div"),Pt=document.createElementNS("http://www.w3.org/2000/svg","svg");function qt(Xe){Z.forEach(function(Ei,an){an<Xe?("ie"==g.table.browser?Ei.setAttribute("class","tabulator-star-active"):Ei.classList.replace("tabulator-star-inactive","tabulator-star-active"),Ei.innerHTML='<polygon fill="#488CE9" stroke="#014AAE" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>'):("ie"==g.table.browser?Ei.setAttribute("class","tabulator-star-inactive"):Ei.classList.replace("tabulator-star-active","tabulator-star-inactive"),Ei.innerHTML='<polygon fill="#010155" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>')})}function be(Xe){var Ei=document.createElement("span"),an=Pt.cloneNode(!0);Z.push(an),Ei.addEventListener("mouseenter",function(Hi){Hi.stopPropagation(),Hi.stopImmediatePropagation(),qt(Xe)}),Ei.addEventListener("mousemove",function(Hi){Hi.stopPropagation(),Hi.stopImmediatePropagation()}),Ei.addEventListener("click",function(Hi){Hi.stopPropagation(),Hi.stopImmediatePropagation(),s(Xe),b.blur()}),Ei.appendChild(an),ht.appendChild(Ei)}function Le(Xe){w=Xe,qt(Xe)}if(b.style.whiteSpace="nowrap",b.style.overflow="hidden",b.style.textOverflow="ellipsis",ht.style.verticalAlign="middle",ht.style.display="inline-block",ht.style.padding="4px",Pt.setAttribute("width",H),Pt.setAttribute("height",H),Pt.setAttribute("viewBox","0 0 512 512"),Pt.setAttribute("xml:space","preserve"),Pt.style.padding="0 1px",u.elementAttributes&&"object"==typeof u.elementAttributes)for(let Xe in u.elementAttributes)"+"==Xe.charAt(0)?(Xe=Xe.slice(1),ht.setAttribute(Xe,ht.getAttribute(Xe)+u.elementAttributes["+"+Xe])):ht.setAttribute(Xe,u.elementAttributes[Xe]);for(var Ge=1;Ge<=k;Ge++)be(Ge);return qt(w=Math.min(parseInt(w),k)),ht.addEventListener("mousemove",function(Xe){qt(0)}),ht.addEventListener("click",function(Xe){s(0)}),b.addEventListener("blur",function(Xe){l()}),b.addEventListener("keydown",function(Xe){switch(Xe.keyCode){case 39:Le(w+1);break;case 37:Le(w-1);break;case 13:s(w);break;case 27:l()}}),ht},progress:function Fh(v,c,s,l,u){var Le,Ge,Pt,qt,g=v.getElement(),b=void 0===u.max?(null==(Le=g.getElementsByTagName("div")[0])?void 0:Le.getAttribute("max"))||100:u.max,w=void 0===u.min?(null==(Ge=g.getElementsByTagName("div")[0])?void 0:Ge.getAttribute("min"))||0:u.min,k=(b-w)/100,H=v.getValue()||0,Z=document.createElement("div"),ht=document.createElement("div");function be(){var Xe=window.getComputedStyle(g,null),Ei=k*Math.round(ht.offsetWidth/((g.clientWidth-parseInt(Xe.getPropertyValue("padding-left"))-parseInt(Xe.getPropertyValue("padding-right")))/100))+w;s(Ei),g.setAttribute("aria-valuenow",Ei),g.setAttribute("aria-label",H)}if(Z.style.position="absolute",Z.style.right="0",Z.style.top="0",Z.style.bottom="0",Z.style.width="5px",Z.classList.add("tabulator-progress-handle"),ht.style.display="inline-block",ht.style.position="relative",ht.style.height="100%",ht.style.backgroundColor="#488CE9",ht.style.maxWidth="100%",ht.style.minWidth="0%",u.elementAttributes&&"object"==typeof u.elementAttributes)for(let Xe in u.elementAttributes)"+"==Xe.charAt(0)?(Xe=Xe.slice(1),ht.setAttribute(Xe,ht.getAttribute(Xe)+u.elementAttributes["+"+Xe])):ht.setAttribute(Xe,u.elementAttributes[Xe]);return g.style.padding="4px 4px",H=Math.min(parseFloat(H),b),H=Math.max(parseFloat(H),w),H=Math.round((H-w)/k),ht.style.width=H+"%",g.setAttribute("aria-valuemin",w),g.setAttribute("aria-valuemax",b),ht.appendChild(Z),Z.addEventListener("mousedown",function(Xe){Pt=Xe.screenX,qt=ht.offsetWidth}),Z.addEventListener("mouseover",function(){Z.style.cursor="ew-resize"}),g.addEventListener("mousemove",function(Xe){Pt&&(ht.style.width=qt+Xe.screenX-Pt+"px")}),g.addEventListener("mouseup",function(Xe){Pt&&(Xe.stopPropagation(),Xe.stopImmediatePropagation(),Pt=!1,qt=!1,be())}),g.addEventListener("keydown",function(Xe){switch(Xe.keyCode){case 39:Xe.preventDefault(),ht.style.width=ht.clientWidth+g.clientWidth/100+"px";break;case 37:Xe.preventDefault(),ht.style.width=ht.clientWidth-g.clientWidth/100+"px";break;case 9:case 13:be();break;case 27:l()}}),g.addEventListener("blur",function(){l()}),ht},tickCross:function td(v,c,s,l,u){var g=v.getValue(),b=document.createElement("input"),w=u.tristate,k=void 0===u.indeterminateValue?null:u.indeterminateValue,H=!1;if(b.setAttribute("type","checkbox"),b.style.marginTop="5px",b.style.boxSizing="border-box",u.elementAttributes&&"object"==typeof u.elementAttributes)for(let ht in u.elementAttributes)"+"==ht.charAt(0)?(ht=ht.slice(1),b.setAttribute(ht,b.getAttribute(ht)+u.elementAttributes["+"+ht])):b.setAttribute(ht,u.elementAttributes[ht]);function Z(ht){return w?ht?H?k:b.checked:b.checked&&!H?(b.checked=!1,b.indeterminate=!0,H=!0,k):(H=!1,b.checked):b.checked}return b.value=g,w&&(void 0===g||g===k||""===g)&&(H=!0,b.indeterminate=!0),"firefox"!=this.table.browser&&c(function(){b.focus({preventScroll:!0})}),b.checked=!0===g||"true"===g||"True"===g||1===g,c(function(){b.focus()}),b.addEventListener("change",function(ht){s(Z())}),b.addEventListener("blur",function(ht){s(Z(!0))}),b.addEventListener("keydown",function(ht){13==ht.keyCode&&s(Z()),27==ht.keyCode&&l()}),b}};let hp=(()=>{class v extends vr{constructor(s){super(s),this.currentCell=!1,this.mouseClick=!1,this.recursionBlock=!1,this.invalidEdit=!1,this.editedCells=[],this.editors=v.editors,this.registerColumnOption("editable"),this.registerColumnOption("editor"),this.registerColumnOption("editorParams"),this.registerColumnOption("cellEditing"),this.registerColumnOption("cellEdited"),this.registerColumnOption("cellEditCancelled"),this.registerTableFunction("getEditedCells",this.getEditedCells.bind(this)),this.registerTableFunction("clearCellEdited",this.clearCellEdited.bind(this)),this.registerTableFunction("navigatePrev",this.navigatePrev.bind(this)),this.registerTableFunction("navigateNext",this.navigateNext.bind(this)),this.registerTableFunction("navigateLeft",this.navigateLeft.bind(this)),this.registerTableFunction("navigateRight",this.navigateRight.bind(this)),this.registerTableFunction("navigateUp",this.navigateUp.bind(this)),this.registerTableFunction("navigateDown",this.navigateDown.bind(this)),this.registerComponentFunction("cell","isEdited",this.cellisEdited.bind(this)),this.registerComponentFunction("cell","clearEdited",this.clearEdited.bind(this)),this.registerComponentFunction("cell","edit",this.editCell.bind(this)),this.registerComponentFunction("cell","cancelEdit",this.cellCancelEdit.bind(this)),this.registerComponentFunction("cell","navigatePrev",this.navigatePrev.bind(this)),this.registerComponentFunction("cell","navigateNext",this.navigateNext.bind(this)),this.registerComponentFunction("cell","navigateLeft",this.navigateLeft.bind(this)),this.registerComponentFunction("cell","navigateRight",this.navigateRight.bind(this)),this.registerComponentFunction("cell","navigateUp",this.navigateUp.bind(this)),this.registerComponentFunction("cell","navigateDown",this.navigateDown.bind(this))}initialize(){this.subscribe("cell-init",this.bindEditor.bind(this)),this.subscribe("cell-delete",this.clearEdited.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this)),this.subscribe("column-delete",this.columnDeleteCheck.bind(this)),this.subscribe("row-deleting",this.rowDeleteCheck.bind(this)),this.subscribe("data-refeshing",this.cancelEdit.bind(this)),this.subscribe("keybinding-nav-prev",this.navigatePrev.bind(this)),this.subscribe("keybinding-nav-next",this.keybindingNavigateNext.bind(this)),this.subscribe("keybinding-nav-left",this.navigateLeft.bind(this)),this.subscribe("keybinding-nav-right",this.navigateRight.bind(this)),this.subscribe("keybinding-nav-up",this.navigateUp.bind(this)),this.subscribe("keybinding-nav-down",this.navigateDown.bind(this))}keybindingNavigateNext(s){var l=this.currentCell,u=this.options("tabEndNewRow");l&&(this.navigateNext(s)||u&&(l.getElement().firstChild.blur(),(u=this.table.addRow(!0===u?{}:"function"==typeof u?u(l.row.getComponent()):Object.assign({},u))).then(()=>{setTimeout(()=>{nav.next()})})))}cellisEdited(s){return!!s.modules.edit&&s.modules.edit.edited}cellCancelEdit(s){s===this.currentCell?this.table.modules.edit.cancelEdit():console.warn("Cancel Editor Error - This cell is not currently being edited ")}clearCellEdited(s){s||(s=this.modules.edit.getEditedCells()),Array.isArray(s)||(s=[s]),s.forEach(l=>{this.modules.edit.clearEdited(l._getSelf())})}navigatePrev(s){var u,g,l=this.currentCell;if(l){if(s&&s.preventDefault(),u=this.navigateLeft())return!0;if((g=this.table.rowManager.prevDisplayRow(l.row,!0))&&(u=this.findNextEditableCell(g,g.cells.length)))return u.getComponent().edit(),!0}return!1}navigateNext(s){var u,g,l=this.currentCell;if(l){if(s&&s.preventDefault(),u=this.navigateRight())return!0;if((g=this.table.rowManager.nextDisplayRow(l.row,!0))&&(u=this.findNextEditableCell(g,-1)))return u.getComponent().edit(),!0}return!1}navigateLeft(s){var u,g,l=this.currentCell;return!(!l||(s&&s.preventDefault(),u=l.getIndex(),g=this.findPrevEditableCell(l.row,u),!g)||(g.getComponent().edit(),0))}navigateRight(s){var u,g,l=this.currentCell;return!(!l||(s&&s.preventDefault(),u=l.getIndex(),g=this.findNextEditableCell(l.row,u),!g)||(g.getComponent().edit(),0))}navigateUp(s){var u,g,l=this.currentCell;return!(!l||(s&&s.preventDefault(),u=l.getIndex(),g=this.table.rowManager.prevDisplayRow(l.row,!0),!g)||(g.cells[u].getComponent().edit(),0))}navigateDown(s){var u,g,l=this.currentCell;return!(!l||(s&&s.preventDefault(),u=l.getIndex(),g=this.table.rowManager.nextDisplayRow(l.row,!0),!g)||(g.cells[u].getComponent().edit(),0))}findNextEditableCell(s,l){var u=!1;if(l<s.cells.length-1)for(var g=l+1;g<s.cells.length;g++){let b=s.cells[g];if(b.column.modules.edit&&Ws.elVisible(b.getElement())){let w=!0;if("function"==typeof b.column.modules.edit.check&&(w=b.column.modules.edit.check(b.getComponent())),w){u=b;break}}}return u}findPrevEditableCell(s,l){var u=!1;if(l>0)for(var g=l-1;g>=0;g--){let b=s.cells[g],w=!0;if(b.column.modules.edit&&Ws.elVisible(b.getElement())&&("function"==typeof b.column.modules.edit.check&&(w=b.column.modules.edit.check(b.getComponent())),w)){u=b;break}}return u}initializeColumnCheck(s){void 0!==s.definition.editor&&this.initializeColumn(s)}columnDeleteCheck(s){this.currentCell&&this.currentCell.column===s&&this.cancelEdit()}rowDeleteCheck(s){this.currentCell&&this.currentCell.row===s&&this.cancelEdit()}initializeColumn(s){var l={editor:!1,blocked:!1,check:s.definition.editable,params:s.definition.editorParams||{}};switch(typeof s.definition.editor){case"string":this.editors[s.definition.editor]?l.editor=this.editors[s.definition.editor]:console.warn("Editor Error - No such editor found: ",s.definition.editor);break;case"function":l.editor=s.definition.editor;break;case"boolean":!0===s.definition.editor&&("function"!=typeof s.definition.formatter?l.editor=this.editors[s.definition.formatter]?this.editors[s.definition.formatter]:this.editors.input:console.warn("Editor Error - Cannot auto lookup editor for a custom formatter: ",s.definition.formatter))}l.editor&&(s.modules.edit=l)}getCurrentCell(){return!!this.currentCell&&this.currentCell.getComponent()}clearEditor(s){var u,l=this.currentCell;if(this.invalidEdit=!1,l){for(this.currentCell=!1,u=l.getElement(),s?l.validate&&l.validate():u.classList.remove("tabulator-validation-fail"),u.classList.remove("tabulator-editing");u.firstChild;)u.removeChild(u.firstChild);l.row.getElement().classList.remove("tabulator-row-editing")}}cancelEdit(){if(this.currentCell){var s=this.currentCell,l=this.currentCell.getComponent();this.clearEditor(!0),s.setValueActual(s.getValue()),s.cellRendered(),("textarea"==s.column.definition.editor||s.column.definition.variableHeight)&&s.row.normalizeHeight(!0),s.column.definition.cellEditCancelled&&s.column.definition.cellEditCancelled.call(this.table,l),this.dispatchExternal("cellEditCancelled",l)}}bindEditor(s){if(s.column.modules.edit){var l=this,u=s.getElement(!0);u.setAttribute("tabindex",0),u.addEventListener("click",function(g){u.classList.contains("tabulator-editing")||u.focus({preventScroll:!0})}),u.addEventListener("mousedown",function(g){2===g.button?g.preventDefault():l.mouseClick=!0}),u.addEventListener("focus",function(g){l.recursionBlock||l.edit(s,g,!1)})}}focusCellNoEvent(s,l){this.recursionBlock=!0,l&&"ie"===this.table.browser||s.getElement().focus({preventScroll:!0}),this.recursionBlock=!1}editCell(s,l){this.focusCellNoEvent(s),this.edit(s,!1,l)}focusScrollAdjust(s){if("virtual"==this.table.rowManager.getRenderMode()){var l=this.table.rowManager.element.scrollTop,u=this.table.rowManager.element.clientHeight+this.table.rowManager.element.scrollTop,g=s.row.getElement();g.offsetTop<l?this.table.rowManager.element.scrollTop-=l-g.offsetTop:g.offsetTop+g.offsetHeight>u&&(this.table.rowManager.element.scrollTop+=g.offsetTop+g.offsetHeight-u);var b=this.table.rowManager.element.scrollLeft,w=this.table.rowManager.element.clientWidth+this.table.rowManager.element.scrollLeft,k=s.getElement();this.table.modExists("frozenColumns")&&(b+=parseInt(this.table.modules.frozenColumns.leftMargin),w-=parseInt(this.table.modules.frozenColumns.rightMargin)),"virtual"===this.table.options.renderHorizontal&&(b-=parseInt(this.table.columnManager.renderer.vDomPadLeft),w-=parseInt(this.table.columnManager.renderer.vDomPadLeft)),k.offsetLeft<b?this.table.rowManager.element.scrollLeft-=b-k.offsetLeft:k.offsetLeft+k.offsetWidth>w&&(this.table.rowManager.element.scrollLeft+=k.offsetLeft+k.offsetWidth-w)}}edit(s,l,u){var H,Z,ht,g=this,b=!0,w=function(){},k=s.getElement();if(!this.currentCell){if(s.column.modules.edit.blocked)return this.mouseClick=!1,k.blur(),!1;switch(l&&l.stopPropagation(),typeof s.column.modules.edit.check){case"function":b=s.column.modules.edit.check(s.getComponent());break;case"boolean":b=s.column.modules.edit.check}if(b||u){if(g.cancelEdit(),g.currentCell=s,this.focusScrollAdjust(s),Z=s.getComponent(),this.mouseClick&&(this.mouseClick=!1,s.column.definition.cellClick&&s.column.definition.cellClick.call(this.table,l,Z)),s.column.definition.cellEditing&&s.column.definition.cellEditing.call(this.table,Z),this.dispatchExternal("cellEditing",Z),ht="function"==typeof s.column.modules.edit.params?s.column.modules.edit.params(Z):s.column.modules.edit.params,!1===(H=s.column.modules.edit.editor.call(g,Z,function be(Xe){w=Xe},function Pt(Xe){if(g.currentCell===s){var Ei=!0;return s.column.modules.validate&&g.table.modExists("validate")&&"manual"!=g.table.options.validationMode&&(Ei=g.table.modules.validate.validate(s.column.modules.validate,s,Xe)),!0===Ei||"highlight"===g.table.options.validationMode?(g.clearEditor(),s.modules.edit||(s.modules.edit={}),s.modules.edit.edited=!0,-1==g.editedCells.indexOf(s)&&g.editedCells.push(s),s.setValue(Xe,!0),g.table.options.dataTree&&g.table.modExists("dataTree")&&g.table.modules.dataTree.checkForRestyle(s),!0===Ei||(k.classList.add("tabulator-validation-fail"),g.table.externalEvents.dispatch("validationFailed",s.getComponent(),Xe,Ei),!1)):(g.invalidEdit=!0,k.classList.add("tabulator-validation-fail"),g.focusCellNoEvent(s,!0),w(),g.table.externalEvents.dispatch("validationFailed",s.getComponent(),Xe,Ei),!1)}},function qt(){g.currentCell===s&&(g.cancelEdit(),g.table.options.dataTree&&g.table.modExists("dataTree")&&g.table.modules.dataTree.checkForRestyle(s))},ht)))return k.blur(),!1;if(!(H instanceof Node))return console.warn("Edit Error - Editor should return an instance of Node, the editor returned:",H),k.blur(),!1;for(k.classList.add("tabulator-editing"),s.row.getElement().classList.add("tabulator-row-editing");k.firstChild;)k.removeChild(k.firstChild);k.appendChild(H),w();for(var Le=k.children,Ge=0;Ge<Le.length;Ge++)Le[Ge].addEventListener("click",function(Xe){Xe.stopPropagation()});return!0}return this.mouseClick=!1,k.blur(),!1}this.invalidEdit||this.cancelEdit()}getEditedCells(){var s=[];return this.editedCells.forEach(l=>{s.push(l.getComponent())}),s}clearEdited(s){var l;s.modules.edit&&s.modules.edit.edited&&(s.modules.edit.edited=!1,s.modules.validate&&(s.modules.validate.invalid=!1)),(l=this.editedCells.indexOf(s))>-1&&this.editedCells.splice(l,1)}}return v.moduleName="edit",v.editors=Bh,v})();class bd{constructor(c,s,l,u){this.type=c,this.columns=s,this.component=l||!1,this.indent=u||0}}class ed{constructor(c,s,l,u,g){this.value=c,this.component=s||!1,this.width=l,this.height=u,this.depth=g}}let Ed=(()=>{class v extends vr{constructor(s){super(s),this.config={},this.cloneTableStyle=!0,this.colVisProp="",this.registerTableOption("htmlOutputConfig",!1),this.registerColumnOption("htmlOutput"),this.registerColumnOption("titleHtmlOutput")}initialize(){this.registerTableFunction("getHtml",this.getHtml.bind(this))}generateExportList(s,l,u,g){this.cloneTableStyle=l,this.config=s||{},this.colVisProp=g;var b=!1!==this.config.columnHeaders?this.headersToExportRows(this.generateColumnGroupHeaders()):[],w=this.bodyToExportRows(this.rowLookup(u));return b.concat(w)}genereateTable(s,l,u,g){var b=this.generateExportList(s,l,u,g);return this.genereateTableElement(b)}rowLookup(s){var l=[];if("function"==typeof s)s.call(this.table).forEach(u=>{(u=this.table.rowManager.findRow(u))&&l.push(u)});else switch(s){case!0:case"visible":l=this.table.rowManager.getVisibleRows(!0);break;case"all":l=this.table.rowManager.rows;break;case"selected":l=this.table.modules.selectRow.selectedRows;break;default:l=this.table.options.pagination?this.table.rowManager.getDisplayRows(this.table.rowManager.displayRows.length-2):this.table.rowManager.getDisplayRows()}return Object.assign([],l)}generateColumnGroupHeaders(){var s=[];return(!1!==this.config.columnGroups?this.table.columnManager.columns:this.table.columnManager.columnsByIndex).forEach(u=>{var g=this.processColumnGroup(u);g&&s.push(g)}),s}processColumnGroup(s){var l=s.columns,u=0,b={title:s.definition["title"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))]||s.definition.title,column:s,depth:1};if(l.length){if(b.subGroups=[],b.width=0,l.forEach(w=>{var k=this.processColumnGroup(w);k&&(b.width+=k.width,b.subGroups.push(k),k.depth>u&&(u=k.depth))}),b.depth+=u,!b.width)return!1}else{if(!this.columnVisCheck(s))return!1;b.width=1}return b}columnVisCheck(s){return!1!==s.definition[this.colVisProp]&&(s.visible||!s.visible&&s.definition[this.colVisProp])}headersToExportRows(s){var l=[],u=0,g=[];function b(w,k){var H=u-k;if(void 0===l[k]&&(l[k]=[]),w.height=w.subGroups?1:H-w.depth+1,l[k].push(w),w.height>1)for(let Z=1;Z<w.height;Z++)void 0===l[k+Z]&&(l[k+Z]=[]),l[k+Z].push(!1);if(w.width>1)for(let Z=1;Z<w.width;Z++)l[k].push(!1);w.subGroups&&w.subGroups.forEach(function(Z){b(Z,k+1)})}return s.forEach(function(w){w.depth>u&&(u=w.depth)}),s.forEach(function(w){b(w,0)}),l.forEach(w=>{var k=[];w.forEach(H=>{k.push(H?new ed(H.title,H.column.getComponent(),H.width,H.height,H.depth):null)}),g.push(new bd("header",k))}),g}bodyToExportRows(s){var l=[],u=[];return this.table.columnManager.columnsByIndex.forEach(g=>{this.columnVisCheck(g)&&l.push(g.getComponent())}),!1!==this.config.columnCalcs&&this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&s.unshift(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&s.push(this.table.modules.columnCalcs.botRow)),(s=s.filter(g=>{switch(g.type){case"group":return!1!==this.config.rowGroups;case"calc":return!1!==this.config.columnCalcs;case"row":return!(this.table.options.dataTree&&!1===this.config.dataTree&&g.modules.dataTree.parent)}return!0})).forEach((g,b)=>{var w=g.getData(this.colVisProp),k=[],H=0;switch(g.type){case"group":H=g.level,k.push(new ed(g.key,g.getComponent(),l.length,1));break;case"calc":case"row":l.forEach(Z=>{k.push(new ed(Z._column.getFieldValue(w),Z,1,1))}),this.table.options.dataTree&&!1!==this.config.dataTree&&(H=g.modules.dataTree.index)}u.push(new bd(g.type,k,g.getComponent(),H))}),u}genereateTableElement(s){var l=document.createElement("table"),u=document.createElement("thead"),g=document.createElement("tbody"),b=this.lookupTableStyles(),w=this.table.options["rowFormatter"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))],k={};return k.rowFormatter=null!==w?w:this.table.options.rowFormatter,this.table.options.dataTree&&!1!==this.config.dataTree&&this.table.modExists("columnCalcs")&&(k.treeElementField=this.table.modules.dataTree.elementField),k.groupHeader=this.table.options["groupHeader"+(this.colVisProp.charAt(0).toUpperCase()+this.colVisProp.slice(1))],k.groupHeader&&!Array.isArray(k.groupHeader)&&(k.groupHeader=[k.groupHeader]),l.classList.add("tabulator-print-table"),this.mapElementStyles(this.table.columnManager.getHeadersElement(),u,["border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),s.length>1e3&&console.warn("It may take a long time to render an HTML table with more than 1000 rows"),s.forEach((H,Z)=>{switch(H.type){case"header":u.appendChild(this.genereateHeaderElement(H,k,b));break;case"group":g.appendChild(this.genereateGroupElement(H,k,b));break;case"calc":g.appendChild(this.genereateCalcElement(H,k,b));break;case"row":let ht=this.genereateRowElement(H,k,b);this.mapElementStyles(Z%2&&b.evenRow?b.evenRow:b.oddRow,ht,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),g.appendChild(ht)}}),u.innerHTML&&l.appendChild(u),l.appendChild(g),this.mapElementStyles(this.table.element,l,["border-top","border-left","border-right","border-bottom"]),l}lookupTableStyles(){var s={};return this.cloneTableStyle&&window.getComputedStyle&&(s.oddRow=this.table.element.querySelector(".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)"),s.evenRow=this.table.element.querySelector(".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)"),s.calcRow=this.table.element.querySelector(".tabulator-row.tabulator-calcs"),s.firstRow=this.table.element.querySelector(".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)"),s.firstGroup=this.table.element.getElementsByClassName("tabulator-group")[0],s.firstRow&&(s.styleCells=s.firstRow.getElementsByClassName("tabulator-cell"),s.firstCell=s.styleCells[0],s.lastCell=s.styleCells[s.styleCells.length-1])),s}genereateHeaderElement(s,l,u){var g=document.createElement("tr");return s.columns.forEach(b=>{if(b){var w=document.createElement("th"),k=b.component._column.definition.cssClass?b.component._column.definition.cssClass.split(" "):[];w.colSpan=b.width,w.rowSpan=b.height,w.innerHTML=b.value,this.cloneTableStyle&&(w.style.boxSizing="border-box"),k.forEach(function(H){w.classList.add(H)}),this.mapElementStyles(b.component.getElement(),w,["text-align","border-top","border-left","border-right","border-bottom","background-color","color","font-weight","font-family","font-size"]),this.mapElementStyles(b.component._column.contentElement,w,["padding-top","padding-left","padding-right","padding-bottom"]),b.component._column.visible?this.mapElementStyles(b.component.getElement(),w,["width"]):b.component._column.definition.width&&(w.style.width=b.component._column.definition.width+"px"),b.component._column.parent&&this.mapElementStyles(b.component._column.parent.groupElement,w,["border-top"]),g.appendChild(w)}}),g}genereateGroupElement(s,l,u){var g=document.createElement("tr"),b=document.createElement("td"),w=s.columns[0];return g.classList.add("tabulator-print-table-row"),w.value=l.groupHeader&&l.groupHeader[s.indent]?l.groupHeader[s.indent](w.value,s.component._group.getRowCount(),s.component._group.getData(),s.component):!1===l.groupHeader?w.value:s.component._group.generator(w.value,s.component._group.getRowCount(),s.component._group.getData(),s.component),b.colSpan=w.width,b.innerHTML=w.value,g.classList.add("tabulator-print-table-group"),g.classList.add("tabulator-group-level-"+s.indent),w.component.isVisible()&&g.classList.add("tabulator-group-visible"),this.mapElementStyles(u.firstGroup,g,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),this.mapElementStyles(u.firstGroup,b,["padding-top","padding-left","padding-right","padding-bottom"]),g.appendChild(b),g}genereateCalcElement(s,l,u){var g=this.genereateRowElement(s,l,u);return g.classList.add("tabulator-print-table-calcs"),this.mapElementStyles(u.calcRow,g,["border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size","background-color"]),g}genereateRowElement(s,l,u){var g=document.createElement("tr");return g.classList.add("tabulator-print-table-row"),s.columns.forEach(b=>{if(b){var w=document.createElement("td"),k=b.component._column,H=b.value,Z={modules:{},getValue:function(){return H},getField:function(){return k.definition.field},getElement:function(){return w},getColumn:function(){return k.getComponent()},getData:function(){return s.component.getData()},getRow:function(){return s.component},getComponent:function(){return Z},column:k};if((k.definition.cssClass?k.definition.cssClass.split(" "):[]).forEach(function(Pt){w.classList.add(Pt)}),this.table.modExists("format")&&!1!==this.config.formatCells)H=this.table.modules.format.formatExportValue(Z,this.colVisProp);else switch(typeof H){case"object":H=JSON.stringify(H);break;case"undefined":case"null":H="";break;default:H=H}H instanceof Node?w.appendChild(H):w.innerHTML=H,u.firstCell&&(this.mapElementStyles(u.firstCell,w,["padding-top","padding-left","padding-right","padding-bottom","border-top","border-left","border-right","border-bottom","color","font-weight","font-family","font-size"]),k.definition.align&&(w.style.textAlign=k.definition.align)),this.table.options.dataTree&&!1!==this.config.dataTree&&(l.treeElementField&&l.treeElementField==k.field||!l.treeElementField&&0==i)&&(s.component._row.modules.dataTree.controlEl&&w.insertBefore(s.component._row.modules.dataTree.controlEl.cloneNode(!0),w.firstChild),s.component._row.modules.dataTree.branchEl&&w.insertBefore(s.component._row.modules.dataTree.branchEl.cloneNode(!0),w.firstChild)),g.appendChild(w),Z.modules.format&&Z.modules.format.renderedCallback&&Z.modules.format.renderedCallback(),l.rowFormatter&&!1!==this.config.formatCells&&l.rowFormatter(s.component)}}),g}genereateHTMLTable(s){var l=document.createElement("div");return l.appendChild(this.genereateTableElement(s)),l.innerHTML}getHtml(s,l,u,g){var b=this.generateExportList(u||this.table.options.htmlOutputConfig,l,s,g||"htmlOutput");return this.genereateHTMLTable(b)}mapElementStyles(s,l,u){if(this.cloneTableStyle&&s&&l){var g={"background-color":"backgroundColor",color:"fontColor",width:"width","font-weight":"fontWeight","font-family":"fontFamily","font-size":"fontSize","text-align":"textAlign","border-top":"borderTop","border-left":"borderLeft","border-right":"borderRight","border-bottom":"borderBottom","padding-top":"paddingTop","padding-left":"paddingLeft","padding-right":"paddingRight","padding-bottom":"paddingBottom"};if(window.getComputedStyle){var b=window.getComputedStyle(s);u.forEach(function(w){l.style[g[w]]=b.getPropertyValue(w)})}}}}return v.moduleName="export",v})();var Ld={"=":function(v,c,s,l){return c==v},"<":function(v,c,s,l){return c<v},"<=":function(v,c,s,l){return c<=v},">":function(v,c,s,l){return c>v},">=":function(v,c,s,l){return c>=v},"!=":function(v,c,s,l){return c!=v},regex:function(v,c,s,l){return"string"==typeof v&&(v=new RegExp(v)),v.test(c)},like:function(v,c,s,l){return null==v?c===v:null!=c&&String(c).toLowerCase().indexOf(v.toLowerCase())>-1},keywords:function(v,c,s,l){var u=v.toLowerCase().split(void 0===l.separator?" ":l.separator),g=String(null==c?"":c).toLowerCase(),b=[];return u.forEach(w=>{g.includes(w)&&b.push(!0)}),l.matchAll?b.length===u.length:!!b.length},starts:function(v,c,s,l){return null==v?c===v:null!=c&&String(c).toLowerCase().startsWith(v.toLowerCase())},ends:function(v,c,s,l){return null==v?c===v:null!=c&&String(c).toLowerCase().endsWith(v.toLowerCase())},in:function(v,c,s,l){return Array.isArray(v)?!v.length||v.indexOf(c)>-1:(console.warn("Filter Error - filter value is not an array:",v),!1)}};let N=(()=>{class v extends vr{constructor(s){super(s),this.filterList=[],this.headerFilters={},this.headerFilterColumns=[],this.prevHeaderFilterChangeCheck="",this.prevHeaderFilterChangeCheck="{}",this.changed=!1,this.tableInitialized=!1,this.registerTableOption("filterMode","local"),this.registerTableOption("initialFilter",!1),this.registerTableOption("initialHeaderFilter",!1),this.registerTableOption("headerFilterLiveFilterDelay",300),this.registerColumnOption("headerFilter"),this.registerColumnOption("headerFilterPlaceholder"),this.registerColumnOption("headerFilterParams"),this.registerColumnOption("headerFilterEmptyCheck"),this.registerColumnOption("headerFilterFunc"),this.registerColumnOption("headerFilterFuncParams"),this.registerColumnOption("headerFilterLiveFilter"),this.registerTableFunction("searchRows",this.searchRows.bind(this)),this.registerTableFunction("searchData",this.searchData.bind(this)),this.registerTableFunction("setFilter",this.userSetFilter.bind(this)),this.registerTableFunction("refreshFilter",this.userRefreshFilter.bind(this)),this.registerTableFunction("addFilter",this.userAddFilter.bind(this)),this.registerTableFunction("getFilters",this.getFilters.bind(this)),this.registerTableFunction("setHeaderFilterFocus",this.userSetHeaderFilterFocus.bind(this)),this.registerTableFunction("getHeaderFilterValue",this.userGetHeaderFilterValue.bind(this)),this.registerTableFunction("setHeaderFilterValue",this.userSetHeaderFilterValue.bind(this)),this.registerTableFunction("getHeaderFilters",this.getHeaderFilters.bind(this)),this.registerTableFunction("removeFilter",this.userRemoveFilter.bind(this)),this.registerTableFunction("clearFilter",this.userClearFilter.bind(this)),this.registerTableFunction("clearHeaderFilter",this.userClearHeaderFilter.bind(this)),this.registerComponentFunction("column","headerFilterFocus",this.setHeaderFilterFocus.bind(this)),this.registerComponentFunction("column","reloadHeaderFilter",this.reloadHeaderFilter.bind(this)),this.registerComponentFunction("column","getHeaderFilterValue",this.getHeaderFilterValue.bind(this)),this.registerComponentFunction("column","setHeaderFilterValue",this.setHeaderFilterValue.bind(this))}initialize(){this.subscribe("column-init",this.initializeColumnHeaderFilter.bind(this)),this.subscribe("column-width-fit-before",this.hideHeaderFilterElements.bind(this)),this.subscribe("column-width-fit-after",this.showHeaderFilterElements.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),"remote"===this.table.options.filterMode&&this.subscribe("data-params",this.remoteFilterParams.bind(this)),this.registerDataHandler(this.filter.bind(this),10)}tableBuilt(){this.table.options.initialFilter&&this.setFilter(this.table.options.initialFilter),this.table.options.initialHeaderFilter&&this.table.options.initialHeaderFilter.forEach(s=>{var l=this.table.columnManager.findColumn(s.field);if(!l)return console.warn("Column Filter Error - No matching column found:",s.field),!1;this.setHeaderFilterValue(l,s.value)}),this.tableInitialized=!0}remoteFilterParams(s,l,u,g){return g.filter=this.getFilters(!0,!0),g}userSetFilter(s,l,u,g){this.setFilter(s,l,u,g),this.refreshFilter()}userRefreshFilter(){this.refreshFilter()}userAddFilter(s,l,u,g){this.addFilter(s,l,u,g),this.refreshFilter()}userSetHeaderFilterFocus(s){var l=this.table.columnManager.findColumn(s);if(!l)return console.warn("Column Filter Focus Error - No matching column found:",s),!1;this.setHeaderFilterFocus(l)}userGetHeaderFilterValue(s){var l=this.table.columnManager.findColumn(s);if(l)return this.getHeaderFilterValue(l);console.warn("Column Filter Error - No matching column found:",s)}userSetHeaderFilterValue(s,l){var u=this.table.columnManager.findColumn(s);if(!u)return console.warn("Column Filter Error - No matching column found:",s),!1;this.setHeaderFilterValue(u,l)}userRemoveFilter(s,l,u){this.removeFilter(s,l,u),this.refreshFilter()}userClearFilter(s){this.clearFilter(s),this.refreshFilter()}userClearHeaderFilter(){this.clearHeaderFilter(),this.refreshFilter()}searchRows(s,l,u){return this.search("rows",s,l,u)}searchData(s,l,u){return this.search("data",s,l,u)}initializeColumnHeaderFilter(s){var l=s.definition;l.headerFilter&&(void 0!==l.headerFilterPlaceholder&&l.field&&this.module("localize").setHeaderFilterColumnPlaceholder(l.field,l.headerFilterPlaceholder),this.initializeColumn(s))}initializeColumn(s,l){var u=this,g=s.getField();s.modules.filter={success:function b(w){var ht,k="input"==s.modules.filter.tagType&&"text"==s.modules.filter.attrType||"textarea"==s.modules.filter.tagType?"partial":"match",H="",Z="";if(void 0===s.modules.filter.prevSuccess||s.modules.filter.prevSuccess!==w){if(s.modules.filter.prevSuccess=w,s.modules.filter.emptyFunc(w))delete u.headerFilters[g];else{switch(s.modules.filter.value=w,typeof s.definition.headerFilterFunc){case"string":v.filters[s.definition.headerFilterFunc]?(H=s.definition.headerFilterFunc,ht=function(Pt){var qt=s.definition.headerFilterFuncParams||{},be=s.getFieldValue(Pt);return qt="function"==typeof qt?qt(w,be,Pt):qt,v.filters[s.definition.headerFilterFunc](w,be,Pt,qt)}):console.warn("Header Filter Error - Matching filter function not found: ",s.definition.headerFilterFunc);break;case"function":H=ht=function(Pt){var qt=s.definition.headerFilterFuncParams||{},be=s.getFieldValue(Pt);return qt="function"==typeof qt?qt(w,be,Pt):qt,s.definition.headerFilterFunc(w,be,Pt,qt)}}ht||("partial"===k?(ht=function(Pt){var qt=s.getFieldValue(Pt);return null!=qt&&String(qt).toLowerCase().indexOf(String(w).toLowerCase())>-1},H="like"):(ht=function(Pt){return s.getFieldValue(Pt)==w},H="=")),u.headerFilters[g]={value:w,func:ht,type:H,params:{}}}Z=JSON.stringify(u.headerFilters),u.prevHeaderFilterChangeCheck!==Z&&(u.prevHeaderFilterChangeCheck=Z,u.trackChanges(),u.refreshFilter())}return!0},attrType:!1,tagType:!1,emptyFunc:!1},this.generateHeaderFilterElement(s)}generateHeaderFilterElement(s,l,u){var k,H,Z,ht,Pt,qt,be,g=this,b=s.modules.filter.success,w=s.getField();if(s.modules.filter.headerElement&&s.modules.filter.headerElement.parentNode&&s.contentElement.removeChild(s.modules.filter.headerElement.parentNode),w){switch(s.modules.filter.emptyFunc=s.definition.headerFilterEmptyCheck||function(Ge){return!Ge&&"0"!==Ge&&0!==Ge},(k=document.createElement("div")).classList.add("tabulator-header-filter"),typeof s.definition.headerFilter){case"string":g.table.modules.edit.editors[s.definition.headerFilter]?(H=g.table.modules.edit.editors[s.definition.headerFilter],("tick"===s.definition.headerFilter||"tickCross"===s.definition.headerFilter)&&!s.definition.headerFilterEmptyCheck&&(s.modules.filter.emptyFunc=function(Ge){return!0!==Ge&&!1!==Ge})):console.warn("Filter Error - Cannot build header filter, No such editor found: ",s.definition.editor);break;case"function":H=s.definition.headerFilter;break;case"boolean":s.modules.edit&&s.modules.edit.editor?H=s.modules.edit.editor:s.definition.formatter&&g.table.modules.edit.editors[s.definition.formatter]?(H=g.table.modules.edit.editors[s.definition.formatter],("tick"===s.definition.formatter||"tickCross"===s.definition.formatter)&&!s.definition.headerFilterEmptyCheck&&(s.modules.filter.emptyFunc=function(Ge){return!0!==Ge&&!1!==Ge})):H=g.table.modules.edit.editors.input}if(H){if(ht={getValue:function(){return void 0!==l?l:""},getField:function(){return s.definition.field},getElement:function(){return k},getColumn:function(){return s.getComponent()},getRow:function(){return{normalizeHeight:function(){}}}},be="function"==typeof(be=s.definition.headerFilterParams||{})?be.call(g.table):be,!(Z=H.call(this.table.modules.edit,ht,function(){},b,function Le(){},be)))return void console.warn("Filter Error - Cannot add filter to "+w+" column, editor returned a value of false");if(!(Z instanceof Node))return void console.warn("Filter Error - Cannot add filter to "+w+" column, editor should return an instance of Node, the editor returned:",Z);w?g.langBind("headerFilters|columns|"+s.definition.field,function(Ge){Z.setAttribute("placeholder",void 0!==Ge&&Ge?Ge:g.langText("headerFilters|default"))}):g.langBind("headerFilters|default",function(Ge){Z.setAttribute("placeholder",Ge)}),Z.addEventListener("click",function(Ge){Ge.stopPropagation(),Z.focus()}),Z.addEventListener("focus",Ge=>{var Xe=this.table.columnManager.element.scrollLeft;Xe!==this.table.rowManager.element.scrollLeft&&(this.table.rowManager.scrollHorizontal(Xe),this.table.columnManager.scrollHorizontal(Xe))}),Pt=!1,qt=function(Ge){Pt&&clearTimeout(Pt),Pt=setTimeout(function(){b(Z.value)},g.table.options.headerFilterLiveFilterDelay)},s.modules.filter.headerElement=Z,s.modules.filter.attrType=Z.hasAttribute("type")?Z.getAttribute("type").toLowerCase():"",s.modules.filter.tagType=Z.tagName.toLowerCase(),!1!==s.definition.headerFilterLiveFilter&&("autocomplete"===s.definition.headerFilter||"tickCross"===s.definition.headerFilter||("autocomplete"===s.definition.editor||"tickCross"===s.definition.editor)&&!0===s.definition.headerFilter||(Z.addEventListener("keyup",qt),Z.addEventListener("search",qt),"number"==s.modules.filter.attrType&&Z.addEventListener("change",function(Ge){b(Z.value)}),"text"==s.modules.filter.attrType&&"ie"!==this.table.browser&&Z.setAttribute("type","search")),("input"==s.modules.filter.tagType||"select"==s.modules.filter.tagType||"textarea"==s.modules.filter.tagType)&&Z.addEventListener("mousedown",function(Ge){Ge.stopPropagation()})),k.appendChild(Z),s.contentElement.appendChild(k),u||g.headerFilterColumns.push(s)}}else console.warn("Filter Error - Cannot add header filter, column has no field set:",s.definition.title)}hideHeaderFilterElements(){this.headerFilterColumns.forEach(function(s){s.modules.filter&&s.modules.filter.headerElement&&(s.modules.filter.headerElement.style.display="none")})}showHeaderFilterElements(){this.headerFilterColumns.forEach(function(s){s.modules.filter&&s.modules.filter.headerElement&&(s.modules.filter.headerElement.style.display="")})}setHeaderFilterFocus(s){s.modules.filter&&s.modules.filter.headerElement?s.modules.filter.headerElement.focus():console.warn("Column Filter Focus Error - No header filter set on column:",s.getField())}getHeaderFilterValue(s){if(s.modules.filter&&s.modules.filter.headerElement)return s.modules.filter.headerElement.value;console.warn("Column Filter Error - No header filter set on column:",s.getField())}setHeaderFilterValue(s,l){s&&(s.modules.filter&&s.modules.filter.headerElement?(this.generateHeaderFilterElement(s,l,!0),s.modules.filter.success(l)):console.warn("Column Filter Error - No header filter set on column:",s.getField()))}reloadHeaderFilter(s){s&&(s.modules.filter&&s.modules.filter.headerElement?this.generateHeaderFilterElement(s,s.modules.filter.value,!0):console.warn("Column Filter Error - No header filter set on column:",s.getField()))}refreshFilter(){this.tableInitialized&&("remote"===this.table.options.filterMode?this.reloadData():this.refreshData())}trackChanges(){this.changed=!0,this.dispatch("filter-changed")}hasChanged(){var s=this.changed;return this.changed=!1,s}setFilter(s,l,u,g){this.filterList=[],Array.isArray(s)||(s=[{field:s,type:l,value:u,params:g}]),this.addFilter(s)}addFilter(s,l,u,g){Array.isArray(s)||(s=[{field:s,type:l,value:u,params:g}]),s.forEach(b=>{(b=this.findFilter(b))&&(this.filterList.push(b),this.changed=!0)})}findFilter(s){var l;if(Array.isArray(s))return this.findSubFilters(s);var u=!1;return"function"==typeof s.field?u=function(g){return s.field(g,s.type||{})}:v.filters[s.type]?u=(l=this.table.columnManager.getColumnByField(s.field))?function(g){return v.filters[s.type](s.value,l.getFieldValue(g),g,s.params||{})}:function(g){return v.filters[s.type](s.value,g[s.field],g,s.params||{})}:console.warn("Filter Error - No such filter type found, ignoring: ",s.type),s.func=u,!!s.func&&s}findSubFilters(s){var l=[];return s.forEach(u=>{(u=this.findFilter(u))&&l.push(u)}),!!l.length&&l}getFilters(s,l){var u=[];return s&&(u=this.getHeaderFilters()),l&&u.forEach(function(g){"function"==typeof g.type&&(g.type="function")}),u.concat(this.filtersToArray(this.filterList,l))}filtersToArray(s,l){var u=[];return s.forEach(g=>{var b;Array.isArray(g)?u.push(this.filtersToArray(g,l)):(b={field:g.field,type:g.type,value:g.value},l&&"function"==typeof b.type&&(b.type="function"),u.push(b))}),u}getHeaderFilters(){var s=[];for(var l in this.headerFilters)s.push({field:l,type:this.headerFilters[l].type,value:this.headerFilters[l].value});return s}removeFilter(s,l,u){Array.isArray(s)||(s=[{field:s,type:l,value:u}]),s.forEach(g=>{var b;(b=this.filterList.findIndex("object"==typeof g.field?w=>g===w:w=>g.field===w.field&&g.type===w.type&&g.value===w.value))>-1?this.filterList.splice(b,1):console.warn("Filter Error - No matching filter type found, ignoring: ",g.type)}),this.trackChanges()}clearFilter(s){this.filterList=[],s&&this.clearHeaderFilter(),this.trackChanges()}clearHeaderFilter(){this.headerFilters={},this.prevHeaderFilterChangeCheck="{}",this.headerFilterColumns.forEach(s=>{void 0!==s.modules.filter.value&&delete s.modules.filter.value,s.modules.filter.prevSuccess=void 0,this.reloadHeaderFilter(s)}),this.trackChanges()}search(s,l,u,g){var b=[],w=[];return Array.isArray(l)||(l=[{field:l,type:u,value:g}]),l.forEach(k=>{(k=this.findFilter(k))&&w.push(k)}),this.table.rowManager.rows.forEach(k=>{var H=!0;w.forEach(Z=>{this.filterRecurse(Z,k.getData())||(H=!1)}),H&&b.push("data"===s?k.getData("data"):k.getComponent())}),b}filter(s,l){var u=[],g=[];return this.subscribedExternal("dataFiltering")&&this.dispatchExternal("dataFiltering",this.getFilters()),"remote"!==this.table.options.filterMode&&(this.filterList.length||Object.keys(this.headerFilters).length)?s.forEach(b=>{this.filterRow(b)&&u.push(b)}):u=s.slice(0),this.subscribedExternal("dataFiltered")&&(u.forEach(b=>{g.push(b.getComponent())}),this.dispatchExternal("dataFiltered",this.getFilters(),g)),u}filterRow(s,l){var u=!0,g=s.getData();for(var b in this.filterList.forEach(w=>{this.filterRecurse(w,g)||(u=!1)}),this.headerFilters)this.headerFilters[b].func(g)||(u=!1);return u}filterRecurse(s,l){var u=!1;return Array.isArray(s)?s.forEach(g=>{this.filterRecurse(g,l)&&(u=!0)}):u=s.func(l),u}}return v.moduleName="filter",v.filters=Ld,v})();var Wf={plaintext:function G(v,c,s){return this.emptyToSpace(this.sanitizeHTML(v.getValue()))},html:function T(v,c,s){return v.getValue()},textarea:function x(v,c,s){return v.getElement().style.whiteSpace="pre-wrap",this.emptyToSpace(this.sanitizeHTML(v.getValue()))},money:function tt(v,c,s){var g,b,w,k,l=parseFloat(v.getValue()),u="",H=c.decimal||".",Z=c.thousand||",",ht=c.negativeSign||"-",Pt=c.symbol||"",qt=!!c.symbolAfter,be=void 0!==c.precision?c.precision:2;if(isNaN(l))return this.emptyToSpace(this.sanitizeHTML(v.getValue()));for(l<0&&(l=Math.abs(l),u=ht),g=!1!==be?l.toFixed(be):l,b=(g=String(g).split("."))[0],w=g.length>1?H+g[1]:"",k=/(\d+)(\d{3})/;k.test(b);)b=b.replace(k,"$1"+Z+"$2");return qt?u+b+w+Pt:u+Pt+b+w},link:function Nt(v,c,s){var l=v.getValue(),u=c.urlPrefix||"",g=c.download,b=l,w=document.createElement("a");if(c.labelField&&(b=v.getData()[c.labelField]),c.label)switch(typeof c.label){case"string":b=c.label;break;case"function":b=c.label(v)}if(b){if(c.urlField&&(l=v.getData()[c.urlField]),c.url)switch(typeof c.url){case"string":l=c.url;break;case"function":l=c.url(v)}return w.setAttribute("href",u+l),c.target&&w.setAttribute("target",c.target),c.download&&(g="function"==typeof g?g(v):!0===g?"":g,w.setAttribute("download",g)),w.innerHTML=this.emptyToSpace(this.sanitizeHTML(b)),w}return"&nbsp;"},image:function Ke(v,c,s){var l=document.createElement("img"),u=v.getValue();switch(c.urlPrefix&&(u=c.urlPrefix+v.getValue()),c.urlSuffix&&(u+=c.urlSuffix),l.setAttribute("src",u),typeof c.height){case"number":l.style.height=c.height+"px";break;case"string":l.style.height=c.height}switch(typeof c.width){case"number":l.style.width=c.width+"px";break;case"string":l.style.width=c.width}return l.addEventListener("load",function(){v.getRow().normalizeHeight()}),l},tickCross:function wi(v,c,s){var l=v.getValue(),u=v.getElement(),g=c.allowEmpty,w=void 0!==c.tickElement?c.tickElement:'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>',k=void 0!==c.crossElement?c.crossElement:'<svg enable-background="new 0 0 24 24" height="14" width="14"  viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>';return c.allowTruthy&&l||!0===l||"true"===l||"True"===l||1===l||"1"===l?(u.setAttribute("aria-checked",!0),w||""):!g||"null"!==l&&""!==l&&null!=l?(u.setAttribute("aria-checked",!1),k||""):(u.setAttribute("aria-checked","mixed"),"")},datetime:function qi(v,c,s){var l=window.DateTime||luxon.DateTime,u=c.inputFormat||"yyyy-MM-dd HH:mm:ss",g=c.outputFormat||"dd/MM/yyyy HH:mm:ss",b=void 0!==c.invalidPlaceholder?c.invalidPlaceholder:"",w=v.getValue();if(void 0!==l){var k=(window.DateTime||luxon.DateTime).fromFormat(w,u);return k.isValid?(c.timezone&&(k=k.shiftTimezone(c.timezone)),k.toFormat(g)):!0===b?w:"function"==typeof b?b(w):b}console.error("Format Error - 'datetime' formatter is dependant on luxon.js")},datetimediff:function Fn(v,c,s){var l=window.DateTime||luxon.DateTime,u=c.inputFormat||"yyyy-MM-dd HH:mm:ss",g=void 0!==c.invalidPlaceholder?c.invalidPlaceholder:"",b=void 0!==c.suffix&&c.suffix,w=void 0!==c.unit?c.unit:"days",k=void 0!==c.humanize&&c.humanize,H=void 0!==c.date?c.date:l.now(),Z=v.getValue();if(void 0!==l){var ht=l.fromFormat(Z,u);if(!ht.isValid)return!0===g?Z:"function"==typeof g?g(Z):g;if(!k)return parseInt(ht.diff(H,w)[w])+(b?" "+b:"")}else console.error("Format Error - 'datetimediff' formatter is dependant on luxon.js")},lookup:function dn(v,c,s){var l=v.getValue();return void 0===c[l]?(console.warn("Missing display value for "+l),l):c[l]},star:function _o(v,c,s){var l=v.getValue(),u=v.getElement(),g=c&&c.stars?c.stars:5,b=document.createElement("span"),w=document.createElementNS("http://www.w3.org/2000/svg","svg");b.style.verticalAlign="middle",w.setAttribute("width","14"),w.setAttribute("height","14"),w.setAttribute("viewBox","0 0 512 512"),w.setAttribute("xml:space","preserve"),w.style.padding="0 1px",l=l&&!isNaN(l)?parseInt(l):0,l=Math.max(0,Math.min(l,g));for(var Z=1;Z<=g;Z++){var ht=w.cloneNode(!0);ht.innerHTML=Z<=l?'<polygon fill="#FFEA00" stroke="#C1AB60" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>':'<polygon fill="#D2D2D2" stroke="#686868" stroke-width="37.6152" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" points="259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 "/>',b.appendChild(ht)}return u.style.whiteSpace="nowrap",u.style.overflow="hidden",u.style.textOverflow="ellipsis",u.setAttribute("aria-label",l),b},traffic:function or(v,c,s){var Z,l=this.sanitizeHTML(v.getValue())||0,u=document.createElement("span"),g=c&&c.max?c.max:100,b=c&&c.min?c.min:0,w=c&&void 0!==c.color?c.color:["red","orange","green"],k="#666666";if(!isNaN(l)&&void 0!==v.getValue()){switch(u.classList.add("tabulator-traffic-light"),Z=parseFloat(l)<=g?parseFloat(l):g,Z=parseFloat(Z)>=b?parseFloat(Z):b,Z=Math.round((Z-b)/((g-b)/100)),typeof w){case"string":k=w;break;case"function":k=w(l);break;case"object":if(Array.isArray(w)){var Pt=Math.floor(Z/(100/w.length));Pt=Math.min(Pt,w.length-1),k=w[Pt=Math.max(Pt,0)];break}}return u.style.backgroundColor=k,u}},progress:function yu(v,c,s){var H,Z,ht,Pt,l=this.sanitizeHTML(v.getValue())||0,u=v.getElement(),g=c&&c.max?c.max:100,b=c&&c.min?c.min:0,w=c&&c.legendAlign?c.legendAlign:"center";switch(H=parseFloat(l)<=g?parseFloat(l):g,H=parseFloat(H)>=b?parseFloat(H):b,H=Math.round((H-b)/((g-b)/100)),typeof c.color){case"string":Z=c.color;break;case"function":Z=c.color(l);break;case"object":if(Array.isArray(c.color)){var qt=100/c.color.length,be=Math.floor(H/qt);be=Math.min(be,c.color.length-1),be=Math.max(be,0),Z=c.color[be];break}default:Z="#2DC214"}switch(typeof c.legend){case"string":ht=c.legend;break;case"function":ht=c.legend(l);break;case"boolean":ht=l;break;default:ht=!1}switch(typeof c.legendColor){case"string":Pt=c.legendColor;break;case"function":Pt=c.legendColor(l);break;case"object":Array.isArray(c.legendColor)&&(qt=100/c.legendColor.length,be=Math.floor(H/qt),be=Math.min(be,c.legendColor.length-1),be=Math.max(be,0),Pt=c.legendColor[be]);break;default:Pt="#000"}u.style.minWidth="30px",u.style.position="relative",u.setAttribute("aria-label",H);var Le=document.createElement("div");Le.style.display="inline-block",Le.style.position="absolute",Le.style.width=H+"%",Le.style.backgroundColor=Z,Le.style.height="100%",Le.setAttribute("data-max",g),Le.setAttribute("data-min",b);var Ge=document.createElement("div");if(Ge.style.position="relative",Ge.style.width="100%",Ge.style.height="100%",ht){var Xe=document.createElement("div");Xe.style.position="absolute",Xe.style.top=0,Xe.style.left=0,Xe.style.textAlign=w,Xe.style.width="100%",Xe.style.color=Pt,Xe.innerHTML=ht}return s(function(){if(!(v instanceof Wp)){var Ei=document.createElement("div");Ei.style.position="absolute",Ei.style.top="4px",Ei.style.bottom="4px",Ei.style.left="4px",Ei.style.right="4px",u.appendChild(Ei),u=Ei}u.appendChild(Ge),Ge.appendChild(Le),ht&&Ge.appendChild(Xe)}),""},color:function id(v,c,s){return v.getElement().style.backgroundColor=this.sanitizeHTML(v.getValue()),""},buttonTick:function Ku(v,c,s){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#2DC214" clip-rule="evenodd" d="M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z" fill-rule="evenodd"/></svg>'},buttonCross:function Bl(v,c,s){return'<svg enable-background="new 0 0 24 24" height="14" width="14" viewBox="0 0 24 24" xml:space="preserve" ><path fill="#CE1515" d="M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z"/></svg>'},rownum:function Nd(v,c,s){return this.table.rowManager.activeRows.indexOf(v.getRow()._getSelf())+1},handle:function Yp(v,c,s){return v.getElement().classList.add("tabulator-row-handle"),"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>"},responsiveCollapse:function Hh(v,c,s){var l=document.createElement("div"),u=v.getRow()._row.modules.responsiveLayout;function g(b){var w=u.element;u.open=b,w&&(u.open?(l.classList.add("open"),w.style.display=""):(l.classList.remove("open"),w.style.display="none"))}return l.classList.add("tabulator-responsive-collapse-toggle"),l.innerHTML="<span class='tabulator-responsive-collapse-toggle-open'>+</span><span class='tabulator-responsive-collapse-toggle-close'>-</span>",v.getElement().classList.add("tabulator-row-handle"),l.addEventListener("click",function(b){b.stopImmediatePropagation(),g(!u.open)}),g(u.open),l},rowSelection:function Pd(v,c,s){var l=document.createElement("input");if(l.type="checkbox",this.table.modExists("selectRow",!0))if(l.addEventListener("click",g=>{g.stopPropagation()}),"function"==typeof v.getRow){var u=v.getRow();u instanceof eu?(l.addEventListener("change",g=>{u.toggleSelect()}),l.checked=u.isSelected&&u.isSelected(),this.table.modules.selectRow.registerRowSelectCheckbox(u,l)):l=""}else l.addEventListener("change",g=>{this.table.modules.selectRow.selectedRows.length?this.table.deselectRow():this.table.selectRow(c.rowRange)}),this.table.modules.selectRow.registerHeaderSelectCheckbox(l);return l}};let Xp=(()=>{class v extends vr{constructor(s){super(s),this.registerColumnOption("formatter"),this.registerColumnOption("formatterParams"),this.registerColumnOption("formatterPrint"),this.registerColumnOption("formatterPrintParams"),this.registerColumnOption("formatterClipboard"),this.registerColumnOption("formatterClipboardParams"),this.registerColumnOption("formatterHtmlOutput"),this.registerColumnOption("formatterHtmlOutputParams"),this.registerColumnOption("titleFormatter"),this.registerColumnOption("titleFormatterParams")}initialize(){this.subscribe("cell-format",this.formatValue.bind(this)),this.subscribe("cell-rendered",this.cellRendered.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-format",this.formatHeader.bind(this))}initializeColumn(s){s.modules.format=this.lookupFormatter(s,""),void 0!==s.definition.formatterPrint&&(s.modules.format.print=this.lookupFormatter(s,"Print")),void 0!==s.definition.formatterClipboard&&(s.modules.format.clipboard=this.lookupFormatter(s,"Clipboard")),void 0!==s.definition.formatterHtmlOutput&&(s.modules.format.htmlOutput=this.lookupFormatter(s,"HtmlOutput"))}lookupFormatter(s,l){var u={params:s.definition["formatter"+l+"Params"]||{}},g=s.definition["formatter"+l];switch(typeof g){case"string":v.formatters[g]?u.formatter=v.formatters[g]:(console.warn("Formatter Error - No such formatter found: ",g),u.formatter=v.formatters.plaintext);break;case"function":u.formatter=g;break;default:u.formatter=v.formatters.plaintext}return u}cellRendered(s){s.modules.format&&s.modules.format.renderedCallback&&!s.modules.format.rendered&&(s.modules.format.renderedCallback(),s.modules.format.rendered=!0)}formatHeader(s,l,u){var g,b,w,k;return s.definition.titleFormatter?(g=this.getFormatter(s.definition.titleFormatter),w=H=>{s.titleFormatterRendered=H},k={getValue:function(){return l},getElement:function(){return u}},b="function"==typeof(b=s.definition.titleFormatterParams||{})?b():b,g.call(this,k,b,w)):l}formatValue(s){var l=s.getComponent(),u="function"==typeof s.column.modules.format.params?s.column.modules.format.params(l):s.column.modules.format.params;return s.column.modules.format.formatter.call(this,l,u,function g(b){s.modules.format||(s.modules.format={}),s.modules.format.renderedCallback=b,s.modules.format.rendered=!1})}formatExportValue(s,l){var g,u=s.column.modules.format[l];if(u){let b=function(w){s.modules.format||(s.modules.format={}),s.modules.format.renderedCallback=w,s.modules.format.rendered=!1};return g="function"==typeof u.params?u.params(component):u.params,u.formatter.call(this,s.getComponent(),g,b)}return this.formatValue(s)}sanitizeHTML(s){if(s){var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(s).replace(/[&<>"'`=\/]/g,function(u){return l[u]})}return s}emptyToSpace(s){return null==s||""===s?"&nbsp;":s}getFormatter(l){switch(typeof l){case"string":v.formatters[l]?l=v.formatters[l]:(console.warn("Formatter Error - No such formatter found: ",l),l=v.formatters.plaintext);break;case"function":l=l;break;default:l=v.formatters.plaintext}return l}}return v.moduleName="format",v.formatters=Wf,v})(),zf=(()=>{class v extends vr{constructor(s){super(s),this.leftColumns=[],this.rightColumns=[],this.leftMargin=0,this.rightMargin=0,this.rightPadding=0,this.initializationMode="left",this.active=!1,this.scrollEndTimer=!1,this.registerColumnOption("frozen")}reset(){this.initializationMode="left",this.leftColumns=[],this.rightColumns=[],this.leftMargin=0,this.rightMargin=0,this.rightMargin=0,this.active=!1,this.table.columnManager.headersElement.style.marginLeft=0,this.table.columnManager.element.style.paddingRight=0}initialize(){this.subscribe("cell-layout",this.layoutCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-width",this.layout.bind(this)),this.subscribe("row-layout-before",this.layoutRow.bind(this)),this.subscribe("table-layout",this.layout.bind(this)),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this)),this.subscribe("columns-loading",this.reset.bind(this)),this.subscribe("table-redraw",this.layout.bind(this))}layoutCell(s){this.layoutElement(s.element,s.column)}initializeColumn(s){var l={margin:0,edge:!1};s.isGroup||(this.frozenCheck(s)?(l.position=this.initializationMode,"left"==this.initializationMode?this.leftColumns.push(s):this.rightColumns.unshift(s),this.active=!0,s.modules.frozen=l):this.initializationMode="right")}frozenCheck(s){return s.parent.isGroup&&s.definition.frozen&&console.warn("Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups"),s.parent.isGroup?this.frozenCheck(s.parent):s.definition.frozen}scrollHorizontal(){var s;this.active&&(clearTimeout(this.scrollEndTimer),this.scrollEndTimer=setTimeout(()=>{this.layout()},100),s=this.table.rowManager.getVisibleRows(),this.calcMargins(),this.layoutColumnPosition(),this.layoutCalcRows(),s.forEach(l=>{"row"===l.type&&this.layoutRow(l)}),this.table.rowManager.tableElement.style.marginRight=this.rightMargin)}calcMargins(){this.leftMargin=this._calcSpace(this.leftColumns,this.leftColumns.length)+"px",this.table.columnManager.headersElement.style.marginLeft=this.leftMargin,this.rightMargin=this._calcSpace(this.rightColumns,this.rightColumns.length)+"px",this.table.columnManager.element.style.paddingRight=this.rightMargin,this.rightPadding=this.table.rowManager.element.clientWidth+this.table.columnManager.scrollLeft}layoutCalcRows(){this.table.modExists("columnCalcs")&&(this.table.modules.columnCalcs.topInitialized&&this.table.modules.columnCalcs.topRow&&this.layoutRow(this.table.modules.columnCalcs.topRow),this.table.modules.columnCalcs.botInitialized&&this.table.modules.columnCalcs.botRow&&this.layoutRow(this.table.modules.columnCalcs.botRow),this.table.modExists("groupRows")&&this.layoutGroupCalcs(this.table.modules.groupRows.getGroups()))}layoutGroupCalcs(s){s.forEach(l=>{l.calcs.top&&this.layoutRow(l.calcs.top),l.calcs.bottom&&this.layoutRow(l.calcs.bottom),l.groupList&&l.groupList.length&&this.layoutGroupCalcs(l.groupList&&l.groupList)})}layoutColumnPosition(s){var l=[];this.leftColumns.forEach((u,g)=>{if(u.modules.frozen.margin=this._calcSpace(this.leftColumns,g)+this.table.columnManager.scrollLeft+"px",u.modules.frozen.edge=g==this.leftColumns.length-1,u.parent.isGroup){var b=this.getColGroupParentElement(u);l.includes(b)||(this.layoutElement(b,u),l.push(b)),u.modules.frozen.edge&&b.classList.add("tabulator-frozen-"+u.modules.frozen.position)}else this.layoutElement(u.getElement(),u);s&&u.cells.forEach(w=>{this.layoutElement(w.getElement(!0),u)})}),this.rightColumns.forEach((u,g)=>{u.modules.frozen.margin=this.rightPadding-this._calcSpace(this.rightColumns,g+1)+"px",u.modules.frozen.edge=g==this.rightColumns.length-1,this.layoutElement(u.parent.isGroup?this.getColGroupParentElement(u):u.getElement(),u),s&&u.cells.forEach(b=>{this.layoutElement(b.getElement(!0),u)})})}getColGroupParentElement(s){return s.parent.isGroup?this.getColGroupParentElement(s.parent):s.getElement()}layout(){this.active&&(this.calcMargins(),this.table.rowManager.getDisplayRows().forEach(s=>{"row"===s.type&&this.layoutRow(s)}),this.layoutCalcRows(),this.layoutColumnPosition(!0),this.table.rowManager.tableElement.style.marginRight=this.rightMargin)}layoutRow(s){s.getElement().style.paddingLeft=this.leftMargin,this.leftColumns.forEach(u=>{var g=s.getCell(u);g&&this.layoutElement(g.getElement(!0),u)}),this.rightColumns.forEach(u=>{var g=s.getCell(u);g&&this.layoutElement(g.getElement(!0),u)})}layoutElement(s,l){l.modules.frozen&&(s.style.position="absolute",s.style.left=l.modules.frozen.margin,s.classList.add("tabulator-frozen"),l.modules.frozen.edge&&s.classList.add("tabulator-frozen-"+l.modules.frozen.position))}_calcSpace(s,l){var u=0;for(let g=0;g<l;g++)s[g].visible&&(u+=s[g].getWidth());return u}}return v.moduleName="frozenColumns",v})(),Kp=(()=>{class v extends vr{constructor(s){super(s),this.topElement=document.createElement("div"),this.rows=[],this.registerComponentFunction("row","freeze",this.freezeRow.bind(this)),this.registerComponentFunction("row","unfreeze",this.unfreezeRow.bind(this)),this.registerComponentFunction("row","isFrozen",this.isRowFrozen.bind(this))}initialize(){this.rows=[],this.topElement.classList.add("tabulator-frozen-rows-holder"),this.table.columnManager.getElement().insertBefore(this.topElement,this.table.columnManager.headersElement.nextSibling),this.subscribe("row-deleting",this.detachRow.bind(this)),this.registerDisplayHandler(this.getRows.bind(this),10)}isRowFrozen(s){return this.rows.indexOf(s)>-1}isFrozen(){return!!this.rows.length}getRows(s){var l=s.slice(0);return this.rows.forEach(function(u){var g=l.indexOf(u);g>-1&&l.splice(g,1)}),l}freezeRow(s){s.modules.frozen?console.warn("Freeze Error - Row is already frozen"):(s.modules.frozen=!0,this.topElement.appendChild(s.getElement()),s.initialize(),s.normalizeHeight(),this.table.rowManager.adjustTableSize(),this.rows.push(s),this.refreshData(!1,"display"),this.styleRows())}unfreezeRow(s){this.rows.indexOf(s),s.modules.frozen?(s.modules.frozen=!1,this.detachRow(s),this.table.rowManager.adjustTableSize(),this.refreshData(!1,"display"),this.rows.length&&this.styleRows()):console.warn("Freeze Error - Row is already unfrozen")}detachRow(s){var l=this.rows.indexOf(s);if(l>-1){var u=s.getElement();u.parentNode&&u.parentNode.removeChild(u),this.rows.splice(l,1)}}styleRows(s){this.rows.forEach((l,u)=>{this.table.rowManager.styleRow(l,u)})}}return v.moduleName="frozenRows",v})();class jf{constructor(c){return this._group=c,this.type="GroupComponent",new Proxy(this,{get:function(s,l,u){return void 0!==s[l]?s[l]:s._group.table.componentFunctionBinder.handle("row",s._group,l)}})}getKey(){return this._group.key}getField(){return this._group.field}getElement(){return this._group.element}getRows(){return this._group.getRows(!0)}getSubGroups(){return this._group.getSubGroups(!0)}getParentGroup(){return!!this._group.parent&&this._group.parent.getComponent()}isVisible(){return this._group.visible}show(){this._group.show()}hide(){this._group.hide()}toggle(){this._group.toggleVisibility()}_getSelf(){return this._group}getTable(){return this._group.groupManager.table}}class Uh{constructor(c,s,l,u,g,b,w){this.groupManager=c,this.parent=s,this.key=u,this.level=l,this.field=g,this.hasSubGroups=l<c.groupIDLookups.length-1,this.addRow=this.hasSubGroups?this._addRowToGroup:this._addRow,this.type="group",this.old=w,this.rows=[],this.groups=[],this.groupList=[],this.generator=b,this.elementContents=!1,this.height=0,this.outerHeight=0,this.initialized=!1,this.calcs={},this.initialized=!1,this.modules={},this.arrowElement=!1,this.visible=w?w.visible:void 0!==c.startOpen[l]?c.startOpen[l]:c.startOpen[0],this.component=null,this.createElements(),this.addBindings(),this.createValueGroups()}wipe(){this.groupList.length?this.groupList.forEach(function(c){c.wipe()}):(this.element=!1,this.arrowElement=!1,this.elementContents=!1)}createElements(){var c=document.createElement("div");c.classList.add("tabulator-arrow"),this.element=document.createElement("div"),this.element.classList.add("tabulator-row"),this.element.classList.add("tabulator-group"),this.element.classList.add("tabulator-group-level-"+this.level),this.element.setAttribute("role","rowgroup"),this.arrowElement=document.createElement("div"),this.arrowElement.classList.add("tabulator-group-toggle"),this.arrowElement.appendChild(c),!1!==this.groupManager.table.options.movableRows&&this.groupManager.table.modExists("moveRow")&&this.groupManager.table.modules.moveRow.initializeGroupHeader(this)}createValueGroups(){var c=this.level+1;this.groupManager.allowedValues&&this.groupManager.allowedValues[c]&&this.groupManager.allowedValues[c].forEach(s=>{this._createGroup(s,c)})}addBindings(){var c,s,l;(this.groupManager.table.options.groupContextMenu||this.groupManager.table.options.groupClickMenu)&&this.groupManager.table.modExists("menu")&&this.groupManager.table.modules.menu.initializeGroup.call(this.groupManager.table.modules.menu,this),this.groupManager.table.options.groupTap&&(l=!1,this.element.addEventListener("touchstart",g=>{l=!0},{passive:!0}),this.element.addEventListener("touchend",g=>{l&&this.groupManager.table.options.groupTap(g,this.getComponent()),l=!1})),this.groupManager.table.options.groupDblTap&&(c=null,this.element.addEventListener("touchend",g=>{c?(clearTimeout(c),c=null,this.groupManager.table.options.groupDblTap(g,this.getComponent())):c=setTimeout(()=>{clearTimeout(c),c=null},300)})),this.groupManager.table.options.groupTapHold&&(s=null,this.element.addEventListener("touchstart",g=>{clearTimeout(s),s=setTimeout(()=>{clearTimeout(s),s=null,l=!1,this.groupManager.table.options.groupTapHold(g,this.getComponent())},1e3)},{passive:!0}),this.element.addEventListener("touchend",g=>{clearTimeout(s),s=null})),this.groupManager.table.options.groupToggleElement&&("arrow"==this.groupManager.table.options.groupToggleElement?this.arrowElement:this.element).addEventListener("click",g=>{g.stopPropagation(),g.stopImmediatePropagation(),this.toggleVisibility()})}_createGroup(c,s){var l=s+"_"+c,u=new Uh(this.groupManager,this,s,c,this.groupManager.groupIDLookups[s].field,this.groupManager.headerGenerator[s]||this.groupManager.headerGenerator[0],!!this.old&&this.old.groups[l]);this.groups[l]=u,this.groupList.push(u)}_addRowToGroup(c){var s=this.level+1;if(this.hasSubGroups){var l=this.groupManager.groupIDLookups[s].func(c.getData()),u=s+"_"+l;this.groupManager.allowedValues&&this.groupManager.allowedValues[s]?this.groups[u]&&this.groups[u].addRow(c):(this.groups[u]||this._createGroup(l,s),this.groups[u].addRow(c))}}_addRow(c){this.rows.push(c),c.modules.group=this}insertRow(c,s,l){var u=this.conformRowData({});c.updateData(u);var g=this.rows.indexOf(s);g>-1?this.rows.splice(l?g+1:g,0,c):l?this.rows.push(c):this.rows.unshift(c),c.modules.group=this,this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this),this.groupManager.updateGroupRows(!0)}scrollHeader(c){this.arrowElement.style.marginLeft=c,this.groupList.forEach(function(s){s.scrollHeader(c)})}getRowIndex(c){}conformRowData(c){return this.field?c[this.field]=this.key:console.warn("Data Conforming Error - Cannot conform row data to match new group as groupBy is a function"),this.parent&&(c=this.parent.conformRowData(c)),c}removeRow(c){var s=this.rows.indexOf(c),l=c.getElement();s>-1&&this.rows.splice(s,1),this.groupManager.table.options.groupValues||this.rows.length?(l.parentNode&&l.parentNode.removeChild(l),this.generateGroupHeaderContents(),this.groupManager.table.modExists("columnCalcs")&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modules.columnCalcs.recalcGroup(this)):(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this),this.groupManager.updateGroupRows(!0))}removeGroup(c){var l,s=c.level+"_"+c.key;this.groups[s]&&(delete this.groups[s],(l=this.groupList.indexOf(c))>-1&&this.groupList.splice(l,1),this.groupList.length||(this.parent?this.parent.removeGroup(this):this.groupManager.removeGroup(this)))}getHeadersAndRows(c){var s=[];return s.push(this),this._visSet(),this.visible?this.groupList.length?this.groupList.forEach(function(l){s=s.concat(l.getHeadersAndRows(c))}):(!c&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),s.push(this.calcs.top)),s=s.concat(this.rows),!c&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),s.push(this.calcs.bottom))):!this.groupList.length&&"table"!=this.groupManager.table.options.columnCalcs&&this.groupManager.table.modExists("columnCalcs")&&(!c&&this.groupManager.table.modules.columnCalcs.hasTopCalcs()&&(this.calcs.top&&(this.calcs.top.detachElement(),this.calcs.top.deleteCells()),this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.top=this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows),s.push(this.calcs.top))),!c&&this.groupManager.table.modules.columnCalcs.hasBottomCalcs()&&(this.calcs.bottom&&(this.calcs.bottom.detachElement(),this.calcs.bottom.deleteCells()),this.groupManager.table.options.groupClosedShowCalcs&&(this.calcs.bottom=this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows),s.push(this.calcs.bottom)))),s}getData(c,s){var l=[];return this._visSet(),(!c||c&&this.visible)&&this.rows.forEach(u=>{l.push(u.getData(s||"data"))}),l}getRowCount(){var c=0;return this.groupList.length?this.groupList.forEach(s=>{c+=s.getRowCount()}):c=this.rows.length,c}toggleVisibility(){this.visible?this.hide():this.show()}hide(){this.visible=!1,"classic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination?this.groupManager.updateGroupRows(!0):(this.element.classList.remove("tabulator-group-visible"),this.groupList.length?this.groupList.forEach(c=>{c.getHeadersAndRows().forEach(l=>{l.detachElement()})}):this.rows.forEach(c=>{var s=c.getElement();s.parentNode.removeChild(s)}),this.groupManager.table.rowManager.setDisplayRows(this.groupManager.updateGroupRows(),this.groupManager.getDisplayIndex()),this.groupManager.table.rowManager.checkClassicModeGroupHeaderWidth()),this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!1)}show(){if(this.visible=!0,"classic"!=this.groupManager.table.rowManager.getRenderMode()||this.groupManager.table.options.pagination)this.groupManager.updateGroupRows(!0);else{this.element.classList.add("tabulator-group-visible");var c=this.getElement();this.groupList.length?this.groupList.forEach(s=>{s.getHeadersAndRows().forEach(u=>{var g=u.getElement();c.parentNode.insertBefore(g,c.nextSibling),u.initialize(),c=g})}):this.rows.forEach(s=>{var l=s.getElement();c.parentNode.insertBefore(l,c.nextSibling),s.initialize(),c=l}),this.groupManager.table.rowManager.setDisplayRows(this.groupManager.updateGroupRows(),this.groupManager.getDisplayIndex()),this.groupManager.table.rowManager.checkClassicModeGroupHeaderWidth()}this.groupManager.table.externalEvents.dispatch("groupVisibilityChanged",this.getComponent(),!0)}_visSet(){var c=[];"function"==typeof this.visible&&(this.rows.forEach(function(s){c.push(s.getData())}),this.visible=this.visible(this.key,this.getRowCount(),c,this.getComponent()))}getRowGroup(c){var s=!1;return this.groupList.length?this.groupList.forEach(function(l){var u=l.getRowGroup(c);u&&(s=u)}):this.rows.find(function(l){return l===c})&&(s=this),s}getSubGroups(c){var s=[];return this.groupList.forEach(function(l){s.push(c?l.getComponent():l)}),s}getRows(c){var s=[];return this.rows.forEach(function(l){s.push(c?l.getComponent():l)}),s}generateGroupHeaderContents(){var c=[];for(this.rows.forEach(function(s){c.push(s.getData())}),this.elementContents=this.generator(this.key,this.getRowCount(),c,this.getComponent());this.element.firstChild;)this.element.removeChild(this.element.firstChild);"string"==typeof this.elementContents?this.element.innerHTML=this.elementContents:this.element.appendChild(this.elementContents),this.element.insertBefore(this.arrowElement,this.element.firstChild)}getPath(c=[]){return c.unshift(this.key),this.parent&&this.parent.getPath(c),c}getElement(){this.addBindingsd=!1,this._visSet(),this.visible?this.element.classList.add("tabulator-group-visible"):this.element.classList.remove("tabulator-group-visible");for(var c=0;c<this.element.childNodes.length;++c)this.element.childNodes[c].parentNode.removeChild(this.element.childNodes[c]);return this.generateGroupHeaderContents(),this.element}detachElement(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}normalizeHeight(){this.setHeight(this.element.clientHeight)}initialize(c){(!this.initialized||c)&&(this.normalizeHeight(),this.initialized=!0)}reinitialize(){this.initialized=!1,this.height=0,Ws.elVisible(this.element)&&this.initialize(!0)}setHeight(c){this.height!=c&&(this.height=c,this.outerHeight=this.element.offsetHeight)}getHeight(){return this.outerHeight}getGroup(){return this}reinitializeHeight(){}calcHeight(){}setCellHeight(){}clearCellHeight(){}deinitializeHeight(){}getComponent(){return this.component||(this.component=new jf(this)),this.component}}let Yf=(()=>{class v extends vr{constructor(s){super(s),this.groupIDLookups=!1,this.startOpen=[function(){return!1}],this.headerGenerator=[function(){return""}],this.groupList=[],this.allowedValues=!1,this.groups={},this.displayIndex=0,this.displayHandler=this.getRows.bind(this),this.registerTableOption("groupBy",!1),this.registerTableOption("groupStartOpen",!0),this.registerTableOption("groupValues",!1),this.registerTableOption("groupUpdateOnCellEdit",!1),this.registerTableOption("groupHeader",!1),this.registerTableOption("groupHeaderPrint",null),this.registerTableOption("groupHeaderClipboard",null),this.registerTableOption("groupHeaderHtmlOutput",null),this.registerTableOption("groupHeaderDownload",null),this.registerTableOption("groupToggleElement","arrow"),this.registerTableOption("groupClosedShowCalcs",!1),this.registerTableFunction("setGroupBy",this.setGroupBy.bind(this)),this.registerTableFunction("setGroupValues",this.setGroupValues.bind(this)),this.registerTableFunction("setGroupStartOpen",this.setGroupStartOpen.bind(this)),this.registerTableFunction("setGroupHeader",this.setGroupHeader.bind(this)),this.registerTableFunction("getGroups",this.userGetGroups.bind(this)),this.registerTableFunction("getGroupedData",this.userGetGroupedData.bind(this)),this.registerComponentFunction("row","getGroup",this.rowGetGroup.bind(this))}initialize(){this.table.options.groupBy&&(this.configureGroupSetup(),this.table.options.groupUpdateOnCellEdit&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("row-data-changed",this.reassignRowToGroup.bind(this),0)),this.subscribe("row-deleting",this.rowDeleting.bind(this)),this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("scroll-horizontal",this.scrollHeaders.bind(this)),this.subscribe("rows-wipe",this.wipe.bind(this)),this.subscribe("rows-added",this.rowsUpdated.bind(this)),this.subscribe("row-moving",this.rowMoving.bind(this)),this.subscribe("row-adding-index",this.rowAddingIndex.bind(this)),this.subscribe("rows-sample",this.rowSample.bind(this)),this.subscribe("render-virtual-fill",this.virtualRenderFill.bind(this)),this.registerDisplayHandler(this.displayHandler,20),this.initialized=!0)}configureGroupSetup(){if(this.table.options.groupBy){var s=this.table.options.groupBy,l=this.table.options.groupStartOpen,u=this.table.options.groupHeader;this.allowedValues=this.table.options.groupValues,Array.isArray(s)&&Array.isArray(u)&&s.length>u.length&&console.warn("Error creating group headers, groupHeader array is shorter than groupBy array"),this.headerGenerator=[function(){return""}],this.startOpen=[function(){return!1}],this.langBind("groups|item",(b,w)=>{this.headerGenerator[0]=(k,H,Z)=>(void 0===k?"":k)+"<span>("+H+" "+(1===H?b:w.groups.items)+")</span>"}),this.groupIDLookups=[],Array.isArray(s)||s?this.table.modExists("columnCalcs")&&"table"!=this.table.options.columnCalcs&&"both"!=this.table.options.columnCalcs&&this.table.modules.columnCalcs.removeCalcs():this.table.modExists("columnCalcs")&&"group"!=this.table.options.columnCalcs&&this.table.columnManager.getRealColumns().forEach(b=>{b.definition.topCalc&&this.table.modules.columnCalcs.initializeTopRow(),b.definition.bottomCalc&&this.table.modules.columnCalcs.initializeBottomRow()}),Array.isArray(s)||(s=[s]),s.forEach((b,w)=>{var k,H;k="function"==typeof b?b:(H=this.table.columnManager.getColumnByField(b))?function(Z){return H.getFieldValue(Z)}:function(Z){return Z[b]},this.groupIDLookups.push({field:"function"!=typeof b&&b,func:k,values:!!this.allowedValues&&this.allowedValues[w]})}),l&&(Array.isArray(l)||(l=[l]),l.forEach(b=>{}),this.startOpen=l),u&&(this.headerGenerator=Array.isArray(u)?u:[u])}}rowSample(s,l){var u=this.getGroups(!1)[0];return l.push(u.getRows(!1)[0]),l}virtualRenderFill(){var s=this.table.rowManager.tableElement,l=this.table.rowManager.getVisibleRows();l=l.filter(u=>"group"!==u.type),s.style.minWidth=l.length?"":this.table.columnManager.getWidth()+"px"}rowAddingIndex(s,l,u){this.assignRowToGroup(s);var g=s.modules.group.rows;return g.length>1&&(!l||l&&-1==g.indexOf(l)?u?g[0]!==s&&this.table.rowManager.moveRowInArray(s.modules.group.rows,s,l=g[0],!u):g[g.length-1]!==s&&this.table.rowManager.moveRowInArray(s.modules.group.rows,s,l=g[g.length-1],!u):this.table.rowManager.moveRowInArray(s.modules.group.rows,s,l,!u)),l}trackChanges(){this.dispatch("group-changed")}setGroupBy(s){this.table.options.groupBy=s,this.configureGroupSetup(),this.refreshData(),this.trackChanges()}setGroupValues(s){this.table.options.groupValues=s,this.configureGroupSetup(),this.refreshData(),this.trackChanges()}setGroupStartOpen(s){this.table.options.groupStartOpen=s,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}setGroupHeader(s){this.table.options.groupHeader=s,this.configureGroupSetup(),this.table.options.groupBy?(this.refreshData(),this.trackChanges()):console.warn("Grouping Update - cant refresh view, no groups have been set")}userGetGroups(s){return this.getGroups(!0)}userGetGroupedData(){return this.table.options.groupBy?this.getGroupedData():this.getData()}rowGetGroup(s){return!!s.modules.group&&s.modules.group.getComponent()}rowMoving(s,l,u){!u&&l instanceof Uh&&(l=this.table.rowManager.prevDisplayRow(s)||l);var g=l instanceof Uh?l:l.modules.group,b=s instanceof Uh?s:s.modules.group;g===b?this.table.rowManager.moveRowInArray(g.rows,s,l,u):(b&&b.removeRow(s),g.insertRow(s,l,u))}rowDeleting(s){s.modules.group&&s.modules.group.removeRow(s)}rowsUpdated(s){this.updateGroupRows(!0)}cellUpdated(s){this.reassignRowToGroup(s.row)}setDisplayIndex(s){this.displayIndex=s}getDisplayIndex(){return this.displayIndex}getRows(s){return this.table.options.groupBy&&this.groupIDLookups.length?(this.dispatchExternal("dataGrouping"),this.generateGroups(s),this.subscribedExternal("dataGrouped")&&this.dispatchExternal("dataGrouped",this.getGroups(!0)),this.updateGroupRows()):s.slice(0)}getGroups(s){var l=[];return this.groupList.forEach(function(u){l.push(s?u.getComponent():u)}),l}getChildGroups(s){var l=[];return s||(s=this),s.groupList.forEach(u=>{u.groupList.length?l=l.concat(this.getChildGroups(u)):l.push(u)}),l}wipe(){this.groupList.forEach(function(s){s.wipe()})}pullGroupListData(s){var l=[];return s.forEach(u=>{var g={level:0,rowCount:0,headerContent:""},b=[];u.hasSubGroups?(b=this.pullGroupListData(u.groupList),g.level=u.level,g.rowCount=b.length-u.groupList.length,g.headerContent=u.generator(u.key,g.rowCount,u.rows,u),l.push(g),l=l.concat(b)):(g.level=u.level,g.headerContent=u.generator(u.key,u.rows.length,u.rows,u),g.rowCount=u.getRows().length,l.push(g),u.getRows().forEach(w=>{l.push(w.getData("data"))}))}),l}getGroupedData(){return this.pullGroupListData(this.groupList)}getRowGroup(s){var l=!1;return this.groupList.forEach(u=>{var g=u.getRowGroup(s);g&&(l=g)}),l}countGroups(){return this.groupList.length}generateGroups(s){var l=this.groups;this.groups={},this.groupList=[],this.allowedValues&&this.allowedValues[0]?(this.allowedValues[0].forEach(u=>{this.createGroup(u,0,l)}),s.forEach(u=>{this.assignRowToExistingGroup(u,l)})):s.forEach(u=>{this.assignRowToGroup(u,l)})}createGroup(s,l,u){var b,g=l+"_"+s;b=new Uh(this,!1,l,s,this.groupIDLookups[0].field,this.headerGenerator[0],(u=u||[])[g]),this.groups[g]=b,this.groupList.push(b)}assignRowToExistingGroup(s,l){var g="0_"+this.groupIDLookups[0].func(s.getData());this.groups[g]&&this.groups[g].addRow(s)}assignRowToGroup(s,l){var u=this.groupIDLookups[0].func(s.getData()),g=!this.groups["0_"+u];return g&&this.createGroup(u,0,l),this.groups["0_"+u].addRow(s),!g}reassignRowToGroup(s){if("row"===s.type){var l=s.modules.group,u=l.getPath(),g=this.getExpectedPath(s);u.length==g.length&&u.every((w,k)=>w===g[k])||(l.removeRow(s),this.assignRowToGroup(s,this.groups),this.refreshData(!0))}}getExpectedPath(s){var l=[],u=s.getData();return this.groupIDLookups.forEach(g=>{l.push(g.func(u))}),l}updateGroupRows(s){var l=[];return this.groupList.forEach(u=>{l=l.concat(u.getHeadersAndRows())}),s&&this.refreshData(!0,this.displayHandler),l}scrollHeaders(s){"virtual"===this.table.options.renderHorizontal&&(s-=this.table.columnManager.renderer.vDomPadLeft),s+="px",this.groupList.forEach(l=>{l.scrollHeader(s)})}removeGroup(s){var u,l=s.level+"_"+s.key;this.groups[l]&&(delete this.groups[l],(u=this.groupList.indexOf(s))>-1&&this.groupList.splice(u,1))}}return v.moduleName="groupRows",v})();var Xf={cellEdit:function(v){v.component.setValueProcessData(v.data.oldValue),v.component.cellRendered()},rowAdd:function(v){v.component.deleteActual()},rowDelete:function(v){var c=this.table.rowManager.addRowActual(v.data.data,v.data.pos,v.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(v.component,c)},rowMove:function(v){this.table.rowManager.moveRowActual(v.component,this.table.rowManager.rows[v.data.posFrom],!v.data.after),this.table.rowManager.redraw()}},Jp={cellEdit:function(v){v.component.setValueProcessData(v.data.newValue),v.component.cellRendered()},rowAdd:function(v){var c=this.table.rowManager.addRowActual(v.data.data,v.data.pos,v.data.index);this.table.options.groupBy&&this.table.modExists("groupRows")&&this.table.modules.groupRows.updateGroupRows(!0),this._rebindRow(v.component,c)},rowDelete:function(v){v.component.deleteActual()},rowMove:function(v){this.table.rowManager.moveRowActual(v.component,this.table.rowManager.rows[v.data.posTo],v.data.after),this.table.rowManager.redraw()}};let $p=(()=>{class v extends vr{constructor(s){super(s),this.history=[],this.index=-1,this.registerTableOption("history",!1)}initialize(){this.table.options.history&&(this.subscribe("cell-value-updated",this.cellUpdated.bind(this)),this.subscribe("cell-delete",this.clearComponentHistory.bind(this)),this.subscribe("row-delete",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clear.bind(this)),this.subscribe("row-added",this.rowAdded.bind(this)),this.subscribe("row-move",this.rowMoved.bind(this))),this.registerTableFunction("undo",this.undo.bind(this)),this.registerTableFunction("redo",this.redo.bind(this)),this.registerTableFunction("getHistoryUndoSize",this.getHistoryUndoSize.bind(this)),this.registerTableFunction("getHistoryRedoSize",this.getHistoryRedoSize.bind(this)),this.registerTableFunction("clearHistory",this.clear.bind(this))}rowMoved(s,l,u){this.action("rowMove",s,{posFrom:this.table.rowManager.getRowPosition(s),posTo:this.table.rowManager.getRowPosition(l),to:l,after:u})}rowAdded(s,l,u,g){this.action("rowAdd",s,{data:l,pos:u,index:g})}rowDeleted(s){var l,u;this.table.options.groupBy?(l=(u=s.getComponent().getGroup().rows).indexOf(s))&&(l=u[l-1]):(l=s.table.rowManager.getRowIndex(s))&&(l=s.table.rowManager.rows[l-1]),this.action("rowDelete",s,{data:s.getData(),pos:!l,index:l})}cellUpdated(s){this.action("cellEdit",s,{oldValue:s.oldValue,newValue:s.value})}clear(){this.history=[],this.index=-1}action(s,l,u){this.history=this.history.slice(0,this.index+1),this.history.push({type:s,component:l,data:u}),this.index++}getHistoryUndoSize(){return this.index+1}getHistoryRedoSize(){return this.history.length-(this.index+1)}clearComponentHistory(s){var l=this.history.findIndex(function(u){return u.component===s});l>-1&&(this.history.splice(l,1),l<=this.index&&this.index--,this.clearComponentHistory(s))}undo(){if(this.index>-1){let s=this.history[this.index];return v.undoers[s.type].call(this,s),this.index--,this.dispatchExternal("historyUndo",s.type,s.component.getComponent(),s.data),!0}return console.warn("History Undo Error - No more history to undo"),!1}redo(){if(this.history.length-1>this.index){this.index++;let s=this.history[this.index];return v.redoers[s.type].call(this,s),this.dispatchExternal("historyRedo",s.type,s.component.getComponent(),s.data),!0}return console.warn("History Redo Error - No more history to redo"),!1}_rebindRow(s,l){this.history.forEach(function(u){if(u.component instanceof Gr)u.component===s&&(u.component=l);else if(u.component instanceof Od&&u.component.row===s){var g=u.component.column.getField();g&&(u.component=l.getCell(g))}})}}return v.moduleName="history",v.undoers=Xf,v.redoers=Jp,v})(),Kf=(()=>{class v extends vr{constructor(s){super(s),this.fieldIndex=[],this.hasIndex=!1}initialize(){this.tableElementCheck()}tableElementCheck(){this.table.originalElement&&"TABLE"===this.table.originalElement.tagName&&this.parseTable()}parseTable(){var s=this.table.originalElement,l=this.table.options,g=s.getElementsByTagName("th"),b=s.getElementsByTagName("tbody")[0],w=[];this.hasIndex=!1,this.dispatchExternal("htmlImporting"),b=b?b.getElementsByTagName("tr"):[],this._extractOptions(s,l),g.length?this._extractHeaders(g,b):this._generateBlankHeaders(g,b);for(var k=0;k<b.length;k++){var Z=b[k].getElementsByTagName("td"),ht={};this.hasIndex||(ht[l.index]=k);for(var Pt=0;Pt<Z.length;Pt++)void 0!==this.fieldIndex[Pt]&&(ht[this.fieldIndex[Pt]]=Z[Pt].innerHTML);w.push(ht)}l.data=w,this.dispatchExternal("htmlImported")}_extractOptions(s,l,u){var g=s.attributes,b=u?Object.assign([],u):Object.keys(l),w={};for(var k in b.forEach(ht=>{w[ht.toLowerCase()]=ht}),g){var Z,H=g[k];H&&"object"==typeof H&&H.name&&0===H.name.indexOf("tabulator-")&&(Z=H.name.replace("tabulator-",""),void 0!==w[Z]&&(l[w[Z]]=this._attribValue(H.value)))}}_attribValue(s){return"true"===s||"false"!==s&&s}_findCol(s){return this.table.options.columns.find(u=>u.title===s)||!1}_extractHeaders(s,l){for(var u=0;u<s.length;u++){var k,g=s[u],b=!1,w=this._findCol(g.textContent);w?b=!0:w={title:g.textContent.trim()},w.field||(w.field=g.textContent.trim().toLowerCase().replace(" ","_")),(k=g.getAttribute("width"))&&!w.width&&(w.width=k),this._extractOptions(g,w,_d.prototype.defaultOptionList),this.fieldIndex[u]=w.field,w.field==this.table.options.index&&(this.hasIndex=!0),b||this.table.options.columns.push(w)}}_generateBlankHeaders(s,l){for(var u=0;u<s.length;u++){var g=s[u],b={title:"",field:"col"+u};this.fieldIndex[u]=b.field;var w=g.getAttribute("width");w&&(b.width=w),this.table.options.columns.push(b)}}}return v.moduleName="htmlTableImport",v})(),Pu=(()=>{class v extends vr{constructor(s){super(s),this.eventMap={rowClick:"row-click",rowDblClick:"row-dblclick",rowContext:"row-contextmenu",rowMouseEnter:"row-mouseenter",rowMouseLeave:"row-mouseleave",rowMouseOver:"row-mouseover",rowMouseOut:"row-mouseout",rowMouseMove:"row-mousemove",rowTap:"row",rowDblTap:"row",rowTapHold:"row",cellClick:"cell-click",cellDblClick:"cell-dblclick",cellContext:"cell-contextmenu",cellMouseEnter:"cell-mouseenter",cellMouseLeave:"cell-mouseleave",cellMouseOver:"cell-mouseover",cellMouseOut:"cell-mouseout",cellMouseMove:"cell-mousemove",cellTap:"cell",cellDblTap:"cell",cellTapHold:"cell",headerClick:"column-click",headerDblClick:"column-dblclick",headerContext:"column-contextmenu",headerMouseEnter:"column-mouseenter",headerMouseLeave:"column-mouseleave",headerMouseOver:"column-mouseover",headerMouseOut:"column-mouseout",headerMouseMove:"column-mousemove",headerTap:"column",headerDblTap:"column",headerTapHold:"column",groupClick:"group-click",groupDblClick:"group-dblclick",groupContext:"group-contextmenu",groupMouseEnter:"group-mouseenter",groupMouseLeave:"group-mouseleave",groupMouseOver:"group-mouseover",groupMouseOut:"group-mouseout",groupMouseMove:"group-mousemove",groupTap:"group",groupDblTap:"group",groupTapHold:"group"},this.subscribers={},this.touchSubscribers={},this.columnSubscribers={},this.touchWatchers={row:{tap:null,tapDbl:null,tapHold:null},cell:{tap:null,tapDbl:null,tapHold:null},column:{tap:null,tapDbl:null,tapHold:null}},this.registerColumnOption("headerClick"),this.registerColumnOption("headerDblClick"),this.registerColumnOption("headerContext"),this.registerColumnOption("headerMouseEnter"),this.registerColumnOption("headerMouseLeave"),this.registerColumnOption("headerMouseOver"),this.registerColumnOption("headerMouseOut"),this.registerColumnOption("headerMouseMove"),this.registerColumnOption("headerTap"),this.registerColumnOption("headerDblTap"),this.registerColumnOption("headerTapHold"),this.registerColumnOption("cellClick"),this.registerColumnOption("cellDblClick"),this.registerColumnOption("cellContext"),this.registerColumnOption("cellMouseEnter"),this.registerColumnOption("cellMouseLeave"),this.registerColumnOption("cellMouseOver"),this.registerColumnOption("cellMouseOut"),this.registerColumnOption("cellMouseMove"),this.registerColumnOption("cellTap"),this.registerColumnOption("cellDblTap"),this.registerColumnOption("cellTapHold")}initialize(){this.initializeExternalEvents(),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("cell-dblclick",this.cellContentsSelectionFixer.bind(this))}cellContentsSelectionFixer(s,l){if(!this.table.modExists("edit")||this.table.modules.edit.currentCell!==this){s.preventDefault();try{if(document.selection)(u=document.body.createTextRange()).moveToElementText(this.element),u.select();else if(window.getSelection){var u;(u=document.createRange()).selectNode(this.element),window.getSelection().removeAllRanges(),window.getSelection().addRange(u)}}catch(g){}}}initializeExternalEvents(){for(let s in this.eventMap)this.subscriptionChangeExternal(s,this.subscriptionChanged.bind(this,s))}subscriptionChanged(s,l){l?this.subscribers[s]||(this.eventMap[s].includes("-")?(this.subscribers[s]=this.handle.bind(this,s),this.subscribe(this.eventMap[s],this.subscribers[s])):this.subscribeTouchEvents(s)):this.eventMap[s].includes("-")?this.subscribers[s]&&!this.columnSubscribers[s]&&!this.subscribedExternal(s)&&(this.unsubscribe(this.eventMap[s],this.subscribers[s]),delete this.subscribers[s]):this.unsubscribeTouchEvents(s)}subscribeTouchEvents(s){var l=this.eventMap[s];this.touchSubscribers[l+"-touchstart"]||(this.touchSubscribers[l+"-touchstart"]=this.handleTouch.bind(this,l,"start"),this.touchSubscribers[l+"-touchend"]=this.handleTouch.bind(this,l,"end"),this.subscribe(l+"-touchstart",this.touchSubscribers[l+"-touchstart"]),this.subscribe(l+"-touchend",this.touchSubscribers[l+"-touchend"])),this.subscribers[s]=!0}unsubscribeTouchEvents(s){var l=!0,u=this.eventMap[s];if(this.subscribers[s]&&!this.subscribedExternal(s)){delete this.subscribers[s];for(let g in this.eventMap)this.eventMap[g]===u&&this.subscribers[g]&&(l=!1);l&&(this.unsubscribe(u+"-touchstart",this.touchSubscribers[u+"-touchstart"]),this.unsubscribe(u+"-touchend",this.touchSubscribers[u+"-touchend"]),delete this.touchSubscribers[u+"-touchstart"],delete this.touchSubscribers[u+"-touchend"])}}initializeColumn(s){var l=s.definition;for(let u in this.eventMap)l[u]&&(this.subscriptionChanged(u,!0),this.columnSubscribers[u]||(this.columnSubscribers[u]=[]),this.columnSubscribers[u].push(s))}handle(s,l,u){this.dispatchEvent(s,l,u)}handleTouch(s,l,u,g){var b=this.touchWatchers[s];switch("column"===s&&(s="header"),l){case"start":b.tap=!0,clearTimeout(b.tapHold),b.tapHold=setTimeout(()=>{clearTimeout(b.tapHold),b.tapHold=null,b.tap=null,clearTimeout(b.tapDbl),b.tapDbl=null,this.dispatchEvent(s+"TapHold",u,g)},1e3);break;case"end":b.tap&&(b.tap=null,this.dispatchEvent(s+"Tap",u,g)),b.tapDbl?(clearTimeout(b.tapDbl),b.tapDbl=null,this.dispatchEvent(s+"DblTap",u,g)):b.tapDbl=setTimeout(()=>{clearTimeout(b.tapDbl),b.tapDbl=null},300),clearTimeout(b.tapHold),b.tapHold=null}}dispatchEvent(s,l,u){var b,g=u.getComponent();this.columnSubscribers[s]&&(u instanceof Od?b=u.column.definition[s]:u instanceof _d&&(b=u.definition[s]),b&&b(l,g)),this.dispatchExternal(s,l,g)}}return v.moduleName="interaction",v})();var dp={navPrev:"shift + 9",navNext:9,navUp:38,navDown:40,scrollPageUp:33,scrollPageDown:34,scrollToStart:36,scrollToEnd:35,undo:"ctrl + 90",redo:"ctrl + 89",copyToClipboard:"ctrl + 67"},Jf={keyBlock:function(v){v.stopPropagation(),v.preventDefault()},scrollPageUp:function(v){var c=this.table.rowManager,s=c.scrollTop-c.element.clientHeight;v.preventDefault(),c.displayRowsCount&&(s>=0?c.element.scrollTop=s:c.scrollToRow(c.getDisplayRows()[0])),this.table.element.focus()},scrollPageDown:function(v){var c=this.table.rowManager,s=c.scrollTop+c.element.clientHeight,l=c.element.scrollHeight;v.preventDefault(),c.displayRowsCount&&(s<=l?c.element.scrollTop=s:c.scrollToRow(c.getDisplayRows()[c.displayRowsCount-1])),this.table.element.focus()},scrollToStart:function(v){var c=this.table.rowManager;v.preventDefault(),c.displayRowsCount&&c.scrollToRow(c.getDisplayRows()[0]),this.table.element.focus()},scrollToEnd:function(v){var c=this.table.rowManager;v.preventDefault(),c.displayRowsCount&&c.scrollToRow(c.getDisplayRows()[c.displayRowsCount-1]),this.table.element.focus()},navPrev:function(v){this.dispatch("keybinding-nav-prev",v)},navNext:function(v){this.dispatch("keybinding-nav-next",v)},navLeft:function(v){this.dispatch("keybinding-nav-left",v)},navRight:function(v){this.dispatch("keybinding-nav-right",v)},navUp:function(v){this.dispatch("keybinding-nav-up",v)},navDown:function(v){this.dispatch("keybinding-nav-down",v)},undo:function(v){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(v.preventDefault(),this.table.modules.history.undo()))},redo:function(v){this.table.options.history&&this.table.modExists("history")&&this.table.modExists("edit")&&(this.table.modules.edit.currentCell||(v.preventDefault(),this.table.modules.history.redo()))},copyToClipboard:function(v){this.table.modules.edit.currentCell||this.table.modExists("clipboard",!0)&&this.table.modules.clipboard.copy(!1,!0)}};let $f=(()=>{class v extends vr{constructor(s){super(s),this.watchKeys=null,this.pressedKeys=null,this.keyupBinding=!1,this.keydownBinding=!1,this.registerTableOption("keybindings",[]),this.registerTableOption("tabEndNewRow",!1)}initialize(){var s=this.table.options.keybindings,l={};if(this.watchKeys={},this.pressedKeys=[],!1!==s){for(let u in v.bindings)l[u]=v.bindings[u];if(Object.keys(s).length)for(let u in s)l[u]=s[u];this.mapBindings(l),this.bindEvents()}this.subscribe("table-destroy",this.clearBindings.bind(this))}mapBindings(s){for(let l in s)v.actions[l]?s[l]&&("object"!=typeof s[l]&&(s[l]=[s[l]]),s[l].forEach(u=>{this.mapBinding(l,u)})):console.warn("Key Binding Error - no such action:",l)}mapBinding(s,l){var u={action:v.actions[s],keys:[],ctrl:!1,shift:!1,meta:!1};l.toString().toLowerCase().split(" ").join("").split("+").forEach(b=>{switch(b){case"ctrl":u.ctrl=!0;break;case"shift":u.shift=!0;break;case"meta":u.meta=!0;break;default:b=parseInt(b),u.keys.push(b),this.watchKeys[b]||(this.watchKeys[b]=[]),this.watchKeys[b].push(u)}})}bindEvents(){var s=this;this.keyupBinding=function(l){var u=l.keyCode,g=s.watchKeys[u];g&&(s.pressedKeys.push(u),g.forEach(function(b){s.checkBinding(l,b)}))},this.keydownBinding=function(l){var u=l.keyCode;if(s.watchKeys[u]){var b=s.pressedKeys.indexOf(u);b>-1&&s.pressedKeys.splice(b,1)}},this.table.element.addEventListener("keydown",this.keyupBinding),this.table.element.addEventListener("keyup",this.keydownBinding)}clearBindings(){this.keyupBinding&&this.table.element.removeEventListener("keydown",this.keyupBinding),this.keydownBinding&&this.table.element.removeEventListener("keyup",this.keydownBinding)}checkBinding(s,l){var u=!0;return s.ctrlKey==l.ctrl&&s.shiftKey==l.shift&&s.metaKey==l.meta&&(l.keys.forEach(g=>{-1==this.pressedKeys.indexOf(g)&&(u=!1)}),u&&l.action.call(this,s),!0)}}return v.moduleName="keybindings",v.bindings=dp,v.actions=Jf,v})(),N_=(()=>{class v extends vr{constructor(s){super(s),this.menuElements=[],this.blurEvent=this.hideMenu.bind(this),this.escEvent=this.escMenu.bind(this),this.nestedMenuBlock=!1,this.positionReversedX=!1,this.registerTableOption("rowContextMenu",!1),this.registerTableOption("rowClickMenu",!1),this.registerTableOption("groupContextMenu",!1),this.registerTableOption("groupClickMenu",!1),this.registerColumnOption("headerContextMenu"),this.registerColumnOption("headerMenu"),this.registerColumnOption("contextMenu"),this.registerColumnOption("clickMenu")}initialize(){this.subscribe("cell-layout",this.layoutCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this))}layoutCell(s){(s.column.definition.contextMenu||s.column.definition.clickMenu)&&this.initializeCell(s)}initializeColumn(s){var l=s.definition;(l.headerContextMenu||l.headerClickMenu||l.headerMenu)&&this.initializeColumnHeader(s)}initializeColumnHeader(s){var l;s.definition.headerContextMenu&&(s.getElement().addEventListener("contextmenu",this.LoadMenuEvent.bind(this,s,s.definition.headerContextMenu)),this.tapHold(s,s.definition.headerContextMenu)),s.definition.headerMenu&&((l=document.createElement("span")).classList.add("tabulator-header-menu-button"),l.innerHTML="&vellip;",l.addEventListener("click",u=>{u.stopPropagation(),u.preventDefault(),this.LoadMenuEvent(s,s.definition.headerMenu,u)}),s.titleElement.insertBefore(l,s.titleElement.firstChild))}LoadMenuEvent(s,l,u){l="function"==typeof l?l.call(this.table,s.getComponent(),u):l,this.loadMenu(u,s,l)}tapHold(s,l){var u=s.getElement(),g=null,b=!1;u.addEventListener("touchstart",w=>{clearTimeout(g),b=!1,g=setTimeout(()=>{clearTimeout(g),g=null,b=!0,this.LoadMenuEvent(s,l,w)},1e3)},{passive:!0}),u.addEventListener("touchend",w=>{clearTimeout(g),g=null,b&&w.preventDefault()})}initializeCell(s){s.column.definition.contextMenu&&(s.getElement(!0).addEventListener("contextmenu",this.LoadMenuEvent.bind(this,s,s.column.definition.contextMenu)),this.tapHold(s,s.column.definition.contextMenu)),s.column.definition.clickMenu&&s.getElement(!0).addEventListener("click",this.LoadMenuEvent.bind(this,s,s.column.definition.clickMenu))}initializeRow(s){this.table.options.rowContextMenu&&(s.getElement().addEventListener("contextmenu",this.LoadMenuEvent.bind(this,s,this.table.options.rowContextMenu)),this.tapHold(s,this.table.options.rowContextMenu)),this.table.options.rowClickMenu&&s.getElement().addEventListener("click",this.LoadMenuEvent.bind(this,s,this.table.options.rowClickMenu))}initializeGroup(s){this.table.options.groupContextMenu&&(s.getElement().addEventListener("contextmenu",this.LoadMenuEvent.bind(this,s,this.table.options.groupContextMenu)),this.tapHold(s,this.table.options.groupContextMenu)),this.table.options.groupClickMenu&&s.getElement().addEventListener("click",this.LoadMenuEvent.bind(this,s,this.table.options.groupClickMenu))}loadMenu(s,l,u,g){var b=!(s instanceof MouseEvent),w=document.createElement("div");if(w.classList.add("tabulator-menu"),b||s.preventDefault(),u&&u.length){if(!g){if(this.nestedMenuBlock){if(this.isOpen())return}else this.nestedMenuBlock=setTimeout(()=>{this.nestedMenuBlock=!1},100);this.hideMenu(),this.menuElements=[]}u.forEach(k=>{var H=document.createElement("div"),Z=k.label,ht=k.disabled;k.separator?H.classList.add("tabulator-menu-separator"):(H.classList.add("tabulator-menu-item"),"function"==typeof Z&&(Z=Z.call(this.table,l.getComponent())),Z instanceof Node?H.appendChild(Z):H.innerHTML=Z,"function"==typeof ht&&(ht=ht.call(this.table,l.getComponent())),ht?(H.classList.add("tabulator-menu-item-disabled"),H.addEventListener("click",Pt=>{Pt.stopPropagation()})):k.menu&&k.menu.length?H.addEventListener("click",Pt=>{Pt.stopPropagation(),this.hideOldSubMenus(w),this.loadMenu(Pt,l,k.menu,H)}):k.action&&H.addEventListener("click",Pt=>{k.action(Pt,l.getComponent())}),k.menu&&k.menu.length&&H.classList.add("tabulator-menu-item-submenu")),w.appendChild(H)}),w.addEventListener("click",k=>{this.hideMenu()}),this.menuElements.push(w),this.positionMenu(w,g,b,s)}}hideOldSubMenus(s){var l=this.menuElements.indexOf(s);if(l>-1)for(let g=this.menuElements.length-1;g>l;g--){var u=this.menuElements[g];u.parentNode&&u.parentNode.removeChild(u),this.menuElements.pop()}}positionMenu(s,l,u,g){var w,k,H,b=Math.max(document.body.offsetHeight,window.innerHeight);l?(w=(H=Ws.elOffset(l)).left+l.offsetWidth,k=H.top-1):(w=u?g.touches[0].pageX:g.pageX,k=u?g.touches[0].pageY:g.pageY,this.positionReversedX=!1),s.style.top=k+"px",s.style.left=w+"px",setTimeout(()=>{this.table.rowManager.element.addEventListener("scroll",this.blurEvent),document.body.addEventListener("click",this.blurEvent),document.body.addEventListener("contextmenu",this.blurEvent),window.addEventListener("resize",this.blurEvent),document.body.addEventListener("keydown",this.escEvent)},100),document.body.appendChild(s),k+s.offsetHeight>=b&&(s.style.top="",s.style.bottom=l?b-H.top-l.offsetHeight-1+"px":b-k+"px"),(w+s.offsetWidth>=document.body.offsetWidth||this.positionReversedX)&&(s.style.left="",s.style.right=l?document.documentElement.offsetWidth-H.left+"px":document.documentElement.offsetWidth-w+"px",this.positionReversedX=!0)}isOpen(){return!!this.menuElements.length}escMenu(s){27==s.keyCode&&this.hideMenu()}hideMenu(){this.menuElements.forEach(s=>{s.parentNode&&s.parentNode.removeChild(s)}),document.body.removeEventListener("keydown",this.escEvent),document.body.removeEventListener("click",this.blurEvent),document.body.removeEventListener("contextmenu",this.blurEvent),window.removeEventListener("resize",this.blurEvent),this.table.rowManager.element.removeEventListener("scroll",this.blurEvent)}}return v.moduleName="menu",v})(),Zp=(()=>{class v extends vr{constructor(s){super(s),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=250,this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.startX=0,this.autoScrollMargin=40,this.autoScrollStep=5,this.autoScrollTimeout=!1,this.touchMove=!1,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.registerTableOption("movableColumns",!1)}createPlaceholderElement(){var s=document.createElement("div");return s.classList.add("tabulator-col"),s.classList.add("tabulator-col-placeholder"),s}initialize(){this.subscribe("column-init",this.initializeColumn.bind(this))}initializeColumn(s){var g,l=this,u={};s.modules.frozen||(g=s.getElement(),u.mousemove=function(b){s.parent===l.moving.parent&&((l.touchMove?b.touches[0].pageX:b.pageX)-Ws.elOffset(g).left+l.table.columnManager.element.scrollLeft>s.getWidth()/2?(l.toCol!==s||!l.toColAfter)&&(g.parentNode.insertBefore(l.placeholderElement,g.nextSibling),l.moveColumn(s,!0)):(l.toCol!==s||l.toColAfter)&&(g.parentNode.insertBefore(l.placeholderElement,g),l.moveColumn(s,!1)))}.bind(l),g.addEventListener("mousedown",function(b){l.touchMove=!1,1===b.which&&(l.checkTimeout=setTimeout(function(){l.startMove(b,s)},l.checkPeriod))}),g.addEventListener("mouseup",function(b){1===b.which&&l.checkTimeout&&clearTimeout(l.checkTimeout)}),l.bindTouchEvents(s)),s.modules.moveColumn=u}bindTouchEvents(s){var g,b,w,k,H,Z,l=s.getElement(),u=!1;l.addEventListener("touchstart",ht=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,g=s.nextColumn(),w=g?g.getWidth()/2:0,b=s.prevColumn(),k=b?b.getWidth()/2:0,H=0,Z=0,u=!1,this.startMove(ht,s)},this.checkPeriod)},{passive:!0}),l.addEventListener("touchmove",ht=>{var Pt,qt;this.moving&&(this.moveHover(ht),u||(u=ht.touches[0].pageX),(Pt=ht.touches[0].pageX-u)>0?g&&Pt-H>w&&(qt=g)!==s&&(u=ht.touches[0].pageX,qt.getElement().parentNode.insertBefore(this.placeholderElement,qt.getElement().nextSibling),this.moveColumn(qt,!0)):b&&-Pt-Z>k&&(qt=b)!==s&&(u=ht.touches[0].pageX,qt.getElement().parentNode.insertBefore(this.placeholderElement,qt.getElement()),this.moveColumn(qt,!1)),qt&&(g=qt.nextColumn(),H=w,w=g?g.getWidth()/2:0,b=qt.prevColumn(),Z=k,k=b?b.getWidth()/2:0))},{passive:!0}),l.addEventListener("touchend",ht=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&this.endMove(ht)})}startMove(s,l){var u=l.getElement(),g=this.table.columnManager.getElement(),b=this.table.columnManager.getHeadersElement();this.moving=l,this.startX=(this.touchMove?s.touches[0].pageX:s.pageX)-Ws.elOffset(u).left,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=l.getWidth()+"px",this.placeholderElement.style.height=l.getHeight()+"px",u.parentNode.insertBefore(this.placeholderElement,u),u.parentNode.removeChild(u),this.hoverElement=u.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.table.columnManager.getElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.bottom=g.clientHeight-b.offsetHeight+"px",this.touchMove||(this._bindMouseMove(),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove)),this.moveHover(s)}_bindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(s){s.modules.moveColumn.mousemove&&s.getElement().addEventListener("mousemove",s.modules.moveColumn.mousemove)})}_unbindMouseMove(){this.table.columnManager.columnsByIndex.forEach(function(s){s.modules.moveColumn.mousemove&&s.getElement().removeEventListener("mousemove",s.modules.moveColumn.mousemove)})}moveColumn(s,l){var u=this.moving.getCells();this.toCol=s,this.toColAfter=l,l?s.getCells().forEach(function(g,b){var w=g.getElement(!0);w.parentNode&&u[b]&&w.parentNode.insertBefore(u[b].getElement(),w.nextSibling)}):s.getCells().forEach(function(g,b){var w=g.getElement(!0);w.parentNode&&u[b]&&w.parentNode.insertBefore(u[b].getElement(),w)})}endMove(s){(1===s.which||this.touchMove)&&(this._unbindMouseMove(),this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toCol&&this.table.columnManager.moveColumnActual(this.moving,this.toCol,this.toColAfter),this.moving=!1,this.toCol=!1,this.toColAfter=!1,this.touchMove||(document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove)))}moveHover(s){var b,l=this.table.columnManager.getElement(),u=l.scrollLeft,g=(this.touchMove?s.touches[0].pageX:s.pageX)-Ws.elOffset(l).left+u;this.hoverElement.style.left=g-this.startX+"px",g-u<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{b=Math.max(0,u-5),this.table.rowManager.getElement().scrollLeft=b,this.autoScrollTimeout=!1},1))),u+l.clientWidth-g<this.autoScrollMargin&&(this.autoScrollTimeout||(this.autoScrollTimeout=setTimeout(()=>{b=Math.min(l.clientWidth,u+5),this.table.rowManager.getElement().scrollLeft=b,this.autoScrollTimeout=!1},1)))}}return v.moduleName="moveColumn",v})();class Fd extends vr{constructor(c){super(c),this.placeholderElement=this.createPlaceholderElement(),this.hoverElement=!1,this.checkTimeout=!1,this.checkPeriod=150,this.moving=!1,this.toRow=!1,this.toRowAfter=!1,this.hasHandle=!1,this.startY=0,this.startX=0,this.moveHover=this.moveHover.bind(this),this.endMove=this.endMove.bind(this),this.tableRowDropEvent=!1,this.touchMove=!1,this.connection=!1,this.connectionSelectorsTables=!1,this.connectionSelectorsElements=!1,this.connectionElements=[],this.connections=[],this.connectedTable=!1,this.connectedRow=!1,this.registerTableOption("movableRows",!1),this.registerTableOption("movableRowsConnectedTables",!1),this.registerTableOption("movableRowsConnectedElements",!1),this.registerTableOption("movableRowsSender",!1),this.registerTableOption("movableRowsReceiver","insert"),this.registerColumnOption("rowHandle")}createPlaceholderElement(){var c=document.createElement("div");return c.classList.add("tabulator-row"),c.classList.add("tabulator-row-placeholder"),c}initialize(){this.table.options.movableRows&&(this.connectionSelectorsTables=this.table.options.movableRowsConnectedTables,this.connectionSelectorsElements=this.table.options.movableRowsConnectedElements,this.connection=this.connectionSelectorsTables||this.connectionSelectorsElements,this.subscribe("cell-init",this.initializeCell.bind(this)),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("row-init",this.initializeRow.bind(this)))}initializeGroupHeader(c){var s=this,l={};l.mouseup=function(u){s.tableRowDrop(u,row)}.bind(s),l.mousemove=function(u){if(u.pageY-Ws.elOffset(c.element).top+s.table.rowManager.element.scrollTop>c.getHeight()/2)s.toRow===c&&s.toRowAfter||((g=c.getElement()).parentNode.insertBefore(s.placeholderElement,g.nextSibling),s.moveRow(c,!0));else if(s.toRow!==c||s.toRowAfter){var g;(g=c.getElement()).previousSibling&&(g.parentNode.insertBefore(s.placeholderElement,g),s.moveRow(c,!1))}}.bind(s),c.modules.moveRow=l}initializeRow(c){var u,s=this,l={};l.mouseup=function(g){s.tableRowDrop(g,c)}.bind(s),l.mousemove=function(g){var b=c.getElement();g.pageY-Ws.elOffset(b).top+s.table.rowManager.element.scrollTop>c.getHeight()/2?(s.toRow!==c||!s.toRowAfter)&&(b.parentNode.insertBefore(s.placeholderElement,b.nextSibling),s.moveRow(c,!0)):(s.toRow!==c||s.toRowAfter)&&(b.parentNode.insertBefore(s.placeholderElement,b),s.moveRow(c,!1))}.bind(s),this.hasHandle||((u=c.getElement()).addEventListener("mousedown",function(g){1===g.which&&(s.checkTimeout=setTimeout(function(){s.startMove(g,c)},s.checkPeriod))}),u.addEventListener("mouseup",function(g){1===g.which&&s.checkTimeout&&clearTimeout(s.checkTimeout)}),this.bindTouchEvents(c,c.getElement())),c.modules.moveRow=l}initializeColumn(c){c.definition.rowHandle&&!1!==this.table.options.movableRows&&(this.hasHandle=!0)}initializeCell(c){if(c.column.definition.rowHandle&&!1!==this.table.options.movableRows){var s=this,l=c.getElement(!0);l.addEventListener("mousedown",function(u){1===u.which&&(s.checkTimeout=setTimeout(function(){s.startMove(u,c.row)},s.checkPeriod))}),l.addEventListener("mouseup",function(u){1===u.which&&s.checkTimeout&&clearTimeout(s.checkTimeout)}),this.bindTouchEvents(c.row,l)}}bindTouchEvents(c,s){var u,g,b,w,k,H,l=!1;s.addEventListener("touchstart",Z=>{this.checkTimeout=setTimeout(()=>{this.touchMove=!0,u=c.nextRow(),b=u?u.getHeight()/2:0,g=c.prevRow(),w=g?g.getHeight()/2:0,k=0,H=0,l=!1,this.startMove(Z,c)},this.checkPeriod)},{passive:!0}),s.addEventListener("touchmove",Z=>{var ht,Pt;this.moving&&(Z.preventDefault(),this.moveHover(Z),l||(l=Z.touches[0].pageY),(ht=Z.touches[0].pageY-l)>0?u&&ht-k>b&&(Pt=u)!==c&&(l=Z.touches[0].pageY,Pt.getElement().parentNode.insertBefore(this.placeholderElement,Pt.getElement().nextSibling),this.moveRow(Pt,!0)):g&&-ht-H>w&&(Pt=g)!==c&&(l=Z.touches[0].pageY,Pt.getElement().parentNode.insertBefore(this.placeholderElement,Pt.getElement()),this.moveRow(Pt,!1)),Pt&&(u=Pt.nextRow(),k=b,b=u?u.getHeight()/2:0,g=Pt.prevRow(),H=w,w=g?g.getHeight()/2:0))}),s.addEventListener("touchend",Z=>{this.checkTimeout&&clearTimeout(this.checkTimeout),this.moving&&(this.endMove(Z),this.touchMove=!1)})}_bindMouseMove(){this.table.rowManager.getDisplayRows().forEach(c=>{("row"===c.type||"group"===c.type)&&c.modules.moveRow&&c.modules.moveRow.mousemove&&c.getElement().addEventListener("mousemove",c.modules.moveRow.mousemove)})}_unbindMouseMove(){this.table.rowManager.getDisplayRows().forEach(c=>{("row"===c.type||"group"===c.type)&&c.modules.moveRow&&c.modules.moveRow.mousemove&&c.getElement().removeEventListener("mousemove",c.modules.moveRow.mousemove)})}startMove(c,s){var l=s.getElement();this.setStartPosition(c,s),this.moving=s,this.table.element.classList.add("tabulator-block-select"),this.placeholderElement.style.width=s.getWidth()+"px",this.placeholderElement.style.height=s.getHeight()+"px",this.connection?(this.table.element.classList.add("tabulator-movingrow-sending"),this.connectToTables(s)):(l.parentNode.insertBefore(this.placeholderElement,l),l.parentNode.removeChild(l)),this.hoverElement=l.cloneNode(!0),this.hoverElement.classList.add("tabulator-moving"),this.connection?(document.body.appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this.hoverElement.style.width=this.table.element.clientWidth+"px",this.hoverElement.style.whiteSpace="nowrap",this.hoverElement.style.overflow="hidden",this.hoverElement.style.pointerEvents="none"):(this.table.rowManager.getTableElement().appendChild(this.hoverElement),this.hoverElement.style.left="0",this.hoverElement.style.top="0",this._bindMouseMove()),document.body.addEventListener("mousemove",this.moveHover),document.body.addEventListener("mouseup",this.endMove),this.moveHover(c)}setStartPosition(c,s){var g,b,l=this.touchMove?c.touches[0].pageX:c.pageX,u=this.touchMove?c.touches[0].pageY:c.pageY;g=s.getElement(),this.connection?(b=g.getBoundingClientRect(),this.startX=b.left-l+window.pageXOffset,this.startY=b.top-u+window.pageYOffset):this.startY=u-g.getBoundingClientRect().top}endMove(c){(!c||1===c.which||this.touchMove)&&(this._unbindMouseMove(),this.connection||(this.placeholderElement.parentNode.insertBefore(this.moving.getElement(),this.placeholderElement.nextSibling),this.placeholderElement.parentNode.removeChild(this.placeholderElement)),this.hoverElement.parentNode.removeChild(this.hoverElement),this.table.element.classList.remove("tabulator-block-select"),this.toRow&&this.table.rowManager.moveRow(this.moving,this.toRow,this.toRowAfter),this.moving=!1,this.toRow=!1,this.toRowAfter=!1,document.body.removeEventListener("mousemove",this.moveHover),document.body.removeEventListener("mouseup",this.endMove),this.connection&&(this.table.element.classList.remove("tabulator-movingrow-sending"),this.disconnectFromTables()))}moveRow(c,s){this.toRow=c,this.toRowAfter=s}moveHover(c){this.connection?this.moveHoverConnections.call(this,c):this.moveHoverTable.call(this,c)}moveHoverTable(c){var s=this.table.rowManager.getElement(),l=s.scrollTop,u=(this.touchMove?c.touches[0].pageY:c.pageY)-s.getBoundingClientRect().top+l;this.hoverElement.style.top=u-this.startY+"px"}moveHoverConnections(c){this.hoverElement.style.left=this.startX+(this.touchMove?c.touches[0].pageX:c.pageX)+"px",this.hoverElement.style.top=this.startY+(this.touchMove?c.touches[0].pageY:c.pageY)+"px"}elementRowDrop(c,s,l){this.dispatchExternal("movableRowsElementDrop",c,s,!!l&&l.getComponent())}connectToTables(c){var s;this.connectionSelectorsTables&&(s=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStart",s),this.commsSend(this.connectionSelectorsTables,"moveRow","connect",{row:c})),this.connectionSelectorsElements&&(this.connectionElements=[],Array.isArray(this.connectionSelectorsElements)||(this.connectionSelectorsElements=[this.connectionSelectorsElements]),this.connectionSelectorsElements.forEach(l=>{"string"==typeof l?this.connectionElements=this.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(l))):this.connectionElements.push(l)}),this.connectionElements.forEach(l=>{var u=g=>{this.elementRowDrop(g,l,this.moving)};l.addEventListener("mouseup",u),l.tabulatorElementDropEvent=u,l.classList.add("tabulator-movingrow-receiving")}))}disconnectFromTables(){var c;this.connectionSelectorsTables&&(c=this.commsConnections(this.connectionSelectorsTables),this.dispatchExternal("movableRowsSendingStop",c),this.commsSend(this.connectionSelectorsTables,"moveRow","disconnect")),this.connectionElements.forEach(s=>{s.classList.remove("tabulator-movingrow-receiving"),s.removeEventListener("mouseup",s.tabulatorElementDropEvent),delete s.tabulatorElementDropEvent})}connect(c,s){return this.connectedTable?(console.warn("Move Row Error - Table cannot accept connection, already connected to table:",this.connectedTable),!1):(this.connectedTable=c,this.connectedRow=s,this.table.element.classList.add("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(l=>{"row"===l.type&&l.modules.moveRow&&l.modules.moveRow.mouseup&&l.getElement().addEventListener("mouseup",l.modules.moveRow.mouseup)}),this.tableRowDropEvent=this.tableRowDrop.bind(this),this.table.element.addEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStart",s,c),!0)}disconnect(c){c===this.connectedTable?(this.connectedTable=!1,this.connectedRow=!1,this.table.element.classList.remove("tabulator-movingrow-receiving"),this.table.rowManager.getDisplayRows().forEach(s=>{"row"===s.type&&s.modules.moveRow&&s.modules.moveRow.mouseup&&s.getElement().removeEventListener("mouseup",s.modules.moveRow.mouseup)}),this.table.element.removeEventListener("mouseup",this.tableRowDropEvent),this.dispatchExternal("movableRowsReceivingStop",c)):console.warn("Move Row Error - trying to disconnect from non connected table")}dropComplete(c,s,l){var u=!1;if(l){switch(typeof this.table.options.movableRowsSender){case"string":u=this.senders[this.table.options.movableRowsSender];break;case"function":u=this.table.options.movableRowsSender}u?u.call(this,this.moving.getComponent(),s?s.getComponent():void 0,c):this.table.options.movableRowsSender&&console.warn("Mover Row Error - no matching sender found:",this.table.options.movableRowsSender),this.dispatchExternal("movableRowsSent",this.moving.getComponent(),s?s.getComponent():void 0,c)}else this.dispatchExternal("movableRowsSentFailed",this.moving.getComponent(),s?s.getComponent():void 0,c);this.endMove()}tableRowDrop(c,s){var l=!1,u=!1;switch(c.stopImmediatePropagation(),typeof this.table.options.movableRowsReceiver){case"string":l=this.receivers[this.table.options.movableRowsReceiver];break;case"function":l=this.table.options.movableRowsReceiver}l?u=l.call(this,this.connectedRow.getComponent(),s?s.getComponent():void 0,this.connectedTable):console.warn("Mover Row Error - no matching receiver found:",this.table.options.movableRowsReceiver),this.dispatchExternal(u?"movableRowsReceived":"movableRowsReceivedFailed",this.connectedRow.getComponent(),s?s.getComponent():void 0,this.connectedTable),this.commsSend(this.connectedTable,"moveRow","dropcomplete",{row:s,success:u})}commsReceived(c,s,l){switch(s){case"connect":return this.connect(c,l.row);case"disconnect":return this.disconnect(c);case"dropcomplete":return this.dropComplete(c,l.row,l.success)}}}Fd.prototype.receivers={insert:function(v,c,s){return this.table.addRow(v.getData(),void 0,c),!0},add:function(v,c,s){return this.table.addRow(v.getData()),!0},update:function(v,c,s){return!!c&&(c.update(v.getData()),!0)},replace:function(v,c,s){return!!c&&(this.table.addRow(v.getData(),void 0,c),c.delete(),!0)}},Fd.prototype.senders={delete:function(v,c,s){v.delete()}},Fd.moduleName="moveRow";var Zf={};let Qf=(()=>{class v extends vr{constructor(s){super(s),this.allowedTypes=["","data","edit","clipboard"],this.enabled=!0,this.registerColumnOption("mutator"),this.registerColumnOption("mutatorParams"),this.registerColumnOption("mutatorData"),this.registerColumnOption("mutatorDataParams"),this.registerColumnOption("mutatorEdit"),this.registerColumnOption("mutatorEditParams"),this.registerColumnOption("mutatorClipboard"),this.registerColumnOption("mutatorClipboardParams")}initialize(){this.subscribe("cell-value-changing",this.transformCell.bind(this)),this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("row-data-init-before",this.rowDataChanged.bind(this)),this.subscribe("row-data-changing",this.rowDataChanged.bind(this))}rowDataChanged(s,l,u){return this.transformRow(l,"data",u)}initializeColumn(s){var l=!1,u={};this.allowedTypes.forEach(g=>{var w,b="mutator"+(g.charAt(0).toUpperCase()+g.slice(1));s.definition[b]&&(w=this.lookupMutator(s.definition[b]))&&(l=!0,u[b]={mutator:w,params:s.definition[b+"Params"]||{}})}),l&&(s.modules.mutate=u)}lookupMutator(s){var l=!1;switch(typeof s){case"string":v.mutators[s]?l=v.mutators[s]:console.warn("Mutator Error - No such mutator found, ignoring: ",s);break;case"function":l=s}return l}transformRow(s,l,u){var b,g="mutator"+(l.charAt(0).toUpperCase()+l.slice(1));return this.enabled&&this.table.columnManager.traverse(w=>{var k,H,Z;w.modules.mutate&&(k=w.modules.mutate[g]||w.modules.mutate.mutator||!1)&&(b=w.getFieldValue(void 0!==u?u:s),("data"==l||void 0!==b)&&(Z=w.getComponent(),H="function"==typeof k.params?k.params(b,s,l,Z):k.params,w.setFieldValue(s,k.mutator(b,s,l,H,Z))))}),s}transformCell(s,l){if(s.column.modules.mutate){var u=s.column.modules.mutate.mutatorEdit||s.column.modules.mutate.mutator||!1,g={};if(u)return g=Object.assign(g,s.row.getData()),s.column.setFieldValue(g,l),u.mutator(l,g,"edit",u.params,s.getComponent())}return l}enable(){this.enabled=!0}disable(){this.enabled=!1}}return v.moduleName="mutator",v.mutators=Zf,v})(),pp=(()=>{class v extends vr{constructor(s){super(s),this.mode="local",this.progressiveLoad=!1,this.size=0,this.page=1,this.count=5,this.max=1,this.displayIndex=0,this.initialLoad=!0,this.dataChanging=!1,this.pageSizes=[],this.dataReceivedNames={},this.dataSentNames={},this.registerTableOption("pagination",!1),this.registerTableOption("paginationMode","local"),this.registerTableOption("paginationSize",!1),this.registerTableOption("paginationInitialPage",1),this.registerTableOption("paginationButtonCount",5),this.registerTableOption("paginationSizeSelector",!1),this.registerTableOption("paginationElement",!1),this.registerTableOption("paginationAddRow","page"),this.registerTableOption("progressiveLoad",!1),this.registerTableOption("progressiveLoadDelay",0),this.registerTableOption("progressiveLoadScrollMargin",0),this.registerTableFunction("setMaxPage",this.setMaxPage.bind(this)),this.registerTableFunction("setPage",this.setPage.bind(this)),this.registerTableFunction("setPageToRow",this.userSetPageToRow.bind(this)),this.registerTableFunction("setPageSize",this.userSetPageSize.bind(this)),this.registerTableFunction("getPageSize",this.getPageSize.bind(this)),this.registerTableFunction("previousPage",this.previousPage.bind(this)),this.registerTableFunction("nextPage",this.nextPage.bind(this)),this.registerTableFunction("getPage",this.getPage.bind(this)),this.registerTableFunction("getPageMax",this.getPageMax.bind(this)),this.registerComponentFunction("row","pageTo",this.setPageToRow.bind(this))}initialize(){this.table.options.pagination?(this.subscribe("row-deleted",this.rowsUpdated.bind(this)),this.subscribe("row-adding-position",this.rowAddingPosition.bind(this)),this.subscribe("row-added",this.rowsUpdated.bind(this)),this.subscribe("data-processed",this.initialLoadComplete.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),"remote"===this.table.options.paginationMode&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this))),this.table.options.progressiveLoad&&console.error("Progressive Load Error - Pagination and progressive load cannot be used at the same time"),this.registerDisplayHandler(this.restOnRenderBefore.bind(this),40),this.registerDisplayHandler(this.getRows.bind(this),50),this.createElements(),this.initializePaginator()):this.table.options.progressiveLoad&&(this.subscribe("data-params",this.remotePageParams.bind(this)),this.subscribe("data-loaded",this._parseRemoteData.bind(this)),this.subscribe("table-built",this.calculatePageSizes.bind(this)),this.initializeProgressive(this.table.options.progressiveLoad),"scroll"===this.table.options.progressiveLoad&&this.subscribe("scroll-vertical",this.scrollVertical.bind(this)))}rowAddingPosition(s,l){var b,u=this.table.rowManager,g=u.getDisplayRows();return l?g.length?b=g[0]:u.activeRows.length&&(b=u.activeRows[u.activeRows.length-1],l=!1):g.length&&(b=g[g.length-1],l=!(g.length<this.size)),{index:b,top:l}}calculatePageSizes(){var s,l;this.table.options.paginationSize?this.size=this.table.options.paginationSize:((s=document.createElement("div")).classList.add("tabulator-row"),s.style.visibility="hidden",(l=document.createElement("div")).classList.add("tabulator-cell"),l.innerHTML="Page Row Test",s.appendChild(l),this.table.rowManager.getTableElement().appendChild(s),this.size=Math.floor(this.table.rowManager.getElement().clientHeight/s.offsetHeight),this.table.rowManager.getTableElement().removeChild(s)),this.generatePageSizeSelectList()}initialLoadComplete(){this.initialLoad=!1}remotePageParams(s,l,u,g){return this.initialLoad||(this.progressiveLoad&&!u||!this.progressiveLoad&&!this.dataChanging)&&this.reset(!0),g.page=this.page,this.size&&(g.size=this.size),g}userSetPageToRow(s){return this.table.options.pagination&&(s=this.rowManager.findRow(s))?this.setPageToRow(s):Promise.reject()}userSetPageSize(s){return!!this.table.options.pagination&&(this.setPageSize(s),this.setPage(1))}scrollVertical(s,l){var u;!l&&!this.table.dataLoader.loading&&(u=this.table.rowManager.getElement()).scrollHeight-u.clientHeight-s<(this.table.options.progressiveLoadScrollMargin||2*u.clientHeight)&&this.nextPage()}restOnRenderBefore(s,l){return l||"local"===this.mode&&this.reset(),s}rowsUpdated(){this.refreshData(!0,"all")}createElements(){var s;this.element=document.createElement("span"),this.element.classList.add("tabulator-paginator"),this.pagesElement=document.createElement("span"),this.pagesElement.classList.add("tabulator-pages"),(s=document.createElement("button")).classList.add("tabulator-page"),s.setAttribute("type","button"),s.setAttribute("role","button"),s.setAttribute("aria-label",""),s.setAttribute("title",""),this.firstBut=s.cloneNode(!0),this.firstBut.setAttribute("data-page","first"),this.prevBut=s.cloneNode(!0),this.prevBut.setAttribute("data-page","prev"),this.nextBut=s.cloneNode(!0),this.nextBut.setAttribute("data-page","next"),this.lastBut=s.cloneNode(!0),this.lastBut.setAttribute("data-page","last"),this.table.options.paginationSizeSelector&&(this.pageSizeSelect=document.createElement("select"),this.pageSizeSelect.classList.add("tabulator-page-size"))}generatePageSizeSelectList(){var s=[];if(this.pageSizeSelect){if(Array.isArray(this.table.options.paginationSizeSelector))this.pageSizes=s=this.table.options.paginationSizeSelector,-1==this.pageSizes.indexOf(this.size)&&s.unshift(this.size);else if(-1==this.pageSizes.indexOf(this.size)){s=[];for(let l=1;l<5;l++)s.push(this.size*l);this.pageSizes=s}else s=this.pageSizes;for(;this.pageSizeSelect.firstChild;)this.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);s.forEach(l=>{var u=document.createElement("option");u.value=l,!0===l?this.langBind("pagination|all",function(g){u.innerHTML=g}):u.innerHTML=l,this.pageSizeSelect.appendChild(u)}),this.pageSizeSelect.value=this.size}}initializePaginator(s){var l;s||(this.langBind("pagination|first",u=>{this.firstBut.innerHTML=u}),this.langBind("pagination|first_title",u=>{this.firstBut.setAttribute("aria-label",u),this.firstBut.setAttribute("title",u)}),this.langBind("pagination|prev",u=>{this.prevBut.innerHTML=u}),this.langBind("pagination|prev_title",u=>{this.prevBut.setAttribute("aria-label",u),this.prevBut.setAttribute("title",u)}),this.langBind("pagination|next",u=>{this.nextBut.innerHTML=u}),this.langBind("pagination|next_title",u=>{this.nextBut.setAttribute("aria-label",u),this.nextBut.setAttribute("title",u)}),this.langBind("pagination|last",u=>{this.lastBut.innerHTML=u}),this.langBind("pagination|last_title",u=>{this.lastBut.setAttribute("aria-label",u),this.lastBut.setAttribute("title",u)}),this.firstBut.addEventListener("click",()=>{this.setPage(1)}),this.prevBut.addEventListener("click",()=>{this.previousPage()}),this.nextBut.addEventListener("click",()=>{this.nextPage()}),this.lastBut.addEventListener("click",()=>{this.setPage(this.max)}),this.table.options.paginationElement&&(this.element=this.table.options.paginationElement),this.pageSizeSelect&&(l=document.createElement("label"),this.langBind("pagination|page_size",u=>{this.pageSizeSelect.setAttribute("aria-label",u),this.pageSizeSelect.setAttribute("title",u),l.innerHTML=u}),this.element.appendChild(l),this.element.appendChild(this.pageSizeSelect),this.pageSizeSelect.addEventListener("change",u=>{this.setPageSize("true"==this.pageSizeSelect.value||this.pageSizeSelect.value),this.setPage(1)})),this.element.appendChild(this.firstBut),this.element.appendChild(this.prevBut),this.element.appendChild(this.pagesElement),this.element.appendChild(this.nextBut),this.element.appendChild(this.lastBut),!this.table.options.paginationElement&&!s&&this.table.footerManager.append(this.element,this),this.page=this.table.options.paginationInitialPage,this.count=this.table.options.paginationButtonCount),this.mode=this.table.options.paginationMode}initializeProgressive(s){this.initializePaginator(!0),this.mode="progressive_"+s,this.progressiveLoad=!0}trackChanges(){this.dispatch("page-changed")}setDisplayIndex(s){this.displayIndex=s}getDisplayIndex(){return this.displayIndex}setMaxRows(s){this.max=s?!0===this.size?1:Math.ceil(s/this.size):1,this.page>this.max&&(this.page=this.max)}reset(s){this.initialLoad||("local"==this.mode||s)&&(this.page=1)}setMaxPage(s){s=parseInt(s),this.max=s||1,this.page>this.max&&(this.page=this.max,this.trigger())}setPage(s){switch(s){case"first":return this.setPage(1);case"prev":return this.previousPage();case"next":return this.nextPage();case"last":return this.setPage(this.max)}return(s=parseInt(s))>0&&s<=this.max||"local"!==this.mode?(this.page=s,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Requested page is out of range of 1 - "+this.max+":",s),Promise.reject())}setPageToRow(s){var u=this.table.rowManager.getDisplayRows(this.displayIndex-1).indexOf(s);if(u>-1){var g=!0===this.size?1:Math.ceil((u+1)/this.size);return this.setPage(g)}return console.warn("Pagination Error - Requested row is not visible"),Promise.reject()}setPageSize(s){!0!==s&&(s=parseInt(s)),s>0&&(this.size=s),this.pageSizeSelect&&this.generatePageSizeSelectList(),this.trackChanges()}_setPageButtons(){let s=Math.floor((this.count-1)/2),l=Math.ceil((this.count-1)/2),u=this.max-this.page+s+1<this.count?this.max-this.count+1:Math.max(this.page-s,1),g=this.page<=l?Math.min(this.count,this.max):Math.min(this.page+l,this.max);for(;this.pagesElement.firstChild;)this.pagesElement.removeChild(this.pagesElement.firstChild);1==this.page?(this.firstBut.disabled=!0,this.prevBut.disabled=!0):(this.firstBut.disabled=!1,this.prevBut.disabled=!1),this.page==this.max?(this.lastBut.disabled=!0,this.nextBut.disabled=!0):(this.lastBut.disabled=!1,this.nextBut.disabled=!1);for(let b=u;b<=g;b++)b>0&&b<=this.max&&this.pagesElement.appendChild(this._generatePageButton(b));this.footerRedraw()}_generatePageButton(s){var l=document.createElement("button");return l.classList.add("tabulator-page"),s==this.page&&l.classList.add("active"),l.setAttribute("type","button"),l.setAttribute("role","button"),this.langBind("pagination|page_title",u=>{l.setAttribute("aria-label",u+" "+s),l.setAttribute("title",u+" "+s)}),l.setAttribute("data-page",s),l.textContent=s,l.addEventListener("click",u=>{this.setPage(s)}),l}previousPage(){return this.page>1?(this.page--,this.trackChanges(),this.trigger()):(console.warn("Pagination Error - Previous page would be less than page 1:",0),Promise.reject())}nextPage(){return this.page<this.max?(this.page++,this.trackChanges(),this.trigger()):(this.progressiveLoad||console.warn("Pagination Error - Next page would be greater than maximum page of "+this.max+":",this.max+1),Promise.reject())}getPage(){return this.page}getPageMax(){return this.max}getPageSize(s){return this.size}getMode(){return this.mode}getRows(s){var l,u,g;if("local"==this.mode){l=[],this.setMaxRows(s.length),!0===this.size?(u=0,g=s.length):g=(u=this.size*(this.page-1))+parseInt(this.size),this._setPageButtons();for(let b=u;b<g;b++)s[b]&&l.push(s[b]);return l}return this._setPageButtons(),s.slice(0)}trigger(){var s;switch(this.mode){case"local":return s=this.table.rowManager.scrollLeft,this.refreshData(),this.table.rowManager.scrollHorizontal(s),this.dispatchExternal("pageLoaded",this.getPage()),Promise.resolve();case"remote":return this.dataChanging=!0,this.reloadData(null).finally(()=>{this.dataChanging=!1});case"progressive_load":case"progressive_scroll":return this.reloadData(null,!0);default:return console.warn("Pagination Error - no such pagination mode:",this.mode),Promise.reject()}}_parseRemoteData(l){if(void 0===l.last_page&&console.warn("Remote Pagination Error - Server response missing '"+this.dataReceivedNames.last_page+"' property"),l.data){if(this.max=parseInt(l.last_page)||1,this.progressiveLoad){switch(this.mode){case"progressive_load":1==this.page?this.table.rowManager.setData(l.data,!1,1==this.page):this.table.rowManager.addRows(l.data),this.page<this.max&&setTimeout(()=>{this.nextPage()},this.table.options.progressiveLoadDelay);break;case"progressive_scroll":l=this.table.rowManager.getData().concat(l.data),this.table.rowManager.setData(l,1!==this.page,1==this.page),this.table.rowManager.element.scrollHeight<=this.table.rowManager.element.clientHeight+(this.table.options.progressiveLoadScrollMargin||2*this.table.rowManager.element.clientHeight)&&setTimeout(()=>{this.nextPage()})}return!1}this.dispatchExternal("pageLoaded",this.getPage())}else console.warn("Remote Pagination Error - Server response missing '"+this.dataReceivedNames.data+"' property");return l.data}footerRedraw(){var s=this.table.footerManager.element;Math.ceil(s.clientWidth)-s.scrollWidth<0?this.pagesElement.style.display="none":(this.pagesElement.style.display="",Math.ceil(s.clientWidth)-s.scrollWidth<0&&(this.pagesElement.style.display="none"))}}return v.moduleName="page",v})();var qf={local:function(v,c){var s=localStorage.getItem(v+"-"+c);return!!s&&JSON.parse(s)},cookie:function(v,c){var g,b,s=document.cookie,l=v+"-"+c,u=s.indexOf(l+"=");return u>-1&&((g=(s=s.substr(u)).indexOf(";"))>-1&&(s=s.substr(0,g)),b=s.replace(l+"=","")),!!b&&JSON.parse(b)}},tg={local:function(v,c,s){localStorage.setItem(v+"-"+c,JSON.stringify(s))},cookie:function(v,c,s){var l=new Date;l.setDate(l.getDate()+1e4),document.cookie=v+"-"+c+"="+JSON.stringify(s)+"; expires="+l.toUTCString()}};let Bd=(()=>{class v extends vr{constructor(s){super(s),this.mode="",this.id="",this.defWatcherBlock=!1,this.config={},this.readFunc=!1,this.writeFunc=!1,this.registerTableOption("persistence",!1),this.registerTableOption("persistenceID",""),this.registerTableOption("persistenceMode",!0),this.registerTableOption("persistenceReaderFunc",!1),this.registerTableOption("persistenceWriterFunc",!1)}localStorageTest(){var s="_tabulator_test";try{return window.localStorage.setItem(s,s),window.localStorage.removeItem(s),!0}catch(l){return!1}}initialize(){if(this.table.options.persistence){var u,s=this.table.options.persistenceMode,l=this.table.options.persistenceID;this.mode=!0!==s?s:this.localStorageTest()?"local":"cookie",this.table.options.persistenceReaderFunc?"function"==typeof this.table.options.persistenceReaderFunc?this.readFunc=this.table.options.persistenceReaderFunc:v.readers[this.table.options.persistenceReaderFunc]?this.readFunc=v.readers[this.table.options.persistenceReaderFunc]:console.warn("Persistence Read Error - invalid reader set",this.table.options.persistenceReaderFunc):v.readers[this.mode]?this.readFunc=v.readers[this.mode]:console.warn("Persistence Read Error - invalid reader set",this.mode),this.table.options.persistenceWriterFunc?"function"==typeof this.table.options.persistenceWriterFunc?this.writeFunc=this.table.options.persistenceWriterFunc:v.writers[this.table.options.persistenceWriterFunc]?this.writeFunc=v.writers[this.table.options.persistenceWriterFunc]:console.warn("Persistence Write Error - invalid reader set",this.table.options.persistenceWriterFunc):v.writers[this.mode]?this.writeFunc=v.writers[this.mode]:console.warn("Persistence Write Error - invalid writer set",this.mode),this.id="tabulator-"+(l||this.table.element.getAttribute("id")||""),this.config={sort:!0===this.table.options.persistence||this.table.options.persistence.sort,filter:!0===this.table.options.persistence||this.table.options.persistence.filter,group:!0===this.table.options.persistence||this.table.options.persistence.group,page:!0===this.table.options.persistence||this.table.options.persistence.page,columns:!0===this.table.options.persistence?["title","width","visible"]:this.table.options.persistence.columns},this.config.page&&(u=this.retreiveData("page"))&&(void 0!==u.paginationSize&&(!0===this.config.page||this.config.page.size)&&(this.table.options.paginationSize=u.paginationSize),void 0!==u.paginationInitialPage&&(!0===this.config.page||this.config.page.page)&&(this.table.options.paginationInitialPage=u.paginationInitialPage)),this.config.group&&(u=this.retreiveData("group"))&&(void 0!==u.groupBy&&(!0===this.config.group||this.config.group.groupBy)&&(this.table.options.groupBy=u.groupBy),void 0!==u.groupStartOpen&&(!0===this.config.group||this.config.group.groupStartOpen)&&(this.table.options.groupStartOpen=u.groupStartOpen),void 0!==u.groupHeader&&(!0===this.config.group||this.config.group.groupHeader)&&(this.table.options.groupHeader=u.groupHeader)),this.config.columns&&(this.table.options.columns=this.load("columns",this.table.options.columns),this.subscribe("column-init",this.initializeColumn.bind(this)),this.subscribe("column-show",this.save.bind(this,"columns")),this.subscribe("column-hide",this.save.bind(this,"columns")),this.subscribe("column-moved",this.save.bind(this,"columns")),this.subscribe("table-built",this.tableBuilt.bind(this),0)),this.subscribe("table-redraw",this.tableRedraw.bind(this)),this.subscribe("filter-changed",this.eventSave.bind(this,"filter")),this.subscribe("sort-changed",this.eventSave.bind(this,"sort")),this.subscribe("group-changed",this.eventSave.bind(this,"group")),this.subscribe("page-changed",this.eventSave.bind(this,"page")),this.subscribe("column-resized",this.eventSave.bind(this,"columns")),this.subscribe("layout-refreshed",this.eventSave.bind(this,"columns"))}this.registerTableFunction("getColumnLayout",this.getColumnLayout.bind(this)),this.registerTableFunction("setColumnLayout",this.setColumnLayout.bind(this))}eventSave(s){this.config[s]&&this.save(s)}tableBuilt(){var l,u;this.config.sort&&(l=this.load("sort"))&&(this.table.initialSort=l),this.config.filter&&(u=this.load("filter"))&&(this.table.initialFilter=u)}tableRedraw(s){s&&this.config.columns&&this.save("columns")}getColumnLayout(){return this.parseColumns(this.table.columnManager.getColumns())}setColumnLayout(s){return this.table.columnManager.setColumns(this.mergeDefinition(this.table.options.columns,s)),!0}initializeColumn(s){var l;this.config.columns&&(this.defWatcherBlock=!0,l=s.getDefinition(),(!0===this.config.columns?Object.keys(l):this.config.columns).forEach(g=>{var b=Object.getOwnPropertyDescriptor(l,g),w=l[g];b&&Object.defineProperty(l,g,{set:function(k){w=k,this.defWatcherBlock||this.save("columns"),b.set&&b.set(k)},get:function(){return b.get&&b.get(),w}})}),this.defWatcherBlock=!1)}load(s,l){var u=this.retreiveData(s);return l&&(u=u?this.mergeDefinition(l,u):l),u}retreiveData(s){return!!this.readFunc&&this.readFunc(this.id,s)}mergeDefinition(s,l){var u=[];return(l=l||[]).forEach((g,b)=>{var k,w=this._findColumn(s,g);w&&(!0===this.config.columns||null==this.config.columns?(k=Object.keys(w)).push("width"):k=this.config.columns,k.forEach(H=>{"columns"!==H&&void 0!==g[H]&&(w[H]=g[H])}),w.columns&&(w.columns=this.mergeDefinition(w.columns,g.columns)),u.push(w))}),s.forEach((g,b)=>{this._findColumn(l,g)||(u.length>b?u.splice(b,0,g):u.push(g))}),u}_findColumn(s,l){var u=l.columns?"group":l.field?"field":"object";return s.find(function(g){switch(u){case"group":return g.title===l.title&&g.columns.length===l.columns.length;case"field":return g.field===l.field;case"object":return g===l}})}save(s){var l={};switch(s){case"columns":l=this.parseColumns(this.table.columnManager.getColumns());break;case"filter":l=this.table.modules.filter.getFilters();break;case"sort":l=this.validateSorters(this.table.modules.sort.getSort());break;case"group":l=this.getGroupConfig();break;case"page":l=this.getPageConfig()}this.writeFunc&&this.writeFunc(this.id,s,l)}validateSorters(s){return s.forEach(function(l){l.column=l.field,delete l.field}),s}getGroupConfig(){var s={};return this.config.group&&((!0===this.config.group||this.config.group.groupBy)&&(s.groupBy=this.table.options.groupBy),(!0===this.config.group||this.config.group.groupStartOpen)&&(s.groupStartOpen=this.table.options.groupStartOpen),(!0===this.config.group||this.config.group.groupHeader)&&(s.groupHeader=this.table.options.groupHeader)),s}getPageConfig(){var s={};return this.config.page&&((!0===this.config.page||this.config.page.size)&&(s.paginationSize=this.table.modules.page.getPageSize()),(!0===this.config.page||this.config.page.page)&&(s.paginationInitialPage=this.table.modules.page.getPage())),s}parseColumns(s){var l=[],u=["headerContextMenu","headerMenu","contextMenu","clickMenu"];return s.forEach(g=>{var k,b={},w=g.getDefinition();g.isGroup?(b.title=w.title,b.columns=this.parseColumns(g.getColumns())):(b.field=g.getField(),!0===this.config.columns||null==this.config.columns?(k=Object.keys(w)).push("width"):k=this.config.columns,k.forEach(H=>{switch(H){case"width":b.width=g.getWidth();break;case"visible":b.visible=g.visible;break;default:"function"!=typeof w[H]&&-1===u.indexOf(H)&&(b[H]=w[H])}})),l.push(b)}),l}}return v.moduleName="persistence",v.readers=qf,v.writers=tg,v})(),fp=(()=>{class v extends vr{constructor(s){super(s),this.element=!1,this.manualBlock=!1,this.registerTableOption("printAsHtml",!1),this.registerTableOption("printFormatter",!1),this.registerTableOption("printHeader",!1),this.registerTableOption("printFooter",!1),this.registerTableOption("printStyled",!0),this.registerTableOption("printRowRange","visible"),this.registerTableOption("printConfig",{}),this.registerColumnOption("print"),this.registerColumnOption("titlePrint")}initialize(){this.table.options.printAsHtml&&(window.addEventListener("beforeprint",this.replaceTable.bind(this)),window.addEventListener("afterprint",this.cleanup.bind(this))),this.registerTableFunction("print",this.printFullscreen.bind(this))}replaceTable(){this.manualBlock||(this.element=document.createElement("div"),this.element.classList.add("tabulator-print-table"),this.element.appendChild(this.table.modules.export.genereateTable(this.table.options.printConfig,this.table.options.printStyled,this.table.options.printRowRange,"print")),this.table.element.style.display="none",this.table.element.parentNode.insertBefore(this.element,this.table.element))}cleanup(){document.body.classList.remove("tabulator-print-fullscreen-hide"),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.table.element.style.display="")}printFullscreen(s,l,u){var Z,ht,g=window.scrollX,b=window.scrollY,w=document.createElement("div"),k=document.createElement("div"),H=this.table.modules.export.genereateTable(void 0!==u?u:this.table.options.printConfig,void 0!==l?l:this.table.options.printStyled,s||this.table.options.printRowRange,"print");this.manualBlock=!0,this.element=document.createElement("div"),this.element.classList.add("tabulator-print-fullscreen"),this.table.options.printHeader&&(w.classList.add("tabulator-print-header"),"string"==typeof(Z="function"==typeof this.table.options.printHeader?this.table.options.printHeader.call(this.table):this.table.options.printHeader)?w.innerHTML=Z:w.appendChild(Z),this.element.appendChild(w)),this.element.appendChild(H),this.table.options.printFooter&&(k.classList.add("tabulator-print-footer"),"string"==typeof(ht="function"==typeof this.table.options.printFooter?this.table.options.printFooter.call(this.table):this.table.options.printFooter)?k.innerHTML=ht:k.appendChild(ht),this.element.appendChild(k)),document.body.classList.add("tabulator-print-fullscreen-hide"),document.body.appendChild(this.element),this.table.options.printFormatter&&this.table.options.printFormatter(this.element,H),window.print(),this.cleanup(),window.scrollTo(g,b),this.manualBlock=!1}}return v.moduleName="print",v})(),eg=(()=>{class v extends vr{constructor(s){super(s),this.data=!1,this.blocked=!1,this.origFuncs={},this.currentVersion=0,this.registerTableOption("reactiveData",!1)}initialize(){this.table.options.reactiveData&&(this.subscribe("cell-value-save-before",this.block.bind(this)),this.subscribe("cell-value-save-after",this.unblock.bind(this)),this.subscribe("row-data-save-before",this.block.bind(this)),this.subscribe("row-data-save-after",this.unblock.bind(this)),this.subscribe("row-data-init-after",this.watchRow.bind(this)),this.subscribe("data-processing",this.watchData.bind(this)),this.subscribe("table-destroy",this.unwatchData.bind(this)))}watchData(s){var u,l=this;this.currentVersion++,u=this.currentVersion,this.unwatchData(),this.data=s,this.origFuncs.push=s.push,Object.defineProperty(this.data,"push",{enumerable:!1,configurable:!0,value:function(){var g=Array.from(arguments);return!l.blocked&&u===l.currentVersion&&g.forEach(b=>{l.table.rowManager.addRowActual(b,!1)}),l.origFuncs.push.apply(s,arguments)}}),this.origFuncs.unshift=s.unshift,Object.defineProperty(this.data,"unshift",{enumerable:!1,configurable:!0,value:function(){var g=Array.from(arguments);return!l.blocked&&u===l.currentVersion&&g.forEach(b=>{l.table.rowManager.addRowActual(b,!0)}),l.origFuncs.unshift.apply(s,arguments)}}),this.origFuncs.shift=s.shift,Object.defineProperty(this.data,"shift",{enumerable:!1,configurable:!0,value:function(){var g;return!l.blocked&&u===l.currentVersion&&l.data.length&&(g=l.table.rowManager.getRowFromDataObject(l.data[0]))&&g.deleteActual(),l.origFuncs.shift.call(s)}}),this.origFuncs.pop=s.pop,Object.defineProperty(this.data,"pop",{enumerable:!1,configurable:!0,value:function(){var g;return!l.blocked&&u===l.currentVersion&&l.data.length&&(g=l.table.rowManager.getRowFromDataObject(l.data[l.data.length-1]))&&g.deleteActual(),l.origFuncs.pop.call(s)}}),this.origFuncs.splice=s.splice,Object.defineProperty(this.data,"splice",{enumerable:!1,configurable:!0,value:function(){var H,g=Array.from(arguments),b=g[0]<0?s.length+g[0]:g[0],w=g[1],k=!!g[2]&&g.slice(2);if(!l.blocked&&u===l.currentVersion){if(k&&((H=!!s[b]&&l.table.rowManager.getRowFromDataObject(s[b]))?k.forEach(ht=>{l.table.rowManager.addRowActual(ht,!0,H,!0)}):(k=k.slice().reverse()).forEach(ht=>{l.table.rowManager.addRowActual(ht,!0,!1,!0)})),0!==w){var Z=s.slice(b,void 0===g[1]?g[1]:b+w);Z.forEach((ht,Pt)=>{var qt=l.table.rowManager.getRowFromDataObject(ht);qt&&qt.deleteActual(Pt!==Z.length-1)})}(k||0!==w)&&l.table.rowManager.reRenderInPosition()}return l.origFuncs.splice.apply(s,arguments)}})}unwatchData(){if(!1!==this.data)for(var s in this.origFuncs)Object.defineProperty(this.data,s,{enumerable:!0,configurable:!0,writable:!0,value:this.origFuncs.key})}watchRow(s){var l=s.getData();for(var u in this.blocked=!0,l)this.watchKey(s,l,u);this.table.options.dataTree&&this.watchTreeChildren(s),this.blocked=!1}watchTreeChildren(s){var l=s.getData()[this.table.options.dataTreeChildField],u={};function g(){this.table.modules.dataTree.initializeRow(s),this.table.modules.dataTree.layoutRow(s),this.table.rowManager.refreshActiveData("tree",!1,!0)}l&&(u.push=l.push,Object.defineProperty(l,"push",{enumerable:!1,configurable:!0,value:()=>{var b=u.push.apply(l,arguments);return g(),b}}),u.unshift=l.unshift,Object.defineProperty(l,"unshift",{enumerable:!1,configurable:!0,value:()=>{var b=u.unshift.apply(l,arguments);return g(),b}}),u.shift=l.shift,Object.defineProperty(l,"shift",{enumerable:!1,configurable:!0,value:()=>{var b=u.shift.call(l);return g(),b}}),u.pop=l.pop,Object.defineProperty(l,"pop",{enumerable:!1,configurable:!0,value:()=>{var b=u.pop.call(l);return g(),b}}),u.splice=l.splice,Object.defineProperty(l,"splice",{enumerable:!1,configurable:!0,value:()=>{var b=u.splice.apply(l,arguments);return g(),b}}))}watchKey(s,l,u){var g=Object.getOwnPropertyDescriptor(l,u),b=l[u],w=this.currentVersion;Object.defineProperty(l,u,{set:k=>{if(b=k,!this.blocked&&w===this.currentVersion){var H={};H[u]=k,s.updateData(H)}g.set&&g.set(k)},get:()=>(g.get&&g.get(),b)})}unwatchRow(s){var l=s.getData();for(var u in l)Object.defineProperty(l,u,{value:l[u]})}block(){this.blocked=!0}unblock(){this.blocked=!1}}return v.moduleName="reactiveData",v})(),gp=(()=>{class v extends vr{constructor(s){super(s),this.startColumn=!1,this.startX=!1,this.startWidth=!1,this.handle=null,this.prevHandle=null,this.registerColumnOption("resizable",!0)}initialize(){this.subscribe("cell-layout",this.layoutCellHandles.bind(this)),this.subscribe("column-init",this.layoutColumnHeader.bind(this))}layoutCellHandles(s){"row"===s.row.type&&this.initializeColumn("cell",s.column,s.element)}layoutColumnHeader(s){this.initializeColumn("header",s,s.element)}initializeColumn(s,l,u){var g=this,w=l.definition.resizable;if("header"===s&&(l.modules.resize={variableHeight:"textarea"==l.definition.formatter||l.definition.variableHeight}),!0===w||w==s){var k=document.createElement("div");k.className="tabulator-col-resize-handle";var H=document.createElement("div");H.className="tabulator-col-resize-handle prev",k.addEventListener("click",function(Pt){Pt.stopPropagation()});var Z=function(Pt){var qt=l.getLastColumn();qt&&g._checkResizability(qt)&&(g.startColumn=l,g._mouseDown(Pt,qt,k))};k.addEventListener("mousedown",Z),k.addEventListener("touchstart",Z,{passive:!0}),k.addEventListener("dblclick",function(Pt){var qt=l.getLastColumn();qt&&g._checkResizability(qt)&&(Pt.stopPropagation(),qt.reinitializeWidth(!0))}),H.addEventListener("click",function(Pt){Pt.stopPropagation()});var ht=function(Pt){var qt,be,Le;(qt=l.getFirstColumn())&&(Le=(be=g.table.columnManager.findColumnIndex(qt))>0&&g.table.columnManager.getColumnByIndex(be-1))&&g._checkResizability(Le)&&(g.startColumn=l,g._mouseDown(Pt,Le,H))};H.addEventListener("mousedown",ht),H.addEventListener("touchstart",ht,{passive:!0}),H.addEventListener("dblclick",function(Pt){var qt,be,Le;(qt=l.getFirstColumn())&&(Le=(be=g.table.columnManager.findColumnIndex(qt))>0&&g.table.columnManager.getColumnByIndex(be-1))&&g._checkResizability(Le)&&(Pt.stopPropagation(),Le.reinitializeWidth(!0))}),u.appendChild(k),u.appendChild(H)}}_checkResizability(s){return s.definition.resizable}_mouseDown(s,l,u){var g=this;function b(k){l.setWidth(g.table.rtl?g.startWidth-((void 0===k.screenX?k.touches[0].screenX:k.screenX)-g.startX):g.startWidth+((void 0===k.screenX?k.touches[0].screenX:k.screenX)-g.startX)),g.table.columnManager.renderer.rerenderColumns(!0),!g.table.browserSlow&&l.modules.resize&&l.modules.resize.variableHeight&&l.checkCellHeights()}function w(k){g.startColumn.modules.edit&&(g.startColumn.modules.edit.blocked=!1),g.table.browserSlow&&l.modules.resize&&l.modules.resize.variableHeight&&l.checkCellHeights(),document.body.removeEventListener("mouseup",w),document.body.removeEventListener("mousemove",b),u.removeEventListener("touchmove",b),u.removeEventListener("touchend",w),g.table.element.classList.remove("tabulator-block-select"),g.dispatch("column-resized",l),g.table.externalEvents.dispatch("columnResized",l.getComponent())}g.table.element.classList.add("tabulator-block-select"),s.stopPropagation(),g.startColumn.modules.edit&&(g.startColumn.modules.edit.blocked=!0),g.startX=void 0===s.screenX?s.touches[0].screenX:s.screenX,g.startWidth=l.getWidth(),document.body.addEventListener("mousemove",b),document.body.addEventListener("mouseup",w),u.addEventListener("touchmove",b,{passive:!0}),u.addEventListener("touchend",w)}}return v.moduleName="resizeColumns",v})(),_p=(()=>{class v extends vr{constructor(s){super(s),this.startColumn=!1,this.startY=!1,this.startHeight=!1,this.handle=null,this.prevHandle=null,this.registerTableOption("resizableRows",!1)}initialize(){this.table.options.resizableRows&&this.subscribe("row-layout-after",this.initializeRow.bind(this))}initializeRow(s){var l=this,u=s.getElement(),g=document.createElement("div");g.className="tabulator-row-resize-handle";var b=document.createElement("div");b.className="tabulator-row-resize-handle prev",g.addEventListener("click",function(H){H.stopPropagation()});var w=function(H){l.startRow=s,l._mouseDown(H,s,g)};g.addEventListener("mousedown",w),g.addEventListener("touchstart",w,{passive:!0}),b.addEventListener("click",function(H){H.stopPropagation()});var k=function(H){var Z=l.table.rowManager.prevDisplayRow(s);Z&&(l.startRow=Z,l._mouseDown(H,Z,b))};b.addEventListener("mousedown",k),b.addEventListener("touchstart",k,{passive:!0}),u.appendChild(g),u.appendChild(b)}_mouseDown(s,l,u){var g=this;function b(k){l.setHeight(g.startHeight+((void 0===k.screenY?k.touches[0].screenY:k.screenY)-g.startY))}function w(k){document.body.removeEventListener("mouseup",b),document.body.removeEventListener("mousemove",b),u.removeEventListener("touchmove",b),u.removeEventListener("touchend",w),g.table.element.classList.remove("tabulator-block-select"),this.dispatchExternal("rowResized",l.getComponent())}g.table.element.classList.add("tabulator-block-select"),s.stopPropagation(),g.startY=void 0===s.screenY?s.touches[0].screenY:s.screenY,g.startHeight=l.getHeight(),document.body.addEventListener("mousemove",b),document.body.addEventListener("mouseup",w),u.addEventListener("touchmove",b,{passive:!0}),u.addEventListener("touchend",w)}}return v.moduleName="resizeRows",v})(),Qp=(()=>{class v extends vr{constructor(s){super(s),this.binding=!1,this.observer=!1,this.containerObserver=!1,this.tableHeight=0,this.tableWidth=0,this.containerHeight=0,this.containerWidth=0,this.autoResize=!1,this.registerTableOption("autoResize",!0)}initialize(){if(this.table.options.autoResize){var l,s=this.table;this.tableHeight=s.element.clientHeight,this.tableWidth=s.element.clientWidth,s.element.parentNode&&(this.containerHeight=s.element.parentNode.clientHeight,this.containerWidth=s.element.parentNode.clientWidth),"undefined"!=typeof ResizeObserver&&"virtual"===s.rowManager.getRenderMode()?(this.autoResize=!0,this.observer=new ResizeObserver(u=>{if(!s.browserMobile||s.browserMobile&&!s.modules.edit.currentCell){var g=Math.floor(u[0].contentRect.height),b=Math.floor(u[0].contentRect.width);(this.tableHeight!=g||this.tableWidth!=b)&&(this.tableHeight=g,this.tableWidth=b,s.element.parentNode&&(this.containerHeight=s.element.parentNode.clientHeight,this.containerWidth=s.element.parentNode.clientWidth),this.table.columnManager.renderer.rerenderColumns(!0),s.redraw())}}),this.observer.observe(s.element),l=window.getComputedStyle(s.element),this.table.element.parentNode&&!this.table.rowManager.fixedHeight&&(l.getPropertyValue("max-height")||l.getPropertyValue("min-height"))&&(this.containerObserver=new ResizeObserver(u=>{if(!s.browserMobile||s.browserMobile&&!s.modules.edit.currentCell){var g=Math.floor(u[0].contentRect.height),b=Math.floor(u[0].contentRect.width);(this.containerHeight!=g||this.containerWidth!=b)&&(this.containerHeight=g,this.containerWidth=b,this.tableHeight=s.element.clientHeight,this.tableWidth=s.element.clientWidth),s.columnManager.renderer.rerenderColumns(!0),s.redraw()}}),this.containerObserver.observe(this.table.element.parentNode)),this.subscribe("table-resize",this.tableResized.bind(this))):(this.binding=function(){(!s.browserMobile||s.browserMobile&&!s.modules.edit.currentCell)&&(s.columnManager.renderer.rerenderColumns(!0),s.redraw())},window.addEventListener("resize",this.binding)),this.subscribe("table-destroy",this.clearBindings.bind(this))}}tableResized(){this.table.rowManager.redraw()}clearBindings(){this.binding&&window.removeEventListener("resize",this.binding),this.observer&&this.observer.unobserve(this.table.element),this.containerObserver&&this.containerObserver.unobserve(this.table.element.parentNode)}}return v.moduleName="resizeTable",v})(),ig=(()=>{class v extends vr{constructor(s){super(s),this.columns=[],this.hiddenColumns=[],this.mode="",this.index=0,this.collapseFormatter=[],this.collapseStartOpen=!0,this.collapseHandleColumn=!1,this.registerTableOption("responsiveLayout",!1),this.registerTableOption("responsiveLayoutCollapseStartOpen",!0),this.registerTableOption("responsiveLayoutCollapseUseFormatters",!0),this.registerTableOption("responsiveLayoutCollapseFormatter",!1),this.registerColumnOption("responsive")}initialize(){this.table.options.responsiveLayout&&(this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("column-show",this.updateColumnVisibility.bind(this)),this.subscribe("column-hide",this.updateColumnVisibility.bind(this)),this.subscribe("columns-loaded",this.initializeResponsivity.bind(this)),this.subscribe("column-moved",this.initializeResponsivity.bind(this)),this.subscribe("column-add",this.initializeResponsivity.bind(this)),this.subscribe("column-delete",this.initializeResponsivity.bind(this)),this.subscribe("table-redrawing",this.tableRedraw.bind(this)),"collapse"===this.table.options.responsiveLayout&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-layout",this.layoutRow.bind(this))))}tableRedraw(s){-1===["fitColumns","fitDataStretch"].indexOf(this.layoutMode())&&(s||this.update())}initializeResponsivity(){var s=[];this.mode=this.table.options.responsiveLayout,this.collapseFormatter=this.table.options.responsiveLayoutCollapseFormatter||this.formatCollapsedData,this.collapseStartOpen=this.table.options.responsiveLayoutCollapseStartOpen,this.hiddenColumns=[],this.table.columnManager.columnsByIndex.forEach(function(l,u){l.modules.responsive&&l.modules.responsive.order&&l.modules.responsive.visible&&(l.modules.responsive.index=u,s.push(l),!l.visible&&"collapse"===self.mode&&self.hiddenColumns.push(l))}),s=(s=s.reverse()).sort(function(l,u){return u.modules.responsive.order-l.modules.responsive.order||u.modules.responsive.index-l.modules.responsive.index}),this.columns=s,"collapse"===this.mode&&this.generateCollapsedContent();for(let l of this.table.columnManager.columnsByIndex)if("responsiveCollapse"==l.definition.formatter){this.collapseHandleColumn=l;break}this.collapseHandleColumn&&(this.hiddenColumns.length?this.collapseHandleColumn.show():this.collapseHandleColumn.hide())}initializeColumn(s){var l=s.getDefinition();s.modules.responsive={order:void 0===l.responsive?1:l.responsive,visible:!1!==l.visible}}initializeRow(s){var l;"calc"!==s.type&&((l=document.createElement("div")).classList.add("tabulator-responsive-collapse"),s.modules.responsiveLayout={element:l,open:this.collapseStartOpen},this.collapseStartOpen||(l.style.display="none"))}layoutRow(s){var l=s.getElement();s.modules.responsiveLayout&&(l.appendChild(s.modules.responsiveLayout.element),this.generateCollapsedRowContent(s))}updateColumnVisibility(s,l){!l&&s.modules.responsive&&(s.modules.responsive.visible=s.visible,this.initialize())}hideColumn(s){var l=this.hiddenColumns.length;s.hide(!1,!0),"collapse"===this.mode&&(this.hiddenColumns.unshift(s),this.generateCollapsedContent(),this.collapseHandleColumn&&!l&&this.collapseHandleColumn.show())}showColumn(s){var l;s.show(!1,!0),s.setWidth(s.getWidth()),"collapse"===this.mode&&((l=this.hiddenColumns.indexOf(s))>-1&&this.hiddenColumns.splice(l,1),this.generateCollapsedContent(),this.collapseHandleColumn&&!this.hiddenColumns.length&&this.collapseHandleColumn.hide())}update(){for(var s=this,l=!0;l;){let u="fitColumns"==s.table.modules.layout.getMode()?s.table.columnManager.getFlexBaseWidth():s.table.columnManager.getWidth(),g=(s.table.options.headerVisible?s.table.columnManager.element.clientWidth:s.table.element.clientWidth)-u;if(g<0){let b=s.columns[s.index];b?(s.hideColumn(b),s.index++):l=!1}else{let b=s.columns[s.index-1];b&&g>0&&g>=b.getWidth()?(s.showColumn(b),s.index--):l=!1}s.table.rowManager.activeRowsCount||s.table.rowManager.renderEmptyScroll()}}generateCollapsedContent(){var s=this;this.table.rowManager.getDisplayRows().forEach(function(u){s.generateCollapsedRowContent(u)})}generateCollapsedRowContent(s){var l,u;if(s.modules.responsiveLayout){for(l=s.modules.responsiveLayout.element;l.firstChild;)l.removeChild(l.firstChild);(u=this.collapseFormatter(this.generateCollapsedRowData(s)))&&l.appendChild(u)}}generateCollapsedRowData(s){var b,l=this,u=s.getData(),g=[];return this.hiddenColumns.forEach(function(w){var k=w.getFieldValue(u);w.definition.title&&w.field&&(w.modules.format&&l.table.options.responsiveLayoutCollapseUseFormatters?(b={value:!1,data:{},getValue:function(){return k},getData:function(){return u},getElement:function(){return document.createElement("div")},getRow:function(){return s.getComponent()},getColumn:function(){return w.getComponent()}},g.push({field:w.field,title:w.definition.title,value:w.modules.format.formatter.call(l.table.modules.format,b,w.modules.format.params,function(Z){Z()})})):g.push({field:w.field,title:w.definition.title,value:k}))}),g}formatCollapsedData(s){var l=document.createElement("table");return s.forEach(function(u){var k,g=document.createElement("tr"),b=document.createElement("td"),w=document.createElement("td"),H=document.createElement("strong");b.appendChild(H),this.langBind("columns|"+u.field,function(Z){H.innerText=Z||u.title}),u.value instanceof Node?((k=document.createElement("div")).appendChild(u.value),w.appendChild(k)):w.innerHTML=u.value,g.appendChild(b),g.appendChild(w),l.appendChild(g)},this),Object.keys(s).length?l:""}}return v.moduleName="responsiveLayout",v})(),qp=(()=>{class v extends vr{constructor(s){super(s),this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],this.headerCheckboxElement=null,this.registerTableOption("selectable","highlight"),this.registerTableOption("selectableRangeMode","drag"),this.registerTableOption("selectableRollingSelection",!0),this.registerTableOption("selectablePersistence",!0),this.registerTableOption("selectableCheck",function(l,u){return!0}),this.registerTableFunction("selectRow",this.selectRows.bind(this)),this.registerTableFunction("deselectRow",this.deselectRows.bind(this)),this.registerTableFunction("toggleSelectRow",this.toggleRow.bind(this)),this.registerTableFunction("getSelectedRows",this.getSelectedRows.bind(this)),this.registerTableFunction("getSelectedData",this.getSelectedData.bind(this)),this.registerComponentFunction("row","select",this.selectRows.bind(this)),this.registerComponentFunction("row","deselect",this.deselectRows.bind(this)),this.registerComponentFunction("row","toggleSelect",this.toggleRow.bind(this)),this.registerComponentFunction("row","isSelected",this.isRowSelected.bind(this))}initialize(){!1!==this.table.options.selectable&&(this.subscribe("row-init",this.initializeRow.bind(this)),this.subscribe("row-deleting",this.rowDeleted.bind(this)),this.subscribe("rows-wipe",this.clearSelectionData.bind(this)),this.subscribe("rows-retrieve",this.rowRetrieve.bind(this)),this.table.options.selectable&&this.table.options.selectablePersistence&&this.subscribe("data-refeshing",this.deselectRows.bind(this)))}rowRetrieve(s,l){return"selected"===s?this.selectedRows:l}rowDeleted(s){this._deselectRow(s,!0)}clearSelectionData(s){this.selecting=!1,this.lastClickedRow=!1,this.selectPrev=[],this.selectedRows=[],!0!==s&&this._rowSelectionChanged()}initializeRow(s){var l=this,u=s.getElement(),g=function(){setTimeout(function(){l.selecting=!1},50),document.body.removeEventListener("mouseup",g)};s.modules.select={selected:!1},l.table.options.selectableCheck.call(this.table,s.getComponent())?(u.classList.add("tabulator-selectable"),u.classList.remove("tabulator-unselectable"),l.table.options.selectable&&"highlight"!=l.table.options.selectable&&("click"===l.table.options.selectableRangeMode?u.addEventListener("click",function(b){if(b.shiftKey){l.table._clearSelection(),l.lastClickedRow=l.lastClickedRow||s;var w=l.table.rowManager.getDisplayRowIndex(l.lastClickedRow),k=l.table.rowManager.getDisplayRowIndex(s),H=w<=k?w:k,Z=w>=k?w:k,Pt=l.table.rowManager.getDisplayRows().slice(0).splice(H,Z-H+1);b.ctrlKey||b.metaKey?(Pt.forEach(function(qt){qt!==l.lastClickedRow&&(!0===l.table.options.selectable||l.isRowSelected(s)||l.selectedRows.length<l.table.options.selectable)&&l.toggleRow(qt)}),l.lastClickedRow=s):(l.deselectRows(void 0,!0),!0!==l.table.options.selectable&&Pt.length>l.table.options.selectable&&(Pt=Pt.slice(0,l.table.options.selectable)),l.selectRows(Pt)),l.table._clearSelection()}else b.ctrlKey||b.metaKey?(l.toggleRow(s),l.lastClickedRow=s):(l.deselectRows(void 0,!0),l.selectRows(s),l.lastClickedRow=s)}):(u.addEventListener("click",function(b){(!l.table.modExists("edit")||!l.table.modules.edit.getCurrentCell())&&l.table._clearSelection(),l.selecting||l.toggleRow(s)}),u.addEventListener("mousedown",function(b){if(b.shiftKey)return l.table._clearSelection(),l.selecting=!0,l.selectPrev=[],document.body.addEventListener("mouseup",g),document.body.addEventListener("keyup",g),l.toggleRow(s),!1}),u.addEventListener("mouseenter",function(b){l.selecting&&(l.table._clearSelection(),l.toggleRow(s),l.selectPrev[1]==s&&l.toggleRow(l.selectPrev[0]))}),u.addEventListener("mouseout",function(b){l.selecting&&(l.table._clearSelection(),l.selectPrev.unshift(s))})))):(u.classList.add("tabulator-unselectable"),u.classList.remove("tabulator-selectable"))}toggleRow(s){this.table.options.selectableCheck.call(this.table,s.getComponent())&&(s.modules.select&&s.modules.select.selected?this._deselectRow(s):this._selectRow(s))}selectRows(s){var l;switch(typeof s){case"undefined":this.table.rowManager.rows.forEach(u=>{this._selectRow(u,!0,!0)}),this._rowSelectionChanged();break;case"string":(l=this.table.rowManager.findRow(s))?this._selectRow(l,!0,!0):this.table.rowManager.getRows(s).forEach(u=>{this._selectRow(u,!0,!0)}),this._rowSelectionChanged();break;default:Array.isArray(s)?(s.forEach(u=>{this._selectRow(u,!0,!0)}),this._rowSelectionChanged()):this._selectRow(s,!1,!0)}}_selectRow(s,l,u){if(!isNaN(this.table.options.selectable)&&!0!==this.table.options.selectable&&!u&&this.selectedRows.length>=this.table.options.selectable){if(!this.table.options.selectableRollingSelection)return!1;this._deselectRow(this.selectedRows[0])}var g=this.table.rowManager.findRow(s);g?-1==this.selectedRows.indexOf(g)&&(g.getElement().classList.add("tabulator-selected"),g.modules.select||(g.modules.select={}),g.modules.select.selected=!0,g.modules.select.checkboxEl&&(g.modules.select.checkboxEl.checked=!0),this.selectedRows.push(g),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(g,!0),l||this.dispatchExternal("rowSelected",g.getComponent()),this._rowSelectionChanged(l)):l||console.warn("Selection Error - No such row found, ignoring selection:"+s)}isRowSelected(s){return-1!==this.selectedRows.indexOf(s)}deselectRows(s,l){var g,u=this;if(void 0===s){g=u.selectedRows.length;for(let b=0;b<g;b++)u._deselectRow(u.selectedRows[0],!0);u._rowSelectionChanged(l)}else Array.isArray(s)?(s.forEach(function(b){u._deselectRow(b,!0)}),u._rowSelectionChanged(l)):u._deselectRow(s,l)}_deselectRow(s,l){var b,u=this,g=u.table.rowManager.findRow(s);g?(b=u.selectedRows.findIndex(function(w){return w==g}))>-1&&(g.getElement().classList.remove("tabulator-selected"),g.modules.select||(g.modules.select={}),g.modules.select.selected=!1,g.modules.select.checkboxEl&&(g.modules.select.checkboxEl.checked=!1),u.selectedRows.splice(b,1),this.table.options.dataTreeSelectPropagate&&this.childRowSelection(g,!1),l||this.dispatchExternal("rowDeselected",g.getComponent()),u._rowSelectionChanged(l)):l||console.warn("Deselection Error - No such row found, ignoring selection:"+s)}getSelectedData(){var s=[];return this.selectedRows.forEach(function(l){s.push(l.getData())}),s}getSelectedRows(){var s=[];return this.selectedRows.forEach(function(l){s.push(l.getComponent())}),s}_rowSelectionChanged(s){this.headerCheckboxElement&&(0===this.selectedRows.length?(this.headerCheckboxElement.checked=!1,this.headerCheckboxElement.indeterminate=!1):this.table.rowManager.rows.length===this.selectedRows.length?(this.headerCheckboxElement.checked=!0,this.headerCheckboxElement.indeterminate=!1):(this.headerCheckboxElement.indeterminate=!0,this.headerCheckboxElement.checked=!1)),s||this.dispatchExternal("rowSelectionChanged",this.getSelectedData(),this.getSelectedRows())}registerRowSelectCheckbox(s,l){s._row.modules.select||(s._row.modules.select={}),s._row.modules.select.checkboxEl=l}registerHeaderSelectCheckbox(s){this.headerCheckboxElement=s}childRowSelection(s,l){var u=this.table.modules.dataTree.getChildren(s,!0);if(l)for(let g of u)this._selectRow(g,!0);else for(let g of u)this._deselectRow(g,!0)}}return v.moduleName="selectRow",v})();function vp(v,c,s,l,u,g,b){var w=window.DateTime||luxon.DateTime,k=b.format||"dd/MM/yyyy HH:mm:ss",H=b.alignEmptyValues,Z=0;if(void 0!==w){if(v=w.fromFormat(v,k),c=w.fromFormat(c,k),v.isValid){if(c.isValid)return v-c;Z=1}else Z=c.isValid?-1:0;return("top"===H&&"desc"===g||"bottom"===H&&"asc"===g)&&(Z*=-1),Z}console.error("Sort Error - 'datetime' sorter is dependant on luxon.js")}var Hd={number:function mp(v,c,s,l,u,g,b){var w=b.alignEmptyValues,k=b.decimalSeparator,H=b.thousandSeparator,Z=0;if(v=String(v),c=String(c),H&&(v=v.split(H).join(""),c=c.split(H).join("")),k&&(v=v.split(k).join("."),c=c.split(k).join(".")),v=parseFloat(v),c=parseFloat(c),isNaN(v))Z=isNaN(c)?0:-1;else{if(!isNaN(c))return v-c;Z=1}return("top"===w&&"desc"===g||"bottom"===w&&"asc"===g)&&(Z*=-1),Z},string:function P_(v,c,s,l,u,g,b){var H,w=b.alignEmptyValues,k=0;if(v){if(c){switch(typeof b.locale){case"boolean":b.locale&&(H=this.langLocale());break;case"string":H=b.locale}return String(v).toLowerCase().localeCompare(String(c).toLowerCase(),H)}k=1}else k=c?-1:0;return("top"===w&&"desc"===g||"bottom"===w&&"asc"===g)&&(k*=-1),k},date:function tf(v,c,s,l,u,g,b){return b.format||(b.format="dd/MM/yyyy"),vp.call(this,v,c,s,l,u,g,b)},time:function ef(v,c,s,l,u,g,b){return b.format||(b.format="HH:mm"),vp.call(this,v,c,s,l,u,g,b)},datetime:vp,boolean:function nf(v,c,s,l,u,g,b){return(!0===v||"true"===v||"True"===v||1===v?1:0)-(!0===c||"true"===c||"True"===c||1===c?1:0)},array:function rf(v,c,s,l,u,g,b){var H=b.type||"length",Z=b.alignEmptyValues,ht=0;function Pt(qt){switch(H){case"length":return qt.length;case"sum":return qt.reduce(function(be,Le){return be+Le});case"max":return Math.max.apply(null,qt);case"min":return Math.min.apply(null,qt);case"avg":return qt.reduce(function(be,Le){return be+Le})/qt.length}}if(Array.isArray(v)){if(Array.isArray(c))return(v?Pt(v):0)-(c?Pt(c):0);Z=1}else Z=Array.isArray(c)?-1:0;return("top"===Z&&"desc"===g||"bottom"===Z&&"asc"===g)&&(ht*=-1),ht},exists:function sf(v,c,s,l,u,g,b){return(void 0===v?0:1)-(void 0===c?0:1)},alphanum:function Ju(v,c,s,l,u,g,b){var w,k,H,Z,Pt,ht=0,qt=/(\d+)|(\D+)/g,be=/\d/,Le=b.alignEmptyValues,Ge=0;if(v||0===v){if(c||0===c){if(isFinite(v)&&isFinite(c))return v-c;if((w=String(v).toLowerCase())===(k=String(c).toLowerCase()))return 0;if(!be.test(w)||!be.test(k))return w>k?1:-1;for(w=w.match(qt),k=k.match(qt),Pt=w.length>k.length?k.length:w.length;ht<Pt;)if((H=w[ht])!==(Z=k[ht++]))return isFinite(H)&&isFinite(Z)?("0"===H.charAt(0)&&(H="."+H),"0"===Z.charAt(0)&&(Z="."+Z),H-Z):H>Z?1:-1;return w.length>k.length}Ge=1}else Ge=c||0===c?-1:0;return("top"===Le&&"desc"===g||"bottom"===Le&&"asc"===g)&&(Ge*=-1),Ge}},og={integer:function(v,c,s){return""===c||null==c||"number"==typeof(c=Number(c))&&isFinite(c)&&Math.floor(c)===c},float:function(v,c,s){return""===c||null==c||"number"==typeof(c=Number(c))&&isFinite(c)&&c%1!=0},numeric:function(v,c,s){return""===c||null==c||!isNaN(c)},string:function(v,c,s){return""===c||null==c||isNaN(c)},max:function(v,c,s){return""===c||null==c||parseFloat(c)<=s},min:function(v,c,s){return""===c||null==c||parseFloat(c)>=s},starts:function(v,c,s){return""===c||null==c||String(c).toLowerCase().startsWith(String(s).toLowerCase())},ends:function(v,c,s){return""===c||null==c||String(c).toLowerCase().endsWith(String(s).toLowerCase())},minLength:function(v,c,s){return""===c||null==c||String(c).length>=s},maxLength:function(v,c,s){return""===c||null==c||String(c).length<=s},in:function(v,c,s){return""===c||null==c||("string"==typeof s&&(s=s.split("|")),""===c||s.indexOf(c)>-1)},regex:function(v,c,s){return""===c||null==c||new RegExp(s).test(c)},unique:function(v,c,s){if(""===c||null==c)return!0;var l=!0,u=v.getData(),g=v.getColumn()._getSelf();return this.table.rowManager.rows.forEach(function(b){var w=b.getData();w!==u&&c==g.getFieldValue(w)&&(l=!1)}),l},required:function(v,c,s){return""!==c&&null!=c}},yp=Object.freeze({__proto__:null,AccessorModule:np,AjaxModule:Md,ClipboardModule:ap,ColumnCalcsModule:lp,DataTreeModule:Qh,DownloadModule:kd,EditModule:hp,ExportModule:Ed,FilterModule:N,FormatModule:Xp,FrozenColumnsModule:zf,FrozenRowsModule:Kp,GroupRowsModule:Yf,HistoryModule:$p,HtmlTableImportModule:Kf,InteractionModule:Pu,KeybindingsModule:$f,MenuModule:N_,MoveColumnsModule:Zp,MoveRowsModule:Fd,MutatorModule:Qf,PageModule:pp,PersistenceModule:Bd,PrintModule:fp,ReactiveDataModule:eg,ResizeColumnsModule:gp,ResizeRowsModule:_p,ResizeTableModule:Qp,ResponsiveLayoutModule:ig,SelectRowModule:qp,SortModule:(()=>{class v extends vr{constructor(s){super(s),this.sortList=[],this.changed=!1,this.registerTableOption("sortMode","local"),this.registerTableOption("initialSort",!1),this.registerTableOption("columnHeaderSortMulti",!0),this.registerTableOption("sortOrderReverse",!1),this.registerTableOption("headerSortElement","<div class='tabulator-arrow'></div>"),this.registerColumnOption("sorter"),this.registerColumnOption("sorterParams"),this.registerColumnOption("headerSort",!0),this.registerColumnOption("headerSortStartingDir"),this.registerColumnOption("headerSortTristate")}initialize(){this.subscribe("column-layout",this.initializeColumn.bind(this)),this.subscribe("table-built",this.tableBuilt.bind(this)),this.registerDataHandler(this.sort.bind(this),20),this.registerTableFunction("setSort",this.userSetSort.bind(this)),this.registerTableFunction("getSorters",this.getSort.bind(this)),this.registerTableFunction("clearSort",this.clearSort.bind(this)),"remote"===this.table.options.sortMode&&this.subscribe("data-params",this.remoteSortParams.bind(this))}tableBuilt(){this.table.options.initialSort&&this.setSort(this.table.options.initialSort)}remoteSortParams(s,l,u,g){var b=this.getSort();return b.forEach(w=>{delete w.column}),g.sort=b,g}userSetSort(s,l){this.setSort(s,l),this.refreshSort()}clearSort(){this.clear(),this.refreshSort()}initializeColumn(s){var u,g,l=!1;switch(typeof s.definition.sorter){case"string":v.sorters[s.definition.sorter]?l=v.sorters[s.definition.sorter]:console.warn("Sort Error - No such sorter found: ",s.definition.sorter);break;case"function":l=s.definition.sorter}s.modules.sort={sorter:l,dir:"none",params:s.definition.sorterParams||{},startingDir:s.definition.headerSortStartingDir||"asc",tristate:s.definition.headerSortTristate},!1!==s.definition.headerSort&&((u=s.getElement()).classList.add("tabulator-sortable"),(g=document.createElement("div")).classList.add("tabulator-col-sorter"),"object"==typeof this.table.options.headerSortElement?g.appendChild(this.table.options.headerSortElement):g.innerHTML=this.table.options.headerSortElement,s.titleHolderElement.appendChild(g),s.modules.sort.element=g,u.addEventListener("click",b=>{var w="",k=[],H=!1;if(s.modules.sort){if(s.modules.sort.tristate)w="none"==s.modules.sort.dir?s.modules.sort.startingDir:s.modules.sort.dir==s.modules.sort.startingDir?"asc"==s.modules.sort.dir?"desc":"asc":"none";else switch(s.modules.sort.dir){case"asc":w="desc";break;case"desc":w="asc";break;default:w=s.modules.sort.startingDir}this.table.options.columnHeaderSortMulti&&(b.shiftKey||b.ctrlKey)?((H=(k=this.getSort()).findIndex(Z=>Z.field===s.getField()))>-1?(k[H].dir=w,H!=k.length-1&&(H=k.splice(H,1)[0],"none"!=w&&k.push(H))):"none"!=w&&k.push({column:s,dir:w}),this.setSort(k)):"none"==w?this.clear():this.setSort(s,w),this.refreshSort()}}))}refreshSort(){"remote"===this.table.options.sortMode?this.reloadData():this.refreshData()}hasChanged(){var s=this.changed;return this.changed=!1,s}getSort(){var l=[];return this.sortList.forEach(function(u){u.column&&l.push({column:u.column.getComponent(),field:u.column.getField(),dir:u.dir})}),l}setSort(s,l){var u=this,g=[];Array.isArray(s)||(s=[{column:s,dir:l}]),s.forEach(function(b){var w;(w=u.table.columnManager.findColumn(b.column))?(b.column=w,g.push(b),u.changed=!0):console.warn("Sort Warning - Sort field does not exist and is being ignored: ",b.column)}),u.sortList=g,this.dispatch("sort-changed")}clear(){this.setSort([])}findSorter(s){var b,l=this.table.rowManager.activeRows[0],u="string";if(l&&(l=l.getData(),s.getField()))switch(b=s.getFieldValue(l),typeof b){case"undefined":u="string";break;case"boolean":u="boolean";break;default:isNaN(b)||""===b?b.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)&&(u="alphanum"):u="number"}return v.sorters[u]}sort(s){var l=this,u=this.table.options.sortOrderReverse?l.sortList.slice().reverse():l.sortList,g=[],b=[];return this.subscribedExternal("dataSorting")&&this.dispatchExternal("dataSorting",l.getSort()),l.clearColumnHeaders(),"remote"!==this.table.options.sortMode?(u.forEach(function(w,k){var H=w.column.modules.sort;w.column&&H&&(H.sorter||(H.sorter=l.findSorter(w.column)),w.params="function"==typeof H.params?H.params(w.column.getComponent(),w.dir):H.params,g.push(w)),l.setColumnHeader(w.column,w.dir)}),g.length&&l._sortItems(s,g)):u.forEach(function(w,k){l.setColumnHeader(w.column,w.dir)}),this.subscribedExternal("dataSorted")&&(s.forEach(w=>{b.push(w.getComponent())}),this.dispatchExternal("dataSorted",l.getSort(),b)),s}clearColumnHeaders(){this.table.columnManager.getRealColumns().forEach(function(s){s.modules.sort&&(s.modules.sort.dir="none",s.getElement().setAttribute("aria-sort","none"))})}setColumnHeader(s,l){s.modules.sort.dir=l,s.getElement().setAttribute("aria-sort",l)}_sortItems(s,l){var u=l.length-1;s.sort((g,b)=>{for(var w,k=u;k>=0;k--){let H=l[k];if(0!==(w=this._sortRow(g,b,H.column,H.dir,H.params)))break}return w})}_sortRow(s,l,u,g,b){var w,k,H="asc"==g?s:l,Z="asc"==g?l:s;return s=void 0!==(s=u.getFieldValue(H.getData()))?s:"",l=void 0!==(l=u.getFieldValue(Z.getData()))?l:"",w=H.getComponent(),k=Z.getComponent(),u.modules.sort.sorter.call(this,s,l,w,k,u.getComponent(),g,b)}}return v.moduleName="sort",v.sorters=Hd,v})(),ValidateModule:(()=>{class v extends vr{constructor(s){super(s),this.invalidCells=[],this.registerTableOption("validationMode","blocking"),this.registerColumnOption("validator"),this.registerTableFunction("getInvalidCells",this.getInvalidCells.bind(this)),this.registerTableFunction("clearCellValidation",this.userClearCellValidation.bind(this)),this.registerTableFunction("validate",this.userValidate.bind(this)),this.registerComponentFunction("cell","isValid",this.cellIsValid.bind(this)),this.registerComponentFunction("cell","clearValidation",this.clearValidation.bind(this)),this.registerComponentFunction("cell","validate",this.cellValidate.bind(this)),this.registerComponentFunction("column","validate",this.columnValidate.bind(this)),this.registerComponentFunction("row","validate",this.rowValidate.bind(this))}initialize(){this.subscribe("cell-delete",this.clearValidation.bind(this)),this.subscribe("column-layout",this.initializeColumnCheck.bind(this))}cellIsValid(s){return!s.modules.validate||!s.modules.validate.invalid}cellValidate(s){return this.validate(s.column.modules.validate,s,s.getValue())}columnValidate(s){var l=[];return s.cells.forEach(function(u){this.cellValidate(u)||l.push(u.getComponent())}),!l.length||l}rowValidate(s){var l=[];return s.cells.forEach(function(u){this.cellValidate(u)||l.push(u.getComponent())}),!l.length||l}userClearCellValidation(s){s||(s=this.getInvalidCells()),Array.isArray(s)||(s=[s]),s.forEach(l=>{this.clearValidation(l._getSelf())})}userValidate(s){var l=[];return this.table.rowManager.rows.forEach(function(u){var g=u.validate();!0!==g&&(l=l.concat(g))}),!l.length||l}initializeColumnCheck(s){void 0!==s.definition.validator&&this.initializeColumn(s)}initializeColumn(s){var g,l=this,u=[];s.definition.validator&&(Array.isArray(s.definition.validator)?s.definition.validator.forEach(function(b){(g=l._extractValidator(b))&&u.push(g)}):(g=this._extractValidator(s.definition.validator))&&u.push(g),s.modules.validate=!!u.length&&u)}_extractValidator(s){var l,u,g;switch(typeof s){case"string":return(g=s.indexOf(":"))>-1?(l=s.substring(0,g),u=s.substring(g+1)):l=s,this._buildValidator(l,u);case"function":return this._buildValidator(s);case"object":return this._buildValidator(s.type,s.parameters)}}_buildValidator(s,l){var u="function"==typeof s?s:v.validators[s];return u?{type:"function"==typeof s?"function":s,func:u,params:l}:(console.warn("Validator Setup Error - No matching validator found:",s),!1)}validate(s,l,u){var g=this,b=[],w=this.invalidCells.indexOf(l);return s&&s.forEach(function(k){k.func.call(g,l.getComponent(),u,k.params)||b.push({type:k.type,parameters:k.params})}),b=!b.length||b,l.modules.validate||(l.modules.validate={}),!0===b?(l.modules.validate.invalid=!1,l.getElement().classList.remove("tabulator-validation-fail"),w>-1&&this.invalidCells.splice(w,1)):(l.modules.validate.invalid=!0,"manual"!==this.table.options.validationMode&&l.getElement().classList.add("tabulator-validation-fail"),-1==w&&this.invalidCells.push(l)),b}getInvalidCells(){var s=[];return this.invalidCells.forEach(l=>{s.push(l.getComponent())}),s}clearValidation(s){var l;s.modules.validate&&s.modules.validate.invalid&&(s.getElement().classList.remove("tabulator-validation-fail"),s.modules.validate.invalid=!1,(l=this.invalidCells.indexOf(s))>-1&&this.invalidCells.splice(l,1))}}return v.moduleName="validate",v.validators=og,v})()}),af={debugEventsExternal:!1,debugEventsInternal:!1,debugInvalidOptions:!0,height:!1,minHeight:!1,maxHeight:!1,columnMaxWidth:!1,columnHeaderVertAlign:"top",columns:[],columnDefaults:{},data:!1,autoColumns:!1,autoColumnsDefinitions:!1,nestedFieldSeparator:".",tooltipGenerationMode:"load",footerElement:!1,index:"id",textDirection:"auto",addRowPos:"bottom",headerVisible:!0,renderVertical:"virtual",renderHorizontal:"basic",renderVerticalBuffer:0,scrollToRowPosition:"top",scrollToRowIfVisible:!0,scrollToColumnPosition:"left",scrollToColumnIfVisible:!0,rowFormatter:!1,rowFormatterPrint:null,rowFormatterClipboard:null,rowFormatterHtmlOutput:null,placeholder:!1,dataLoader:!0,dataLoaderLoading:!1,dataLoaderError:!1,dataSendParams:{},dataReceiveParams:{}};class Ud{constructor(c,s){this.table=c,this.msgType=s,this.registeredDefaults={}}register(c,s){this.registeredDefaults[c]=s}generate(c,s={}){var l=Object.assign({},this.registeredDefaults);if(Object.assign(l,c),!1!==s.debugInvalidOptions||this.table.options.debugInvalidOptions)for(var u in s)l.hasOwnProperty(u)||console.warn("Invalid "+this.msgType+" option:",u);for(var u in l)u in s?l[u]=s[u]:Array.isArray(l[u])?l[u]=Object.assign([],l[u]):"object"==typeof l[u]&&null!==l[u]?l[u]=Object.assign({},l[u]):void 0===l[u]&&delete l[u];return l}}class mh extends tu{constructor(c){super(c),this.elementVertical=c.rowManager.element,this.elementHorizontal=c.columnManager.element,this.tableElement=c.rowManager.tableElement,this.verticalFillMode="fit"}initialize(){}clearRows(){}clearColumns(){}reinitializeColumnWidths(c){}renderRows(){}renderColumns(){}rerenderRows(c){c&&c()}rerenderColumns(c,s){}renderRowCells(c){}rerenderRowCells(c,s){}scrollColumns(c,s){}scrollRows(c,s){}resize(){}scrollToRow(c){}scrollToRowNearestTop(c){}visibleRows(c){return[]}rows(){return this.table.rowManager.getDisplayRows()}styleRow(c,s){var l=c.getElement();s%2?(l.classList.add("tabulator-row-even"),l.classList.remove("tabulator-row-odd")):(l.classList.add("tabulator-row-odd"),l.classList.remove("tabulator-row-even"))}clear(){this.clearRows(),this.clearColumns()}render(){this.renderRows(),this.renderColumns()}rerender(c){this.rerenderRows(),this.rerenderColumns()}scrollToRowPosition(c,s,l){var u=this.rows().indexOf(c),g=c.getElement(),b=0;return new Promise((w,k)=>{if(u>-1){if(void 0===l&&(l=this.table.options.scrollToRowIfVisible),!l&&Ws.elVisible(g)&&(b=Ws.elOffset(g).top-Ws.elOffset(this.elementVertical).top)>0&&b<this.elementVertical.clientHeight-g.offsetHeight)return!1;switch(void 0===s&&(s=this.table.options.scrollToRowPosition),"nearest"===s&&(s=this.scrollToRowNearestTop(c)?"top":"bottom"),this.scrollToRow(c),s){case"middle":case"center":this.elementVertical.scrollTop=this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop+(g.offsetTop-this.elementVertical.scrollTop)-(this.elementVertical.scrollHeight-g.offsetTop)/2:this.elementVertical.scrollTop-this.elementVertical.clientHeight/2;break;case"bottom":this.elementVertical.scrollTop=this.elementVertical.scrollHeight-this.elementVertical.scrollTop==this.elementVertical.clientHeight?this.elementVertical.scrollTop-(this.elementVertical.scrollHeight-g.offsetTop)+g.offsetHeight:this.elementVertical.scrollTop-this.elementVertical.clientHeight+g.offsetHeight}w()}else console.warn("Scroll Error - Row not visible"),k("Scroll Error - Row not visible")})}}class rg extends mh{constructor(c){super(c)}renderRowCells(c){c.cells.forEach(s=>{c.element.appendChild(s.getElement()),s.cellRendered()})}reinitializeColumnWidths(c){c.forEach(function(s){s.reinitializeWidth()})}}class Tp extends mh{constructor(c){super(c),this.leftCol=0,this.rightCol=0,this.scrollLeft=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0,this.fitDataColAvg=0,this.window=200,this.initialized=!1,this.columns=[]}initialize(){this.compatabilityCheck()}compatabilityCheck(){var c=this.options("columns"),l=!0;return"fitDataTable"==this.options("layout")&&(console.warn("Horizontal Vitrual DOM is not compatible with fitDataTable layout mode"),l=!1),this.options("responsiveLayout")&&(console.warn("Horizontal Vitrual DOM is not compatible with responsive columns"),l=!1),this.options("rtl")&&(console.warn("Horizontal Vitrual DOM is not currently compatible with RTL text direction"),l=!1),c&&c.find(u=>u.frozen)&&(console.warn("Horizontal Vitrual DOM is not compatible with frozen columns"),l=!1),l}renderColumns(c,s){this.dataChange()}scrollColumns(c,s){this.scrollLeft!=c&&(this.scrollLeft=c,this.scroll(c-(this.vDomScrollPosLeft+this.window)))}rerenderColumns(c,s){var l={cols:this.columns,leftCol:this.leftCol,rightCol:this.rightCol};if(!c||this.initialized){this.clear(),this.scrollLeft=this.elementVertical.scrollLeft,this.vDomScrollPosLeft=this.scrollLeft-this.window,this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.window;var u=0;this.table.columnManager.columnsByIndex.forEach(g=>{var b={};if(g.visible){var w=g.getWidth();b.leftPos=u,b.rightPos=u+w,b.width=w,"fitData"===this.options("layout")&&(b.fitDataCheck=!0),u+w>this.vDomScrollPosLeft&&u<this.vDomScrollPosRight?(-1==this.leftCol&&(this.leftCol=this.columns.length,this.vDomPadLeft=u),this.rightCol=this.columns.length):-1!==this.leftCol&&(this.vDomPadRight+=w),this.columns.push(g),g.modules.vdomHoz=b,u+=w}}),this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.initialized=!0,s||(!c||this.reinitChanged(l))&&this.renitializeRows(),this.elementVertical.scrollLeft=this.scrollLeft}}renderRowCells(c){this.initialized?this.initializeRow(c):c.cells.forEach(s=>{c.element.appendChild(s.getElement()),s.cellRendered()})}rerenderRowCells(c,s){this.reinitializeRow(c,s)}reinitializeColumnWidths(c){for(let s=this.leftCol;s<=this.rightCol;s++)this.columns[s].reinitializeWidth()}deinitialize(){this.initialized=!1}clear(){this.columns=[],this.leftCol=-1,this.rightCol=0,this.vDomScrollPosLeft=0,this.vDomScrollPosRight=0,this.vDomPadLeft=0,this.vDomPadRight=0}dataChange(){var g,u,c=!1,s=0,l=0;if("fitData"===this.options("layout")){if(this.table.columnManager.columnsByIndex.forEach(b=>{!b.definition.width&&b.visible&&(c=!0)}),c&&c&&this.table.rowManager.getDisplayRows().length&&(this.vDomScrollPosRight=this.scrollLeft+this.elementVertical.clientWidth+this.window,u=this.chain("rows-sample",[1],[],()=>this.table.rowManager.getDisplayRows()[0])[0])){for(g=u.getElement(),u.generateCells(),this.tableElement.appendChild(g),l=0;l<u.cells.length;l++){let k=u.cells[l];if(g.appendChild(k.getElement()),k.column.reinitializeWidth(),(s+=k.column.getWidth())>this.vDomScrollPosRight)break}for(g.parentNode.removeChild(g),this.fitDataColAvg=Math.floor(s/(l+1));l<this.table.columnManager.columnsByIndex.length;l++)this.table.columnManager.columnsByIndex[l].setWidth(this.fitDataColAvg);this.rerenderColumns(!1,!0)}}else"fitColumns"===this.options("layout")&&(this.layoutRefresh(),this.rerenderColumns(!1,!0))}reinitChanged(c){var s=!0;return c.cols.length!==this.columns.length||c.leftCol!==this.leftCol||c.rightCol!==this.rightCol||(c.cols.forEach((l,u)=>{l!==this.columns[u]&&(s=!1)}),!s)}renitializeRows(){this.table.rowManager.getVisibleRows().forEach(s=>{this.reinitializeRow(s,!0)})}scroll(c){this.vDomScrollPosLeft+=c,this.vDomScrollPosRight+=c,c>.8*this.elementVertical.clientWidth?this.rerenderColumns():c>0?(this.addColRight(),this.removeColLeft()):(this.addColLeft(),this.removeColRight())}colPositionAdjust(c,s,l){for(let u=c;u<s;u++){let g=this.columns[u];g.modules.vdomHoz.leftPos+=l,g.modules.vdomHoz.rightPos+=l}}addColRight(){var c=this.columns[this.rightCol+1];c&&c.modules.vdomHoz.leftPos<=this.vDomScrollPosRight&&(this.table.rowManager.getVisibleRows().forEach(l=>{if("group"!==l.type){var u=l.getCell(c);l.getElement().appendChild(u.getElement()),u.cellRendered()}}),this.fitDataColActualWidthCheck(c),this.rightCol++,this.rightCol>=this.columns.length-1?this.vDomPadRight=0:this.vDomPadRight-=c.getWidth(),this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.addColRight())}addColLeft(){var c=this.columns[this.leftCol-1];c&&c.modules.vdomHoz.rightPos>=this.vDomScrollPosLeft&&(this.table.rowManager.getVisibleRows().forEach(u=>{if("group"!==u.type){var g=u.getCell(c);u.getElement().prepend(g.getElement()),g.cellRendered()}}),this.fitDataColActualWidthCheck(c),this.leftCol?this.vDomPadLeft-=c.getWidth():this.vDomPadLeft=0,this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.leftCol--,this.addColLeft())}removeColRight(s){var l;(s=this.columns[this.rightCol])&&s.modules.vdomHoz.leftPos>this.vDomScrollPosRight&&(l=this.table.rowManager.getVisibleRows(),s.modules.vdomHoz.visible=!1,l.forEach(u=>{if("group"!==u.type){var g=u.getCell(s);u.getElement().removeChild(g.getElement())}}),this.vDomPadRight+=s.getWidth(),this.tableElement.style.paddingRight=this.vDomPadRight+"px",this.rightCol--,this.removeColRight())}removeColLeft(){var c=this.columns[this.leftCol];c&&c.modules.vdomHoz.rightPos<this.vDomScrollPosLeft&&(this.table.rowManager.getVisibleRows().forEach(l=>{if("group"!==l.type){var u=l.getCell(c);u.parentNode&&l.getElement().removeChild(u.getElement())}}),this.vDomPadLeft+=c.getWidth(),this.tableElement.style.paddingLeft=this.vDomPadLeft+"px",this.leftCol++,this.removeColLeft())}fitDataColActualWidthCheck(c){var s,l;c.modules.vdomHoz.fitDataCheck&&(c.reinitializeWidth(),(l=(s=c.getWidth())-c.modules.vdomHoz.width)&&(c.modules.vdomHoz.rightPos+=l,c.modules.vdomHoz.width=s,this.colPositionAdjust(this.rightCol+2,this.columns.length,l)),c.modules.vdomHoz.fitDataCheck=!1)}initializeRow(c){if("group"!==c.type){c.modules.vdomHoz={leftCol:this.leftCol,rightCol:this.rightCol};for(let s=this.leftCol;s<=this.rightCol;s++){let l=this.columns[s];if(l&&l.visible){let u=c.getCell(l);c.getElement().appendChild(u.getElement()),u.cellRendered()}}}}reinitializeRow(c,s){if("group"!==c.type&&(s||!c.modules.vdomHoz||c.modules.vdomHoz.leftCol!==this.leftCol||c.modules.vdomHoz.rightCol!==this.rightCol)){for(var l=c.getElement();l.firstChild;)l.removeChild(l.firstChild);this.initializeRow(c)}}}class lf extends tu{constructor(c){super(c),this.blockHozScrollEvent=!1,this.headersElement=null,this.element=null,this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.scrollLeft=0,this.optionsList=new Ud(this.table,"column definition"),this.renderer=null}initialize(){this.initializeRenderer(),this.headersElement=this.createHeadersElement(),this.element=this.createHeaderElement(),this.element.insertBefore(this.headersElement,this.element.firstChild),this.subscribe("scroll-horizontal",this.scrollHorizontal.bind(this))}initializeRenderer(){var c;(c="string"==typeof this.table.options.renderHorizontal?{virtual:Tp,basic:rg}[this.table.options.renderHorizontal]:this.table.options.renderHorizontal)?(this.renderer=new c(this.table,this.element,this.tableElement),this.renderer.initialize()):console.error("Unable to find matching renderer:",table.options.renderHorizontal)}createHeadersElement(){var c=document.createElement("div");return c.classList.add("tabulator-headers"),c.setAttribute("role","row"),c}createHeaderElement(){var c=document.createElement("div");return c.classList.add("tabulator-header"),c.setAttribute("role","rowgroup"),this.table.options.headerVisible||c.classList.add("tabulator-header-hidden"),c}getElement(){return this.element}getHeadersElement(){return this.headersElement}scrollHorizontal(c){var l=this.element.scrollWidth-this.table.element.clientWidth;this.element.scrollLeft=c,this.element.style.marginLeft=c>l?-(c-l)+"px":0,this.scrollLeft=c,this.renderer.scrollColumns(c)}generateColumnsFromRowData(c){var u,g,s=[],l=this.table.options.autoColumnsDefinitions;if(c&&c.length){for(var b in u=c[0]){let w={field:b,title:b},k=u[b];switch(typeof k){case"undefined":g="string";break;case"boolean":g="boolean";break;case"object":g=Array.isArray(k)?"array":"string";break;default:g=isNaN(k)||""===k?k.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)?"alphanum":"string":"number"}w.sorter=g,s.push(w)}if(l)switch(typeof l){case"function":this.table.options.columns=l.call(this.table,s);break;case"object":Array.isArray(l)?s.forEach(w=>{var k=l.find(H=>H.field===w.field);k&&Object.assign(w,k)}):s.forEach(w=>{l[w.field]&&Object.assign(w,l[w.field])}),this.table.options.columns=s}else this.table.options.columns=s;this.setColumns(this.table.options.columns)}}setColumns(c,s){for(;this.headersElement.firstChild;)this.headersElement.removeChild(this.headersElement.firstChild);this.columns=[],this.columnsByIndex=[],this.columnsByField={},this.dispatch("columns-loading"),c.forEach((l,u)=>{this._addColumn(l)}),this._reIndexColumns(),this.dispatch("columns-loaded"),this.renderer.rerenderColumns(!1,!0),this.redraw(!0)}_addColumn(c,s,l){var u=new _d(c,this),g=u.getElement(),b=l&&this.findColumnIndex(l);if(l&&b>-1){var w=l.getTopColumn(),k=this.columns.indexOf(w),H=w.getElement();s?(this.columns.splice(k,0,u),H.parentNode.insertBefore(g,H)):(this.columns.splice(k+1,0,u),H.parentNode.insertBefore(g,H.nextSibling))}else s?(this.columns.unshift(u),this.headersElement.insertBefore(u.getElement(),this.headersElement.firstChild)):(this.columns.push(u),this.headersElement.appendChild(u.getElement()));return u.columnRendered(),u}registerColumnField(c){c.definition.field&&(this.columnsByField[c.definition.field]=c)}registerColumnPosition(c){this.columnsByIndex.push(c)}_reIndexColumns(){this.columnsByIndex=[],this.columns.forEach(function(c){c.reRegisterPosition()})}verticalAlignHeaders(){var c=0;this.columns.forEach(s=>{var l;s.clearVerticalAlign(),(l=s.getHeight())>c&&(c=l)}),this.columns.forEach(s=>{s.verticalAlign(this.table.options.columnHeaderVertAlign,c)}),this.table.rowManager.adjustTableSize()}findColumn(c){return"object"!=typeof c?this.columnsByField[c]||!1:c instanceof _d?c:c instanceof zp?c._getSelf()||!1:"undefined"!=typeof HTMLElement&&c instanceof HTMLElement&&this.columns.find(l=>l.element===c)||!1}getColumnByField(c){return this.columnsByField[c]}getColumnsByFieldRoot(c){var s=[];return Object.keys(this.columnsByField).forEach(l=>{l.split(".")[0]===c&&s.push(this.columnsByField[l])}),s}getColumnByIndex(c){return this.columnsByIndex[c]}getFirstVisibileColumn(s){return(s=this.columnsByIndex.findIndex(l=>l.visible))>-1&&this.columnsByIndex[s]}getColumns(){return this.columns}findColumnIndex(c){return this.columnsByIndex.findIndex(s=>c===s)}getRealColumns(){return this.columnsByIndex}traverse(c){this.columnsByIndex.forEach((s,l)=>{c(s,l)})}getDefinitions(c){var s=[];return this.columnsByIndex.forEach(l=>{(!c||c&&l.visible)&&s.push(l.getDefinition())}),s}getDefinitionTree(){var c=[];return this.columns.forEach(s=>{c.push(s.getDefinition(!0))}),c}getComponents(c){var s=[];return(c?this.columns:this.columnsByIndex).forEach(u=>{s.push(u.getComponent())}),s}getWidth(){var c=0;return this.columnsByIndex.forEach(s=>{s.visible&&(c+=s.getWidth())}),c}moveColumn(c,s,l){this.moveColumnActual(c,s,l),s.element.parentNode.insertBefore(c.element,s.element),l&&s.element.parentNode.insertBefore(s.element,c.element),this.verticalAlignHeaders(),this.table.rowManager.reinitialize()}moveColumnActual(c,s,l){this._moveColumnInArray(c.parent.isGroup?c.parent.columns:this.columns,c,s,l),this._moveColumnInArray(this.columnsByIndex,c,s,l,!0),this.renderer.rerenderColumns(!0),this.dispatch("column-moved",c,s,l),this.subscribedExternal("columnMoved")&&this.dispatchExternal("columnMoved",c.getComponent(),this.table.columnManager.getComponents())}_moveColumnInArray(c,s,l,u,g){var w,b=c.indexOf(s);b>-1&&(c.splice(b,1),(w=c.indexOf(l))>-1?u&&(w+=1):w=b,c.splice(w,0,s),g&&(this.chain("column-moving-rows",[s,l,u],null,[])||[]).concat(this.table.rowManager.rows).forEach(function(H){if(H.cells.length){var Z=H.cells.splice(b,1)[0];H.cells.splice(w,0,Z)}}))}scrollToColumn(c,s,l){var u=0,g=0,b=0,w=c.getElement();return new Promise((k,H)=>{if(void 0===s&&(s=this.table.options.scrollToColumnPosition),void 0===l&&(l=this.table.options.scrollToColumnIfVisible),c.visible){switch(s){case"middle":case"center":b=-this.element.clientWidth/2;break;case"right":b=w.clientWidth-this.headersElement.clientWidth}if(!l&&(g=w.offsetLeft)>0&&g+w.offsetWidth<this.element.clientWidth)return!1;u=w.offsetLeft+b,u=Math.max(Math.min(u,this.table.rowManager.element.scrollWidth-this.table.rowManager.element.clientWidth),0),this.table.rowManager.scrollHorizontal(u),this.scrollHorizontal(u),k()}else console.warn("Scroll Error - Column not visible"),H("Scroll Error - Column not visible")})}generateCells(c){var s=[];return this.columnsByIndex.forEach(l=>{s.push(l.generateCell(c))}),s}getFlexBaseWidth(){var c=this.table.element.clientWidth,s=0;return this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(c-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),this.columnsByIndex.forEach(function(l){var u,g,b;l.visible&&(u=l.definition.width||0,g=parseInt(l.minWidth),b="string"==typeof u?u.indexOf("%")>-1?c/100*parseInt(u):parseInt(u):u,s+=b>g?b:g)}),s}addColumn(c,s,l){return new Promise((u,g)=>{var b=this._addColumn(c,s,l);this._reIndexColumns(),this.dispatch("column-add",c,s,l),"fitColumns"!=this.layoutMode()&&b.reinitializeWidth(),this.redraw(!0),this.table.rowManager.reinitialize(),this.renderer.rerenderColumns(),u(b)})}deregisterColumn(c){var l,s=c.getField();s&&delete this.columnsByField[s],(l=this.columnsByIndex.indexOf(c))>-1&&this.columnsByIndex.splice(l,1),(l=this.columns.indexOf(c))>-1&&this.columns.splice(l,1),this.verticalAlignHeaders(),this.redraw()}redraw(c){Ws.elVisible(this.element)&&this.verticalAlignHeaders(),c&&(this.table.rowManager.resetScroll(),this.table.rowManager.reinitialize()),this.confirm("table-redrawing",c)||this.layoutRefresh(),this.dispatch("table-redraw",c),this.table.footerManager.redraw()}}class cf extends mh{constructor(c){super(c),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0}clearRows(){for(var c=this.tableElement;c.firstChild;)c.removeChild(c.firstChild);c.scrollTop=0,c.scrollLeft=0,c.style.minWidth="",c.style.minHeight="",c.style.display="",c.style.visibility=""}renderRows(){var c=this.tableElement,s=!0;this.rows().forEach((l,u)=>{this.styleRow(l,u),c.appendChild(l.getElement()),l.initialize(!0),"group"!==l.type&&(s=!1)}),c.style.minWidth=s?this.table.columnManager.getWidth()+"px":""}rerenderRows(c){this.render(),c&&c()}scrollToRowNearestTop(c){var s=Ws.elOffset(c.getElement()).top;return!(Math.abs(this.elementVertical.scrollTop-s)>Math.abs(this.elementVertical.scrollTop+this.elementVertical.clientHeight-s))}scrollToRow(c){var s=c.getElement();this.elementVertical.scrollTop=Ws.elOffset(s).top-Ws.elOffset(this.elementVertical).top+this.elementVertical.scrollTop}visibleRows(c){return this.rows()}}class uf extends mh{constructor(c){super(c),this.verticalFillMode="fill",this.scrollTop=0,this.scrollLeft=0,this.vDomRowHeight=20,this.vDomTop=0,this.vDomBottom=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomMaxRenderChain=90,this.vDomWindowBuffer=0,this.vDomWindowMinTotalRows=20,this.vDomWindowMinMarginRows=5,this.vDomTopNewRows=[],this.vDomBottomNewRows=[]}clearRows(){for(var c=this.tableElement;c.firstChild;)c.removeChild(c.firstChild);c.style.paddingTop="",c.style.paddingBottom="",c.style.minWidth="",c.style.minHeight="",c.style.display="",c.style.visibility="",this.elementVertical.scrollTop=0,this.elementVertical.scrollLeft=0,this.scrollTop=0,this.scrollLeft=0,this.vDomTop=0,this.vDomBottom=0,this.vDomTopPad=0,this.vDomBottomPad=0,this.vDomScrollPosTop=0,this.vDomScrollPosBottom=0}renderRows(){this._virtualRenderFill()}rerenderRows(c){for(var s=this.elementVertical.scrollTop,l=!1,u=!1,g=this.table.rowManager.scrollLeft,b=this.rows(),w=this.vDomTop;w<=this.vDomBottom;w++)if(b[w]){var k=s-b[w].getElement().offsetTop;if(!(!1===u||Math.abs(k)<u))break;u=k,l=w}b.forEach(H=>{H.deinitializeHeight()}),c&&c(),this._virtualRenderFill(!1===l?this.rows.length-1:l,!0,u||0),this.scrollColumns(g)}scrollColumns(c){this.table.rowManager.scrollHorizontal(c)}scrollRows(c,s){var l=c-this.vDomScrollPosTop,u=c-this.vDomScrollPosBottom,g=2*this.vDomWindowBuffer,b=this.rows();if(this.scrollTop=c,-l>g||u>g){var w=this.table.rowManager.scrollLeft;this._virtualRenderFill(Math.floor(this.elementVertical.scrollTop/this.elementVertical.scrollHeight*b.length)),this.scrollColumns(w)}else s?(l<0&&this._addTopRow(b,-l),u<0&&(this.vDomScrollHeight-this.scrollTop>this.vDomWindowBuffer?this._removeBottomRow(b,-u):this.vDomScrollPosBottom=this.scrollTop)):(u>=0&&this._addBottomRow(b,u),l>=0&&(this.scrollTop>this.vDomWindowBuffer?this._removeTopRow(b,l):this.vDomScrollPosTop=this.scrollTop))}resize(){this.vDomWindowBuffer=this.table.options.renderVerticalBuffer||this.elementVertical.clientHeight}scrollToRowNearestTop(c){var s=this.rows().indexOf(c);return!(Math.abs(this.vDomTop-s)>Math.abs(this.vDomBottom-s))}scrollToRow(c){var s=this.rows().indexOf(c);s>-1&&this._virtualRenderFill(s,!0)}visibleRows(c){var s=this.elementVertical.scrollTop,l=this.elementVertical.clientHeight+s,u=!1,g=0,b=0,w=this.rows();if(c)g=this.vDomTop,b=this.vDomBottom;else for(var k=this.vDomTop;k<=this.vDomBottom;k++)if(w[k])if(u){if(!(l-w[k].getElement().offsetTop>=0))break;b=k}else if(s-w[k].getElement().offsetTop>=0)g=k;else{if(u=!0,!(l-w[k].getElement().offsetTop>=0))break;b=k}return w.slice(g,b+1)}_virtualRenderFill(c,s,l){var u=this.tableElement,g=this.elementVertical,b=0,w=0,k=0,H=0,Z=0,ht=this.rows(),Pt=ht.length,qt=this.elementVertical.clientHeight;if(l=l||0,c=c||0){for(;u.firstChild;)u.removeChild(u.firstChild);(k=(Pt-c+1)*this.vDomRowHeight)<qt&&(c-=Math.ceil((qt-k)/this.vDomRowHeight))<0&&(c=0),c-=b=Math.min(Math.max(Math.floor(this.vDomWindowBuffer/this.vDomRowHeight),this.vDomWindowMinMarginRows),c)}else this.clear();if(Pt&&Ws.elVisible(this.elementVertical)){for(this.vDomTop=c,this.vDomBottom=c-1;(w<=qt+this.vDomWindowBuffer||Z<this.vDomWindowMinTotalRows)&&this.vDomBottom<Pt-1;){var Ge,be=this.vDomBottom+1,Le=ht[be];this.styleRow(Le,be),u.appendChild(Le.getElement()),Le.initialize(),Le.heightInitialized||Le.normalizeHeight(!0),Ge=Le.getHeight(),Z<b?H+=Ge:w+=Ge,Ge>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*Ge),this.vDomBottom++,Z++}c?(this.vDomTopPad=s?this.vDomRowHeight*this.vDomTop+l:this.scrollTop-H,this.vDomBottomPad=this.vDomBottom==Pt-1?0:Math.max(this.vDomScrollHeight-this.vDomTopPad-w-H,0)):(this.vDomTopPad=0,this.vDomRowHeight=Math.floor((w+H)/Z),this.vDomBottomPad=this.vDomRowHeight*(Pt-this.vDomBottom-1),this.vDomScrollHeight=H+w+this.vDomBottomPad-qt),u.style.paddingTop=this.vDomTopPad+"px",u.style.paddingBottom=this.vDomBottomPad+"px",s&&(this.scrollTop=this.vDomTopPad+H+l-(this.elementVertical.scrollWidth>this.elementVertical.clientWidth?this.elementVertical.offsetHeight-qt:0)),this.scrollTop=Math.min(this.scrollTop,this.elementVertical.scrollHeight-qt),this.elementVertical.scrollWidth>this.elementVertical.offsetWidth&&s&&(this.scrollTop+=this.elementVertical.offsetHeight-qt),this.vDomScrollPosTop=this.scrollTop,this.vDomScrollPosBottom=this.scrollTop,g.scrollTop=this.scrollTop,this.dispatch("render-virtual-fill")}}_addTopRow(c,s){for(var l=this.tableElement,u=[],g=0,b=this.vDomTop-1,w=0;this.vDomTop;){let H,Z,k=c[b];if(!(k&&w<this.vDomMaxRenderChain))break;if(H=k.getHeight()||this.vDomRowHeight,Z=k.initialized,!(s>=H))break;this.styleRow(k,b),l.insertBefore(k.getElement(),l.firstChild),(!k.initialized||!k.heightInitialized)&&u.push(k),k.initialize(),Z||(H=k.getElement().offsetHeight,H>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*H)),s-=H,g+=H,this.vDomTop--,b--,w++}for(let k of u)k.clearCellHeight();this._quickNormalizeRowHeight(u),g&&(this.vDomTopPad-=g,this.vDomTopPad<0&&(this.vDomTopPad=b*this.vDomRowHeight),b<1&&(this.vDomTopPad=0),l.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop-=g)}_removeTopRow(c,s){for(var l=[],u=0,g=0;;){let w,b=c[this.vDomTop];if(!(b&&g<this.vDomMaxRenderChain))break;if(w=b.getHeight()||this.vDomRowHeight,!(s>=w))break;this.vDomTop++,s-=w,u+=w,l.push(b),g++}for(let b of l){let w=b.getElement();w.parentNode&&w.parentNode.removeChild(w)}u&&(this.vDomTopPad+=u,this.tableElement.style.paddingTop=this.vDomTopPad+"px",this.vDomScrollPosTop+=this.vDomTop?u:u+this.vDomWindowBuffer)}_addBottomRow(c,s){for(var l=this.tableElement,u=[],g=0,b=this.vDomBottom+1,w=0;;){let H,Z,k=c[b];if(!(k&&w<this.vDomMaxRenderChain))break;if(H=k.getHeight()||this.vDomRowHeight,Z=k.initialized,!(s>=H))break;this.styleRow(k,b),l.appendChild(k.getElement()),(!k.initialized||!k.heightInitialized)&&u.push(k),k.initialize(),Z||(H=k.getElement().offsetHeight,H>this.vDomWindowBuffer&&(this.vDomWindowBuffer=2*H)),s-=H,g+=H,this.vDomBottom++,b++,w++}for(let k of u)k.clearCellHeight();this._quickNormalizeRowHeight(u),g&&(this.vDomBottomPad-=g,(this.vDomBottomPad<0||b==c.length-1)&&(this.vDomBottomPad=0),l.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom+=g)}_removeBottomRow(c,s){for(var l=[],u=0,g=0;;){let w,b=c[this.vDomBottom];if(!(b&&g<this.vDomMaxRenderChain))break;if(w=b.getHeight()||this.vDomRowHeight,!(s>=w))break;this.vDomBottom--,s-=w,u+=w,l.push(b),g++}for(let b of l){let w=b.getElement();w.parentNode&&w.parentNode.removeChild(w)}u&&(this.vDomBottomPad+=u,this.vDomBottomPad<0&&(this.vDomBottomPad=0),this.tableElement.style.paddingBottom=this.vDomBottomPad+"px",this.vDomScrollPosBottom-=u)}_quickNormalizeRowHeight(c){for(let s of c)s.calcHeight();for(let s of c)s.setCellHeight()}}class sg extends tu{constructor(c){super(c),this.element=this.createHolderElement(),this.tableElement=this.createTableElement(),this.heightFixer=this.createTableElement(),this.firstRender=!1,this.renderMode="virtual",this.fixedHeight=!1,this.rows=[],this.activeRowsPipeline=[],this.activeRows=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.scrollTop=0,this.scrollLeft=0,this.rowNumColumn=!1,this.redrawBlock=!1,this.redrawBlockRestoreConfig=!1,this.redrawBlockRederInPosition=!1,this.dataPipeline=[],this.displayPipeline=[],this.renderer=null}createHolderElement(){var c=document.createElement("div");return c.classList.add("tabulator-tableholder"),c.setAttribute("tabindex",0),c.setAttribute("role","rowgroup"),c}createTableElement(){var c=document.createElement("div");return c.classList.add("tabulator-table"),c.setAttribute("role","rowgroup"),c}getElement(){return this.element}getTableElement(){return this.tableElement}getRowPosition(c,s){return s?this.activeRows.indexOf(c):this.rows.indexOf(c)}initialize(){this.initializeRenderer(),this.element.appendChild(this.tableElement),this.firstRender=!0,this.element.addEventListener("scroll",()=>{var c=this.element.scrollLeft,s=this.scrollLeft>c,l=this.element.scrollTop,u=this.scrollTop>l;this.scrollLeft!=c&&(this.scrollLeft=c,this.dispatch("scroll-horizontal",c,s),this.dispatchExternal("scrollHorizontal",c,s)),this.scrollTop!=l&&(this.scrollTop=l,this.renderer.scrollRows(l,u),this.dispatch("scroll-vertical",l,u),this.dispatchExternal("scrollVertical",l,u))})}findRow(c){return"object"!=typeof c?null!=c&&(this.rows.find(l=>l.data[this.table.options.index]==c)||!1):c instanceof Gr?c:c instanceof eu?c._getSelf()||!1:"undefined"!=typeof HTMLElement&&c instanceof HTMLElement&&this.rows.find(l=>l.getElement()===c)||!1}getRowFromDataObject(c){return this.rows.find(l=>l.data===c)||!1}getRowFromPosition(c,s){return s?this.activeRows[c]:this.rows[c]}scrollToRow(c,s,l){return this.renderer.scrollToRowPosition(c,s,l)}setData(c,s,l){return new Promise((u,g)=>{s&&this.getDisplayRows().length?this.table.options.pagination?this._setDataActual(c,!0):this.reRenderInPosition(()=>{this._setDataActual(c)}):(this.table.options.autoColumns&&l&&this.table.initialized&&this.table.columnManager.generateColumnsFromRowData(c),this.resetScroll(),this._setDataActual(c)),u()})}_setDataActual(c,s){this.dispatchExternal("dataProcessing",c),this._wipeElements(),Array.isArray(c)?(this.dispatch("data-processing",c),c.forEach((l,u)=>{if(l&&"object"==typeof l){var g=new Gr(l,this);this.rows.push(g)}else console.warn("Data Loading Warning - Invalid row data detected and ignored, expecting object but received:",l)}),this.refreshActiveData(!1,!1,s),this.dispatch("data-processed",c),this.dispatchExternal("dataProcessed",c)):console.error("Data Loading Error - Unable to process data due to invalid data type \nExpecting: array \nReceived: ",typeof c,"\nData:     ",c)}_wipeElements(){this.dispatch("rows-wipe"),this.rows.forEach(c=>{c.wipe()}),this.rows=[],this.activeRows=[],this.activeRowsPipeline=[],this.activeRowsCount=0,this.displayRows=[],this.displayRowsCount=0,this.adjustTableSize()}deleteRow(c,s){var l=this.rows.indexOf(c),u=this.activeRows.indexOf(c);u>-1&&this.activeRows.splice(u,1),l>-1&&this.rows.splice(l,1),this.setActiveRows(this.activeRows),this.displayRowIterator(g=>{var b=g.indexOf(c);b>-1&&g.splice(b,1)}),s||this.reRenderInPosition(),this.regenerateRowNumbers(),this.dispatchExternal("rowDeleted",c.getComponent()),this.displayRowsCount||this._showPlaceholder(),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.getData())}addRow(c,s,l,u){var g=this.addRowActual(c,s,l,u);return this.dispatch("row-added",g,c,s,l),g}addRows(c,s,l){var u=[];return new Promise((g,b)=>{s=this.findAddRowPos(s),Array.isArray(c)||(c=[c]),(void 0===l&&s||void 0!==l&&!s)&&c.reverse(),c.forEach((w,k)=>{var H=this.addRow(w,s,l,!0);u.push(H),this.dispatch("row-added",H,c,s,l)}),this.refreshActiveData(!1,!1,!0),this.regenerateRowNumbers(),u.length&&this._clearPlaceholder(),g(u)})}findAddRowPos(c){return void 0===c&&(c=this.table.options.addRowPos),"pos"===c&&(c=!0),"bottom"===c&&(c=!1),c}addRowActual(c,s,l,u){var k,H,g=c instanceof Gr?c:new Gr(c||{},this),b=this.findAddRowPos(s),w=-1;return l||(H=this.chain("row-adding-position",[g,b],null,{index:l,top:b}),l=H.index,b=H.top),void 0!==l&&(l=this.findRow(l)),(l=this.chain("row-adding-index",[g,l,b],null,l))&&(w=this.rows.indexOf(l)),l&&w>-1?(k=this.activeRows.indexOf(l),this.displayRowIterator(function(Z){var ht=Z.indexOf(l);ht>-1&&Z.splice(b?ht:ht+1,0,g)}),k>-1&&this.activeRows.splice(b?k:k+1,0,g),this.rows.splice(b?w:w+1,0,g)):b?(this.displayRowIterator(function(Z){Z.unshift(g)}),this.activeRows.unshift(g),this.rows.unshift(g)):(this.displayRowIterator(function(Z){Z.push(g)}),this.activeRows.push(g),this.rows.push(g)),this.setActiveRows(this.activeRows),this.dispatchExternal("rowAdded",g.getComponent()),this.subscribedExternal("dataChanged")&&this.dispatchExternal("dataChanged",this.table.rowManager.getData()),u||this.reRenderInPosition(),g}moveRow(c,s,l){this.dispatch("row-move",c,s,l),this.moveRowActual(c,s,l),this.regenerateRowNumbers(),this.dispatch("row-moved",c,s,l),this.dispatchExternal("rowMoved",c.getComponent())}moveRowActual(c,s,l){this.moveRowInArray(this.rows,c,s,l),this.moveRowInArray(this.activeRows,c,s,l),this.displayRowIterator(u=>{this.moveRowInArray(u,c,s,l)}),this.dispatch("row-moving",c,s,l)}moveRowInArray(c,s,l,u){var g,b,k;if(s!==l&&((g=c.indexOf(s))>-1&&(c.splice(g,1),b=c.indexOf(l),c.splice(b>-1?u?b+1:b:g,0,s)),c===this.getDisplayRows())){k=b>g?b:g+1;for(let H=g<b?g:b;H<=k;H++)c[H]&&this.styleRow(c[H],H)}}clearData(){this.setData([])}getRowIndex(c){return this.findRowIndex(c,this.rows)}getDisplayRowIndex(c){var s=this.getDisplayRows().indexOf(c);return s>-1&&s}nextDisplayRow(c,s){var l=this.getDisplayRowIndex(c),u=!1;return!1!==l&&l<this.displayRowsCount-1&&(u=this.getDisplayRows()[l+1]),!u||u instanceof Gr&&"row"==u.type?u:this.nextDisplayRow(u,s)}prevDisplayRow(c,s){var l=this.getDisplayRowIndex(c),u=!1;return l&&(u=this.getDisplayRows()[l-1]),!s||!u||u instanceof Gr&&"row"==u.type?u:this.prevDisplayRow(u,s)}findRowIndex(c,s){var l;return!!((c=this.findRow(c))&&(l=s.indexOf(c),l>-1))&&l}getData(c,s){var l=[];return this.getRows(c).forEach(function(g){"row"==g.type&&l.push(g.getData(s||"data"))}),l}getComponents(c){var s=[];return this.getRows(c).forEach(function(u){s.push(u.getComponent())}),s}getDataCount(c){return this.getRows(c).length}scrollHorizontal(c){this.scrollLeft=c,this.element.scrollLeft=c,this.dispatch("scroll-horizontal",c)}registerDataPipelineHandler(c,s){void 0!==s?(this.dataPipeline.push({handler:c,priority:s}),this.dataPipeline.sort((l,u)=>l.priority-u.priority)):console.error("Data pipeline handlers must have a priority in order to be registered")}registerDisplayPipelineHandler(c,s){void 0!==s?(this.displayPipeline.push({handler:c,priority:s}),this.displayPipeline.sort((l,u)=>l.priority-u.priority)):console.error("Display pipeline handlers must have a priority in order to be registered")}refreshActiveData(c,s,l){var u=this.table,g="",b=0,w=["all","dataPipeline","display","displayPipeline","end"];if("function"==typeof c)if((b=this.dataPipeline.findIndex(k=>k.handler===c))>-1)g="dataPipeline",s&&(b==this.dataPipeline.length-1?g="display":b++);else{if(!((b=this.displayPipeline.findIndex(k=>k.handler===c))>-1))return void console.error("Unable to refresh data, invalid handler provided",c);g="displayPipeline",s&&(b==this.displayPipeline.length-1?g="end":b++)}else g=c||"all",b=0;if(this.redrawBlock)(!this.redrawBlockRestoreConfig||this.redrawBlockRestoreConfig&&(this.redrawBlockRestoreConfig.stage===g&&b<this.redrawBlockRestoreConfig.index||w.indexOf(g)<w.indexOf(this.redrawBlockRestoreConfig.stage)))&&(this.redrawBlockRestoreConfig={handler:c,skipStage:s,renderInPosition:l,stage:g,index:b});else{switch(this.dispatch("data-refeshing"),c||(this.activeRowsPipeline[0]=this.rows.slice(0)),g){case"all":case"dataPipeline":for(let k=b;k<this.dataPipeline.length;k++){let H=this.dataPipeline[k].handler(this.activeRowsPipeline[k].slice(0));this.activeRowsPipeline[k+1]=H||this.activeRowsPipeline[k].slice(0)}this.setActiveRows(this.activeRowsPipeline[this.dataPipeline.length]),this.regenerateRowNumbers();case"display":b=0,this.resetDisplayRows();case"displayPipeline":for(let k=b;k<this.displayPipeline.length;k++){let H=this.displayPipeline[k].handler((k?this.getDisplayRows(k-1):this.activeRows).slice(0),l);this.setDisplayRows(H||this.getDisplayRows(k-1).slice(0),k)}}Ws.elVisible(this.element)&&(l?this.reRenderInPosition():(c||this.table.columnManager.renderer.renderColumns(),this.renderTable(),u.options.layoutColumnsOnNewData&&this.table.columnManager.redraw(!0))),this.dispatch("data-refeshed")}}regenerateRowNumbers(){this.rowNumColumn&&this.activeRows.forEach(c=>{var s=c.getCell(this.rowNumColumn);s&&s._generateContents()})}setActiveRows(c){this.activeRows=c,this.activeRowsCount=this.activeRows.length}resetDisplayRows(){this.displayRows=[],this.displayRows.push(this.activeRows.slice(0)),this.displayRowsCount=this.displayRows[0].length}getNextDisplayIndex(){return this.displayRows.length}setDisplayRows(c,s){var l=!0;return s&&void 0!==this.displayRows[s]?(this.displayRows[s]=c,l=!0):(this.displayRows.push(c),l=s=this.displayRows.length-1),s==this.displayRows.length-1&&(this.displayRowsCount=this.displayRows[this.displayRows.length-1].length),l}getDisplayRows(c){return void 0===c?this.displayRows.length?this.displayRows[this.displayRows.length-1]:[]:this.displayRows[c]||[]}getVisibleRows(c){return this.renderer.visibleRows(!c)}displayRowIterator(c){this.activeRowsPipeline.forEach(c),this.displayRows.forEach(c),this.displayRowsCount=this.displayRows[this.displayRows.length-1].length}getRows(c){var s;switch(c){case"active":s=this.activeRows;break;case"display":s=this.table.rowManager.getDisplayRows();break;case"visible":s=this.getVisibleRows(!0);break;default:s=this.chain("rows-retrieve",c,null,this.rows)||this.rows}return s}reRenderInPosition(c){this.redrawBlock?c?c():this.redrawBlockRederInPosition=!0:this.renderer.rerenderRows(c)}initializeRenderer(){var c;(c="string"==typeof this.table.options.renderVertical?{virtual:uf,basic:cf}[this.table.options.renderVertical]:this.table.options.renderVertical)?(this.renderer=new c(this.table,this.element,this.tableElement),this.renderer.initialize(),this.fixedHeight=!(!this.table.element.clientHeight&&!this.table.options.height)):console.error("Unable to find matching renderer:",table.options.renderVertical)}getRenderMode(){return this.renderMode}renderTable(){this.dispatchExternal("renderStarted"),this.element.scrollTop=0,this._clearTable(),this.displayRowsCount?(this.renderer.renderRows(),this.firstRender&&(this.firstRender=!1,this.layoutRefresh())):this.renderEmptyScroll(),this.fixedHeight||this.adjustTableSize(),this.dispatch("table-layout"),this.displayRowsCount||this._showPlaceholder(),this.dispatchExternal("renderComplete")}renderEmptyScroll(){this.table.options.placeholder?this.tableElement.style.display="none":this.tableElement.style.minWidth=this.table.columnManager.getWidth()+"px"}_clearTable(){this._clearPlaceholder(),this.scrollTop=0,this.scrollLeft=0,this.renderer.clearRows()}_showPlaceholder(){this.table.options.placeholder&&(this.table.options.placeholder.setAttribute("tabulator-render-mode",this.renderMode),this.getElement().appendChild(this.table.options.placeholder),this.table.options.placeholder.style.width=this.table.columnManager.getWidth()+"px")}_clearPlaceholder(){this.table.options.placeholder&&this.table.options.placeholder.parentNode&&this.table.options.placeholder.parentNode.removeChild(this.table.options.placeholder)}styleRow(c,s){var l=c.getElement();s%2?(l.classList.add("tabulator-row-even"),l.classList.remove("tabulator-row-odd")):(l.classList.add("tabulator-row-odd"),l.classList.remove("tabulator-row-even"))}normalizeHeight(){this.activeRows.forEach(function(c){c.normalizeHeight()})}adjustTableSize(){var c=this.element.clientHeight;if("fill"===this.renderer.verticalFillMode){let s=Math.floor(this.table.columnManager.getElement().getBoundingClientRect().height+(this.table.footerManager&&this.table.footerManager.active&&!this.table.footerManager.external?this.table.footerManager.getElement().getBoundingClientRect().height:0));this.fixedHeight?(this.element.style.minHeight="calc(100% - "+s+"px)",this.element.style.height="calc(100% - "+s+"px)",this.element.style.maxHeight="calc(100% - "+s+"px)"):(this.element.style.height="",this.element.style.height=this.table.element.clientHeight-s+"px",this.element.scrollTop=this.scrollTop),this.renderer.resize(),!this.fixedHeight&&c!=this.element.clientHeight&&(this.subscribed("table-resize")?this.dispatch("table-resize"):this.redraw())}}reinitialize(){this.rows.forEach(function(c){c.reinitialize(!0)})}blockRedraw(){this.redrawBlock=!0,this.redrawBlockRestoreConfig=!1}restoreRedraw(){this.redrawBlock=!1,this.redrawBlockRestoreConfig?(this.refreshActiveData(this.redrawBlockRestoreConfig.handler,this.redrawBlockRestoreConfig.skipStage,this.redrawBlockRestoreConfig.renderInPosition),this.redrawBlockRestoreConfig=!1):this.redrawBlockRederInPosition&&this.reRenderInPosition(),this.redrawBlockRederInPosition=!1}redraw(c){var s=this.scrollLeft;this.adjustTableSize(),this.table.tableWidth=this.table.element.clientWidth,c?this.renderTable():(this.reRenderInPosition(),this.scrollHorizontal(s),this.displayRowsCount||this.table.options.placeholder&&this.getElement().appendChild(this.table.options.placeholder))}resetScroll(){if(this.element.scrollLeft=0,this.element.scrollTop=0,"ie"===this.table.browser){var c=document.createEvent("Event");c.initEvent("scroll",!1,!0),this.element.dispatchEvent(c)}else this.element.dispatchEvent(new Event("scroll"))}}class bp extends tu{constructor(c){super(c),this.active=!1,this.element=this.createElement(),this.external=!1,this.links=[],this.initializeElement()}initialize(){this.initializeElement()}createElement(){var c=document.createElement("div");return c.classList.add("tabulator-footer"),c}initializeElement(){this.table.options.footerElement&&("string"==typeof this.table.options.footerElement?"<"===this.table.options.footerElement[0]?this.element.innerHTML=this.table.options.footerElement:(this.external=!0,this.element=document.querySelector(this.table.options.footerElement)):this.element=this.table.options.footerElement)}getElement(){return this.element}append(c,s){this.activate(s),this.element.appendChild(c),this.table.rowManager.adjustTableSize()}prepend(c,s){this.activate(s),this.element.insertBefore(c,this.element.firstChild),this.table.rowManager.adjustTableSize()}remove(c){c.parentNode.removeChild(c),this.deactivate()}deactivate(c){(!this.element.firstChild||c)&&(this.external||this.element.parentNode.removeChild(this.element),this.active=!1)}activate(c){this.active||(this.active=!0,this.external||(this.table.element.appendChild(this.getElement()),this.table.element.style.display="")),c&&this.links.push(c)}redraw(){this.links.forEach(function(c){c.footerRedraw()})}}class ag extends tu{constructor(c){super(c),this.el=this.table.element,this.abortClasses=["tabulator-headers","tabulator-table"],this.previousTargets={},this.listeners=["click","dblclick","contextmenu","mouseenter","mouseleave","mouseover","mouseout","mousemove","touchstart","touchend"],this.componentMap={"tabulator-cell":"cell","tabulator-row":"row","tabulator-group":"group","tabulator-col":"column"},this.buildListenerMap(),this.bindSubscriptionWatchers()}buildListenerMap(){var c={};this.listeners.forEach(s=>{c[s]={handler:null,components:[]}}),this.listeners=c}bindSubscriptionWatchers(){var c=Object.keys(this.listeners),s=Object.values(this.componentMap);for(let l of s)for(let u of c)this.subscriptionChange(l+"-"+u,this.subscriptionChanged.bind(this,l,u))}subscriptionChanged(c,s,l){var u=this.listeners[s].components,g=u.indexOf(c),b=!1;l?-1===g&&(u.push(c),b=!0):this.subscribed(c+"-"+s)||g>-1&&(u.splice(g,1),b=!0),b&&this.updateEventListeners()}updateEventListeners(){for(let c in this.listeners){let s=this.listeners[c];s.components.length?s.handler||(s.handler=this.track.bind(this,c),this.el.addEventListener(c,s.handler)):s.handler&&(this.el.removeEventListener(c,s.handler),s.handler=null)}}track(c,s){var l=s.composedPath&&s.composedPath()||s.path,u=this.findTargets(l);u=this.bindComponents(c,u),this.triggerEvents(c,s,u)}findTargets(c){var s={};let l=Object.keys(this.componentMap);for(let u of c){let g=u.classList?[...u.classList]:[];if(g.filter(k=>this.abortClasses.includes(k)).length)break;let w=g.filter(k=>l.includes(k));for(let k of w)s[this.componentMap[k]]=u}return s.group&&s.group===s.row&&delete s.row,s}bindComponents(c,s){var l=Object.keys(s).reverse(),u=this.listeners[c],g={};for(let b of l){let w,k=s[b],H=this.previousTargets[b];if(H&&H.target===k)w=H.component;else switch(b){case"row":case"group":(u.components.includes("row")||u.components.includes("cell"))&&(w=this.table.rowManager.getVisibleRows().find(ht=>ht.getElement()===k));break;case"column":u.components.includes("column")&&(w=this.table.columnManager.findColumn(k));break;case"cell":u.components.includes("cell")&&(w=s.row.findCell(k))}w&&(s[b]=w,g[b]={target:k,component:w})}return this.previousTargets=g,s}triggerEvents(c,s,l){var u=this.listeners[c];for(let g in l)l[g]&&u.components.includes(g)&&this.dispatch(g+"-"+c,s,l[g])}}class lg{constructor(c){this.table=c,this.bindings={}}bind(c,s,l){this.bindings[c]||(this.bindings[c]={}),this.bindings[c][s]?console.warn("Unable to bind component handler, a matching function name is already bound",c,s,hanlder):this.bindings[c][s]=l}handle(c,s,l){if(this.bindings[c]&&this.bindings[c][l])return this.bindings[c][l].bind(null,s);"then"!==l&&"string"==typeof l&&!l.startsWith("_")&&console.error("The "+c+" component does not have a "+l+" function, have you checked that you have the correct Tabulator module installed?")}}class hf extends tu{constructor(c){super(c),this.loaderElement=this.createLoaderElement(),this.msgElement=this.createMsgElement(),this.loadingElement=null,this.errorElement=null,this.requestOrder=0,this.loading=!1}initialize(){var c;this.loaderElement.appendChild(this.msgElement),this.table.options.dataLoaderLoading&&("string"==typeof this.table.options.dataLoaderLoading?((c=document.createElement("template")).innerHTML=this.table.options.dataLoaderLoading.trim(),this.loadingElement=c.firstElementChild):this.loadingElement=this.table.options.dataLoaderLoading),this.table.options.dataLoaderError&&("string"==typeof this.table.options.dataLoaderError?((c=document.createElement("template")).innerHTML=this.table.options.dataLoaderError.trim(),this.errorElement=c.firstElementChild):this.errorElement=this.table.options.dataLoaderError)}createLoaderElement(){var c=document.createElement("div");return c.classList.add("tabulator-loader"),c}createMsgElement(){var c=document.createElement("div");return c.classList.add("tabulator-loader-msg"),c.setAttribute("role","alert"),c}load(c,s,l,u,g){var b=++this.requestOrder;return this.dispatchExternal("dataLoading",c),c&&(0==c.indexOf("{")||0==c.indexOf("["))&&(c=JSON.parse(c)),this.confirm("data-loading",c,s,l,g)?(this.loading=!0,g||this.showLoader(),s=this.chain("data-params",[c,l,g],s||{},{}),s=this.mapParams(s,this.table.options.dataSendParams),this.chain("data-load",[c,s,l,g],Promise.resolve([])).then(H=>{!Array.isArray(H)&&"object"==typeof H&&(H=this.mapParams(H,this.objectInvert(this.table.options.dataReceiveParams)));var Z=this.chain("data-loaded",H,null,H);b==this.requestOrder?(this.hideLoader(),!1!==Z&&(this.dispatchExternal("dataLoaded",Z),this.table.rowManager.setData(Z,u,!u))):console.warn("Data Load Response Blocked - An active data load request was blocked by an attempt to change table data while the request was being made")}).catch(H=>{console.error("Data Load Error: ",H),this.dispatchExternal("dataLoadError",H),g||this.showError(),setTimeout(()=>{this.hideLoader()},3e3)}).finally(()=>{this.loading=!1})):(this.dispatchExternal("dataLoaded",c),c||(c=[]),this.table.rowManager.setData(c,u,!u),Promise.resolve())}mapParams(c,s){var l={};for(let u in c)l[s.hasOwnProperty(u)?s[u]:u]=c[u];return l}objectInvert(c){var s={};for(let l in c)s[c[l]]=l;return s}blockActiveLoad(){this.requestOrder++}showLoader(){if("function"==typeof this.table.options.dataLoader?this.table.options.dataLoader():this.table.options.dataLoader){for(this.hideLoader();this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.remove("tabulator-error"),this.msgElement.classList.add("tabulator-loading"),this.loadingElement?this.msgElement.appendChild(this.loadingElement):this.msgElement.innerHTML=this.langText("data|loading"),this.table.element.appendChild(this.loaderElement)}}showError(){for(this.hideLoader();this.msgElement.firstChild;)this.msgElement.removeChild(this.msgElement.firstChild);this.msgElement.classList.remove("tabulator-loading"),this.msgElement.classList.add("tabulator-error"),this.errorElement?this.msgElement.appendChild(this.errorElement):this.msgElement.innerHTML=this.langText("data|error"),this.table.element.appendChild(this.loaderElement)}hideLoader(){this.loaderElement.parentNode&&this.loaderElement.parentNode.removeChild(this.loaderElement)}}class nd{constructor(c,s,l){this.table=c,this.events={},this.optionsList=s||{},this.subscriptionNotifiers={},this.dispatch=l?this._debugDispatch.bind(this):this._dispatch.bind(this),this.debug=l}subscriptionChange(c,s){this.subscriptionNotifiers[c]||(this.subscriptionNotifiers[c]=[]),this.subscriptionNotifiers[c].push(s),this.subscribed(c)&&this._notifiySubscriptionChange(c,!0)}subscribe(c,s){this.events[c]||(this.events[c]=[]),this.events[c].push(s),this._notifiySubscriptionChange(c,!0)}unsubscribe(c,s){var l;if(this.events[c]){if(s){if(!((l=this.events[c].findIndex(u=>u===s))>-1))return void console.warn("Cannot remove event, no matching event found:",c,s);this.events[c].splice(l,1)}else delete this.events[c];this._notifiySubscriptionChange(c,!1)}else console.warn("Cannot remove event, no events set on:",c)}subscribed(c){return this.events[c]&&this.events[c].length}_notifiySubscriptionChange(c,s){var l=this.subscriptionNotifiers[c];l&&l.forEach(u=>{u(s)})}_dispatch(){var l,c=Array.from(arguments),s=c.shift();return this.events[s]&&this.events[s].forEach((u,g)=>{let b=u.apply(this.table,c);g||(l=b)}),l}_debugDispatch(){var c=Array.from(arguments),s=c[0];return c[0]="ExternalEvent:"+c[0],(!0===this.debug||this.debug.includes(s))&&console.log(...c),this._dispatch(...arguments)}}class df{constructor(c){this.events={},this.subscriptionNotifiers={},this.dispatch=c?this._debugDispatch.bind(this):this._dispatch.bind(this),this.chain=c?this._debugChain.bind(this):this._chain.bind(this),this.confirm=c?this._debugConfirm.bind(this):this._confirm.bind(this),this.debug=c}subscriptionChange(c,s){this.subscriptionNotifiers[c]||(this.subscriptionNotifiers[c]=[]),this.subscriptionNotifiers[c].push(s),this.subscribed(c)&&this._notifiySubscriptionChange(c,!0)}subscribe(c,s,l=1e4){this.events[c]||(this.events[c]=[]),this.events[c].push({callback:s,priority:l}),this.events[c].sort((u,g)=>u.priority-g.priority),this._notifiySubscriptionChange(c,!0)}unsubscribe(c,s){var l;if(this.events[c]){if(s){if(!((l=this.events[c].findIndex(u=>u.callback===s))>-1))return void console.warn("Cannot remove event, no matching event found:",c,s);this.events[c].splice(l,1)}this._notifiySubscriptionChange(c,!1)}else console.warn("Cannot remove event, no events set on:",c)}subscribed(c){return this.events[c]&&this.events[c].length}_chain(c,s,l,u){var g=l;return Array.isArray(s)||(s=[s]),this.subscribed(c)?(this.events[c].forEach((b,w)=>{g=b.callback.apply(this,s.concat([g]))}),g):"function"==typeof u?u():u}_confirm(c,s){var l=!1;return Array.isArray(s)||(s=[s]),this.subscribed(c)&&this.events[c].forEach((u,g)=>{u.callback.apply(this,s)&&(l=!0)}),l}_notifiySubscriptionChange(c,s){var l=this.subscriptionNotifiers[c];l&&l.forEach(u=>{u(s)})}_dispatch(){var c=Array.from(arguments),s=c.shift();this.events[s]&&this.events[s].forEach(l=>{l.callback.apply(this,c)})}_debugDispatch(){var c=Array.from(arguments),s=c[0];return c[0]="InternalEvent:"+s,(!0===this.debug||this.debug.includes(s))&&console.log(...c),this._dispatch(...arguments)}_debugChain(){var c=Array.from(arguments),s=c[0];return c[0]="InternalEvent:"+s,(!0===this.debug||this.debug.includes(s))&&console.log(...c),this._chain(...arguments)}_debugConfirm(){var c=Array.from(arguments),s=c[0];return c[0]="InternalEvent:"+s,(!0===this.debug||this.debug.includes(s))&&console.log(...c),this._confirm(...arguments)}}let Vd=(()=>{class v{static register(s){v.tables.push(s)}static deregister(s){var l=v.tables.indexOf(s);l>-1&&v.tables.splice(l,1)}static lookupTable(s,l){var g,b,u=[];if("string"==typeof s){if((g=document.querySelectorAll(s)).length)for(var w=0;w<g.length;w++)(b=v.matchElement(g[w]))&&u.push(b)}else"undefined"!=typeof HTMLElement&&s instanceof HTMLElement||s instanceof vh?(b=v.matchElement(s))&&u.push(b):Array.isArray(s)?s.forEach(function(k){u=u.concat(v.lookupTable(k))}):l||console.warn("Table Connection Error - Invalid Selector",s);return u}static matchElement(s){return v.tables.find(function(l){return s instanceof vh?l===s:l.element===s})}}return v.tables=[],v})();function Vh(v){v.forEach(function(c){c.reinitializeWidth()}),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()}var dg={fitData:function cg(v){this.table.columnManager.renderer.reinitializeColumnWidths(v),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitDataFill:Vh,fitDataTable:Vh,fitDataStretch:function ug(v){var c=0,s=this.table.rowManager.element.clientWidth,l=0,u=!1;v.forEach((g,b)=>{g.widthFixed||g.reinitializeWidth(),(this.table.options.responsiveLayout?g.modules.responsive.visible:g.visible)&&(u=g),g.visible&&(c+=g.getWidth())}),u?(l=s-c+u.getWidth(),this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&(u.setWidth(0),this.table.modules.responsiveLayout.update()),l>0?u.setWidth(l):u.reinitializeWidth()):this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update()},fitColumns:function hg(v){var g,H,c=this.table.element.clientWidth,s=0,l=0,u=0,b=[],w=[],k=0,Pt=0;function Z(qt){return"string"==typeof qt?qt.indexOf("%")>-1?c/100*parseInt(qt):parseInt(qt):qt}function ht(qt,be,Le,Ge){var Xe=[],Ei=0,an=0,Hi=0,Wi=u,yn=0,fn=0,An=[];function Bn(Qi){return Le*(Qi.column.definition.widthGrow||1)}function Cn(Qi){return Z(Qi.width)-Le*(Qi.column.definition.widthShrink||0)}return qt.forEach(function(Qi,Vn){var mo=Ge?Cn(Qi):Bn(Qi);Qi.column.minWidth>=mo?Xe.push(Qi):Qi.column.maxWidth&&Qi.column.maxWidth<mo?(Qi.width=Qi.column.maxWidth,be-=Qi.column.maxWidth,(Wi-=Ge?Qi.column.definition.widthShrink||1:Qi.column.definition.widthGrow||1)&&(Le=Math.floor(be/Wi))):(An.push(Qi),fn+=Ge?Qi.column.definition.widthShrink||1:Qi.column.definition.widthGrow||1)}),Xe.length?(Xe.forEach(function(Qi){Ei+=Ge?Qi.width-Qi.column.minWidth:Qi.column.minWidth,Qi.width=Qi.column.minWidth}),yn=(an=be-Ei)-(Hi=fn?Math.floor(an/fn):an)*fn,yn+=ht(An,an,Hi,Ge)):(yn=fn?be-Math.floor(be/fn)*fn:be,An.forEach(function(Qi){Qi.width=Ge?Cn(Qi):Bn(Qi)})),yn}this.table.options.responsiveLayout&&this.table.modExists("responsiveLayout",!0)&&this.table.modules.responsiveLayout.update(),this.table.rowManager.element.scrollHeight>this.table.rowManager.element.clientHeight&&(c-=this.table.rowManager.element.offsetWidth-this.table.rowManager.element.clientWidth),v.forEach(function(qt){var be,Le,Ge;qt.visible&&(be=qt.definition.width,Le=parseInt(qt.minWidth),be?(Ge=Z(be),s+=Ge>Le?Ge:Le,qt.definition.widthShrink&&(w.push({column:qt,width:Ge>Le?Ge:Le}),k+=qt.definition.widthShrink)):(b.push({column:qt,width:0}),u+=qt.definition.widthGrow||1))}),l=c-s,g=Math.floor(l/u),Pt=ht(b,l,g,!1),b.length&&Pt>0&&(b[b.length-1].width+=+Pt),b.forEach(function(qt){l-=qt.width}),(H=Math.abs(Pt)+l)>0&&k&&(Pt=ht(w,H,Math.floor(H/k),!0)),w.length&&(w[w.length-1].width-=Pt),b.forEach(function(qt){qt.column.setWidth(qt.width)}),w.forEach(function(qt){qt.column.setWidth(qt.width)})}},iu={default:{groups:{item:"item",items:"items"},columns:{},data:{loading:"Loading",error:"Error"},pagination:{page_size:"Page Size",page_title:"Show Page",first:"First",first_title:"First Page",last:"Last",last_title:"Last Page",prev:"Prev",prev_title:"Prev Page",next:"Next",next_title:"Next Page",all:"All"},headerFilters:{default:"filter column...",columns:{}}}},ff=Object.freeze({__proto__:null,LayoutModule:(()=>{class v extends vr{constructor(s){super(s,"layout"),this.mode=null,this.registerTableOption("layout","fitData"),this.registerTableOption("layoutColumnsOnNewData",!1),this.registerColumnOption("widthGrow"),this.registerColumnOption("widthShrink")}initialize(){var s=this.table.options.layout;v.modes[s]?this.mode=s:(console.warn("Layout Error - invalid mode set, defaulting to 'fitData' : "+s),this.mode="fitData"),this.table.element.setAttribute("tabulator-layout",this.mode)}getMode(){return this.mode}layout(){v.modes[this.mode].call(this,this.table.columnManager.columnsByIndex),this.dispatch("layout-refreshed")}}return v.moduleName="layout",v.modes=dg,v})(),LocalizeModule:(()=>{class v extends vr{constructor(s){super(s),this.locale="default",this.lang=!1,this.bindings={},this.langList={},this.registerTableOption("locale",!1),this.registerTableOption("langs",{})}initialize(){this.langList=Ws.deepClone(v.langs),!1!==this.table.options.columnDefaults.headerFilterPlaceholder&&this.setHeaderFilterPlaceholder(this.table.options.columnDefaults.headerFilterPlaceholder);for(let s in this.table.options.langs)this.installLang(s,this.table.options.langs[s]);this.setLocale(this.table.options.locale),this.registerTableFunction("setLocale",this.setLocale.bind(this)),this.registerTableFunction("getLocale",this.getLocale.bind(this)),this.registerTableFunction("getLang",this.getLang.bind(this))}setHeaderFilterPlaceholder(s){this.langList.default.headerFilters.default=s}setHeaderFilterColumnPlaceholder(s,l){this.langList.default.headerFilters.columns[s]=l,this.lang&&!this.lang.headerFilters.columns[s]&&(this.lang.headerFilters.columns[s]=l)}installLang(s,l){this.langList[s]?this._setLangProp(this.langList[s],l):this.langList[s]=l}_setLangProp(s,l){for(let u in l)s[u]&&"object"==typeof s[u]?this._setLangProp(s[u],l[u]):s[u]=l[u]}setLocale(s){if(!0===(s=s||"default")&&navigator.language&&(s=navigator.language.toLowerCase()),s&&!this.langList[s]){let u=s.split("-")[0];this.langList[u]?(console.warn("Localization Error - Exact matching locale not found, using closest match: ",s,u),s=u):(console.warn("Localization Error - Matching locale not found, using default: ",s),s="default")}this.locale=s,this.lang=Ws.deepClone(this.langList.default||{}),"default"!=s&&function l(u,g){for(var b in u)"object"==typeof u[b]?(g[b]||(g[b]={}),l(u[b],g[b])):g[b]=u[b]}(this.langList[s],this.lang),this.dispatchExternal("localized",this.locale,this.lang),this._executeBindings()}getLocale(s){return this.locale}getLang(s){return s?this.langList[s]:this.lang}getText(u,l){var g=(u=l?u+"|"+l:u).split("|");return this._getLangElement(g,this.locale)||""}_getLangElement(s,l){var u=this.lang;return s.forEach(function(g){var b;u&&(u=void 0!==(b=u[g])&&b)}),u}bind(s,l){this.bindings[s]||(this.bindings[s]=[]),this.bindings[s].push(l),l(this.getText(s),this.lang)}_executeBindings(){for(let s in this.bindings)this.bindings[s].forEach(l=>{l(this.getText(s),this.lang)})}}return v.moduleName="localize",v.langs=iu,v})(),CommsModule:(()=>{class v extends vr{constructor(s){super(s)}initialize(){this.registerTableFunction("tableComms",this.receive.bind(this))}getConnections(s){var l=[];return Vd.lookupTable(s).forEach(g=>{this.table!==g&&l.push(g)}),l}send(s,l,u,g){var b=this.getConnections(s);b.forEach(w=>{w.tableComms(this.table.element,l,u,g)}),!b.length&&s&&console.warn("Table Connection Error - No tables matching selector found",s)}receive(s,l,u,g){if(this.table.modExists(l))return this.table.modules[l].commsReceived(s,u,g);console.warn("Inter-table Comms Error - no such module:",l)}}return v.moduleName="comms",v})()});class Ep{constructor(c,s){this.bindStaticFuctionality(c),this.bindModules(c,ff,!0),s&&this.bindModules(c,s)}bindStaticFuctionality(c){c.moduleBindings={},c.extendModule=function(s,l,u){if(c.moduleBindings[s]){var g=c.moduleBindings[s][l];if(g)if("object"==typeof u)for(let b in u)g[b]=u[b];else console.warn("Module Error - Invalid value type, it must be an object");else console.warn("Module Error - property does not exist:",l)}else console.warn("Module Error - module does not exist:",s)},c.registerModule=function(s){Array.isArray(s)||(s=[s]),s.forEach(l=>{c.registerModuleBinding(l)})},c.registerModuleBinding=function(s){c.moduleBindings[s.moduleName]=s},c.findTable=function(s){var l=Vd.lookupTable(s,!0);return!(Array.isArray(l)&&!l.length)&&l},c.prototype.bindModules=function(){for(var s in this.modules={},c.moduleBindings){let l=c.moduleBindings[s];this.modules[s]=new l(this),l.prototype.moduleCore?this.modulesCore[s]=this.modules[s]:this.modulesRegular[s]=this.modules[s]}}}bindModules(c,s,l){var u=Object.values(s);l&&u.forEach(g=>{g.prototype.moduleCore=!0}),c.registerModule(u)}}let vh=(()=>{class v{constructor(s,l){this.options={},this.columnManager=null,this.rowManager=null,this.footerManager=null,this.vdomHoz=null,this.externalEvents=null,this.eventBus=null,this.interactionMonitor=!1,this.browser="",this.browserSlow=!1,this.browserMobile=!1,this.rtl=!1,this.originalElement=null,this.componentFunctionBinder=new lg(this),this.dataLoader=!1,this.modules={},this.modulesCore={},this.modulesRegular={},this.optionsList=new Ud(this,"table constructor"),this.initialized=!1,this.initializeElement(s)&&(this.initialzeCoreSystems(l),setTimeout(()=>{this._create()})),Vd.register(this)}initializeElement(s){return"undefined"!=typeof HTMLElement&&s instanceof HTMLElement?(this.element=s,!0):"string"==typeof s?(this.element=document.querySelector(s),!!this.element||(console.error("Tabulator Creation Error - no element found matching selector: ",s),!1)):(console.error("Tabulator Creation Error - Invalid element provided:",s),!1)}initialzeCoreSystems(s){this.columnManager=new lf(this),this.rowManager=new sg(this),this.footerManager=new bp(this),this.dataLoader=new hf(this),this.bindModules(),this.options=this.optionsList.generate(v.defaultOptions,s),this._clearObjectPointers(),this._mapDepricatedFunctionality(),this.externalEvents=new nd(this,this.options,this.options.debugEventsExternal),this.eventBus=new df(this.options.debugEventsInternal),this.interactionMonitor=new ag(this),this.dataLoader.initialize(),this.columnManager.initialize(),this.rowManager.initialize(),this.footerManager.initialize()}_mapDepricatedFunctionality(){}_clearSelection(){this.element.classList.add("tabulator-block-select"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty(),this.element.classList.remove("tabulator-block-select")}_create(){this.externalEvents.dispatch("tableBuilding"),this.eventBus.dispatch("table-building"),this._rtlCheck(),this._buildElement(),this._initializeTable(),this._loadInitialData(),this.initialized=!0,this.externalEvents.dispatch("tableBuilt")}_rtlCheck(){var s=window.getComputedStyle(this.element);switch(this.options.textDirection){case"auto":if("rtl"!==s.direction)break;case"rtl":this.element.classList.add("tabulator-rtl"),this.rtl=!0;break;case"ltr":this.element.classList.add("tabulator-ltr");default:this.rtl=!1}}_clearObjectPointers(){this.options.columns=this.options.columns.slice(0),this.options.data&&!this.options.reactiveData&&(this.options.data=this.options.data.slice(0))}_buildElement(){var u,s=this.element,l=this.options;if("TABLE"===s.tagName){this.originalElement=this.element,u=document.createElement("div");var g=s.attributes;for(var b in g)"object"==typeof g[b]&&u.setAttribute(g[b].name,g[b].value);s.parentNode.replaceChild(u,s),this.element=s=u}for(s.classList.add("tabulator"),s.setAttribute("role","grid");s.firstChild;)s.removeChild(s.firstChild);l.height&&(l.height=isNaN(l.height)?l.height:l.height+"px",s.style.height=l.height),!1!==l.minHeight&&(l.minHeight=isNaN(l.minHeight)?l.minHeight:l.minHeight+"px",s.style.minHeight=l.minHeight),!1!==l.maxHeight&&(l.maxHeight=isNaN(l.maxHeight)?l.maxHeight:l.maxHeight+"px",s.style.maxHeight=l.maxHeight)}_initializeTable(){var s=this.element,l=this.options;this.columnManager.initialize(),this.rowManager.initialize(),this._detectBrowser();for(let b in this.modulesCore)this.modulesCore[b].initialize();if("string"==typeof l.placeholder){var u=document.createElement("div");u.classList.add("tabulator-placeholder");var g=document.createElement("span");g.innerHTML=l.placeholder,u.appendChild(g),l.placeholder=u}s.appendChild(this.columnManager.getElement()),s.appendChild(this.rowManager.getElement()),l.footerElement&&this.footerManager.activate(),l.autoColumns&&l.data&&this.columnManager.generateColumnsFromRowData(this.options.data);for(let b in this.modulesRegular)this.modulesRegular[b].initialize();this.columnManager.setColumns(l.columns),this.eventBus.dispatch("table-built")}_loadInitialData(){this.dataLoader.load(this.options.data)}destroy(){var s=this.element;for(Vd.deregister(this),this.eventBus.dispatch("table-destroy"),this.rowManager.rows.forEach(function(l){l.wipe()}),this.rowManager.rows=[],this.rowManager.activeRows=[],this.rowManager.displayRows=[];s.firstChild;)s.removeChild(s.firstChild);s.classList.remove("tabulator")}_detectBrowser(){var s=navigator.userAgent||navigator.vendor||window.opera;s.indexOf("Trident")>-1?(this.browser="ie",this.browserSlow=!0):s.indexOf("Edge")>-1?(this.browser="edge",this.browserSlow=!0):s.indexOf("Firefox")>-1?(this.browser="firefox",this.browserSlow=!1):(this.browser="other",this.browserSlow=!1),this.browserMobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(s)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(s.substr(0,4))}blockRedraw(){return this.rowManager.blockRedraw()}restoreRedraw(){return this.rowManager.restoreRedraw()}setDataFromLocalFile(s){return new Promise((l,u)=>{var g=document.createElement("input");g.type="file",g.accept=s||".json,application/json",g.addEventListener("change",b=>{var H,w=g.files[0],k=new FileReader;k.readAsText(w),k.onload=Z=>{try{H=JSON.parse(k.result)}catch(ht){return console.warn("File Load Error - File contents is invalid JSON",ht),void u(ht)}this.setData(H).then(ht=>{l(ht)}).catch(ht=>{l(ht)})},k.onerror=Z=>{console.warn("File Load Error - Unable to read file"),u()}}),g.click()})}setData(s,l,u){if(this.initialized)return this.dataLoader.load(s,l,u,!1);console.warn("setData failed - table not yet initialized. To set initial data please use the 'data' property in the table constructor.")}clearData(){this.dataLoader.blockActiveLoad(),this.rowManager.clearData()}getData(s){return this.rowManager.getData(s)}getDataCount(s){return this.rowManager.getDataCount(s)}replaceData(s,l,u){if(this.initialized)return this.dataLoader.load(s,l,u,!0,!0);console.warn("replaceData failed - table not yet initialized. Please wait for the `tableBuilt` event before calling this function.")}updateData(s){var l=0;if(this.initialized)return new Promise((u,g)=>{this.dataLoader.blockActiveLoad(),"string"==typeof s&&(s=JSON.parse(s)),s?s.forEach(b=>{var w=this.rowManager.findRow(b[this.options.index]);w&&(l++,w.updateData(b).then(()=>{--l||u()}))}):(console.warn("Update Error - No data provided"),g("Update Error - No data provided"))});console.warn("updateData failed - table not yet initialized. Please wait for the `tableBuilt` event before calling this function.")}addData(s,l,u){if(this.initialized)return new Promise((g,b)=>{this.dataLoader.blockActiveLoad(),"string"==typeof s&&(s=JSON.parse(s)),s?this.rowManager.addRows(s,l,u).then(w=>{var k=[];w.forEach(function(H){k.push(H.getComponent())}),g(k)}):(console.warn("Update Error - No data provided"),b("Update Error - No data provided"))});console.warn("addData failed - table not yet initialized. Please wait for the `tableBuilt` event before calling this function.")}updateOrAddData(s){var l=[],u=0;if(this.initialized)return new Promise((g,b)=>{this.dataLoader.blockActiveLoad(),"string"==typeof s&&(s=JSON.parse(s)),s?s.forEach(w=>{var k=this.rowManager.findRow(w[this.options.index]);u++,k?k.updateData(w).then(()=>{u--,l.push(k.getComponent()),u||g(l)}):this.rowManager.addRows(w).then(H=>{u--,l.push(H[0].getComponent()),u||g(l)})}):(console.warn("Update Error - No data provided"),b("Update Error - No data provided"))});console.warn("updateOrAddData failed - table not yet initialized. Please wait for the `tableBuilt` event before calling this function.")}getRow(s){var l=this.rowManager.findRow(s);return l?l.getComponent():(console.warn("Find Error - No matching row found:",s),!1)}getRowFromPosition(s,l){var u=this.rowManager.getRowFromPosition(s,l);return u?u.getComponent():(console.warn("Find Error - No matching row found:",s),!1)}deleteRow(s){var l=[];Array.isArray(s)||(s=[s]);for(let u of s){let g=this.rowManager.findRow(u,!0);if(!g)return console.error("Delete Error - No matching row found:",u),Promise.reject("Delete Error - No matching row found");l.push(g)}return l.sort((u,g)=>this.rowManager.rows.indexOf(u)>this.rowManager.rows.indexOf(g)?1:-1),l.forEach(u=>{u.delete()}),this.rowManager.reRenderInPosition(),Promise.resolve()}addRow(s,l,u){if(this.initialized)return"string"==typeof s&&(s=JSON.parse(s)),this.rowManager.addRows(s,l,u).then(g=>g[0].getComponent());console.warn("addRow failed - table not yet initialized. Please wait for the `tableBuilt` event before calling this function.")}updateOrAddRow(s,l){var u=this.rowManager.findRow(s);return"string"==typeof l&&(l=JSON.parse(l)),u?u.updateData(l).then(()=>u.getComponent()):this.rowManager.addRows(l).then(g=>g[0].getComponent())}updateRow(s,l){var u=this.rowManager.findRow(s);return"string"==typeof l&&(l=JSON.parse(l)),u?u.updateData(l).then(()=>{resolve(u.getComponent())}):(console.warn("Update Error - No matching row found:",s),Promise.reject("Update Error - No matching row found"))}scrollToRow(s,l,u){var g=this.rowManager.findRow(s);return g?this.rowManager.scrollToRow(g,l,u):(console.warn("Scroll Error - No matching row found:",s),Promise.reject("Scroll Error - No matching row found"))}moveRow(s,l,u){var g=this.rowManager.findRow(s);g?g.moveToRow(l,u):console.warn("Move Error - No matching row found:",s)}getRows(s){if(this.initialized)return this.rowManager.getComponents(s);console.warn("getRows failed - table not yet initialized. Please wait for the `tableBuilt` event before calling this function.")}getRowPosition(s,l){var u=this.rowManager.findRow(s);return u?this.rowManager.getRowPosition(u,l):(console.warn("Position Error - No matching row found:",s),!1)}setColumns(s){this.initialized?this.columnManager.setColumns(s):console.warn("setColumns failed - table not yet initialized. To set initial data please use the 'columns' property in the table constructor.")}getColumns(s){return this.columnManager.getComponents(s)}getColumn(s){var l=this.columnManager.findColumn(s);return l?l.getComponent():(console.warn("Find Error - No matching column found:",s),!1)}getColumnDefinitions(){return this.columnManager.getDefinitionTree()}showColumn(s){var l=this.columnManager.findColumn(s);if(!l)return console.warn("Column Show Error - No matching column found:",s),!1;l.show()}hideColumn(s){var l=this.columnManager.findColumn(s);if(!l)return console.warn("Column Hide Error - No matching column found:",s),!1;l.hide()}toggleColumn(s){var l=this.columnManager.findColumn(s);if(!l)return console.warn("Column Visibility Toggle Error - No matching column found:",s),!1;l.visible?l.hide():l.show()}addColumn(s,l,u){var g=this.columnManager.findColumn(u);return this.columnManager.addColumn(s,l,g).then(b=>b.getComponent())}deleteColumn(s){var l=this.columnManager.findColumn(s);return l?l.delete():(console.warn("Column Delete Error - No matching column found:",s),Promise.reject())}updateColumnDefinition(s,l){var u=this.columnManager.findColumn(s);return u?u.updateDefinition(l):(console.warn("Column Update Error - No matching column found:",s),Promise.reject())}moveColumn(s,l,u){var g=this.columnManager.findColumn(s),b=this.columnManager.findColumn(l);g?b?this.columnManager.moveColumn(g,b,u):console.warn("Move Error - No matching column found:",b):console.warn("Move Error - No matching column found:",s)}scrollToColumn(s,l,u){return new Promise((g,b)=>{var w=this.columnManager.findColumn(s);return w?this.columnManager.scrollToColumn(w,l,u):(console.warn("Scroll Error - No matching column found:",s),Promise.reject("Scroll Error - No matching column found"))})}redraw(s){this.initialized?(this.columnManager.redraw(s),this.rowManager.redraw(s)):console.warn("redraw failed - table not yet initialized. Please wait for the `tableBuilt` event before calling this function.")}setHeight(s){this.options.height=isNaN(s)?s:s+"px",this.element.style.height=this.options.height,this.rowManager.initializeRenderer(),this.rowManager.redraw()}on(s,l){this.externalEvents.subscribe(s,l)}off(s,l){this.externalEvents.unsubscribe(s,l)}dispatchEvent(){Array.from(arguments).shift(),this.externalEvents.dispatch(...arguments)}modExists(s,l){return!!this.modules[s]||(l&&console.error("Tabulator Module Not Installed: "+s),!1)}module(s){var l=this.modules[s];return l||console.error("Tabulator module not installed: "+s),l}}return v.defaultOptions=af,v})();new Ep(vh),new Ep(class gg extends vh{},yp);let _g=(()=>{class v{constructor(){this.a=null,this.b=null,this.dataObject=[],this.objectsForGrid=[],this.stringsForGrid=[],this.hotInstance=null,this.data=[]}get hot(){return null!=this.hotInstance?this.hotInstance:null}initGrid(s){vh.registerModule([Xp,ap,kd,qp]),this.hotInstance=new vh(s,{columns:[{title:"Step",field:"id"}],layout:"fitColumns",clipboard:"copy",footerElement:"<div>\n        \x3c!-- <a href=\"javascript:{var event = new Event('TabCopy'); window.dispatchEvent(event);}\">Copy Clipboard</a>\n        &nbsp;&nbsp;&nbsp;&nbsp;\n        <a href=\"javascript:{var event = new Event('TabDownload'); window.dispatchEvent(event);}\">CSV</a>\n        --\x3e\n        \n    </div>",placeholder:"please press execute button"})}AddStringToGrid(s){if(s.startsWith("{")&&s.endsWith("}"))try{var l=JSON.parse(s);return void this.objectsForGrid.push(l)}catch(b){}if(s.startsWith("[")&&s.endsWith("]"))try{for(var u=JSON.parse(s),g=0;g<u.length;g++)this.objectsForGrid.push(u[g]);return}catch(b){}this.stringsForGrid.push(s)}AddData(s){this.data.push(s)}AddDataToGrid(s){return"string"==typeof s?(this.AddStringToGrid(null==s?void 0:s.toString()),void this.dataObject.push([null==s?void 0:s.toString()])):"object"==typeof s?(console.log("adding object to grid"),this.AddStringToGrid(JSON.stringify(s)),void this.dataObject.push([s])):(this.dataObject.push([s.ToString()]),void this.AddStringToGrid(s.toString()))}ClearDataGrid(){this.data=[],this.dataObject=[],this.objectsForGrid=[],this.stringsForGrid=[],null!=this.hot&&(this.hot.setColumns([{title:"Step",field:"id"},{title:"Value",field:"val"}]),this.hot.replaceData([]),this.hot.redraw(!0))}hasOwnProperty(s,l){return null!=s&&s.hasOwnProperty(l)}AddObjectToFinishGrid(){for(var s,l,u=[],g=this.objectsForGrid,b=0;b<g.length;b++)"string"==typeof(w=g[b])?u.push("_"):u.push(...Object.keys(w));var k=new Set(u);u=Array.from(k);var H=[...u],Z=[];for(b=0;b<g.length;b++){for(var w=g[b],ht={Nr:b+1},Pt=0;Pt<u.length;Pt++){var qt=u[Pt],be=this.goodNameForKey(qt);if(w&&this.hasOwnProperty(w,qt)){var Le=w[qt];ht[be]="object"==typeof Le?JSON.stringify(Le):Le}else ht[be]="string"==typeof w&&0===Pt?w:""}Z.push(ht)}u.splice(0,0,"Nr"),H.splice(0,0,"Nr");var Ge=this.Headers(H);null===(s=this.hot)||void 0===s||s.setColumns(Ge),null===(l=this.hot)||void 0===l||l.replaceData(Z)}Headers(s){return s.map(l=>({title:l,field:this.goodNameForKey(l),formatter:function(u,g,b){try{var w=u.getValue().toString();if(w.length<2)return w;if(w.startsWith("[")&&w.endsWith("]"))try{var k=JSON.parse(w),H=u.getRow().getData().Nr,ht=u.getColumn().getField()+"_"+H;return b(function(){new vh("#"+ht,{data:k,autoColumns:!0,layout:"fitDataFill"})}),"<div id='"+ht+"'>"+w+"</div>"}catch(Pt){return w}}catch(Pt){return w}return u.getValue()}}))}AddStringToFinishGrid(){for(var s,l,u=[],g=0;g<this.stringsForGrid.length;g++)u.push({Nr:g+1,Text:this.stringsForGrid[g]});var w=this.Headers(["Nr","Text"]);null===(s=this.hot)||void 0===s||s.setColumns(w),null===(l=this.hot)||void 0===l||l.replaceData(u)}FinishGrid(){for(var s,l=0;l<this.data.length;l++)this.AddDataToGrid(this.data[l]);this.objectsForGrid.length+this.stringsForGrid.length!=0&&(this.objectsForGrid.length>0?this.AddObjectToFinishGrid():this.AddStringToFinishGrid(),null===(s=this.hot)||void 0===s||s.redraw(!0))}goodNameForKey(s){var l=s;return l.replace(".","_")}copyClip(){var s;null===(s=this.hot)||void 0===s||s.copyToClipboard()}copyCSV(){var s;null===(s=this.hot)||void 0===s||s.download("csv","data.csv",{bom:!0})}}return v.\u0275fac=function(s){return new(s||v)},v.\u0275prov=re.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})();var mg=_(5137),Cp=_(91083),B_=_(20549),gf=_(57261),Gd=_(43954),_f=_(92181),H_=_(4834),U_=_(20773),Sp=_(33);function vg(v,c){1&v&&re._UZ(0,"mat-spinner")}const mf=function(v){return["/","automation","loadexample",v]};function vf(v,c){if(1&v&&(re.TgZ(0,"a",15),re._uU(1),re.qZA()),2&v){const s=re.oxw();re.Q6J("routerLink",re.VKq(2,mf,s.mustLoadDemoBlock)),re.xp6(1),re.hij("Direct link ",s.mustLoadDemoBlock,"")}}function V_(v,c){if(1&v&&(re.TgZ(0,"mat-tab",27),re._UZ(1,"div",22),re.qZA()),2&v){const s=re.oxw(3);re.xp6(1),re.Q6J("id","steps"+s.myId)}}function Tu(v,c){if(1&v){const s=re.EpF();re.TgZ(0,"mat-tab-group",18),re.NdJ("selectedTabChange",function(u){return re.CHM(s),re.oxw(2).changeTabOutput(u)}),re.TgZ(1,"mat-tab",19),re.TgZ(2,"ngx-codemirror",20),re.NdJ("ngModelChange",function(u){return re.CHM(s),re.oxw(2).showInner=u}),re.qZA(),re.qZA(),re.TgZ(3,"mat-tab",21),re._UZ(4,"div",22),re.qZA(),re.TgZ(5,"mat-tab",23),re._UZ(6,"div",22),re.qZA(),re.TgZ(7,"mat-tab",24),re._UZ(8,"canvas",25),re.qZA(),re.YNc(9,V_,2,1,"mat-tab",26),re.qZA()}if(2&v){const s=re.oxw(2);re.xp6(2),re.Q6J("options",s.editorPlain)("ngModel",s.showInner),re.xp6(2),re.Q6J("id","htmlText"+s.myId),re.xp6(2),re.Q6J("id","htmlOutput"+s.myId),re.xp6(2),re.Q6J("id","barchart"+s.myId),re.xp6(1),re.Q6J("ngIf",!1)}}function G_(v,c){if(1&v){const s=re.EpF();re.TgZ(0,"ngx-codemirror",20),re.NdJ("ngModelChange",function(u){return re.CHM(s),re.oxw(2).showJSCode=u}),re.qZA()}if(2&v){const s=re.oxw(2);re.Q6J("options",s.editorJSOptions)("ngModel",s.showJSCode)}}function W_(v,c){if(1&v){const s=re.EpF();re.TgZ(0,"ngx-codemirror",20),re.NdJ("ngModelChange",function(u){return re.CHM(s),re.oxw(2).showXMLCode=u}),re.qZA()}if(2&v){const s=re.oxw(2);re.Q6J("options",s.editorXMLOptions)("ngModel",s.showXMLCode)}}function yf(v,c){if(1&v){const s=re.EpF();re.TgZ(0,"ngx-codemirror",20),re.NdJ("ngModelChange",function(u){return re.CHM(s),re.oxw(2).showBlocksDefinition=u}),re.qZA()}if(2&v){const s=re.oxw(2);re.Q6J("options",s.editorJSOptions)("ngModel",s.showBlocksDefinition)}}function Tf(v,c){if(1&v&&(re.TgZ(0,"mat-grid-tile"),re.YNc(1,Tu,10,6,"mat-tab-group",16),re.YNc(2,G_,1,2,"ngx-codemirror",17),re.YNc(3,W_,1,2,"ngx-codemirror",17),re.YNc(4,yf,1,2,"ngx-codemirror",17),re.qZA()),2&v){const s=re.oxw();re.xp6(1),re.Q6J("ngIf",s.ShowOutput()),re.xp6(1),re.Q6J("ngIf",s.ShowCode()),re.xp6(1),re.Q6J("ngIf",s.ShowXML()),re.xp6(1),re.Q6J("ngIf",s.ShowBlocksDefinition())}}var vc=(()=>{return(v=vc||(vc={}))[v.ShowNone=0]="ShowNone",v[v.ShowBlocksDefinition=1]="ShowBlocksDefinition",v[v.ShowXML=2]="ShowXML",v[v.ShowOutput=3]="ShowOutput",v[v.ShowCode=4]="ShowCode",v[v.Stop=100]="Stop",vc;var v})();let yg=(()=>{class v{constructor(s,l,u,g,b,w,k){var H;this.tabulator=s,this.DetailsApp=l,this.loadDemo=u,this.ar=g,this.ta=b,this.snackBar=w,this.dialog=k,this.lastData=null,this.editorXMLOptions={theme:"vs-dark",language:"xml"},this.editorJSOptions={theme:"vs-dark",language:"javascript",lineNumbers:"on"},this.editorPlain={theme:"vs-dark",language:"plaintext",lineNumbers:"on"},this.code='function x() {\nconsole.log("Hello world!");\n}',this.showCodeAndXML=vc.ShowNone,this.swaggerLoaded=0,this.demoWorkspace=null,this.mustLoadDemoBlock="",this.intro=L(),this.myId=0,this.bs=new Jh,this.bh2=new hd,this.bh=null,this.fullTextData="",this.fullHtmlData="",this.myChart=null,this.tabIndex=0,this.step=0,this.swaggerData=[],this.showInner="",this.showXMLCode="",this.showJSCode="",this.showBlocksDefinition="",this.toolboxXML="",this.loadedCompletely=!1,this.myId=++v.id,this.ar.paramMap.subscribe(Z=>{this.mustLoadDemoBlock=Z.get("demoblock")}),this.ta.receiveData().subscribe(Z=>{"DisplayBlocklyComponent"==Z[0]&&this[Z[1]]()}),null===(H=this.DetailsApp.LocalAPI)||void 0===H||H.IsAlive().subscribe()}createIntro(){var s,l=null===(s=this.DetailsApp.settings)||void 0===s?void 0:s.tourSteps.map(u=>{var g;return{title:(null===(g=this.DetailsApp.settings)||void 0===g?void 0:g.title)||"Blockly Automation",intro:u.text,element:document.querySelector(u.query)||void 0}});this.intro.setOptions({exitOnEsc:!0,showStepNumbers:!0,showButtons:!0,doneLabel:"Exit",skipLabel:"Skip",showProgress:!0,steps:l}).start()}clearOutput(){this.step=0,this.showInner="",this.tabulator.ClearDataGrid(),null!=this.myChart&&this.myChart.destroy(),this.fullHtmlData="",this.fullTextData=""}ShowText(s){if(null!=s){var l=s.toString();this.fullTextData+="\n"+l}}finishHTMLOutput(){this.theHtmlOutput().innerHTML=this.fullHtmlData}ShowHTML(s){if(null!=s){var l=s.toString();this.fullHtmlData+="<br/>"+l}}theHtmlOutput(){return document.getElementById("htmlOutput"+this.myId)}theTextOutput(){return document.getElementById("htmlText"+this.myId)}ShowChart(s){var l,u=null===(l=document.getElementById("barchart"+this.myId))||void 0===l?void 0:l.getContext("2d");if(null!=u)try{var g=null==s?void 0:s.toString(),b=JSON.parse(g);b&&b.type&&(this.myChart=new cn(u,b),console.log("make chart",s))}catch(w){this.myChart=null}else console.log("not canvas available for chart!")}changeTab(s){switch(s){case 0:break;case 1:this.theTextOutput().innerText=this.fullTextData;break;case 2:this.finishHTMLOutput();break;case 3:this.ShowChart(this.lastData);break;case 4:const l=document.getElementById("steps"+this.myId);if(null==l)return void window.alert("gridElement is null");this.tabulator.ClearDataGrid(),this.tabulator.initGrid(l),this.tabulator.FinishGrid();break;default:window.alert("tab "+s+" not implemented")}}changeTabOutput(s){console.log(s.index),this.tabIndex=s.index,this.changeTab(s.index)}RunCode(){this.snackBar.open("Program start","Executing...");var s=this,l=this.run.latestCode;s.CalculateXMLAndCode(),this.bh=new $h(this.demoWorkspace,t),this.run=this.bh,this.showCodeAndXML=vc.ShowOutput,this.clearOutput(),this.showInner='{ "step_start": "start program",',this.run.runCode((b,w)=>{try{return new Interpreter(b,w)}catch(k){s.CalculateXMLAndCode(),window.alert("please copy the left output and report there is an error at "+JSON.stringify(k)),this.showCodeAndXML=vc.ShowCode}},b=>{s.step++,s.showInner+=`\n           \n"step_${s.step}" : "${b}",`,s.lastData=b,s.tabulator.AddData(b),s.ShowHTML(b),s.ShowText(b)},()=>{this.snackBar.open("Program end","Done!",{duration:3e3}),s.showInner+='\n "step_end" : "program executed; see results below"\n}',this.changeTab(this.tabIndex)},l)}ShowLocalAPI(s){var l;null===(l=this.DetailsApp.LocalAPI)||void 0===l||l.LoadBlockContent(s).subscribe(u=>{var g=e.Xml.textToDom(u);null!=this.demoWorkspace&&(e.Xml.clearWorkspaceAndLoadFromXml(g,this.demoWorkspace),window.alert("please press execute button"))})}ShowDemo(s){this.mustLoadDemoBlock=s,this.loadDemo.getDemoBlock(s).subscribe(l=>{var u=e.Xml.textToDom(l);if(null!=this.demoWorkspace){try{e.Xml.clearWorkspaceAndLoadFromXml(u,this.demoWorkspace)}catch(g){return(null==s?void 0:s.toString().indexOf("docker"))>-1?void(window.confirm("This demo must run with Desktop App.\nDo you want to go to download page?")&&window.open("http://ba.serviciipeweb.ro/")):(null==s?void 0:s.toString().indexOf("chrome"))>-1?void(window.confirm("This demo must run with MyPC swagger.\nDo you want to go to download page?")&&window.open("https://github.com/ignatandrei/BlocklyAutomation/wiki/MyPC")):void window.alert("error "+s)}window.alert("please press execute button")}})}registerSwaggerBlocksObjects(s,l){return l.fieldXMLObjects.map(g=>e.Xml.textToDom(g))}registerSwaggerBlocksAPIControllers(s,l,u){return l.findfieldXMLFunctions(u).map(b=>e.Xml.textToDom(b.gui))}registerSwaggerBlocksAPIAll(s,l){return l.fieldXMLFunctions.map(g=>e.Xml.textToDom(g.gui))}ngOnInit(){}ngAfterViewInit(){this.StartRegister(),(0,xn.R)(window,"TabDownload").subscribe(s=>this.tabulator.copyCSV()),(0,xn.R)(window,"TabCopy").subscribe(s=>this.tabulator.copyClip())}ShowBlocks(){this.dialog.open(Ha,{}).afterClosed().subscribe(l=>{if(console.log("The dialog was closed with ",l),l){var u=l;switch(u.Source){case"Demos":try{console.log("into try"),this.ShowDemo(l.id)}catch(g){window.alert(l.id),window.alert(g)}break;case"LocalAPI":this.ShowLocalAPI(l.id);break;default:window.alert(u.Source)}}})}LoadSwagger(){var s=this,u=(new R.L(""),window.prompt("Swagger/OpenAPI ? "));if(u){if(u.endsWith(".html")||u.endsWith(".htm"))return void window.alert("Swagger should end with .json - see source of html page");s.LoadSwaggerFromUrl(u).then(g=>{g.hasError?window.confirm("error loading swagger - most probably CORS\n Please download the windows app to try this.")&&window.open("http://ba.serviciipeweb.ro/"):(s.addToToolboxSwagger(g,this),window.alert("loaded successfully"))})}}LoadSwaggerFromUrl(s,l){var u=this;return(0,C.Z)(function*(){var g=new R.L(s),b=yield g.ParseSwagger();return b.name=l||s,b.hasError?b:u.LoadSwaggerFromAPI(b)})()}LoadSwaggerFromAPI(s){if(s.hasError)return console.error("error in swagger",s.name),s;this.swaggerData.push(s);for(var l=0;l<s.GenerateBlocks.length;l++){var u=s.GenerateBlocks[l];null==e.getMainWorkspace()&&console.log("#38 here in loadSwagger from api is not ok",e.getMainWorkspace()),u(e.Blocks,t,this.demoWorkspace)}for(l=0;l<s.GenerateFunctions.length;l++)(u=s.GenerateFunctions[l])(e.Blocks,t);return s.metaBlocks()(e.Blocks,t),s}StartRegister(){var s,l=[...Array(50).keys()].map(k=>this.CategorySwaggerHidden(k)).join(""),u=this.DetailsApp.customCategories,g=[this.bs.defaultBlocks.fieldXML(),` \n        <category name='Blockly Advanced'>\n        <category id="Audio" name="Audio">\n        ${this.bs.ttsBlock.fieldXML()}\n        ${this.bs.pianoBlock.fieldXML()}\n        </category>  \n            ${this.bs.filterBlocks.fieldXML()}\n                \n                ${this.bs.auth0Blocks.fieldXML()}\n                <category id="catConverters"  name="Converters">\n                ${this.bs.convertersBlocks.fieldXML()}\n              </category>    \n              <category id="catDates"  name="Dates">\n          ${this.bs.currentDateBlock.fieldXML()}\n          ${this.bs.dateFromTextBlock.fieldXML()}\n          ${this.bs.waitBlocks1.fieldXML()}\n          ${this.bs.waitBlocks2.fieldXML()}\n        </category>\n        <category id="catEmail"  name="Email">\n        ${this.bs.emailBlocks.fieldXML()}\n      </category>\n\n        <category id="catExporter"  name="Exporter">\n        ${this.bs.exportFileBlock.fieldXML()}\n      </category>\n              <category id="catGUI" name="GUI">\n              ${this.bs.guiBlocks.fieldXML()}\n              ${this.bs.chartBlock.fieldXML()}\n              </category>\n              <category id="catHTML" name="HTML">\n              <category name="GenHTML" id="Generate">\n              ${this.bs.htmlblocks.fieldXML()}\n              </category>\n              <category name="Parser" id="parseHTML">\n              ${this.bs.HTMLParserBlocks.fieldXML()}\n              </category>\n              </category>\n              <category name="Objects" id="objects">\n              ${this.bs.propBlocks.fieldXML()}\n              ${this.bs.createObjectBlocks.fieldXML()}\n              \n              </category>\n              <category id="XHR" name="Request">\n            ${this.bs.xhrBlocks.fieldXML()}\n            ${this.bs.windowsCreds.fieldXML()}\n            </category>\n        `,`<category id="catTimers"  name="Timers">\n          ${this.bs.waitBlocks1.fieldXML()}\n          ${this.bs.waitBlocks2.fieldXML()}\n        </category>`,`  <category id="programming" name="Programming">\n        ${this.bs.trycatchFinBlock.fieldXML()}\n        ${this.bs.commentBlock.fieldXML()}\n          </category>\n        \n      `,`</category>\n      ${u}\n      \n      <category name="Swagger" id="catSwagger" expanded='false' >          \n          ${l}\n        </category> \n       \n        `];this.initialize(g),this.bs.filterBlocks.definitionBlocks(e.Blocks,t),this.bs.waitBlocks2.definitionBlocks(e.defineBlocksWithJsonArray,t),this.bs.xhrBlocks.definitionBlocks(e.Blocks,t),this.bs.propBlocks.definitionBlocks(e.Blocks,t),this.bs.guiBlocks.definitionBlocks(e.Blocks,t),this.bs.convertersBlocks.definitionBlocks(e.Blocks,t),this.bs.exportFileBlock.definitionBlocks(e.Blocks,t),this.bs.createObjectBlocks.definitionBlocks(e.Blocks,t,e.Extensions,e.Mutator),this.bs.currentDateBlock.definitionBlocks(e.Blocks,t),this.bs.dateFromTextBlock.definitionBlocks(e.Blocks,t),this.bs.waitBlocks1.definitionBlocks(e.Blocks,t),this.bs.commentBlock.definitionBlocks(e.Blocks,t),this.bs.trycatchFinBlock.definitionBlocks(e.Blocks,t),this.bs.auth0Blocks.definitionBlocks(e.Blocks,t),this.bs.windowsCreds.definitionBlocks(e.Blocks,t),this.bs.chartBlock.definitionBlocks(e.Blocks,t),this.bs.emailBlocks.definitionBlocks(e.Blocks,t),this.bs.htmlblocks.definitionBlocks(e.Blocks,t),this.bs.HTMLParserBlocks.definitionBlocks(e.Blocks,t),this.bs.ttsBlock.definitionBlocks(e.Blocks,t),this.bs.pianoBlock.definitionBlocks(e.Blocks,t);var b=this.DetailsApp.swaggersDict,w=new Map;b.forEach((k,H)=>{var Z=!k.hasError;console.log("show swagger: "+H+":"+Z),Z&&w.set(H,this.LoadSwaggerFromAPI(k))}),(null===(s=this.DetailsApp.LocalAPI)||void 0===s?void 0:s.WasAlive)&&this.LoadSwaggerFromUrl(this.DetailsApp.LocalAPI.urL+"swagger/v1/swagger.json","LocalAutomation"),window.setTimeout(this.afterTimeout,2e3,this)}SaveBlocks(){this.bh2.saveState(e.Xml,this.demoWorkspace,this.myId)}ShowBlocksDefinition(){return this.showCodeAndXML===vc.ShowBlocksDefinition}ShowSelection(){return vc[this.showCodeAndXML]}ShowSomething(){return this.showCodeAndXML!==vc.ShowNone}ShowOutput(){return this.showCodeAndXML===vc.ShowOutput}ShowCode(){return this.showCodeAndXML===vc.ShowCode}ShowXML(){return this.showCodeAndXML===vc.ShowXML}CalculateXMLAndCode(){var s=e.Xml.workspaceToDom(this.demoWorkspace,!0),l=e.Xml.domToPrettyText(s);this.showJSCode=this.run.latestCode,this.showXMLCode=l;var u=this.parseTextForBlocks(l);this.showBlocksDefinition=u.map(g=>{try{return`Blockly.Blocks['${g}']={ init: \n`+e.Blocks[g].init.toString()+`};\n};\nBlockly.JavaScript['${g}']=`+t[g].toString()+";"}catch(k){return console.error("parse definition : "+g,k),"//Error for "+g}}).join("\n")}parseTextForBlocks(s){var l=[];if(s.indexOf('<block type="')>=0)for(var u=s.split('<block type="'),g=1;g<u.length;g++){var b=u[g].split('"')[0];l.push(b)}return l}ShowInnerWorkings(){null!=this.demoWorkspace?(this.showCodeAndXML++,this.ShowSelection()||(this.showCodeAndXML=vc.ShowNone,setTimeout(l=>{e.svgResize(l)},1e3,this.demoWorkspace)),this.CalculateXMLAndCode()):window.alert("demoWorkspace is null")}Download(){var s=window.prompt("Name?","blocks.txt");null!=s&&this.bh2.DownloadBlocks(e.Xml,this.demoWorkspace,s)}changeListener(s){this.readThis(s.target)}readThis(s){var l=s.files[0],u=new FileReader,g=this;u.onloadend=function(b){g.bh2.LoadFile(e.Xml,g.demoWorkspace,u.result),g.run.resetInterpreter()},u.readAsText(l)}CategorySwaggerHidden(s){return`<category name='swagger_hidden_${s}' hidden='true' >${s}</category>`}SaveToLocalAPI(){var s,l,u;if(0==((null===(l=null===(s=this.DetailsApp)||void 0===s?void 0:s.LocalAPI)||void 0===l?void 0:l.WasAlive)||!1))return this.LoadLocalAPI(),void window.alert("local api it is not yet loaded - please try again after loading");var g=e.Xml.workspaceToDom(this.demoWorkspace,!0),b=e.Xml.domToPrettyText(g),w=new h.q,k=window.prompt("name of the blocks?");null!=k&&(w.id=k,w.blocks="",w.categories="",w.description="",null===(u=this.DetailsApp.LocalAPI)||void 0===u||u.SaveBlock(w,b).subscribe(H=>{console.log("number blocks",H),window.alert("saved !")}))}LoadLocalAPI(){var s,l,u=this;return null===(l=null===(s=u.DetailsApp.LocalAPI)||void 0===s?void 0:s.IsAlive())||void 0===l?void 0:l.pipe((0,en.K)(g=>{var b;throw window.alert(`cannot load ${null===(b=u.DetailsApp.LocalAPI)||void 0===b?void 0:b.urL}`),g})).subscribe(g=>{var b;if(!g){if(!window.confirm("LocalAPI is not alive.\n Do you want to downlod and run ?"))return;u.DetailsApp.LocalAPI.download()}var w=(null===(b=u.DetailsApp.LocalAPI)||void 0===b?void 0:b.urL)||"";u.LoadSwaggerFromUrl(w+="swagger/v1/swagger.json").then(k=>{k.hasError?window.alert("error loading local api"):(k.name="LocalAPI",u.addToToolboxSwagger(k,this),window.alert("loaded successfully"))})})}initialize(s){var l,u,g;const b=document.getElementById("blocklyDiv"+this.myId);if(null!=b){var w=s.map(Pt=>`<sep></sep>${Pt}`);if(this.toolboxXML=`<xml xmlns="https://developers.google.com/blockly/xml" id="toolbox-simple" style="display: none">    \n    ${w}\n    </xml>`,this.demoWorkspace=e.inject(b,{readOnly:!1,media:"media/",trashcan:!0,horizontalLayout:!1,move:{scrollbars:!0,drag:!0,wheel:!0},zoom:{controls:!0,wheel:!0,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2,pinch:!0},toolbox:this.toolboxXML}),new a(this.demoWorkspace).init(),((null===(u=null===(l=this.DetailsApp.settings)||void 0===l?void 0:l.startBlocks)||void 0===u?void 0:u.length)||0)>0)try{var H=((null===(g=this.DetailsApp.settings)||void 0===g?void 0:g.startBlocks)||[]).join("\n"),Z=e.Xml.textToDom(H);e.Xml.clearWorkspaceAndLoadFromXml(Z,this.demoWorkspace)}catch(Pt){console.error("error when load default blocks",Pt)}this.bh=new $h(this.demoWorkspace,t),this.run=this.bh;var ht=this;this.demoWorkspace.addChangeListener(function(Pt){Pt.isUiEvent||(ht.run.resetInterpreter(),ht.run.generateCodeAndLoadIntoInterpreter(),ht.CalculateXMLAndCode())})}else window.alert("blocklyDiv is null")}restoreBlocks(){this.bh2.restoreState(e.Xml,this.demoWorkspace,this.myId)}addToToolboxSwagger(s,l){var u,g=s.findCategSwaggerFromPaths().sort().map(qt=>`<category name='${qt}' custom='func_${s.name}_${qt}'></category>`).join("\n"),b=(null==l?void 0:l.CategorySwaggerHidden(null==l?void 0:l.swaggerLoaded))||"",w=l.toolboxXML,k=`<category name='${s.name}'>\n<category name='API' id='func_${s.name}'>\n${g}\n</category>\n${s.categSwagger()}\n\n<category name='meta' id='meta_${s.name}'>\n<block type='meta_swagger_controllers_${s.name}'></block>\n<block type='meta_swagger_controllers_actions_${s.name}'></block>\n</category>\n\n</category>\n`;if(w=w.replace(b,k),l.swaggerLoaded++,l.toolboxXML=w,null===(u=null==l?void 0:l.demoWorkspace)||void 0===u||u.updateToolbox(w),null!=(null==l?void 0:l.demoWorkspace)){var Z="objects_"+s.nameCategSwagger(),ht="AllApi_"+s.nameCategSwagger(),Pt=s;l.demoWorkspace.registerToolboxCategoryCallback(Z,qt=>l.registerSwaggerBlocksObjects(qt,Pt)),l.demoWorkspace.registerToolboxCategoryCallback(ht,qt=>l.registerSwaggerBlocksAPIAll(qt,Pt)),s.findCategSwaggerFromPaths().forEach(qt=>{var be;null===(be=null==l?void 0:l.demoWorkspace)||void 0===be||be.registerToolboxCategoryCallback(`func_${s.name}_${qt}`,Le=>l.registerSwaggerBlocksAPIControllers(Le,s,qt))})}}afterTimeout(s){var l,u,g;if(s.loadedCompletely=!0,null!=(null==s?void 0:s.swaggerData))if(s.toolboxXML=s.toolboxXML.replace("Swagger",`Swagger(${s.swaggerData.length})`),s.swaggerData.forEach(H=>{s.addToToolboxSwagger(H,s)}),null!=(null==s?void 0:s.mustLoadDemoBlock))s.ShowDemo(null==s?void 0:s.mustLoadDemoBlock);else{if(((null===(u=null===(l=s.DetailsApp.settings)||void 0===l?void 0:l.startBlocks)||void 0===u?void 0:u.length)||0)>0)try{var w=((null===(g=s.DetailsApp.settings)||void 0===g?void 0:g.startBlocks)||[]).join("\n");if((null==w?void 0:w.length)>62){var k=e.Xml.textToDom(w);e.Xml.clearWorkspaceAndLoadFromXml(k,s.demoWorkspace)}}catch(H){console.log("error when load default blocks",H)}s.restoreBlocks()}}}return v.id=0,v.\u0275fac=function(s){return new(s||v)(re.Y36(_g),re.Y36(Ba.d),re.Y36(mg.F),re.Y36(Cp.gz),re.Y36(B_.v),re.Y36(gf.ux),re.Y36(qr.uw))},v.\u0275cmp=re.Xpm({type:v,selectors:[["app-display-blockly"]],decls:49,vars:10,consts:[[4,"ngIf"],["rowHeight","1:1",3,"cols"],[2,"display","inline-block","height","100%","width","100%"],[2,"display","inline-block","height","5%","width","100%"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","id","downloadBlocks","color","primary",3,"matMenuTriggerFor"],["menuSave","matMenu"],[3,"inset"],["id","downloadBlocks","mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"color","click"],["mat-raised-button","","color","warn","id","runButton",3,"click"],["type","file",3,"change"],["mat-raised-button","","id","demos","color","accent",3,"click"],["target","_blank","mat-raised-button","","color","primary",3,"routerLink",4,"ngIf"],[2,"display","inline-block","height","100%","width","100%",3,"id"],["target","_blank","mat-raised-button","","color","primary",3,"routerLink"],["style","height: 100%; width: 100%",3,"selectedTabChange",4,"ngIf"],["style","display: inline-block; height: 100%; width: 100%",3,"options","ngModel","ngModelChange",4,"ngIf"],[2,"height","100%","width","100%",3,"selectedTabChange"],["label","JSON"],[2,"display","inline-block","height","100%","width","100%",3,"options","ngModel","ngModelChange"],["label","Text","isActive","true"],[3,"id"],["label","HTML"],["label","Chart"],["width","800","height","450",3,"id"],["label","Grid",4,"ngIf"],["label","Grid"]],template:function(s,l){if(1&s&&(re.YNc(0,vg,1,0,"mat-spinner",0),re.TgZ(1,"mat-grid-list",1),re.TgZ(2,"mat-grid-tile-header"),re.TgZ(3,"div",2),re.TgZ(4,"div",3),re.TgZ(5,"button",4),re.NdJ("click",function(){return l.LoadSwagger()}),re.TgZ(6,"mat-icon"),re._uU(7,"file_upload"),re.qZA(),re._uU(8," Load Swagger/OpenAPI "),re.qZA(),re._uU(9," \xa0 "),re.TgZ(10,"button",5),re.TgZ(11,"mat-icon"),re._uU(12,"save"),re.qZA(),re._uU(13," Save => "),re.qZA(),re.TgZ(14,"mat-menu",null,6),re.TgZ(16,"button",4),re.NdJ("click",function(){return l.SaveBlocks()}),re.TgZ(17,"mat-icon"),re._uU(18,"web"),re.qZA(),re._uU(19," Persist in browser "),re.qZA(),re._UZ(20,"mat-divider",7),re.TgZ(21,"button",8),re.NdJ("click",function(){return l.Download()}),re.TgZ(22,"mat-icon"),re._uU(23,"download"),re.qZA(),re._uU(24," Download blocks "),re.qZA(),re._UZ(25,"mat-divider",7),re.TgZ(26,"button",9),re.NdJ("click",function(){return l.SaveToLocalAPI()}),re.TgZ(27,"mat-icon"),re._uU(28,"save"),re.qZA(),re._uU(29," Save Local "),re.qZA(),re.qZA(),re._uU(30," \xa0 "),re.TgZ(31,"button",10),re.NdJ("click",function(){return l.RunCode()}),re.TgZ(32,"mat-icon"),re._uU(33,"play_arrow"),re.qZA(),re._uU(34," Execute "),re.qZA(),re._uU(35," \xa0 \xa0 "),re.TgZ(36,"input",11),re.NdJ("change",function(g){return l.changeListener(g)}),re.qZA(),re.TgZ(37,"button",4),re.NdJ("click",function(){return l.ShowInnerWorkings()}),re.TgZ(38,"mat-icon"),re._uU(39,"code"),re.qZA(),re._uU(40),re.qZA(),re.TgZ(41,"button",12),re.NdJ("click",function(){return l.ShowBlocks()}),re.TgZ(42,"mat-icon"),re._uU(43,"list"),re.qZA(),re._uU(44," Load Blocks "),re.qZA(),re.YNc(45,vf,2,4,"a",13),re.qZA(),re.qZA(),re.qZA(),re.TgZ(46,"mat-grid-tile"),re._UZ(47,"div",14),re.qZA(),re.YNc(48,Tf,5,4,"mat-grid-tile",0),re.qZA()),2&s){const u=re.MAs(15);re.Q6J("ngIf",!l.loadedCompletely),re.xp6(1),re.Q6J("cols",l.ShowSomething()?2:1),re.xp6(9),re.Q6J("matMenuTriggerFor",u),re.xp6(10),re.Q6J("inset",!0),re.xp6(5),re.Q6J("inset",!0),re.xp6(1),re.Q6J("color",null!=l.DetailsApp.LocalAPI&&l.DetailsApp.LocalAPI.WasAlive?"primary":"warn"),re.xp6(14),re.hij(" ",l.ShowSelection()," "),re.xp6(5),re.Q6J("ngIf",null==l.mustLoadDemoBlock?null:l.mustLoadDemoBlock.length),re.xp6(2),re.Q6J("id","blocklyDiv"+l.myId),re.xp6(1),re.Q6J("ngIf",l.ShowSomething())}},directives:[ea.O5,Gd.Il,Gd.$H,Gd.jo,_c.lW,mc.Hw,_f.p6,_f.VK,H_.d,Gd.DX,U_.$g,_c.zs,Cp.yS,cs.SP,cs.uX,Sp.C,go.JJ,go.On],styles:[".tabulator[_ngcontent-%COMP%]{font-size:12px;border:none}.tabulator[_ngcontent-%COMP%]   .tabulator-header[_ngcontent-%COMP%]{font-weight:400;border-bottom:1px solid;border-bottom-color:#0000001f;color:#0000008a}.tabulator[_ngcontent-%COMP%]   .tabulator-header[_ngcontent-%COMP%]   .tabulator-col[_ngcontent-%COMP%]{height:48px;background-color:#fff;border:none;padding:0 7px}.tabulator-row[_ngcontent-%COMP%]{border-bottom:1px solid;border-bottom-color:#0000001f;min-height:48px;vertical-align:middle}.tabulator-row[_ngcontent-%COMP%]   .tabulator-cell[_ngcontent-%COMP%]{padding:16px 7px;border-right:none;vertical-align:middle}.tabulator-row[_ngcontent-%COMP%]   .tabulator-cell[_ngcontent-%COMP%]:first-of-type, .tabulator[_ngcontent-%COMP%]   .tabulator-header[_ngcontent-%COMP%]   .tabulator-col[_ngcontent-%COMP%]:first-of-type{padding-left:24px}.tabulator-row.tabulator-row-even[_ngcontent-%COMP%]{background-color:#fff}"]}),v})()},5137:(B,X,_)=>{"use strict";_.d(X,{F:()=>o}),_(39646);var m=_(54004),e=_(18505),t=_(5e3),n=_(40520);let o=(()=>{class r{constructor(h){this.http=h}getDemoBlocks(){var h=(new Date).toISOString();return this.http.get(`assets/showUsage/demoBlocks/all.txt?${h}`,{responseType:"text"}).pipe((0,m.U)(R=>JSON.parse(R)))}getCustomCategories(){var h=(new Date).toISOString();return this.http.get(`assets/loadAtStartup/customCategories.txt?${h}`,{responseType:"text"}).pipe((0,m.U)(R=>R.toString()))}getSwaggerLinks(){var h=(new Date).toISOString();return this.http.get(`assets/loadAtStartup/swaggers.json?${h}`,{responseType:"text"}).pipe((0,m.U)(R=>JSON.parse(R)))}getDemoBlock(h){var R=(new Date).toISOString();return this.http.get(`assets/showUsage/demoBlocks/${h}.txt?${R}`,{responseType:"text"}).pipe((0,e.b)(W=>{}),(0,m.U)(W=>W.toString()))}}return r.\u0275fac=function(h){return new(h||r)(t.LFG(n.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},86931:function(B,X,_){var m,e;m=[_(81069)],void 0!==(e=function(t){"use strict";return t}.apply(X,m))&&(B.exports=e)},81069:function(B,X){var m;void 0!==(m=function(){"use strict";var e={connectionTypes:{INPUT_VALUE:1,OUTPUT_VALUE:2,NEXT_STATEMENT:3,PREVIOUS_STATEMENT:4},constants:{},LINE_MODE_MULTIPLIER:40,PAGE_MODE_MULTIPLIER:125,DRAG_RADIUS:5,FLYOUT_DRAG_RADIUS:10,SNAP_RADIUS:28};return e.CONNECTING_SNAP_RADIUS=e.SNAP_RADIUS,e.CURRENT_CONNECTION_PREFERENCE=8,e.BUMP_DELAY=250,e.BUMP_RANDOMNESS=10,e.COLLAPSE_CHARS=30,e.LONGPRESS=750,e.SOUND_LIMIT=100,e.DRAG_STACK=!0,e.HSV_SATURATION=.45,e.HSV_VALUE=.65,e.SPRITE={width:96,height:124,url:"sprites.png"},e.constants.ALIGN={LEFT:-1,CENTRE:0,RIGHT:1},e.DRAG_NONE=0,e.DRAG_STICKY=1,e.DRAG_BEGIN=1,e.DRAG_FREE=2,e.OPPOSITE_TYPE=[],e.OPPOSITE_TYPE[e.connectionTypes.INPUT_VALUE]=e.connectionTypes.OUTPUT_VALUE,e.OPPOSITE_TYPE[e.connectionTypes.OUTPUT_VALUE]=e.connectionTypes.INPUT_VALUE,e.OPPOSITE_TYPE[e.connectionTypes.NEXT_STATEMENT]=e.connectionTypes.PREVIOUS_STATEMENT,e.OPPOSITE_TYPE[e.connectionTypes.PREVIOUS_STATEMENT]=e.connectionTypes.NEXT_STATEMENT,e.VARIABLE_CATEGORY_NAME="VARIABLE",e.VARIABLE_DYNAMIC_CATEGORY_NAME="VARIABLE_DYNAMIC",e.PROCEDURE_CATEGORY_NAME="PROCEDURE",e.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",e.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",e.constants.COLLAPSED_INPUT_NAME="_TEMP_COLLAPSED_INPUT",e.constants.COLLAPSED_FIELD_NAME="_TEMP_COLLAPSED_FIELD",e.utils={},e.utils.global=function(){return"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:this}(),e.Msg={},e.utils.global.Blockly||(e.utils.global.Blockly={}),e.utils.global.Blockly.Msg||(e.utils.global.Blockly.Msg=e.Msg),e.utils.colour={},e.utils.colour.parse=function(t){t=String(t).toLowerCase().trim();var n=e.utils.colour.names[t];if(n||(n="0x"==t.substring(0,2)?"#"+t.substring(2):t,/^#[0-9a-f]{6}$/.test(n="#"==n[0]?n:"#"+n)))return n;if(/^#[0-9a-f]{3}$/.test(n))return["#",n[1],n[1],n[2],n[2],n[3],n[3]].join("");var o=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return o&&(t=Number(o[1]),n=Number(o[2]),o=Number(o[3]),0<=t&&256>t&&0<=n&&256>n&&0<=o&&256>o)?e.utils.colour.rgbToHex(t,n,o):null},e.utils.colour.rgbToHex=function(t,n,o){return n=t<<16|n<<8|o,16>t?"#"+(16777216|n).toString(16).substr(1):"#"+n.toString(16)},e.utils.colour.hexToRgb=function(t){return(t=e.utils.colour.parse(t))?[(t=parseInt(t.substr(1),16))>>16,t>>8&255,255&t]:[0,0,0]},e.utils.colour.hsvToHex=function(t,n,o){var r=0,a=0,h=0;if(0==n)h=a=r=o;else{var R=Math.floor(t/60),L=t/60-R;t=o*(1-n);var W=o*(1-n*L);switch(n=o*(1-n*(1-L)),R){case 1:r=W,a=o,h=t;break;case 2:r=t,a=o,h=n;break;case 3:r=t,a=W,h=o;break;case 4:r=n,a=t,h=o;break;case 5:r=o,a=t,h=W;break;case 6:case 0:r=o,a=n,h=t}}return e.utils.colour.rgbToHex(Math.floor(r),Math.floor(a),Math.floor(h))},e.utils.colour.blend=function(t,n,o){return(t=e.utils.colour.parse(t))&&(n=e.utils.colour.parse(n))?(t=e.utils.colour.hexToRgb(t),n=e.utils.colour.hexToRgb(n),e.utils.colour.rgbToHex(Math.round(n[0]+o*(t[0]-n[0])),Math.round(n[1]+o*(t[1]-n[1])),Math.round(n[2]+o*(t[2]-n[2])))):null},e.utils.colour.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},e.utils.Coordinate=function(t,n){this.x=t,this.y=n},e.utils.Coordinate.equals=function(t,n){return t==n||!(!t||!n)&&t.x==n.x&&t.y==n.y},e.utils.Coordinate.distance=function(t,n){var o=t.x-n.x;return t=t.y-n.y,Math.sqrt(o*o+t*t)},e.utils.Coordinate.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},e.utils.Coordinate.difference=function(t,n){return new e.utils.Coordinate(t.x-n.x,t.y-n.y)},e.utils.Coordinate.sum=function(t,n){return new e.utils.Coordinate(t.x+n.x,t.y+n.y)},e.utils.Coordinate.prototype.clone=function(){return new e.utils.Coordinate(this.x,this.y)},e.utils.Coordinate.prototype.scale=function(t){return this.x*=t,this.y*=t,this},e.utils.Coordinate.prototype.translate=function(t,n){return this.x+=t,this.y+=n,this},e.utils.Rect=function(t,n,o,r){this.top=t,this.bottom=n,this.left=o,this.right=r},e.utils.Rect.prototype.contains=function(t,n){return t>=this.left&&t<=this.right&&n>=this.top&&n<=this.bottom},e.utils.Rect.prototype.intersects=function(t){return!(this.left>t.right||this.right<t.left||this.top>t.bottom||this.bottom<t.top)},e.utils.string={},e.utils.string.startsWith=function(t,n){return 0==t.lastIndexOf(n,0)},e.utils.string.shortestStringLength=function(t){return t.length?t.reduce(function(n,o){return n.length<o.length?n:o}).length:0},e.utils.string.commonWordPrefix=function(t,n){if(!t.length)return 0;if(1==t.length)return t[0].length;var o=0;n=n||e.utils.string.shortestStringLength(t);for(var r=0;r<n;r++){for(var a=t[0][r],h=1;h<t.length;h++)if(a!=t[h][r])return o;" "==a&&(o=r+1)}for(h=1;h<t.length;h++)if((a=t[h][r])&&" "!=a)return o;return n},e.utils.string.commonWordSuffix=function(t,n){if(!t.length)return 0;if(1==t.length)return t[0].length;var o=0;n=n||e.utils.string.shortestStringLength(t);for(var r=0;r<n;r++){for(var a=t[0].substr(-r-1,1),h=1;h<t.length;h++)if(a!=t[h].substr(-r-1,1))return o;" "==a&&(o=r+1)}for(h=1;h<t.length;h++)if((a=t[h].charAt(t[h].length-r-1))&&" "!=a)return o;return n},e.utils.string.wrap=function(t,n){t=t.split("\n");for(var o=0;o<t.length;o++)t[o]=e.utils.string.wrapLine_(t[o],n);return t.join("\n")},e.utils.string.wrapLine_=function(t,n){if(t.length<=n)return t;for(var o=t.trim().split(/\s+/),r=0;r<o.length;r++)o[r].length>n&&(n=o[r].length);r=-1/0;var a=1;do{var h=r,R=t;t=[];var L=o.length/a,W=1;for(r=0;r<o.length-1;r++)W<(r+1.5)/L?(W++,t[r]=!0):t[r]=!1;t=e.utils.string.wrapMutate_(o,t,n),r=e.utils.string.wrapScore_(o,t,n),t=e.utils.string.wrapToText_(o,t),a++}while(r>h);return R},e.utils.string.wrapScore_=function(t,n,o){for(var r=[0],a=[],h=0;h<t.length;h++)r[r.length-1]+=t[h].length,!0===n[h]?(r.push(0),a.push(t[h].charAt(t[h].length-1))):!1===n[h]&&r[r.length-1]++;for(t=Math.max.apply(Math,r),h=n=0;h<r.length;h++)n-=2*Math.pow(Math.abs(o-r[h]),1.5),n-=Math.pow(t-r[h],1.5),-1!=".?!".indexOf(a[h])?n+=o/3:-1!=",;)]}".indexOf(a[h])&&(n+=o/4);return 1<r.length&&r[r.length-1]<=r[r.length-2]&&(n+=.5),n},e.utils.string.wrapMutate_=function(t,n,o){for(var a,r=e.utils.string.wrapScore_(t,n,o),h=0;h<n.length-1;h++)if(n[h]!=n[h+1]){var R=[].concat(n);R[h]=!R[h],R[h+1]=!R[h+1];var L=e.utils.string.wrapScore_(t,R,o);L>r&&(r=L,a=R)}return a?e.utils.string.wrapMutate_(t,a,o):n},e.utils.string.wrapToText_=function(t,n){for(var o=[],r=0;r<t.length;r++)o.push(t[r]),void 0!==n[r]&&o.push(n[r]?"\n":" ");return o.join("")},e.utils.Size=function(t,n){this.width=t,this.height=n},e.utils.Size.equals=function(t,n){return t==n||!(!t||!n)&&t.width==n.width&&t.height==n.height},e.utils.style={},e.utils.style.getSize=function(t){if("none"!=e.utils.style.getStyle_(t,"display"))return e.utils.style.getSizeWithDisplay_(t);var n=t.style,o=n.display,r=n.visibility,a=n.position;n.visibility="hidden",n.position="absolute",n.display="inline";var h=t.offsetWidth;return t=t.offsetHeight,n.display=o,n.position=a,n.visibility=r,new e.utils.Size(h,t)},e.utils.style.getSizeWithDisplay_=function(t){return new e.utils.Size(t.offsetWidth,t.offsetHeight)},e.utils.style.getStyle_=function(t,n){return e.utils.style.getComputedStyle(t,n)||e.utils.style.getCascadedStyle(t,n)||t.style&&t.style[n]},e.utils.style.getComputedStyle=function(t,n){return document.defaultView&&document.defaultView.getComputedStyle&&(t=document.defaultView.getComputedStyle(t,null))&&(t[n]||t.getPropertyValue(n))||""},e.utils.style.getCascadedStyle=function(t,n){return t.currentStyle?t.currentStyle[n]:null},e.utils.style.getPageOffset=function(t){var n=new e.utils.Coordinate(0,0);t=t.getBoundingClientRect();var o=document.documentElement;return o=new e.utils.Coordinate(window.pageXOffset||o.scrollLeft,window.pageYOffset||o.scrollTop),n.x=t.left+o.x,n.y=t.top+o.y,n},e.utils.style.getViewportPageOffset=function(){var t=document.body,n=document.documentElement;return new e.utils.Coordinate(t.scrollLeft||n.scrollLeft,t.scrollTop||n.scrollTop)},e.utils.style.setElementShown=function(t,n){t.style.display=n?"":"none"},e.utils.style.isRightToLeft=function(t){return"rtl"==e.utils.style.getStyle_(t,"direction")},e.utils.style.getBorderBox=function(t){var n=e.utils.style.getComputedStyle(t,"borderLeftWidth"),o=e.utils.style.getComputedStyle(t,"borderRightWidth"),r=e.utils.style.getComputedStyle(t,"borderTopWidth");return t=e.utils.style.getComputedStyle(t,"borderBottomWidth"),{top:parseFloat(r),right:parseFloat(o),bottom:parseFloat(t),left:parseFloat(n)}},e.utils.style.scrollIntoContainerView=function(t,n,o){t=e.utils.style.getContainerOffsetToScrollInto(t,n,o),n.scrollLeft=t.x,n.scrollTop=t.y},e.utils.style.getContainerOffsetToScrollInto=function(t,n,o){var r=e.utils.style.getPageOffset(t),a=e.utils.style.getPageOffset(n),h=e.utils.style.getBorderBox(n),R=r.x-a.x-h.left;return r=r.y-a.y-h.top,a=e.utils.style.getSizeWithDisplay_(t),t=n.clientWidth-a.width,a=n.clientHeight-a.height,h=n.scrollLeft,n=n.scrollTop,o?(h+=R-t/2,n+=r-a/2):(h+=Math.min(R,Math.max(R-t,0)),n+=Math.min(r,Math.max(r-a,0))),new e.utils.Coordinate(h,n)},e.utils.userAgent={},function(t){function n(r){return-1!=o.indexOf(r.toUpperCase())}e.utils.userAgent.raw=t;var o=e.utils.userAgent.raw.toUpperCase();e.utils.userAgent.IE=n("Trident")||n("MSIE"),e.utils.userAgent.EDGE=n("Edge"),e.utils.userAgent.JAVA_FX=n("JavaFX"),e.utils.userAgent.CHROME=(n("Chrome")||n("CriOS"))&&!e.utils.userAgent.EDGE,e.utils.userAgent.WEBKIT=n("WebKit")&&!e.utils.userAgent.EDGE,e.utils.userAgent.GECKO=n("Gecko")&&!e.utils.userAgent.WEBKIT&&!e.utils.userAgent.IE&&!e.utils.userAgent.EDGE,e.utils.userAgent.ANDROID=n("Android"),t=e.utils.global.navigator&&e.utils.global.navigator.maxTouchPoints,e.utils.userAgent.IPAD=n("iPad")||n("Macintosh")&&0<t,e.utils.userAgent.IPOD=n("iPod"),e.utils.userAgent.IPHONE=n("iPhone")&&!e.utils.userAgent.IPAD&&!e.utils.userAgent.IPOD,e.utils.userAgent.MAC=n("Macintosh"),e.utils.userAgent.TABLET=e.utils.userAgent.IPAD||e.utils.userAgent.ANDROID&&!n("Mobile")||n("Silk"),e.utils.userAgent.MOBILE=!e.utils.userAgent.TABLET&&(e.utils.userAgent.IPOD||e.utils.userAgent.IPHONE||e.utils.userAgent.ANDROID||n("IEMobile"))}(e.utils.global.navigator&&e.utils.global.navigator.userAgent||""),e.utils.noEvent=function(t){t.preventDefault(),t.stopPropagation()},e.utils.isTargetInput=function(t){return"textarea"==t.target.type||"text"==t.target.type||"number"==t.target.type||"email"==t.target.type||"password"==t.target.type||"search"==t.target.type||"tel"==t.target.type||"url"==t.target.type||t.target.isContentEditable||t.target.dataset&&"true"==t.target.dataset.isTextInput},e.utils.getRelativeXY=function(t){var n=new e.utils.Coordinate(0,0),o=t.getAttribute("x");return o&&(n.x=parseInt(o,10)),(o=t.getAttribute("y"))&&(n.y=parseInt(o,10)),(o=(o=t.getAttribute("transform"))&&o.match(e.utils.getRelativeXY.XY_REGEX_))&&(n.x+=Number(o[1]),o[3]&&(n.y+=Number(o[3]))),(t=t.getAttribute("style"))&&-1<t.indexOf("translate")&&(t=t.match(e.utils.getRelativeXY.XY_STYLE_REGEX_))&&(n.x+=Number(t[1]),t[3]&&(n.y+=Number(t[3]))),n},e.utils.getInjectionDivXY_=function(t){for(var n=0,o=0;t;){var r=e.utils.getRelativeXY(t);if(n+=r.x,o+=r.y,-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;t=t.parentNode}return new e.utils.Coordinate(n,o)},e.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,e.utils.getRelativeXY.XY_STYLE_REGEX_=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,e.utils.isRightButton=function(t){return!(!t.ctrlKey||!e.utils.userAgent.MAC)||2==t.button},e.utils.mouseToSvg=function(t,n,o){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,o||(o=n.getScreenCTM().inverse()),r.matrixTransform(o)},e.utils.getScrollDeltaPixels=function(t){switch(t.deltaMode){default:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*e.LINE_MODE_MULTIPLIER,y:t.deltaY*e.LINE_MODE_MULTIPLIER};case 2:return{x:t.deltaX*e.PAGE_MODE_MULTIPLIER,y:t.deltaY*e.PAGE_MODE_MULTIPLIER}}},e.utils.tokenizeInterpolation=function(t){return e.utils.tokenizeInterpolation_(t,!0)},e.utils.replaceMessageReferences=function(t){return"string"!=typeof t?t:(t=e.utils.tokenizeInterpolation_(t,!1)).length?String(t[0]):""},e.utils.checkMessageReferences=function(t){for(var n=!0,o=e.Msg,r=t.match(/%{BKY_[A-Z]\w*}/gi),a=0;a<r.length;a++)null==o[r[a].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+r[a]+" in "+t),n=!1);return n},e.utils.tokenizeInterpolation_=function(t,n){var o=[],r=t.split("");r.push("");var a=0;t=[];for(var h=null,R=0;R<r.length;R++){var L=r[R];0==a?"%"==L?((L=t.join(""))&&o.push(L),t.length=0,a=1):t.push(L):1==a?"%"==L?(t.push(L),a=0):n&&"0"<=L&&"9">=L?(a=2,h=L,(L=t.join(""))&&o.push(L),t.length=0):"{"==L?a=3:(t.push("%",L),a=0):2==a?"0"<=L&&"9">=L?h+=L:(o.push(parseInt(h,10)),R--,a=0):3==a&&(""==L?(t.splice(0,0,"%{"),R--,a=0):"}"!=L?t.push(L):(a=t.join(""),/[A-Z]\w*/i.test(a)?(L=a.toUpperCase(),(L=e.utils.string.startsWith(L,"BKY_")?L.substring(4):null)&&L in e.Msg?"string"==typeof(a=e.Msg[L])?Array.prototype.push.apply(o,e.utils.tokenizeInterpolation_(a,n)):o.push(n?String(a):a):o.push("%{"+a+"}")):o.push("%{"+a+"}"),a=t.length=0))}for((L=t.join(""))&&o.push(L),n=[],R=t.length=0;R<o.length;++R)"string"==typeof o[R]?t.push(o[R]):((L=t.join(""))&&n.push(L),t.length=0,n.push(o[R]));return(L=t.join(""))&&n.push(L),t.length=0,n},e.utils.genUid=function(){for(var t=e.utils.genUid.soup_.length,n=[],o=0;20>o;o++)n[o]=e.utils.genUid.soup_.charAt(Math.random()*t);return n.join("")},e.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e.utils.is3dSupported=function(){if(void 0!==e.utils.is3dSupported.cached_)return e.utils.is3dSupported.cached_;if(!e.utils.global.getComputedStyle)return!1;var t=document.createElement("p"),n="none",o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var r in document.body.insertBefore(t,null),o)if(void 0!==t.style[r]){if(t.style[r]="translate3d(1px,1px,1px)",!(n=e.utils.global.getComputedStyle(t)))return document.body.removeChild(t),!1;n=n.getPropertyValue(o[r])}return document.body.removeChild(t),e.utils.is3dSupported.cached_="none"!==n,e.utils.is3dSupported.cached_},e.utils.runAfterPageLoad=function(t){if("object"!=typeof document)throw Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"==document.readyState)t();else var n=setInterval(function(){"complete"==document.readyState&&(clearInterval(n),t())},10)},e.utils.getViewportBBox=function(){var t=e.utils.style.getViewportPageOffset();return new e.utils.Rect(t.y,document.documentElement.clientHeight+t.y,t.x,document.documentElement.clientWidth+t.x)},e.utils.arrayRemove=function(t,n){return-1!=(n=t.indexOf(n))&&(t.splice(n,1),!0)},e.utils.getDocumentScroll=function(){var t=document.documentElement,n=window;return e.utils.userAgent.IE&&n.pageYOffset!=t.scrollTop?new e.utils.Coordinate(t.scrollLeft,t.scrollTop):new e.utils.Coordinate(n.pageXOffset||t.scrollLeft,n.pageYOffset||t.scrollTop)},e.utils.getBlockTypeCounts=function(t,n){var o=Object.create(null),r=t.getDescendants(!0);for(n&&(t=t.getNextBlock())&&(t=r.indexOf(t),r.splice(t,r.length-t)),t=0;n=r[t];t++)o[n.type]?o[n.type]++:o[n.type]=1;return o},e.utils.screenToWsCoordinates=function(t,n){var o=n.x;n=n.y;var r=t.getInjectionDiv().getBoundingClientRect();return o=new e.utils.Coordinate(o-r.left,n-r.top),n=t.getOriginOffsetInPixels(),e.utils.Coordinate.difference(o,n).scale(1/t.scale)},e.utils.parseBlockColour=function(t){var n="string"==typeof t?e.utils.replaceMessageReferences(t):t,o=Number(n);if(!isNaN(o)&&0<=o&&360>=o)return{hue:o,hex:e.utils.colour.hsvToHex(o,e.HSV_SATURATION,255*e.HSV_VALUE)};if(o=e.utils.colour.parse(n))return{hue:null,hex:o};throw o='Invalid colour: "'+n+'"',t!=n&&(o+=' (from "'+t+'")'),Error(o)},e.Touch={},e.Touch.TOUCH_ENABLED="ontouchstart"in e.utils.global||!!(e.utils.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!e.utils.global.navigator||!e.utils.global.navigator.maxTouchPoints&&!e.utils.global.navigator.msMaxTouchPoints),e.Touch.touchIdentifier_=null,e.Touch.TOUCH_MAP={},e.utils.global.PointerEvent?e.Touch.TOUCH_MAP={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]}:e.Touch.TOUCH_ENABLED&&(e.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]}),e.longPid_=0,e.longStart=function(t,n){e.longStop_(),t.changedTouches&&1!=t.changedTouches.length||(e.longPid_=setTimeout(function(){t.changedTouches&&(t.button=2,t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY),n&&n.handleRightClick(t)},e.LONGPRESS))},e.longStop_=function(){e.longPid_&&(clearTimeout(e.longPid_),e.longPid_=0)},e.Touch.clearTouchIdentifier=function(){e.Touch.touchIdentifier_=null},e.Touch.shouldHandleEvent=function(t){return!e.Touch.isMouseOrTouchEvent(t)||e.Touch.checkTouchIdentifier(t)},e.Touch.getTouchIdentifierFromEvent=function(t){return null!=t.pointerId?t.pointerId:t.changedTouches&&t.changedTouches[0]&&null!=t.changedTouches[0].identifier?t.changedTouches[0].identifier:"mouse"},e.Touch.checkTouchIdentifier=function(t){var n=e.Touch.getTouchIdentifierFromEvent(t);return null!=e.Touch.touchIdentifier_?e.Touch.touchIdentifier_==n:("mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type)&&(e.Touch.touchIdentifier_=n,!0)},e.Touch.setClientFromTouch=function(t){if(e.utils.string.startsWith(t.type,"touch")){var n=t.changedTouches[0];t.clientX=n.clientX,t.clientY=n.clientY}},e.Touch.isMouseOrTouchEvent=function(t){return e.utils.string.startsWith(t.type,"touch")||e.utils.string.startsWith(t.type,"mouse")||e.utils.string.startsWith(t.type,"pointer")},e.Touch.isTouchEvent=function(t){return e.utils.string.startsWith(t.type,"touch")||e.utils.string.startsWith(t.type,"pointer")},e.Touch.splitEventByTouches=function(t){var n=[];if(t.changedTouches)for(var o=0;o<t.changedTouches.length;o++)n[o]={type:t.type,changedTouches:[t.changedTouches[o]],target:t.target,stopPropagation:function(){t.stopPropagation()},preventDefault:function(){t.preventDefault()}};else n.push(t);return n},e.browserEvents={},e.browserEvents.conditionalBind=function(t,n,o,r,a,h){var R=!1,L=function(It){var gt=!a;It=e.Touch.splitEventByTouches(It);for(var Ut,wt=0;Ut=It[wt];wt++)(!gt||e.Touch.shouldHandleEvent(Ut))&&(e.Touch.setClientFromTouch(Ut),o?r.call(o,Ut):r(Ut),R=!0)},W=[];if(e.utils.global.PointerEvent&&n in e.Touch.TOUCH_MAP)for(var et,nt=0;et=e.Touch.TOUCH_MAP[n][nt];nt++)t.addEventListener(et,L,!1),W.push([t,et,L]);else if(t.addEventListener(n,L,!1),W.push([t,n,L]),n in e.Touch.TOUCH_MAP){var Et=function(It){L(It),R&&!h&&It.preventDefault()};for(nt=0;et=e.Touch.TOUCH_MAP[n][nt];nt++)t.addEventListener(et,Et,!1),W.push([t,et,Et])}return W},e.browserEvents.bind=function(t,n,o,r){var a=function(nt){o?r.call(o,nt):r(nt)},h=[];if(e.utils.global.PointerEvent&&n in e.Touch.TOUCH_MAP)for(var L,R=0;L=e.Touch.TOUCH_MAP[n][R];R++)t.addEventListener(L,a,!1),h.push([t,L,a]);else if(t.addEventListener(n,a,!1),h.push([t,n,a]),n in e.Touch.TOUCH_MAP){var W=function(nt){if(nt.changedTouches&&1==nt.changedTouches.length){var et=nt.changedTouches[0];nt.clientX=et.clientX,nt.clientY=et.clientY}a(nt),nt.preventDefault()};for(R=0;L=e.Touch.TOUCH_MAP[n][R];R++)t.addEventListener(L,W,!1),h.push([t,L,W])}return h},e.browserEvents.unbind=function(t){for(;t.length;){var n=t.pop(),o=n[2];n[0].removeEventListener(n[1],o,!1)}return o},e.ComponentManager=function(){this.componentData_=Object.create(null),this.capabilityToComponentIds_=Object.create(null)},e.ComponentManager.prototype.addComponent=function(t,n){var o=t.component.id;if(!n&&this.componentData_[o])throw Error('Plugin "'+o+'" with capabilities "'+this.componentData_[o].capabilities+'" already added.');this.componentData_[o]=t,n=[];for(var r=0;r<t.capabilities.length;r++){var a=String(t.capabilities[r]).toLowerCase();n.push(a),void 0===this.capabilityToComponentIds_[a]?this.capabilityToComponentIds_[a]=[o]:this.capabilityToComponentIds_[a].push(o)}this.componentData_[o].capabilities=n},e.ComponentManager.prototype.removeComponent=function(t){var n=this.componentData_[t];if(n){for(var o=0;o<n.capabilities.length;o++){var r=String(n.capabilities[o]).toLowerCase();this.capabilityToComponentIds_[r].splice(this.capabilityToComponentIds_[r].indexOf(t),1)}delete this.componentData_[t]}},e.ComponentManager.prototype.addCapability=function(t,n){if(!this.getComponent(t))throw Error('Cannot add capability, "'+n+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,n)?console.warn('Plugin "'+t+'already has capability "'+n+'"'):(n=String(n).toLowerCase(),this.componentData_[t].capabilities.push(n),this.capabilityToComponentIds_[n].push(t))},e.ComponentManager.prototype.removeCapability=function(t,n){if(!this.getComponent(t))throw Error('Cannot remove capability, "'+n+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,n)?(n=String(n).toLowerCase(),this.componentData_[t].capabilities.splice(this.componentData_[t].capabilities.indexOf(n),1),this.capabilityToComponentIds_[n].splice(this.capabilityToComponentIds_[n].indexOf(t),1)):console.warn('Plugin "'+t+"doesn't have capability \""+n+'" to remove')},e.ComponentManager.prototype.hasCapability=function(t,n){return n=String(n).toLowerCase(),-1!==this.componentData_[t].capabilities.indexOf(n)},e.ComponentManager.prototype.getComponent=function(t){return this.componentData_[t]&&this.componentData_[t].component},e.ComponentManager.prototype.getComponents=function(t,n){if(t=String(t).toLowerCase(),!(t=this.capabilityToComponentIds_[t]))return[];var o=[];if(n){var r=[],a=this.componentData_;t.forEach(function(h){r.push(a[h])}),r.sort(function(h,R){return h.weight-R.weight}),r.forEach(function(h){o.push(h.component)})}else a=this.componentData_,t.forEach(function(h){o.push(a[h].component)});return o},e.ComponentManager.Capability=function(t){this.name_=t},e.ComponentManager.Capability.prototype.toString=function(){return this.name_},e.ComponentManager.Capability.POSITIONABLE=new e.ComponentManager.Capability("positionable"),e.ComponentManager.Capability.DRAG_TARGET=new e.ComponentManager.Capability("drag_target"),e.ComponentManager.Capability.DELETE_AREA=new e.ComponentManager.Capability("delete_area"),e.ComponentManager.Capability.AUTOHIDEABLE=new e.ComponentManager.Capability("autohideable"),e.utils.Svg=function(t){this.tagName_=t},e.utils.Svg.prototype.toString=function(){return this.tagName_},e.utils.Svg.ANIMATE=new e.utils.Svg("animate"),e.utils.Svg.CIRCLE=new e.utils.Svg("circle"),e.utils.Svg.CLIPPATH=new e.utils.Svg("clipPath"),e.utils.Svg.DEFS=new e.utils.Svg("defs"),e.utils.Svg.FECOMPOSITE=new e.utils.Svg("feComposite"),e.utils.Svg.FECOMPONENTTRANSFER=new e.utils.Svg("feComponentTransfer"),e.utils.Svg.FEFLOOD=new e.utils.Svg("feFlood"),e.utils.Svg.FEFUNCA=new e.utils.Svg("feFuncA"),e.utils.Svg.FEGAUSSIANBLUR=new e.utils.Svg("feGaussianBlur"),e.utils.Svg.FEPOINTLIGHT=new e.utils.Svg("fePointLight"),e.utils.Svg.FESPECULARLIGHTING=new e.utils.Svg("feSpecularLighting"),e.utils.Svg.FILTER=new e.utils.Svg("filter"),e.utils.Svg.FOREIGNOBJECT=new e.utils.Svg("foreignObject"),e.utils.Svg.G=new e.utils.Svg("g"),e.utils.Svg.IMAGE=new e.utils.Svg("image"),e.utils.Svg.LINE=new e.utils.Svg("line"),e.utils.Svg.PATH=new e.utils.Svg("path"),e.utils.Svg.PATTERN=new e.utils.Svg("pattern"),e.utils.Svg.POLYGON=new e.utils.Svg("polygon"),e.utils.Svg.RECT=new e.utils.Svg("rect"),e.utils.Svg.SVG=new e.utils.Svg("svg"),e.utils.Svg.TEXT=new e.utils.Svg("text"),e.utils.Svg.TSPAN=new e.utils.Svg("tspan"),e.utils.dom={},e.utils.dom.SVG_NS="http://www.w3.org/2000/svg",e.utils.dom.HTML_NS="http://www.w3.org/1999/xhtml",e.utils.dom.XLINK_NS="http://www.w3.org/1999/xlink",e.utils.dom.NodeType={ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8,DOCUMENT_POSITION_CONTAINED_BY:16},e.utils.dom.cacheWidths_=null,e.utils.dom.cacheReference_=0,e.utils.dom.canvasContext_=null,e.utils.dom.createSvgElement=function(t,n,o){for(var r in t=document.createElementNS(e.utils.dom.SVG_NS,String(t)),n)t.setAttribute(r,n[r]);return document.body.runtimeStyle&&(t.runtimeStyle=t.currentStyle=t.style),o&&o.appendChild(t),t},e.utils.dom.addClass=function(t,n){var o=t.getAttribute("class")||"";return-1==(" "+o+" ").indexOf(" "+n+" ")&&(o&&(o+=" "),t.setAttribute("class",o+n),!0)},e.utils.dom.removeClasses=function(t,n){n=n.split(" ");for(var o=0;o<n.length;o++)e.utils.dom.removeClass(t,n[o])},e.utils.dom.removeClass=function(t,n){var o=t.getAttribute("class");if(-1==(" "+o+" ").indexOf(" "+n+" "))return!1;o=o.split(/\s+/);for(var r=0;r<o.length;r++)o[r]&&o[r]!=n||(o.splice(r,1),r--);return o.length?t.setAttribute("class",o.join(" ")):t.removeAttribute("class"),!0},e.utils.dom.hasClass=function(t,n){return-1!=(" "+t.getAttribute("class")+" ").indexOf(" "+n+" ")},e.utils.dom.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},e.utils.dom.insertAfter=function(t,n){var o=n.nextSibling;if(!(n=n.parentNode))throw Error("Reference node has no parent.");o?n.insertBefore(t,o):n.appendChild(t)},e.utils.dom.containsNode=function(t,n){return!!(t.compareDocumentPosition(n)&e.utils.dom.NodeType.DOCUMENT_POSITION_CONTAINED_BY)},e.utils.dom.setCssTransform=function(t,n){t.style.transform=n,t.style["-webkit-transform"]=n},e.utils.dom.startTextWidthCache=function(){e.utils.dom.cacheReference_++,e.utils.dom.cacheWidths_||(e.utils.dom.cacheWidths_=Object.create(null))},e.utils.dom.stopTextWidthCache=function(){e.utils.dom.cacheReference_--,e.utils.dom.cacheReference_||(e.utils.dom.cacheWidths_=null)},e.utils.dom.getTextWidth=function(t){var o,n=t.textContent+"\n"+t.className.baseVal;if(e.utils.dom.cacheWidths_&&(o=e.utils.dom.cacheWidths_[n]))return o;try{o=e.utils.userAgent.IE||e.utils.userAgent.EDGE?t.getBBox().width:t.getComputedTextLength()}catch(r){return 8*t.textContent.length}return e.utils.dom.cacheWidths_&&(e.utils.dom.cacheWidths_[n]=o),o},e.utils.dom.getFastTextWidth=function(t,n,o,r){return e.utils.dom.getFastTextWidthWithSizeString(t,n+"pt",o,r)},e.utils.dom.getFastTextWidthWithSizeString=function(t,n,o,r){var h,a=t.textContent;return t=a+"\n"+t.className.baseVal,e.utils.dom.cacheWidths_&&(h=e.utils.dom.cacheWidths_[t])||(e.utils.dom.canvasContext_||((h=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(h),e.utils.dom.canvasContext_=h.getContext("2d")),e.utils.dom.canvasContext_.font=o+" "+n+" "+r,h=e.utils.dom.canvasContext_.measureText(a).width,e.utils.dom.cacheWidths_&&(e.utils.dom.cacheWidths_[t]=h)),h},e.utils.dom.measureFontMetrics=function(t,n,o,r){var a=document.createElement("span");a.style.font=o+" "+n+" "+r,a.textContent=t,(t=document.createElement("div")).style.width="1px",t.style.height="0px",(n=document.createElement("div")).setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),n.appendChild(a),n.appendChild(t),document.body.appendChild(n);try{o={},n.style.alignItems="baseline",o.baseline=t.offsetTop-a.offsetTop,n.style.alignItems="flex-end",o.height=t.offsetTop-a.offsetTop}finally{document.body.removeChild(n)}return o},e.utils.math={},e.utils.math.toRadians=function(t){return t*Math.PI/180},e.utils.math.toDegrees=function(t){return 180*t/Math.PI},e.utils.math.clamp=function(t,n,o){if(o<t){var r=o;o=t,t=r}return Math.max(t,Math.min(n,o))},e.DropDownDiv=function(){},e.DropDownDiv.boundsElement_=null,e.DropDownDiv.owner_=null,e.DropDownDiv.positionToField_=null,e.DropDownDiv.ARROW_SIZE=16,e.DropDownDiv.BORDER_SIZE=1,e.DropDownDiv.ARROW_HORIZONTAL_PADDING=12,e.DropDownDiv.PADDING_Y=16,e.DropDownDiv.ANIMATION_TIME=.25,e.DropDownDiv.animateOutTimer_=null,e.DropDownDiv.onHide_=null,e.DropDownDiv.rendererClassName_="",e.DropDownDiv.themeClassName_="",e.DropDownDiv.createDom=function(){if(!e.DropDownDiv.DIV_){var t=document.createElement("div");t.className="blocklyDropDownDiv",(e.parentContainer||document.body).appendChild(t),e.DropDownDiv.DIV_=t;var n=document.createElement("div");n.className="blocklyDropDownContent",t.appendChild(n),e.DropDownDiv.content_=n,(n=document.createElement("div")).className="blocklyDropDownArrow",t.appendChild(n),e.DropDownDiv.arrow_=n,e.DropDownDiv.DIV_.style.opacity=0,e.DropDownDiv.DIV_.style.transition="transform "+e.DropDownDiv.ANIMATION_TIME+"s, opacity "+e.DropDownDiv.ANIMATION_TIME+"s",t.addEventListener("focusin",function(){e.utils.dom.addClass(t,"blocklyFocused")}),t.addEventListener("focusout",function(){e.utils.dom.removeClass(t,"blocklyFocused")})}},e.DropDownDiv.setBoundsElement=function(t){e.DropDownDiv.boundsElement_=t},e.DropDownDiv.getContentDiv=function(){return e.DropDownDiv.content_},e.DropDownDiv.clearContent=function(){e.DropDownDiv.content_.textContent="",e.DropDownDiv.content_.style.width=""},e.DropDownDiv.setColour=function(t,n){e.DropDownDiv.DIV_.style.backgroundColor=t,e.DropDownDiv.DIV_.style.borderColor=n},e.DropDownDiv.showPositionedByBlock=function(t,n,o,r){return e.DropDownDiv.showPositionedByRect_(e.DropDownDiv.getScaledBboxOfBlock_(n),t,o,r)},e.DropDownDiv.showPositionedByField=function(t,n,o){return e.DropDownDiv.positionToField_=!0,e.DropDownDiv.showPositionedByRect_(e.DropDownDiv.getScaledBboxOfField_(t),t,n,o)},e.DropDownDiv.getScaledBboxOfBlock_=function(t){var n=t.getSvgRoot(),o=n.getBBox(),r=t.workspace.scale;return t=o.height*r,o=o.width*r,n=e.utils.style.getPageOffset(n),new e.utils.Rect(n.y,n.y+t,n.x,n.x+o)},e.DropDownDiv.getScaledBboxOfField_=function(t){return t=t.getScaledBBox(),new e.utils.Rect(t.top,t.bottom,t.left,t.right)},e.DropDownDiv.showPositionedByRect_=function(t,n,o,r){var a=t.left+(t.right-t.left)/2,h=t.bottom;t=t.top,r&&(t+=r);for(var R=(r=n.getSourceBlock()).workspace;R.options.parentWorkspace;)R=R.options.parentWorkspace;return e.DropDownDiv.setBoundsElement(R.getParentSvg().parentNode),e.DropDownDiv.show(n,r.RTL,a,h,a,t,o)},e.DropDownDiv.show=function(t,n,o,r,a,h,R){return e.DropDownDiv.owner_=t,e.DropDownDiv.onHide_=R||null,(t=e.DropDownDiv.DIV_).style.direction=n?"rtl":"ltr",n=e.getMainWorkspace(),e.DropDownDiv.rendererClassName_=n.getRenderer().getClassName(),e.DropDownDiv.themeClassName_=n.getTheme().getClassName(),e.utils.dom.addClass(t,e.DropDownDiv.rendererClassName_),e.utils.dom.addClass(t,e.DropDownDiv.themeClassName_),e.DropDownDiv.positionInternal_(o,r,a,h)},e.DropDownDiv.getBoundsInfo_=function(){var t=e.utils.style.getPageOffset(e.DropDownDiv.boundsElement_),n=e.utils.style.getSize(e.DropDownDiv.boundsElement_);return{left:t.x,right:t.x+n.width,top:t.y,bottom:t.y+n.height,width:n.width,height:n.height}},e.DropDownDiv.getPositionMetrics_=function(t,n,o,r){var a=e.DropDownDiv.getBoundsInfo_(),h=e.utils.style.getSize(e.DropDownDiv.DIV_);return n+h.height<a.bottom?e.DropDownDiv.getPositionBelowMetrics_(t,n,a,h):r-h.height>a.top?e.DropDownDiv.getPositionAboveMetrics_(o,r,a,h):n+h.height<document.documentElement.clientHeight?e.DropDownDiv.getPositionBelowMetrics_(t,n,a,h):r-h.height>document.documentElement.clientTop?e.DropDownDiv.getPositionAboveMetrics_(o,r,a,h):e.DropDownDiv.getPositionTopOfPageMetrics_(t,a,h)},e.DropDownDiv.getPositionBelowMetrics_=function(t,n,o,r){return{initialX:(t=e.DropDownDiv.getPositionX(t,o.left,o.right,r.width)).divX,initialY:n,finalX:t.divX,finalY:n+e.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:-(e.DropDownDiv.ARROW_SIZE/2+e.DropDownDiv.BORDER_SIZE),arrowAtTop:!0,arrowVisible:!0}},e.DropDownDiv.getPositionAboveMetrics_=function(t,n,o,r){return{initialX:(t=e.DropDownDiv.getPositionX(t,o.left,o.right,r.width)).divX,initialY:n-r.height,finalX:t.divX,finalY:n-r.height-e.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:r.height-2*e.DropDownDiv.BORDER_SIZE-e.DropDownDiv.ARROW_SIZE/2,arrowAtTop:!1,arrowVisible:!0}},e.DropDownDiv.getPositionTopOfPageMetrics_=function(t,n,o){return{initialX:(t=e.DropDownDiv.getPositionX(t,n.left,n.right,o.width)).divX,initialY:0,finalX:t.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},e.DropDownDiv.getPositionX=function(t,n,o,r){var a=t;return t=e.utils.math.clamp(n,t-r/2,o-r),{arrowX:r=e.utils.math.clamp(n=e.DropDownDiv.ARROW_HORIZONTAL_PADDING,(a-=e.DropDownDiv.ARROW_SIZE/2)-t,r-n-e.DropDownDiv.ARROW_SIZE),divX:t}},e.DropDownDiv.isVisible=function(){return!!e.DropDownDiv.owner_},e.DropDownDiv.hideIfOwner=function(t,n){return e.DropDownDiv.owner_===t&&(n?e.DropDownDiv.hideWithoutAnimation():e.DropDownDiv.hide(),!0)},e.DropDownDiv.hide=function(){var t=e.DropDownDiv.DIV_;t.style.transform="translate(0, 0)",t.style.opacity=0,e.DropDownDiv.animateOutTimer_=setTimeout(function(){e.DropDownDiv.hideWithoutAnimation()},1e3*e.DropDownDiv.ANIMATION_TIME),e.DropDownDiv.onHide_&&(e.DropDownDiv.onHide_(),e.DropDownDiv.onHide_=null)},e.DropDownDiv.hideWithoutAnimation=function(){if(e.DropDownDiv.isVisible()){e.DropDownDiv.animateOutTimer_&&clearTimeout(e.DropDownDiv.animateOutTimer_);var t=e.DropDownDiv.DIV_;t.style.transform="",t.style.left="",t.style.top="",t.style.opacity=0,t.style.display="none",t.style.backgroundColor="",t.style.borderColor="",e.DropDownDiv.onHide_&&(e.DropDownDiv.onHide_(),e.DropDownDiv.onHide_=null),e.DropDownDiv.clearContent(),e.DropDownDiv.owner_=null,e.DropDownDiv.rendererClassName_&&(e.utils.dom.removeClass(t,e.DropDownDiv.rendererClassName_),e.DropDownDiv.rendererClassName_=""),e.DropDownDiv.themeClassName_&&(e.utils.dom.removeClass(t,e.DropDownDiv.themeClassName_),e.DropDownDiv.themeClassName_=""),e.getMainWorkspace().markFocused()}},e.DropDownDiv.positionInternal_=function(t,n,o,r){(t=e.DropDownDiv.getPositionMetrics_(t,n,o,r)).arrowVisible?(e.DropDownDiv.arrow_.style.display="",e.DropDownDiv.arrow_.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",e.DropDownDiv.arrow_.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):e.DropDownDiv.arrow_.style.display="none",n=Math.floor(t.initialX),o=Math.floor(t.initialY),r=Math.floor(t.finalX);var a=Math.floor(t.finalY),h=e.DropDownDiv.DIV_;return h.style.left=n+"px",h.style.top=o+"px",h.style.display="block",h.style.opacity=1,h.style.transform="translate("+(r-n)+"px,"+(a-o)+"px)",!!t.arrowAtTop},e.DropDownDiv.repositionForWindowResize=function(){if(e.DropDownDiv.owner_){var t=e.DropDownDiv.owner_,n=t.getSourceBlock();t=e.DropDownDiv.positionToField_?e.DropDownDiv.getScaledBboxOfField_(t):e.DropDownDiv.getScaledBboxOfBlock_(n),e.DropDownDiv.positionInternal_(n=t.left+(t.right-t.left)/2,t.bottom,n,t.top)}else e.DropDownDiv.hide()},e.registry={},e.registry.typeMap_=Object.create(null),e.registry.DEFAULT="default",e.registry.Type=function(t){this.name_=t},e.registry.Type.prototype.toString=function(){return this.name_},e.registry.Type.CONNECTION_CHECKER=new e.registry.Type("connectionChecker"),e.registry.Type.CURSOR=new e.registry.Type("cursor"),e.registry.Type.EVENT=new e.registry.Type("event"),e.registry.Type.FIELD=new e.registry.Type("field"),e.registry.Type.RENDERER=new e.registry.Type("renderer"),e.registry.Type.TOOLBOX=new e.registry.Type("toolbox"),e.registry.Type.THEME=new e.registry.Type("theme"),e.registry.Type.TOOLBOX_ITEM=new e.registry.Type("toolboxItem"),e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX=new e.registry.Type("flyoutsVerticalToolbox"),e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX=new e.registry.Type("flyoutsHorizontalToolbox"),e.registry.Type.METRICS_MANAGER=new e.registry.Type("metricsManager"),e.registry.Type.BLOCK_DRAGGER=new e.registry.Type("blockDragger"),e.registry.register=function(t,n,o,r){if(!(t instanceof e.registry.Type)&&"string"!=typeof t||""==String(t).trim())throw Error('Invalid type "'+t+'". The type must be a non-empty string or a Blockly.registry.Type.');if(t=String(t).toLowerCase(),"string"!=typeof n||""==n.trim())throw Error('Invalid name "'+n+'". The name must be a non-empty string.');if(n=n.toLowerCase(),!o)throw Error("Can not register a null value");var a=e.registry.typeMap_[t];if(a||(a=e.registry.typeMap_[t]=Object.create(null)),e.registry.validate_(t,o),!r&&a[n])throw Error('Name "'+n+'" with type "'+t+'" already registered.');a[n]=o},e.registry.validate_=function(t,n){if(t===String(e.registry.Type.FIELD)&&"function"!=typeof n.fromJson)throw Error('Type "'+t+'" must have a fromJson function')},e.registry.unregister=function(t,n){t=String(t).toLowerCase(),n=n.toLowerCase();var o=e.registry.typeMap_[t];o&&o[n]?delete e.registry.typeMap_[t][n]:console.warn("Unable to unregister ["+n+"]["+t+"] from the registry.")},e.registry.getItem_=function(t,n,o){t=String(t).toLowerCase(),n=n.toLowerCase();var r=e.registry.typeMap_[t];if(!r||!r[n]){if(n="Unable to find ["+n+"]["+t+"] in the registry.",o)throw Error(n+" You must require or register a "+t+" plugin.");return console.warn(n),null}return r[n]},e.registry.hasItem=function(t,n){return t=String(t).toLowerCase(),n=n.toLowerCase(),!!(t=e.registry.typeMap_[t])&&!!t[n]},e.registry.getClass=function(t,n,o){return e.registry.getItem_(t,n,o)},e.registry.getObject=function(t,n,o){return e.registry.getItem_(t,n,o)},e.registry.getClassFromOptions=function(t,n,o){return"function"==typeof(n=n.plugins[t.toString()]||e.registry.DEFAULT)?n:e.registry.getClass(t,n,o)},e.Events={},e.Events.group_="",e.Events.recordUndo=!0,e.Events.disabled_=0,e.Events.CREATE="create",e.Events.BLOCK_CREATE=e.Events.CREATE,e.Events.DELETE="delete",e.Events.BLOCK_DELETE=e.Events.DELETE,e.Events.CHANGE="change",e.Events.BLOCK_CHANGE=e.Events.CHANGE,e.Events.MOVE="move",e.Events.BLOCK_MOVE=e.Events.MOVE,e.Events.VAR_CREATE="var_create",e.Events.VAR_DELETE="var_delete",e.Events.VAR_RENAME="var_rename",e.Events.UI="ui",e.Events.BLOCK_DRAG="drag",e.Events.SELECTED="selected",e.Events.CLICK="click",e.Events.MARKER_MOVE="marker_move",e.Events.BUBBLE_OPEN="bubble_open",e.Events.TRASHCAN_OPEN="trashcan_open",e.Events.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.Events.THEME_CHANGE="theme_change",e.Events.VIEWPORT_CHANGE="viewport_change",e.Events.COMMENT_CREATE="comment_create",e.Events.COMMENT_DELETE="comment_delete",e.Events.COMMENT_CHANGE="comment_change",e.Events.COMMENT_MOVE="comment_move",e.Events.FINISHED_LOADING="finished_loading",e.Events.BUMP_EVENTS=[e.Events.BLOCK_CREATE,e.Events.BLOCK_MOVE,e.Events.COMMENT_CREATE,e.Events.COMMENT_MOVE],e.Events.FIRE_QUEUE_=[],e.Events.fire=function(t){e.Events.isEnabled()&&(e.Events.FIRE_QUEUE_.length||setTimeout(e.Events.fireNow_,0),e.Events.FIRE_QUEUE_.push(t))},e.Events.fireNow_=function(){for(var o,t=e.Events.filter(e.Events.FIRE_QUEUE_,!0),n=e.Events.FIRE_QUEUE_.length=0;o=t[n];n++)if(o.workspaceId){var r=e.Workspace.getById(o.workspaceId);r&&r.fireChangeListener(o)}},e.Events.filter=function(t,n){t=t.slice(),n||t.reverse();for(var h,o=[],r=Object.create(null),a=0;h=t[a];a++)if(!h.isNull()){var R=[h.isUiEvent?e.Events.UI:h.type,h.blockId,h.workspaceId].join(" "),L=r[R],W=L?L.event:null;L?h.type==e.Events.MOVE&&L.index==a-1?(W.newParentId=h.newParentId,W.newInputName=h.newInputName,W.newCoordinate=h.newCoordinate,L.index=a):h.type==e.Events.CHANGE&&h.element==W.element&&h.name==W.name?W.newValue=h.newValue:h.type==e.Events.VIEWPORT_CHANGE?(W.viewTop=h.viewTop,W.viewLeft=h.viewLeft,W.scale=h.scale,W.oldScale=h.oldScale):(h.type!=e.Events.CLICK||W.type!=e.Events.BUBBLE_OPEN)&&(r[R]={event:h,index:a},o.push(h)):(r[R]={event:h,index:a},o.push(h))}for(t=o.filter(function(nt){return!nt.isNull()}),n||t.reverse(),a=1;h=t[a];a++)h.type==e.Events.CHANGE&&"mutation"==h.element&&t.unshift(t.splice(a,1)[0]);return t},e.Events.clearPendingUndo=function(){for(var n,t=0;n=e.Events.FIRE_QUEUE_[t];t++)n.recordUndo=!1},e.Events.disable=function(){e.Events.disabled_++},e.Events.enable=function(){e.Events.disabled_--},e.Events.isEnabled=function(){return 0==e.Events.disabled_},e.Events.getGroup=function(){return e.Events.group_},e.Events.setGroup=function(t){e.Events.group_="boolean"==typeof t?t?e.utils.genUid():"":t},e.Events.getDescendantIds=function(t){var n=[];t=t.getDescendants(!1);for(var r,o=0;r=t[o];o++)n[o]=r.id;return n},e.Events.fromJson=function(t,n){var o=e.Events.get(t.type);if(!o)throw Error("Unknown event type.");return(o=new o).fromJson(t),o.workspaceId=n.id,o},e.Events.get=function(t){return e.registry.getClass(e.registry.Type.EVENT,t)},e.Events.disableOrphans=function(t){if((t.type==e.Events.MOVE||t.type==e.Events.CREATE)&&t.workspaceId){var n=e.Workspace.getById(t.workspaceId),o=n.getBlockById(t.blockId);if(o){t=e.Events.recordUndo;try{e.Events.recordUndo=!1;var r=o.getParent();if(r&&r.isEnabled()){var h,a=o.getDescendants(!1);for(n=0;h=a[n];n++)h.setEnabled(!0)}else if((o.outputConnection||o.previousConnection)&&!n.isDragging())do{o.setEnabled(!1),o=o.getNextBlock()}while(o)}finally{e.Events.recordUndo=t}}}},e.Events.Abstract=function(){this.isBlank=null,this.workspaceId=void 0,this.group=e.Events.getGroup(),this.recordUndo=e.Events.recordUndo},e.Events.Abstract.prototype.isUiEvent=!1,e.Events.Abstract.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),t},e.Events.Abstract.prototype.fromJson=function(t){this.isBlank=!1,this.group=t.group},e.Events.Abstract.prototype.isNull=function(){return!1},e.Events.Abstract.prototype.run=function(t){},e.Events.Abstract.prototype.getEventWorkspace_=function(){if(this.workspaceId)var t=e.Workspace.getById(this.workspaceId);if(!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t},e.utils.object={},e.utils.object.inherits=function(t,n){t.superClass_=n.prototype,t.prototype=Object.create(n.prototype),t.prototype.constructor=t},e.utils.object.mixin=function(t,n){for(var o in n)t[o]=n[o]},e.utils.object.deepMerge=function(t,n){for(var o in n)t[o]=null!=n[o]&&"object"==typeof n[o]?e.utils.object.deepMerge(t[o]||Object.create(null),n[o]):n[o];return t},e.utils.object.values=function(t){return Object.values?Object.values(t):Object.keys(t).map(function(n){return t[n]})},e.utils.xml={},e.utils.xml.NAME_SPACE="https://developers.google.com/blockly/xml",e.utils.xml.document=function(){return document},e.utils.xml.createElement=function(t){return e.utils.xml.document().createElementNS(e.utils.xml.NAME_SPACE,t)},e.utils.xml.createTextNode=function(t){return e.utils.xml.document().createTextNode(t)},e.utils.xml.textToDomDocument=function(t){return(new DOMParser).parseFromString(t,"text/xml")},e.utils.xml.domToText=function(t){return(new XMLSerializer).serializeToString(t)},e.inputTypes={VALUE:e.connectionTypes.INPUT_VALUE,STATEMENT:e.connectionTypes.NEXT_STATEMENT,DUMMY:5},e.Xml={},e.Xml.workspaceToDom=function(t,n){var o=e.utils.xml.createElement("xml"),r=e.Xml.variablesToDom(e.Variables.allUsedVarModels(t));r.hasChildNodes()&&o.appendChild(r);var h,a=t.getTopComments(!0);for(r=0;h=a[r];r++)o.appendChild(h.toXmlWithXY(n));for(t=t.getTopBlocks(!0),r=0;a=t[r];r++)o.appendChild(e.Xml.blockToDomWithXY(a,n));return o},e.Xml.variablesToDom=function(t){for(var r,n=e.utils.xml.createElement("variables"),o=0;r=t[o];o++){var a=e.utils.xml.createElement("variable");a.appendChild(e.utils.xml.createTextNode(r.name)),r.type&&a.setAttribute("type",r.type),a.id=r.getId(),n.appendChild(a)}return n},e.Xml.blockToDomWithXY=function(t,n){if(t.isInsertionMarker()&&!(t=t.getChildren(!1)[0]))return new DocumentFragment;var o;t.workspace.RTL&&(o=t.workspace.getWidth()),n=e.Xml.blockToDom(t,n);var r=t.getRelativeToSurfaceXY();return n.setAttribute("x",Math.round(t.workspace.RTL?o-r.x:r.x)),n.setAttribute("y",Math.round(r.y)),n},e.Xml.fieldToDom_=function(t){if(t.isSerializable()){var n=e.utils.xml.createElement("field");return n.setAttribute("name",t.name||""),t.toXml(n)}return null},e.Xml.allFieldsToDom_=function(t,n){for(var r,o=0;r=t.inputList[o];o++)for(var h,a=0;h=r.fieldRow[a];a++)(h=e.Xml.fieldToDom_(h))&&n.appendChild(h)},e.Xml.blockToDom=function(t,n){if(t.isInsertionMarker())return(t=t.getChildren(!1)[0])?e.Xml.blockToDom(t):new DocumentFragment;var o=e.utils.xml.createElement(t.isShadow()?"shadow":"block");if(o.setAttribute("type",t.type),n||o.setAttribute("id",t.id),t.mutationToDom){var r=t.mutationToDom();r&&(r.hasChildNodes()||r.hasAttributes())&&o.appendChild(r)}if(e.Xml.allFieldsToDom_(t,o),r=t.getCommentText()){var a=t.commentModel.size,h=t.commentModel.pinned,R=e.utils.xml.createElement("comment");R.appendChild(e.utils.xml.createTextNode(r)),R.setAttribute("pinned",h),R.setAttribute("h",a.height),R.setAttribute("w",a.width),o.appendChild(R)}for(t.data&&((r=e.utils.xml.createElement("data")).appendChild(e.utils.xml.createTextNode(t.data)),o.appendChild(r)),r=0;a=t.inputList[r];r++){var L;if(h=!0,a.type!=e.inputTypes.DUMMY){var W=a.connection.targetBlock();a.type==e.inputTypes.VALUE?L=e.utils.xml.createElement("value"):a.type==e.inputTypes.STATEMENT&&(L=e.utils.xml.createElement("statement")),!(R=a.connection.getShadowDom())||W&&W.isShadow()||L.appendChild(e.Xml.cloneShadow_(R,n)),W&&(R=e.Xml.blockToDom(W,n)).nodeType==e.utils.dom.NodeType.ELEMENT_NODE&&(L.appendChild(R),h=!1),L.setAttribute("name",a.name),h||o.appendChild(L)}}return null!=t.inputsInline&&t.inputsInline!=t.inputsInlineDefault&&o.setAttribute("inline",t.inputsInline),t.isCollapsed()&&o.setAttribute("collapsed",!0),t.isEnabled()||o.setAttribute("disabled",!0),t.isDeletable()||t.isShadow()||o.setAttribute("deletable",!1),t.isMovable()||t.isShadow()||o.setAttribute("movable",!1),t.isEditable()||o.setAttribute("editable",!1),(r=t.getNextBlock())&&(R=e.Xml.blockToDom(r,n)).nodeType==e.utils.dom.NodeType.ELEMENT_NODE&&((L=e.utils.xml.createElement("next")).appendChild(R),o.appendChild(L)),!(R=t.nextConnection&&t.nextConnection.getShadowDom())||r&&r.isShadow()||L.appendChild(e.Xml.cloneShadow_(R,n)),o},e.Xml.cloneShadow_=function(t,n){for(var r,o=t=t.cloneNode(!0);o;)if(n&&"shadow"==o.nodeName&&o.removeAttribute("id"),o.firstChild)o=o.firstChild;else{for(;o&&!o.nextSibling;)r=o,o=o.parentNode,r.nodeType==e.utils.dom.NodeType.TEXT_NODE&&""==r.data.trim()&&o.firstChild!=r&&e.utils.dom.removeNode(r);o&&(r=o,o=o.nextSibling,r.nodeType==e.utils.dom.NodeType.TEXT_NODE&&""==r.data.trim()&&e.utils.dom.removeNode(r))}return t},e.Xml.domToText=function(t){return e.utils.xml.domToText(t).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},e.Xml.domToPrettyText=function(t){t=e.Xml.domToText(t).split("<");for(var n="",o=1;o<t.length;o++){var r=t[o];"/"==r[0]&&(n=n.substring(2)),t[o]=n+"<"+r,"/"!=r[0]&&"/>"!=r.slice(-2)&&(n+="  ")}return(t=(t=t.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},e.Xml.textToDom=function(t){var n=e.utils.xml.textToDomDocument(t);if(!n||!n.documentElement||n.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+t);return n.documentElement},e.Xml.clearWorkspaceAndLoadFromXml=function(t,n){return n.setResizesEnabled(!1),n.clear(),t=e.Xml.domToWorkspace(t,n),n.setResizesEnabled(!0),t},e.Xml.domToWorkspace=function(t,n){if(t instanceof e.Workspace){var o=t;t=n,n=o,console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var r;n.RTL&&(r=n.getWidth()),o=[],e.utils.dom.startTextWidthCache();var a=e.Events.getGroup();a||e.Events.setGroup(!0),n.setResizesEnabled&&n.setResizesEnabled(!1);var h=!0;try{for(var L,R=0;L=t.childNodes[R];R++){var W=L.nodeName.toLowerCase(),nt=L;if("block"==W||"shadow"==W&&!e.Events.recordUndo){var et=e.Xml.domToBlock(nt,n);o.push(et.id);var Et=nt.hasAttribute("x")?parseInt(nt.getAttribute("x"),10):10,It=nt.hasAttribute("y")?parseInt(nt.getAttribute("y"),10):10;isNaN(Et)||isNaN(It)||et.moveBy(n.RTL?r-Et:Et,It),h=!1}else{if("shadow"==W)throw TypeError("Shadow block cannot be a top-level block.");if("comment"==W)n.rendered?e.WorkspaceCommentSvg?e.WorkspaceCommentSvg.fromXml(nt,n,r):console.warn("Missing require for Blockly.WorkspaceCommentSvg, ignoring workspace comment."):e.WorkspaceComment?e.WorkspaceComment.fromXml(nt,n):console.warn("Missing require for Blockly.WorkspaceComment, ignoring workspace comment.");else if("variables"==W){if(!h)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");e.Xml.domToVariables(nt,n),h=!1}}}}finally{a||e.Events.setGroup(!1),e.utils.dom.stopTextWidthCache()}return n.setResizesEnabled&&n.setResizesEnabled(!0),e.Events.fire(new(e.Events.get(e.Events.FINISHED_LOADING))(n)),o},e.Xml.appendDomToWorkspace=function(t,n){var o;if(Object.prototype.hasOwnProperty.call(n,"scale")&&(o=n.getBlocksBoundingBox()),t=e.Xml.domToWorkspace(t,n),o&&o.top!=o.bottom){var r=o.bottom,a=n.RTL?o.right:o.left,h=1/0,R=-1/0,L=1/0;for(o=0;o<t.length;o++){var W=n.getBlockById(t[o]).getRelativeToSurfaceXY();W.y<L&&(L=W.y),W.x<h&&(h=W.x),W.x>R&&(R=W.x)}for(r=r-L+10,a=n.RTL?a-R:a-h,o=0;o<t.length;o++)n.getBlockById(t[o]).moveBy(a,r)}return t},e.Xml.domToBlock=function(t,n){if(t instanceof e.Workspace){var o=t;t=n,n=o,console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}e.Events.disable(),o=n.getAllVariables();try{var r=e.Xml.domToBlockHeadless_(t,n),a=r.getDescendants(!1);if(n.rendered){r.setConnectionTracking(!1);for(var h=a.length-1;0<=h;h--)a[h].initSvg();for(h=a.length-1;0<=h;h--)a[h].render(!1);setTimeout(function(){r.disposed||r.setConnectionTracking(!0)},1),r.updateDisabled(),n.resizeContents()}else for(h=a.length-1;0<=h;h--)a[h].initModel()}finally{e.Events.enable()}if(e.Events.isEnabled()){for(t=e.Variables.getAddedVariables(n,o),h=0;h<t.length;h++)n=t[h],e.Events.fire(new(e.Events.get(e.Events.VAR_CREATE))(n));e.Events.fire(new(e.Events.get(e.Events.CREATE))(r))}return r},e.Xml.domToVariables=function(t,n){for(var r,o=0;r=t.childNodes[o];o++)if(r.nodeType==e.utils.dom.NodeType.ELEMENT_NODE){var a=r.getAttribute("type"),h=r.getAttribute("id");n.createVariable(r.textContent,a,h)}},e.Xml.mapSupportedXmlTags_=function(t){for(var r,n={mutation:[],comment:[],data:[],field:[],input:[],next:[]},o=0;r=t.childNodes[o];o++)if(r.nodeType!=e.utils.dom.NodeType.TEXT_NODE)switch(r.nodeName.toLowerCase()){case"mutation":n.mutation.push(r);break;case"comment":if(!e.Comment){console.warn("Missing require for Blockly.Comment, ignoring block comment.");break}n.comment.push(r);break;case"data":n.data.push(r);break;case"title":case"field":n.field.push(r);break;case"value":case"statement":n.input.push(r);break;case"next":n.next.push(r);break;default:console.warn("Ignoring unknown tag: "+r.nodeName)}return n},e.Xml.applyMutationTagNodes_=function(t,n){for(var a,o=!1,r=0;a=t[r];r++)n.domToMutation&&(n.domToMutation(a),n.initSvg&&(o=!0));return o},e.Xml.applyCommentTagNodes_=function(t,n){for(var r,o=0;r=t[o];o++){var a=r.textContent,h="true"==r.getAttribute("pinned"),R=parseInt(r.getAttribute("w"),10);r=parseInt(r.getAttribute("h"),10),n.setCommentText(a),n.commentModel.pinned=h,isNaN(R)||isNaN(r)||(n.commentModel.size=new e.utils.Size(R,r)),h&&n.getCommentIcon&&!n.isInFlyout&&setTimeout(function(){n.getCommentIcon().setVisible(!0)},1)}},e.Xml.applyDataTagNodes_=function(t,n){for(var r,o=0;r=t[o];o++)n.data=r.textContent},e.Xml.applyFieldTagNodes_=function(t,n){for(var r,o=0;r=t[o];o++){var a=r.getAttribute("name");e.Xml.domToField_(n,a,r)}},e.Xml.findChildBlocks_=function(t){for(var r,n={childBlockElement:null,childShadowElement:null},o=0;r=t.childNodes[o];o++)r.nodeType==e.utils.dom.NodeType.ELEMENT_NODE&&("block"==r.nodeName.toLowerCase()?n.childBlockElement=r:"shadow"==r.nodeName.toLowerCase()&&(n.childShadowElement=r));return n},e.Xml.applyInputTagNodes_=function(t,n,o,r){for(var h,a=0;h=t[a];a++){var R=h.getAttribute("name"),L=o.getInput(R);if(!L){console.warn("Ignoring non-existent input "+R+" in block "+r);break}if((h=e.Xml.findChildBlocks_(h)).childBlockElement){if(!L.connection)throw TypeError("Input connection does not exist.");e.Xml.domToBlockHeadless_(h.childBlockElement,n,L.connection,!1)}h.childShadowElement&&L.connection.setShadowDom(h.childShadowElement)}},e.Xml.applyNextTagNodes_=function(t,n,o){for(var a,r=0;a=t[r];r++){if((a=e.Xml.findChildBlocks_(a)).childBlockElement){if(!o.nextConnection)throw TypeError("Next statement does not exist.");if(o.nextConnection.isConnected())throw TypeError("Next statement is already connected.");e.Xml.domToBlockHeadless_(a.childBlockElement,n,o.nextConnection,!0)}a.childShadowElement&&o.nextConnection&&o.nextConnection.setShadowDom(a.childShadowElement)}},e.Xml.domToBlockHeadless_=function(t,n,o,r){var a=t.getAttribute("type");if(!a)throw TypeError("Block type unspecified: "+t.outerHTML);var h=t.getAttribute("id");h=n.newBlock(a,h);var R=e.Xml.mapSupportedXmlTags_(t),L=e.Xml.applyMutationTagNodes_(R.mutation,h);if(e.Xml.applyCommentTagNodes_(R.comment,h),e.Xml.applyDataTagNodes_(R.data,h),o)if(r){if(!h.previousConnection)throw TypeError("Next block does not have previous statement.");o.connect(h.previousConnection)}else if(h.outputConnection)o.connect(h.outputConnection);else{if(!h.previousConnection)throw TypeError("Child block does not have output or previous statement.");o.connect(h.previousConnection)}if(e.Xml.applyFieldTagNodes_(R.field,h),e.Xml.applyInputTagNodes_(R.input,n,h,a),e.Xml.applyNextTagNodes_(R.next,n,h),L&&h.initSvg(),(n=t.getAttribute("inline"))&&h.setInputsInline("true"==n),(n=t.getAttribute("disabled"))&&h.setEnabled("true"!=n&&"disabled"!=n),(n=t.getAttribute("deletable"))&&h.setDeletable("true"==n),(n=t.getAttribute("movable"))&&h.setMovable("true"==n),(n=t.getAttribute("editable"))&&h.setEditable("true"==n),(n=t.getAttribute("collapsed"))&&h.setCollapsed("true"==n),"shadow"==t.nodeName.toLowerCase()){for(t=h.getChildren(!1),n=0;o=t[n];n++)if(!o.isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(h.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");h.setShadow(!0)}return h},e.Xml.domToField_=function(t,n,o){var r=t.getField(n);r?r.fromXml(o):console.warn("Ignoring non-existent field "+n+" in block "+t.type)},e.Xml.deleteNext=function(t){for(var o,n=0;o=t.childNodes[n];n++)if("next"==o.nodeName.toLowerCase()){t.removeChild(o);break}},e.Events.BlockBase=function(t){e.Events.BlockBase.superClass_.constructor.call(this),this.blockId=(this.isBlank=void 0===t)?"":t.id,this.workspaceId=this.isBlank?"":t.workspace.id},e.utils.object.inherits(e.Events.BlockBase,e.Events.Abstract),e.Events.BlockBase.prototype.toJson=function(){var t=e.Events.BlockBase.superClass_.toJson.call(this);return t.blockId=this.blockId,t},e.Events.BlockBase.prototype.fromJson=function(t){e.Events.BlockBase.superClass_.fromJson.call(this,t),this.blockId=t.blockId},e.Events.BlockChange=function(t,n,o,r,a){e.Events.Change.superClass_.constructor.call(this,t),t&&(this.element=void 0===n?"":n,this.name=void 0===o?"":o,this.oldValue=void 0===r?"":r,this.newValue=void 0===a?"":a)},e.utils.object.inherits(e.Events.BlockChange,e.Events.BlockBase),e.Events.Change=e.Events.BlockChange,e.Events.BlockChange.prototype.type=e.Events.CHANGE,e.Events.BlockChange.prototype.toJson=function(){var t=e.Events.BlockChange.superClass_.toJson.call(this);return t.element=this.element,this.name&&(t.name=this.name),t.oldValue=this.oldValue,t.newValue=this.newValue,t},e.Events.BlockChange.prototype.fromJson=function(t){e.Events.BlockChange.superClass_.fromJson.call(this,t),this.element=t.element,this.name=t.name,this.oldValue=t.oldValue,this.newValue=t.newValue},e.Events.BlockChange.prototype.isNull=function(){return this.oldValue==this.newValue},e.Events.BlockChange.prototype.run=function(t){var n=this.getEventWorkspace_().getBlockById(this.blockId);if(n)switch(n.mutator&&n.mutator.setVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(n=n.getField(this.name))?n.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":n.setCommentText(t||null);break;case"collapsed":n.setCollapsed(!!t);break;case"disabled":n.setEnabled(!t);break;case"inline":n.setInputsInline(!!t);break;case"mutation":var o="";if(n.mutationToDom&&(o=(o=n.mutationToDom())&&e.Xml.domToText(o)),n.domToMutation){var r=e.Xml.textToDom(t||"<mutation/>");n.domToMutation(r)}e.Events.fire(new e.Events.BlockChange(n,"mutation",null,o,t));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existent block: "+this.blockId)},e.Events.Create=function(t){e.Events.Create.superClass_.constructor.call(this,t),t&&(t.isShadow()&&(this.recordUndo=!1),this.xml=t.workspace.rendered?e.Xml.blockToDomWithXY(t):e.Xml.blockToDom(t),this.ids=e.Events.getDescendantIds(t))},e.utils.object.inherits(e.Events.Create,e.Events.BlockBase),e.Events.BlockCreate=e.Events.Create,e.Events.Create.prototype.type=e.Events.CREATE,e.Events.Create.prototype.toJson=function(){var t=e.Events.Create.superClass_.toJson.call(this);return t.xml=e.Xml.domToText(this.xml),t.ids=this.ids,this.recordUndo||(t.recordUndo=this.recordUndo),t},e.Events.Create.prototype.fromJson=function(t){e.Events.Create.superClass_.fromJson.call(this,t),this.xml=e.Xml.textToDom(t.xml),this.ids=t.ids,void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},e.Events.Create.prototype.run=function(t){var n=this.getEventWorkspace_();if(t)(t=e.utils.xml.createElement("xml")).appendChild(this.xml),e.Xml.domToWorkspace(t,n);else{t=0;for(var o;o=this.ids[t];t++){var r=n.getBlockById(o);r?r.dispose(!1):o==this.blockId&&console.warn("Can't uncreate non-existent block: "+o)}}},e.Events.Delete=function(t){if(e.Events.Delete.superClass_.constructor.call(this,t),t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");t.isShadow()&&(this.recordUndo=!1),this.oldXml=t.workspace.rendered?e.Xml.blockToDomWithXY(t):e.Xml.blockToDom(t),this.ids=e.Events.getDescendantIds(t)}},e.utils.object.inherits(e.Events.Delete,e.Events.BlockBase),e.Events.BlockDelete=e.Events.Delete,e.Events.Delete.prototype.type=e.Events.DELETE,e.Events.Delete.prototype.toJson=function(){var t=e.Events.Delete.superClass_.toJson.call(this);return t.oldXml=e.Xml.domToText(this.oldXml),t.ids=this.ids,this.recordUndo||(t.recordUndo=this.recordUndo),t},e.Events.Delete.prototype.fromJson=function(t){e.Events.Delete.superClass_.fromJson.call(this,t),this.oldXml=e.Xml.textToDom(t.oldXml),this.ids=t.ids,void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},e.Events.Delete.prototype.run=function(t){var n=this.getEventWorkspace_();if(t){t=0;for(var o;o=this.ids[t];t++){var r=n.getBlockById(o);r?r.dispose(!1):o==this.blockId&&console.warn("Can't delete non-existent block: "+o)}}else(t=e.utils.xml.createElement("xml")).appendChild(this.oldXml),e.Xml.domToWorkspace(t,n)},e.Events.Move=function(t){e.Events.Move.superClass_.constructor.call(this,t),t&&(t.isShadow()&&(this.recordUndo=!1),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)},e.utils.object.inherits(e.Events.Move,e.Events.BlockBase),e.Events.BlockMove=e.Events.Move,e.Events.Move.prototype.type=e.Events.MOVE,e.Events.Move.prototype.toJson=function(){var t=e.Events.Move.superClass_.toJson.call(this);return this.newParentId&&(t.newParentId=this.newParentId),this.newInputName&&(t.newInputName=this.newInputName),this.newCoordinate&&(t.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),this.recordUndo||(t.recordUndo=this.recordUndo),t},e.Events.Move.prototype.fromJson=function(t){if(e.Events.Move.superClass_.fromJson.call(this,t),this.newParentId=t.newParentId,this.newInputName=t.newInputName,t.newCoordinate){var n=t.newCoordinate.split(",");this.newCoordinate=new e.utils.Coordinate(Number(n[0]),Number(n[1]))}void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},e.Events.Move.prototype.recordNew=function(){var t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate},e.Events.Move.prototype.currentLocation_=function(){var t=this.getEventWorkspace_().getBlockById(this.blockId),n={},o=t.getParent();return o?(n.parentId=o.id,(t=o.getInputWithBlock(t))&&(n.inputName=t.name)):n.coordinate=t.getRelativeToSurfaceXY(),n},e.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&e.utils.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},e.Events.Move.prototype.run=function(t){var n=this.getEventWorkspace_(),o=n.getBlockById(this.blockId);if(o){var r=t?this.newParentId:this.oldParentId,a=t?this.newInputName:this.oldInputName,h=t?this.newCoordinate:this.oldCoordinate;if(t=null,r&&!(t=n.getBlockById(r)))return void console.warn("Can't connect to non-existent block: "+r);if(o.getParent()&&o.unplug(),h)a=o.getRelativeToSurfaceXY(),o.moveBy(h.x-a.x,h.y-a.y);else{if(n=(o=o.outputConnection||o.previousConnection).type,a){if(t=t.getInput(a))var R=t.connection}else n==e.connectionTypes.PREVIOUS_STATEMENT&&(R=t.nextConnection);R?o.connect(R):console.warn("Can't connect to non-existent input: "+a)}}else console.warn("Can't move non-existent block: "+this.blockId)},e.registry.register(e.registry.Type.EVENT,e.Events.CREATE,e.Events.Create),e.registry.register(e.registry.Type.EVENT,e.Events.DELETE,e.Events.Delete),e.registry.register(e.registry.Type.EVENT,e.Events.CHANGE,e.Events.BlockChange),e.registry.register(e.registry.Type.EVENT,e.Events.MOVE,e.Events.Move),e.Events.FinishedLoading=function(t){this.isBlank=void 0===t,this.workspaceId=t?t.id:"",this.group=e.Events.getGroup(),this.recordUndo=!1},e.utils.object.inherits(e.Events.FinishedLoading,e.Events.Abstract),e.Events.FinishedLoading.prototype.type=e.Events.FINISHED_LOADING,e.Events.FinishedLoading.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),this.workspaceId&&(t.workspaceId=this.workspaceId),t},e.Events.FinishedLoading.prototype.fromJson=function(t){this.isBlank=!1,this.workspaceId=t.workspaceId,this.group=t.group},e.registry.register(e.registry.Type.EVENT,e.Events.FINISHED_LOADING,e.Events.FinishedLoading),e.Events.UiBase=function(t){e.Events.UiBase.superClass_.constructor.call(this),this.isBlank=void 0===t,this.workspaceId=t||"",this.recordUndo=!1},e.utils.object.inherits(e.Events.UiBase,e.Events.Abstract),e.Events.UiBase.prototype.isUiEvent=!0,e.Events.Ui=function(t,n,o,r){e.Events.Ui.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.element=void 0===n?"":n,this.oldValue=void 0===o?"":o,this.newValue=void 0===r?"":r},e.utils.object.inherits(e.Events.Ui,e.Events.UiBase),e.Events.Ui.prototype.type=e.Events.UI,e.Events.Ui.prototype.toJson=function(){var t=e.Events.Ui.superClass_.toJson.call(this);return t.element=this.element,void 0!==this.newValue&&(t.newValue=this.newValue),this.blockId&&(t.blockId=this.blockId),t},e.Events.Ui.prototype.fromJson=function(t){e.Events.Ui.superClass_.fromJson.call(this,t),this.element=t.element,this.newValue=t.newValue,this.blockId=t.blockId},e.registry.register(e.registry.Type.EVENT,e.Events.UI,e.Events.Ui),e.Events.VarBase=function(t){e.Events.VarBase.superClass_.constructor.call(this),this.varId=(this.isBlank=void 0===t)?"":t.getId(),this.workspaceId=this.isBlank?"":t.workspace.id},e.utils.object.inherits(e.Events.VarBase,e.Events.Abstract),e.Events.VarBase.prototype.toJson=function(){var t=e.Events.VarBase.superClass_.toJson.call(this);return t.varId=this.varId,t},e.Events.VarBase.prototype.fromJson=function(t){e.Events.VarBase.superClass_.toJson.call(this),this.varId=t.varId},e.Events.VarCreate=function(t){e.Events.VarCreate.superClass_.constructor.call(this,t),t&&(this.varType=t.type,this.varName=t.name)},e.utils.object.inherits(e.Events.VarCreate,e.Events.VarBase),e.Events.VarCreate.prototype.type=e.Events.VAR_CREATE,e.Events.VarCreate.prototype.toJson=function(){var t=e.Events.VarCreate.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},e.Events.VarCreate.prototype.fromJson=function(t){e.Events.VarCreate.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},e.Events.VarCreate.prototype.run=function(t){var n=this.getEventWorkspace_();t?n.createVariable(this.varName,this.varType,this.varId):n.deleteVariableById(this.varId)},e.Events.VarDelete=function(t){e.Events.VarDelete.superClass_.constructor.call(this,t),t&&(this.varType=t.type,this.varName=t.name)},e.utils.object.inherits(e.Events.VarDelete,e.Events.VarBase),e.Events.VarDelete.prototype.type=e.Events.VAR_DELETE,e.Events.VarDelete.prototype.toJson=function(){var t=e.Events.VarDelete.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},e.Events.VarDelete.prototype.fromJson=function(t){e.Events.VarDelete.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},e.Events.VarDelete.prototype.run=function(t){var n=this.getEventWorkspace_();t?n.deleteVariableById(this.varId):n.createVariable(this.varName,this.varType,this.varId)},e.Events.VarRename=function(t,n){e.Events.VarRename.superClass_.constructor.call(this,t),t&&(this.oldName=t.name,this.newName=void 0===n?"":n)},e.utils.object.inherits(e.Events.VarRename,e.Events.VarBase),e.Events.VarRename.prototype.type=e.Events.VAR_RENAME,e.Events.VarRename.prototype.toJson=function(){var t=e.Events.VarRename.superClass_.toJson.call(this);return t.oldName=this.oldName,t.newName=this.newName,t},e.Events.VarRename.prototype.fromJson=function(t){e.Events.VarRename.superClass_.fromJson.call(this,t),this.oldName=t.oldName,this.newName=t.newName},e.Events.VarRename.prototype.run=function(t){this.getEventWorkspace_().renameVariableById(this.varId,t?this.newName:this.oldName)},e.registry.register(e.registry.Type.EVENT,e.Events.VAR_CREATE,e.Events.VarCreate),e.registry.register(e.registry.Type.EVENT,e.Events.VAR_DELETE,e.Events.VarDelete),e.registry.register(e.registry.Type.EVENT,e.Events.VAR_RENAME,e.Events.VarRename),e.BlockDragSurfaceSvg=function(t){this.container_=t,this.createDom()},e.BlockDragSurfaceSvg.prototype.SVG_=null,e.BlockDragSurfaceSvg.prototype.dragGroup_=null,e.BlockDragSurfaceSvg.prototype.container_=null,e.BlockDragSurfaceSvg.prototype.scale_=1,e.BlockDragSurfaceSvg.prototype.surfaceXY_=null,e.BlockDragSurfaceSvg.prototype.childSurfaceXY_=new e.utils.Coordinate(0,0),e.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},this.SVG_))},e.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(t){if(this.dragGroup_.childNodes.length)throw Error("Already dragging a block.");this.dragGroup_.appendChild(t),this.SVG_.style.display="block",this.surfaceXY_=new e.utils.Coordinate(0,0)},e.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(t,n,o){this.scale_=o,t=t.toFixed(0),n=n.toFixed(0),this.childSurfaceXY_.x=parseInt(t,10),this.childSurfaceXY_.y=parseInt(n,10),this.dragGroup_.setAttribute("transform","translate("+t+","+n+") scale("+o+")")},e.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var t=this.surfaceXY_.x,n=this.surfaceXY_.y;t=t.toFixed(0),n=n.toFixed(0),this.SVG_.style.display="block",e.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+n+"px, 0px)")},e.BlockDragSurfaceSvg.prototype.translateBy=function(t,n){this.surfaceXY_=new e.utils.Coordinate(this.surfaceXY_.x+t,this.surfaceXY_.y+n),this.translateSurfaceInternal_()},e.BlockDragSurfaceSvg.prototype.translateSurface=function(t,n){this.surfaceXY_=new e.utils.Coordinate(t*this.scale_,n*this.scale_),this.translateSurfaceInternal_()},e.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var t=e.utils.getRelativeXY(this.SVG_);return new e.utils.Coordinate(t.x/this.scale_,t.y/this.scale_)},e.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},e.BlockDragSurfaceSvg.prototype.getSvgRoot=function(){return this.SVG_},e.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},e.BlockDragSurfaceSvg.prototype.getWsTranslation=function(){return this.childSurfaceXY_.clone()},e.BlockDragSurfaceSvg.prototype.clearAndHide=function(t){if(t?t.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",this.dragGroup_.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY_=null},e.Css={},e.Css.injected_=!1,e.Css.register=function(t){if(e.Css.injected_)throw Error("CSS already injected");Array.prototype.push.apply(e.Css.CONTENT,t),t.length=0},e.Css.inject=function(t,n){if(!e.Css.injected_){e.Css.injected_=!0;var o=e.Css.CONTENT.join("\n");e.Css.CONTENT.length=0,t&&(t=n.replace(/[\\/]$/,""),o=o.replace(/<<<PATH>>>/g,t),(t=document.createElement("style")).id="blockly-common-style",o=document.createTextNode(o),t.appendChild(o),document.head.insertBefore(t,document.head.firstChild))}},e.Css.CONTENT=[".blocklySvg {","background-color: #fff;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none;","}",".blocklyNonSelectable {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyBlockCanvas.blocklyCanvasTransitioning,",".blocklyBubbleCanvas.blocklyCanvasTransitioning {","transition: transform .5s;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;","font: 9pt sans-serif;","opacity: .9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: absolute;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-color: #dadce0;","background-color: #fff;","border-radius: 2px;","padding: 4px;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","overflow-x: hidden;","position: relative;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyArrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".blocklyArrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #515A5A;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPathLight {","fill: none;","stroke-linecap: round;","stroke-width: 1;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: .8;","stroke-opacity: .8;","}",".blocklyDragging>.blocklyPathDark {","display: none;","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyDisabled>.blocklyPathLight,",".blocklyDisabled>.blocklyPathDark {","display: none;","}",".blocklyInsertionMarker>.blocklyPath,",".blocklyInsertionMarker>.blocklyPathLight,",".blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: .2;","stroke: none;","}",".blocklyMultilineText {","font-family: monospace;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyText text {","cursor: default;","}",".blocklySvg text,",".blocklyBlockDragSurface text {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyHtmlInput {","border: none;","border-radius: 4px;","height: 100%;","margin: 0;","outline: none;","padding: 0;","width: 100%;","text-align: center;","display: block;","box-sizing: border-box;","}",".blocklyHtmlInput::-ms-clear {","display: none;","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: #ddd;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal,",".blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: #ccc;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyVerticalMarker {","stroke-width: 3px;","fill: rgba(255,255,255,.5);","pointer-events: none;","}",".blocklyComputeCanvas {","position: absolute;","width: 0;","height: 0;","}",".blocklyNoPointerEvents {","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","border-radius: 2px;","padding: 0 !important;","}",".blocklyDropdownMenu .blocklyMenuItem {","padding-left: 28px;","}",".blocklyDropdownMenu .blocklyMenuItemRtl {","padding-left: 5px;","padding-right: 28px;","}",".blocklyWidgetDiv .blocklyMenu {","background: #fff;","border: 1px solid transparent;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","font: normal 13px Arial, sans-serif;","margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","max-height: 100%;","z-index: 20000;","}",".blocklyWidgetDiv .blocklyMenu.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv .blocklyMenu {","background: inherit;","border: inherit;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","position: relative;","z-index: 20000;","}",".blocklyMenuItem {","border: none;","color: #000;","cursor: pointer;","list-style: none;","margin: 0;","min-width: 7em;","padding: 6px 15px;","white-space: nowrap;","}",".blocklyMenuItemDisabled {","color: #ccc;","cursor: inherit;","}",".blocklyMenuItemHighlight {","background-color: rgba(0,0,0,.1);","}",".blocklyMenuItemCheckbox {","height: 16px;","position: absolute;","width: 16px;","}",".blocklyMenuItemSelected .blocklyMenuItemCheckbox {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;","float: left;","margin-left: -24px;","position: static;","}",".blocklyMenuItemRtl .blocklyMenuItemCheckbox {","float: right;","margin-right: -24px;","}"],e.Grid=function(t,n){this.gridPattern_=t,this.spacing_=n.spacing,this.length_=n.length,this.line2_=(this.line1_=t.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=n.snap},e.Grid.prototype.scale_=1,e.Grid.prototype.dispose=function(){this.gridPattern_=null},e.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},e.Grid.prototype.getSpacing=function(){return this.spacing_},e.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},e.Grid.prototype.update=function(t){this.scale_=t;var n=this.spacing_*t||100;this.gridPattern_.setAttribute("width",n),this.gridPattern_.setAttribute("height",n);var o=(n=Math.floor(this.spacing_/2)+.5)-this.length_/2,r=n+this.length_/2;this.setLineAttributes_(this.line1_,t,o*=t,r*=t,n*=t,n),this.setLineAttributes_(this.line2_,t,n,n,o,r)},e.Grid.prototype.setLineAttributes_=function(t,n,o,r,a,h){t&&(t.setAttribute("stroke-width",n),t.setAttribute("x1",o),t.setAttribute("y1",a),t.setAttribute("x2",r),t.setAttribute("y2",h))},e.Grid.prototype.moveTo=function(t,n){this.gridPattern_.setAttribute("x",t),this.gridPattern_.setAttribute("y",n),(e.utils.userAgent.IE||e.utils.userAgent.EDGE)&&this.update(this.scale_)},e.Grid.createDom=function(t,n,o){return t=e.utils.dom.createSvgElement(e.utils.Svg.PATTERN,{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},o),0<n.length&&0<n.spacing?(e.utils.dom.createSvgElement(e.utils.Svg.LINE,{stroke:n.colour},t),1<n.length&&e.utils.dom.createSvgElement(e.utils.Svg.LINE,{stroke:n.colour},t)):e.utils.dom.createSvgElement(e.utils.Svg.LINE,{},t),t},e.Theme=function(t,n,o,r){this.name=t,this.blockStyles=n||Object.create(null),this.categoryStyles=o||Object.create(null),this.componentStyles=r||Object.create(null),this.fontStyle=Object.create(null),this.startHats=null,e.registry.register(e.registry.Type.THEME,t,this)},e.Theme.prototype.getClassName=function(){return this.name+"-theme"},e.Theme.prototype.setBlockStyle=function(t,n){this.blockStyles[t]=n},e.Theme.prototype.setCategoryStyle=function(t,n){this.categoryStyles[t]=n},e.Theme.prototype.getComponentStyle=function(t){return(t=this.componentStyles[t])&&"string"==typeof t&&this.getComponentStyle(t)?this.getComponentStyle(t):t?String(t):null},e.Theme.prototype.setComponentStyle=function(t,n){this.componentStyles[t]=n},e.Theme.prototype.setFontStyle=function(t){this.fontStyle=t},e.Theme.prototype.setStartHats=function(t){this.startHats=t},e.Theme.defineTheme=function(t,n){var o=new e.Theme(t),r=n.base;return r&&("string"==typeof r&&(r=e.registry.getObject(e.registry.Type.THEME,r)),r instanceof e.Theme&&(e.utils.object.deepMerge(o,r),o.name=t)),e.utils.object.deepMerge(o.blockStyles,n.blockStyles),e.utils.object.deepMerge(o.categoryStyles,n.categoryStyles),e.utils.object.deepMerge(o.componentStyles,n.componentStyles),e.utils.object.deepMerge(o.fontStyle,n.fontStyle),null!=n.startHats&&(o.startHats=n.startHats),o},e.Themes={},e.Themes.Classic={},e.Themes.Classic.defaultBlockStyles={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},e.Themes.Classic.categoryStyles={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},e.Themes.Classic=new e.Theme("classic",e.Themes.Classic.defaultBlockStyles,e.Themes.Classic.categoryStyles),e.utils.IdGenerator={},e.utils.IdGenerator.nextId_=0,e.utils.IdGenerator.getNextUniqueId=function(){return"blockly-"+(e.utils.IdGenerator.nextId_++).toString(36)},e.utils.Metrics=function(){},e.utils.toolbox={},e.utils.toolbox.CATEGORY_TOOLBOX_KIND="categoryToolbox",e.utils.toolbox.FLYOUT_TOOLBOX_KIND="flyoutToolbox",e.utils.toolbox.Position={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3},e.utils.toolbox.convertToolboxDefToJson=function(t){return t?((t instanceof Element||"string"==typeof t)&&(t=e.utils.toolbox.parseToolboxTree(t),t=e.utils.toolbox.convertToToolboxJson_(t)),e.utils.toolbox.validateToolbox_(t),t):null},e.utils.toolbox.validateToolbox_=function(t){var n=t.kind;if(t=t.contents,n&&n!=e.utils.toolbox.FLYOUT_TOOLBOX_KIND&&n!=e.utils.toolbox.CATEGORY_TOOLBOX_KIND)throw Error("Invalid toolbox kind "+n+". Please supply either "+e.utils.toolbox.FLYOUT_TOOLBOX_KIND+" or "+e.utils.toolbox.CATEGORY_TOOLBOX_KIND);if(!t)throw Error("Toolbox must have a contents attribute.")},e.utils.toolbox.convertFlyoutDefToJsonArray=function(t){return t?t.contents?t.contents:Array.isArray(t)&&0<t.length&&!t[0].nodeType?t:e.utils.toolbox.xmlToJsonArray_(t):[]},e.utils.toolbox.hasCategories=function(t){if(!t)return!1;var n=t.kind;return n?n==e.utils.toolbox.CATEGORY_TOOLBOX_KIND:!!t.contents.filter(function(o){return"CATEGORY"==o.kind.toUpperCase()}).length},e.utils.toolbox.isCategoryCollapsible=function(t){return!(!t||!t.contents||!t.contents.filter(function(n){return"CATEGORY"==n.kind.toUpperCase()}).length)},e.utils.toolbox.convertToToolboxJson_=function(t){var n={contents:e.utils.toolbox.xmlToJsonArray_(t)};return t instanceof Node&&e.utils.toolbox.addAttributes_(t,n),n},e.utils.toolbox.xmlToJsonArray_=function(t){var r,n=[],o=t.childNodes;for(o||(o=t),t=0;r=o[t];t++)if(r.tagName){var a={},h=r.tagName.toUpperCase();a.kind=h,"BLOCK"==h?a.blockxml=r:r.childNodes&&0<r.childNodes.length&&(a.contents=e.utils.toolbox.xmlToJsonArray_(r)),e.utils.toolbox.addAttributes_(r,a),n.push(a)}return n},e.utils.toolbox.addAttributes_=function(t,n){for(var o=0;o<t.attributes.length;o++){var r=t.attributes[o];-1<r.nodeName.indexOf("css-")?(n.cssconfig=n.cssconfig||{},n.cssconfig[r.nodeName.replace("css-","")]=r.value):n[r.nodeName]=r.value}},e.utils.toolbox.parseToolboxTree=function(t){if(t){if("string"!=typeof t&&(e.utils.userAgent.IE&&t.outerHTML?t=t.outerHTML:t instanceof Element||(t=null)),"string"==typeof t&&"xml"!=(t=e.Xml.textToDom(t)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else t=null;return t},e.Options=function(t){var n=!!t.readOnly;if(n)var o=null,r=!1,a=!1,h=!1,R=!1,L=!1,W=!1;else{o=e.utils.toolbox.convertToolboxDefToJson(t.toolbox),r=e.utils.toolbox.hasCategories(o),void 0===(a=t.trashcan)&&(a=r);var nt=t.maxTrashcanContents;a?void 0===nt&&(nt=32):nt=0,void 0===(h=t.collapse)&&(h=r),void 0===(R=t.comments)&&(R=r),void 0===(L=t.disable)&&(L=r),void 0===(W=t.sounds)&&(W=!0)}var et=!!t.rtl,Et=t.horizontalLayout;void 0===Et&&(Et=!1);var It=t.toolboxPosition;It="end"!==It,It=Et?It?e.utils.toolbox.Position.TOP:e.utils.toolbox.Position.BOTTOM:It==et?e.utils.toolbox.Position.RIGHT:e.utils.toolbox.Position.LEFT;var gt=t.css;void 0===gt&&(gt=!0);var wt="https://blockly-demo.appspot.com/static/media/";t.media?wt=t.media:t.path&&(wt=t.path+"media/");var Ut=void 0===t.oneBasedIndex||!!t.oneBasedIndex,Jt=t.renderer||"geras",Ct=t.plugins||{};this.RTL=et,this.oneBasedIndex=Ut,this.collapse=h,this.comments=R,this.disable=L,this.readOnly=n,this.maxBlocks=t.maxBlocks||1/0,this.maxInstances=t.maxInstances,this.pathToMedia=wt,this.hasCategories=r,this.moveOptions=e.Options.parseMoveOptions_(t,r),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=a,this.maxTrashcanContents=nt,this.hasSounds=W,this.hasCss=gt,this.horizontalLayout=Et,this.languageTree=o,this.gridOptions=e.Options.parseGridOptions_(t),this.zoomOptions=e.Options.parseZoomOptions_(t),this.toolboxPosition=It,this.theme=e.Options.parseThemeOptions_(t),this.renderer=Jt,this.rendererOverrides=t.rendererOverrides,this.gridPattern=null,this.parentWorkspace=t.parentWorkspace,this.plugins=Ct},e.BlocklyOptions=function(){},e.Options.parseMoveOptions_=function(t,n){var o=t.move||{},r={};return void 0===o.scrollbars&&void 0===t.scrollbars?r.scrollbars=n:"object"==typeof o.scrollbars?(r.scrollbars={},r.scrollbars.horizontal=!!o.scrollbars.horizontal,r.scrollbars.vertical=!!o.scrollbars.vertical,r.scrollbars.horizontal&&r.scrollbars.vertical?r.scrollbars=!0:r.scrollbars.horizontal||r.scrollbars.vertical||(r.scrollbars=!1)):r.scrollbars=!!o.scrollbars||!!t.scrollbars,r.wheel=r.scrollbars&&void 0!==o.wheel?!!o.wheel:"object"==typeof r.scrollbars,r.drag=!(!r.scrollbars||void 0!==o.drag&&!o.drag),r},e.Options.parseZoomOptions_=function(t){var n={};return n.controls=void 0!==(t=t.zoom||{}).controls&&!!t.controls,n.wheel=void 0!==t.wheel&&!!t.wheel,n.startScale=void 0===t.startScale?1:Number(t.startScale),n.maxScale=void 0===t.maxScale?3:Number(t.maxScale),n.minScale=void 0===t.minScale?.3:Number(t.minScale),n.scaleSpeed=void 0===t.scaleSpeed?1.2:Number(t.scaleSpeed),n.pinch=void 0===t.pinch?n.wheel||n.controls:!!t.pinch,n},e.Options.parseGridOptions_=function(t){t=t.grid||{};var n={};return n.spacing=Number(t.spacing)||0,n.colour=t.colour||"#888",n.length=void 0===t.length?1:Number(t.length),n.snap=0<n.spacing&&!!t.snap,n},e.Options.parseThemeOptions_=function(t){return"string"==typeof(t=t.theme||e.Themes.Classic)?e.registry.getObject(e.registry.Type.THEME,t):t instanceof e.Theme?t:e.Theme.defineTheme(t.name||"builtin"+e.utils.IdGenerator.getNextUniqueId(),t)},e.Options.parseToolboxTree=function(t){return e.utils.deprecation.warn("Blockly.Options.parseToolboxTree","September 2020","September 2021","Blockly.utils.toolbox.parseToolboxTree"),e.utils.toolbox.parseToolboxTree(t)},e.ScrollbarPair=function(t,n,o,r,a){this.workspace_=t,o=void 0===o||o;var h=(n=void 0===n||n)&&o;n&&(this.hScroll=new e.Scrollbar(t,!0,h,r,a)),o&&(this.vScroll=new e.Scrollbar(t,!1,h,r,a)),h&&(this.corner_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{height:e.Scrollbar.scrollbarThickness,width:e.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),e.utils.dom.insertAfter(this.corner_,t.getBubbleCanvas())),this.oldHostMetrics_=null},e.ScrollbarPair.prototype.dispose=function(){e.utils.dom.removeNode(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)},e.ScrollbarPair.prototype.resize=function(){var t=this.workspace_.getMetrics();if(t){var n=!1,o=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth==t.scrollWidth&&this.oldHostMetrics_.viewLeft==t.viewLeft&&this.oldHostMetrics_.scrollLeft==t.scrollLeft||(n=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight==t.scrollHeight&&this.oldHostMetrics_.viewTop==t.viewTop&&this.oldHostMetrics_.scrollTop==t.scrollTop||(o=!0)):o=n=!0,n||o){try{e.Events.disable(),this.hScroll&&n&&this.hScroll.resize(t),this.vScroll&&o&&this.vScroll.resize(t)}finally{e.Events.enable()}this.workspace_.maybeFireViewportChangeEvent()}this.hScroll&&this.vScroll&&(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position.y)),this.oldHostMetrics_=t}},e.ScrollbarPair.prototype.canScrollHorizontally=function(){return!!this.hScroll},e.ScrollbarPair.prototype.canScrollVertically=function(){return!!this.vScroll},e.ScrollbarPair.prototype.setOrigin=function(t,n){this.hScroll&&this.hScroll.setOrigin(t,n),this.vScroll&&this.vScroll.setOrigin(t,n)},e.ScrollbarPair.prototype.set=function(t,n,o){this.hScroll&&this.hScroll.set(t,!1),this.vScroll&&this.vScroll.set(n,!1),(o||void 0===o)&&(t={},this.hScroll&&(t.x=this.hScroll.getRatio_()),this.vScroll&&(t.y=this.vScroll.getRatio_()),this.workspace_.setMetrics(t))},e.ScrollbarPair.prototype.setX=function(t){this.hScroll&&this.hScroll.set(t,!0)},e.ScrollbarPair.prototype.setY=function(t){this.vScroll&&this.vScroll.set(t,!0)},e.ScrollbarPair.prototype.setContainerVisible=function(t){this.hScroll&&this.hScroll.setContainerVisible(t),this.vScroll&&this.vScroll.setContainerVisible(t)},e.ScrollbarPair.prototype.isVisible=function(){var t=!1;return this.hScroll&&(t=this.hScroll.isVisible()),this.vScroll&&(t=t||this.vScroll.isVisible()),t},e.ScrollbarPair.prototype.resizeContent=function(t){this.hScroll&&this.hScroll.resizeContentHorizontal(t),this.vScroll&&this.vScroll.resizeContentVertical(t)},e.ScrollbarPair.prototype.resizeView=function(t){this.hScroll&&this.hScroll.resizeViewHorizontal(t),this.vScroll&&this.vScroll.resizeViewVertical(t)},e.Scrollbar=function(t,n,o,r,a){this.workspace_=t,this.pair_=o||!1,this.horizontal_=n,this.margin_=void 0!==a?a:e.Scrollbar.DEFAULT_SCROLLBAR_MARGIN,this.ratio=this.oldHostMetrics_=null,this.createDom_(r),this.position=new e.utils.Coordinate(0,0),t=e.Scrollbar.scrollbarThickness,n?(this.svgBackground_.setAttribute("height",t),this.outerSvg_.setAttribute("height",t),this.svgHandle_.setAttribute("height",t-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",t),this.outerSvg_.setAttribute("width",t),this.svgHandle_.setAttribute("width",t-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=e.browserEvents.conditionalBind(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=e.browserEvents.conditionalBind(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)},e.Scrollbar.prototype.origin_=new e.utils.Coordinate(0,0),e.Scrollbar.prototype.startDragMouse_=0,e.Scrollbar.prototype.scrollbarLength_=0,e.Scrollbar.prototype.handleLength_=0,e.Scrollbar.prototype.handlePosition_=0,e.Scrollbar.prototype.isVisible_=!0,e.Scrollbar.prototype.containerVisible_=!0,e.Scrollbar.scrollbarThickness=15,e.Touch.TOUCH_ENABLED&&(e.Scrollbar.scrollbarThickness=25),e.Scrollbar.DEFAULT_SCROLLBAR_MARGIN=.5,e.Scrollbar.metricsAreEquivalent_=function(t,n){return t.viewWidth==n.viewWidth&&t.viewHeight==n.viewHeight&&t.viewLeft==n.viewLeft&&t.viewTop==n.viewTop&&t.absoluteTop==n.absoluteTop&&t.absoluteLeft==n.absoluteLeft&&t.scrollWidth==n.scrollWidth&&t.scrollHeight==n.scrollHeight&&t.scrollLeft==n.scrollLeft&&t.scrollTop==n.scrollTop},e.Scrollbar.prototype.dispose=function(){this.cleanUp_(),e.browserEvents.unbind(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,e.browserEvents.unbind(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,e.utils.dom.removeNode(this.outerSvg_),this.svgBackground_=this.svgGroup_=this.outerSvg_=null,this.svgHandle_&&(this.workspace_.getThemeManager().unsubscribe(this.svgHandle_),this.svgHandle_=null),this.workspace_=null},e.Scrollbar.prototype.constrainHandleLength_=function(t){return 0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength_)},e.Scrollbar.prototype.setHandleLength_=function(t){this.handleLength_=t,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},e.Scrollbar.prototype.constrainHandlePosition_=function(t){return 0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength_-this.handleLength_)},e.Scrollbar.prototype.setHandlePosition=function(t){this.handlePosition_=t,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},e.Scrollbar.prototype.setScrollbarLength_=function(t){this.scrollbarLength_=t,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollbarLength_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollbarLength_)},e.Scrollbar.prototype.setPosition=function(t,n){this.position.x=t,this.position.y=n,e.utils.dom.setCssTransform(this.outerSvg_,"translate("+(this.position.x+this.origin_.x)+"px,"+(this.position.y+this.origin_.y)+"px)")},e.Scrollbar.prototype.resize=function(t){!t&&!(t=this.workspace_.getMetrics())||this.oldHostMetrics_&&e.Scrollbar.metricsAreEquivalent_(t,this.oldHostMetrics_)||(this.horizontal_?this.resizeHorizontal_(t):this.resizeVertical_(t),this.oldHostMetrics_=t,this.updateMetrics_())},e.Scrollbar.prototype.requiresViewResize_=function(t){return!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==t.viewWidth||this.oldHostMetrics_.viewHeight!==t.viewHeight||this.oldHostMetrics_.absoluteLeft!==t.absoluteLeft||this.oldHostMetrics_.absoluteTop!==t.absoluteTop},e.Scrollbar.prototype.resizeHorizontal_=function(t){this.requiresViewResize_(t)?this.resizeViewHorizontal(t):this.resizeContentHorizontal(t)},e.Scrollbar.prototype.resizeViewHorizontal=function(t){var n=t.viewWidth-2*this.margin_;this.pair_&&(n-=e.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,n)),n=t.absoluteLeft+this.margin_,this.pair_&&this.workspace_.RTL&&(n+=e.Scrollbar.scrollbarThickness),this.setPosition(n,t.absoluteTop+t.viewHeight-e.Scrollbar.scrollbarThickness-this.margin_),this.resizeContentHorizontal(t)},e.Scrollbar.prototype.resizeContentHorizontal=function(t){if(t.viewWidth>=t.scrollWidth)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var n=this.scrollbarLength_*t.viewWidth/t.scrollWidth;n=this.constrainHandleLength_(n),this.setHandleLength_(n);var o=this.scrollbarLength_-this.handleLength_;t=this.constrainHandlePosition_(t=(t.viewLeft-t.scrollLeft)/(n=t.scrollWidth-t.viewWidth)*o),this.setHandlePosition(t),this.ratio=o/n}},e.Scrollbar.prototype.resizeVertical_=function(t){this.requiresViewResize_(t)?this.resizeViewVertical(t):this.resizeContentVertical(t)},e.Scrollbar.prototype.resizeViewVertical=function(t){var n=t.viewHeight-2*this.margin_;this.pair_&&(n-=e.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,n)),this.setPosition(this.workspace_.RTL?t.absoluteLeft+this.margin_:t.absoluteLeft+t.viewWidth-e.Scrollbar.scrollbarThickness-this.margin_,t.absoluteTop+this.margin_),this.resizeContentVertical(t)},e.Scrollbar.prototype.resizeContentVertical=function(t){if(t.viewHeight>=t.scrollHeight)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var n=this.scrollbarLength_*t.viewHeight/t.scrollHeight;n=this.constrainHandleLength_(n),this.setHandleLength_(n);var o=this.scrollbarLength_-this.handleLength_;t=this.constrainHandlePosition_(t=(t.viewTop-t.scrollTop)/(n=t.scrollHeight-t.viewHeight)*o),this.setHandlePosition(t),this.ratio=o/n}},e.Scrollbar.prototype.createDom_=function(t){var n="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");t&&(n+=" "+t),this.outerSvg_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{class:n},null),this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},this.outerSvg_),this.svgBackground_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyScrollbarBackground"},this.svgGroup_),t=Math.floor((e.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyScrollbarHandle",rx:t,ry:t},this.svgGroup_),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarOpacity","fill-opacity"),e.utils.dom.insertAfter(this.outerSvg_,this.workspace_.getParentSvg())},e.Scrollbar.prototype.isVisible=function(){return this.isVisible_},e.Scrollbar.prototype.setContainerVisible=function(t){var n=t!=this.containerVisible_;this.containerVisible_=t,n&&this.updateDisplay_()},e.Scrollbar.prototype.setVisible=function(t){var n=t!=this.isVisible();if(this.pair_)throw Error("Unable to toggle visibility of paired scrollbars.");this.isVisible_=t,n&&this.updateDisplay_()},e.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},e.Scrollbar.prototype.onMouseDownBar_=function(t){if(this.workspace_.markFocused(),e.Touch.clearTouchIdentifier(),this.cleanUp_(),e.utils.isRightButton(t))t.stopPropagation();else{var n=e.utils.mouseToSvg(t,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());n=this.horizontal_?n.x:n.y;var o=e.utils.getInjectionDivXY_(this.svgHandle_),r=this.handlePosition_,a=.95*this.handleLength_;n<=(o=this.horizontal_?o.x:o.y)?r-=a:n>=o+this.handleLength_&&(r+=a),this.setHandlePosition(this.constrainHandlePosition_(r)),this.updateMetrics_(),t.stopPropagation(),t.preventDefault()}},e.Scrollbar.prototype.onMouseDownHandle_=function(t){this.workspace_.markFocused(),this.cleanUp_(),e.utils.isRightButton(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse_=this.horizontal_?t.clientX:t.clientY,e.Scrollbar.onMouseUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",this,this.onMouseUpHandle_),e.Scrollbar.onMouseMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",this,this.onMouseMoveHandle_),t.stopPropagation(),t.preventDefault())},e.Scrollbar.prototype.onMouseMoveHandle_=function(t){this.setHandlePosition(this.constrainHandlePosition_(this.startDragHandle+((this.horizontal_?t.clientX:t.clientY)-this.startDragMouse_))),this.updateMetrics_()},e.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),e.Touch.clearTouchIdentifier(),this.cleanUp_()},e.Scrollbar.prototype.cleanUp_=function(){e.hideChaff(!0),e.Scrollbar.onMouseUpWrapper_&&(e.browserEvents.unbind(e.Scrollbar.onMouseUpWrapper_),e.Scrollbar.onMouseUpWrapper_=null),e.Scrollbar.onMouseMoveWrapper_&&(e.browserEvents.unbind(e.Scrollbar.onMouseMoveWrapper_),e.Scrollbar.onMouseMoveWrapper_=null)},e.Scrollbar.prototype.getRatio_=function(){var t=this.handlePosition_/(this.scrollbarLength_-this.handleLength_);return isNaN(t)&&(t=0),t},e.Scrollbar.prototype.updateMetrics_=function(){var t=this.getRatio_(),n={};this.horizontal_?n.x=t:n.y=t,this.workspace_.setMetrics(n)},e.Scrollbar.prototype.set=function(t,n){this.setHandlePosition(this.constrainHandlePosition_(t*this.ratio)),(n||void 0===n)&&this.updateMetrics_()},e.Scrollbar.prototype.setOrigin=function(t,n){this.origin_=new e.utils.Coordinate(t,n)},e.Tooltip={},e.Tooltip.visible=!1,e.Tooltip.blocked_=!1,e.Tooltip.LIMIT=50,e.Tooltip.mouseOutPid_=0,e.Tooltip.showPid_=0,e.Tooltip.lastX_=0,e.Tooltip.lastY_=0,e.Tooltip.element_=null,e.Tooltip.poisonedElement_=null,e.Tooltip.OFFSET_X=0,e.Tooltip.OFFSET_Y=10,e.Tooltip.RADIUS_OK=10,e.Tooltip.HOVER_MS=750,e.Tooltip.MARGINS=5,e.Tooltip.DIV=null,e.Tooltip.getTooltipOfObject=function(t){if(t=e.Tooltip.getTargetObject_(t)){for(t=t.tooltip;"function"==typeof t;)t=t();if("string"!=typeof t)throw Error("Tooltip function must return a string.");return t}return""},e.Tooltip.getTargetObject_=function(t){for(;t&&t.tooltip;){if("string"==typeof t.tooltip||"function"==typeof t.tooltip)return t;t=t.tooltip}return null},e.Tooltip.createDom=function(){e.Tooltip.DIV||(e.Tooltip.DIV=document.createElement("div"),e.Tooltip.DIV.className="blocklyTooltipDiv",(e.parentContainer||document.body).appendChild(e.Tooltip.DIV))},e.Tooltip.bindMouseEvents=function(t){t.mouseOverWrapper_=e.browserEvents.bind(t,"mouseover",null,e.Tooltip.onMouseOver_),t.mouseOutWrapper_=e.browserEvents.bind(t,"mouseout",null,e.Tooltip.onMouseOut_),t.addEventListener("mousemove",e.Tooltip.onMouseMove_,!1)},e.Tooltip.unbindMouseEvents=function(t){t&&(e.browserEvents.unbind(t.mouseOverWrapper_),e.browserEvents.unbind(t.mouseOutWrapper_),t.removeEventListener("mousemove",e.Tooltip.onMouseMove_))},e.Tooltip.onMouseOver_=function(t){e.Tooltip.blocked_||(t=e.Tooltip.getTargetObject_(t.currentTarget),e.Tooltip.element_!=t&&(e.Tooltip.hide(),e.Tooltip.poisonedElement_=null,e.Tooltip.element_=t),clearTimeout(e.Tooltip.mouseOutPid_))},e.Tooltip.onMouseOut_=function(t){e.Tooltip.blocked_||(e.Tooltip.mouseOutPid_=setTimeout(function(){e.Tooltip.element_=null,e.Tooltip.poisonedElement_=null,e.Tooltip.hide()},1),clearTimeout(e.Tooltip.showPid_))},e.Tooltip.onMouseMove_=function(t){if(e.Tooltip.element_&&e.Tooltip.element_.tooltip&&!e.Tooltip.blocked_)if(e.Tooltip.visible){var n=e.Tooltip.lastX_-t.pageX;t=e.Tooltip.lastY_-t.pageY,Math.sqrt(n*n+t*t)>e.Tooltip.RADIUS_OK&&e.Tooltip.hide()}else e.Tooltip.poisonedElement_!=e.Tooltip.element_&&(clearTimeout(e.Tooltip.showPid_),e.Tooltip.lastX_=t.pageX,e.Tooltip.lastY_=t.pageY,e.Tooltip.showPid_=setTimeout(e.Tooltip.show_,e.Tooltip.HOVER_MS))},e.Tooltip.dispose=function(){e.Tooltip.element_=null,e.Tooltip.poisonedElement_=null,e.Tooltip.hide()},e.Tooltip.hide=function(){e.Tooltip.visible&&(e.Tooltip.visible=!1,e.Tooltip.DIV&&(e.Tooltip.DIV.style.display="none")),e.Tooltip.showPid_&&clearTimeout(e.Tooltip.showPid_)},e.Tooltip.block=function(){e.Tooltip.hide(),e.Tooltip.blocked_=!0},e.Tooltip.unblock=function(){e.Tooltip.blocked_=!1},e.Tooltip.show_=function(){if(!e.Tooltip.blocked_&&(e.Tooltip.poisonedElement_=e.Tooltip.element_,e.Tooltip.DIV)){e.Tooltip.DIV.textContent="";var t=e.Tooltip.getTooltipOfObject(e.Tooltip.element_);t=(t=e.utils.string.wrap(t,e.Tooltip.LIMIT)).split("\n");for(var n=0;n<t.length;n++){var o=document.createElement("div");o.appendChild(document.createTextNode(t[n])),e.Tooltip.DIV.appendChild(o)}t=e.Tooltip.element_.RTL,n=document.documentElement.clientWidth,o=document.documentElement.clientHeight,e.Tooltip.DIV.style.direction=t?"rtl":"ltr",e.Tooltip.DIV.style.display="block",e.Tooltip.visible=!0;var r=e.Tooltip.lastX_;r=t?r-(e.Tooltip.OFFSET_X+e.Tooltip.DIV.offsetWidth):r+e.Tooltip.OFFSET_X;var a=e.Tooltip.lastY_+e.Tooltip.OFFSET_Y;a+e.Tooltip.DIV.offsetHeight>o+window.scrollY&&(a-=e.Tooltip.DIV.offsetHeight+2*e.Tooltip.OFFSET_Y),t?r=Math.max(e.Tooltip.MARGINS-window.scrollX,r):r+e.Tooltip.DIV.offsetWidth>n+window.scrollX-2*e.Tooltip.MARGINS&&(r=n-e.Tooltip.DIV.offsetWidth-2*e.Tooltip.MARGINS),e.Tooltip.DIV.style.top=a+"px",e.Tooltip.DIV.style.left=r+"px"}},e.utils.aria={},e.utils.aria.ARIA_PREFIX_="aria-",e.utils.aria.ROLE_ATTRIBUTE_="role",e.utils.aria.Role={GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",LISTBOX:"listbox",MENU:"menu",MENUITEM:"menuitem",MENUITEMCHECKBOX:"menuitemcheckbox",OPTION:"option",PRESENTATION:"presentation",ROW:"row",TREE:"tree",TREEITEM:"treeitem"},e.utils.aria.State={ACTIVEDESCENDANT:"activedescendant",COLCOUNT:"colcount",DISABLED:"disabled",EXPANDED:"expanded",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",ORIENTATION:"orientation",POSINSET:"posinset",ROWCOUNT:"rowcount",SELECTED:"selected",SETSIZE:"setsize",VALUEMAX:"valuemax",VALUEMIN:"valuemin"},e.utils.aria.setRole=function(t,n){t.setAttribute(e.utils.aria.ROLE_ATTRIBUTE_,n)},e.utils.aria.setState=function(t,n,o){Array.isArray(o)&&(o=o.join(" ")),t.setAttribute(e.utils.aria.ARIA_PREFIX_+n,o)},e.IASTNodeLocation=function(){},e.IASTNodeLocationSvg=function(){},e.IASTNodeLocationWithBlock=function(){},e.IKeyboardAccessible=function(){},e.utils.deprecation={},e.utils.deprecation.warn=function(t,n,o,r){t=t+" was deprecated on "+n+" and will be deleted on "+o+".",r&&(t+="\nUse "+r+" instead."),console.warn(t)},e.Connection=function(t,n){this.sourceBlock_=t,this.type=n},e.Connection.CAN_CONNECT=0,e.Connection.REASON_SELF_CONNECTION=1,e.Connection.REASON_WRONG_TYPE=2,e.Connection.REASON_TARGET_NULL=3,e.Connection.REASON_CHECKS_FAILED=4,e.Connection.REASON_DIFFERENT_WORKSPACES=5,e.Connection.REASON_SHADOW_PARENT=6,e.Connection.REASON_DRAG_CHECKS_FAILED=7,e.Connection.prototype.targetConnection=null,e.Connection.prototype.disposed=!1,e.Connection.prototype.check_=null,e.Connection.prototype.shadowDom_=null,e.Connection.prototype.x=0,e.Connection.prototype.y=0,e.Connection.prototype.connect_=function(t){var L,n=e.connectionTypes.INPUT_VALUE,o=this.getSourceBlock(),r=t.getSourceBlock();if(t.isConnected()&&t.disconnect(),this.isConnected()){var a=this.getShadowDom(!0);this.shadowDom_=null;var h=this.targetBlock();if(h.isShadow())h.dispose(!1);else{this.disconnect();var R=h}this.shadowDom_=a}e.Events.isEnabled()&&(L=new(e.Events.get(e.Events.BLOCK_MOVE))(r)),e.Connection.connectReciprocally_(this,t),r.setParent(o),L&&(L.recordNew(),e.Events.fire(L)),R&&((r=e.Connection.getConnectionForOrphanedConnection(r,t=this.type===n?R.outputConnection:R.previousConnection))?t.connect(r):t.onFailedConnect(this))},e.Connection.prototype.dispose=function(){if(this.isConnected()){this.setShadowDom(null);var t=this.targetBlock();t&&t.unplug()}this.disposed=!0},e.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},e.Connection.prototype.isSuperior=function(){return this.type==e.connectionTypes.INPUT_VALUE||this.type==e.connectionTypes.NEXT_STATEMENT},e.Connection.prototype.isConnected=function(){return!!this.targetConnection},e.Connection.prototype.canConnectWithReason=function(t){return e.utils.deprecation.warn("Connection.prototype.canConnectWithReason","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnectWithReason(this,t,!1)},e.Connection.prototype.checkConnection=function(t){e.utils.deprecation.warn("Connection.prototype.checkConnection","July 2020","July 2021","the workspace's connection checker");var n=this.getConnectionChecker(),o=n.canConnectWithReason(this,t,!1);if(o!=e.Connection.CAN_CONNECT)throw Error(n.getErrorMessage(o,this,t))},e.Connection.prototype.getConnectionChecker=function(){return this.sourceBlock_.workspace.connectionChecker},e.Connection.prototype.isConnectionAllowed=function(t){return e.utils.deprecation.warn("Connection.prototype.isConnectionAllowed","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,t,!0)},e.Connection.prototype.onFailedConnect=function(t){},e.Connection.prototype.connect=function(t){if(this.targetConnection!=t&&this.getConnectionChecker().canConnect(this,t,!1)){var n=e.Events.getGroup();n||e.Events.setGroup(!0),this.isSuperior()?this.connect_(t):t.connect_(this),n||e.Events.setGroup(!1)}},e.Connection.connectReciprocally_=function(t,n){if(!t||!n)throw Error("Cannot connect null connections.");t.targetConnection=n,n.targetConnection=t},e.Connection.getSingleConnection_=function(t,n){for(var h,o=null,r=(n=n.outputConnection).getConnectionChecker(),a=0;h=t.inputList[a];a++)if((h=h.connection)&&r.canConnect(n,h,!1)){if(o)return null;o=h}return o},e.Connection.getConnectionForOrphanedOutput_=function(t,n){for(var o;o=e.Connection.getSingleConnection_(t,n);)if(!(t=o.targetBlock())||t.isShadow())return o;return null},e.Connection.getConnectionForOrphanedConnection=function(t,n){if(n.type===e.connectionTypes.OUTPUT_VALUE)return e.Connection.getConnectionForOrphanedOutput_(t,n.getSourceBlock());t=t.lastConnectionInStack(!0);var o=n.getConnectionChecker();return t&&o.canConnect(n,t,!1)?t:null},e.Connection.prototype.disconnect=function(){var t=this.targetConnection;if(!t)throw Error("Source connection not connected.");if(t.targetConnection!=this)throw Error("Target connection not connected to source connection.");if(this.isSuperior()){var n=this.sourceBlock_,o=t.getSourceBlock();t=this}else n=t.getSourceBlock(),o=this.sourceBlock_;var r=e.Events.getGroup();r||e.Events.setGroup(!0),this.disconnectInternal_(n,o),o.isShadow()||t.respawnShadow_(),r||e.Events.setGroup(!1)},e.Connection.prototype.disconnectInternal_=function(t,n){var o;e.Events.isEnabled()&&(o=new(e.Events.get(e.Events.BLOCK_MOVE))(n)),this.targetConnection=this.targetConnection.targetConnection=null,n.setParent(null),o&&(o.recordNew(),e.Events.fire(o))},e.Connection.prototype.respawnShadow_=function(){var t=this.getSourceBlock(),n=this.getShadowDom();if(t.workspace&&n)if((t=e.Xml.domToBlock(n,t.workspace)).outputConnection)this.connect(t.outputConnection);else{if(!t.previousConnection)throw Error("Child block does not have output or previous statement.");this.connect(t.previousConnection)}},e.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},e.Connection.prototype.checkType=function(t){return e.utils.deprecation.warn("Connection.prototype.checkType","October 2019","January 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,t,!1)},e.Connection.prototype.checkType_=function(t){return e.utils.deprecation.warn("Connection.prototype.checkType_","October 2019","January 2021","the workspace's connection checker"),this.checkType(t)},e.Connection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},e.Connection.prototype.setCheck=function(t){return t?(Array.isArray(t)||(t=[t]),this.check_=t,this.onCheckChanged_()):this.check_=null,this},e.Connection.prototype.getCheck=function(){return this.check_},e.Connection.prototype.setShadowDom=function(t){this.shadowDom_=t,(t=this.targetBlock())?t.isShadow()&&(t.dispose(!1),this.respawnShadow_()):this.respawnShadow_()},e.Connection.prototype.getShadowDom=function(t){return t&&this.targetBlock().isShadow()?e.Xml.blockToDom(this.targetBlock()):this.shadowDom_},e.Connection.prototype.neighbours=function(t){return[]},e.Connection.prototype.getParentInput=function(){for(var t=null,n=this.sourceBlock_.inputList,o=0;o<n.length;o++)if(n[o].connection===this){t=n[o];break}return t},e.Connection.prototype.toString=function(){var t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection==this)var n="Output Connection of ";else if(t.previousConnection==this)n="Previous Connection of ";else if(t.nextConnection==this)n="Next Connection of ";else{n=null;for(var r,o=0;r=t.inputList[o];o++)if(r.connection==this){n=r;break}if(!n)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";n='Input "'+n.name+'" connection on '}return n+t.toDevString()},e.IConnectionChecker=function(){},e.ConnectionChecker=function(){},e.ConnectionChecker.prototype.canConnect=function(t,n,o,r){return this.canConnectWithReason(t,n,o,r)==e.Connection.CAN_CONNECT},e.ConnectionChecker.prototype.canConnectWithReason=function(t,n,o,r){var a=this.doSafetyChecks(t,n);return a!=e.Connection.CAN_CONNECT?a:this.doTypeChecks(t,n)?o&&!this.doDragChecks(t,n,r||0)?e.Connection.REASON_DRAG_CHECKS_FAILED:e.Connection.CAN_CONNECT:e.Connection.REASON_CHECKS_FAILED},e.ConnectionChecker.prototype.getErrorMessage=function(t,n,o){switch(t){case e.Connection.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case e.Connection.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case e.Connection.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case e.Connection.REASON_TARGET_NULL:return"Target connection is null.";case e.Connection.REASON_CHECKS_FAILED:return"Connection checks failed. "+n+" expected "+n.getCheck()+", found "+o.getCheck();case e.Connection.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case e.Connection.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";default:return"Unknown connection failure: this should never happen!"}},e.ConnectionChecker.prototype.doSafetyChecks=function(t,n){if(!t||!n)return e.Connection.REASON_TARGET_NULL;if(t.isSuperior())var o=t.getSourceBlock(),r=n.getSourceBlock();else r=t.getSourceBlock(),o=n.getSourceBlock();return o==r?e.Connection.REASON_SELF_CONNECTION:n.type!=e.OPPOSITE_TYPE[t.type]?e.Connection.REASON_WRONG_TYPE:o.workspace!==r.workspace?e.Connection.REASON_DIFFERENT_WORKSPACES:o.isShadow()&&!r.isShadow()?e.Connection.REASON_SHADOW_PARENT:e.Connection.CAN_CONNECT},e.ConnectionChecker.prototype.doTypeChecks=function(t,n){if(t=t.getCheck(),n=n.getCheck(),!t||!n)return!0;for(var o=0;o<t.length;o++)if(-1!=n.indexOf(t[o]))return!0;return!1},e.ConnectionChecker.prototype.doDragChecks=function(t,n,o){if(t.distanceFrom(n)>o||n.getSourceBlock().isInsertionMarker())return!1;switch(n.type){case e.connectionTypes.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t,n);case e.connectionTypes.OUTPUT_VALUE:if(n.isConnected()&&!n.targetBlock().isInsertionMarker()||t.isConnected())return!1;break;case e.connectionTypes.INPUT_VALUE:if(n.isConnected()&&!n.targetBlock().isMovable()&&!n.targetBlock().isShadow())return!1;break;case e.connectionTypes.NEXT_STATEMENT:if(n.isConnected()&&!t.getSourceBlock().nextConnection&&!n.targetBlock().isShadow()&&n.targetBlock().nextConnection)return!1;break;default:return!1}return-1==e.draggingConnections.indexOf(n)},e.ConnectionChecker.prototype.canConnectToPrevious_=function(t,n){return!(t.targetConnection||-1!=e.draggingConnections.indexOf(n)||n.targetConnection&&(!(t=n.targetBlock()).isInsertionMarker()||t.getPreviousBlock()))},e.registry.register(e.registry.Type.CONNECTION_CHECKER,e.registry.DEFAULT,e.ConnectionChecker),e.VariableMap=function(t){this.variableMap_=Object.create(null),this.workspace=t},e.VariableMap.prototype.clear=function(){this.variableMap_=Object.create(null)},e.VariableMap.prototype.renameVariable=function(t,n){var o=this.getVariable(n,t.type),r=this.workspace.getAllBlocks(!1);e.Events.setGroup(!0);try{o&&o.getId()!=t.getId()?this.renameVariableWithConflict_(t,n,o,r):this.renameVariableAndUses_(t,n,r)}finally{e.Events.setGroup(!1)}},e.VariableMap.prototype.renameVariableById=function(t,n){var o=this.getVariableById(t);if(!o)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(o,n)},e.VariableMap.prototype.renameVariableAndUses_=function(t,n,o){for(e.Events.fire(new(e.Events.get(e.Events.VAR_RENAME))(t,n)),t.name=n,n=0;n<o.length;n++)o[n].updateVarName(t)},e.VariableMap.prototype.renameVariableWithConflict_=function(t,n,o,r){var a=t.type;for(n!=o.name&&this.renameVariableAndUses_(o,n,r),n=0;n<r.length;n++)r[n].renameVarById(t.getId(),o.getId());e.Events.fire(new(e.Events.get(e.Events.VAR_DELETE))(t)),t=this.getVariablesOfType(a).indexOf(t),this.variableMap_[a].splice(t,1)},e.VariableMap.prototype.createVariable=function(t,n,o){var r=this.getVariable(t,n);if(r){if(o&&r.getId()!=o)throw Error('Variable "'+t+'" is already in use and its id is "'+r.getId()+'" which conflicts with the passed in id, "'+o+'".');return r}if(o&&this.getVariableById(o))throw Error('Variable id, "'+o+'", is already in use.');return r=o||e.utils.genUid(),r=new e.VariableModel(this.workspace,t,n=n||"",r),(t=this.variableMap_[n]||[]).push(r),delete this.variableMap_[n],this.variableMap_[n]=t,r},e.VariableMap.prototype.deleteVariable=function(t){for(var r,n=this.variableMap_[t.type],o=0;r=n[o];o++)if(r.getId()==t.getId()){n.splice(o,1),e.Events.fire(new(e.Events.get(e.Events.VAR_DELETE))(t));break}},e.VariableMap.prototype.deleteVariableById=function(t){var n=this.getVariableById(t);if(n){var a,o=n.name,r=this.getVariableUsesById(t);for(t=0;a=r[t];t++)if("procedures_defnoreturn"==a.type||"procedures_defreturn"==a.type)return t=a.getFieldValue("NAME"),o=e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",o).replace("%2",t),void e.alert(o);var h=this;1<r.length?(o=e.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(r.length)).replace("%2",o),e.confirm(o,function(R){R&&n&&h.deleteVariableInternal(n,r)})):h.deleteVariableInternal(n,r)}else console.warn("Can't delete non-existent variable: "+t)},e.VariableMap.prototype.deleteVariableInternal=function(t,n){var o=e.Events.getGroup();o||e.Events.setGroup(!0);try{for(var r=0;r<n.length;r++)n[r].dispose(!0);this.deleteVariable(t)}finally{o||e.Events.setGroup(!1)}},e.VariableMap.prototype.getVariable=function(t,n){if(n=this.variableMap_[n||""])for(var r,o=0;r=n[o];o++)if(e.Names.equals(r.name,t))return r;return null},e.VariableMap.prototype.getVariableById=function(t){for(var n=Object.keys(this.variableMap_),o=0;o<n.length;o++)for(var h,r=n[o],a=0;h=this.variableMap_[r][a];a++)if(h.getId()==t)return h;return null},e.VariableMap.prototype.getVariablesOfType=function(t){return(t=this.variableMap_[t||""])?t.slice():[]},e.VariableMap.prototype.getVariableTypes=function(t){var n={};e.utils.object.mixin(n,this.variableMap_),t&&t.getPotentialVariableMap()&&e.utils.object.mixin(n,t.getPotentialVariableMap().variableMap_),t=Object.keys(n),n=!1;for(var o=0;o<t.length;o++)""==t[o]&&(n=!0);return n||t.push(""),t},e.VariableMap.prototype.getAllVariables=function(){var n,t=[];for(n in this.variableMap_)t=t.concat(this.variableMap_[n]);return t},e.VariableMap.prototype.getAllVariableNames=function(){var n,t=[];for(n in this.variableMap_)for(var a,o=this.variableMap_[n],r=0;a=o[r];r++)t.push(a.name);return t},e.VariableMap.prototype.getVariableUsesById=function(t){for(var n=[],o=this.workspace.getAllBlocks(!1),r=0;r<o.length;r++){var a=o[r].getVarModels();if(a)for(var h=0;h<a.length;h++)a[h].getId()==t&&n.push(o[r])}return n},e.Workspace=function(t){this.id=e.utils.genUid(),e.Workspace.WorkspaceDB_[this.id]=this,this.options=t||new e.Options({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(e.registry.getClassFromOptions(e.registry.Type.CONNECTION_CHECKER,this.options,!0))(this),this.topBlocks_=[],this.topComments_=[],this.commentDB_=Object.create(null),this.listeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.typedBlocksDB_=Object.create(null),this.variableMap_=new e.VariableMap(this),this.potentialVariableMap_=null},e.Workspace.prototype.rendered=!1,e.Workspace.prototype.isClearing=!1,e.Workspace.prototype.MAX_UNDO=1024,e.Workspace.prototype.connectionDBList=null,e.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete e.Workspace.WorkspaceDB_[this.id]},e.Workspace.SCAN_ANGLE=3,e.Workspace.prototype.sortObjects_=function(t,n){return t=t.getRelativeToSurfaceXY(),n=n.getRelativeToSurfaceXY(),t.y+e.Workspace.prototype.sortObjects_.offset*t.x-(n.y+e.Workspace.prototype.sortObjects_.offset*n.x)},e.Workspace.prototype.addTopBlock=function(t){this.topBlocks_.push(t)},e.Workspace.prototype.removeTopBlock=function(t){if(!e.utils.arrayRemove(this.topBlocks_,t))throw Error("Block not present in workspace's list of top-most blocks.")},e.Workspace.prototype.getTopBlocks=function(t){var n=[].concat(this.topBlocks_);return t&&1<n.length&&(this.sortObjects_.offset=Math.sin(e.utils.math.toRadians(e.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),n.sort(this.sortObjects_)),n},e.Workspace.prototype.addTypedBlock=function(t){this.typedBlocksDB_[t.type]||(this.typedBlocksDB_[t.type]=[]),this.typedBlocksDB_[t.type].push(t)},e.Workspace.prototype.removeTypedBlock=function(t){this.typedBlocksDB_[t.type].splice(this.typedBlocksDB_[t.type].indexOf(t),1),this.typedBlocksDB_[t.type].length||delete this.typedBlocksDB_[t.type]},e.Workspace.prototype.getBlocksByType=function(t,n){return this.typedBlocksDB_[t]?(t=this.typedBlocksDB_[t].slice(0),n&&1<t.length&&(this.sortObjects_.offset=Math.sin(e.utils.math.toRadians(e.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t):[]},e.Workspace.prototype.addTopComment=function(t){this.topComments_.push(t),this.commentDB_[t.id]&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB_[t.id]=t},e.Workspace.prototype.removeTopComment=function(t){if(!e.utils.arrayRemove(this.topComments_,t))throw Error("Comment not present in workspace's list of top-most comments.");delete this.commentDB_[t.id]},e.Workspace.prototype.getTopComments=function(t){var n=[].concat(this.topComments_);return t&&1<n.length&&(this.sortObjects_.offset=Math.sin(e.utils.math.toRadians(e.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),n.sort(this.sortObjects_)),n},e.Workspace.prototype.getAllBlocks=function(t){if(t){t=this.getTopBlocks(!0);for(var n=[],o=0;o<t.length;o++)n.push.apply(n,t[o].getDescendants(!0))}else for(n=this.getTopBlocks(!1),o=0;o<n.length;o++)n.push.apply(n,n[o].getChildren(!1));return n.filter(function(r){return!r.isInsertionMarker()})},e.Workspace.prototype.clear=function(){this.isClearing=!0;try{var t=e.Events.getGroup();for(t||e.Events.setGroup(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose(!1);for(;this.topComments_.length;)this.topComments_[this.topComments_.length-1].dispose(!1);t||e.Events.setGroup(!1),this.variableMap_.clear(),this.potentialVariableMap_&&this.potentialVariableMap_.clear()}finally{this.isClearing=!1}},e.Workspace.prototype.renameVariableById=function(t,n){this.variableMap_.renameVariableById(t,n)},e.Workspace.prototype.createVariable=function(t,n,o){return this.variableMap_.createVariable(t,n,o)},e.Workspace.prototype.getVariableUsesById=function(t){return this.variableMap_.getVariableUsesById(t)},e.Workspace.prototype.deleteVariableById=function(t){this.variableMap_.deleteVariableById(t)},e.Workspace.prototype.getVariable=function(t,n){return this.variableMap_.getVariable(t,n)},e.Workspace.prototype.getVariableById=function(t){return this.variableMap_.getVariableById(t)},e.Workspace.prototype.getVariablesOfType=function(t){return this.variableMap_.getVariablesOfType(t)},e.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes(this)},e.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},e.Workspace.prototype.getAllVariableNames=function(){return this.variableMap_.getAllVariableNames()},e.Workspace.prototype.getWidth=function(){return 0},e.Workspace.prototype.newBlock=function(t,n){return new e.Block(this,t,n)},e.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length},e.Workspace.prototype.remainingCapacityOfType=function(t){return this.options.maxInstances?(void 0!==this.options.maxInstances[t]?this.options.maxInstances[t]:1/0)-this.getBlocksByType(t,!1).length:1/0},e.Workspace.prototype.isCapacityAvailable=function(t){if(!this.hasBlockLimits())return!0;var o,n=0;for(o in t){if(t[o]>this.remainingCapacityOfType(o))return!1;n+=t[o]}return!(n>this.remainingCapacity())},e.Workspace.prototype.hasBlockLimits=function(){return this.options.maxBlocks!=1/0||!!this.options.maxInstances},e.Workspace.prototype.getUndoStack=function(){return this.undoStack_},e.Workspace.prototype.getRedoStack=function(){return this.redoStack_},e.Workspace.prototype.undo=function(t){var n=t?this.redoStack_:this.undoStack_,o=t?this.undoStack_:this.redoStack_,r=n.pop();if(r){for(var a=[r];n.length&&r.group&&r.group==n[n.length-1].group;)a.push(n.pop());for(n=0;r=a[n];n++)o.push(r);a=e.Events.filter(a,t),e.Events.recordUndo=!1;try{for(n=0;r=a[n];n++)r.run(t)}finally{e.Events.recordUndo=!0}}},e.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,e.Events.clearPendingUndo()},e.Workspace.prototype.addChangeListener=function(t){return this.listeners_.push(t),t},e.Workspace.prototype.removeChangeListener=function(t){e.utils.arrayRemove(this.listeners_,t)},e.Workspace.prototype.fireChangeListener=function(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(var o,n=0;o=this.listeners_[n];n++)o(t)},e.Workspace.prototype.getBlockById=function(t){return this.blockDB_[t]||null},e.Workspace.prototype.setBlockById=function(t,n){this.blockDB_[t]=n},e.Workspace.prototype.removeBlockById=function(t){delete this.blockDB_[t]},e.Workspace.prototype.getCommentById=function(t){return this.commentDB_[t]||null},e.Workspace.prototype.allInputsFilled=function(t){for(var r,n=this.getTopBlocks(!1),o=0;r=n[o];o++)if(!r.allInputsFilled(t))return!1;return!0},e.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_},e.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new e.VariableMap(this)},e.Workspace.prototype.getVariableMap=function(){return this.variableMap_},e.Workspace.prototype.setVariableMap=function(t){this.variableMap_=t},e.Workspace.WorkspaceDB_=Object.create(null),e.Workspace.getById=function(t){return e.Workspace.WorkspaceDB_[t]||null},e.Workspace.getAll=function(){var n,t=[];for(n in e.Workspace.WorkspaceDB_)t.push(e.Workspace.WorkspaceDB_[n]);return t},e.WorkspaceDragSurfaceSvg=function(t){this.container_=t,this.createDom()},e.WorkspaceDragSurfaceSvg.prototype.SVG_=null,e.WorkspaceDragSurfaceSvg.prototype.container_=null,e.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null),this.container_.appendChild(this.SVG_))},e.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(t,n){t=t.toFixed(0),n=n.toFixed(0),this.SVG_.style.display="block",e.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+n+"px, 0px)")},e.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return e.utils.getRelativeXY(this.SVG_)},e.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(t){if(!t)throw Error("Couldn't clear and hide the drag surface: missing new surface.");var n=this.SVG_.childNodes[0],o=this.SVG_.childNodes[1];if(!(n&&o&&e.utils.dom.hasClass(n,"blocklyBlockCanvas")&&e.utils.dom.hasClass(o,"blocklyBubbleCanvas")))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(null!=this.previousSibling_?e.utils.dom.insertAfter(n,this.previousSibling_):t.insertBefore(n,t.firstChild),e.utils.dom.insertAfter(o,n),this.SVG_.style.display="none",this.SVG_.childNodes.length)throw Error("Drag surface was not cleared.");e.utils.dom.setCssTransform(this.SVG_,""),this.previousSibling_=null},e.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(t,n,o,r,a,h){if(this.SVG_.childNodes.length)throw Error("Already dragging a block.");this.previousSibling_=o,t.setAttribute("transform","translate(0, 0) scale("+h+")"),n.setAttribute("transform","translate(0, 0) scale("+h+")"),this.SVG_.setAttribute("width",r),this.SVG_.setAttribute("height",a),this.SVG_.appendChild(t),this.SVG_.appendChild(n),this.SVG_.style.display="block"},e.blockRendering={},e.blockRendering.useDebugger=!1,e.blockRendering.register=function(t,n){e.registry.register(e.registry.Type.RENDERER,t,n)},e.blockRendering.unregister=function(t){e.registry.unregister(e.registry.Type.RENDERER,t)},e.blockRendering.startDebugger=function(){e.blockRendering.useDebugger=!0},e.blockRendering.stopDebugger=function(){e.blockRendering.useDebugger=!1},e.blockRendering.init=function(t,n,o){return(t=new(e.registry.getClass(e.registry.Type.RENDERER,t))(t)).init(n,o),t},e.ASTNode=function(t,n,o){if(!n)throw Error("Cannot create a node without a location.");this.type_=t,this.isConnection_=e.ASTNode.isConnectionType_(t),this.location_=n,this.wsCoordinate_=null,this.processParams_(o||null)},e.ASTNode.types={FIELD:"field",BLOCK:"block",INPUT:"input",OUTPUT:"output",NEXT:"next",PREVIOUS:"previous",STACK:"stack",WORKSPACE:"workspace"},e.ASTNode.NAVIGATE_ALL_FIELDS=!1,e.ASTNode.DEFAULT_OFFSET_Y=-20,e.ASTNode.isConnectionType_=function(t){switch(t){case e.ASTNode.types.PREVIOUS:case e.ASTNode.types.NEXT:case e.ASTNode.types.INPUT:case e.ASTNode.types.OUTPUT:return!0}return!1},e.ASTNode.createFieldNode=function(t){return t?new e.ASTNode(e.ASTNode.types.FIELD,t):null},e.ASTNode.createConnectionNode=function(t){if(!t)return null;var n=t.type;return n==e.connectionTypes.INPUT_VALUE||n==e.connectionTypes.NEXT_STATEMENT&&t.getParentInput()?e.ASTNode.createInputNode(t.getParentInput()):n==e.connectionTypes.NEXT_STATEMENT?new e.ASTNode(e.ASTNode.types.NEXT,t):n==e.connectionTypes.OUTPUT_VALUE?new e.ASTNode(e.ASTNode.types.OUTPUT,t):n==e.connectionTypes.PREVIOUS_STATEMENT?new e.ASTNode(e.ASTNode.types.PREVIOUS,t):null},e.ASTNode.createInputNode=function(t){return t&&t.connection?new e.ASTNode(e.ASTNode.types.INPUT,t.connection):null},e.ASTNode.createBlockNode=function(t){return t?new e.ASTNode(e.ASTNode.types.BLOCK,t):null},e.ASTNode.createStackNode=function(t){return t?new e.ASTNode(e.ASTNode.types.STACK,t):null},e.ASTNode.createWorkspaceNode=function(t,n){return n&&t?new e.ASTNode(e.ASTNode.types.WORKSPACE,t,{wsCoordinate:n}):null},e.ASTNode.createTopNode=function(t){var n=t.previousConnection||t.outputConnection;return n?e.ASTNode.createConnectionNode(n):e.ASTNode.createBlockNode(t)},e.ASTNode.prototype.processParams_=function(t){t&&t.wsCoordinate&&(this.wsCoordinate_=t.wsCoordinate)},e.ASTNode.prototype.getLocation=function(){return this.location_},e.ASTNode.prototype.getType=function(){return this.type_},e.ASTNode.prototype.getWsCoordinate=function(){return this.wsCoordinate_},e.ASTNode.prototype.isConnection=function(){return this.isConnection_},e.ASTNode.prototype.findNextForInput_=function(){var o,t=this.location_.getParentInput(),n=t.getSourceBlock();for(t=n.inputList.indexOf(t)+1;o=n.inputList[t];t++){for(var h,r=o.fieldRow,a=0;h=r[a];a++)if(h.isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(h);if(o.connection)return e.ASTNode.createInputNode(o)}return null},e.ASTNode.prototype.findNextForField_=function(){var t=this.location_,n=t.getParentInput(),o=t.getSourceBlock(),r=o.inputList.indexOf(n);for(t=n.fieldRow.indexOf(t)+1;n=o.inputList[r];r++){for(var a=n.fieldRow;t<a.length;){if(a[t].isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(a[t]);t++}if(t=0,n.connection)return e.ASTNode.createInputNode(n)}return null},e.ASTNode.prototype.findPrevForInput_=function(){for(var r,t=this.location_.getParentInput(),n=t.getSourceBlock(),o=n.inputList.indexOf(t);r=n.inputList[o];o--){if(r.connection&&r!==t)return e.ASTNode.createInputNode(r);for(var h,a=(r=r.fieldRow).length-1;h=r[a];a--)if(h.isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(h)}return null},e.ASTNode.prototype.findPrevForField_=function(){var a,t=this.location_,n=t.getParentInput(),o=t.getSourceBlock(),r=o.inputList.indexOf(n);for(t=n.fieldRow.indexOf(t)-1;a=o.inputList[r];r--){if(a.connection&&a!==n)return e.ASTNode.createInputNode(a);for(a=a.fieldRow;-1<t;){if(a[t].isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(a[t]);t--}0<=r-1&&(t=o.inputList[r-1].fieldRow.length-1)}return null},e.ASTNode.prototype.navigateBetweenStacks_=function(t){var n=this.getLocation();if(n instanceof e.Block||(n=n.getSourceBlock()),!n||!n.workspace)return null;var o=n.getRootBlock();n=o.workspace.getTopBlocks(!0);for(var a,r=0;a=n[r];r++)if(o.id==a.id)return-1==(t=r+(t?1:-1))||t==n.length?null:e.ASTNode.createStackNode(n[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")},e.ASTNode.prototype.findTopASTNodeForBlock_=function(t){var n=t.previousConnection||t.outputConnection;return n?e.ASTNode.createConnectionNode(n):e.ASTNode.createBlockNode(t)},e.ASTNode.prototype.getOutAstNodeForBlock_=function(t){if(!t)return null;var n=(t=t.getTopStackBlock()).previousConnection||t.outputConnection;return n&&n.targetConnection&&n.targetConnection.getParentInput()?e.ASTNode.createInputNode(n.targetConnection.getParentInput()):e.ASTNode.createStackNode(t)},e.ASTNode.prototype.findFirstFieldOrInput_=function(t){t=t.inputList;for(var o,n=0;o=t[n];n++){for(var h,r=o.fieldRow,a=0;h=r[a];a++)if(h.isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(h);if(o.connection)return e.ASTNode.createInputNode(o)}return null},e.ASTNode.prototype.getSourceBlock=function(){return this.getType()===e.ASTNode.types.BLOCK||this.getType()===e.ASTNode.types.STACK?this.getLocation():this.getType()===e.ASTNode.types.WORKSPACE?null:this.getLocation().getSourceBlock()},e.ASTNode.prototype.next=function(){switch(this.type_){case e.ASTNode.types.STACK:return this.navigateBetweenStacks_(!0);case e.ASTNode.types.OUTPUT:var t=this.location_;return e.ASTNode.createBlockNode(t.getSourceBlock());case e.ASTNode.types.FIELD:return this.findNextForField_();case e.ASTNode.types.INPUT:return this.findNextForInput_();case e.ASTNode.types.BLOCK:return e.ASTNode.createConnectionNode(this.location_.nextConnection);case e.ASTNode.types.PREVIOUS:return e.ASTNode.createBlockNode((t=this.location_).getSourceBlock());case e.ASTNode.types.NEXT:return e.ASTNode.createConnectionNode((t=this.location_).targetConnection)}return null},e.ASTNode.prototype.in=function(){switch(this.type_){case e.ASTNode.types.WORKSPACE:var t=this.location_.getTopBlocks(!0);if(0<t.length)return e.ASTNode.createStackNode(t[0]);break;case e.ASTNode.types.STACK:return this.findTopASTNodeForBlock_(t=this.location_);case e.ASTNode.types.BLOCK:return this.findFirstFieldOrInput_(t=this.location_);case e.ASTNode.types.INPUT:return e.ASTNode.createConnectionNode(this.location_.targetConnection)}return null},e.ASTNode.prototype.prev=function(){switch(this.type_){case e.ASTNode.types.STACK:return this.navigateBetweenStacks_(!1);case e.ASTNode.types.FIELD:return this.findPrevForField_();case e.ASTNode.types.INPUT:return this.findPrevForInput_();case e.ASTNode.types.BLOCK:var t=this.location_;return e.ASTNode.createConnectionNode(t.previousConnection||t.outputConnection);case e.ASTNode.types.PREVIOUS:if((t=(t=this.location_).targetConnection)&&!t.getParentInput())return e.ASTNode.createConnectionNode(t);break;case e.ASTNode.types.NEXT:return e.ASTNode.createBlockNode((t=this.location_).getSourceBlock())}return null},e.ASTNode.prototype.out=function(){switch(this.type_){case e.ASTNode.types.STACK:var t=this.location_,n=t.getRelativeToSurfaceXY();return n=new e.utils.Coordinate(n.x,n.y+e.ASTNode.DEFAULT_OFFSET_Y),e.ASTNode.createWorkspaceNode(t.workspace,n);case e.ASTNode.types.OUTPUT:return(n=(t=this.location_).targetConnection)?e.ASTNode.createConnectionNode(n):e.ASTNode.createStackNode(t.getSourceBlock());case e.ASTNode.types.FIELD:return e.ASTNode.createBlockNode(this.location_.getSourceBlock());case e.ASTNode.types.INPUT:return e.ASTNode.createBlockNode((t=this.location_).getSourceBlock());case e.ASTNode.types.BLOCK:return this.getOutAstNodeForBlock_(t=this.location_);case e.ASTNode.types.PREVIOUS:case e.ASTNode.types.NEXT:return this.getOutAstNodeForBlock_((t=this.location_).getSourceBlock())}return null},e.Blocks=Object.create(null),e.Extensions={},e.Extensions.ALL_=Object.create(null),e.Extensions.register=function(t,n){if("string"!=typeof t||""==t.trim())throw Error('Error: Invalid extension name "'+t+'"');if(e.Extensions.ALL_[t])throw Error('Error: Extension "'+t+'" is already registered.');if("function"!=typeof n)throw Error('Error: Extension "'+t+'" must be a function');e.Extensions.ALL_[t]=n},e.Extensions.registerMixin=function(t,n){if(!n||"object"!=typeof n)throw Error('Error: Mixin "'+t+'" must be a object');e.Extensions.register(t,function(){this.mixin(n)})},e.Extensions.registerMutator=function(t,n,o,r){var a='Error when registering mutator "'+t+'": ';e.Extensions.checkHasFunction_(a,n.domToMutation,"domToMutation"),e.Extensions.checkHasFunction_(a,n.mutationToDom,"mutationToDom");var h=e.Extensions.checkMutatorDialog_(n,a);if(o&&"function"!=typeof o)throw Error('Extension "'+t+'" is not a function');e.Extensions.register(t,function(){if(h){if(!e.Mutator)throw Error(a+"Missing require for Blockly.Mutator");this.setMutator(new e.Mutator(r||[]))}this.mixin(n),o&&o.apply(this)})},e.Extensions.unregister=function(t){e.Extensions.ALL_[t]?delete e.Extensions.ALL_[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},e.Extensions.apply=function(t,n,o){var r=e.Extensions.ALL_[t];if("function"!=typeof r)throw Error('Error: Extension "'+t+'" not found.');if(o)e.Extensions.checkNoMutatorProperties_(t,n);else var a=e.Extensions.getMutatorProperties_(n);if(r.apply(n),o)e.Extensions.checkBlockHasMutatorProperties_('Error after applying mutator "'+t+'": ',n);else if(!e.Extensions.mutatorPropertiesMatch_(a,n))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},e.Extensions.checkHasFunction_=function(t,n,o){if(!n)throw Error(t+'missing required property "'+o+'"');if("function"!=typeof n)throw Error(t+'" required property "'+o+'" must be a function')},e.Extensions.checkNoMutatorProperties_=function(t,n){if(e.Extensions.getMutatorProperties_(n).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+n.id)},e.Extensions.checkMutatorDialog_=function(t,n){var o=void 0!==t.compose,r=void 0!==t.decompose;if(o&&r){if("function"!=typeof t.compose)throw Error(n+"compose must be a function.");if("function"!=typeof t.decompose)throw Error(n+"decompose must be a function.");return!0}if(!o&&!r)return!1;throw Error(n+'Must have both or neither of "compose" and "decompose"')},e.Extensions.checkBlockHasMutatorProperties_=function(t,n){if("function"!=typeof n.domToMutation)throw Error(t+'Applying a mutator didn\'t add "domToMutation"');if("function"!=typeof n.mutationToDom)throw Error(t+'Applying a mutator didn\'t add "mutationToDom"');e.Extensions.checkMutatorDialog_(n,t)},e.Extensions.getMutatorProperties_=function(t){var n=[];return void 0!==t.domToMutation&&n.push(t.domToMutation),void 0!==t.mutationToDom&&n.push(t.mutationToDom),void 0!==t.compose&&n.push(t.compose),void 0!==t.decompose&&n.push(t.decompose),n},e.Extensions.mutatorPropertiesMatch_=function(t,n){if((n=e.Extensions.getMutatorProperties_(n)).length!=t.length)return!1;for(var o=0;o<n.length;o++)if(t[o]!=n[o])return!1;return!0},e.Extensions.buildTooltipForDropdown=function(t,n){var o=[];return"object"==typeof document&&e.utils.runAfterPageLoad(function(){for(var r in n)e.utils.checkMessageReferences(n[r])}),function(){this.type&&-1==o.indexOf(this.type)&&(e.Extensions.checkDropdownOptionsInTable_(this,t,n),o.push(this.type)),this.setTooltip(function(){var r=String(this.getFieldValue(t)),a=n[r];return null==a?-1==o.indexOf(this.type)&&(r="No tooltip mapping for value "+r+" of field "+t,null!=this.type&&(r+=" of block type "+this.type),console.warn(r+".")):a=e.utils.replaceMessageReferences(a),a}.bind(this))}},e.Extensions.checkDropdownOptionsInTable_=function(t,n,o){var r=t.getField(n);if(!r.isOptionListDynamic()){r=r.getOptions();for(var a=0;a<r.length;++a){var h=r[a][1];null==o[h]&&console.warn("No tooltip mapping for value "+h+" of field "+n+" of block type "+t.type)}}},e.Extensions.buildTooltipWithFieldText=function(t,n){return"object"==typeof document&&e.utils.runAfterPageLoad(function(){e.utils.checkMessageReferences(t)}),function(){this.setTooltip(function(){var o=this.getField(n);return e.utils.replaceMessageReferences(t).replace("%1",o?o.getText():"")}.bind(this))}},e.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip,this.setTooltip(function(){var t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||this.tooltipWhenNotConnected_}.bind(this))},e.Extensions.register("parent_tooltip_when_inline",e.Extensions.extensionParentTooltip_),e.fieldRegistry={},e.fieldRegistry.register=function(t,n){e.registry.register(e.registry.Type.FIELD,t,n)},e.fieldRegistry.unregister=function(t){e.registry.unregister(e.registry.Type.FIELD,t)},e.fieldRegistry.fromJson=function(t){var n=e.registry.getObject(e.registry.Type.FIELD,t.type);return n?n.fromJson(t):(console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},e.IDeletable=function(){},e.blockAnimations={},e.blockAnimations.disconnectPid_=0,e.blockAnimations.disconnectGroup_=null,e.blockAnimations.disposeUiEffect=function(t){var n=t.workspace,o=t.getSvgRoot();n.getAudioManager().play("delete"),t=n.getSvgXY(o),(o=o.cloneNode(!0)).translateX_=t.x,o.translateY_=t.y,o.setAttribute("transform","translate("+t.x+","+t.y+")"),n.getParentSvg().appendChild(o),o.bBox_=o.getBBox(),e.blockAnimations.disposeUiStep_(o,n.RTL,new Date,n.scale)},e.blockAnimations.disposeUiStep_=function(t,n,o,r){var a=(new Date-o)/150;1<a?e.utils.dom.removeNode(t):(t.setAttribute("transform","translate("+(t.translateX_+(n?-1:1)*t.bBox_.width*r/2*a)+","+(t.translateY_+t.bBox_.height*r*a)+") scale("+(1-a)*r+")"),setTimeout(e.blockAnimations.disposeUiStep_,10,t,n,o,r))},e.blockAnimations.connectionUiEffect=function(t){var n=t.workspace,o=n.scale;if(n.getAudioManager().play("click"),!(1>o)){var r=n.getSvgXY(t.getSvgRoot());t.outputConnection?(r.x+=(t.RTL?3:-3)*o,r.y+=13*o):t.previousConnection&&(r.x+=(t.RTL?-23:23)*o,r.y+=3*o),t=e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{cx:r.x,cy:r.y,r:0,fill:"none",stroke:"#888","stroke-width":10},n.getParentSvg()),e.blockAnimations.connectionUiStep_(t,new Date,o)}},e.blockAnimations.connectionUiStep_=function(t,n,o){var r=(new Date-n)/150;1<r?e.utils.dom.removeNode(t):(t.setAttribute("r",25*r*o),t.style.opacity=1-r,e.blockAnimations.disconnectPid_=setTimeout(e.blockAnimations.connectionUiStep_,10,t,n,o))},e.blockAnimations.disconnectUiEffect=function(t){if(t.workspace.getAudioManager().play("disconnect"),!(1>t.workspace.scale)){var n=t.getHeightWidth().height;n=Math.atan(10/n)/Math.PI*180,t.RTL||(n*=-1),e.blockAnimations.disconnectUiStep_(t.getSvgRoot(),n,new Date)}},e.blockAnimations.disconnectUiStep_=function(t,n,o){var r=(new Date-o)/200;1<r?t.skew_="":(t.skew_="skewX("+Math.round(Math.sin(r*Math.PI*3)*(1-r)*n)+")",e.blockAnimations.disconnectGroup_=t,e.blockAnimations.disconnectPid_=setTimeout(e.blockAnimations.disconnectUiStep_,10,t,n,o)),t.setAttribute("transform",t.translate_+t.skew_)},e.blockAnimations.disconnectUiStop=function(){if(e.blockAnimations.disconnectGroup_){clearTimeout(e.blockAnimations.disconnectPid_);var t=e.blockAnimations.disconnectGroup_;t.skew_="",t.setAttribute("transform",t.translate_),e.blockAnimations.disconnectGroup_=null}},e.Events.BlockDrag=function(t,n,o){e.Events.BlockDrag.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.isStart=n,this.blocks=o},e.utils.object.inherits(e.Events.BlockDrag,e.Events.UiBase),e.Events.BlockDrag.prototype.type=e.Events.BLOCK_DRAG,e.Events.BlockDrag.prototype.toJson=function(){var t=e.Events.BlockDrag.superClass_.toJson.call(this);return t.isStart=this.isStart,t.blockId=this.blockId,t.blocks=this.blocks,t},e.Events.BlockDrag.prototype.fromJson=function(t){e.Events.BlockDrag.superClass_.fromJson.call(this,t),this.isStart=t.isStart,this.blockId=t.blockId,this.blocks=t.blocks},e.registry.register(e.registry.Type.EVENT,e.Events.BLOCK_DRAG,e.Events.BlockDrag),e.IBlockDragger=function(){},e.InsertionMarkerManager=function(t){this.topBlock_=e.selected=t,this.workspace_=t.workspace,this.lastMarker_=this.lastOnStack_=null,this.firstMarker_=this.createMarkerBlock_(this.topBlock_),this.localConnection_=this.closestConnection_=null,this.wouldDeleteBlock_=!1,this.fadedBlock_=this.highlightedBlock_=this.markerConnection_=null,this.availableConnections_=this.initAvailableConnections_()},e.InsertionMarkerManager.PREVIEW_TYPE={INSERTION_MARKER:0,INPUT_OUTLINE:1,REPLACEMENT_FADE:2},e.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",e.InsertionMarkerManager.prototype.dispose=function(){this.availableConnections_.length=0,e.Events.disable();try{this.firstMarker_&&this.firstMarker_.dispose(),this.lastMarker_&&this.lastMarker_.dispose()}finally{e.Events.enable()}},e.InsertionMarkerManager.prototype.updateAvailableConnections=function(){this.availableConnections_=this.initAvailableConnections_()},e.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},e.InsertionMarkerManager.prototype.wouldConnectBlock=function(){return!!this.closestConnection_},e.InsertionMarkerManager.prototype.applyConnections=function(){if(this.closestConnection_&&(e.Events.disable(),this.hidePreview_(),e.Events.enable(),this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered)){var t=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;e.blockAnimations.connectionUiEffect(t.getSourceBlock()),this.topBlock_.getRootBlock().bringToFront()}},e.InsertionMarkerManager.prototype.update=function(t,n){var o=this.getCandidate_(t);((this.wouldDeleteBlock_=this.shouldDelete_(o,n))||this.shouldUpdatePreviews_(o,t))&&(e.Events.disable(),this.maybeHidePreview_(o),this.maybeShowPreview_(o),e.Events.enable())},e.InsertionMarkerManager.prototype.createMarkerBlock_=function(t){var n=t.type;e.Events.disable();try{var o=this.workspace_.newBlock(n);if(o.setInsertionMarker(!0),t.mutationToDom){var r=t.mutationToDom();r&&o.domToMutation(r)}for(n=0;n<t.inputList.length;n++){var a=t.inputList[n];if(a.name!=e.constants.COLLAPSED_INPUT_NAME){var h=o.inputList[n];if(!h)throw Error(e.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","an input"));for(r=0;r<a.fieldRow.length;r++){var R=a.fieldRow[r],L=h.fieldRow[r];if(!L)throw Error(e.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","a field"));L.setValue(R.getValue())}}}o.setCollapsed(t.isCollapsed()),o.setInputsInline(t.getInputsInline()),o.initSvg(),o.getSvgRoot().setAttribute("visibility","hidden")}finally{e.Events.enable()}return o},e.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var t=this.topBlock_.getConnections_(!1),n=this.topBlock_.lastConnectionInStack(!0);if(n&&n!=this.topBlock_.nextConnection){if(t.push(n),this.lastOnStack_=n,this.lastMarker_){e.Events.disable();try{this.lastMarker_.dispose()}finally{e.Events.enable()}}this.lastMarker_=this.createMarkerBlock_(n.getSourceBlock())}return t},e.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(t,n){var o=t.local,r=t.closest;return t=t.radius,o&&r?this.localConnection_&&this.closestConnection_?!(this.closestConnection_==r&&this.localConnection_==o||(o=this.localConnection_.x+n.x-this.closestConnection_.x,n=this.localConnection_.y+n.y-this.closestConnection_.y,n=Math.sqrt(o*o+n*n),r&&t>n-e.CURRENT_CONNECTION_PREFERENCE)):!this.localConnection_&&!this.closestConnection_||(console.error("Only one of localConnection_ and closestConnection_ was set."),console.error("Returning true from shouldUpdatePreviews, but it's not clear why."),!0):!(!this.localConnection_||!this.closestConnection_)},e.InsertionMarkerManager.prototype.getCandidate_=function(t){for(var n=this.getStartRadius_(),o=null,r=null,a=0;a<this.availableConnections_.length;a++){var h=this.availableConnections_[a],R=h.closest(n,t);R.connection&&(o=R.connection,r=h,n=R.radius)}return{closest:o,local:r,radius:n}},e.InsertionMarkerManager.prototype.getStartRadius_=function(){return this.closestConnection_&&this.localConnection_?e.CONNECTING_SNAP_RADIUS:e.SNAP_RADIUS},e.InsertionMarkerManager.prototype.shouldDelete_=function(t,n){return!(!n||!this.workspace_.getComponentManager().hasCapability(n.id,e.ComponentManager.Capability.DELETE_AREA))&&n.wouldDelete(this.topBlock_,t&&!!t.closest)},e.InsertionMarkerManager.prototype.maybeShowPreview_=function(t){if(!this.wouldDeleteBlock_){var n=t.closest;t=t.local,n&&(n==this.closestConnection_||n.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.closestConnection_=n,this.localConnection_=t,this.showPreview_()))}},e.InsertionMarkerManager.prototype.showPreview_=function(){var t=this.closestConnection_,n=this.workspace_.getRenderer();switch(n.getConnectionPreviewMethod(t,this.localConnection_,this.topBlock_)){case e.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline_();break;case e.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker_();break;case e.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade_()}t&&n.shouldHighlightConnection(t)&&t.highlight()},e.InsertionMarkerManager.prototype.maybeHidePreview_=function(t){if(t.closest){var n=this.closestConnection_!=t.closest;t=this.localConnection_!=t.local,this.closestConnection_&&this.localConnection_&&(n||t||this.wouldDeleteBlock_)&&this.hidePreview_()}else this.hidePreview_();this.localConnection_=this.closestConnection_=this.markerConnection_=null},e.InsertionMarkerManager.prototype.hidePreview_=function(){this.closestConnection_&&this.closestConnection_.targetBlock()&&this.workspace_.getRenderer().shouldHighlightConnection(this.closestConnection_)&&this.closestConnection_.unhighlight(),this.fadedBlock_?this.hideReplacementFade_():this.highlightedBlock_?this.hideInsertionInputOutline_():this.markerConnection_&&this.hideInsertionMarker_()},e.InsertionMarkerManager.prototype.showInsertionMarker_=function(){var t=this.localConnection_,n=this.closestConnection_,o=this.lastOnStack_&&t==this.lastOnStack_?this.lastMarker_:this.firstMarker_;if((t=o.getMatchingConnection(t.getSourceBlock(),t))==this.markerConnection_)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");o.render(),o.rendered=!0,o.getSvgRoot().setAttribute("visibility","visible"),t&&n&&o.positionNearConnection(t,n),n&&t.connect(n),this.markerConnection_=t},e.InsertionMarkerManager.prototype.hideInsertionMarker_=function(){if(this.markerConnection_){var t=this.markerConnection_,n=t.getSourceBlock(),o=n.nextConnection,r=n.previousConnection,a=n.outputConnection;if(a=t.type==e.connectionTypes.INPUT_VALUE&&!(a&&a.targetConnection),!(t!=o||r&&r.targetConnection)||a?t.targetBlock().unplug(!1):t.type==e.connectionTypes.NEXT_STATEMENT&&t!=o?((o=t.targetConnection).getSourceBlock().unplug(!1),r=r?r.targetConnection:null,n.unplug(!0),r&&r.connect(o)):n.unplug(!0),t.targetConnection)throw Error("markerConnection_ still connected at the end of disconnectInsertionMarker");this.markerConnection_=null,(t=n.getSvgRoot())&&t.setAttribute("visibility","hidden")}else console.log("No insertion marker connection to disconnect")},e.InsertionMarkerManager.prototype.showInsertionInputOutline_=function(){var t=this.closestConnection_;this.highlightedBlock_=t.getSourceBlock(),this.highlightedBlock_.highlightShapeForInput(t,!0)},e.InsertionMarkerManager.prototype.hideInsertionInputOutline_=function(){this.highlightedBlock_.highlightShapeForInput(this.closestConnection_,!1),this.highlightedBlock_=null},e.InsertionMarkerManager.prototype.showReplacementFade_=function(){this.fadedBlock_=this.closestConnection_.targetBlock(),this.fadedBlock_.fadeForReplacement(!0)},e.InsertionMarkerManager.prototype.hideReplacementFade_=function(){this.fadedBlock_.fadeForReplacement(!1),this.fadedBlock_=null},e.InsertionMarkerManager.prototype.getInsertionMarkers=function(){var t=[];return this.firstMarker_&&t.push(this.firstMarker_),this.lastMarker_&&t.push(this.lastMarker_),t},e.BlockDragger=function(t,n){this.draggingBlock_=t,this.workspace_=n,this.draggedConnectionManager_=new e.InsertionMarkerManager(this.draggingBlock_),this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=e.BlockDragger.initIconData_(t)},e.BlockDragger.prototype.dispose=function(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()},e.BlockDragger.initIconData_=function(t){var n=[];t=t.getDescendants(!1);for(var r,o=0;r=t[o];o++){r=r.getIcons();for(var a=0;a<r.length;a++){var h={location:r[a].getIconLocation(),icon:r[a]};n.push(h)}}return n},e.BlockDragger.prototype.startDrag=function(t,n){e.Events.getGroup()||e.Events.setGroup(!0),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),e.utils.dom.startTextWidthCache(),this.workspace_.setResizesEnabled(!1),e.blockAnimations.disconnectUiStop(),this.shouldDisconnect_(n)&&this.disconnectBlock_(n,t),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface()},e.BlockDragger.prototype.shouldDisconnect_=function(t){return!!(this.draggingBlock_.getParent()||t&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())},e.BlockDragger.prototype.disconnectBlock_=function(t,n){this.draggingBlock_.unplug(t),t=this.pixelsToWorkspaceUnits_(n),t=e.utils.Coordinate.sum(this.startXY_,t),this.draggingBlock_.translate(t.x,t.y),e.blockAnimations.disconnectUiEffect(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()},e.BlockDragger.prototype.fireDragStartEvent_=function(){var t=new(e.Events.get(e.Events.BLOCK_DRAG))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));e.Events.fire(t)},e.BlockDragger.prototype.drag=function(t,n){n=this.pixelsToWorkspaceUnits_(n);var o=e.utils.Coordinate.sum(this.startXY_,n);this.draggingBlock_.moveDuringDrag(o),this.dragIcons_(n),o=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(t),this.draggedConnectionManager_.update(n,this.dragTarget_),t=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock(),t!=this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==o&&(o&&o.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)},e.BlockDragger.prototype.endDrag=function(t,n){if(this.drag(t,n),this.dragIconData_=[],this.fireDragEndEvent_(),e.utils.dom.stopTextWidthCache(),e.blockAnimations.disconnectUiStop(),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_))t=this.startXY_;else{var o=(t=this.getNewLocationAfterDrag_(n)).delta;t=t.newLocation}this.draggingBlock_.moveOffDragSurface(t),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(!1),o?this.updateBlockAfterMove_(o):e.bumpObjectIntoBounds_(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)),this.workspace_.setResizesEnabled(!0),e.Events.setGroup(!1)},e.BlockDragger.prototype.getNewLocationAfterDrag_=function(t){var n={};return n.delta=this.pixelsToWorkspaceUnits_(t),n.newLocation=e.utils.Coordinate.sum(this.startXY_,n.delta),n},e.BlockDragger.prototype.maybeDeleteBlock_=function(){return!!this.wouldDeleteBlock_&&(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),e.draggingConnections=[],!0)},e.BlockDragger.prototype.updateBlockAfterMove_=function(t){this.draggingBlock_.moveConnections(t.x,t.y),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()},e.BlockDragger.prototype.fireDragEndEvent_=function(){var t=new(e.Events.get(e.Events.BLOCK_DRAG))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));e.Events.fire(t)},e.BlockDragger.prototype.updateToolboxStyle_=function(t){var n=this.workspace_.getToolbox();if(n){var o=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";t&&"function"==typeof n.removeStyle?n.removeStyle(o):t||"function"!=typeof n.addStyle||n.addStyle(o)}},e.BlockDragger.prototype.fireMoveEvent_=function(){var t=new(e.Events.get(e.Events.BLOCK_MOVE))(this.draggingBlock_);t.oldCoordinate=this.startXY_,t.recordNew(),e.Events.fire(t)},e.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)},e.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new e.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},e.BlockDragger.prototype.dragIcons_=function(t){for(var n=0;n<this.dragIconData_.length;n++){var o=this.dragIconData_[n];o.icon.setIconLocation(e.utils.Coordinate.sum(o.location,t))}},e.BlockDragger.prototype.getInsertionMarkers=function(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]},e.registry.register(e.registry.Type.BLOCK_DRAGGER,e.registry.DEFAULT,e.BlockDragger),e.IContextMenu=function(){},e.IDraggable=function(){},e.IBubble=function(){},e.Bubble=function(t,n,o,r,a,h){this.workspace_=t,this.content_=n,this.shape_=o,this.onMouseDownResizeWrapper_=this.onMouseDownBubbleWrapper_=this.moveCallback_=this.resizeCallback_=null,this.disposed=!1,o=e.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(o=-o),this.arrow_radians_=e.utils.math.toRadians(o),t.getBubbleCanvas().appendChild(this.createDom_(n,!(!a||!h))),this.setAnchorLocation(r),a&&h||(a=(t=this.content_.getBBox()).width+2*e.Bubble.BORDER_WIDTH,h=t.height+2*e.Bubble.BORDER_WIDTH),this.setBubbleSize(a,h),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0},e.Bubble.BORDER_WIDTH=6,e.Bubble.ARROW_THICKNESS=5,e.Bubble.ARROW_ANGLE=20,e.Bubble.ARROW_BEND=4,e.Bubble.ANCHOR_RADIUS=8,e.Bubble.onMouseUpWrapper_=null,e.Bubble.onMouseMoveWrapper_=null,e.Bubble.unbindDragEvents_=function(){e.Bubble.onMouseUpWrapper_&&(e.browserEvents.unbind(e.Bubble.onMouseUpWrapper_),e.Bubble.onMouseUpWrapper_=null),e.Bubble.onMouseMoveWrapper_&&(e.browserEvents.unbind(e.Bubble.onMouseMoveWrapper_),e.Bubble.onMouseMoveWrapper_=null)},e.Bubble.bubbleMouseUp_=function(t){e.Touch.clearTouchIdentifier(),e.Bubble.unbindDragEvents_()},e.Bubble.prototype.rendered_=!1,e.Bubble.prototype.anchorXY_=null,e.Bubble.prototype.relativeLeft_=0,e.Bubble.prototype.relativeTop_=0,e.Bubble.prototype.width_=0,e.Bubble.prototype.height_=0,e.Bubble.prototype.autoLayout_=!0,e.Bubble.prototype.createDom_=function(t,n){this.bubbleGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null);var o={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return e.utils.userAgent.JAVA_FX&&(o={}),o=e.utils.dom.createSvgElement(e.utils.Svg.G,o,this.bubbleGroup_),this.bubbleArrow_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{},o),this.bubbleBack_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyDraggable",x:0,y:0,rx:e.Bubble.BORDER_WIDTH,ry:e.Bubble.BORDER_WIDTH},o),n?(this.resizeGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),e.utils.dom.createSvgElement(e.utils.Svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,(n=2*e.Bubble.BORDER_WIDTH).toString())},this.resizeGroup_),e.utils.dom.createSvgElement(e.utils.Svg.LINE,{class:"blocklyResizeLine",x1:n/3,y1:n-1,x2:n-1,y2:n/3},this.resizeGroup_),e.utils.dom.createSvgElement(e.utils.Svg.LINE,{class:"blocklyResizeLine",x1:2*n/3,y1:n-1,x2:n-1,y2:2*n/3},this.resizeGroup_)):this.resizeGroup_=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper_=e.browserEvents.conditionalBind(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&(this.onMouseDownResizeWrapper_=e.browserEvents.conditionalBind(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))),this.bubbleGroup_.appendChild(t),this.bubbleGroup_},e.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_},e.Bubble.prototype.setSvgId=function(t){this.bubbleGroup_.dataset&&(this.bubbleGroup_.dataset.blockId=t)},e.Bubble.prototype.bubbleMouseDown_=function(t){var n=this.workspace_.getGesture(t);n&&n.handleBubbleStart(t,this)},e.Bubble.prototype.showContextMenu=function(t){},e.Bubble.prototype.isDeletable=function(){return!1},e.Bubble.prototype.setDeleteStyle=function(t){},e.Bubble.prototype.resizeMouseDown_=function(t){this.promote(),e.Bubble.unbindDragEvents_(),e.utils.isRightButton(t)||(this.workspace_.startDrag(t,new e.utils.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),e.Bubble.onMouseUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",this,e.Bubble.bubbleMouseUp_),e.Bubble.onMouseMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",this,this.resizeMouseMove_),e.hideChaff()),t.stopPropagation()},e.Bubble.prototype.resizeMouseMove_=function(t){this.autoLayout_=!1,t=this.workspace_.moveDrag(t),this.setBubbleSize(this.workspace_.RTL?-t.x:t.x,t.y),this.workspace_.RTL&&this.positionBubble_()},e.Bubble.prototype.registerResizeEvent=function(t){this.resizeCallback_=t},e.Bubble.prototype.registerMoveEvent=function(t){this.moveCallback_=t},e.Bubble.prototype.promote=function(){var t=this.bubbleGroup_.parentNode;return t.lastChild!==this.bubbleGroup_&&(t.appendChild(this.bubbleGroup_),!0)},e.Bubble.prototype.setAnchorLocation=function(t){this.anchorXY_=t,this.rendered_&&this.positionBubble_()},e.Bubble.prototype.layoutBubble_=function(){var t=this.workspace_.getMetricsManager().getViewMetrics(!0),n=this.getOptimalRelativeLeft_(t),o=this.getOptimalRelativeTop_(t),r=this.shape_.getBBox(),a={x:n,y:-this.height_-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},h={x:-this.width_-30,y:o};o={x:r.width,y:o};var R={x:n,y:r.height};n=r.width<r.height?o:R,r=r.width<r.height?R:o,o=this.getOverlap_(a,t),R=this.getOverlap_(h,t);var L=this.getOverlap_(n,t);t=this.getOverlap_(r,t),o==(t=Math.max(o,R,L,t))?(this.relativeLeft_=a.x,this.relativeTop_=a.y):R==t?(this.relativeLeft_=h.x,this.relativeTop_=h.y):L==t?(this.relativeLeft_=n.x,this.relativeTop_=n.y):(this.relativeLeft_=r.x,this.relativeTop_=r.y)},e.Bubble.prototype.getOverlap_=function(t,n){var o=this.workspace_.RTL?this.anchorXY_.x-t.x-this.width_:t.x+this.anchorXY_.x;return t=t.y+this.anchorXY_.y,Math.max(0,Math.min(1,(Math.min(o+this.width_,n.left+n.width)-Math.max(o,n.left))*(Math.min(t+this.height_,n.top+n.height)-Math.max(t,n.top))/(this.width_*this.height_)))},e.Bubble.prototype.getOptimalRelativeLeft_=function(t){var n=-this.width_/4;if(this.width_>t.width)return n;if(this.workspace_.RTL)var o=this.anchorXY_.x-n,r=o-this.width_,a=t.left+t.width,h=t.left+e.Scrollbar.scrollbarThickness/this.workspace_.scale;else o=(r=n+this.anchorXY_.x)+this.width_,h=t.left,a=t.left+t.width-e.Scrollbar.scrollbarThickness/this.workspace_.scale;return this.workspace_.RTL?r<h?n=-(h-this.anchorXY_.x+this.width_):o>a&&(n=-(a-this.anchorXY_.x)):r<h?n=h-this.anchorXY_.x:o>a&&(n=a-this.anchorXY_.x-this.width_),n},e.Bubble.prototype.getOptimalRelativeTop_=function(t){var n=-this.height_/4;if(this.height_>t.height)return n;var o=this.anchorXY_.y+n,a=t.top;t=t.top+t.height-e.Scrollbar.scrollbarThickness/this.workspace_.scale;var h=this.anchorXY_.y;return o<a?n=a-h:o+this.height_>t&&(n=t-h-this.height_),n},e.Bubble.prototype.positionBubble_=function(){var t=this.anchorXY_.x;this.moveTo(t=this.workspace_.RTL?t-(this.relativeLeft_+this.width_):t+this.relativeLeft_,this.relativeTop_+this.anchorXY_.y)},e.Bubble.prototype.moveTo=function(t,n){this.bubbleGroup_.setAttribute("transform","translate("+t+","+n+")")},e.Bubble.prototype.setDragging=function(t){!t&&this.moveCallback_&&this.moveCallback_()},e.Bubble.prototype.getBubbleSize=function(){return new e.utils.Size(this.width_,this.height_)},e.Bubble.prototype.setBubbleSize=function(t,n){var o=2*e.Bubble.BORDER_WIDTH;t=Math.max(t,o+45),n=Math.max(n,o+20),this.width_=t,this.height_=n,this.bubbleBack_.setAttribute("width",t),this.bubbleBack_.setAttribute("height",n),this.resizeGroup_&&this.resizeGroup_.setAttribute("transform",this.workspace_.RTL?"translate("+2*e.Bubble.BORDER_WIDTH+","+(n-o)+") scale(-1 1)":"translate("+(t-o)+","+(n-o)+")"),this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_(),this.resizeCallback_&&this.resizeCallback_()},e.Bubble.prototype.renderArrow_=function(){var t=[],n=this.width_/2,o=this.height_/2,r=-this.relativeLeft_,a=-this.relativeTop_;if(n==r&&o==a)t.push("M "+n+","+o);else{a-=o,r-=n,this.workspace_.RTL&&(r*=-1);var h=Math.sqrt(a*a+r*r),R=Math.acos(r/h);0>a&&(R=2*Math.PI-R);var L=R+Math.PI/2;L>2*Math.PI&&(L-=2*Math.PI);var W=Math.sin(L),nt=Math.cos(L),et=this.getBubbleSize();L=(et.width+et.height)/e.Bubble.ARROW_THICKNESS,L=Math.min(L,et.width,et.height)/4,r=n+(et=1-e.Bubble.ANCHOR_RADIUS/h)*r,a=o+et*a,et=n+L*nt;var Et=o+L*W;n-=L*nt,o-=L*W,(W=R+this.arrow_radians_)>2*Math.PI&&(W-=2*Math.PI),R=Math.sin(W)*h/e.Bubble.ARROW_BEND,h=Math.cos(W)*h/e.Bubble.ARROW_BEND,t.push("M"+et+","+Et),t.push("C"+(et+h)+","+(Et+R)+" "+r+","+a+" "+r+","+a),t.push("C"+r+","+a+" "+(n+h)+","+(o+R)+" "+n+","+o)}t.push("z"),this.bubbleArrow_.setAttribute("d",t.join(" "))},e.Bubble.prototype.setColour=function(t){this.bubbleBack_.setAttribute("fill",t),this.bubbleArrow_.setAttribute("fill",t)},e.Bubble.prototype.dispose=function(){this.onMouseDownBubbleWrapper_&&e.browserEvents.unbind(this.onMouseDownBubbleWrapper_),this.onMouseDownResizeWrapper_&&e.browserEvents.unbind(this.onMouseDownResizeWrapper_),e.Bubble.unbindDragEvents_(),e.utils.dom.removeNode(this.bubbleGroup_),this.disposed=!0},e.Bubble.prototype.moveDuringDrag=function(t,n){t?t.translateSurface(n.x,n.y):this.moveTo(n.x,n.y),this.relativeLeft_=this.workspace_.RTL?this.anchorXY_.x-n.x-this.width_:n.x-this.anchorXY_.x,this.relativeTop_=n.y-this.anchorXY_.y,this.renderArrow_()},e.Bubble.prototype.getRelativeToSurfaceXY=function(){return new e.utils.Coordinate(this.workspace_.RTL?-this.relativeLeft_+this.anchorXY_.x-this.width_:this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)},e.Bubble.prototype.setAutoLayout=function(t){this.autoLayout_=t},e.Bubble.textToDom=function(t){var n=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:e.Bubble.BORDER_WIDTH},null);t=t.split("\n");for(var o=0;o<t.length;o++){var r=e.utils.dom.createSvgElement(e.utils.Svg.TSPAN,{dy:"1em",x:e.Bubble.BORDER_WIDTH},n),a=document.createTextNode(t[o]);r.appendChild(a)}return n},e.Bubble.createNonEditableBubble=function(t,n,o){if((o=new e.Bubble(n.workspace,t,n.pathObject.svgPath,o,null,null)).setSvgId(n.id),n.RTL){n=t.getBBox().width;for(var a,r=0;a=t.childNodes[r];r++)a.setAttribute("text-anchor","end"),a.setAttribute("x",n+e.Bubble.BORDER_WIDTH)}return o},e.Events.CommentBase=function(t){this.commentId=(this.isBlank=void 0===t)?"":t.id,this.workspaceId=this.isBlank?"":t.workspace.id,this.group=e.Events.getGroup(),this.recordUndo=e.Events.recordUndo},e.utils.object.inherits(e.Events.CommentBase,e.Events.Abstract),e.Events.CommentBase.prototype.toJson=function(){var t=e.Events.CommentBase.superClass_.toJson.call(this);return this.commentId&&(t.commentId=this.commentId),t},e.Events.CommentBase.prototype.fromJson=function(t){e.Events.CommentBase.superClass_.fromJson.call(this,t),this.commentId=t.commentId},e.Events.CommentChange=function(t,n,o){e.Events.CommentChange.superClass_.constructor.call(this,t),t&&(this.oldContents_=void 0===n?"":n,this.newContents_=void 0===o?"":o)},e.utils.object.inherits(e.Events.CommentChange,e.Events.CommentBase),e.Events.CommentChange.prototype.type=e.Events.COMMENT_CHANGE,e.Events.CommentChange.prototype.toJson=function(){var t=e.Events.CommentChange.superClass_.toJson.call(this);return t.oldContents=this.oldContents_,t.newContents=this.newContents_,t},e.Events.CommentChange.prototype.fromJson=function(t){e.Events.CommentChange.superClass_.fromJson.call(this,t),this.oldContents_=t.oldContents,this.newContents_=t.newContents},e.Events.CommentChange.prototype.isNull=function(){return this.oldContents_==this.newContents_},e.Events.CommentChange.prototype.run=function(t){var n=this.getEventWorkspace_().getCommentById(this.commentId);n?n.setContent(t?this.newContents_:this.oldContents_):console.warn("Can't change non-existent comment: "+this.commentId)},e.Events.CommentCreate=function(t){e.Events.CommentCreate.superClass_.constructor.call(this,t),t&&(this.xml=t.toXmlWithXY())},e.utils.object.inherits(e.Events.CommentCreate,e.Events.CommentBase),e.Events.CommentCreate.prototype.type=e.Events.COMMENT_CREATE,e.Events.CommentCreate.prototype.toJson=function(){var t=e.Events.CommentCreate.superClass_.toJson.call(this);return t.xml=e.Xml.domToText(this.xml),t},e.Events.CommentCreate.prototype.fromJson=function(t){e.Events.CommentCreate.superClass_.fromJson.call(this,t),this.xml=e.Xml.textToDom(t.xml)},e.Events.CommentCreate.prototype.run=function(t){e.Events.CommentCreateDeleteHelper(this,t)},e.Events.CommentCreateDeleteHelper=function(t,n){var o=t.getEventWorkspace_();n?((n=e.utils.xml.createElement("xml")).appendChild(t.xml),e.Xml.domToWorkspace(n,o)):(o=o.getCommentById(t.commentId))?o.dispose(!1,!1):console.warn("Can't uncreate non-existent comment: "+t.commentId)},e.Events.CommentDelete=function(t){e.Events.CommentDelete.superClass_.constructor.call(this,t),t&&(this.xml=t.toXmlWithXY())},e.utils.object.inherits(e.Events.CommentDelete,e.Events.CommentBase),e.Events.CommentDelete.prototype.type=e.Events.COMMENT_DELETE,e.Events.CommentDelete.prototype.toJson=function(){return e.Events.CommentDelete.superClass_.toJson.call(this)},e.Events.CommentDelete.prototype.fromJson=function(t){e.Events.CommentDelete.superClass_.fromJson.call(this,t)},e.Events.CommentDelete.prototype.run=function(t){e.Events.CommentCreateDeleteHelper(this,!t)},e.Events.CommentMove=function(t){e.Events.CommentMove.superClass_.constructor.call(this,t),t&&(this.comment_=t,this.oldCoordinate_=t.getXY(),this.newCoordinate_=null)},e.utils.object.inherits(e.Events.CommentMove,e.Events.CommentBase),e.Events.CommentMove.prototype.recordNew=function(){if(!this.comment_)throw Error("Tried to record the new position of a comment on the same event twice.");this.newCoordinate_=this.comment_.getXY(),this.comment_=null},e.Events.CommentMove.prototype.type=e.Events.COMMENT_MOVE,e.Events.CommentMove.prototype.setOldCoordinate=function(t){this.oldCoordinate_=t},e.Events.CommentMove.prototype.toJson=function(){var t=e.Events.CommentMove.superClass_.toJson.call(this);return this.oldCoordinate_&&(t.oldCoordinate=Math.round(this.oldCoordinate_.x)+","+Math.round(this.oldCoordinate_.y)),this.newCoordinate_&&(t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y)),t},e.Events.CommentMove.prototype.fromJson=function(t){if(e.Events.CommentMove.superClass_.fromJson.call(this,t),t.oldCoordinate){var n=t.oldCoordinate.split(",");this.oldCoordinate_=new e.utils.Coordinate(Number(n[0]),Number(n[1]))}t.newCoordinate&&(n=t.newCoordinate.split(","),this.newCoordinate_=new e.utils.Coordinate(Number(n[0]),Number(n[1])))},e.Events.CommentMove.prototype.isNull=function(){return e.utils.Coordinate.equals(this.oldCoordinate_,this.newCoordinate_)},e.Events.CommentMove.prototype.run=function(t){var n=this.getEventWorkspace_().getCommentById(this.commentId);if(n){t=t?this.newCoordinate_:this.oldCoordinate_;var o=n.getXY();n.moveBy(t.x-o.x,t.y-o.y)}else console.warn("Can't move non-existent comment: "+this.commentId)},e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_CREATE,e.Events.CommentCreate),e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_CHANGE,e.Events.CommentChange),e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_MOVE,e.Events.CommentMove),e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_DELETE,e.Events.CommentDelete),e.BubbleDragger=function(t,n){this.draggingBubble_=t,this.workspace_=n,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY(),this.dragSurface_=e.utils.is3dSupported()&&n.getBlockDragSurface()?n.getBlockDragSurface():null},e.BubbleDragger.prototype.dispose=function(){this.dragSurface_=this.workspace_=this.draggingBubble_=null},e.BubbleDragger.prototype.startBubbleDrag=function(){e.Events.getGroup()||e.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),this.draggingBubble_.setAutoLayout(!1),this.dragSurface_&&this.moveToDragSurface_(),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!0)},e.BubbleDragger.prototype.dragBubble=function(t,n){n=this.pixelsToWorkspaceUnits_(n),n=e.utils.Coordinate.sum(this.startXY_,n),this.draggingBubble_.moveDuringDrag(this.dragSurface_,n),n=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(t),t=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),t!=this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==n&&(n&&n.onDragExit(this.draggingBubble_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBubble_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBubble_)},e.BubbleDragger.prototype.shouldDelete_=function(t){return!(!t||!this.workspace_.getComponentManager().hasCapability(t.id,e.ComponentManager.Capability.DELETE_AREA))&&t.wouldDelete(this.draggingBubble_,!1)},e.BubbleDragger.prototype.updateCursorDuringBubbleDrag_=function(){this.draggingBubble_.setDeleteStyle(this.wouldDeleteBubble_)},e.BubbleDragger.prototype.endBubbleDrag=function(t,n){this.dragBubble(t,n),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBubble_)?t=this.startXY_:(t=this.pixelsToWorkspaceUnits_(n),t=e.utils.Coordinate.sum(this.startXY_,t)),this.draggingBubble_.moveTo(t.x,t.y),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBubble_),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.draggingBubble_.dispose(!1,!0)):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas()),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!1),this.fireMoveEvent_()),this.workspace_.setResizesEnabled(!0),e.Events.setGroup(!1)},e.BubbleDragger.prototype.fireMoveEvent_=function(){if(this.draggingBubble_.isComment){var t=new(e.Events.get(e.Events.COMMENT_MOVE))(this.draggingBubble_);t.setOldCoordinate(this.startXY_),t.recordNew(),e.Events.fire(t)}},e.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new e.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},e.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())},e.Events.Click=function(t,n,o){e.Events.Click.superClass_.constructor.call(this,t?t.workspace.id:n),this.blockId=t?t.id:null,this.targetType=o},e.utils.object.inherits(e.Events.Click,e.Events.UiBase),e.Events.Click.prototype.type=e.Events.CLICK,e.Events.Click.prototype.toJson=function(){var t=e.Events.Click.superClass_.toJson.call(this);return t.targetType=this.targetType,this.blockId&&(t.blockId=this.blockId),t},e.Events.Click.prototype.fromJson=function(t){e.Events.Click.superClass_.fromJson.call(this,t),this.targetType=t.targetType,this.blockId=t.blockId},e.registry.register(e.registry.Type.EVENT,e.Events.CLICK,e.Events.Click),e.WorkspaceDragger=function(t){this.workspace_=t,this.horizontalScrollEnabled_=this.workspace_.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace_.isMovableVertically(),this.startScrollXY_=new e.utils.Coordinate(t.scrollX,t.scrollY)},e.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},e.WorkspaceDragger.prototype.startDrag=function(){e.selected&&e.selected.unselect(),this.workspace_.setupDragSurface()},e.WorkspaceDragger.prototype.endDrag=function(t){this.drag(t),this.workspace_.resetDragSurface()},e.WorkspaceDragger.prototype.drag=function(t){if(t=e.utils.Coordinate.sum(this.startScrollXY_,t),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace_.scroll(t.x,t.y);else if(this.horizontalScrollEnabled_)this.workspace_.scroll(t.x,this.workspace_.scrollY);else{if(!this.verticalScrollEnabled_)throw new TypeError("Invalid state.");this.workspace_.scroll(this.workspace_.scrollX,t.y)}},e.Gesture=function(t,n){this.mouseDownXY_=null,this.currentDragDeltaXY_=new e.utils.Coordinate(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.creatorWorkspace_=n,this.isDraggingBubble_=this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=t,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1,this.healStack_=!e.DRAG_STACK},e.Gesture.prototype.dispose=function(){e.Touch.clearTouchIdentifier(),e.Tooltip.unblock(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&e.browserEvents.unbind(this.onMoveWrapper_),this.onUpWrapper_&&e.browserEvents.unbind(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.bubbleDragger_&&this.bubbleDragger_.dispose()},e.Gesture.prototype.updateFromEvent_=function(t){var n=new e.utils.Coordinate(t.clientX,t.clientY);this.updateDragDelta_(n)&&(this.updateIsDragging_(),e.longStop_()),this.mostRecentEvent_=t},e.Gesture.prototype.updateDragDelta_=function(t){return this.currentDragDeltaXY_=e.utils.Coordinate.difference(t,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=e.utils.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?e.FLYOUT_DRAG_RADIUS:e.DRAG_RADIUS))},e.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(!this.targetBlock_||!this.flyout_.isBlockCreatable_(this.targetBlock_)||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),e.Events.getGroup()||e.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),0))},e.Gesture.prototype.updateIsDraggingBubble_=function(){return!!this.startBubble_&&(this.isDraggingBubble_=!0,this.startDraggingBubble_(),!0)},e.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},e.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=new e.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},e.Gesture.prototype.updateIsDragging_=function(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},e.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new(e.registry.getClassFromOptions(e.registry.Type.BLOCK_DRAGGER,this.creatorWorkspace_.options,!0))(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_)},e.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new e.BubbleDragger(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)},e.Gesture.prototype.doStart=function(t){e.utils.isTargetInput(t)?this.cancel():(this.hasStarted_=!0,e.blockAnimations.disconnectUiStop(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),e.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=t,e.Tooltip.block(),this.targetBlock_&&this.targetBlock_.select(),e.utils.isRightButton(t)?this.handleRightClick(t):("touchstart"!=t.type.toLowerCase()&&"pointerdown"!=t.type.toLowerCase()||"mouse"==t.pointerType||e.longStart(t,this),this.mouseDownXY_=new e.utils.Coordinate(t.clientX,t.clientY),this.healStack_=t.altKey||t.ctrlKey||t.metaKey,this.bindMouseEvents(t)))},e.Gesture.prototype.bindMouseEvents=function(t){this.onMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",null,this.handleUp.bind(this)),t.preventDefault(),t.stopPropagation()},e.Gesture.prototype.handleMove=function(t){this.updateFromEvent_(t),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBubble_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),t.preventDefault(),t.stopPropagation()},e.Gesture.prototype.handleUp=function(t){this.updateFromEvent_(t),e.longStop_(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(t,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(t,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(t),t.preventDefault(),t.stopPropagation(),this.dispose())},e.Gesture.prototype.cancel=function(){this.isEnding_||(e.longStop_(),this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},e.Gesture.prototype.handleRightClick=function(t){this.targetBlock_?(this.bringBlockToFront_(),e.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(t)):this.startBubble_?this.startBubble_.showContextMenu(t):this.startWorkspace_&&!this.flyout_&&(e.hideChaff(),this.startWorkspace_.showContextMenu(t)),t.preventDefault(),t.stopPropagation(),this.dispose()},e.Gesture.prototype.handleWsStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(n),this.mostRecentEvent_=t,this.doStart(t)},e.Gesture.prototype.fireWorkspaceClick_=function(t){e.Events.fire(new(e.Events.get(e.Events.CLICK))(null,t.id,"workspace"))},e.Gesture.prototype.handleFlyoutStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(n),this.handleWsStart(t,n.getWorkspace())},e.Gesture.prototype.handleBlockStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(n),this.mostRecentEvent_=t},e.Gesture.prototype.handleBubbleStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(n),this.mostRecentEvent_=t},e.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.setFocus&&this.startBubble_.setFocus(),this.startBubble_.select&&this.startBubble_.select()},e.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()},e.Gesture.prototype.doBlockClick_=function(){if(this.flyout_&&this.flyout_.autoClose)this.targetBlock_.isEnabled()&&(e.Events.getGroup()||e.Events.setGroup(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump());else{var t=new(e.Events.get(e.Events.CLICK))(this.startBlock_,this.startWorkspace_.id,"block");e.Events.fire(t)}this.bringBlockToFront_(),e.Events.setGroup(!1)},e.Gesture.prototype.doWorkspaceClick_=function(t){t=this.creatorWorkspace_,e.selected&&e.selected.unselect(),this.fireWorkspaceClick_(this.startWorkspace_||t)},e.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},e.Gesture.prototype.setStartField=function(t){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=t)},e.Gesture.prototype.setStartBubble=function(t){this.startBubble_||(this.startBubble_=t)},e.Gesture.prototype.setStartBlock=function(t){this.startBlock_||this.startBubble_||(this.startBlock_=t,t.isInFlyout&&t!=t.getRootBlock()?this.setTargetBlock_(t.getRootBlock()):this.setTargetBlock_(t))},e.Gesture.prototype.setTargetBlock_=function(t){t.isShadow()?this.setTargetBlock_(t.getParent()):this.targetBlock_=t},e.Gesture.prototype.setStartWorkspace_=function(t){this.startWorkspace_||(this.startWorkspace_=t)},e.Gesture.prototype.setStartFlyout_=function(t){this.flyout_||(this.flyout_=t)},e.Gesture.prototype.isBubbleClick_=function(){return!!this.startBubble_&&!this.hasExceededDragRadius_},e.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},e.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isClickable()&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)},e.Gesture.prototype.isWorkspaceClick_=function(){return!(this.startBlock_||this.startBubble_||this.startField_||this.hasExceededDragRadius_)},e.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_},e.Gesture.prototype.hasStarted=function(){return this.hasStarted_},e.Gesture.prototype.getInsertionMarkers=function(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]},e.Gesture.prototype.getCurrentDragger=function(){return this.isDraggingBlock_?this.blockDragger_:this.isDraggingWorkspace_?this.workspaceDragger_:this.isDraggingBubble_?this.bubbleDragger_:null},e.Gesture.inProgress=function(){for(var o,t=e.Workspace.getAll(),n=0;o=t[n];n++)if(o.currentGesture_)return!0;return!1},e.IRegistrable=function(){},e.Marker=function(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"},e.Marker.prototype.setDrawer=function(t){this.drawer_=t},e.Marker.prototype.getDrawer=function(){return this.drawer_},e.Marker.prototype.getCurNode=function(){return this.curNode_},e.Marker.prototype.setCurNode=function(t){var n=this.curNode_;this.curNode_=t,this.drawer_&&this.drawer_.draw(n,this.curNode_)},e.Marker.prototype.draw=function(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)},e.Marker.prototype.hide=function(){this.drawer_&&this.drawer_.hide()},e.Marker.prototype.dispose=function(){this.getDrawer()&&this.getDrawer().dispose()},e.Cursor=function(){e.Cursor.superClass_.constructor.call(this),this.type="cursor"},e.utils.object.inherits(e.Cursor,e.Marker),e.Cursor.prototype.next=function(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()==e.ASTNode.types.NEXT||t.getType()==e.ASTNode.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t},e.Cursor.prototype.in=function(){var t=this.getCurNode();return t?((t.getType()==e.ASTNode.types.PREVIOUS||t.getType()==e.ASTNode.types.OUTPUT)&&(t=t.next()),(t=t.in())&&this.setCurNode(t),t):null},e.Cursor.prototype.prev=function(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()==e.ASTNode.types.NEXT||t.getType()==e.ASTNode.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t},e.Cursor.prototype.out=function(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()==e.ASTNode.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null},e.registry.register(e.registry.Type.CURSOR,e.registry.DEFAULT,e.Cursor),e.MarkerManager=function(t){this.cursorSvg_=this.cursor_=null,this.markers_=Object.create(null),this.workspace_=t},e.MarkerManager.LOCAL_MARKER="local_marker_1",e.MarkerManager.prototype.registerMarker=function(t,n){this.markers_[t]&&this.unregisterMarker(t),n.setDrawer(this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,n)),this.setMarkerSvg(n.getDrawer().createDom()),this.markers_[t]=n},e.MarkerManager.prototype.unregisterMarker=function(t){var n=this.markers_[t];if(!n)throw Error("Marker with ID "+t+" does not exist. Can only unregister markers that exist.");n.dispose(),delete this.markers_[t]},e.MarkerManager.prototype.getCursor=function(){return this.cursor_},e.MarkerManager.prototype.getMarker=function(t){return this.markers_[t]||null},e.MarkerManager.prototype.setCursor=function(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(t=this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,this.cursor_),this.cursor_.setDrawer(t),this.setCursorSvg(this.cursor_.getDrawer().createDom()))},e.MarkerManager.prototype.setCursorSvg=function(t){t?(this.workspace_.getBlockCanvas().appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},e.MarkerManager.prototype.setMarkerSvg=function(t){t?this.workspace_.getBlockCanvas()&&(this.cursorSvg_?this.workspace_.getBlockCanvas().insertBefore(t,this.cursorSvg_):this.workspace_.getBlockCanvas().appendChild(t)):this.markerSvg_=null},e.MarkerManager.prototype.updateMarkers=function(){this.workspace_.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace_.getCursor().draw()},e.MarkerManager.prototype.dispose=function(){for(var o,t=Object.keys(this.markers_),n=0;o=t[n];n++)this.unregisterMarker(o);this.markers_=null,this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)},e.WidgetDiv={},e.WidgetDiv.owner_=null,e.WidgetDiv.dispose_=null,e.WidgetDiv.rendererClassName_="",e.WidgetDiv.themeClassName_="",e.WidgetDiv.createDom=function(){e.WidgetDiv.DIV||(e.WidgetDiv.DIV=document.createElement("div"),e.WidgetDiv.DIV.className="blocklyWidgetDiv",(e.parentContainer||document.body).appendChild(e.WidgetDiv.DIV))},e.WidgetDiv.show=function(t,n,o){e.WidgetDiv.hide(),e.WidgetDiv.owner_=t,e.WidgetDiv.dispose_=o,(t=e.WidgetDiv.DIV).style.direction=n?"rtl":"ltr",t.style.display="block",n=e.getMainWorkspace(),e.WidgetDiv.rendererClassName_=n.getRenderer().getClassName(),e.WidgetDiv.themeClassName_=n.getTheme().getClassName(),e.utils.dom.addClass(t,e.WidgetDiv.rendererClassName_),e.utils.dom.addClass(t,e.WidgetDiv.themeClassName_)},e.WidgetDiv.hide=function(){if(e.WidgetDiv.isVisible()){e.WidgetDiv.owner_=null;var t=e.WidgetDiv.DIV;t.style.display="none",t.style.left="",t.style.top="",e.WidgetDiv.dispose_&&e.WidgetDiv.dispose_(),e.WidgetDiv.dispose_=null,t.textContent="",e.WidgetDiv.rendererClassName_&&(e.utils.dom.removeClass(t,e.WidgetDiv.rendererClassName_),e.WidgetDiv.rendererClassName_=""),e.WidgetDiv.themeClassName_&&(e.utils.dom.removeClass(t,e.WidgetDiv.themeClassName_),e.WidgetDiv.themeClassName_=""),e.getMainWorkspace().markFocused()}},e.WidgetDiv.isVisible=function(){return!!e.WidgetDiv.owner_},e.WidgetDiv.hideIfOwner=function(t){e.WidgetDiv.owner_==t&&e.WidgetDiv.hide()},e.WidgetDiv.positionInternal_=function(t,n,o){e.WidgetDiv.DIV.style.left=t+"px",e.WidgetDiv.DIV.style.top=n+"px",e.WidgetDiv.DIV.style.height=o+"px"},e.WidgetDiv.positionWithAnchor=function(t,n,o,r){var a=e.WidgetDiv.calculateY_(t,n,o);t=e.WidgetDiv.calculateX_(t,n,o,r),0>a?e.WidgetDiv.positionInternal_(t,0,o.height+a):e.WidgetDiv.positionInternal_(t,a,o.height)},e.WidgetDiv.calculateX_=function(t,n,o,r){return r?(n=Math.max(n.right-o.width,t.left),Math.min(n,t.right-o.width)):(n=Math.min(n.left,t.right-o.width),Math.max(n,t.left))},e.WidgetDiv.calculateY_=function(t,n,o){return n.bottom+o.height>=t.bottom?n.top-o.height:n.bottom},e.Field=function(t,n,o){this.value_=this.DEFAULT_VALUE,this.tooltip_=this.validator_=null,this.size_=new e.utils.Size(0,0),this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=null,o&&this.configure_(o),this.setValue(t),n&&this.setValidator(n)},e.Field.prototype.DEFAULT_VALUE=null,e.Field.prototype.name=void 0,e.Field.prototype.disposed=!1,e.Field.prototype.maxDisplayLength=50,e.Field.prototype.sourceBlock_=null,e.Field.prototype.isDirty_=!0,e.Field.prototype.visible_=!0,e.Field.prototype.clickTarget_=null,e.Field.NBSP="\xa0",e.Field.prototype.EDITABLE=!0,e.Field.prototype.SERIALIZABLE=!1,e.Field.prototype.configure_=function(t){var n=t.tooltip;"string"==typeof n&&(n=e.utils.replaceMessageReferences(t.tooltip)),n&&this.setTooltip(n)},e.Field.prototype.setSourceBlock=function(t){if(this.sourceBlock_)throw Error("Field already bound to a block.");this.sourceBlock_=t},e.Field.prototype.getConstants=function(){return!this.constants_&&this.sourceBlock_&&this.sourceBlock_.workspace&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_},e.Field.prototype.getSourceBlock=function(){return this.sourceBlock_},e.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())},e.Field.prototype.initView=function(){this.createBorderRect_(),this.createTextElement_()},e.Field.prototype.initModel=function(){},e.Field.prototype.createBorderRect_=function(){this.borderRect_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)},e.Field.prototype.createTextElement_=function(){this.textElement_=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)},e.Field.prototype.bindEvents_=function(){e.Tooltip.bindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_=e.browserEvents.conditionalBind(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)},e.Field.prototype.fromXml=function(t){this.setValue(t.textContent)},e.Field.prototype.toXml=function(t){return t.textContent=this.getValue(),t},e.Field.prototype.dispose=function(){e.DropDownDiv.hideIfOwner(this),e.WidgetDiv.hideIfOwner(this),e.Tooltip.unbindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_&&e.browserEvents.unbind(this.mouseDownWrapper_),e.utils.dom.removeNode(this.fieldGroup_),this.disposed=!0},e.Field.prototype.updateEditable=function(){var t=this.fieldGroup_;this.EDITABLE&&t&&(this.sourceBlock_.isEditable()?(e.utils.dom.addClass(t,"blocklyEditableText"),e.utils.dom.removeClass(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(e.utils.dom.addClass(t,"blocklyNonEditableText"),e.utils.dom.removeClass(t,"blocklyEditableText"),t.style.cursor=""))},e.Field.prototype.isClickable=function(){return!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&!!this.showEditor_&&"function"==typeof this.showEditor_},e.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},e.Field.prototype.isSerializable=function(){var t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t},e.Field.prototype.isVisible=function(){return this.visible_},e.Field.prototype.setVisible=function(t){if(this.visible_!=t){this.visible_=t;var n=this.getSvgRoot();n&&(n.style.display=t?"block":"none")}},e.Field.prototype.setValidator=function(t){this.validator_=t},e.Field.prototype.getValidator=function(){return this.validator_},e.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},e.Field.prototype.applyColour=function(){},e.Field.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()},e.Field.prototype.showEditor=function(t){this.isClickable()&&this.showEditor_(t)},e.Field.prototype.updateSize_=function(t){var n=this.getConstants(),o=2*(t=null!=t?t:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0),r=n.FIELD_TEXT_HEIGHT,a=0;this.textElement_&&(o+=a=e.utils.dom.getFastTextWidth(this.textElement_,n.FIELD_TEXT_FONTSIZE,n.FIELD_TEXT_FONTWEIGHT,n.FIELD_TEXT_FONTFAMILY)),this.borderRect_&&(r=Math.max(r,n.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=r,this.size_.width=o,this.positionTextElement_(t,a),this.positionBorderRect_()},e.Field.prototype.positionTextElement_=function(t,n){if(this.textElement_){var o=this.getConstants(),r=this.size_.height/2;this.textElement_.setAttribute("x",this.sourceBlock_.RTL?this.size_.width-n-t:t),this.textElement_.setAttribute("y",o.FIELD_TEXT_BASELINE_CENTER?r:r-o.FIELD_TEXT_HEIGHT/2+o.FIELD_TEXT_BASELINE)}},e.Field.prototype.positionBorderRect_=function(){this.borderRect_&&(this.borderRect_.setAttribute("width",this.size_.width),this.borderRect_.setAttribute("height",this.size_.height),this.borderRect_.setAttribute("rx",this.getConstants().FIELD_BORDER_RECT_RADIUS),this.borderRect_.setAttribute("ry",this.getConstants().FIELD_BORDER_RECT_RADIUS))},e.Field.prototype.getSize=function(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0==this.size_.width&&(console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead."),this.render_()),this.size_):new e.utils.Size(0,0)},e.Field.prototype.getScaledBBox=function(){if(this.borderRect_)t=this.borderRect_.getBoundingClientRect(),o=e.utils.style.getPageOffset(this.borderRect_),r=t.width,t=t.height;else{var t=this.sourceBlock_.getHeightWidth(),n=this.sourceBlock_.workspace.scale,o=this.getAbsoluteXY_(),r=t.width*n;t=t.height*n,e.utils.userAgent.GECKO?(o.x+=1.5*n,o.y+=1.5*n):e.utils.userAgent.EDGE||e.utils.userAgent.IE||(o.x-=.5*n,o.y-=.5*n),r+=1*n,t+=1*n}return new e.utils.Rect(o.y,o.y+t,o.x,o.x+r)},e.Field.prototype.getDisplayText_=function(){var t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+"\u2026"),t=t.replace(/\s/g,e.Field.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+="\u200f"),t):e.Field.NBSP},e.Field.prototype.getText=function(){if(this.getText_){var t=this.getText_.call(this);if(null!==t)return String(t)}return String(this.getValue())},e.Field.prototype.markDirty=function(){this.isDirty_=!0,this.constants_=null},e.Field.prototype.forceRerender=function(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())},e.Field.prototype.setValue=function(t){if(null!==t){var n=this.doClassValidation_(t);if(!((t=this.processValidation_(t,n))instanceof Error)){if((n=this.getValidator())&&(n=n.call(this,t),(t=this.processValidation_(t,n))instanceof Error))return;if(!(n=this.sourceBlock_)||!n.disposed){var o=this.getValue();o===t?this.doValueUpdate_(t):(n&&e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(n,"field",this.name||null,o,t)),this.doValueUpdate_(t),this.isDirty_&&this.forceRerender())}}}},e.Field.prototype.processValidation_=function(t,n){return null===n?(this.doValueInvalid_(t),this.isDirty_&&this.forceRerender(),Error()):(void 0!==n&&(t=n),t)},e.Field.prototype.getValue=function(){return this.value_},e.Field.prototype.doClassValidation_=function(t){return null==t?null:t},e.Field.prototype.doValueUpdate_=function(t){this.value_=t,this.isDirty_=!0},e.Field.prototype.doValueInvalid_=function(t){},e.Field.prototype.onMouseDown_=function(t){this.sourceBlock_&&this.sourceBlock_.workspace&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)},e.Field.prototype.setTooltip=function(t){t||""===t||(t=this.sourceBlock_);var n=this.getClickTarget_();n?n.tooltip=t:this.tooltip_=t},e.Field.prototype.getTooltip=function(){var t=this.getClickTarget_();return e.Tooltip.getTooltipOfObject(t||{tooltip:this.tooltip_})},e.Field.prototype.getClickTarget_=function(){return this.clickTarget_||this.getSvgRoot()},e.Field.prototype.getAbsoluteXY_=function(){return e.utils.style.getPageOffset(this.getClickTarget_())},e.Field.prototype.referencesVariables=function(){return!1},e.Field.prototype.getParentInput=function(){for(var t=null,n=this.sourceBlock_,o=n.inputList,r=0;r<n.inputList.length;r++)for(var a=o[r],h=a.fieldRow,R=0;R<h.length;R++)if(h[R]===this){t=a;break}return t},e.Field.prototype.getFlipRtl=function(){return!1},e.Field.prototype.isTabNavigable=function(){return!1},e.Field.prototype.onShortcut=function(t){return!1},e.Field.prototype.setCursorSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},e.Field.prototype.setMarkerSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.markerSvg_=t):this.markerSvg_=null},e.Field.prototype.updateMarkers_=function(){var t=this.sourceBlock_.workspace;t.keyboardAccessibilityMode&&this.cursorSvg_&&t.getCursor().draw(),t.keyboardAccessibilityMode&&this.markerSvg_&&t.getMarker(e.MarkerManager.LOCAL_MARKER).draw()},e.FieldLabel=function(t,n,o){this.class_=null,e.FieldLabel.superClass_.constructor.call(this,t,null,o),o||(this.class_=n||null)},e.utils.object.inherits(e.FieldLabel,e.Field),e.FieldLabel.prototype.DEFAULT_VALUE="",e.FieldLabel.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldLabel(n,void 0,t)},e.FieldLabel.prototype.EDITABLE=!1,e.FieldLabel.prototype.configure_=function(t){e.FieldLabel.superClass_.configure_.call(this,t),this.class_=t.class},e.FieldLabel.prototype.initView=function(){this.createTextElement_(),this.class_&&e.utils.dom.addClass(this.textElement_,this.class_)},e.FieldLabel.prototype.doClassValidation_=function(t){return null==t?null:String(t)},e.FieldLabel.prototype.setClass=function(t){this.textElement_&&(this.class_&&e.utils.dom.removeClass(this.textElement_,this.class_),t&&e.utils.dom.addClass(this.textElement_,t)),this.class_=t},e.fieldRegistry.register("field_label",e.FieldLabel),e.Input=function(t,n,o,r){if(t!=e.inputTypes.DUMMY&&!n)throw Error("Value inputs and statement inputs must have non-empty name.");this.type=t,this.name=n,this.sourceBlock_=o,this.connection=r,this.fieldRow=[]},e.Input.prototype.align=e.constants.ALIGN.LEFT,e.Input.prototype.visible_=!0,e.Input.prototype.getSourceBlock=function(){return this.sourceBlock_},e.Input.prototype.appendField=function(t,n){return this.insertFieldAt(this.fieldRow.length,t,n),this},e.Input.prototype.insertFieldAt=function(t,n,o){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return(n||""==n&&o)&&("string"==typeof n&&(n=e.fieldRegistry.fromJson({type:"field_label",text:n})),n.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&(n.init(),n.applyColour()),n.name=o,n.setVisible(this.isVisible()),n.prefixField&&(t=this.insertFieldAt(t,n.prefixField)),this.fieldRow.splice(t,0,n),++t,n.suffixField&&(t=this.insertFieldAt(t,n.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours())),t},e.Input.prototype.removeField=function(t,n){for(var r,o=0;r=this.fieldRow[o];o++)if(r.name===t)return r.dispose(),this.fieldRow.splice(o,1),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),!0;if(n)return!1;throw Error('Field "'+t+'" not found.')},e.Input.prototype.isVisible=function(){return this.visible_},e.Input.prototype.setVisible=function(t){var n=[];if(this.visible_==t)return n;this.visible_=t;for(var r,o=0;r=this.fieldRow[o];o++)r.setVisible(t);return this.connection&&(this.connection=this.connection,t?n=this.connection.startTrackingAll():this.connection.stopTrackingAll(),o=this.connection.targetBlock())&&(o.getSvgRoot().style.display=t?"block":"none"),n},e.Input.prototype.markDirty=function(){for(var n,t=0;n=this.fieldRow[t];t++)n.markDirty()},e.Input.prototype.setCheck=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this},e.Input.prototype.setAlign=function(t){return this.align=t,this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render()),this},e.Input.prototype.setShadowDom=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(t),this},e.Input.prototype.getShadowDom=function(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()},e.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var t=0;t<this.fieldRow.length;t++)this.fieldRow[t].init()},e.Input.prototype.dispose=function(){for(var n,t=0;n=this.fieldRow[t];t++)n.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null},e.Block=function(t,n,o){if(e.Generator&&void 0!==e.Generator.prototype[n])throw Error('Block prototypeName "'+n+'" conflicts with Blockly.Generator members.');if(this.id=o&&!t.getBlockById(o)?o:e.utils.genUid(),t.setBlockById(this.id,this),this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.comment=this.outputShape_=null,this.commentModel={text:null,pinned:!1,size:new e.utils.Size(160,80)},this.xy_=new e.utils.Coordinate(0,0),this.workspace=t,this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,this.isInsertionMarker_=!1,this.hat=void 0,this.rendered=null,this.statementInputCount=0,n){if(this.type=n,!(o=e.Blocks[n])||"object"!=typeof o)throw TypeError("Unknown block type: "+n);e.utils.object.mixin(this,o)}t.addTopBlock(this),t.addTypedBlock(this),(t=e.Events.getGroup())||e.Events.setGroup(!0),n=e.Events.recordUndo;try{"function"==typeof this.init&&(e.Events.recordUndo=!1,this.init(),e.Events.recordUndo=n),e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(this))}finally{t||e.Events.setGroup(!1),e.Events.recordUndo=n}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)},e.Block.COLLAPSED_INPUT_NAME=e.constants.COLLAPSED_INPUT_NAME,e.Block.COLLAPSED_FIELD_NAME=e.constants.COLLAPSED_FIELD_NAME,e.Block.prototype.data=null,e.Block.prototype.disposed=!1,e.Block.prototype.hue_=null,e.Block.prototype.colour_="#000000",e.Block.prototype.styleName_="",e.Block.prototype.dispose=function(t){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_DELETE))(this)),e.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.workspace=null),e.selected==this&&(e.selected=null);for(var n=this.childBlocks_.length-1;0<=n;n--)this.childBlocks_[n].dispose(!1);n=0;for(var o;o=this.inputList[n];n++)o.dispose();this.inputList.length=0;var a,r=this.getConnections_(!0);for(n=0;a=r[n];n++)a.dispose()}finally{e.Events.enable(),this.disposed=!0}}},e.Block.prototype.initModel=function(){for(var n,t=0;n=this.inputList[t];t++)for(var r,o=0;r=n.fieldRow[o];o++)r.initModel&&r.initModel()},e.Block.prototype.unplug=function(t){this.outputConnection?this.unplugFromRow_(t):this.previousConnection&&this.unplugFromStack_(t)},e.Block.prototype.unplugFromRow_=function(t){var n=null;this.outputConnection.isConnected()&&(n=this.outputConnection.targetConnection,this.outputConnection.disconnect()),n&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&((t=t.targetConnection).disconnect(),this.workspace.connectionChecker.canConnect(t,n,!1)?n.connect(t):t.onFailedConnect(n))},e.Block.prototype.getOnlyValueConnection_=function(){for(var t=null,n=0;n<this.inputList.length;n++){var o=this.inputList[n].connection;if(o&&o.type==e.connectionTypes.INPUT_VALUE&&o.targetConnection){if(t)return null;t=o}}return t},e.Block.prototype.unplugFromStack_=function(t){var n=null;this.previousConnection.isConnected()&&(n=this.previousConnection.targetConnection,this.previousConnection.disconnect());var o=this.getNextBlock();t&&o&&!o.isShadow()&&((t=this.nextConnection.targetConnection).disconnect(),n&&this.workspace.connectionChecker.canConnect(n,t,!1)&&n.connect(t))},e.Block.prototype.getConnections_=function(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(var o,n=0;o=this.inputList[n];n++)o.connection&&t.push(o.connection);return t},e.Block.prototype.lastConnectionInStack=function(t){for(var n=this.nextConnection;n;){var o=n.targetBlock();if(!o||t&&o.isShadow())return n;n=o.nextConnection}return null},e.Block.prototype.bumpNeighbours=function(){},e.Block.prototype.getParent=function(){return this.parentBlock_},e.Block.prototype.getInputWithBlock=function(t){for(var o,n=0;o=this.inputList[n];n++)if(o.connection&&o.connection.targetBlock()==t)return o;return null},e.Block.prototype.getSurroundParent=function(){var t=this;do{var n=t;if(!(t=t.getParent()))return null}while(t.getNextBlock()==n);return t},e.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},e.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()},e.Block.prototype.getFirstStatementConnection=function(){for(var n,t=0;n=this.inputList[t];t++)if(n.connection&&n.connection.type==e.connectionTypes.NEXT_STATEMENT)return n.connection;return null},e.Block.prototype.getRootBlock=function(){var t=this;do{var n=t;t=n.parentBlock_}while(t);return n},e.Block.prototype.getTopStackBlock=function(){var t=this;do{var n=t.getPreviousBlock()}while(n&&n.getNextBlock()==t&&(t=n));return t},e.Block.prototype.getChildren=function(t){if(!t)return this.childBlocks_;t=[];for(var o,n=0;o=this.inputList[n];n++)o.connection&&(o=o.connection.targetBlock())&&t.push(o);return(n=this.getNextBlock())&&t.push(n),t},e.Block.prototype.setParent=function(t){if(t!=this.parentBlock_){if(this.parentBlock_){if(e.utils.arrayRemove(this.parentBlock_.childBlocks_,this),this.previousConnection&&this.previousConnection.isConnected())throw Error("Still connected to previous block.");if(this.outputConnection&&this.outputConnection.isConnected())throw Error("Still connected to parent block.");this.parentBlock_=null}else this.workspace.removeTopBlock(this);(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}},e.Block.prototype.getDescendants=function(t){for(var r,n=[this],o=this.getChildren(t),a=0;r=o[a];a++)n.push.apply(n,r.getDescendants(t));return n},e.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},e.Block.prototype.setDeletable=function(t){this.deletable_=t},e.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},e.Block.prototype.setMovable=function(t){this.movable_=t},e.Block.prototype.isDuplicatable=function(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(e.utils.getBlockTypeCounts(this,!0))},e.Block.prototype.isShadow=function(){return this.isShadow_},e.Block.prototype.setShadow=function(t){this.isShadow_=t},e.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_},e.Block.prototype.setInsertionMarker=function(t){this.isInsertionMarker_=t},e.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},e.Block.prototype.setEditable=function(t){this.editable_=t,t=0;for(var n;n=this.inputList[t];t++)for(var r,o=0;r=n.fieldRow[o];o++)r.updateEditable()},e.Block.prototype.isDisposed=function(){return this.disposed},e.Block.prototype.getMatchingConnection=function(t,n){var o=this.getConnections_(!0);if(t=t.getConnections_(!0),o.length!=t.length)throw Error("Connection lists did not match in length.");for(var r=0;r<t.length;r++)if(t[r]==n)return o[r];return null},e.Block.prototype.setHelpUrl=function(t){this.helpUrl=t},e.Block.prototype.setTooltip=function(t){this.tooltip=t},e.Block.prototype.getTooltip=function(){return e.Tooltip.getTooltipOfObject(this)},e.Block.prototype.getColour=function(){return this.colour_},e.Block.prototype.getStyleName=function(){return this.styleName_},e.Block.prototype.getHue=function(){return this.hue_},e.Block.prototype.setColour=function(t){t=e.utils.parseBlockColour(t),this.hue_=t.hue,this.colour_=t.hex},e.Block.prototype.setStyle=function(t){this.styleName_=t},e.Block.prototype.setOnChange=function(t){if(t&&"function"!=typeof t)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=t)&&(this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},e.Block.prototype.getField=function(t){if("string"!=typeof t)throw TypeError("Blockly.Block.prototype.getField expects a string with the field name but received "+(void 0===t?"nothing":t+" of type "+typeof t)+" instead");for(var o,n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)if(a.name===t)return a;return null},e.Block.prototype.getVars=function(){for(var o,t=[],n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)a.referencesVariables()&&t.push(a.getValue());return t},e.Block.prototype.getVarModels=function(){for(var o,t=[],n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)a.referencesVariables()&&(a=this.workspace.getVariableById(a.getValue()))&&t.push(a);return t},e.Block.prototype.updateVarName=function(t){for(var o,n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)a.referencesVariables()&&t.getId()==a.getValue()&&a.refreshVariableName()},e.Block.prototype.renameVarById=function(t,n){for(var r,o=0;r=this.inputList[o];o++)for(var h,a=0;h=r.fieldRow[a];a++)h.referencesVariables()&&t==h.getValue()&&h.setValue(n)},e.Block.prototype.getFieldValue=function(t){return(t=this.getField(t))?t.getValue():null},e.Block.prototype.setFieldValue=function(t,n){var o=this.getField(n);if(!o)throw Error('Field "'+n+'" not found.');o.setValue(t)},e.Block.prototype.setPreviousStatement=function(t,n){if(t){if(void 0===n&&(n=null),!this.previousConnection){if(this.outputConnection)throw Error("Remove output connection prior to adding previous connection.");this.previousConnection=this.makeConnection_(e.connectionTypes.PREVIOUS_STATEMENT)}this.previousConnection.setCheck(n)}else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}},e.Block.prototype.setNextStatement=function(t,n){if(t)void 0===n&&(n=null),this.nextConnection||(this.nextConnection=this.makeConnection_(e.connectionTypes.NEXT_STATEMENT)),this.nextConnection.setCheck(n);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}},e.Block.prototype.setOutput=function(t,n){if(t){if(void 0===n&&(n=null),!this.outputConnection){if(this.previousConnection)throw Error("Remove previous connection prior to adding output connection.");this.outputConnection=this.makeConnection_(e.connectionTypes.OUTPUT_VALUE)}this.outputConnection.setCheck(n)}else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}},e.Block.prototype.setInputsInline=function(t){this.inputsInline!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)},e.Block.prototype.getInputsInline=function(){if(null!=this.inputsInline)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==e.inputTypes.DUMMY&&this.inputList[t].type==e.inputTypes.DUMMY)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==e.inputTypes.VALUE&&this.inputList[t].type==e.inputTypes.DUMMY)return!0;return!1},e.Block.prototype.setOutputShape=function(t){this.outputShape_=t},e.Block.prototype.getOutputShape=function(){return this.outputShape_},e.Block.prototype.isEnabled=function(){return!this.disabled},e.Block.prototype.setEnabled=function(t){this.isEnabled()!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"disabled",null,this.disabled,!t)),this.disabled=!t)},e.Block.prototype.getInheritedDisabled=function(){for(var t=this.getSurroundParent();t;){if(t.disabled)return!0;t=t.getSurroundParent()}return!1},e.Block.prototype.isCollapsed=function(){return this.collapsed_},e.Block.prototype.setCollapsed=function(t){this.collapsed_!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)},e.Block.prototype.toString=function(t,n){function o(nt){var et=nt.getCheck();return!et&&nt.targetConnection&&(et=nt.targetConnection.getCheck()),!!et&&(-1!=et.indexOf("Boolean")||-1!=et.indexOf("Number"))}function r(){R&&R.getType()==L.getType()&&R.getLocation()==L.getLocation()&&(R=null)}var a=[];n=n||"?";var h=e.ASTNode.NAVIGATE_ALL_FIELDS;e.ASTNode.NAVIGATE_ALL_FIELDS=!0;for(var R=e.ASTNode.createBlockNode(this),L=R;R;){switch(R.getType()){case e.ASTNode.types.INPUT:var W=R.getLocation();R.in()?o(W)&&a.push("("):a.push(n);break;case e.ASTNode.types.FIELD:(W=R.getLocation()).name!=e.constants.COLLAPSED_FIELD_NAME&&a.push(W.getText())}if(!(R=(W=R).in()||W.next())){for(R=W.out(),r();R&&!R.next();)R=R.out(),r(),R&&R.getType()==e.ASTNode.types.INPUT&&o(R.getLocation())&&a.push(")");R&&(R=R.next())}}for(e.ASTNode.NAVIGATE_ALL_FIELDS=h,n=2;n<a.length;n++)"("==a[n-2]&&")"==a[n]&&(a[n-2]=a[n-1],a.splice(n-1,2));return a=(a=a.reduce(function(nt,et){return nt+("("==nt.substr(-1)||")"==et?"":" ")+et},"")).trim()||"???",t&&a.length>t&&(a=a.substring(0,t-3)+"..."),a},e.Block.prototype.appendValueInput=function(t){return this.appendInput_(e.inputTypes.VALUE,t)},e.Block.prototype.appendStatementInput=function(t){return this.appendInput_(e.inputTypes.STATEMENT,t)},e.Block.prototype.appendDummyInput=function(t){return this.appendInput_(e.inputTypes.DUMMY,t||"")},e.Block.prototype.jsonInit=function(t){var n=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(n+"Must not have both an output and a previousStatement.");if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(n+"Must not have both a colour and a style.");t.style?this.jsonInitStyle_(t,n):this.jsonInitColour_(t,n);for(var o=0;void 0!==t["message"+o];)this.interpolate_(t["message"+o],t["args"+o]||[],t["lastDummyAlign"+o],n),o++;if(void 0!==t.inputsInline&&this.setInputsInline(t.inputsInline),void 0!==t.output&&this.setOutput(!0,t.output),void 0!==t.outputShape&&this.setOutputShape(t.outputShape),void 0!==t.previousStatement&&this.setPreviousStatement(!0,t.previousStatement),void 0!==t.nextStatement&&this.setNextStatement(!0,t.nextStatement),void 0!==t.tooltip&&(o=e.utils.replaceMessageReferences(o=t.tooltip),this.setTooltip(o)),void 0!==t.enableContextMenu&&(this.contextMenu=!!(o=t.enableContextMenu)),void 0!==t.helpUrl&&(o=e.utils.replaceMessageReferences(o=t.helpUrl),this.setHelpUrl(o)),"string"==typeof t.extensions&&(console.warn(n+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),void 0!==t.mutator&&e.Extensions.apply(t.mutator,this,!0),t=t.extensions,Array.isArray(t))for(n=0;n<t.length;++n)e.Extensions.apply(t[n],this,!1)},e.Block.prototype.jsonInitColour_=function(t,n){if("colour"in t)if(void 0===t.colour)console.warn(n+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch(o){console.warn(n+"Illegal colour value: ",t)}}},e.Block.prototype.jsonInitStyle_=function(t,n){t=t.style;try{this.setStyle(t)}catch(o){console.warn(n+"Style does not exist: ",t)}},e.Block.prototype.mixin=function(t,n){if(void 0!==n&&"boolean"!=typeof n)throw Error("opt_disableCheck must be a boolean if provided");if(!n){for(var o in n=[],t)void 0!==this[o]&&n.push(o);if(n.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(n))}e.utils.object.mixin(this,t)},e.Block.prototype.interpolate_=function(t,n,o,r){t=e.utils.tokenizeInterpolation(t),this.validateTokens_(t,n.length),n=this.interpolateArguments_(t,n,o),o=[],t=0;for(var a;a=n[t];t++)if(this.isInputKeyword_(a.type)){if(a=this.inputFromJson_(a,r)){for(var R,h=0;R=o[h];h++)a.appendField(R[0],R[1]);o.length=0}}else(h=this.fieldFromJson_(a))&&o.push([h,a.name])},e.Block.prototype.validateTokens_=function(t,n){for(var o=[],r=0,a=0;a<t.length;a++){var h=t[a];if("number"==typeof h){if(1>h||h>n)throw Error('Block "'+this.type+'": Message index %'+h+" out of range.");if(o[h])throw Error('Block "'+this.type+'": Message index %'+h+" duplicated.");o[h]=!0,r++}}if(r!=n)throw Error('Block "'+this.type+'": Message does not reference all '+n+" arg(s).")},e.Block.prototype.interpolateArguments_=function(t,n,o){for(var r=[],a=0;a<t.length;a++){var h=t[a];"number"==typeof h&&(h=n[h-1]),("string"!=typeof h||(h=this.stringToFieldJson_(h)))&&r.push(h)}return(t=r.length)&&!this.isInputKeyword_(r[t-1].type)&&(t={type:"input_dummy"},o&&(t.align=o),r.push(t)),r},e.Block.prototype.fieldFromJson_=function(t){var n=e.fieldRegistry.fromJson(t);return!n&&t.alt?"string"==typeof t.alt?(t=this.stringToFieldJson_(t.alt))?this.fieldFromJson_(t):null:this.fieldFromJson_(t.alt):n},e.Block.prototype.inputFromJson_=function(t,n){var o={LEFT:e.constants.ALIGN.LEFT,RIGHT:e.constants.ALIGN.RIGHT,CENTRE:e.constants.ALIGN.CENTRE,CENTER:e.constants.ALIGN.CENTRE},r=null;switch(t.type){case"input_value":r=this.appendValueInput(t.name);break;case"input_statement":r=this.appendStatementInput(t.name);break;case"input_dummy":r=this.appendDummyInput(t.name)}return r?(t.check&&r.setCheck(t.check),t.align&&(void 0===(o=o[t.align.toUpperCase()])?console.warn(n+"Illegal align value: ",t.align):r.setAlign(o)),r):null},e.Block.prototype.isInputKeyword_=function(t){return"input_value"==t||"input_statement"==t||"input_dummy"==t},e.Block.prototype.stringToFieldJson_=function(t){return(t=t.trim())?{type:"field_label",text:t}:null},e.Block.prototype.appendInput_=function(t,n){var o=null;return(t==e.inputTypes.VALUE||t==e.inputTypes.STATEMENT)&&(o=this.makeConnection_(t)),t==e.inputTypes.STATEMENT&&this.statementInputCount++,t=new e.Input(t,n,this,o),this.inputList.push(t),t},e.Block.prototype.moveInputBefore=function(t,n){if(t!=n){for(var h,o=-1,r=n?-1:this.inputList.length,a=0;h=this.inputList[a];a++)if(h.name==t){if(o=a,-1!=r)break}else if(n&&h.name==n&&(r=a,-1!=o))break;if(-1==o)throw Error('Named input "'+t+'" not found.');if(-1==r)throw Error('Reference input "'+n+'" not found.');this.moveNumberedInputBefore(o,r)}},e.Block.prototype.moveNumberedInputBefore=function(t,n){if(t==n)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(n>this.inputList.length)throw RangeError("Reference input "+n+" out of bounds.");var o=this.inputList[t];this.inputList.splice(t,1),t<n&&n--,this.inputList.splice(n,0,o)},e.Block.prototype.removeInput=function(t,n){for(var r,o=0;r=this.inputList[o];o++)if(r.name==t)return r.type==e.inputTypes.STATEMENT&&this.statementInputCount--,r.dispose(),this.inputList.splice(o,1),!0;if(n)return!1;throw Error("Input not found: "+t)},e.Block.prototype.getInput=function(t){for(var o,n=0;o=this.inputList[n];n++)if(o.name==t)return o;return null},e.Block.prototype.getInputTargetBlock=function(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()},e.Block.prototype.getCommentText=function(){return this.commentModel.text},e.Block.prototype.setCommentText=function(t){this.commentModel.text!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"comment",null,this.commentModel.text,t)),this.comment=this.commentModel.text=t)},e.Block.prototype.setWarningText=function(t,n){},e.Block.prototype.setMutator=function(t){},e.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},e.Block.prototype.moveBy=function(t,n){if(this.parentBlock_)throw Error("Block has parent.");var o=new(e.Events.get(e.Events.BLOCK_MOVE))(this);this.xy_.translate(t,n),o.recordNew(),e.Events.fire(o)},e.Block.prototype.makeConnection_=function(t){return new e.Connection(this,t)},e.Block.prototype.allInputsFilled=function(t){if(void 0===t&&(t=!0),!t&&this.isShadow())return!1;for(var o,n=0;o=this.inputList[n];n++)if(o.connection&&(!(o=o.connection.targetBlock())||!o.allInputsFilled(t)))return!1;return!(n=this.getNextBlock())||n.allInputsFilled(t)},e.Block.prototype.toDevString=function(){var t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t},e.blockRendering.IPathObject=function(t,n){},e.utils.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,FF_HASH:163,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},e.Menu=function(){this.menuItems_=[],this.roleName_=this.element_=this.onKeyDownHandler_=this.mouseLeaveHandler_=this.mouseEnterHandler_=this.clickHandler_=this.mouseOverHandler_=this.highlightedItem_=this.openingCoords=null},e.Menu.prototype.addChild=function(t){this.menuItems_.push(t)},e.Menu.prototype.render=function(t){var n=document.createElement("div");n.className="blocklyMenu goog-menu blocklyNonSelectable",n.tabIndex=0,this.roleName_&&e.utils.aria.setRole(n,this.roleName_),this.element_=n;for(var r,o=0;r=this.menuItems_[o];o++)n.appendChild(r.createDom());this.mouseOverHandler_=e.browserEvents.conditionalBind(n,"mouseover",this,this.handleMouseOver_,!0),this.clickHandler_=e.browserEvents.conditionalBind(n,"click",this,this.handleClick_,!0),this.mouseEnterHandler_=e.browserEvents.conditionalBind(n,"mouseenter",this,this.handleMouseEnter_,!0),this.mouseLeaveHandler_=e.browserEvents.conditionalBind(n,"mouseleave",this,this.handleMouseLeave_,!0),this.onKeyDownHandler_=e.browserEvents.conditionalBind(n,"keydown",this,this.handleKeyEvent_),t.appendChild(n)},e.Menu.prototype.getElement=function(){return this.element_},e.Menu.prototype.focus=function(){var t=this.getElement();t&&(t.focus({preventScroll:!0}),e.utils.dom.addClass(t,"blocklyFocused"))},e.Menu.prototype.blur_=function(){var t=this.getElement();t&&(t.blur(),e.utils.dom.removeClass(t,"blocklyFocused"))},e.Menu.prototype.setRole=function(t){this.roleName_=t},e.Menu.prototype.dispose=function(){this.mouseOverHandler_&&(e.browserEvents.unbind(this.mouseOverHandler_),this.mouseOverHandler_=null),this.clickHandler_&&(e.browserEvents.unbind(this.clickHandler_),this.clickHandler_=null),this.mouseEnterHandler_&&(e.browserEvents.unbind(this.mouseEnterHandler_),this.mouseEnterHandler_=null),this.mouseLeaveHandler_&&(e.browserEvents.unbind(this.mouseLeaveHandler_),this.mouseLeaveHandler_=null),this.onKeyDownHandler_&&(e.browserEvents.unbind(this.onKeyDownHandler_),this.onKeyDownHandler_=null);for(var n,t=0;n=this.menuItems_[t];t++)n.dispose();this.element_=null},e.Menu.prototype.getMenuItem_=function(t){for(var n=this.getElement();t&&t!=n;){if(e.utils.dom.hasClass(t,"blocklyMenuItem"))for(var r,o=0;r=this.menuItems_[o];o++)if(r.getElement()==t)return r;t=t.parentElement}return null},e.Menu.prototype.setHighlighted=function(t){var n=this.highlightedItem_;n&&(n.setHighlighted(!1),this.highlightedItem_=null),t&&(t.setHighlighted(!0),this.highlightedItem_=t,n=this.getElement(),e.utils.style.scrollIntoContainerView(t.getElement(),n),e.utils.aria.setState(n,e.utils.aria.State.ACTIVEDESCENDANT,t.getId()))},e.Menu.prototype.highlightNext=function(){var t=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(t,1)},e.Menu.prototype.highlightPrevious=function(){var t=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(0>t?this.menuItems_.length:t,-1)},e.Menu.prototype.highlightFirst_=function(){this.highlightHelper_(-1,1)},e.Menu.prototype.highlightLast_=function(){this.highlightHelper_(this.menuItems_.length,-1)},e.Menu.prototype.highlightHelper_=function(t,n){t+=n;for(var o;o=this.menuItems_[t];){if(o.isEnabled()){this.setHighlighted(o);break}t+=n}},e.Menu.prototype.handleMouseOver_=function(t){(t=this.getMenuItem_(t.target))&&(t.isEnabled()?this.highlightedItem_!=t&&this.setHighlighted(t):this.setHighlighted(null))},e.Menu.prototype.handleClick_=function(t){var n=this.openingCoords;if(this.openingCoords=null,n&&"number"==typeof t.clientX){var o=new e.utils.Coordinate(t.clientX,t.clientY);if(1>e.utils.Coordinate.distance(n,o))return}(t=this.getMenuItem_(t.target))&&t.performAction()},e.Menu.prototype.handleMouseEnter_=function(t){this.focus()},e.Menu.prototype.handleMouseLeave_=function(t){this.getElement()&&(this.blur_(),this.setHighlighted(null))},e.Menu.prototype.handleKeyEvent_=function(t){if(this.menuItems_.length&&!(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)){var n=this.highlightedItem_;switch(t.keyCode){case e.utils.KeyCodes.ENTER:case e.utils.KeyCodes.SPACE:n&&n.performAction();break;case e.utils.KeyCodes.UP:this.highlightPrevious();break;case e.utils.KeyCodes.DOWN:this.highlightNext();break;case e.utils.KeyCodes.PAGE_UP:case e.utils.KeyCodes.HOME:this.highlightFirst_();break;case e.utils.KeyCodes.PAGE_DOWN:case e.utils.KeyCodes.END:this.highlightLast_();break;default:return}t.preventDefault(),t.stopPropagation()}},e.Menu.prototype.getSize=function(){var t=this.getElement(),n=e.utils.style.getSize(t);return n.height=t.scrollHeight,n},e.MenuItem=function(t,n){this.content_=t,this.value_=n,this.enabled_=!0,this.element_=null,this.rightToLeft_=!1,this.roleName_=null,this.highlight_=this.checked_=this.checkable_=!1,this.actionHandler_=null},e.MenuItem.prototype.createDom=function(){var t=document.createElement("div");t.id=e.utils.IdGenerator.getNextUniqueId(),this.element_=t,t.className="blocklyMenuItem goog-menuitem "+(this.enabled_?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked_?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight_?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft_?"blocklyMenuItemRtl goog-menuitem-rtl ":"");var n=document.createElement("div");if(n.className="blocklyMenuItemContent goog-menuitem-content",this.checkable_){var o=document.createElement("div");o.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",n.appendChild(o)}return o=this.content_,"string"==typeof this.content_&&(o=document.createTextNode(this.content_)),n.appendChild(o),t.appendChild(n),this.roleName_&&e.utils.aria.setRole(t,this.roleName_),e.utils.aria.setState(t,e.utils.aria.State.SELECTED,this.checkable_&&this.checked_||!1),e.utils.aria.setState(t,e.utils.aria.State.DISABLED,!this.enabled_),t},e.MenuItem.prototype.dispose=function(){this.element_=null},e.MenuItem.prototype.getElement=function(){return this.element_},e.MenuItem.prototype.getId=function(){return this.element_.id},e.MenuItem.prototype.getValue=function(){return this.value_},e.MenuItem.prototype.setRightToLeft=function(t){this.rightToLeft_=t},e.MenuItem.prototype.setRole=function(t){this.roleName_=t},e.MenuItem.prototype.setCheckable=function(t){this.checkable_=t},e.MenuItem.prototype.setChecked=function(t){this.checked_=t},e.MenuItem.prototype.setHighlighted=function(t){this.highlight_=t;var n=this.getElement();n&&this.isEnabled()&&(t?(e.utils.dom.addClass(n,"blocklyMenuItemHighlight"),e.utils.dom.addClass(n,"goog-menuitem-highlight")):(e.utils.dom.removeClass(n,"blocklyMenuItemHighlight"),e.utils.dom.removeClass(n,"goog-menuitem-highlight")))},e.MenuItem.prototype.isEnabled=function(){return this.enabled_},e.MenuItem.prototype.setEnabled=function(t){this.enabled_=t},e.MenuItem.prototype.performAction=function(){this.isEnabled()&&this.actionHandler_&&this.actionHandler_(this)},e.MenuItem.prototype.onAction=function(t,n){this.actionHandler_=t.bind(n)},e.ContextMenu={},e.ContextMenu.currentBlock=null,e.ContextMenu.menu_=null,e.ContextMenu.show=function(t,n,o){if(e.WidgetDiv.show(e.ContextMenu,o,e.ContextMenu.dispose),n.length){var r=e.ContextMenu.populate_(n,o);e.ContextMenu.menu_=r,e.ContextMenu.position_(r,t,o),setTimeout(function(){r.focus()},1),e.ContextMenu.currentBlock=null}else e.ContextMenu.hide()},e.ContextMenu.populate_=function(t,n){var o=new e.Menu;o.setRole(e.utils.aria.Role.MENU);for(var a,r=0;a=t[r];r++){var h=new e.MenuItem(a.text);h.setRightToLeft(n),h.setRole(e.utils.aria.Role.MENUITEM),o.addChild(h),h.setEnabled(a.enabled),a.enabled&&h.onAction(function(R){e.ContextMenu.hide(),this.callback(this.scope)},a)}return o},e.ContextMenu.position_=function(t,n,o){var r=e.utils.getViewportBBox();n=new e.utils.Rect(n.clientY+r.top,n.clientY+r.top,n.clientX+r.left,n.clientX+r.left),e.ContextMenu.createWidget_(t);var a=t.getSize();o&&(n.left+=a.width,n.right+=a.width,r.left+=a.width,r.right+=a.width),e.WidgetDiv.positionWithAnchor(r,n,a,o),t.focus()},e.ContextMenu.createWidget_=function(t){t.render(e.WidgetDiv.DIV);var n=t.getElement();e.utils.dom.addClass(n,"blocklyContextMenu"),e.browserEvents.conditionalBind(n,"contextmenu",null,e.utils.noEvent),t.focus()},e.ContextMenu.hide=function(){e.WidgetDiv.hideIfOwner(e.ContextMenu),e.ContextMenu.currentBlock=null},e.ContextMenu.dispose=function(){e.ContextMenu.menu_&&(e.ContextMenu.menu_.dispose(),e.ContextMenu.menu_=null)},e.ContextMenu.callbackFactory=function(t,n){return function(){e.Events.disable();try{var o=e.Xml.domToBlock(n,t.workspace),r=t.getRelativeToSurfaceXY();r.x=t.RTL?r.x-e.SNAP_RADIUS:r.x+e.SNAP_RADIUS,r.y+=2*e.SNAP_RADIUS,o.moveBy(r.x,r.y)}finally{e.Events.enable()}e.Events.isEnabled()&&!o.isShadow()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(o)),o.select()}},e.ContextMenu.commentDeleteOption=function(t){return{text:e.Msg.REMOVE_COMMENT,enabled:!0,callback:function(){e.Events.setGroup(!0),t.dispose(!0,!0),e.Events.setGroup(!1)}}},e.ContextMenu.commentDuplicateOption=function(t){return{text:e.Msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){e.duplicate(t)}}},e.ContextMenu.workspaceCommentOption=function(t,n){if(!e.WorkspaceCommentSvg)throw Error("Missing require for Blockly.WorkspaceCommentSvg");var o={enabled:!e.utils.userAgent.IE};return o.text=e.Msg.ADD_COMMENT,o.callback=function(){var r=new e.WorkspaceCommentSvg(t,e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT,e.WorkspaceCommentSvg.DEFAULT_SIZE,e.WorkspaceCommentSvg.DEFAULT_SIZE),a=t.getInjectionDiv().getBoundingClientRect();a=new e.utils.Coordinate(n.clientX-a.left,n.clientY-a.top);var h=t.getOriginOffsetInPixels();(a=e.utils.Coordinate.difference(a,h)).scale(1/t.scale),r.moveBy(a.x,a.y),t.rendered&&(r.initSvg(),r.render(),r.select())},o},e.ContextMenuRegistry=function(){e.ContextMenuRegistry.registry=this,this.registry_=Object.create(null)},e.ContextMenuRegistry.ScopeType={BLOCK:"block",WORKSPACE:"workspace"},e.ContextMenuRegistry.registry=null,e.ContextMenuRegistry.prototype.register=function(t){if(this.registry_[t.id])throw Error('Menu item with ID "'+t.id+'" is already registered.');this.registry_[t.id]=t},e.ContextMenuRegistry.prototype.unregister=function(t){if(!this.registry_[t])throw Error('Menu item with ID "'+t+'" not found.');delete this.registry_[t]},e.ContextMenuRegistry.prototype.getItem=function(t){return this.registry_[t]||null},e.ContextMenuRegistry.prototype.getContextMenuOptions=function(t,n){var o=[],r=this.registry_;return Object.keys(r).forEach(function(a){if(t==(a=r[a]).scopeType){var h=a.preconditionFn(n);"hidden"!=h&&(a={text:"function"==typeof a.displayText?a.displayText(n):a.displayText,enabled:"enabled"==h,callback:a.callback,scope:n,weight:a.weight},o.push(a))}}),o.sort(function(a,h){return a.weight-h.weight}),o},new e.ContextMenuRegistry,e.Events.Selected=function(t,n,o){e.Events.Selected.superClass_.constructor.call(this,o),this.oldElementId=t,this.newElementId=n},e.utils.object.inherits(e.Events.Selected,e.Events.UiBase),e.Events.Selected.prototype.type=e.Events.SELECTED,e.Events.Selected.prototype.toJson=function(){var t=e.Events.Selected.superClass_.toJson.call(this);return t.oldElementId=this.oldElementId,t.newElementId=this.newElementId,t},e.Events.Selected.prototype.fromJson=function(t){e.Events.Selected.superClass_.fromJson.call(this,t),this.oldElementId=t.oldElementId,this.newElementId=t.newElementId},e.registry.register(e.registry.Type.EVENT,e.Events.SELECTED,e.Events.Selected),e.IBoundedElement=function(){},e.ICopyable=function(){},e.RenderedConnection=function(t,n){e.RenderedConnection.superClass_.constructor.call(this,t,n),this.db_=t.workspace.connectionDBList[n],this.dbOpposite_=t.workspace.connectionDBList[e.OPPOSITE_TYPE[n]],this.offsetInBlock_=new e.utils.Coordinate(0,0),this.trackedState_=e.RenderedConnection.TrackedState.WILL_TRACK,this.targetConnection=null},e.utils.object.inherits(e.RenderedConnection,e.Connection),e.RenderedConnection.TrackedState={WILL_TRACK:-1,UNTRACKED:0,TRACKED:1},e.RenderedConnection.prototype.dispose=function(){e.RenderedConnection.superClass_.dispose.call(this),this.trackedState_==e.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)},e.RenderedConnection.prototype.getSourceBlock=function(){return e.RenderedConnection.superClass_.getSourceBlock.call(this)},e.RenderedConnection.prototype.targetBlock=function(){return e.RenderedConnection.superClass_.targetBlock.call(this)},e.RenderedConnection.prototype.distanceFrom=function(t){var n=this.x-t.x;return t=this.y-t.y,Math.sqrt(n*n+t*t)},e.RenderedConnection.prototype.bumpAwayFrom=function(t){if(!this.sourceBlock_.workspace.isDragging()){var n=this.sourceBlock_.getRootBlock();if(!n.isInFlyout){var o=!1;if(!n.isMovable()){if(!(n=t.getSourceBlock().getRootBlock()).isMovable())return;t=this,o=!0}var r=e.selected==n;r||n.addSelect();var a=t.x+e.SNAP_RADIUS+Math.floor(Math.random()*e.BUMP_RANDOMNESS)-this.x,h=t.y+e.SNAP_RADIUS+Math.floor(Math.random()*e.BUMP_RANDOMNESS)-this.y;o&&(h=-h),n.RTL&&(a=t.x-e.SNAP_RADIUS-Math.floor(Math.random()*e.BUMP_RANDOMNESS)-this.x),n.moveBy(a,h),r||n.removeSelect()}}},e.RenderedConnection.prototype.moveTo=function(t,n){this.trackedState_==e.RenderedConnection.TrackedState.WILL_TRACK?(this.db_.addConnection(this,n),this.trackedState_=e.RenderedConnection.TrackedState.TRACKED):this.trackedState_==e.RenderedConnection.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,n)),this.x=t,this.y=n},e.RenderedConnection.prototype.moveBy=function(t,n){this.moveTo(this.x+t,this.y+n)},e.RenderedConnection.prototype.moveToOffset=function(t){this.moveTo(t.x+this.offsetInBlock_.x,t.y+this.offsetInBlock_.y)},e.RenderedConnection.prototype.setOffsetInBlock=function(t,n){this.offsetInBlock_.x=t,this.offsetInBlock_.y=n},e.RenderedConnection.prototype.getOffsetInBlock=function(){return this.offsetInBlock_},e.RenderedConnection.prototype.tighten=function(){var t=this.targetConnection.x-this.x,n=this.targetConnection.y-this.y;if(0!=t||0!=n){var o=this.targetBlock(),r=o.getSvgRoot();if(!r)throw Error("block is not rendered.");r=e.utils.getRelativeXY(r),o.getSvgRoot().setAttribute("transform","translate("+(r.x-t)+","+(r.y-n)+")"),o.moveConnections(-t,-n)}},e.RenderedConnection.prototype.closest=function(t,n){return this.dbOpposite_.searchForClosest(this,t,n)},e.RenderedConnection.prototype.highlight=function(){var t=this.sourceBlock_.workspace.getRenderer().getConstants(),n=t.shapeFor(this);n=this.type==e.connectionTypes.INPUT_VALUE||this.type==e.connectionTypes.OUTPUT_VALUE?e.utils.svgPaths.moveBy(0,-(t=t.TAB_OFFSET_FROM_TOP))+e.utils.svgPaths.lineOnAxis("v",t)+n.pathDown+e.utils.svgPaths.lineOnAxis("v",t):e.utils.svgPaths.moveBy(-(t=t.NOTCH_OFFSET_LEFT-t.CORNER_RADIUS),0)+e.utils.svgPaths.lineOnAxis("h",t)+n.pathLeft+e.utils.svgPaths.lineOnAxis("h",t),t=this.sourceBlock_.getRelativeToSurfaceXY(),e.Connection.highlightedPath_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyHighlightedConnectionPath",d:n,transform:"translate("+(this.x-t.x)+","+(this.y-t.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},e.RenderedConnection.prototype.unhighlight=function(){e.utils.dom.removeNode(e.Connection.highlightedPath_),delete e.Connection.highlightedPath_},e.RenderedConnection.prototype.setTracking=function(t){t&&this.trackedState_==e.RenderedConnection.TrackedState.TRACKED||!t&&this.trackedState_==e.RenderedConnection.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(t?(this.db_.addConnection(this,this.y),this.trackedState_=e.RenderedConnection.TrackedState.TRACKED):(this.trackedState_==e.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=e.RenderedConnection.TrackedState.UNTRACKED))},e.RenderedConnection.prototype.stopTrackingAll=function(){if(this.setTracking(!1),this.targetConnection)for(var t=this.targetBlock().getDescendants(!1),n=0;n<t.length;n++){for(var o=t[n],r=o.getConnections_(!0),a=0;a<r.length;a++)r[a].setTracking(!1);for(o=o.getIcons(),a=0;a<o.length;a++)o[a].setVisible(!1)}},e.RenderedConnection.prototype.startTrackingAll=function(){this.setTracking(!0);var t=[];if(this.type!=e.connectionTypes.INPUT_VALUE&&this.type!=e.connectionTypes.NEXT_STATEMENT)return t;var n=this.targetBlock();if(n){if(n.isCollapsed()){var o=[];n.outputConnection&&o.push(n.outputConnection),n.nextConnection&&o.push(n.nextConnection),n.previousConnection&&o.push(n.previousConnection)}else o=n.getConnections_(!0);for(var r=0;r<o.length;r++)t.push.apply(t,o[r].startTrackingAll());t.length||(t[0]=n)}return t},e.RenderedConnection.prototype.isConnectionAllowed=function(t,n){return e.utils.deprecation.warn("RenderedConnection.prototype.isConnectionAllowed","July 2020","July 2021","Blockly.Workspace.prototype.getConnectionChecker().canConnect"),!(this.distanceFrom(t)>n)&&e.RenderedConnection.superClass_.isConnectionAllowed.call(this,t)},e.RenderedConnection.prototype.onFailedConnect=function(t){var n=this.getSourceBlock();if(e.Events.recordUndo){var o=e.Events.getGroup();setTimeout(function(){n.isDisposed()||n.getParent()||(e.Events.setGroup(o),this.bumpAwayFrom(t),e.Events.setGroup(!1))}.bind(this),e.BUMP_DELAY)}},e.RenderedConnection.prototype.disconnectInternal_=function(t,n){e.RenderedConnection.superClass_.disconnectInternal_.call(this,t,n),t.rendered&&t.render(),n.rendered&&(n.updateDisabled(),n.render(),n.getSvgRoot().style.display="block")},e.RenderedConnection.prototype.respawnShadow_=function(){e.RenderedConnection.superClass_.respawnShadow_.call(this);var t=this.targetBlock();t&&(t.initSvg(),t.render(!1),(t=this.getSourceBlock()).rendered&&t.render())},e.RenderedConnection.prototype.neighbours=function(t){return this.dbOpposite_.getNeighbours(this,t)},e.RenderedConnection.prototype.connect_=function(t){e.RenderedConnection.superClass_.connect_.call(this,t);var n=this.getSourceBlock();t=t.getSourceBlock();var o=n.rendered,r=t.rendered;o&&n.updateDisabled(),r&&t.updateDisabled(),o&&r&&(this.type==e.connectionTypes.NEXT_STATEMENT||this.type==e.connectionTypes.PREVIOUS_STATEMENT?t.render():n.render()),(n=n.getInputWithBlock(t))&&(n=n.isVisible(),t.getSvgRoot().style.display=n?"block":"none")},e.RenderedConnection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())},e.BasicCursor=function(){e.BasicCursor.superClass_.constructor.call(this)},e.utils.object.inherits(e.BasicCursor,e.Cursor),e.BasicCursor.registrationName="basicCursor",e.BasicCursor.prototype.next=function(){var t=this.getCurNode();return t?((t=this.getNextNode_(t,this.validNode_))&&this.setCurNode(t),t):null},e.BasicCursor.prototype.in=function(){return this.next()},e.BasicCursor.prototype.prev=function(){var t=this.getCurNode();return t?((t=this.getPreviousNode_(t,this.validNode_))&&this.setCurNode(t),t):null},e.BasicCursor.prototype.out=function(){return this.prev()},e.BasicCursor.prototype.getNextNode_=function(t,n){if(!t)return null;var o=t.in()||t.next();return n(o)?o:o?this.getNextNode_(o,n):n(t=this.findSiblingOrParent_(t.out()))?t:t?this.getNextNode_(t,n):null},e.BasicCursor.prototype.getPreviousNode_=function(t,n){if(!t)return null;var o=t.prev();return n(o=o?this.getRightMostChild_(o):t.out())?o:o?this.getPreviousNode_(o,n):null},e.BasicCursor.prototype.validNode_=function(t){var n=!1;return((t=t&&t.getType())==e.ASTNode.types.OUTPUT||t==e.ASTNode.types.INPUT||t==e.ASTNode.types.FIELD||t==e.ASTNode.types.NEXT||t==e.ASTNode.types.PREVIOUS||t==e.ASTNode.types.WORKSPACE)&&(n=!0),n},e.BasicCursor.prototype.findSiblingOrParent_=function(t){return t?t.next()||this.findSiblingOrParent_(t.out()):null},e.BasicCursor.prototype.getRightMostChild_=function(t){if(!t.in())return t;for(t=t.in();t.next();)t=t.next();return this.getRightMostChild_(t)},e.registry.register(e.registry.Type.CURSOR,e.BasicCursor.registrationName,e.BasicCursor),e.TabNavigateCursor=function(){e.TabNavigateCursor.superClass_.constructor.call(this)},e.utils.object.inherits(e.TabNavigateCursor,e.BasicCursor),e.TabNavigateCursor.prototype.validNode_=function(t){var n=!1,o=t&&t.getType();return t&&(t=t.getLocation(),o==e.ASTNode.types.FIELD&&t&&t.isTabNavigable()&&t.isClickable()&&(n=!0)),n},e.BlockSvg=function(t,n,o){this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null),this.svgGroup_.translate_="",this.style=t.getRenderer().getConstants().getBlockStyle(null),this.pathObject=t.getRenderer().makePathObject(this.svgGroup_,this.style),this.renderIsInProgress_=this.rendered=!1,this.workspace=t,this.previousConnection=this.nextConnection=this.outputConnection=null,this.useDragSurface_=e.utils.is3dSupported()&&!!t.getBlockDragSurface();var r=this.pathObject.svgPath;r.tooltip=this,e.Tooltip.bindMouseEvents(r),e.BlockSvg.superClass_.constructor.call(this,t,n,o),this.svgGroup_.dataset?this.svgGroup_.dataset.id=this.id:e.utils.userAgent.IE&&this.svgGroup_.setAttribute("data-id",this.id)},e.utils.object.inherits(e.BlockSvg,e.Block),e.BlockSvg.prototype.height=0,e.BlockSvg.prototype.width=0,e.BlockSvg.prototype.warningTextDb_=null,e.BlockSvg.INLINE=-1,e.BlockSvg.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",e.BlockSvg.prototype.initSvg=function(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(var n,t=0;n=this.inputList[t];t++)n.init();for(n=this.getIcons(),t=0;t<n.length;t++)n[t].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),t=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!t||e.browserEvents.conditionalBind(t,"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,t.parentNode||this.workspace.getCanvas().appendChild(t)},e.BlockSvg.prototype.getColourSecondary=function(){return this.style.colourSecondary},e.BlockSvg.prototype.getColourTertiary=function(){return this.style.colourTertiary},e.BlockSvg.prototype.getColourShadow=function(){return e.utils.deprecation.warn("BlockSvg.prototype.getColourShadow","January 2020","January 2021","style.colourSecondary"),this.getColourSecondary()},e.BlockSvg.prototype.getColourBorder=function(){return e.utils.deprecation.warn("BlockSvg.prototype.getColourBorder","January 2020","January 2021","style.colourTertiary"),{colourBorder:this.getColourTertiary(),colourLight:null,colourDark:null}},e.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(e.selected!=this){var t=null;if(e.selected){t=e.selected.id,e.Events.disable();try{e.selected.unselect()}finally{e.Events.enable()}}t=new(e.Events.get(e.Events.SELECTED))(t,this.id,this.workspace.id),e.Events.fire(t),e.selected=this,this.addSelect()}},e.BlockSvg.prototype.unselect=function(){if(e.selected==this){var t=new(e.Events.get(e.Events.SELECTED))(this.id,null,this.workspace.id);t.workspaceId=this.workspace.id,e.Events.fire(t),e.selected=null,this.removeSelect()}},e.BlockSvg.prototype.mutator=null,e.BlockSvg.prototype.comment=null,e.BlockSvg.prototype.commentIcon_=null,e.BlockSvg.prototype.warning=null,e.BlockSvg.prototype.getIcons=function(){var t=[];return this.mutator&&t.push(this.mutator),this.commentIcon_&&t.push(this.commentIcon_),this.warning&&t.push(this.warning),t},e.BlockSvg.prototype.setParent=function(t){var n=this.parentBlock_;if(t!=n){e.utils.dom.startTextWidthCache(),e.BlockSvg.superClass_.setParent.call(this,t),e.utils.dom.stopTextWidthCache();var o=this.getSvgRoot();if(!this.workspace.isClearing&&o){var r=this.getRelativeToSurfaceXY();t?(t.getSvgRoot().appendChild(o),t=this.getRelativeToSurfaceXY(),this.moveConnections(t.x-r.x,t.y-r.y)):n&&(this.workspace.getCanvas().appendChild(o),this.translate(r.x,r.y)),this.applyColour()}}},e.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var t=0,n=0,o=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null,r=this.getSvgRoot();if(r)do{var a=e.utils.getRelativeXY(r);t+=a.x,n+=a.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()==r&&(t+=(a=this.workspace.getBlockDragSurface().getSurfaceTranslation()).x,n+=a.y),r=r.parentNode}while(r&&r!=this.workspace.getCanvas()&&r!=o);return new e.utils.Coordinate(t,n)},e.BlockSvg.prototype.moveBy=function(t,n){if(this.parentBlock_)throw Error("Block has parent.");var o=e.Events.isEnabled();if(o)var r=new(e.Events.get(e.Events.BLOCK_MOVE))(this);var a=this.getRelativeToSurfaceXY();this.translate(a.x+t,a.y+n),this.moveConnections(t,n),o&&(r.recordNew(),e.Events.fire(r)),this.workspace.resizeContents()},e.BlockSvg.prototype.translate=function(t,n){this.getSvgRoot().setAttribute("transform","translate("+t+","+n+")")},e.BlockSvg.prototype.moveToDragSurface=function(){if(this.useDragSurface_){var t=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(t.x,t.y),(t=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(t)}},e.BlockSvg.prototype.moveTo=function(t){var n=this.getRelativeToSurfaceXY();this.moveBy(t.x-n.x,t.y-n.y)},e.BlockSvg.prototype.moveOffDragSurface=function(t){this.useDragSurface_&&(this.translate(t.x,t.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))},e.BlockSvg.prototype.moveDuringDrag=function(t){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},e.BlockSvg.prototype.clearTransformAttributes_=function(){this.getSvgRoot().removeAttribute("transform")},e.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var t=this.workspace.getGrid();if(t&&t.shouldSnap()){var n=t.getSpacing(),o=n/2,r=this.getRelativeToSurfaceXY();t=Math.round((r.x-o)/n)*n+o-r.x,n=Math.round((r.y-o)/n)*n+o-r.y,t=Math.round(t),n=Math.round(n),0==t&&0==n||this.moveBy(t,n)}}},e.BlockSvg.prototype.getBoundingRectangle=function(){var t=this.getRelativeToSurfaceXY(),n=this.getHeightWidth();if(this.RTL)var o=t.x-n.width,r=t.x;else o=t.x,r=t.x+n.width;return new e.utils.Rect(t.y,t.y+n.height,o,r)},e.BlockSvg.prototype.markDirty=function(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(var n,t=0;n=this.inputList[t];t++)n.markDirty()},e.BlockSvg.prototype.setCollapsed=function(t){this.collapsed_!=t&&(e.BlockSvg.superClass_.setCollapsed.call(this,t),t?this.rendered&&this.render():this.updateCollapsed_())},e.BlockSvg.prototype.updateCollapsed_=function(){for(var a,t=this.isCollapsed(),n=e.constants.COLLAPSED_INPUT_NAME,o=e.constants.COLLAPSED_FIELD_NAME,r=0;a=this.inputList[r];r++)a.name!=n&&a.setVisible(!t);if(t){for(a=this.getIcons(),r=0;t=a[r];r++)t.setVisible(!1);r=this.toString(e.COLLAPSE_CHARS),(a=this.getField(o))?a.setValue(r):(a=this.getInput(n)||this.appendDummyInput(n)).appendField(new e.FieldLabel(r),o)}else this.updateDisabled(),this.removeInput(n)},e.BlockSvg.prototype.tab=function(t,n){var o=new e.TabNavigateCursor;o.setCurNode(e.ASTNode.createFieldNode(t)),t=o.getCurNode(),n?o.next():o.prev(),(n=o.getCurNode())&&n!==t&&(n.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(n))},e.BlockSvg.prototype.onMouseDown_=function(t){var n=this.workspace&&this.workspace.getGesture(t);n&&n.handleBlockStart(t,this)},e.BlockSvg.prototype.showHelp=function(){var t="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;t&&window.open(t)},e.BlockSvg.prototype.generateContextMenu=function(){if(this.workspace.options.readOnly||!this.contextMenu)return null;var t=e.ContextMenuRegistry.registry.getContextMenuOptions(e.ContextMenuRegistry.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(t),t},e.BlockSvg.prototype.showContextMenu=function(t){var n=this.generateContextMenu();n&&n.length&&(e.ContextMenu.show(t,n,this.RTL),e.ContextMenu.currentBlock=this)},e.BlockSvg.prototype.moveConnections=function(t,n){if(this.rendered){for(var o=this.getConnections_(!1),r=0;r<o.length;r++)o[r].moveBy(t,n);for(o=this.getIcons(),r=0;r<o.length;r++)o[r].computeIconLocation();for(r=0;r<this.childBlocks_.length;r++)this.childBlocks_[r].moveConnections(t,n)}},e.BlockSvg.prototype.setDragging=function(t){if(t){var n=this.getSvgRoot();n.translate_="",n.skew_="",e.draggingConnections=e.draggingConnections.concat(this.getConnections_(!0)),e.utils.dom.addClass(this.svgGroup_,"blocklyDragging")}else e.draggingConnections=[],e.utils.dom.removeClass(this.svgGroup_,"blocklyDragging");for(n=0;n<this.childBlocks_.length;n++)this.childBlocks_[n].setDragging(t)},e.BlockSvg.prototype.setMovable=function(t){e.BlockSvg.superClass_.setMovable.call(this,t),this.pathObject.updateMovable(t)},e.BlockSvg.prototype.setEditable=function(t){e.BlockSvg.superClass_.setEditable.call(this,t),t=this.getIcons();for(var n=0;n<t.length;n++)t[n].updateEditable()},e.BlockSvg.prototype.setShadow=function(t){e.BlockSvg.superClass_.setShadow.call(this,t),this.applyColour()},e.BlockSvg.prototype.setInsertionMarker=function(t){this.isInsertionMarker_!=t&&(this.isInsertionMarker_=t)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))},e.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},e.BlockSvg.prototype.dispose=function(t,n){if(this.workspace){e.Tooltip.dispose(),e.Tooltip.unbindMouseEvents(this.pathObject.svgPath),e.utils.dom.startTextWidthCache();var o=this.workspace;if(e.selected==this&&(this.unselect(),this.workspace.cancelCurrentGesture()),e.ContextMenu.currentBlock==this&&e.ContextMenu.hide(),n&&this.rendered&&(this.unplug(t),e.blockAnimations.disposeUiEffect(this)),this.rendered=!1,this.warningTextDb_){for(var r in this.warningTextDb_)clearTimeout(this.warningTextDb_[r]);this.warningTextDb_=null}for(n=this.getIcons(),r=0;r<n.length;r++)n[r].dispose();e.BlockSvg.superClass_.dispose.call(this,!!t),e.utils.dom.removeNode(this.svgGroup_),o.resizeContents(),this.svgGroup_=null,e.utils.dom.stopTextWidthCache()}},e.BlockSvg.prototype.toCopyData=function(){if(this.isInsertionMarker_)return null;var t=e.Xml.blockToDom(this,!0);e.Xml.deleteNext(t);var n=this.getRelativeToSurfaceXY();return t.setAttribute("x",this.RTL?-n.x:n.x),t.setAttribute("y",n.y),{xml:t,source:this.workspace,typeCounts:e.utils.getBlockTypeCounts(this,!0)}},e.BlockSvg.prototype.applyColour=function(){this.pathObject.applyColour(this);for(var t=this.getIcons(),n=0;n<t.length;n++)t[n].applyColour();for(t=0;n=this.inputList[t];t++)for(var r,o=0;r=n.fieldRow[o];o++)r.applyColour()},e.BlockSvg.prototype.updateDisabled=function(){var t=this.getChildren(!1);if(this.applyColour(),!this.isCollapsed())for(var o,n=0;o=t[n];n++)o.rendered&&o.updateDisabled()},e.BlockSvg.prototype.getCommentIcon=function(){return this.commentIcon_},e.BlockSvg.prototype.setCommentText=function(t){if(!e.Comment)throw Error("Missing require for Blockly.Comment");this.commentModel.text!=t&&(e.BlockSvg.superClass_.setCommentText.call(this,t),!!this.commentIcon_==(t=null!=t)?this.commentIcon_.updateText():(t?this.comment=this.commentIcon_=new e.Comment(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))},e.BlockSvg.prototype.setWarningText=function(t,n){if(!e.Warning)throw Error("Missing require for Blockly.Warning");this.warningTextDb_||(this.warningTextDb_=Object.create(null));var o=n||"";if(o)this.warningTextDb_[o]&&(clearTimeout(this.warningTextDb_[o]),delete this.warningTextDb_[o]);else for(var r in this.warningTextDb_)clearTimeout(this.warningTextDb_[r]),delete this.warningTextDb_[r];if(this.workspace.isDragging()){var a=this;this.warningTextDb_[o]=setTimeout(function(){a.workspace&&(delete a.warningTextDb_[o],a.setWarningText(t,o))},100)}else{if(this.isInFlyout&&(t=null),n=!1,"string"==typeof t){r=this.getSurroundParent();for(var h=null;r;)r.isCollapsed()&&(h=r),r=r.getSurroundParent();h&&h.setWarningText(e.Msg.COLLAPSED_WARNINGS_WARNING,e.BlockSvg.COLLAPSED_WARNING_ID),this.warning||(this.warning=new e.Warning(this),n=!0),this.warning.setText(t,o)}else this.warning&&!o?(this.warning.dispose(),n=!0):this.warning&&(n=this.warning.getText(),this.warning.setText("",o),(r=this.warning.getText())||this.warning.dispose(),n=n!=r);n&&this.rendered&&(this.render(),this.bumpNeighbours())}},e.BlockSvg.prototype.setMutator=function(t){this.mutator&&this.mutator!==t&&this.mutator.dispose(),t&&(t.setBlock(this),this.mutator=t,t.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setEnabled=function(t){this.isEnabled()!=t&&(e.BlockSvg.superClass_.setEnabled.call(this,t),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())},e.BlockSvg.prototype.setHighlighted=function(t){this.rendered&&this.pathObject.updateHighlighted(t)},e.BlockSvg.prototype.addSelect=function(){this.pathObject.updateSelected(!0)},e.BlockSvg.prototype.removeSelect=function(){this.pathObject.updateSelected(!1)},e.BlockSvg.prototype.setDeleteStyle=function(t){this.pathObject.updateDraggingDelete(t)},e.BlockSvg.prototype.getColour=function(){return this.style.colourPrimary},e.BlockSvg.prototype.setColour=function(t){e.BlockSvg.superClass_.setColour.call(this,t),t=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(t.style),this.style=t.style,this.styleName_=t.name,this.applyColour()},e.BlockSvg.prototype.setStyle=function(t){var n=this.workspace.getRenderer().getConstants().getBlockStyle(t);if(this.styleName_=t,!n)throw Error("Invalid style name: "+t);this.hat=n.hat,this.pathObject.setStyle(n),this.colour_=n.colourPrimary,this.style=n,this.applyColour()},e.BlockSvg.prototype.bringToFront=function(){var t=this;do{var n=t.getSvgRoot(),o=n.parentNode,r=o.childNodes;r[r.length-1]!==n&&o.appendChild(n),t=t.getParent()}while(t)},e.BlockSvg.prototype.setPreviousStatement=function(t,n){e.BlockSvg.superClass_.setPreviousStatement.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setNextStatement=function(t,n){e.BlockSvg.superClass_.setNextStatement.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setOutput=function(t,n){e.BlockSvg.superClass_.setOutput.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setInputsInline=function(t){e.BlockSvg.superClass_.setInputsInline.call(this,t),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.removeInput=function(t,n){return t=e.BlockSvg.superClass_.removeInput.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours()),t},e.BlockSvg.prototype.moveNumberedInputBefore=function(t,n){e.BlockSvg.superClass_.moveNumberedInputBefore.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.appendInput_=function(t,n){return t=e.BlockSvg.superClass_.appendInput_.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours()),t},e.BlockSvg.prototype.setConnectionTracking=function(t){if(this.previousConnection&&this.previousConnection.setTracking(t),this.outputConnection&&this.outputConnection.setTracking(t),this.nextConnection){this.nextConnection.setTracking(t);var n=this.nextConnection.targetBlock();n&&n.setConnectionTracking(t)}if(!this.collapsed_)for(n=0;n<this.inputList.length;n++){var o=this.inputList[n].connection;o&&(o.setTracking(t),(o=o.targetBlock())&&o.setConnectionTracking(t))}},e.BlockSvg.prototype.getConnections_=function(t){var n=[];if((t||this.rendered)&&(this.outputConnection&&n.push(this.outputConnection),this.previousConnection&&n.push(this.previousConnection),this.nextConnection&&n.push(this.nextConnection),t||!this.collapsed_)){t=0;for(var o;o=this.inputList[t];t++)o.connection&&n.push(o.connection)}return n},e.BlockSvg.prototype.lastConnectionInStack=function(t){return e.BlockSvg.superClass_.lastConnectionInStack.call(this,t)},e.BlockSvg.prototype.getMatchingConnection=function(t,n){return e.BlockSvg.superClass_.getMatchingConnection.call(this,t,n)},e.BlockSvg.prototype.makeConnection_=function(t){return new e.RenderedConnection(this,t)},e.BlockSvg.prototype.bumpNeighbours=function(){if(this.workspace&&!this.workspace.isDragging()){var t=this.getRootBlock();if(!t.isInFlyout)for(var r,n=this.getConnections_(!1),o=0;r=n[o];o++){r.isConnected()&&r.isSuperior()&&r.targetBlock().bumpNeighbours();for(var R,a=r.neighbours(e.SNAP_RADIUS),h=0;R=a[h];h++)r.isConnected()&&R.isConnected()||R.getSourceBlock().getRootBlock()!=t&&(r.isSuperior()?R.bumpAwayFrom(r):r.bumpAwayFrom(R))}}},e.BlockSvg.prototype.scheduleSnapAndBump=function(){var t=this,n=e.Events.getGroup();setTimeout(function(){e.Events.setGroup(n),t.snapToGrid(),e.Events.setGroup(!1)},e.BUMP_DELAY/2),setTimeout(function(){e.Events.setGroup(n),t.bumpNeighbours(),e.Events.setGroup(!1)},e.BUMP_DELAY)},e.BlockSvg.prototype.positionNearConnection=function(t,n){t.type!=e.connectionTypes.NEXT_STATEMENT&&t.type!=e.connectionTypes.INPUT_VALUE||this.moveBy(n.x-t.x,n.y-t.y)},e.BlockSvg.prototype.getParent=function(){return e.BlockSvg.superClass_.getParent.call(this)},e.BlockSvg.prototype.getRootBlock=function(){return e.BlockSvg.superClass_.getRootBlock.call(this)},e.BlockSvg.prototype.render=function(t){if(!this.renderIsInProgress_){this.renderIsInProgress_=!0;try{if(this.rendered=!0,e.utils.dom.startTextWidthCache(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),!1!==t){var n=this.getParent();n?n.render(!0):this.workspace.resizeContents()}e.utils.dom.stopTextWidthCache(),this.updateMarkers_()}finally{this.renderIsInProgress_=!1}}},e.BlockSvg.prototype.updateMarkers_=function(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(e.MarkerManager.LOCAL_MARKER).draw()},e.BlockSvg.prototype.updateConnectionLocations_=function(){var t=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(t),this.outputConnection&&this.outputConnection.moveToOffset(t);for(var n=0;n<this.inputList.length;n++){var o=this.inputList[n].connection;o&&(o.moveToOffset(t),o.isConnected()&&o.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(t),this.nextConnection.isConnected()&&this.nextConnection.tighten())},e.BlockSvg.prototype.setCursorSvg=function(t){this.pathObject.setCursorSvg(t)},e.BlockSvg.prototype.setMarkerSvg=function(t){this.pathObject.setMarkerSvg(t)},e.BlockSvg.prototype.getHeightWidth=function(){var t=this.height,n=this.width,o=this.getNextBlock();if(o){o=o.getHeightWidth();var r=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;t+=o.height-r,n=Math.max(n,o.width)}return{height:t,width:n}},e.BlockSvg.prototype.fadeForReplacement=function(t){this.pathObject.updateReplacementFade(t)},e.BlockSvg.prototype.highlightShapeForInput=function(t,n){this.pathObject.updateShapeForInputHighlight(t,n)},e.ConnectionDB=function(t){this.connections_=[],this.connectionChecker_=t},e.ConnectionDB.prototype.addConnection=function(t,n){n=this.calculateIndexForYPos_(n),this.connections_.splice(n,0,t)},e.ConnectionDB.prototype.findIndexOfConnection_=function(t,n){if(!this.connections_.length)return-1;var o=this.calculateIndexForYPos_(n);if(o>=this.connections_.length)return-1;n=t.y;for(var r=o;0<=r&&this.connections_[r].y==n;){if(this.connections_[r]==t)return r;r--}for(r=o;r<this.connections_.length&&this.connections_[r].y==n;){if(this.connections_[r]==t)return r;r++}return-1},e.ConnectionDB.prototype.calculateIndexForYPos_=function(t){if(!this.connections_.length)return 0;for(var n=0,o=this.connections_.length;n<o;){var r=Math.floor((n+o)/2);if(this.connections_[r].y<t)n=r+1;else{if(!(this.connections_[r].y>t)){n=r;break}o=r}}return n},e.ConnectionDB.prototype.removeConnection=function(t,n){if(-1==(t=this.findIndexOfConnection_(t,n)))throw Error("Unable to find connection in connectionDB.");this.connections_.splice(t,1)},e.ConnectionDB.prototype.getNeighbours=function(t,n){function o(nt){var et=a-r[nt].x,Et=h-r[nt].y;return Math.sqrt(et*et+Et*Et)<=n&&W.push(r[nt]),Et<n}var r=this.connections_,a=t.x,h=t.y;t=0;for(var R=r.length-2,L=R;t<L;)r[L].y<h?t=L:R=L,L=Math.floor((t+R)/2);var W=[];if(R=t=L,r.length){for(;0<=t&&o(t);)t--;do{R++}while(R<r.length&&o(R))}return W},e.ConnectionDB.prototype.isInYRange_=function(t,n,o){return Math.abs(this.connections_[t].y-n)<=o},e.ConnectionDB.prototype.searchForClosest=function(t,n,o){if(!this.connections_.length)return{connection:null,radius:n};var r=t.y,a=t.x;t.x=a+o.x,t.y=r+o.y;var h=this.calculateIndexForYPos_(t.y);o=null;for(var L,R=n,W=h-1;0<=W&&this.isInYRange_(W,t.y,n);)this.connectionChecker_.canConnect(t,L=this.connections_[W],!0,R)&&(o=L,R=L.distanceFrom(t)),W--;for(;h<this.connections_.length&&this.isInYRange_(h,t.y,n);)this.connectionChecker_.canConnect(t,L=this.connections_[h],!0,R)&&(o=L,R=L.distanceFrom(t)),h++;return t.x=a,t.y=r,{connection:o,radius:R}},e.ConnectionDB.init=function(t){var n=[];return n[e.connectionTypes.INPUT_VALUE]=new e.ConnectionDB(t),n[e.connectionTypes.OUTPUT_VALUE]=new e.ConnectionDB(t),n[e.connectionTypes.NEXT_STATEMENT]=new e.ConnectionDB(t),n[e.connectionTypes.PREVIOUS_STATEMENT]=new e.ConnectionDB(t),n},e.Events.ThemeChange=function(t,n){e.Events.ThemeChange.superClass_.constructor.call(this,n),this.themeName=t},e.utils.object.inherits(e.Events.ThemeChange,e.Events.UiBase),e.Events.ThemeChange.prototype.type=e.Events.THEME_CHANGE,e.Events.ThemeChange.prototype.toJson=function(){var t=e.Events.ThemeChange.superClass_.toJson.call(this);return t.themeName=this.themeName,t},e.Events.ThemeChange.prototype.fromJson=function(t){e.Events.ThemeChange.superClass_.fromJson.call(this,t),this.themeName=t.themeName},e.registry.register(e.registry.Type.EVENT,e.Events.THEME_CHANGE,e.Events.ThemeChange),e.Events.ViewportChange=function(t,n,o,r,a){e.Events.ViewportChange.superClass_.constructor.call(this,r),this.viewTop=t,this.viewLeft=n,this.scale=o,this.oldScale=a},e.utils.object.inherits(e.Events.ViewportChange,e.Events.UiBase),e.Events.ViewportChange.prototype.type=e.Events.VIEWPORT_CHANGE,e.Events.ViewportChange.prototype.toJson=function(){var t=e.Events.ViewportChange.superClass_.toJson.call(this);return t.viewTop=this.viewTop,t.viewLeft=this.viewLeft,t.scale=this.scale,t.oldScale=this.oldScale,t},e.Events.ViewportChange.prototype.fromJson=function(t){e.Events.ViewportChange.superClass_.fromJson.call(this,t),this.viewTop=t.viewTop,this.viewLeft=t.viewLeft,this.scale=t.scale,this.oldScale=t.oldScale},e.registry.register(e.registry.Type.EVENT,e.Events.VIEWPORT_CHANGE,e.Events.ViewportChange),e.IMetricsManager=function(){},e.MetricsManager=function(t){this.workspace_=t},e.MetricsManager.prototype.getDimensionsPx_=function(t){var n=0,o=0;return t&&(n=t.getWidth(),o=t.getHeight()),new e.utils.Size(n,o)},e.MetricsManager.prototype.getFlyoutMetrics=function(t){return{width:(t=this.getDimensionsPx_(this.workspace_.getFlyout(t))).width,height:t.height,position:this.workspace_.toolboxPosition}},e.MetricsManager.prototype.getToolboxMetrics=function(){var t=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}},e.MetricsManager.prototype.getSvgMetrics=function(){return this.workspace_.getCachedParentSvgSize()},e.MetricsManager.prototype.getAbsoluteMetrics=function(){var t=0,n=this.getToolboxMetrics(),o=this.getFlyoutMetrics(!0),r=!!this.workspace_.getToolbox(),a=!!this.workspace_.getFlyout(!0),h=r?n.position:o.position,R=h==e.utils.toolbox.Position.LEFT;return h=h==e.utils.toolbox.Position.TOP,r&&R?t=n.width:a&&R&&(t=o.width),R=0,r&&h?R=n.height:a&&h&&(R=o.height),{top:R,left:t}},e.MetricsManager.prototype.getViewMetrics=function(t){t=t?this.workspace_.scale:1;var n=this.getSvgMetrics(),o=this.getToolboxMetrics(),r=this.getFlyoutMetrics(!0),a=this.workspace_.getToolbox()?o.position:r.position;return this.workspace_.getToolbox()?a==e.utils.toolbox.Position.TOP||a==e.utils.toolbox.Position.BOTTOM?n.height-=o.height:(a==e.utils.toolbox.Position.LEFT||a==e.utils.toolbox.Position.RIGHT)&&(n.width-=o.width):this.workspace_.getFlyout(!0)&&(a==e.utils.toolbox.Position.TOP||a==e.utils.toolbox.Position.BOTTOM?n.height-=r.height:(a==e.utils.toolbox.Position.LEFT||a==e.utils.toolbox.Position.RIGHT)&&(n.width-=r.width)),{height:n.height/t,width:n.width/t,top:-this.workspace_.scrollY/t,left:-this.workspace_.scrollX/t}},e.MetricsManager.prototype.getContentMetrics=function(t){t=t?1:this.workspace_.scale;var n=this.workspace_.getBlocksBoundingBox();return{height:(n.bottom-n.top)*t,width:(n.right-n.left)*t,top:n.top*t,left:n.left*t}},e.MetricsManager.prototype.hasFixedEdges=function(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()},e.MetricsManager.prototype.getComputedFixedEdges_=function(t){if(!this.hasFixedEdges())return{};var n=this.workspace_.isMovableHorizontally(),o=this.workspace_.isMovableVertically();t=t||this.getViewMetrics(!1);var r={};return o||(r.top=t.top,r.bottom=t.top+t.height),n||(r.left=t.left,r.right=t.left+t.width),r},e.MetricsManager.prototype.getPaddedContent_=function(t,n){var o=n.top+n.height,r=n.left+n.width,a=t.width,h=a/2,R=(t=t.height)/2;return{top:Math.min(n.top-R,o-t),bottom:Math.max(o+R,n.top+t),left:Math.min(n.left-h,r-a),right:Math.max(r+h,n.left+a)}},e.MetricsManager.prototype.getScrollMetrics=function(t,n,o){t=t?this.workspace_.scale:1,n=n||this.getViewMetrics(!1);var r=o||this.getContentMetrics();o=this.getComputedFixedEdges_(n),n=this.getPaddedContent_(n,r);var a=void 0!==o.left?o.left:n.left;return{top:(r=void 0!==o.top?o.top:n.top)/t,left:a/t,width:((void 0!==o.right?o.right:n.right)-a)/t,height:((void 0!==o.bottom?o.bottom:n.bottom)-r)/t}},e.MetricsManager.prototype.getUiMetrics=function(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}},e.MetricsManager.prototype.getMetrics=function(){var t=this.getToolboxMetrics(),n=this.getFlyoutMetrics(!0),o=this.getSvgMetrics(),r=this.getAbsoluteMetrics(),a=this.getViewMetrics(),h=this.getContentMetrics(),R=this.getScrollMetrics(!1,a,h);return{contentHeight:h.height,contentWidth:h.width,contentTop:h.top,contentLeft:h.left,scrollHeight:R.height,scrollWidth:R.width,scrollTop:R.top,scrollLeft:R.left,viewHeight:a.height,viewWidth:a.width,viewTop:a.top,viewLeft:a.left,absoluteTop:r.top,absoluteLeft:r.left,svgHeight:o.height,svgWidth:o.width,toolboxWidth:t.width,toolboxHeight:t.height,toolboxPosition:t.position,flyoutWidth:n.width,flyoutHeight:n.height}},e.registry.register(e.registry.Type.METRICS_MANAGER,e.registry.DEFAULT,e.MetricsManager),e.FlyoutMetricsManager=function(t,n){this.flyout_=n,e.FlyoutMetricsManager.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.FlyoutMetricsManager,e.MetricsManager),e.FlyoutMetricsManager.prototype.getBoundingBox_=function(){try{var t=this.workspace_.getCanvas().getBBox()}catch(n){t={height:0,y:0,width:0,x:0}}return t},e.FlyoutMetricsManager.prototype.getContentMetrics=function(t){var n=this.getBoundingBox_();return{height:n.height*(t=t?1:this.workspace_.scale),width:n.width*t,top:n.y*t,left:n.x*t}},e.FlyoutMetricsManager.prototype.getScrollMetrics=function(t,n,o){return{height:((n=o||this.getContentMetrics()).height+2*(o=this.flyout_.MARGIN*this.workspace_.scale))/(t=t?this.workspace_.scale:1),width:(n.width+n.left+o)/t,top:0,left:0}},e.ThemeManager=function(t,n){this.workspace_=t,this.theme_=n,this.subscribedWorkspaces_=[],this.componentDB_=Object.create(null)},e.ThemeManager.prototype.getTheme=function(){return this.theme_},e.ThemeManager.prototype.setTheme=function(t){var o,n=this.theme_;for(this.theme_=t,(t=this.workspace_.getInjectionDiv())&&(n&&e.utils.dom.removeClass(t,n.getClassName()),e.utils.dom.addClass(t,this.theme_.getClassName())),n=0;t=this.subscribedWorkspaces_[n];n++)t.refreshTheme();for(n=0,t=Object.keys(this.componentDB_);o=t[n];n++)for(var a,r=0;a=this.componentDB_[o][r];r++){var h=a.element;a=a.propertyName;var R=this.theme_&&this.theme_.getComponentStyle(o);h.style[a]=R||""}e.hideChaff()},e.ThemeManager.prototype.subscribeWorkspace=function(t){this.subscribedWorkspaces_.push(t)},e.ThemeManager.prototype.unsubscribeWorkspace=function(t){if(0>(t=this.subscribedWorkspaces_.indexOf(t)))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.");this.subscribedWorkspaces_.splice(t,1)},e.ThemeManager.prototype.subscribe=function(t,n,o){this.componentDB_[n]||(this.componentDB_[n]=[]),this.componentDB_[n].push({element:t,propertyName:o}),n=this.theme_&&this.theme_.getComponentStyle(n),t.style[o]=n||""},e.ThemeManager.prototype.unsubscribe=function(t){if(t)for(var r,n=Object.keys(this.componentDB_),o=0;r=n[o];o++){for(var a=this.componentDB_[r],h=a.length-1;0<=h;h--)a[h].element===t&&a.splice(h,1);this.componentDB_[r].length||delete this.componentDB_[r]}},e.ThemeManager.prototype.dispose=function(){this.componentDB_=this.subscribedWorkspaces_=this.theme_=this.owner_=null},e.TouchGesture=function(t,n){e.TouchGesture.superClass_.constructor.call(this,t,n),this.isMultiTouch_=!1,this.cachedPoints_=Object.create(null),this.startDistance_=this.previousScale_=0,this.isPinchZoomEnabled_=this.onStartWrapper_=null},e.utils.object.inherits(e.TouchGesture,e.Gesture),e.TouchGesture.ZOOM_IN_MULTIPLIER=5,e.TouchGesture.ZOOM_OUT_MULTIPLIER=6,e.TouchGesture.prototype.doStart=function(t){this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,e.TouchGesture.superClass_.doStart.call(this,t),!this.isEnding_&&e.Touch.isTouchEvent(t)&&this.handleTouchStart(t)},e.TouchGesture.prototype.bindMouseEvents=function(t){this.onStartWrapper_=e.browserEvents.conditionalBind(document,"mousedown",null,this.handleStart.bind(this),!0),this.onMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",null,this.handleMove.bind(this),!0),this.onUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",null,this.handleUp.bind(this),!0),t.preventDefault(),t.stopPropagation()},e.TouchGesture.prototype.handleStart=function(t){!this.isDragging()&&e.Touch.isTouchEvent(t)&&(this.handleTouchStart(t),this.isMultiTouch()&&e.longStop_())},e.TouchGesture.prototype.handleMove=function(t){this.isDragging()?e.Touch.shouldHandleEvent(t)&&e.TouchGesture.superClass_.handleMove.call(this,t):this.isMultiTouch()?(e.Touch.isTouchEvent(t)&&this.handleTouchMove(t),e.longStop_()):e.TouchGesture.superClass_.handleMove.call(this,t)},e.TouchGesture.prototype.handleUp=function(t){e.Touch.isTouchEvent(t)&&!this.isDragging()&&this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()?e.Touch.shouldHandleEvent(t)&&e.TouchGesture.superClass_.handleUp.call(this,t):(t.preventDefault(),t.stopPropagation(),this.dispose())},e.TouchGesture.prototype.isMultiTouch=function(){return this.isMultiTouch_},e.TouchGesture.prototype.dispose=function(){e.TouchGesture.superClass_.dispose.call(this),this.onStartWrapper_&&e.browserEvents.unbind(this.onStartWrapper_)},e.TouchGesture.prototype.handleTouchStart=function(t){var n=e.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[n]=this.getTouchPoint(t),2==(n=Object.keys(this.cachedPoints_)).length&&(this.startDistance_=e.utils.Coordinate.distance(this.cachedPoints_[n[0]],this.cachedPoints_[n[1]]),this.isMultiTouch_=!0,t.preventDefault())},e.TouchGesture.prototype.handleTouchMove=function(t){var n=e.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[n]=this.getTouchPoint(t),n=Object.keys(this.cachedPoints_),this.isPinchZoomEnabled_&&2===n.length?this.handlePinch_(t):e.TouchGesture.superClass_.handleMove.call(this,t)},e.TouchGesture.prototype.handlePinch_=function(t){var n=Object.keys(this.cachedPoints_);if(n=e.utils.Coordinate.distance(this.cachedPoints_[n[0]],this.cachedPoints_[n[1]])/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){var o=n-this.previousScale_;o=0<o?o*e.TouchGesture.ZOOM_IN_MULTIPLIER:o*e.TouchGesture.ZOOM_OUT_MULTIPLIER;var r=this.startWorkspace_,a=e.utils.mouseToSvg(t,r.getParentSvg(),r.getInverseScreenCTM());r.zoom(a.x,a.y,o)}this.previousScale_=n,t.preventDefault()},e.TouchGesture.prototype.handleTouchEnd=function(t){t=e.Touch.getTouchIdentifierFromEvent(t),this.cachedPoints_[t]&&delete this.cachedPoints_[t],2>Object.keys(this.cachedPoints_).length&&(this.cachedPoints_=Object.create(null),this.previousScale_=0)},e.TouchGesture.prototype.getTouchPoint=function(t){return this.startWorkspace_?new e.utils.Coordinate(t.pageX?t.pageX:t.changedTouches[0].pageX,t.pageY?t.pageY:t.changedTouches[0].pageY):null},e.WorkspaceAudio=function(t){this.parentWorkspace_=t,this.SOUNDS_=Object.create(null)},e.WorkspaceAudio.prototype.lastSound_=null,e.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},e.WorkspaceAudio.prototype.load=function(t,n){if(t.length){try{var o=new e.utils.global.Audio}catch(L){return}for(var r,a=0;a<t.length;a++){var h=t[a],R=h.match(/\.(\w+)$/);if(R&&o.canPlayType("audio/"+R[1])){r=new e.utils.global.Audio(h);break}}r&&r.play&&(this.SOUNDS_[n]=r)}},e.WorkspaceAudio.prototype.preload=function(){for(var t in this.SOUNDS_){var n=this.SOUNDS_[t];n.volume=.01;var o=n.play();if(void 0!==o?o.then(n.pause).catch(function(){}):n.pause(),e.utils.userAgent.IPAD||e.utils.userAgent.IPHONE)break}},e.WorkspaceAudio.prototype.play=function(t,n){var o=this.SOUNDS_[t];o?(t=new Date,null!=this.lastSound_&&t-this.lastSound_<e.SOUND_LIMIT||(this.lastSound_=t,(o=e.utils.userAgent.IPAD||e.utils.userAgent.ANDROID?o:o.cloneNode()).volume=void 0===n?1:n,o.play())):this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(t,n)},e.WorkspaceSvg=function(t,n,o){e.WorkspaceSvg.superClass_.constructor.call(this,t),this.metricsManager_=new(e.registry.getClassFromOptions(e.registry.Type.METRICS_MANAGER,t,!0))(this),this.getMetrics=t.getMetrics||this.metricsManager_.getMetrics.bind(this.metricsManager_),this.setMetrics=t.setMetrics||e.WorkspaceSvg.setTopLevelWorkspaceMetrics_,this.componentManager_=new e.ComponentManager,this.connectionDBList=e.ConnectionDB.init(this.connectionChecker),n&&(this.blockDragSurface_=n),o&&(this.workspaceDragSurface_=o),this.useWorkspaceDragSurface_=!!this.workspaceDragSurface_&&e.utils.is3dSupported(),this.highlightedBlocks_=[],this.audioManager_=new e.WorkspaceAudio(t.parentWorkspace),this.grid_=this.options.gridPattern?new e.Grid(this.options.gridPattern,t.gridOptions):null,this.markerManager_=new e.MarkerManager(this),this.toolboxCategoryCallbacks_=Object.create(null),this.flyoutButtonCallbacks_=Object.create(null),e.Variables&&e.Variables.flyoutCategory&&this.registerToolboxCategoryCallback(e.VARIABLE_CATEGORY_NAME,e.Variables.flyoutCategory),e.VariablesDynamic&&e.VariablesDynamic.flyoutCategory&&this.registerToolboxCategoryCallback(e.VARIABLE_DYNAMIC_CATEGORY_NAME,e.VariablesDynamic.flyoutCategory),e.Procedures&&e.Procedures.flyoutCategory&&(this.registerToolboxCategoryCallback(e.PROCEDURE_CATEGORY_NAME,e.Procedures.flyoutCategory),this.addChangeListener(e.Procedures.mutatorOpenListener)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new e.ThemeManager(this,this.options.theme||e.Themes.Classic),this.themeManager_.subscribeWorkspace(this),this.renderer_=e.blockRendering.init(this.options.renderer||"geras",this.getTheme(),this.options.rendererOverrides),this.cachedParentSvg_=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements_=[],this.dragTargetAreas_=[],this.cachedParentSvgSize_=new e.utils.Size(0,0)},e.utils.object.inherits(e.WorkspaceSvg,e.Workspace),e.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,e.WorkspaceSvg.prototype.rendered=!0,e.WorkspaceSvg.prototype.isVisible_=!0,e.WorkspaceSvg.prototype.isFlyout=!1,e.WorkspaceSvg.prototype.isMutator=!1,e.WorkspaceSvg.prototype.resizesEnabled_=!0,e.WorkspaceSvg.prototype.scrollX=0,e.WorkspaceSvg.prototype.scrollY=0,e.WorkspaceSvg.prototype.startScrollX=0,e.WorkspaceSvg.prototype.startScrollY=0,e.WorkspaceSvg.prototype.dragDeltaXY_=null,e.WorkspaceSvg.prototype.scale=1,e.WorkspaceSvg.prototype.oldScale_=1,e.WorkspaceSvg.prototype.oldTop_=0,e.WorkspaceSvg.prototype.oldLeft_=0,e.WorkspaceSvg.prototype.trashcan=null,e.WorkspaceSvg.prototype.scrollbar=null,e.WorkspaceSvg.prototype.flyout_=null,e.WorkspaceSvg.prototype.toolbox_=null,e.WorkspaceSvg.prototype.currentGesture_=null,e.WorkspaceSvg.prototype.blockDragSurface_=null,e.WorkspaceSvg.prototype.workspaceDragSurface_=null,e.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,e.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,e.WorkspaceSvg.prototype.injectionDiv_=null,e.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,e.WorkspaceSvg.prototype.targetWorkspace=null,e.WorkspaceSvg.prototype.inverseScreenCTM_=null,e.WorkspaceSvg.prototype.inverseScreenCTMDirty_=!0,e.WorkspaceSvg.prototype.getMarkerManager=function(){return this.markerManager_},e.WorkspaceSvg.prototype.getMetricsManager=function(){return this.metricsManager_},e.WorkspaceSvg.prototype.setMetricsManager=function(t){this.metricsManager_=t,this.getMetrics=this.metricsManager_.getMetrics.bind(this.metricsManager_)},e.WorkspaceSvg.prototype.getComponentManager=function(){return this.componentManager_},e.WorkspaceSvg.prototype.setCursorSvg=function(t){this.markerManager_.setCursorSvg(t)},e.WorkspaceSvg.prototype.setMarkerSvg=function(t){this.markerManager_.setMarkerSvg(t)},e.WorkspaceSvg.prototype.getMarker=function(t){return this.markerManager_?this.markerManager_.getMarker(t):null},e.WorkspaceSvg.prototype.getCursor=function(){return this.markerManager_?this.markerManager_.getCursor():null},e.WorkspaceSvg.prototype.getRenderer=function(){return this.renderer_},e.WorkspaceSvg.prototype.getThemeManager=function(){return this.themeManager_},e.WorkspaceSvg.prototype.getTheme=function(){return this.themeManager_.getTheme()},e.WorkspaceSvg.prototype.setTheme=function(t){t||(t=e.Themes.Classic),this.themeManager_.setTheme(t)},e.WorkspaceSvg.prototype.refreshTheme=function(){this.svgGroup_&&this.renderer_.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(n){return!!n.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);var t=new(e.Events.get(e.Events.THEME_CHANGE))(this.getTheme().name,this.id);e.Events.fire(t)},e.WorkspaceSvg.prototype.updateBlockStyles_=function(t){for(var o,n=0;o=t[n];n++){var r=o.getStyleName();r&&(o.setStyle(r),o.mutator&&o.mutator.updateBlockStyle())}},e.WorkspaceSvg.prototype.getInverseScreenCTM=function(){if(this.inverseScreenCTMDirty_){var t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM_=t.inverse(),this.inverseScreenCTMDirty_=!1)}return this.inverseScreenCTM_},e.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){this.inverseScreenCTMDirty_=!0},e.WorkspaceSvg.prototype.isVisible=function(){return this.isVisible_},e.WorkspaceSvg.prototype.getSvgXY=function(t){var n=0,o=0,r=1;(e.utils.dom.containsNode(this.getCanvas(),t)||e.utils.dom.containsNode(this.getBubbleCanvas(),t))&&(r=this.scale);do{var a=e.utils.getRelativeXY(t);(t==this.getCanvas()||t==this.getBubbleCanvas())&&(r=1),n+=a.x*r,o+=a.y*r,t=t.parentNode}while(t&&t!=this.getParentSvg());return new e.utils.Coordinate(n,o)},e.WorkspaceSvg.prototype.getCachedParentSvgSize=function(){var t=this.cachedParentSvgSize_;return new e.utils.Size(t.width,t.height)},e.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return e.utils.getInjectionDivXY_(this.getCanvas())},e.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_)for(var t=this.svgGroup_;t;){if(-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv_=t;break}t=t.parentNode}return this.injectionDiv_},e.WorkspaceSvg.prototype.getBlockCanvas=function(){return this.svgBlockCanvas_},e.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(t){this.resizeHandlerWrapper_=t},e.WorkspaceSvg.prototype.createDom=function(t){return this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyWorkspace"},null),t&&(this.svgBackground_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{height:"100%",width:"100%",class:t},this.svgGroup_),"blocklyMainBackground"==t&&this.grid_?this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(e.browserEvents.conditionalBind(this.svgGroup_,"mousedown",this,this.onMouseDown_,!1,!0),e.browserEvents.conditionalBind(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(e.registry.getClassFromOptions(e.registry.Type.TOOLBOX,this.options,!0))(this)),this.grid_&&this.grid_.update(this.scale),this.recordDragTargets(),(t=e.registry.getClassFromOptions(e.registry.Type.CURSOR,this.options))&&this.markerManager_.setCursor(new t),this.renderer_.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_},e.WorkspaceSvg.prototype.dispose=function(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&(e.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.renderer_.dispose(),this.markerManager_&&(this.markerManager_.dispose(),this.markerManager_=null),e.WorkspaceSvg.superClass_.dispose.call(this),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||(this.themeManager_.dispose(),this.themeManager_=null)),this.flyoutButtonCallbacks_=this.toolboxCategoryCallbacks_=this.connectionDBList=null,!this.options.parentWorkspace){var t=this.getParentSvg();t&&t.parentNode&&e.utils.dom.removeNode(t.parentNode)}this.resizeHandlerWrapper_&&(e.browserEvents.unbind(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},e.WorkspaceSvg.prototype.newBlock=function(t,n){return new e.BlockSvg(this,t,n)},e.WorkspaceSvg.prototype.addTrashcan=function(){if(!e.Trashcan)throw Error("Missing require for Blockly.Trashcan");this.trashcan=new e.Trashcan(this);var t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.svgBlockCanvas_)},e.WorkspaceSvg.prototype.addZoomControls=function(){if(!e.ZoomControls)throw Error("Missing require for Blockly.ZoomControls");this.zoomControls_=new e.ZoomControls(this);var t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)},e.WorkspaceSvg.prototype.addFlyout=function(t){var n=new e.Options({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return n.toolboxPosition=this.options.toolboxPosition,this.flyout_=this.horizontalLayout?new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(n):new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(n),this.flyout_.autoClose=!1,this.flyout_.getWorkspace().setVisible(!0),this.flyout_.createDom(t)},e.WorkspaceSvg.prototype.getFlyout=function(t){return this.flyout_||t?this.flyout_:this.toolbox_?this.toolbox_.getFlyout():null},e.WorkspaceSvg.prototype.getToolbox=function(){return this.toolbox_},e.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDragTargets()},e.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())},e.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position();for(var a,t=this.componentManager_.getComponents(e.ComponentManager.Capability.POSITIONABLE,!0),n=this.getMetricsManager().getUiMetrics(),o=[],r=0;a=t[r];r++)a.position(n,o),(a=a.getBoundingRectangle())&&o.push(a);this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},e.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var t=e.utils.getDocumentScroll();e.utils.Coordinate.equals(this.lastRecordedPageScroll_,t)||(this.lastRecordedPageScroll_=t,this.updateScreenCalculations_())},e.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},e.WorkspaceSvg.prototype.setCachedParentSvgSize=function(t,n){var o=this.getParentSvg();t&&(this.cachedParentSvgSize_.width=t,o.cachedWidth_=t),n&&(this.cachedParentSvgSize_.height=n,o.cachedHeight_=n)},e.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},e.WorkspaceSvg.prototype.getParentSvg=function(){if(!this.cachedParentSvg_)for(var t=this.svgGroup_;t;){if("svg"==t.tagName){this.cachedParentSvg_=t;break}t=t.parentNode}return this.cachedParentSvg_},e.WorkspaceSvg.prototype.maybeFireViewportChangeEvent=function(){if(e.Events.isEnabled()){var t=this.scale,n=-this.scrollY,o=-this.scrollX;if(!(t==this.oldScale_&&1>Math.abs(n-this.oldTop_)&&1>Math.abs(o-this.oldLeft_))){var r=new(e.Events.get(e.Events.VIEWPORT_CHANGE))(n,o,t,this.id,this.oldScale_);this.oldScale_=t,this.oldTop_=n,this.oldLeft_=o,e.Events.fire(r)}}},e.WorkspaceSvg.prototype.translate=function(t,n){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(t,n);else{var o="translate("+t+","+n+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",o),this.svgBubbleCanvas_.setAttribute("transform",o)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(t,n,this.scale),this.grid_&&this.grid_.moveTo(t,n),this.maybeFireViewportChangeEvent()},e.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var t=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),this.svgBlockCanvas_.setAttribute("transform",t="translate("+t.x+","+t.y+") scale("+this.scale+")"),this.svgBubbleCanvas_.setAttribute("transform",t)}},e.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var t=this.svgBlockCanvas_.previousSibling,n=parseInt(this.getParentSvg().getAttribute("width"),10),o=parseInt(this.getParentSvg().getAttribute("height"),10),r=e.utils.getRelativeXY(this.getCanvas());this.workspaceDragSurface_.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),t,n,o,this.scale),this.workspaceDragSurface_.translateSurface(r.x,r.y)}},e.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_},e.WorkspaceSvg.prototype.getWidth=function(){var t=this.getMetrics();return t?t.viewWidth/this.scale:0},e.WorkspaceSvg.prototype.setVisible=function(t){if(this.isVisible_=t,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&this.toolbox_.setVisible(t),t){for(var n=(t=this.getAllBlocks(!1)).length-1;0<=n;n--)t[n].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else e.hideChaff(!0)},e.WorkspaceSvg.prototype.render=function(){for(var t=this.getAllBlocks(!1),n=t.length-1;0<=n;n--)t[n].render(!1);if(this.currentGesture_)for(t=this.currentGesture_.getInsertionMarkers(),n=0;n<t.length;n++)t[n].render(!1);this.markerManager_.updateMarkers()},e.WorkspaceSvg.prototype.highlightBlock=function(t,n){if(void 0===n){for(var r,o=0;r=this.highlightedBlocks_[o];o++)r.setHighlighted(!1);this.highlightedBlocks_.length=0}(r=t?this.getBlockById(t):null)&&((t=void 0===n||n)?-1==this.highlightedBlocks_.indexOf(r)&&this.highlightedBlocks_.push(r):e.utils.arrayRemove(this.highlightedBlocks_,r),r.setHighlighted(t))},e.WorkspaceSvg.prototype.paste=function(t){!this.rendered||!t.tagName||t.getElementsByTagName("block").length>=this.remainingCapacity()||(this.currentGesture_&&this.currentGesture_.cancel(),"comment"==t.tagName.toLowerCase()?this.pasteWorkspaceComment_(t):this.pasteBlock_(t))},e.WorkspaceSvg.prototype.pasteBlock_=function(t){e.Events.disable();try{var n=e.Xml.domToBlock(t,this),o=parseInt(t.getAttribute("x"),10),r=parseInt(t.getAttribute("y"),10);if(!isNaN(o)&&!isNaN(r)){this.RTL&&(o=-o);do{t=!1;for(var R,a=this.getAllBlocks(!1),h=0;R=a[h];h++){var L=R.getRelativeToSurfaceXY();if(1>=Math.abs(o-L.x)&&1>=Math.abs(r-L.y)){t=!0;break}}if(!t){var nt,W=n.getConnections_(!1);for(h=0;nt=W[h];h++)if(nt.closest(e.SNAP_RADIUS,new e.utils.Coordinate(o,r)).connection){t=!0;break}}t&&(o=this.RTL?o-e.SNAP_RADIUS:o+e.SNAP_RADIUS,r+=2*e.SNAP_RADIUS)}while(t);n.moveBy(o,r)}}finally{e.Events.enable()}e.Events.isEnabled()&&!n.isShadow()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(n)),n.select()},e.WorkspaceSvg.prototype.pasteWorkspaceComment_=function(t){e.Events.disable();try{var n=e.WorkspaceCommentSvg.fromXml(t,this),o=parseInt(t.getAttribute("x"),10),r=parseInt(t.getAttribute("y"),10);isNaN(o)||isNaN(r)||(this.RTL&&(o=-o),n.moveBy(o+50,r+50))}finally{e.Events.enable()}e.Events.isEnabled()&&e.WorkspaceComment.fireCreateEvent(n),n.select()},e.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.getFlyout()&&t.toolbox_.refreshSelection()},e.WorkspaceSvg.prototype.renameVariableById=function(t,n){e.WorkspaceSvg.superClass_.renameVariableById.call(this,t,n),this.refreshToolboxSelection()},e.WorkspaceSvg.prototype.deleteVariableById=function(t){e.WorkspaceSvg.superClass_.deleteVariableById.call(this,t),this.refreshToolboxSelection()},e.WorkspaceSvg.prototype.createVariable=function(t,n,o){return t=e.WorkspaceSvg.superClass_.createVariable.call(this,t,n,o),this.refreshToolboxSelection(),t},e.WorkspaceSvg.prototype.recordDeleteAreas=function(){e.utils.deprecation.warn("WorkspaceSvg.prototype.recordDeleteAreas","June 2021","June 2022","WorkspaceSvg.prototype.recordDragTargets"),this.recordDragTargets()},e.WorkspaceSvg.prototype.recordDragTargets=function(){var t=this.componentManager_.getComponents(e.ComponentManager.Capability.DRAG_TARGET,!0);this.dragTargetAreas_=[];for(var o,n=0;o=t[n];n++){var r=o.getClientRect();r&&this.dragTargetAreas_.push({component:o,clientRect:r})}},e.WorkspaceSvg.prototype.getDragTarget=function(t){for(var o,n=0;o=this.dragTargetAreas_[n];n++)if(o.clientRect.contains(t.clientX,t.clientY))return o.component;return null},e.WorkspaceSvg.prototype.onMouseDown_=function(t){var n=this.getGesture(t);n&&n.handleWsStart(t,this)},e.WorkspaceSvg.prototype.startDrag=function(t,n){(t=e.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,this.dragDeltaXY_=e.utils.Coordinate.difference(n,t)},e.WorkspaceSvg.prototype.moveDrag=function(t){return(t=e.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,e.utils.Coordinate.sum(this.dragDeltaXY_,t)},e.WorkspaceSvg.prototype.isDragging=function(){return null!=this.currentGesture_&&this.currentGesture_.isDragging()},e.WorkspaceSvg.prototype.isDraggable=function(){return this.options.moveOptions&&this.options.moveOptions.drag},e.WorkspaceSvg.prototype.isMovable=function(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch},e.WorkspaceSvg.prototype.isMovableHorizontally=function(){var t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollHorizontally())},e.WorkspaceSvg.prototype.isMovableVertically=function(){var t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollVertically())},e.WorkspaceSvg.prototype.onMouseWheel_=function(t){if(e.Gesture.inProgress())t.preventDefault(),t.stopPropagation();else{var n=this.options.zoomOptions&&this.options.zoomOptions.wheel,o=this.options.moveOptions&&this.options.moveOptions.wheel;if(n||o){var r=e.utils.getScrollDeltaPixels(t);!n||!t.ctrlKey&&o?(n=this.scrollX-r.x,o=this.scrollY-r.y,t.shiftKey&&!r.x&&(n=this.scrollX-r.y,o=this.scrollY),this.scroll(n,o)):(r=-r.y/50,n=e.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(n.x,n.y,r)),t.preventDefault()}}},e.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var t=this.getTopBoundedElements();if(!t.length)return new e.utils.Rect(0,0,0,0);for(var n=t[0].getBoundingRectangle(),o=1;o<t.length;o++){var r=t[o];r.isInsertionMarker&&r.isInsertionMarker()||((r=r.getBoundingRectangle()).top<n.top&&(n.top=r.top),r.bottom>n.bottom&&(n.bottom=r.bottom),r.left<n.left&&(n.left=r.left),r.right>n.right&&(n.right=r.right))}return n},e.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(!1),e.Events.setGroup(!0);for(var r,t=this.getTopBlocks(!0),n=0,o=0;r=t[o];o++)if(r.isMovable()){var a=r.getRelativeToSurfaceXY();r.moveBy(-a.x,n-a.y),r.snapToGrid(),n=r.getRelativeToSurfaceXY().y+r.getHeightWidth().height+this.renderer_.getConstants().MIN_BLOCK_HEIGHT}e.Events.setGroup(!1),this.setResizesEnabled(!0)},e.WorkspaceSvg.prototype.showContextMenu=function(t){if(!this.options.readOnly&&!this.isFlyout){var n=e.ContextMenuRegistry.registry.getContextMenuOptions(e.ContextMenuRegistry.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(n,t),e.ContextMenu.show(t,n,this.RTL)}},e.WorkspaceSvg.prototype.updateToolbox=function(t){if(t=e.utils.toolbox.convertToolboxDefToJson(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(e.utils.toolbox.hasCategories(t)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.render(t)}else{if(!this.flyout_)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout_.show(t)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")},e.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(e.mainWorkspace=this,this.setBrowserFocus())},e.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:!0})}catch(t){try{this.getParentSvg().parentNode.setActive()}catch(n){this.getParentSvg().parentNode.focus({preventScroll:!0})}}},e.WorkspaceSvg.prototype.zoom=function(t,n,o){o=Math.pow(this.options.zoomOptions.scaleSpeed,o);var r=this.scale*o;if(this.scale!=r){r>this.options.zoomOptions.maxScale?o=this.options.zoomOptions.maxScale/this.scale:r<this.options.zoomOptions.minScale&&(o=this.options.zoomOptions.minScale/this.scale);var a=this.getCanvas().getCTM(),h=this.getParentSvg().createSVGPoint();h.x=t,h.y=n,h=h.matrixTransform(a.inverse()),a=a.translate((t=h.x)*(1-o),(n=h.y)*(1-o)).scale(o),this.scrollX=a.e,this.scrollY=a.f,this.setScale(r)}},e.WorkspaceSvg.prototype.zoomCenter=function(t){var n=this.getMetrics();if(this.flyout_){var o=n.svgWidth?n.svgWidth/2:0;n=n.svgHeight?n.svgHeight/2:0}else o=n.viewWidth/2+n.absoluteLeft,n=n.viewHeight/2+n.absoluteTop;this.zoom(o,n,t)},e.WorkspaceSvg.prototype.zoomToFit=function(){if(this.isMovable()){var t=this.getMetrics(),n=t.viewWidth;t=t.viewHeight;var o=this.getBlocksBoundingBox(),r=o.right-o.left;if(o=o.bottom-o.top,r){this.flyout_&&(this.horizontalLayout?(t+=this.flyout_.getHeight(),o+=this.flyout_.getHeight()/this.scale):(n+=this.flyout_.getWidth(),r+=this.flyout_.getWidth()/this.scale)),n/=r,t/=o,e.Events.disable();try{this.setScale(Math.min(n,t)),this.scrollCenter()}finally{e.Events.enable()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},e.WorkspaceSvg.prototype.beginCanvasTransition=function(){e.utils.dom.addClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),e.utils.dom.addClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},e.WorkspaceSvg.prototype.endCanvasTransition=function(){e.utils.dom.removeClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),e.utils.dom.removeClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},e.WorkspaceSvg.prototype.scrollCenter=function(){if(this.isMovable()){var t=this.getMetrics(),n=(t.scrollWidth-t.viewWidth)/2,o=(t.scrollHeight-t.viewHeight)/2;this.scroll(n=-n-t.scrollLeft,o=-o-t.scrollTop)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},e.WorkspaceSvg.prototype.centerOnBlock=function(t){if(this.isMovable()){if(t=t?this.getBlockById(t):null){var n=t.getRelativeToSurfaceXY(),o=t.getHeightWidth(),r=this.scale;t=(n.x+(this.RTL?-1:1)*o.width/2)*r,n=(n.y+o.height/2)*r,o=this.getMetrics(),this.scroll(-(t-o.viewWidth/2),-(n-o.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},e.WorkspaceSvg.prototype.setScale=function(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,e.hideChaff(!1),this.flyout_&&(this.flyout_.reflow(),this.recordDragTargets()),this.grid_&&this.grid_.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout_?this.scrollbar.resizeView(t):this.scrollbar.resizeContent(t))},e.WorkspaceSvg.prototype.getScale=function(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale},e.WorkspaceSvg.prototype.scroll=function(t,n){e.hideChaff(!0);var o=this.getMetrics();t=Math.min(t,-o.scrollLeft),n=Math.min(n,-o.scrollTop);var r=o.scrollTop+Math.max(0,o.scrollHeight-o.viewHeight);t=Math.max(t,-(o.scrollLeft+Math.max(0,o.scrollWidth-o.viewWidth))),n=Math.max(n,-r),this.scrollX=t,this.scrollY=n,this.scrollbar&&this.scrollbar.set(-(t+o.scrollLeft),-(n+o.scrollTop),!1),this.translate(t+=o.absoluteLeft,n+=o.absoluteTop)},e.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(t){var n=this.getMetrics();"number"==typeof t.x&&(this.scrollX=-(n.scrollLeft+(n.scrollWidth-n.viewWidth)*t.x)),"number"==typeof t.y&&(this.scrollY=-(n.scrollTop+(n.scrollHeight-n.viewHeight)*t.y)),this.translate(this.scrollX+n.absoluteLeft,this.scrollY+n.absoluteTop)},e.WorkspaceSvg.prototype.getBlockById=function(t){return e.WorkspaceSvg.superClass_.getBlockById.call(this,t)},e.WorkspaceSvg.prototype.getTopBlocks=function(t){return e.WorkspaceSvg.superClass_.getTopBlocks.call(this,t)},e.WorkspaceSvg.prototype.addTopBlock=function(t){this.addTopBoundedElement(t),e.WorkspaceSvg.superClass_.addTopBlock.call(this,t)},e.WorkspaceSvg.prototype.removeTopBlock=function(t){this.removeTopBoundedElement(t),e.WorkspaceSvg.superClass_.removeTopBlock.call(this,t)},e.WorkspaceSvg.prototype.addTopComment=function(t){this.addTopBoundedElement(t),e.WorkspaceSvg.superClass_.addTopComment.call(this,t)},e.WorkspaceSvg.prototype.removeTopComment=function(t){this.removeTopBoundedElement(t),e.WorkspaceSvg.superClass_.removeTopComment.call(this,t)},e.WorkspaceSvg.prototype.addTopBoundedElement=function(t){this.topBoundedElements_.push(t)},e.WorkspaceSvg.prototype.removeTopBoundedElement=function(t){e.utils.arrayRemove(this.topBoundedElements_,t)},e.WorkspaceSvg.prototype.getTopBoundedElements=function(){return[].concat(this.topBoundedElements_)},e.WorkspaceSvg.prototype.setResizesEnabled=function(t){var n=!this.resizesEnabled_&&t;this.resizesEnabled_=t,n&&this.resizeContents()},e.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),e.WorkspaceSvg.superClass_.clear.call(this),this.topBoundedElements_=[],this.setResizesEnabled(!0)},e.WorkspaceSvg.prototype.registerButtonCallback=function(t,n){if("function"!=typeof n)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks_[t]=n},e.WorkspaceSvg.prototype.getButtonCallback=function(t){return(t=this.flyoutButtonCallbacks_[t])?t:null},e.WorkspaceSvg.prototype.removeButtonCallback=function(t){this.flyoutButtonCallbacks_[t]=null},e.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(t,n){if("function"!=typeof n)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[t]=n},e.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(t){return this.toolboxCategoryCallbacks_[t]||null},e.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(t){this.toolboxCategoryCallbacks_[t]=null},e.WorkspaceSvg.prototype.getGesture=function(t){var n="mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type,o=this.currentGesture_;return o?n&&o.hasStarted()?(console.warn("Tried to start the same gesture twice."),o.cancel(),null):o:n?this.currentGesture_=new e.TouchGesture(t,this):null},e.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},e.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},e.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},e.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},e.inject=function(t,n){if(e.checkBlockColourConstants(),"string"==typeof t&&(t=document.getElementById(t)||document.querySelector(t)),!t||!e.utils.dom.containsNode(document,t))throw Error("Error: container is not in current document.");n=new e.Options(n||{});var o=document.createElement("div");o.className="injectionDiv",o.tabIndex=0,e.utils.aria.setState(o,e.utils.aria.State.LABEL,e.Msg.WORKSPACE_ARIA_LABEL),t.appendChild(o),t=e.createDom_(o,n);var r=new e.BlockDragSurfaceSvg(o),a=new e.WorkspaceDragSurfaceSvg(o),h=e.createMainWorkspace_(t,n,r,a);return e.init_(h),e.mainWorkspace=h,e.svgResize(h),o.addEventListener("focusin",function(){e.mainWorkspace=h}),h},e.createDom_=function(t,n){t.setAttribute("dir","LTR"),e.Css.inject(n.hasCss,n.pathToMedia),t=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",class:"blocklySvg",tabindex:"0"},t);var o=e.utils.dom.createSvgElement(e.utils.Svg.DEFS,{},t),r=String(Math.random()).substring(2);return n.gridPattern=e.Grid.createDom(r,n.gridOptions,o),t},e.createMainWorkspace_=function(t,n,o,r){return n.parentWorkspace=null,(n=new e.WorkspaceSvg(n,o,r)).scale=(o=n.options).zoomOptions.startScale,t.appendChild(n.createDom("blocklyMainBackground")),e.utils.dom.addClass(n.getInjectionDiv(),n.getRenderer().getClassName()),e.utils.dom.addClass(n.getInjectionDiv(),n.getTheme().getClassName()),!o.hasCategories&&o.languageTree&&(r=n.addFlyout(e.utils.Svg.SVG),e.utils.dom.insertAfter(r,t)),o.hasTrashcan&&n.addTrashcan(),o.zoomOptions&&o.zoomOptions.controls&&n.addZoomControls(),n.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),n.translate(0,0),n.addChangeListener(e.bumpIntoBoundsHandler_(n)),e.svgResize(n),e.WidgetDiv.createDom(),e.DropDownDiv.createDom(),e.Tooltip.createDom(),n},e.extractObjectFromEvent_=function(t,n){var o=null;switch(n.type){case e.Events.BLOCK_CREATE:case e.Events.BLOCK_MOVE:(o=t.getBlockById(n.blockId))&&(o=o.getRootBlock());break;case e.Events.COMMENT_CREATE:case e.Events.COMMENT_MOVE:o=t.getCommentById(n.commentId)}return o},e.bumpTopObjectsIntoBounds_=function(t){var n=t.getMetricsManager();if(n.hasFixedEdges()&&!t.isDragging()){n=n.getScrollMetrics(!0);for(var a,o=t.getTopBoundedElements(),r=0;a=o[r];r++)e.bumpObjectIntoBounds_(t,n,a)}},e.bumpIntoBoundsHandler_=function(t){return function(n){var o=t.getMetricsManager();if(o.hasFixedEdges()&&!t.isDragging())if(-1!==e.Events.BUMP_EVENTS.indexOf(n.type)){o=o.getScrollMetrics(!0);var r=e.extractObjectFromEvent_(t,n);if(r){var a=e.Events.getGroup();e.Events.setGroup(n.group),e.bumpObjectIntoBounds_(t,o,r)&&!n.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),null!==a&&e.Events.setGroup(a)}}else n.type===e.Events.VIEWPORT_CHANGE&&n.scale>n.oldScale&&e.bumpTopObjectsIntoBounds_(t)}},e.bumpObjectIntoBounds_=function(t,n,o){var r=o.getBoundingRectangle(),a=r.right-r.left,h=e.utils.math.clamp(n.top,r.top,n.top+n.height-(r.bottom-r.top))-r.top,R=n.left;return n=n.left+n.width-a,t.RTL?R=Math.min(n,R):n=Math.max(R,n),!(!(t=e.utils.math.clamp(R,r.left,n)-r.left)&&!h||(o.moveBy(t,h),0))},e.init_=function(t){var n=t.options,o=t.getParentSvg();if(e.browserEvents.conditionalBind(o.parentNode,"contextmenu",null,function(a){e.utils.isTargetInput(a)||a.preventDefault()}),o=e.browserEvents.conditionalBind(window,"resize",null,function(){e.hideChaff(!0),e.svgResize(t),e.bumpTopObjectsIntoBounds_(t)}),t.setResizeHandlerWrapper(o),e.inject.bindDocumentEvents_(),n.languageTree){o=t.getToolbox();var r=t.getFlyout(!0);o?o.init():r&&(r.init(t),r.show(n.languageTree),"function"==typeof r.scrollToStart&&r.scrollToStart())}n.hasTrashcan&&t.trashcan.init(),n.zoomOptions&&n.zoomOptions.controls&&t.zoomControls_.init(),n.moveOptions&&n.moveOptions.scrollbars?(t.scrollbar=new e.ScrollbarPair(t,!0===n.moveOptions.scrollbars||!!n.moveOptions.scrollbars.horizontal,!0===n.moveOptions.scrollbars||!!n.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),n.hasSounds&&e.inject.loadSounds_(n.pathToMedia,t)},e.inject.bindDocumentEvents_=function(){e.documentEventsBound_||(e.browserEvents.conditionalBind(document,"scroll",null,function(){for(var o,t=e.Workspace.getAll(),n=0;o=t[n];n++)o.updateInverseScreenCTM&&o.updateInverseScreenCTM()}),e.browserEvents.conditionalBind(document,"keydown",null,e.onKeyDown),e.browserEvents.bind(document,"touchend",null,e.longStop_),e.browserEvents.bind(document,"touchcancel",null,e.longStop_),e.utils.userAgent.IPAD&&e.browserEvents.conditionalBind(window,"orientationchange",document,function(){e.svgResize(e.getMainWorkspace())})),e.documentEventsBound_=!0},e.inject.loadSounds_=function(t,n){var o=n.getAudioManager();o.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),o.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),o.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");var r=[];t=function(){for(;r.length;)e.browserEvents.unbind(r.pop());o.preload()},r.push(e.browserEvents.conditionalBind(document,"mousemove",null,t,!0)),r.push(e.browserEvents.conditionalBind(document,"touchstart",null,t,!0))},e.Names=function(t,n){if(this.variablePrefix_=n||"",this.reservedDict_=Object.create(null),t)for(t=t.split(","),n=0;n<t.length;n++)this.reservedDict_[t[n]]=!0;this.reset()},e.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE",e.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},e.Names.prototype.setVariableMap=function(t){this.variableMap_=t},e.Names.prototype.getNameForUserVariable_=function(t){return this.variableMap_?(t=this.variableMap_.getVariableById(t))?t.name:null:(console.warn("Deprecated call to Blockly.Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)},e.Names.prototype.populateVariables=function(t){t=e.Variables.allUsedVarModels(t);for(var n=0;n<t.length;n++)this.getName(t[n].getId(),e.VARIABLE_CATEGORY_NAME)},e.Names.prototype.populateProcedures=function(t){t=(t=e.Procedures.allProcedures(t))[0].concat(t[1]);for(var n=0;n<t.length;n++)this.getName(t[n][0],e.PROCEDURE_CATEGORY_NAME)},e.Names.prototype.getName=function(t,n){var o=t;n==e.VARIABLE_CATEGORY_NAME&&(t=this.getNameForUserVariable_(t))&&(o=t),t=o.toLowerCase();var r=n==e.VARIABLE_CATEGORY_NAME||n==e.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"";n in this.db_||(this.db_[n]=Object.create(null));var a=this.db_[n];return t in a?r+a[t]:(n=this.getDistinctName(o,n),a[t]=n.substr(r.length),n)},e.Names.prototype.getUserNames=function(t){return Object.keys(this.db_[t]||{})},e.Names.prototype.getDistinctName=function(t,n){t=this.safeName_(t);for(var o="";this.dbReverse_[t+o]||t+o in this.reservedDict_;)o=o?o+1:2;return this.dbReverse_[t+=o]=!0,(n==e.VARIABLE_CATEGORY_NAME||n==e.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"")+t},e.Names.prototype.safeName_=function(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(t[0])&&(t="my_"+t)):t=e.Msg.UNNAMED_KEY||"unnamed",t},e.Names.equals=function(t,n){return t.toLowerCase()==n.toLowerCase()},e.Procedures={},e.Procedures.NAME_TYPE=e.PROCEDURE_CATEGORY_NAME,e.Procedures.DEFAULT_ARG="x",e.Procedures.allProcedures=function(t){var n=t.getBlocksByType("procedures_defnoreturn",!1).map(function(o){return o.getProcedureDef()});return t=t.getBlocksByType("procedures_defreturn",!1).map(function(o){return o.getProcedureDef()}),n.sort(e.Procedures.procTupleComparator_),t.sort(e.Procedures.procTupleComparator_),[n,t]},e.Procedures.procTupleComparator_=function(t,n){return t[0].localeCompare(n[0],void 0,{sensitivity:"base"})},e.Procedures.findLegalName=function(t,n){if(n.isInFlyout)return t;for(t=t||e.Msg.UNNAMED_KEY||"unnamed";!e.Procedures.isLegalName_(t,n.workspace,n);){var o=t.match(/^(.*?)(\d+)$/);t=o?o[1]+(parseInt(o[2],10)+1):t+"2"}return t},e.Procedures.isLegalName_=function(t,n,o){return!e.Procedures.isNameUsed(t,n,o)},e.Procedures.isNameUsed=function(t,n,o){n=n.getAllBlocks(!1);for(var r=0;r<n.length;r++)if(n[r]!=o&&n[r].getProcedureDef){var a=n[r].getProcedureDef();if(e.Names.equals(a[0],t))return!0}return!1},e.Procedures.rename=function(t){t=t.trim();var n=e.Procedures.findLegalName(t,this.getSourceBlock()),o=this.getValue();if(o!=t&&o!=n){t=this.getSourceBlock().workspace.getAllBlocks(!1);for(var r=0;r<t.length;r++)t[r].renameProcedure&&t[r].renameProcedure(o,n)}return n},e.Procedures.flyoutCategory=function(t){function n(h,R){for(var L=0;L<h.length;L++){var W=h[L][0],nt=h[L][1],et=e.utils.xml.createElement("block");et.setAttribute("type",R),et.setAttribute("gap",16);var Et=e.utils.xml.createElement("mutation");for(Et.setAttribute("name",W),et.appendChild(Et),W=0;W<nt.length;W++){var It=e.utils.xml.createElement("arg");It.setAttribute("name",nt[W]),Et.appendChild(It)}o.push(et)}}var o=[];if(e.Blocks.procedures_defnoreturn){var r=e.utils.xml.createElement("block");r.setAttribute("type","procedures_defnoreturn"),r.setAttribute("gap",16);var a=e.utils.xml.createElement("field");a.setAttribute("name","NAME"),a.appendChild(e.utils.xml.createTextNode(e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE)),r.appendChild(a),o.push(r)}return e.Blocks.procedures_defreturn&&((r=e.utils.xml.createElement("block")).setAttribute("type","procedures_defreturn"),r.setAttribute("gap",16),(a=e.utils.xml.createElement("field")).setAttribute("name","NAME"),a.appendChild(e.utils.xml.createTextNode(e.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),r.appendChild(a),o.push(r)),e.Blocks.procedures_ifreturn&&((r=e.utils.xml.createElement("block")).setAttribute("type","procedures_ifreturn"),r.setAttribute("gap",16),o.push(r)),o.length&&o[o.length-1].setAttribute("gap",24),n((t=e.Procedures.allProcedures(t))[0],"procedures_callnoreturn"),n(t[1],"procedures_callreturn"),o},e.Procedures.updateMutatorFlyout_=function(t){for(var a,n=[],o=t.getBlocksByType("procedures_mutatorarg",!1),r=0;a=o[r];r++)n.push(a.getFieldValue("NAME"));o=e.utils.xml.createElement("xml"),(r=e.utils.xml.createElement("block")).setAttribute("type","procedures_mutatorarg"),(a=e.utils.xml.createElement("field")).setAttribute("name","NAME"),n=e.Variables.generateUniqueNameFromOptions(e.Procedures.DEFAULT_ARG,n),n=e.utils.xml.createTextNode(n),a.appendChild(n),r.appendChild(a),o.appendChild(r),t.updateToolbox(o)},e.Procedures.mutatorOpenListener=function(t){if(t.type==e.Events.BUBBLE_OPEN&&"mutator"===t.bubbleType&&t.isOpen){var n=(t=e.Workspace.getById(t.workspaceId).getBlockById(t.blockId)).type;("procedures_defnoreturn"==n||"procedures_defreturn"==n)&&(t=t.mutator.getWorkspace(),e.Procedures.updateMutatorFlyout_(t),t.addChangeListener(e.Procedures.mutatorChangeListener_))}},e.Procedures.mutatorChangeListener_=function(t){(t.type==e.Events.BLOCK_CREATE||t.type==e.Events.BLOCK_DELETE||t.type==e.Events.BLOCK_CHANGE)&&(t=e.Workspace.getById(t.workspaceId),e.Procedures.updateMutatorFlyout_(t))},e.Procedures.getCallers=function(t,n){var o=[];n=n.getAllBlocks(!1);for(var r=0;r<n.length;r++)if(n[r].getProcedureCall){var a=n[r].getProcedureCall();a&&e.Names.equals(a,t)&&o.push(n[r])}return o},e.Procedures.mutateCallers=function(t){var a,n=e.Events.recordUndo,o=t.getProcedureDef()[0],r=t.mutationToDom(!0);for(t=e.Procedures.getCallers(o,t.workspace),o=0;a=t[o];o++){var h=a.mutationToDom();h=h&&e.Xml.domToText(h),a.domToMutation(r);var R=a.mutationToDom();h!=(R=R&&e.Xml.domToText(R))&&(e.Events.recordUndo=!1,e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(a,"mutation",null,h,R)),e.Events.recordUndo=n)}},e.Procedures.getDefinition=function(t,n){n=n.getAllBlocks(!1);for(var o=0;o<n.length;o++)if(n[o].getProcedureDef){var r=n[o].getProcedureDef();if(r&&e.Names.equals(r[0],t))return n[o]}return null},e.ShortcutRegistry=function(){e.ShortcutRegistry.registry=this,this.registry_=Object.create(null),this.keyMap_=Object.create(null)},e.ShortcutRegistry.modifierKeys={Shift:e.utils.KeyCodes.SHIFT,Control:e.utils.KeyCodes.CTRL,Alt:e.utils.KeyCodes.ALT,Meta:e.utils.KeyCodes.META},e.ShortcutRegistry.prototype.register=function(t,n){if(this.registry_[t.name]&&!n)throw Error('Shortcut with name "'+t.name+'" already exists.');this.registry_[t.name]=t},e.ShortcutRegistry.prototype.unregister=function(t){return this.registry_[t]?(this.removeAllKeyMappings(t),delete this.registry_[t],!0):(console.warn('Keyboard shortcut with name "'+t+'" not found.'),!1)},e.ShortcutRegistry.prototype.addKeyMapping=function(t,n,o){t=String(t);var r=this.keyMap_[t];if(r&&!o)throw Error('Shortcut with name "'+n+'" collides with shortcuts '+r.toString());r&&o?r.unshift(n):this.keyMap_[t]=[n]},e.ShortcutRegistry.prototype.removeKeyMapping=function(t,n,o){var r=this.keyMap_[t];if(!r&&!o)return console.warn('No keyboard shortcut with name "'+n+'" registered with key code "'+t+'"'),!1;var a=r.indexOf(n);return-1<a?(r.splice(a,1),0==r.length&&delete this.keyMap_[t],!0):(o||console.warn('No keyboard shortcut with name "'+n+'" registered with key code "'+t+'"'),!1)},e.ShortcutRegistry.prototype.removeAllKeyMappings=function(t){for(var n in this.keyMap_)this.removeKeyMapping(n,t,!0)},e.ShortcutRegistry.prototype.setKeyMap=function(t){this.keyMap_=t},e.ShortcutRegistry.prototype.getKeyMap=function(){return e.utils.object.deepMerge(Object.create(null),this.keyMap_)},e.ShortcutRegistry.prototype.getRegistry=function(){return e.utils.object.deepMerge(Object.create(null),this.registry_)},e.ShortcutRegistry.prototype.onKeyDown=function(t,n){var o=this.serializeKeyEvent_(n);if(!(o=this.getShortcutNamesByKeyCode(o)))return!1;for(var a,r=0;a=o[r];r++)if((!(a=this.registry_[a]).preconditionFn||a.preconditionFn(t))&&a.callback&&a.callback(t,n,a))return!0;return!1},e.ShortcutRegistry.prototype.getShortcutNamesByKeyCode=function(t){return this.keyMap_[t]||[]},e.ShortcutRegistry.prototype.getKeyCodesByShortcutName=function(t){var o,n=[];for(o in this.keyMap_)-1<this.keyMap_[o].indexOf(t)&&n.push(o);return n},e.ShortcutRegistry.prototype.serializeKeyEvent_=function(t){var o,n="";for(o in e.ShortcutRegistry.modifierKeys)t.getModifierState(o)&&(""!=n&&(n+="+"),n+=o);return""!=n&&t.keyCode?n=n+"+"+t.keyCode:t.keyCode&&(n=t.keyCode.toString()),n},e.ShortcutRegistry.prototype.checkModifiers_=function(t){for(var r,n=e.utils.object.values(e.ShortcutRegistry.modifierKeys),o=0;r=t[o];o++)if(0>n.indexOf(r))throw Error(r+" is not a valid modifier key.")},e.ShortcutRegistry.prototype.createSerializedKey=function(t,n){var o="";if(n)for(var r in this.checkModifiers_(n),e.ShortcutRegistry.modifierKeys)-1<n.indexOf(e.ShortcutRegistry.modifierKeys[r])&&(""!=o&&(o+="+"),o+=r);return""!=o&&t?o=o+"+"+t:t&&(o=t.toString()),o},new e.ShortcutRegistry,e.VariableModel=function(t,n,o,r){this.workspace=t,this.name=n,this.type=o||"",this.id_=r||e.utils.genUid(),e.Events.fire(new(e.Events.get(e.Events.VAR_CREATE))(this))},e.VariableModel.prototype.getId=function(){return this.id_},e.VariableModel.compareByName=function(t,n){return t.name.localeCompare(n.name,void 0,{sensitivity:"base"})},e.Variables={},e.Variables.NAME_TYPE=e.VARIABLE_CATEGORY_NAME,e.Variables.allUsedVarModels=function(t){var n=t.getAllBlocks(!1);t=Object.create(null);for(var o=0;o<n.length;o++){var r=n[o].getVarModels();if(r)for(var a=0;a<r.length;a++){var h=r[a],R=h.getId();R&&(t[R]=h)}}for(R in n=[],t)n.push(t[R]);return n},e.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_={},e.Variables.allDeveloperVariables=function(t){t=t.getAllBlocks(!1);for(var r,n=Object.create(null),o=0;r=t[o];o++){var a=r.getDeveloperVariables;if(!a&&r.getDeveloperVars&&(a=r.getDeveloperVars,e.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[r.type]||(console.warn("Function getDeveloperVars() deprecated. Use getDeveloperVariables() (block type '"+r.type+"')"),e.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[r.type]=!0)),a)for(r=a(),a=0;a<r.length;a++)n[r[a]]=!0}return Object.keys(n)},e.Variables.flyoutCategory=function(t){var n=[],o=document.createElement("button");return o.setAttribute("text","%{BKY_NEW_VARIABLE}"),o.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",function(r){e.Variables.createVariableButtonHandler(r.getTargetWorkspace())}),n.push(o),t=e.Variables.flyoutCategoryBlocks(t),n.concat(t)},e.Variables.flyoutCategoryBlocks=function(t){var n=[];if(0<(t=t.getVariablesOfType("")).length){var o=t[t.length-1];if(e.Blocks.variables_set){var r=e.utils.xml.createElement("block");r.setAttribute("type","variables_set"),r.setAttribute("gap",e.Blocks.math_change?8:24),r.appendChild(e.Variables.generateVariableFieldDom(o)),n.push(r)}if(e.Blocks.math_change&&((r=e.utils.xml.createElement("block")).setAttribute("type","math_change"),r.setAttribute("gap",e.Blocks.variables_get?20:8),r.appendChild(e.Variables.generateVariableFieldDom(o)),o=e.Xml.textToDom('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),r.appendChild(o),n.push(r)),e.Blocks.variables_get){t.sort(e.VariableModel.compareByName),o=0;for(var a;a=t[o];o++)(r=e.utils.xml.createElement("block")).setAttribute("type","variables_get"),r.setAttribute("gap",8),r.appendChild(e.Variables.generateVariableFieldDom(a)),n.push(r)}}return n},e.Variables.VAR_LETTER_OPTIONS="ijkmnopqrstuvwxyzabcdefgh",e.Variables.generateUniqueName=function(t){return e.Variables.generateUniqueNameFromOptions(e.Variables.VAR_LETTER_OPTIONS.charAt(0),t.getAllVariableNames())},e.Variables.generateUniqueNameFromOptions=function(t,n){if(!n.length)return t;for(var o=e.Variables.VAR_LETTER_OPTIONS,r="",a=o.indexOf(t);;){for(var h=!1,R=0;R<n.length;R++)if(n[R].toLowerCase()==t){h=!0;break}if(!h)return t;++a==o.length&&(a=0,r=Number(r)+1),t=o.charAt(a)+r}},e.Variables.createVariableButtonHandler=function(t,n,o){var r=o||"",a=function(h){e.Variables.promptName(e.Msg.NEW_VARIABLE_TITLE,h,function(R){if(R){var L=e.Variables.nameUsedWithAnyType(R,t);if(L){if(L.type==r)var W=e.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",L.name);else W=(W=e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",L.name).replace("%2",L.type);e.alert(W,function(){a(R)})}else t.createVariable(R,r),n&&n(R)}else n&&n(null)})};a("")},e.Variables.createVariable=e.Variables.createVariableButtonHandler,e.Variables.renameVariable=function(t,n,o){var r=function(a){var h=e.Msg.RENAME_VARIABLE_TITLE.replace("%1",n.name);e.Variables.promptName(h,a,function(R){if(R){var L=e.Variables.nameUsedWithOtherType_(R,n.type,t);L?(L=e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",L.name).replace("%2",L.type),e.alert(L,function(){r(R)})):(t.renameVariableById(n.getId(),R),o&&o(R))}else o&&o(null)})};r("")},e.Variables.promptName=function(t,n,o){e.prompt(t,n,function(r){r&&((r=r.replace(/[\s\xa0]+/g," ").trim())==e.Msg.RENAME_VARIABLE||r==e.Msg.NEW_VARIABLE)&&(r=null),o(r)})},e.Variables.nameUsedWithOtherType_=function(t,n,o){o=o.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var a,r=0;a=o[r];r++)if(a.name.toLowerCase()==t&&a.type!=n)return a;return null},e.Variables.nameUsedWithAnyType=function(t,n){n=n.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var r,o=0;r=n[o];o++)if(r.name.toLowerCase()==t)return r;return null},e.Variables.generateVariableFieldDom=function(t){var n=e.utils.xml.createElement("field");return n.setAttribute("name","VAR"),n.setAttribute("id",t.getId()),n.setAttribute("variabletype",t.type),t=e.utils.xml.createTextNode(t.name),n.appendChild(t),n},e.Variables.getOrCreateVariablePackage=function(t,n,o,r){var a=e.Variables.getVariable(t,n,o,r);return a||(a=e.Variables.createVariable_(t,n,o,r)),a},e.Variables.getVariable=function(t,n,o,r){var a=t.getPotentialVariableMap(),h=null;if(n&&(!(h=t.getVariableById(n))&&a&&(h=a.getVariableById(n)),h))return h;if(o){if(null==r)throw Error("Tried to look up a variable by name without a type");!(h=t.getVariable(o,r))&&a&&(h=a.getVariable(o,r))}return h},e.Variables.createVariable_=function(t,n,o,r){var a=t.getPotentialVariableMap();return o||(o=e.Variables.generateUniqueName(t.isFlyout?t.targetWorkspace:t)),a?a.createVariable(o,r,n):t.createVariable(o,r,n)},e.Variables.getAddedVariables=function(t,n){t=t.getAllVariables();var o=[];if(n.length!=t.length)for(var r=0;r<t.length;r++){var a=t[r];-1==n.indexOf(a)&&o.push(a)}return o},e.VERSION="6.20210701.0",e.mainWorkspace=null,e.selected=null,e.draggingConnections=[],e.clipboardXml_=null,e.clipboardSource_=null,e.clipboardTypeCounts_=null,e.cache3dSupported_=null,e.parentContainer=null,e.svgSize=function(t){return e.utils.deprecation.warn("Blockly.svgSize","March 2021","March 2022","workspace.getCachedParentSvgSize"),new e.utils.Size(t.cachedWidth_,t.cachedHeight_)},e.resizeSvgContents=function(t){t.resizeContents()},e.svgResize=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;var n=t.getParentSvg(),o=t.getCachedParentSvgSize(),r=n.parentNode;if(r){var a=r.offsetWidth;r=r.offsetHeight,o.width!=a&&(n.setAttribute("width",a+"px"),t.setCachedParentSvgSize(a,null)),o.height!=r&&(n.setAttribute("height",r+"px"),t.setCachedParentSvgSize(null,r)),t.resize()}},e.onKeyDown=function(t){var n=e.mainWorkspace;n&&!(e.utils.isTargetInput(t)||n.rendered&&!n.isVisible())&&e.ShortcutRegistry.registry.onKeyDown(n,t)},e.deleteBlock=function(t){t.workspace.isFlyout||(e.Events.setGroup(!0),e.hideChaff(),t.dispose(!t.outputConnection,!0),e.Events.setGroup(!1))},e.copy=function(t){(t=t.toCopyData())&&(e.clipboardXml_=t.xml,e.clipboardSource_=t.source,e.clipboardTypeCounts_=t.typeCounts)},e.paste=function(){if(!e.clipboardXml_)return!1;var t=e.clipboardSource_;return t.isFlyout&&(t=t.targetWorkspace),!(!e.clipboardTypeCounts_||!t.isCapacityAvailable(e.clipboardTypeCounts_)||(e.Events.setGroup(!0),t.paste(e.clipboardXml_),e.Events.setGroup(!1),0))},e.duplicate=function(t){var n=e.clipboardXml_,o=e.clipboardSource_;e.copy(t),t.workspace.paste(e.clipboardXml_),e.clipboardXml_=n,e.clipboardSource_=o},e.onContextMenu_=function(t){e.utils.isTargetInput(t)||t.preventDefault()},e.hideChaff=function(t){e.Tooltip.hide(),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation();var n=!!t;e.getMainWorkspace().getComponentManager().getComponents(e.ComponentManager.Capability.AUTOHIDEABLE,!0).forEach(function(o){o.autoHide(n)})},e.getMainWorkspace=function(){return e.mainWorkspace},e.alert=function(t,n){alert(t),n&&n()},e.confirm=function(t,n){n(confirm(t))},e.prompt=function(t,n,o){o(prompt(t,n))},e.jsonInitFactory_=function(t){return function(){this.jsonInit(t)}},e.defineBlocksWithJsonArray=function(t){for(var n=0;n<t.length;n++){var o=t[n];if(o){var r=o.type;null==r||""===r?console.warn("Block definition #"+n+" in JSON array is missing a type attribute. Skipping."):(e.Blocks[r]&&console.warn("Block definition #"+n+' in JSON array overwrites prior definition of "'+r+'".'),e.Blocks[r]={init:e.jsonInitFactory_(o)})}else console.warn("Block definition #"+n+" in JSON array is "+o+". Skipping.")}},e.isNumber=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},e.hueToHex=function(t){return e.utils.colour.hsvToHex(t,e.HSV_SATURATION,255*e.HSV_VALUE)},e.checkBlockColourConstants=function(){e.checkBlockColourConstant_("LOGIC_HUE",["Blocks","logic","HUE"],void 0),e.checkBlockColourConstant_("LOGIC_HUE",["Constants","Logic","HUE"],210),e.checkBlockColourConstant_("LOOPS_HUE",["Blocks","loops","HUE"],void 0),e.checkBlockColourConstant_("LOOPS_HUE",["Constants","Loops","HUE"],120),e.checkBlockColourConstant_("MATH_HUE",["Blocks","math","HUE"],void 0),e.checkBlockColourConstant_("MATH_HUE",["Constants","Math","HUE"],230),e.checkBlockColourConstant_("TEXTS_HUE",["Blocks","texts","HUE"],void 0),e.checkBlockColourConstant_("TEXTS_HUE",["Constants","Text","HUE"],160),e.checkBlockColourConstant_("LISTS_HUE",["Blocks","lists","HUE"],void 0),e.checkBlockColourConstant_("LISTS_HUE",["Constants","Lists","HUE"],260),e.checkBlockColourConstant_("COLOUR_HUE",["Blocks","colour","HUE"],void 0),e.checkBlockColourConstant_("COLOUR_HUE",["Constants","Colour","HUE"],20),e.checkBlockColourConstant_("VARIABLES_HUE",["Blocks","variables","HUE"],void 0),e.checkBlockColourConstant_("VARIABLES_HUE",["Constants","Variables","HUE"],330),e.checkBlockColourConstant_("VARIABLES_DYNAMIC_HUE",["Constants","VariablesDynamic","HUE"],310),e.checkBlockColourConstant_("PROCEDURES_HUE",["Blocks","procedures","HUE"],void 0)},e.checkBlockColourConstant_=function(t,n,o){for(var r="Blockly",a=e,h=0;h<n.length;++h)r+="."+n[h],a&&(a=a[n[h]]);a&&a!==o&&(t=(void 0===o?'%1 has been removed. Use Blockly.Msg["%2"].':'%1 is deprecated and unused. Override Blockly.Msg["%2"].').replace("%1",r).replace("%2",t),console.warn(t))},e.setParentContainer=function(t){e.parentContainer=t},e.bindEvent_=e.browserEvents.bind,e.unbindEvent_=e.browserEvents.unbind,e.bindEventWithChecks_=e.browserEvents.conditionalBind,e.ALIGN_LEFT=e.constants.ALIGN.LEFT,e.ALIGN_CENTRE=e.constants.ALIGN.CENTRE,e.ALIGN_RIGHT=e.constants.ALIGN.RIGHT,e.INPUT_VALUE=e.connectionTypes.INPUT_VALUE,e.OUTPUT_VALUE=e.connectionTypes.OUTPUT_VALUE,e.NEXT_STATEMENT=e.connectionTypes.NEXT_STATEMENT,e.PREVIOUS_STATEMENT=e.connectionTypes.PREVIOUS_STATEMENT,e.DUMMY_INPUT=e.inputTypes.DUMMY,e.TOOLBOX_AT_TOP=e.utils.toolbox.Position.TOP,e.TOOLBOX_AT_BOTTOM=e.utils.toolbox.Position.BOTTOM,e.TOOLBOX_AT_LEFT=e.utils.toolbox.Position.LEFT,e.TOOLBOX_AT_RIGHT=e.utils.toolbox.Position.RIGHT,e.Events.BubbleOpen=function(t,n,o){e.Events.BubbleOpen.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.isOpen=n,this.bubbleType=o},e.utils.object.inherits(e.Events.BubbleOpen,e.Events.UiBase),e.Events.BubbleOpen.prototype.type=e.Events.BUBBLE_OPEN,e.Events.BubbleOpen.prototype.toJson=function(){var t=e.Events.BubbleOpen.superClass_.toJson.call(this);return t.isOpen=this.isOpen,t.bubbleType=this.bubbleType,t.blockId=this.blockId,t},e.Events.BubbleOpen.prototype.fromJson=function(t){e.Events.BubbleOpen.superClass_.fromJson.call(this,t),this.isOpen=t.isOpen,this.bubbleType=t.bubbleType,this.blockId=t.blockId},e.registry.register(e.registry.Type.EVENT,e.Events.BUBBLE_OPEN,e.Events.BubbleOpen),e.Icon=function(t){this.block_=t,this.iconGroup_=null},e.Icon.prototype.collapseHidden=!0,e.Icon.prototype.SIZE=17,e.Icon.prototype.bubble_=null,e.Icon.prototype.iconXY_=null,e.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&e.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),e.browserEvents.conditionalBind(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},e.Icon.prototype.dispose=function(){e.utils.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},e.Icon.prototype.updateEditable=function(){},e.Icon.prototype.isVisible=function(){return!!this.bubble_},e.Icon.prototype.iconClick_=function(t){this.block_.workspace.isDragging()||this.block_.isInFlyout||e.utils.isRightButton(t)||this.setVisible(!this.isVisible())},e.Icon.prototype.applyColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.style.colourPrimary)},e.Icon.prototype.setIconLocation=function(t){this.iconXY_=t,this.isVisible()&&this.bubble_.setAnchorLocation(t)},e.Icon.prototype.computeIconLocation=function(){var t=this.block_.getRelativeToSurfaceXY(),n=e.utils.getRelativeXY(this.iconGroup_);t=new e.utils.Coordinate(t.x+n.x+this.SIZE/2,t.y+n.y+this.SIZE/2),e.utils.Coordinate.equals(this.getIconLocation(),t)||this.setIconLocation(t)},e.Icon.prototype.getIconLocation=function(){return this.iconXY_},e.Icon.prototype.getCorrectedSize=function(){return new e.utils.Size(e.Icon.prototype.SIZE,e.Icon.prototype.SIZE-2)},e.Warning=function(t){e.Warning.superClass_.constructor.call(this,t),this.createIcon(),this.text_=Object.create(null)},e.utils.object.inherits(e.Warning,e.Icon),e.Warning.prototype.collapseHidden=!1,e.Warning.prototype.drawIcon_=function(t){e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},t),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},t),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},t)},e.Warning.prototype.setVisible=function(t){t!=this.isVisible()&&(e.Events.fire(new(e.Events.get(e.Events.BUBBLE_OPEN))(this.block_,t,"warning")),t?this.createBubble_():this.disposeBubble_())},e.Warning.prototype.createBubble_=function(){this.paragraphElement_=e.Bubble.textToDom(this.getText()),this.bubble_=e.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},e.Warning.prototype.disposeBubble_=function(){this.bubble_.dispose(),this.paragraphElement_=this.bubble_=null},e.Warning.prototype.setText=function(t,n){this.text_[n]!=t&&(t?this.text_[n]=t:delete this.text_[n],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},e.Warning.prototype.getText=function(){var n,t=[];for(n in this.text_)t.push(this.text_[n]);return t.join("\n")},e.Warning.prototype.dispose=function(){this.block_.warning=null,e.Icon.prototype.dispose.call(this)},e.Comment=function(t){e.Comment.superClass_.constructor.call(this,t),this.model_=t.commentModel,this.model_.text=this.model_.text||"",this.cachedText_="",this.onInputWrapper_=this.onChangeWrapper_=this.onWheelWrapper_=this.onMouseUpWrapper_=null,this.createIcon()},e.utils.object.inherits(e.Comment,e.Icon),e.Comment.prototype.drawIcon_=function(t){e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},t),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},t),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},t)},e.Comment.prototype.createEditor_=function(){this.foreignObject_=e.utils.dom.createSvgElement(e.utils.Svg.FOREIGNOBJECT,{x:e.Bubble.BORDER_WIDTH,y:e.Bubble.BORDER_WIDTH},null);var t=document.createElementNS(e.utils.dom.HTML_NS,"body");t.setAttribute("xmlns",e.utils.dom.HTML_NS),t.className="blocklyMinimalBody";var n=this.textarea_=document.createElementNS(e.utils.dom.HTML_NS,"textarea");return n.className="blocklyCommentTextarea",n.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),n.value=this.model_.text,this.resizeTextarea_(),t.appendChild(n),this.foreignObject_.appendChild(t),this.onMouseUpWrapper_=e.browserEvents.conditionalBind(n,"mouseup",this,this.startEdit_,!0,!0),this.onWheelWrapper_=e.browserEvents.conditionalBind(n,"wheel",this,function(o){o.stopPropagation()}),this.onChangeWrapper_=e.browserEvents.conditionalBind(n,"change",this,function(o){this.cachedText_!=this.model_.text&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this.block_,"comment",null,this.cachedText_,this.model_.text))}),this.onInputWrapper_=e.browserEvents.conditionalBind(n,"input",this,function(o){this.model_.text=n.value}),setTimeout(n.focus.bind(n),0),this.foreignObject_},e.Comment.prototype.updateEditable=function(){e.Comment.superClass_.updateEditable.call(this),this.isVisible()&&(this.disposeBubble_(),this.createBubble_())},e.Comment.prototype.onBubbleResize_=function(){this.isVisible()&&(this.model_.size=this.bubble_.getBubbleSize(),this.resizeTextarea_())},e.Comment.prototype.resizeTextarea_=function(){var t=this.model_.size,n=2*e.Bubble.BORDER_WIDTH,o=t.width-n;t=t.height-n,this.foreignObject_.setAttribute("width",o),this.foreignObject_.setAttribute("height",t),this.textarea_.style.width=o-4+"px",this.textarea_.style.height=t-4+"px"},e.Comment.prototype.setVisible=function(t){t!=this.isVisible()&&(e.Events.fire(new(e.Events.get(e.Events.BUBBLE_OPEN))(this.block_,t,"comment")),(this.model_.pinned=t)?this.createBubble_():this.disposeBubble_())},e.Comment.prototype.createBubble_=function(){!this.block_.isEditable()||e.utils.userAgent.IE?this.createNonEditableBubble_():this.createEditableBubble_()},e.Comment.prototype.createEditableBubble_=function(){this.bubble_=new e.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,this.model_.size.width,this.model_.size.height),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerResizeEvent(this.onBubbleResize_.bind(this)),this.applyColour()},e.Comment.prototype.createNonEditableBubble_=function(){this.paragraphElement_=e.Bubble.textToDom(this.block_.getCommentText()),this.bubble_=e.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},e.Comment.prototype.disposeBubble_=function(){this.onMouseUpWrapper_&&(e.browserEvents.unbind(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onWheelWrapper_&&(e.browserEvents.unbind(this.onWheelWrapper_),this.onWheelWrapper_=null),this.onChangeWrapper_&&(e.browserEvents.unbind(this.onChangeWrapper_),this.onChangeWrapper_=null),this.onInputWrapper_&&(e.browserEvents.unbind(this.onInputWrapper_),this.onInputWrapper_=null),this.bubble_.dispose(),this.paragraphElement_=this.foreignObject_=this.textarea_=this.bubble_=null},e.Comment.prototype.startEdit_=function(t){this.bubble_.promote()&&this.textarea_.focus(),this.cachedText_=this.model_.text},e.Comment.prototype.getBubbleSize=function(){return this.model_.size},e.Comment.prototype.setBubbleSize=function(t,n){this.bubble_?this.bubble_.setBubbleSize(t,n):(this.model_.size.width=t,this.model_.size.height=n)},e.Comment.prototype.updateText=function(){this.textarea_?this.textarea_.value=this.model_.text:this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model_.text)},e.Comment.prototype.dispose=function(){this.block_.comment=null,e.Icon.prototype.dispose.call(this)},e.Css.register(".blocklyCommentTextarea {,background-color: #fef49c;,border: 0;,outline: 0;,margin: 0;,padding: 3px;,resize: none;,display: block;,text-overflow: hidden;,}".split(",")),e.IComponent=function(){},e.IDragTarget=function(){},e.DragTarget=function(){},e.DragTarget.prototype.onDragEnter=function(t){},e.DragTarget.prototype.onDragOver=function(t){},e.DragTarget.prototype.onDragExit=function(t){},e.DragTarget.prototype.onDrop=function(t){},e.DragTarget.prototype.shouldPreventMove=function(t){return!1},e.IDeleteArea=function(){},e.DeleteArea=function(){e.DeleteArea.superClass_.constructor.call(this),this.wouldDelete_=!1},e.utils.object.inherits(e.DeleteArea,e.DragTarget),e.DeleteArea.prototype.wouldDelete=function(t,n){return t instanceof e.BlockSvg?(t=!t.getParent()&&t.isDeletable(),this.updateWouldDelete_(t&&!n)):this.updateWouldDelete_(t.isDeletable()),this.wouldDelete_},e.DeleteArea.prototype.updateWouldDelete_=function(t){this.wouldDelete_=t},e.IFlyout=function(){},e.Flyout=function(t){e.Flyout.superClass_.constructor.call(this),t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new e.WorkspaceSvg(t),this.workspace_.setMetricsManager(new e.FlyoutMetricsManager(this.workspace_,this)),this.workspace_.isFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=e.utils.genUid(),this.RTL=!!t.RTL,this.horizontalLayout=!1,this.toolboxPosition_=t.toolboxPosition,this.eventWrappers_=[],this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.targetWorkspace=null},e.utils.object.inherits(e.Flyout,e.DeleteArea),e.Flyout.prototype.autoClose=!0,e.Flyout.prototype.isVisible_=!1,e.Flyout.prototype.containerVisible_=!0,e.Flyout.prototype.CORNER_RADIUS=8,e.Flyout.prototype.MARGIN=e.Flyout.prototype.CORNER_RADIUS,e.Flyout.prototype.GAP_X=3*e.Flyout.prototype.MARGIN,e.Flyout.prototype.GAP_Y=3*e.Flyout.prototype.MARGIN,e.Flyout.prototype.SCROLLBAR_MARGIN=2.5,e.Flyout.prototype.width_=0,e.Flyout.prototype.height_=0,e.Flyout.prototype.dragAngleRange_=70,e.Flyout.prototype.createDom=function(t){return this.svgGroup_=e.utils.dom.createSvgElement(t,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_},e.Flyout.prototype.init=function(t){this.targetWorkspace=t,this.workspace_.targetWorkspace=t,this.workspace_.scrollbar=new e.ScrollbarPair(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),Array.prototype.push.apply(this.eventWrappers_,e.browserEvents.conditionalBind(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,e.browserEvents.conditionalBind(this.svgBackground_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),t.getComponentManager().addComponent({component:this,weight:1,capabilities:[e.ComponentManager.Capability.DELETE_AREA,e.ComponentManager.Capability.DRAG_TARGET]})},e.Flyout.prototype.dispose=function(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id),e.browserEvents.unbind(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&(e.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace=this.svgBackground_=null},e.Flyout.prototype.getWidth=function(){return this.width_},e.Flyout.prototype.getHeight=function(){return this.height_},e.Flyout.prototype.getFlyoutScale=function(){return this.targetWorkspace.scale},e.Flyout.prototype.getWorkspace=function(){return this.workspace_},e.Flyout.prototype.isVisible=function(){return this.isVisible_},e.Flyout.prototype.setVisible=function(t){var n=t!=this.isVisible();this.isVisible_=t,n&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_())},e.Flyout.prototype.setContainerVisible=function(t){var n=t!=this.containerVisible_;this.containerVisible_=t,n&&this.updateDisplay_()},e.Flyout.prototype.updateDisplay_=function(){var t=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=t?"block":"none",this.workspace_.scrollbar.setContainerVisible(t)},e.Flyout.prototype.positionAt_=function(t,n,o,r){this.svgGroup_.setAttribute("width",t),this.svgGroup_.setAttribute("height",n),this.workspace_.setCachedParentSvgSize(t,n),"svg"==this.svgGroup_.tagName?e.utils.dom.setCssTransform(this.svgGroup_,"translate("+o+"px,"+r+"px)"):this.svgGroup_.setAttribute("transform","translate("+o+","+r+")"),(t=this.workspace_.scrollbar)&&(t.setOrigin(o,r),t.resize(),t.hScroll&&t.hScroll.setPosition(t.hScroll.position.x,t.hScroll.position.y),t.vScroll&&t.vScroll.setPosition(t.vScroll.position.x,t.vScroll.position.y))},e.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var n,t=0;n=this.listeners_[t];t++)e.browserEvents.unbind(n);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},e.Flyout.prototype.show=function(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof t&&(t=this.getDynamicCategoryContents_(t)),this.setVisible(!0),t=e.utils.toolbox.convertFlyoutDefToJsonArray(t),t=this.createFlyoutInfo_(t),this.layout_(t.contents,t.gaps),this.listeners_.push(e.browserEvents.conditionalBind(this.svgBackground_,"mouseover",this,function(){for(var r,n=this.workspace_.getTopBlocks(!1),o=0;r=n[o];o++)r.removeSelect()})),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_)},e.Flyout.prototype.createFlyoutInfo_=function(t){var n=[],o=[];this.permanentlyDisabled_.length=0;for(var h,r=this.horizontalLayout?this.GAP_X:this.GAP_Y,a=0;h=t[a];a++)switch(h.custom&&(h=this.getDynamicCategoryContents_(h.custom),h=e.utils.toolbox.convertFlyoutDefToJsonArray(h),t.splice.apply(t,[a,1].concat(h)),h=t[a]),h.kind.toUpperCase()){case"BLOCK":var R=h,L=this.getBlockXml_(R);h=this.createBlock_(L),R=parseInt(R.gap||L.getAttribute("gap"),10),o.push(isNaN(R)?r:R),n.push({type:"block",block:h});break;case"SEP":this.addSeparatorGap_(h,o,r);break;case"LABEL":h=this.createButton_(h,!0),n.push({type:"button",button:h}),o.push(r);break;case"BUTTON":h=this.createButton_(h,!1),n.push({type:"button",button:h}),o.push(r)}return{contents:n,gaps:o}},e.Flyout.prototype.getDynamicCategoryContents_=function(t){if("function"!=typeof(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");if(t=t(this.workspace_.targetWorkspace),!Array.isArray(t))throw new TypeError("Result of toolbox category callback must be an array.");return t},e.Flyout.prototype.createButton_=function(t,n){if(!e.FlyoutButton)throw Error("Missing require for Blockly.FlyoutButton");return new e.FlyoutButton(this.workspace_,this.targetWorkspace,t,n)},e.Flyout.prototype.createBlock_=function(t){return(t=e.Xml.domToBlock(t,this.workspace_)).isEnabled()||this.permanentlyDisabled_.push(t),t},e.Flyout.prototype.getBlockXml_=function(t){var n=null,o=t.blockxml;if(o&&"string"!=typeof o?n=o:o&&"string"==typeof o?(n=e.Xml.textToDom(o),t.blockxml=n):t.type&&((n=e.utils.xml.createElement("xml")).setAttribute("type",t.type),n.setAttribute("disabled",t.disabled),t.blockxml=n),!n)throw Error("Error: Invalid block definition. Block definition must have blockxml or type.");return n},e.Flyout.prototype.addSeparatorGap_=function(t,n,o){t=parseInt(t.gap,10),!isNaN(t)&&0<n.length?n[n.length-1]=t:n.push(o)},e.Flyout.prototype.clearOldBlocks_=function(){for(var o,t=this.workspace_.getTopBlocks(!1),n=0;o=t[n];n++)o.workspace==this.workspace_&&o.dispose(!1,!1);for(n=0;n<this.mats_.length;n++)(t=this.mats_[n])&&(e.Tooltip.unbindMouseEvents(t),e.utils.dom.removeNode(t));for(n=this.mats_.length=0;t=this.buttons_[n];n++)t.dispose();this.buttons_.length=0,this.workspace_.getPotentialVariableMap().clear()},e.Flyout.prototype.addBlockListeners_=function(t,n,o){this.listeners_.push(e.browserEvents.conditionalBind(t,"mousedown",null,this.blockMouseDown_(n))),this.listeners_.push(e.browserEvents.conditionalBind(o,"mousedown",null,this.blockMouseDown_(n))),this.listeners_.push(e.browserEvents.bind(t,"mouseenter",n,n.addSelect)),this.listeners_.push(e.browserEvents.bind(t,"mouseleave",n,n.removeSelect)),this.listeners_.push(e.browserEvents.bind(o,"mouseenter",n,n.addSelect)),this.listeners_.push(e.browserEvents.bind(o,"mouseleave",n,n.removeSelect))},e.Flyout.prototype.blockMouseDown_=function(t){var n=this;return function(o){var r=n.targetWorkspace.getGesture(o);r&&(r.setStartBlock(t),r.handleFlyoutStart(o,n))}},e.Flyout.prototype.onMouseDown_=function(t){var n=this.targetWorkspace.getGesture(t);n&&n.handleFlyoutStart(t,this)},e.Flyout.prototype.isBlockCreatable_=function(t){return t.isEnabled()},e.Flyout.prototype.createBlock=function(t){var n=null;e.Events.disable();var o=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{n=this.placeNewBlock_(t)}finally{e.Events.enable()}if(e.hideChaff(),t=e.Variables.getAddedVariables(this.targetWorkspace,o),e.Events.isEnabled()){for(e.Events.setGroup(!0),o=0;o<t.length;o++){var r=t[o];e.Events.fire(new(e.Events.get(e.Events.VAR_CREATE))(r))}e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(n))}return this.autoClose?this.hide():this.filterForCapacity_(),n},e.Flyout.prototype.initFlyoutButton_=function(t,n,o){var r=t.createDom();t.moveTo(n,o),t.show(),this.listeners_.push(e.browserEvents.conditionalBind(r,"mousedown",this,this.onMouseDown_)),this.buttons_.push(t)},e.Flyout.prototype.createRect_=function(t,n,o,r,a){return(n=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{"fill-opacity":0,x:n,y:o,height:r.height,width:r.width},null)).tooltip=t,e.Tooltip.bindMouseEvents(n),this.workspace_.getCanvas().insertBefore(n,t.getSvgRoot()),t.flyoutRect_=n,this.mats_[a]=n},e.Flyout.prototype.moveRectToBlock_=function(t,n){var o=n.getHeightWidth();t.setAttribute("width",o.width),t.setAttribute("height",o.height),n=n.getRelativeToSurfaceXY(),t.setAttribute("y",n.y),t.setAttribute("x",this.RTL?n.x-o.width:n.x)},e.Flyout.prototype.filterForCapacity_=function(){for(var o,t=this.workspace_.getTopBlocks(!1),n=0;o=t[n];n++)if(-1==this.permanentlyDisabled_.indexOf(o))for(var r=this.targetWorkspace.isCapacityAvailable(e.utils.getBlockTypeCounts(o));o;)o.setEnabled(r),o=o.getNextBlock()},e.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},e.Flyout.prototype.isScrollable=function(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()},e.Flyout.prototype.placeNewBlock_=function(t){var n=this.targetWorkspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered.");var o=e.Xml.blockToDom(t,!0);if(n.setResizesEnabled(!1),!(o=e.Xml.domToBlock(o,n)).getSvgRoot())throw Error("block is not rendered.");var r=n.getOriginOffsetInPixels(),a=this.workspace_.getOriginOffsetInPixels();return(t=t.getRelativeToSurfaceXY()).scale(this.workspace_.scale),t=e.utils.Coordinate.sum(a,t),(r=e.utils.Coordinate.difference(t,r)).scale(1/n.scale),o.moveBy(r.x,r.y),o},e.HorizontalFlyout=function(t){e.HorizontalFlyout.superClass_.constructor.call(this,t),this.horizontalLayout=!0},e.utils.object.inherits(e.HorizontalFlyout,e.Flyout),e.HorizontalFlyout.prototype.setMetrics_=function(t){if(this.isVisible()){var n=this.workspace_.getMetricsManager(),o=n.getScrollMetrics(),r=n.getViewMetrics();n=n.getAbsoluteMetrics(),"number"==typeof t.x&&(this.workspace_.scrollX=-(o.left+(o.width-r.width)*t.x)),this.workspace_.translate(this.workspace_.scrollX+n.left,this.workspace_.scrollY+n.top)}},e.HorizontalFlyout.prototype.getX=function(){return 0},e.HorizontalFlyout.prototype.getY=function(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager(),n=t.getAbsoluteMetrics(),o=t.getViewMetrics();t=t.getToolboxMetrics();var r=this.toolboxPosition_==e.utils.toolbox.Position.TOP;return this.targetWorkspace.toolboxPosition==this.toolboxPosition_?this.targetWorkspace.getToolbox()?r?t.height:o.height-this.height_:r?0:o.height:r?0:o.height+n.top-this.height_},e.HorizontalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=t.width,this.setBackgroundPath_(t.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),t=this.getX();var n=this.getY();this.positionAt_(this.width_,this.height_,t,n)}},e.HorizontalFlyout.prototype.setBackgroundPath_=function(t,n){var o=this.toolboxPosition_==e.utils.toolbox.Position.TOP,r=["M 0,"+(o?0:this.CORNER_RADIUS)];o?(r.push("h",t+2*this.CORNER_RADIUS),r.push("v",n),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("h",-t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),r.push("h",t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("v",n),r.push("h",-t-2*this.CORNER_RADIUS)),r.push("z"),this.svgBackground_.setAttribute("d",r.join(" "))},e.HorizontalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setX(this.RTL?1/0:0)},e.HorizontalFlyout.prototype.wheel_=function(t){var n=e.utils.getScrollDeltaPixels(t);if(n=n.x||n.y){var o=this.workspace_.getMetricsManager(),r=o.getScrollMetrics();n=o.getViewMetrics().left-r.left+n,this.workspace_.scrollbar.setX(n),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()}t.preventDefault(),t.stopPropagation()},e.HorizontalFlyout.prototype.layout_=function(t,n){this.workspace_.scale=this.targetWorkspace.scale;var o=this.MARGIN,r=o+this.tabWidth_;this.RTL&&(t=t.reverse());for(var h,a=0;h=t[a];a++)if("block"==h.type){for(var W,R=(h=h.block).getDescendants(!1),L=0;W=R[L];L++)W.isInFlyout=!0;h.render(),R=h.getSvgRoot(),L=h.getHeightWidth(),W=h.outputConnection?this.tabWidth_:0,h.moveBy(W=this.RTL?r+L.width:r-W,o),W=this.createRect_(h,W,o,L,a),r+=L.width+n[a],this.addBlockListeners_(R,h,W)}else"button"==h.type&&(this.initFlyoutButton_(h.button,r,o),r+=h.button.width+n[a])},e.HorizontalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var n=this.dragAngleRange_;return t<90+n&&t>90-n||t>-90-n&&t<-90+n},e.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var t=this.svgGroup_.getBoundingClientRect(),n=t.top;return this.toolboxPosition_==e.utils.toolbox.Position.TOP?new e.utils.Rect(-1e9,n+t.height,-1e9,1e9):new e.utils.Rect(n,1e9,-1e9,1e9)},e.HorizontalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var r,t=0,n=this.workspace_.getTopBlocks(!1),o=0;r=n[o];o++)t=Math.max(t,r.getHeightWidth().height);if(t+=1.5*this.MARGIN,t*=this.workspace_.scale,this.height_!=(t+=e.Scrollbar.scrollbarThickness)){for(o=0;r=n[o];o++)r.flyoutRect_&&this.moveRectToBlock_(r.flyoutRect_,r);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=e.utils.toolbox.Position.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+t),this.height_=t,this.position(),this.targetWorkspace.recordDragTargets()}},e.registry.register(e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,e.registry.DEFAULT,e.HorizontalFlyout),e.VerticalFlyout=function(t){e.VerticalFlyout.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.VerticalFlyout,e.Flyout),e.VerticalFlyout.registryName="verticalFlyout",e.VerticalFlyout.prototype.setMetrics_=function(t){if(this.isVisible()){var n=this.workspace_.getMetricsManager(),o=n.getScrollMetrics(),r=n.getViewMetrics();n=n.getAbsoluteMetrics(),"number"==typeof t.y&&(this.workspace_.scrollY=-(o.top+(o.height-r.height)*t.y)),this.workspace_.translate(this.workspace_.scrollX+n.left,this.workspace_.scrollY+n.top)}},e.VerticalFlyout.prototype.getX=function(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager(),n=t.getAbsoluteMetrics(),o=t.getViewMetrics();return t=t.getToolboxMetrics(),this.targetWorkspace.toolboxPosition==this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_==e.utils.toolbox.Position.LEFT?t.width:o.width-this.width_:this.toolboxPosition_==e.utils.toolbox.Position.LEFT?0:o.width:this.toolboxPosition_==e.utils.toolbox.Position.LEFT?0:o.width+n.left-this.width_},e.VerticalFlyout.prototype.getY=function(){return 0},e.VerticalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=t.height,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,t.height-2*this.CORNER_RADIUS),t=this.getX();var n=this.getY();this.positionAt_(this.width_,this.height_,t,n)}},e.VerticalFlyout.prototype.setBackgroundPath_=function(t,n){var o=this.toolboxPosition_==e.utils.toolbox.Position.RIGHT,r=t+this.CORNER_RADIUS;(r=["M "+(o?r:0)+",0"]).push("h",o?-t:t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("v",Math.max(0,n)),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("h",o?t:-t),r.push("z"),this.svgBackground_.setAttribute("d",r.join(" "))},e.VerticalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setY(0)},e.VerticalFlyout.prototype.wheel_=function(t){var n=e.utils.getScrollDeltaPixels(t);if(n.y){var o=this.workspace_.getMetricsManager(),r=o.getScrollMetrics();n=o.getViewMetrics().top-r.top+n.y,this.workspace_.scrollbar.setY(n),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()}t.preventDefault(),t.stopPropagation()},e.VerticalFlyout.prototype.layout_=function(t,n){this.workspace_.scale=this.targetWorkspace.scale;for(var h,o=this.MARGIN,r=this.RTL?o:o+this.tabWidth_,a=0;h=t[a];a++)if("block"==h.type){for(var W,R=(h=h.block).getDescendants(!1),L=0;W=R[L];L++)W.isInFlyout=!0;h.render(),R=h.getSvgRoot(),L=h.getHeightWidth(),h.moveBy(W=h.outputConnection?r-this.tabWidth_:r,o),W=this.createRect_(h,this.RTL?W-L.width:W,o,L,a),this.addBlockListeners_(R,h,W),o+=L.height+n[a]}else"button"==h.type&&(this.initFlyoutButton_(h.button,r,o),o+=h.button.height+n[a])},e.VerticalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var n=this.dragAngleRange_;return t<n&&t>-n||t<-180+n||t>180-n},e.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var t=this.svgGroup_.getBoundingClientRect(),n=t.left;return this.toolboxPosition_==e.utils.toolbox.Position.LEFT?new e.utils.Rect(-1e9,1e9,-1e9,n+t.width):new e.utils.Rect(-1e9,1e9,n,1e9)},e.VerticalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var r,t=0,n=this.workspace_.getTopBlocks(!1),o=0;r=n[o];o++){var a=r.getHeightWidth().width;r.outputConnection&&(a-=this.tabWidth_),t=Math.max(t,a)}for(o=0;r=this.buttons_[o];o++)t=Math.max(t,r.width);if(t+=1.5*this.MARGIN+this.tabWidth_,t*=this.workspace_.scale,this.width_!=(t+=e.Scrollbar.scrollbarThickness)){for(o=0;r=n[o];o++){if(this.RTL){a=r.getRelativeToSurfaceXY().x;var h=t/this.workspace_.scale-this.MARGIN;r.outputConnection||(h-=this.tabWidth_),r.moveBy(h-a,0)}r.flyoutRect_&&this.moveRectToBlock_(r.flyoutRect_,r)}if(this.RTL)for(o=0;r=this.buttons_[o];o++)n=r.getPosition().y,r.moveTo(t/this.workspace_.scale-r.width-this.MARGIN-this.tabWidth_,n);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=e.utils.toolbox.Position.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+t,this.targetWorkspace.scrollY),this.width_=t,this.position(),this.targetWorkspace.recordDragTargets()}},e.registry.register(e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,e.registry.DEFAULT,e.VerticalFlyout),e.FlyoutButton=function(t,n,o,r){this.workspace_=t,this.targetWorkspace_=n,this.text_=o.text,this.position_=new e.utils.Coordinate(0,0),this.isLabel_=r,this.callbackKey_=o.callbackKey||o.callbackkey,this.cssClass_=o["web-class"]||null,this.onMouseUpWrapper_=null,this.info=o},e.FlyoutButton.MARGIN_X=5,e.FlyoutButton.MARGIN_Y=2,e.FlyoutButton.prototype.width=0,e.FlyoutButton.prototype.height=0,e.FlyoutButton.prototype.createDom=function(){var t=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";if(this.cssClass_&&(t+=" "+this.cssClass_),this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:t},this.workspace_.getCanvas()),!this.isLabel_)var n=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_);t=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var o=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_),r=e.utils.replaceMessageReferences(this.text_);this.workspace_.RTL&&(r+="\u200f"),o.textContent=r,this.isLabel_&&(this.svgText_=o,this.workspace_.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));var a=e.utils.style.getComputedStyle(o,"fontSize"),h=e.utils.style.getComputedStyle(o,"fontWeight"),R=e.utils.style.getComputedStyle(o,"fontFamily");return this.width=e.utils.dom.getFastTextWidthWithSizeString(o,a,h,R),r=e.utils.dom.measureFontMetrics(r,a,h,R),this.height=r.height,this.isLabel_||(this.width+=2*e.FlyoutButton.MARGIN_X,this.height+=2*e.FlyoutButton.MARGIN_Y,n.setAttribute("width",this.width),n.setAttribute("height",this.height)),t.setAttribute("width",this.width),t.setAttribute("height",this.height),o.setAttribute("x",this.width/2),o.setAttribute("y",this.height/2-r.height/2+r.baseline),this.updateTransform_(),this.onMouseUpWrapper_=e.browserEvents.conditionalBind(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},e.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},e.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},e.FlyoutButton.prototype.moveTo=function(t,n){this.position_.x=t,this.position_.y=n,this.updateTransform_()},e.FlyoutButton.prototype.isLabel=function(){return this.isLabel_},e.FlyoutButton.prototype.getPosition=function(){return this.position_},e.FlyoutButton.prototype.getButtonText=function(){return this.text_},e.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},e.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&e.browserEvents.unbind(this.onMouseUpWrapper_),this.svgGroup_&&e.utils.dom.removeNode(this.svgGroup_),this.svgText_&&this.workspace_.getThemeManager().unsubscribe(this.svgText_)},e.FlyoutButton.prototype.onMouseUp_=function(t){(t=this.targetWorkspace_.getGesture(t))&&t.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace_.getButtonCallback(this.callbackKey_)?this.isLabel_||this.targetWorkspace_.getButtonCallback(this.callbackKey_)(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)},e.Css.register(".blocklyFlyoutButton {,fill: #888;,cursor: default;,},.blocklyFlyoutButtonShadow {,fill: #666;,},.blocklyFlyoutButton:hover {,fill: #aaa;,},.blocklyFlyoutLabel {,cursor: default;,},.blocklyFlyoutLabelBackground {,opacity: 0;,}".split(",")),e.Generator=function(t){this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")},e.Generator.prototype.INFINITE_LOOP_TRAP=null,e.Generator.prototype.STATEMENT_PREFIX=null,e.Generator.prototype.STATEMENT_SUFFIX=null,e.Generator.prototype.INDENT="  ",e.Generator.prototype.COMMENT_WRAP=60,e.Generator.prototype.ORDER_OVERRIDES=[],e.Generator.prototype.isInitialized=null,e.Generator.prototype.workspaceToCode=function(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=e.getMainWorkspace());var n=[];this.init(t),t=t.getTopBlocks(!0);for(var r,o=0;r=t[o];o++){var a=this.blockToCode(r);Array.isArray(a)&&(a=a[0]),a&&(r.outputConnection&&(a=this.scrubNakedValue(a),this.STATEMENT_PREFIX&&!r.suppressPrefixSuffix&&(a=this.injectId(this.STATEMENT_PREFIX,r)+a),this.STATEMENT_SUFFIX&&!r.suppressPrefixSuffix&&(a+=this.injectId(this.STATEMENT_SUFFIX,r))),n.push(a))}return n=n.join("\n"),(n=(n=(n=this.finish(n)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")},e.Generator.prototype.prefixLines=function(t,n){return n+t.replace(/(?!\n$)\n/g,"\n"+n)},e.Generator.prototype.allNestedComments=function(t){var n=[];t=t.getDescendants(!0);for(var o=0;o<t.length;o++){var r=t[o].getCommentText();r&&n.push(r)}return n.length&&n.push(""),n.join("\n")},e.Generator.prototype.blockToCode=function(t,n){if(!1===this.isInitialized&&console.warn("Generator init was not called before blockToCode was called."),!t)return"";if(!t.isEnabled())return n?"":this.blockToCode(t.getNextBlock());if(t.isInsertionMarker())return n?"":this.blockToCode(t.getChildren(!1)[0]);var o=this[t.type];if("function"!=typeof o)throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+t.type+'".');if(o=o.call(t,t),Array.isArray(o)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,o[0],n),o[1]]}if("string"==typeof o)return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(o=this.injectId(this.STATEMENT_PREFIX,t)+o),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(o+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,o,n);if(null===o)return"";throw SyntaxError("Invalid code generated: "+o)},e.Generator.prototype.valueToCode=function(t,n,o){if(isNaN(o))throw TypeError("Expecting valid order from block: "+t.type);var r=t.getInputTargetBlock(n);if(!r||""===(n=this.blockToCode(r)))return"";if(!Array.isArray(n))throw TypeError("Expecting tuple from value block: "+r.type);if(t=n[0],n=n[1],isNaN(n))throw TypeError("Expecting valid order from value block: "+r.type);if(!t)return"";r=!1;var a=Math.floor(o),h=Math.floor(n);if(a<=h&&(a!=h||0!=a&&99!=a))for(r=!0,a=0;a<this.ORDER_OVERRIDES.length;a++)if(this.ORDER_OVERRIDES[a][0]==o&&this.ORDER_OVERRIDES[a][1]==n){r=!1;break}return r&&(t="("+t+")"),t},e.Generator.prototype.statementToCode=function(t,n){if(t=t.getInputTargetBlock(n),"string"!=typeof(n=this.blockToCode(t)))throw TypeError("Expecting code from statement block: "+(t&&t.type));return n&&(n=this.prefixLines(n,this.INDENT)),n},e.Generator.prototype.addLoopTrap=function(t,n){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,n),this.INDENT)+t),this.STATEMENT_SUFFIX&&!n.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,n),this.INDENT)+t),this.STATEMENT_PREFIX&&!n.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,n),this.INDENT)),t},e.Generator.prototype.injectId=function(t,n){return n=n.id.replace(/\$/g,"$$$$"),t.replace(/%1/g,"'"+n+"'")},e.Generator.prototype.RESERVED_WORDS_="",e.Generator.prototype.addReservedWords=function(t){this.RESERVED_WORDS_+=t+","},e.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",Object.defineProperty(e.Generator.prototype,"variableDB_",{get:function(){return e.utils.deprecation.warn("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_},set:function(t){e.utils.deprecation.warn("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_=t}}),e.Generator.prototype.provideFunction_=function(t,n){if(!this.definitions_[t]){var r,o=this.nameDB_.getDistinctName(t,e.PROCEDURE_CATEGORY_NAME);for(this.functionNames_[t]=o,n=n.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,o);r!=n;)r=n,n=n.replace(/^(( {2})*) {2}/gm,"$1\0");n=n.replace(/\0/g,this.INDENT),this.definitions_[t]=n}return this.functionNames_[t]},e.Generator.prototype.init=function(t){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)},e.Generator.prototype.scrub_=function(t,n,o){return n},e.Generator.prototype.finish=function(t){return delete this.definitions_,delete this.functionNames_,t},e.Generator.prototype.scrubNakedValue=function(t){return t},e.IToolboxItem=function(){},e.ISelectableToolboxItem=function(){},e.ICollapsibleToolboxItem=function(){},e.ToolboxItem=function(t,n,o){this.id_=t.toolboxitemid||e.utils.IdGenerator.getNextUniqueId(),this.level_=(this.parent_=o||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=t,this.parentToolbox_=n,this.workspace_=this.parentToolbox_.getWorkspace()},e.ToolboxItem.prototype.init=function(){},e.ToolboxItem.prototype.getDiv=function(){return null},e.ToolboxItem.prototype.getId=function(){return this.id_},e.ToolboxItem.prototype.getParent=function(){return null},e.ToolboxItem.prototype.getLevel=function(){return this.level_},e.ToolboxItem.prototype.isSelectable=function(){return!1},e.ToolboxItem.prototype.isCollapsible=function(){return!1},e.ToolboxItem.prototype.dispose=function(){},e.ToolboxCategory=function(t,n,o){e.ToolboxCategory.superClass_.constructor.call(this,t,n,o),this.name_=e.utils.replaceMessageReferences(t.name),this.colour_=this.getColour_(t),this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.cssConfig_=this.makeDefaultCssConfig_(),e.utils.object.mixin(this.cssConfig_,t.cssconfig||t.cssConfig),this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.parseContents_(t)},e.utils.object.inherits(e.ToolboxCategory,e.ToolboxItem),e.ToolboxCategory.registrationName="category",e.ToolboxCategory.nestedPadding=19,e.ToolboxCategory.borderWidth=8,e.ToolboxCategory.defaultBackgroundColour="#57e",e.ToolboxCategory.prototype.makeDefaultCssConfig_=function(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}},e.ToolboxCategory.prototype.parseContents_=function(t){var n=t.contents;if(t.custom)this.flyoutItems_=t.custom;else if(n){t=0;for(var o;o=n[t];t++)this.flyoutItems_.push(o)}},e.ToolboxCategory.prototype.init=function(){this.createDom_(),"true"==this.toolboxItemDef_.hidden&&this.hide()},e.ToolboxCategory.prototype.createDom_=function(){return this.htmlDiv_=this.createContainer_(),e.utils.aria.setRole(this.htmlDiv_,e.utils.aria.Role.TREEITEM),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.SELECTED,!1),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),e.utils.aria.setRole(this.iconDom_,e.utils.aria.Role.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.LABELLEDBY,this.labelDom_.getAttribute("id")),this.addColourBorder_(this.colour_),this.htmlDiv_},e.ToolboxCategory.prototype.createContainer_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,this.cssConfig_.container),t},e.ToolboxCategory.prototype.createRowContainer_=function(){var t=document.createElement("div");e.utils.dom.addClass(t,this.cssConfig_.row);var n=e.ToolboxCategory.nestedPadding*this.getLevel();return n=n.toString()+"px",this.workspace_.RTL?t.style.paddingRight=n:t.style.paddingLeft=n,t},e.ToolboxCategory.prototype.createRowContentsContainer_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,this.cssConfig_.rowcontentcontainer),t},e.ToolboxCategory.prototype.createIconDom_=function(){var t=document.createElement("span");return this.parentToolbox_.isHorizontal()||e.utils.dom.addClass(t,this.cssConfig_.icon),t.style.display="inline-block",t},e.ToolboxCategory.prototype.createLabelDom_=function(t){var n=document.createElement("span");return n.setAttribute("id",this.getId()+".label"),n.textContent=t,e.utils.dom.addClass(n,this.cssConfig_.label),n},e.ToolboxCategory.prototype.refreshTheme=function(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)},e.ToolboxCategory.prototype.addColourBorder_=function(t){t&&(t=e.ToolboxCategory.borderWidth+"px solid "+(t||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=t:this.rowDiv_.style.borderLeft=t)},e.ToolboxCategory.prototype.getColour_=function(t){var n=t.categorystyle||t.categoryStyle;return(t=t.colour)&&n?(console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour'),""):n?this.getColourfromStyle_(n):this.parseColour_(t)},e.ToolboxCategory.prototype.getColourfromStyle_=function(t){var n=this.workspace_.getTheme();if(t&&n){if((n=n.categoryStyles[t])&&n.colour)return this.parseColour_(n.colour);console.warn('Style "'+t+'" must exist and contain a colour value')}return""},e.ToolboxCategory.prototype.getClickTarget=function(){return this.rowDiv_},e.ToolboxCategory.prototype.parseColour_=function(t){if(null==(t=e.utils.replaceMessageReferences(t))||""===t)return"";var n=Number(t);return isNaN(n)?(n=e.utils.colour.parse(t))?n:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+t),""):e.hueToHex(n)},e.ToolboxCategory.prototype.openIcon_=function(t){t&&(e.utils.dom.removeClasses(t,this.cssConfig_.closedicon),e.utils.dom.addClass(t,this.cssConfig_.openicon))},e.ToolboxCategory.prototype.closeIcon_=function(t){t&&(e.utils.dom.removeClasses(t,this.cssConfig_.openicon),e.utils.dom.addClass(t,this.cssConfig_.closedicon))},e.ToolboxCategory.prototype.setVisible_=function(t){this.htmlDiv_.style.display=t?"block":"none",this.isHidden_=!t,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},e.ToolboxCategory.prototype.hide=function(){this.setVisible_(!1)},e.ToolboxCategory.prototype.show=function(){this.setVisible_(!0)},e.ToolboxCategory.prototype.isVisible=function(){return!this.isHidden_&&this.allAncestorsExpanded_()},e.ToolboxCategory.prototype.allAncestorsExpanded_=function(){for(var t=this;t.getParent();)if(!(t=t.getParent()).isExpanded())return!1;return!0},e.ToolboxCategory.prototype.isSelectable=function(){return this.isVisible()&&!this.isDisabled_},e.ToolboxCategory.prototype.onClick=function(t){},e.ToolboxCategory.prototype.setSelected=function(t){if(t){var n=this.parseColour_(e.ToolboxCategory.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||n,e.utils.dom.addClass(this.rowDiv_,this.cssConfig_.selected)}else this.rowDiv_.style.backgroundColor="",e.utils.dom.removeClass(this.rowDiv_,this.cssConfig_.selected);e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.SELECTED,t)},e.ToolboxCategory.prototype.setDisabled=function(t){this.isDisabled_=t,this.getDiv().setAttribute("disabled",t),t?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")},e.ToolboxCategory.prototype.getName=function(){return this.name_},e.ToolboxCategory.prototype.getParent=function(){return this.parent_},e.ToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},e.ToolboxCategory.prototype.getContents=function(){return this.flyoutItems_},e.ToolboxCategory.prototype.updateFlyoutContents=function(t){this.flyoutItems_=[],"string"==typeof t?this.toolboxItemDef_.custom=t:(delete this.toolboxItemDef_.custom,this.toolboxItemDef_.contents=e.utils.toolbox.convertFlyoutDefToJsonArray(t)),this.parseContents_(this.toolboxItemDef_)},e.ToolboxCategory.prototype.dispose=function(){e.utils.dom.removeNode(this.htmlDiv_)},e.Css.register([".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: rgba(255, 255, 255, 0.2);","}",'.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {',"margin: 1px 5px 1px 0;","}",'.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {',"margin: 1px 0 1px 5px;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","padding-right: 0px","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","visibility: hidden;","width: 16px;","}",".blocklyTreeIconClosed {","background-position: -32px -1px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {',"background-position: 0 -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosed {","background-position: -32px -17px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {',"background-position: 0 -17px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeLabel {","cursor: default;","font: 16px sans-serif;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}"]),e.registry.register(e.registry.Type.TOOLBOX_ITEM,e.ToolboxCategory.registrationName,e.ToolboxCategory),e.ToolboxSeparator=function(t,n){e.ToolboxSeparator.superClass_.constructor.call(this,t,n),this.cssConfig_={container:"blocklyTreeSeparator"},e.utils.object.mixin(this.cssConfig_,t.cssconfig||t.cssConfig)},e.utils.object.inherits(e.ToolboxSeparator,e.ToolboxItem),e.ToolboxSeparator.registrationName="sep",e.ToolboxSeparator.prototype.init=function(){this.createDom_()},e.ToolboxSeparator.prototype.createDom_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,this.cssConfig_.container),this.htmlDiv_=t},e.ToolboxSeparator.prototype.getDiv=function(){return this.htmlDiv_},e.ToolboxSeparator.prototype.dispose=function(){e.utils.dom.removeNode(this.htmlDiv_)},e.Css.register('.blocklyTreeSeparator {,border-bottom: solid #e5e5e5 1px;,height: 0;,margin: 5px 0;,},.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {,border-right: solid #e5e5e5 1px;,border-bottom: none;,height: auto;,margin: 0 5px 0 5px;,padding: 5px 0;,width: 0;,}'.split(",")),e.registry.register(e.registry.Type.TOOLBOX_ITEM,e.ToolboxSeparator.registrationName,e.ToolboxSeparator),e.CollapsibleToolboxCategory=function(t,n,o){this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[],e.CollapsibleToolboxCategory.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.CollapsibleToolboxCategory,e.ToolboxCategory),e.CollapsibleToolboxCategory.registrationName="collapsibleCategory",e.CollapsibleToolboxCategory.prototype.makeDefaultCssConfig_=function(){var t=e.CollapsibleToolboxCategory.superClass_.makeDefaultCssConfig_.call(this);return t.contents="blocklyToolboxContents",t},e.CollapsibleToolboxCategory.prototype.parseContents_=function(t){var n=t.contents,o=!0;if(t.custom)this.flyoutItems_=t.custom;else if(n){t=0;for(var r;r=n[t];t++)!e.registry.hasItem(e.registry.Type.TOOLBOX_ITEM,r.kind)||r.kind.toLowerCase()==e.ToolboxSeparator.registrationName&&o?(this.flyoutItems_.push(r),o=!0):(this.createToolboxItem_(r),o=!1)}},e.CollapsibleToolboxCategory.prototype.createToolboxItem_=function(t){var n=t.kind;"CATEGORY"==n.toUpperCase()&&e.utils.toolbox.isCategoryCollapsible(t)&&(n=e.CollapsibleToolboxCategory.registrationName),t=new(e.registry.getClass(e.registry.Type.TOOLBOX_ITEM,n))(t,this.parentToolbox_,this),this.toolboxItems_.push(t)},e.CollapsibleToolboxCategory.prototype.init=function(){e.CollapsibleToolboxCategory.superClass_.init.call(this),this.setExpanded("true"==this.toolboxItemDef_.expanded||this.toolboxItemDef_.expanded)},e.CollapsibleToolboxCategory.prototype.createDom_=function(){e.CollapsibleToolboxCategory.superClass_.createDom_.call(this);var t=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(t),e.utils.aria.setRole(this.subcategoriesDiv_,e.utils.aria.Role.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_},e.CollapsibleToolboxCategory.prototype.createIconDom_=function(){var t=document.createElement("span");return this.parentToolbox_.isHorizontal()||(e.utils.dom.addClass(t,this.cssConfig_.icon),t.style.visibility="visible"),t.style.display="inline-block",t},e.CollapsibleToolboxCategory.prototype.createSubCategoriesDom_=function(t){var n=document.createElement("div");e.utils.dom.addClass(n,this.cssConfig_.contents);for(var o=0;o<t.length;o++){var r=t[o];r.init();var a=r.getDiv();n.appendChild(a),r.getClickTarget&&r.getClickTarget().setAttribute("id",r.getId())}return n},e.CollapsibleToolboxCategory.prototype.setExpanded=function(t){this.expanded_!=t&&((this.expanded_=t)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.EXPANDED,t),this.parentToolbox_.handleToolboxItemResize())},e.CollapsibleToolboxCategory.prototype.setVisible_=function(t){this.htmlDiv_.style.display=t?"block":"none";for(var o,n=0;o=this.getChildToolboxItems()[n];n++)o.setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},e.CollapsibleToolboxCategory.prototype.isExpanded=function(){return this.expanded_},e.CollapsibleToolboxCategory.prototype.isCollapsible=function(){return!0},e.CollapsibleToolboxCategory.prototype.onClick=function(t){this.toggleExpanded()},e.CollapsibleToolboxCategory.prototype.toggleExpanded=function(){this.setExpanded(!this.expanded_)},e.CollapsibleToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},e.CollapsibleToolboxCategory.prototype.getChildToolboxItems=function(){return this.toolboxItems_},e.registry.register(e.registry.Type.TOOLBOX_ITEM,e.CollapsibleToolboxCategory.registrationName,e.CollapsibleToolboxCategory),e.Events.ToolboxItemSelect=function(t,n,o){e.Events.ToolboxItemSelect.superClass_.constructor.call(this,o),this.oldItem=t,this.newItem=n},e.utils.object.inherits(e.Events.ToolboxItemSelect,e.Events.UiBase),e.Events.ToolboxItemSelect.prototype.type=e.Events.TOOLBOX_ITEM_SELECT,e.Events.ToolboxItemSelect.prototype.toJson=function(){var t=e.Events.ToolboxItemSelect.superClass_.toJson.call(this);return t.oldItem=this.oldItem,t.newItem=this.newItem,t},e.Events.ToolboxItemSelect.prototype.fromJson=function(t){e.Events.ToolboxItemSelect.superClass_.fromJson.call(this,t),this.oldItem=t.oldItem,this.newItem=t.newItem},e.registry.register(e.registry.Type.EVENT,e.Events.TOOLBOX_ITEM_SELECT,e.Events.ToolboxItemSelect),e.IAutoHideable=function(){},e.IStyleable=function(){},e.IToolbox=function(){},e.Toolbox=function(t){e.Toolbox.superClass_.constructor.call(this),this.workspace_=t,this.id="toolbox",this.toolboxDef_=t.options.languageTree||{contents:[]},this.horizontalLayout_=t.options.horizontalLayout,this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.RTL=t.options.RTL,this.flyout_=null,this.contentMap_=Object.create(null),this.toolboxPosition=t.options.toolboxPosition,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[]},e.utils.object.inherits(e.Toolbox,e.DeleteArea),e.Toolbox.prototype.onShortcut=function(t){return!1},e.Toolbox.prototype.init=function(){var t=this.workspace_,n=t.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),e.utils.dom.insertAfter(this.flyout_.createDom("svg"),n),this.setVisible(!0),this.flyout_.init(t),this.render(this.toolboxDef_),(t=t.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),t.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[e.ComponentManager.Capability.AUTOHIDEABLE,e.ComponentManager.Capability.DELETE_AREA,e.ComponentManager.Capability.DRAG_TARGET]})},e.Toolbox.prototype.createDom_=function(t){t=t.getParentSvg();var n=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,e.utils.aria.setRole(this.contentsDiv_,e.utils.aria.Role.TREE),n.appendChild(this.contentsDiv_),t.parentNode.insertBefore(n,t),this.attachEvents_(n,this.contentsDiv_),n},e.Toolbox.prototype.createContainer_=function(){var t=document.createElement("div");return t.setAttribute("layout",this.isHorizontal()?"h":"v"),e.utils.dom.addClass(t,"blocklyToolboxDiv"),e.utils.dom.addClass(t,"blocklyNonSelectable"),t.setAttribute("dir",this.RTL?"RTL":"LTR"),t},e.Toolbox.prototype.createContentsContainer_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,"blocklyToolboxContents"),this.isHorizontal()&&(t.style.flexDirection="row"),t},e.Toolbox.prototype.attachEvents_=function(t,n){t=e.browserEvents.conditionalBind(t,"click",this,this.onClick_,!1,!0),this.boundEvents_.push(t),n=e.browserEvents.conditionalBind(n,"keydown",this,this.onKeyDown_,!1,!0),this.boundEvents_.push(n)},e.Toolbox.prototype.onClick_=function(t){if(e.utils.isRightButton(t)||t.target==this.HtmlDiv)e.hideChaff(!1);else{var n=t.target.getAttribute("id");n&&(n=this.getToolboxItemById(n)).isSelectable()&&(this.setSelectedItem(n),n.onClick(t)),e.hideChaff(!0)}e.Touch.clearTouchIdentifier()},e.Toolbox.prototype.onKeyDown_=function(t){var n=!1;switch(t.keyCode){case e.utils.KeyCodes.DOWN:n=this.selectNext_();break;case e.utils.KeyCodes.UP:n=this.selectPrevious_();break;case e.utils.KeyCodes.LEFT:n=this.selectParent_();break;case e.utils.KeyCodes.RIGHT:n=this.selectChild_();break;case e.utils.KeyCodes.ENTER:case e.utils.KeyCodes.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),n=!0);break;default:n=!1}!n&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(n=this.selectedItem_.onKeyDown(t)),n&&t.preventDefault()},e.Toolbox.prototype.createFlyout_=function(){var t=this.workspace_,n=new e.Options({parentWorkspace:t,rtl:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,renderer:t.options.renderer,rendererOverrides:t.options.rendererOverrides,move:{scrollbars:!0}});return n.toolboxPosition=t.options.toolboxPosition,new(e.registry.getClassFromOptions(t.horizontalLayout?e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX:e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,t.options,!0))(n)},e.Toolbox.prototype.render=function(t){this.toolboxDef_=t;for(var n=0;n<this.contents_.length;n++){var o=this.contents_[n];o&&o.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(t.contents),this.position(),this.handleToolboxItemResize()},e.Toolbox.prototype.renderContents_=function(t){for(var r,n=document.createDocumentFragment(),o=0;r=t[o];o++)this.createToolboxItem_(r,n);this.contentsDiv_.appendChild(n)},e.Toolbox.prototype.createToolboxItem_=function(t,n){var o=t.kind;"CATEGORY"==o.toUpperCase()&&e.utils.toolbox.isCategoryCollapsible(t)&&(o=e.CollapsibleToolboxCategory.registrationName),(o=e.registry.getClass(e.registry.Type.TOOLBOX_ITEM,o.toLowerCase()))&&(t=new o(t,this),this.addToolboxItem_(t),t.init(),(o=t.getDiv())&&n.appendChild(o),t.getClickTarget&&t.getClickTarget().setAttribute("id",t.getId()))},e.Toolbox.prototype.addToolboxItem_=function(t){if(this.contents_.push(t),this.contentMap_[t.getId()]=t,t.isCollapsible())for(var o,n=0;o=t.getChildToolboxItems()[n];n++)this.addToolboxItem_(o)},e.Toolbox.prototype.getToolboxItems=function(){return this.contents_},e.Toolbox.prototype.addStyle=function(t){e.utils.dom.addClass(this.HtmlDiv,t)},e.Toolbox.prototype.removeStyle=function(t){e.utils.dom.removeClass(this.HtmlDiv,t)},e.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv||!this.isVisible_)return null;var t=this.HtmlDiv.getBoundingClientRect(),n=t.top,o=n+t.height,r=t.left;return t=r+t.width,this.toolboxPosition==e.utils.toolbox.Position.TOP?new e.utils.Rect(-1e7,o,-1e7,1e7):this.toolboxPosition==e.utils.toolbox.Position.BOTTOM?new e.utils.Rect(n,1e7,-1e7,1e7):this.toolboxPosition==e.utils.toolbox.Position.LEFT?new e.utils.Rect(-1e7,1e7,-1e7,t):new e.utils.Rect(-1e7,1e7,r,1e7)},e.Toolbox.prototype.wouldDelete=function(t,n){return this.updateWouldDelete_(t instanceof e.BlockSvg?!t.getParent()&&t.isDeletable():t.isDeletable()),this.wouldDelete_},e.Toolbox.prototype.onDragEnter=function(t){this.updateCursorDeleteStyle_(!0)},e.Toolbox.prototype.onDragExit=function(t){this.updateCursorDeleteStyle_(!1)},e.Toolbox.prototype.onDrop=function(t){this.updateCursorDeleteStyle_(!1)},e.Toolbox.prototype.updateWouldDelete_=function(t){t!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=t,this.updateCursorDeleteStyle_(!0))},e.Toolbox.prototype.updateCursorDeleteStyle_=function(t){var n=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";t?this.addStyle(n):this.removeStyle(n)},e.Toolbox.prototype.getToolboxItemById=function(t){return this.contentMap_[t]||null},e.Toolbox.prototype.getWidth=function(){return this.width_},e.Toolbox.prototype.getHeight=function(){return this.height_},e.Toolbox.prototype.getFlyout=function(){return this.flyout_},e.Toolbox.prototype.getWorkspace=function(){return this.workspace_},e.Toolbox.prototype.getSelectedItem=function(){return this.selectedItem_},e.Toolbox.prototype.getPreviouslySelectedItem=function(){return this.previouslySelectedItem_},e.Toolbox.prototype.isHorizontal=function(){return this.horizontalLayout_},e.Toolbox.prototype.position=function(){var t=this.workspace_.getMetrics(),n=this.HtmlDiv;n&&(this.horizontalLayout_?(n.style.left="0",n.style.height="auto",n.style.width="100%",this.height_=n.offsetHeight,this.width_=t.viewWidth,this.toolboxPosition==e.utils.toolbox.Position.TOP?n.style.top="0":n.style.bottom="0"):(this.toolboxPosition==e.utils.toolbox.Position.RIGHT?n.style.right="0":n.style.left="0",n.style.height="100%",this.width_=n.offsetWidth,this.height_=t.viewHeight),this.flyout_.position())},e.Toolbox.prototype.handleToolboxItemResize=function(){var t=this.workspace_,n=this.HtmlDiv.getBoundingClientRect();t.translate(this.toolboxPosition==e.utils.toolbox.Position.LEFT?t.scrollX+n.width:t.scrollX,this.toolboxPosition==e.utils.toolbox.Position.TOP?t.scrollY+n.height:t.scrollY),e.svgResize(t)},e.Toolbox.prototype.clearSelection=function(){this.setSelectedItem(null)},e.Toolbox.prototype.refreshTheme=function(){for(var t=0;t<this.contents_.length;t++){var n=this.contents_[t];n.refreshTheme&&n.refreshTheme()}},e.Toolbox.prototype.refreshSelection=function(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())},e.Toolbox.prototype.setVisible=function(t){this.isVisible_!==t&&(this.HtmlDiv.style.display=t?"block":"none",this.isVisible_=t,this.workspace_.recordDragTargets())},e.Toolbox.prototype.autoHide=function(t){!t&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()},e.Toolbox.prototype.setSelectedItem=function(t){var n=this.selectedItem_;!t&&!n||t&&!t.isSelectable()||(this.shouldDeselectItem_(n,t)&&null!=n&&this.deselectItem_(n),this.shouldSelectItem_(n,t)&&null!=t&&this.selectItem_(n,t),this.updateFlyout_(n,t),this.fireSelectEvent_(n,t))},e.Toolbox.prototype.shouldDeselectItem_=function(t,n){return null!=t&&(!t.isCollapsible()||t!=n)},e.Toolbox.prototype.shouldSelectItem_=function(t,n){return null!=n&&n!=t},e.Toolbox.prototype.deselectItem_=function(t){this.selectedItem_=null,this.previouslySelectedItem_=t,t.setSelected(!1),e.utils.aria.setState(this.contentsDiv_,e.utils.aria.State.ACTIVEDESCENDANT,"")},e.Toolbox.prototype.selectItem_=function(t,n){this.selectedItem_=n,this.previouslySelectedItem_=t,n.setSelected(!0),e.utils.aria.setState(this.contentsDiv_,e.utils.aria.State.ACTIVEDESCENDANT,n.getId())},e.Toolbox.prototype.selectItemByPosition=function(t){-1<t&&t<this.contents_.length&&(t=this.contents_[t]).isSelectable()&&this.setSelectedItem(t)},e.Toolbox.prototype.updateFlyout_=function(t,n){(t!=n||n.isCollapsible())&&n&&n.getContents().length?(this.flyout_.show(n.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()},e.Toolbox.prototype.fireSelectEvent_=function(t,n){var o=t&&t.getName(),r=n&&n.getName();t==n&&(r=null),t=new(e.Events.get(e.Events.TOOLBOX_ITEM_SELECT))(o,r,this.workspace_.id),e.Events.fire(t)},e.Toolbox.prototype.selectParent_=function(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.setExpanded(!1),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))},e.Toolbox.prototype.selectChild_=function(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;var t=this.selectedItem_;return t.isExpanded()?this.selectNext_():t.setExpanded(!0),!0},e.Toolbox.prototype.selectNext_=function(){if(!this.selectedItem_)return!1;var t=this.contents_.indexOf(this.selectedItem_)+1;if(-1<t&&t<this.contents_.length){for(var n=this.contents_[t];n&&!n.isSelectable();)n=this.contents_[++t];if(n&&n.isSelectable())return this.setSelectedItem(n),!0}return!1},e.Toolbox.prototype.selectPrevious_=function(){if(!this.selectedItem_)return!1;var t=this.contents_.indexOf(this.selectedItem_)-1;if(-1<t&&t<this.contents_.length){for(var n=this.contents_[t];n&&!n.isSelectable();)n=this.contents_[--t];if(n&&n.isSelectable())return this.setSelectedItem(n),!0}return!1},e.Toolbox.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var t=0;t<this.contents_.length;t++)this.contents_[t].dispose();for(t=0;t<this.boundEvents_.length;t++)e.browserEvents.unbind(this.boundEvents_[t]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),e.utils.dom.removeNode(this.HtmlDiv)},e.Css.register([".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyToolboxDiv {","background-color: #ddd;","overflow-x: visible;","overflow-y: auto;","padding: 4px 0 4px 0;","position: absolute;","z-index: 70;","-webkit-tap-highlight-color: transparent;","}",".blocklyToolboxContents {","display: flex;","flex-wrap: wrap;","flex-direction: column;","}",".blocklyToolboxContents:focus {","outline: none;","}"]),e.registry.register(e.registry.Type.TOOLBOX,e.registry.DEFAULT,e.Toolbox),e.Events.TrashcanOpen=function(t,n){e.Events.TrashcanOpen.superClass_.constructor.call(this,n),this.isOpen=t},e.utils.object.inherits(e.Events.TrashcanOpen,e.Events.UiBase),e.Events.TrashcanOpen.prototype.type=e.Events.TRASHCAN_OPEN,e.Events.TrashcanOpen.prototype.toJson=function(){var t=e.Events.TrashcanOpen.superClass_.toJson.call(this);return t.isOpen=this.isOpen,t},e.Events.TrashcanOpen.prototype.fromJson=function(t){e.Events.TrashcanOpen.superClass_.fromJson.call(this,t),this.isOpen=t.isOpen},e.registry.register(e.registry.Type.EVENT,e.Events.TRASHCAN_OPEN,e.Events.TrashcanOpen),e.IPositionable=function(){},e.uiPosition={},e.uiPosition.verticalPosition={TOP:0,BOTTOM:1},e.uiPosition.horizontalPosition={LEFT:0,RIGHT:1},e.uiPosition.bumpDirection={UP:0,DOWN:1},e.uiPosition.getStartPositionRect=function(t,n,o,r,a,h){var R=h.scrollbar&&h.scrollbar.canScrollVertically();return t.horizontal===e.uiPosition.horizontalPosition.LEFT?(o=a.absoluteMetrics.left+o,R&&h.RTL&&(o+=e.Scrollbar.scrollbarThickness)):(o=a.absoluteMetrics.left+a.viewMetrics.width-n.width-o,R&&!h.RTL&&(o-=e.Scrollbar.scrollbarThickness)),t.vertical===e.uiPosition.verticalPosition.TOP?t=a.absoluteMetrics.top+r:(t=a.absoluteMetrics.top+a.viewMetrics.height-n.height-r,h.scrollbar&&h.scrollbar.canScrollHorizontally()&&(t-=e.Scrollbar.scrollbarThickness)),new e.utils.Rect(t,t+n.height,o,o+n.width)},e.uiPosition.getCornerOppositeToolbox=function(t,n){return{horizontal:n.toolboxMetrics.position===e.utils.toolbox.Position.LEFT||t.horizontalLayout&&!t.RTL?e.uiPosition.horizontalPosition.RIGHT:e.uiPosition.horizontalPosition.LEFT,vertical:n.toolboxMetrics.position===e.utils.toolbox.Position.BOTTOM?e.uiPosition.verticalPosition.TOP:e.uiPosition.verticalPosition.BOTTOM}},e.uiPosition.bumpPositionRect=function(t,n,o,r){for(var W,a=t.left,h=t.right-t.left,R=t.bottom-t.top,L=0;W=r[L];L++)t.intersects(W)&&(t=new e.utils.Rect(t=o===e.uiPosition.bumpDirection.UP?W.top-R-n:W.bottom+n,t+R,a,a+h),L=-1);return t},e.Trashcan=function(t){e.Trashcan.superClass_.constructor.call(this),this.workspace_=t,this.id="trashcan",this.contents_=[],this.flyout=null,0>=this.workspace_.options.maxTrashcanContents||(t=new e.Options({scrollbars:!0,parentWorkspace:this.workspace_,rtl:this.workspace_.RTL,oneBasedIndex:this.workspace_.options.oneBasedIndex,renderer:this.workspace_.options.renderer,rendererOverrides:this.workspace_.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace_.horizontalLayout?(t.toolboxPosition=this.workspace_.toolboxPosition==e.utils.toolbox.Position.TOP?e.utils.toolbox.Position.BOTTOM:e.utils.toolbox.Position.TOP,this.flyout=new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace_.options,!0))(t)):(t.toolboxPosition=this.workspace_.toolboxPosition==e.utils.toolbox.Position.RIGHT?e.utils.toolbox.Position.LEFT:e.utils.toolbox.Position.RIGHT,this.flyout=new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.workspace_.options,!0))(t)),this.workspace_.addChangeListener(this.onDelete_.bind(this)))},e.utils.object.inherits(e.Trashcan,e.DeleteArea),e.Trashcan.prototype.WIDTH_=47,e.Trashcan.prototype.BODY_HEIGHT_=44,e.Trashcan.prototype.LID_HEIGHT_=16,e.Trashcan.prototype.MARGIN_VERTICAL_=20,e.Trashcan.prototype.MARGIN_HORIZONTAL_=20,e.Trashcan.prototype.MARGIN_HOTSPOT_=10,e.Trashcan.prototype.SPRITE_LEFT_=0,e.Trashcan.prototype.SPRITE_TOP_=32,e.Trashcan.prototype.HAS_BLOCKS_LID_ANGLE_=.1,e.Trashcan.ANIMATION_LENGTH_=80,e.Trashcan.ANIMATION_FRAMES_=4,e.Trashcan.OPACITY_MIN_=.4,e.Trashcan.OPACITY_MAX_=.8,e.Trashcan.MAX_LID_ANGLE_=45,e.Trashcan.prototype.isLidOpen=!1,e.Trashcan.prototype.minOpenness_=0,e.Trashcan.prototype.svgGroup_=null,e.Trashcan.prototype.svgLid_=null,e.Trashcan.prototype.lidTask_=0,e.Trashcan.prototype.lidOpen_=0,e.Trashcan.prototype.left_=0,e.Trashcan.prototype.top_=0,e.Trashcan.prototype.initialized_=!1,e.Trashcan.prototype.createDom=function(){this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyTrash"},null);var t=String(Math.random()).substring(2),n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},n);var o=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,x:-this.SPRITE_LEFT_,height:e.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup_);return o.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup_),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:this.WIDTH_,height:this.LID_HEIGHT_},n),this.svgLid_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,x:-this.SPRITE_LEFT_,height:e.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup_),this.svgLid_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),e.browserEvents.bind(this.svgGroup_,"mousedown",this,this.blockMouseDownWhenOpenable_),e.browserEvents.bind(this.svgGroup_,"mouseup",this,this.click),e.browserEvents.bind(o,"mouseover",this,this.mouseOver_),e.browserEvents.bind(o,"mouseout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_},e.Trashcan.prototype.init=function(){0<this.workspace_.options.maxTrashcanContents&&(e.utils.dom.insertAfter(this.flyout.createDom(e.utils.Svg.SVG),this.workspace_.getParentSvg()),this.flyout.init(this.workspace_)),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[e.ComponentManager.Capability.AUTOHIDEABLE,e.ComponentManager.Capability.DELETE_AREA,e.ComponentManager.Capability.DRAG_TARGET,e.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0,this.setLidOpen(!1)},e.Trashcan.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("trashcan"),this.svgGroup_&&(e.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,clearTimeout(this.lidTask_)},e.Trashcan.prototype.hasContents_=function(){return!!this.contents_.length},e.Trashcan.prototype.contentsIsOpen=function(){return this.flyout.isVisible()},e.Trashcan.prototype.openFlyout=function(){if(!this.contentsIsOpen()){var t=this.contents_.map(e.Xml.textToDom);this.flyout.show(t),this.fireUiEvent_(!0)}},e.Trashcan.prototype.closeFlyout=function(){this.contentsIsOpen()&&(this.flyout.hide(),this.fireUiEvent_(!1))},e.Trashcan.prototype.autoHide=function(t){!t&&this.flyout&&this.closeFlyout()},e.Trashcan.prototype.emptyContents=function(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())},e.Trashcan.prototype.position=function(t,n){if(this.initialized_){var o=e.uiPosition.getCornerOppositeToolbox(this.workspace_,t);t=e.uiPosition.getStartPositionRect(o,new e.utils.Size(this.WIDTH_,this.BODY_HEIGHT_+this.LID_HEIGHT_),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,t,this.workspace_),n=e.uiPosition.bumpPositionRect(t,this.MARGIN_VERTICAL_,o.vertical===e.uiPosition.verticalPosition.TOP?e.uiPosition.bumpDirection.DOWN:e.uiPosition.bumpDirection.UP,n),this.top_=n.top,this.left_=n.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},e.Trashcan.prototype.getBoundingRectangle=function(){return new e.utils.Rect(this.top_,this.top_+this.BODY_HEIGHT_+this.LID_HEIGHT_,this.left_,this.left_+this.WIDTH_)},e.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),n=t.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_;return new e.utils.Rect(n,n+this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_,t=t.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,t+this.WIDTH_+2*this.MARGIN_HOTSPOT_)},e.Trashcan.prototype.onDragOver=function(t){this.setLidOpen(this.wouldDelete_)},e.Trashcan.prototype.onDragExit=function(t){this.setLidOpen(!1)},e.Trashcan.prototype.onDrop=function(t){setTimeout(this.setLidOpen.bind(this,!1),100)},e.Trashcan.prototype.setLidOpen=function(t){this.isLidOpen!=t&&(clearTimeout(this.lidTask_),this.isLidOpen=t,this.animateLid_())},e.Trashcan.prototype.animateLid_=function(){var t=e.Trashcan.ANIMATION_FRAMES_,n=1/(t+1);this.lidOpen_+=this.isLidOpen?n:-n,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*e.Trashcan.MAX_LID_ANGLE_),this.svgGroup_.style.opacity=(n=e.Trashcan.OPACITY_MIN_)+this.lidOpen_*(e.Trashcan.OPACITY_MAX_-n),this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),e.Trashcan.ANIMATION_LENGTH_/t))},e.Trashcan.prototype.setLidAngle_=function(t){var n=this.workspace_.toolboxPosition==e.utils.toolbox.Position.RIGHT||this.workspace_.horizontalLayout&&this.workspace_.RTL;this.svgLid_.setAttribute("transform","rotate("+(n?-t:t)+","+(n?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")")},e.Trashcan.prototype.setMinOpenness_=function(t){this.minOpenness_=t,this.isLidOpen||this.setLidAngle_(t*e.Trashcan.MAX_LID_ANGLE_)},e.Trashcan.prototype.closeLid=function(){this.setLidOpen(!1)},e.Trashcan.prototype.click=function(){this.hasContents_()&&this.openFlyout()},e.Trashcan.prototype.fireUiEvent_=function(t){t=new(e.Events.get(e.Events.TRASHCAN_OPEN))(t,this.workspace_.id),e.Events.fire(t)},e.Trashcan.prototype.blockMouseDownWhenOpenable_=function(t){!this.contentsIsOpen()&&this.hasContents_()&&t.stopPropagation()},e.Trashcan.prototype.mouseOver_=function(){this.hasContents_()&&this.setLidOpen(!0)},e.Trashcan.prototype.mouseOut_=function(){this.setLidOpen(!1)},e.Trashcan.prototype.onDelete_=function(t){if(!(0>=this.workspace_.options.maxTrashcanContents)&&t.type==e.Events.BLOCK_DELETE&&t.oldXml.tagName&&"shadow"!=t.oldXml.tagName.toLowerCase()&&(t=this.cleanBlockXML_(t.oldXml),-1==this.contents_.indexOf(t))){for(this.contents_.unshift(t);this.contents_.length>this.workspace_.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(this.HAS_BLOCKS_LID_ANGLE_)}},e.Trashcan.prototype.cleanBlockXML_=function(t){for(var n=t=t.cloneNode(!0);n;){n.removeAttribute&&(n.removeAttribute("x"),n.removeAttribute("y"),n.removeAttribute("id"),n.removeAttribute("disabled"),"comment"==n.nodeName&&(n.removeAttribute("h"),n.removeAttribute("w"),n.removeAttribute("pinned")));var o=n.firstChild||n.nextSibling;if(!o)for(o=n.parentNode;o;){if(o.nextSibling){o=o.nextSibling;break}o=o.parentNode}n=o}return e.Xml.domToText(t)},e.VariablesDynamic={},e.VariablesDynamic.onCreateVariableButtonClick_String=function(t){e.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"String")},e.VariablesDynamic.onCreateVariableButtonClick_Number=function(t){e.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"Number")},e.VariablesDynamic.onCreateVariableButtonClick_Colour=function(t){e.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"Colour")},e.VariablesDynamic.flyoutCategory=function(t){var n=[],o=document.createElement("button");return o.setAttribute("text",e.Msg.NEW_STRING_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),n.push(o),(o=document.createElement("button")).setAttribute("text",e.Msg.NEW_NUMBER_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),n.push(o),(o=document.createElement("button")).setAttribute("text",e.Msg.NEW_COLOUR_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),n.push(o),t.registerButtonCallback("CREATE_VARIABLE_STRING",e.VariablesDynamic.onCreateVariableButtonClick_String),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",e.VariablesDynamic.onCreateVariableButtonClick_Number),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",e.VariablesDynamic.onCreateVariableButtonClick_Colour),t=e.VariablesDynamic.flyoutCategoryBlocks(t),n.concat(t)},e.VariablesDynamic.flyoutCategoryBlocks=function(t){var n=[];if(0<(t=t.getAllVariables()).length){if(e.Blocks.variables_set_dynamic){var o=t[t.length-1],r=e.utils.xml.createElement("block");r.setAttribute("type","variables_set_dynamic"),r.setAttribute("gap",24),r.appendChild(e.Variables.generateVariableFieldDom(o)),n.push(r)}if(e.Blocks.variables_get_dynamic){t.sort(e.VariableModel.compareByName),o=0;for(var a;a=t[o];o++)(r=e.utils.xml.createElement("block")).setAttribute("type","variables_get_dynamic"),r.setAttribute("gap",8),r.appendChild(e.Variables.generateVariableFieldDom(a)),n.push(r)}}return n},e.ZoomControls=function(t){this.workspace_=t,this.id="zoomControls",this.zoomResetGroup_=this.zoomOutGroup_=this.zoomInGroup_=this.onZoomOutWrapper_=this.onZoomInWrapper_=this.onZoomResetWrapper_=null},e.ZoomControls.prototype.WIDTH_=32,e.ZoomControls.prototype.HEIGHT_=32,e.ZoomControls.prototype.SMALL_SPACING_=2,e.ZoomControls.prototype.LARGE_SPACING_=11,e.ZoomControls.prototype.MARGIN_VERTICAL_=20,e.ZoomControls.prototype.MARGIN_HORIZONTAL_=20,e.ZoomControls.prototype.svgGroup_=null,e.ZoomControls.prototype.left_=0,e.ZoomControls.prototype.top_=0,e.ZoomControls.prototype.initialized_=!1,e.ZoomControls.prototype.createDom=function(){this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null);var t=String(Math.random()).substring(2);return this.createZoomOutSvg_(t),this.createZoomInSvg_(t),this.workspace_.isMovable()&&this.createZoomResetSvg_(t),this.svgGroup_},e.ZoomControls.prototype.init=function(){this.workspace_.getComponentManager().addComponent({component:this,weight:2,capabilities:[e.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0},e.ZoomControls.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("zoomControls"),this.svgGroup_&&e.utils.dom.removeNode(this.svgGroup_),this.onZoomResetWrapper_&&e.browserEvents.unbind(this.onZoomResetWrapper_),this.onZoomInWrapper_&&e.browserEvents.unbind(this.onZoomInWrapper_),this.onZoomOutWrapper_&&e.browserEvents.unbind(this.onZoomOutWrapper_)},e.ZoomControls.prototype.getBoundingRectangle=function(){var t=this.SMALL_SPACING_+2*this.HEIGHT_;return this.zoomResetGroup_&&(t+=this.LARGE_SPACING_+this.HEIGHT_),new e.utils.Rect(this.top_,this.top_+t,this.left_,this.left_+this.WIDTH_)},e.ZoomControls.prototype.position=function(t,n){if(this.initialized_){var o=e.uiPosition.getCornerOppositeToolbox(this.workspace_,t),r=this.SMALL_SPACING_+2*this.HEIGHT_;this.zoomResetGroup_&&(r+=this.LARGE_SPACING_+this.HEIGHT_),t=e.uiPosition.getStartPositionRect(o,new e.utils.Size(this.WIDTH_,r),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,t,this.workspace_),n=e.uiPosition.bumpPositionRect(t,this.MARGIN_VERTICAL_,(o=o.vertical)===e.uiPosition.verticalPosition.TOP?e.uiPosition.bumpDirection.DOWN:e.uiPosition.bumpDirection.UP,n),o===e.uiPosition.verticalPosition.TOP?(this.zoomInGroup_.setAttribute("transform","translate(0, "+(o=this.SMALL_SPACING_+this.HEIGHT_)+")"),this.zoomResetGroup_&&this.zoomResetGroup_.setAttribute("transform","translate(0, "+(o+this.LARGE_SPACING_+this.HEIGHT_)+")")):(this.zoomInGroup_.setAttribute("transform","translate(0, "+(o=this.zoomResetGroup_?this.LARGE_SPACING_+this.HEIGHT_:0)+")"),this.zoomOutGroup_.setAttribute("transform","translate(0, "+(o+this.SMALL_SPACING_+this.HEIGHT_)+")")),this.top_=n.top,this.left_=n.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},e.ZoomControls.prototype.createZoomOutSvg_=function(t){this.zoomOutGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:32,height:32},n),e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,height:e.SPRITE.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup_).setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),this.onZoomOutWrapper_=e.browserEvents.conditionalBind(this.zoomOutGroup_,"mousedown",null,this.zoom_.bind(this,-1))},e.ZoomControls.prototype.createZoomInSvg_=function(t){this.zoomInGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyZoominClipPath"+t},this.zoomInGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:32,height:32},n),e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,height:e.SPRITE.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup_).setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),this.onZoomInWrapper_=e.browserEvents.conditionalBind(this.zoomInGroup_,"mousedown",null,this.zoom_.bind(this,1))},e.ZoomControls.prototype.zoom_=function(t,n){this.workspace_.markFocused(),this.workspace_.zoomCenter(t),this.fireZoomEvent_(),e.Touch.clearTouchIdentifier(),n.stopPropagation(),n.preventDefault()},e.ZoomControls.prototype.createZoomResetSvg_=function(t){this.zoomResetGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:32,height:32},n),e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,height:e.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup_).setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),this.onZoomResetWrapper_=e.browserEvents.conditionalBind(this.zoomResetGroup_,"mousedown",null,this.resetZoom_.bind(this))},e.ZoomControls.prototype.resetZoom_=function(t){this.workspace_.markFocused();var n=Math.log(this.workspace_.options.zoomOptions.startScale/this.workspace_.scale)/Math.log(this.workspace_.options.zoomOptions.scaleSpeed);this.workspace_.beginCanvasTransition(),this.workspace_.zoomCenter(n),this.workspace_.scrollCenter(),setTimeout(this.workspace_.endCanvasTransition.bind(this.workspace_),500),this.fireZoomEvent_(),e.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()},e.ZoomControls.prototype.fireZoomEvent_=function(){var t=new(e.Events.get(e.Events.CLICK))(null,this.workspace_.id,"zoom_controls");e.Events.fire(t)},e.Css.register([".blocklyZoom>image, .blocklyZoom>svg>image {","opacity: .4;","}",".blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {","opacity: .6;","}",".blocklyZoom>image:active, .blocklyZoom>svg>image:active {","opacity: .8;","}"]),e.ShortcutItems={},e.ShortcutItems.names={ESCAPE:"escape",DELETE:"delete",COPY:"copy",CUT:"cut",PASTE:"paste",UNDO:"undo",REDO:"redo"},e.ShortcutItems.registerEscape=function(){var t={name:e.ShortcutItems.names.ESCAPE,preconditionFn:function(n){return!n.options.readOnly},callback:function(){return e.hideChaff(),!0}};e.ShortcutRegistry.registry.register(t),e.ShortcutRegistry.registry.addKeyMapping(e.utils.KeyCodes.ESC,t.name)},e.ShortcutItems.registerDelete=function(){var t={name:e.ShortcutItems.names.DELETE,preconditionFn:function(n){return!n.options.readOnly&&e.selected&&e.selected.isDeletable()},callback:function(n,o){return o.preventDefault(),!e.Gesture.inProgress()&&(e.deleteBlock(e.selected),!0)}};e.ShortcutRegistry.registry.register(t),e.ShortcutRegistry.registry.addKeyMapping(e.utils.KeyCodes.DELETE,t.name),e.ShortcutRegistry.registry.addKeyMapping(e.utils.KeyCodes.BACKSPACE,t.name)},e.ShortcutItems.registerCopy=function(){var t={name:e.ShortcutItems.names.COPY,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()&&e.selected&&e.selected.isDeletable()&&e.selected.isMovable()},callback:function(o,r){return r.preventDefault(),e.hideChaff(),e.copy(e.selected),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerCut=function(){var t={name:e.ShortcutItems.names.CUT,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()&&e.selected&&e.selected.isDeletable()&&e.selected.isMovable()&&!e.selected.workspace.isFlyout},callback:function(){return e.copy(e.selected),e.deleteBlock(e.selected),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerPaste=function(){var t={name:e.ShortcutItems.names.PASTE,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()},callback:function(){return e.paste()}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerUndo=function(){var t={name:e.ShortcutItems.names.UNDO,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()},callback:function(o){return e.hideChaff(),o.undo(!1),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerRedo=function(){var t={name:e.ShortcutItems.names.REDO,preconditionFn:function(o){return!e.Gesture.inProgress()&&!o.options.readOnly},callback:function(o){return e.hideChaff(),o.undo(!0),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.SHIFT,e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.SHIFT,e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.SHIFT,e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Y,[e.utils.KeyCodes.CTRL]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerDefaultShortcuts=function(){e.ShortcutItems.registerEscape(),e.ShortcutItems.registerDelete(),e.ShortcutItems.registerCopy(),e.ShortcutItems.registerCut(),e.ShortcutItems.registerPaste(),e.ShortcutItems.registerUndo(),e.ShortcutItems.registerRedo()},e.ShortcutItems.registerDefaultShortcuts(),e.ContextMenuItems={},e.ContextMenuItems.registerUndo=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.UNDO},preconditionFn:function(t){return 0<t.workspace.getUndoStack().length?"enabled":"disabled"},callback:function(t){t.workspace.undo(!1)},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},e.ContextMenuItems.registerRedo=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.REDO},preconditionFn:function(t){return 0<t.workspace.getRedoStack().length?"enabled":"disabled"},callback:function(t){t.workspace.undo(!0)},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},e.ContextMenuItems.registerCleanup=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.CLEAN_UP},preconditionFn:function(t){return t.workspace.isMovable()?1<t.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback:function(t){t.workspace.cleanUp()},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},e.ContextMenuItems.toggleOption_=function(t,n){for(var o=0,r=0;r<n.length;r++)for(var a=n[r];a;)setTimeout(a.setCollapsed.bind(a,t),o),a=a.getNextBlock(),o+=10},e.ContextMenuItems.registerCollapse=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.COLLAPSE_ALL},preconditionFn:function(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(var n=0;n<t.length;n++)for(var o=t[n];o;){if(!o.isCollapsed())return"enabled";o=o.getNextBlock()}return"disabled"}return"hidden"},callback:function(t){e.ContextMenuItems.toggleOption_(!0,t.workspace.getTopBlocks(!0))},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},e.ContextMenuItems.registerExpand=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.EXPAND_ALL},preconditionFn:function(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(var n=0;n<t.length;n++)for(var o=t[n];o;){if(o.isCollapsed())return"enabled";o=o.getNextBlock()}return"disabled"}return"hidden"},callback:function(t){e.ContextMenuItems.toggleOption_(!1,t.workspace.getTopBlocks(!0))},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},e.ContextMenuItems.addDeletableBlocks_=function(t,n){if(t.isDeletable())Array.prototype.push.apply(n,t.getDescendants(!1));else{t=t.getChildren(!1);for(var o=0;o<t.length;o++)e.ContextMenuItems.addDeletableBlocks_(t[o],n)}},e.ContextMenuItems.getDeletableBlocks_=function(t){var n=[];t=t.getTopBlocks(!0);for(var o=0;o<t.length;o++)e.ContextMenuItems.addDeletableBlocks_(t[o],n);return n},e.ContextMenuItems.deleteNext_=function(t,n){e.Events.setGroup(n);var o=t.shift();o&&(o.workspace?(o.dispose(!1,!0),setTimeout(e.ContextMenuItems.deleteNext_,10,t,n)):e.ContextMenuItems.deleteNext_(t,n)),e.Events.setGroup(!1)},e.ContextMenuItems.registerDeleteAll=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){if(t.workspace)return 1==(t=e.ContextMenuItems.getDeletableBlocks_(t.workspace).length)?e.Msg.DELETE_BLOCK:e.Msg.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn:function(t){if(t.workspace)return 0<e.ContextMenuItems.getDeletableBlocks_(t.workspace).length?"enabled":"disabled"},callback:function(t){if(t.workspace){t.workspace.cancelCurrentGesture();var n=e.ContextMenuItems.getDeletableBlocks_(t.workspace),o=e.utils.genUid();2>n.length?e.ContextMenuItems.deleteNext_(n,o):e.confirm(e.Msg.DELETE_ALL_BLOCKS.replace("%1",n.length),function(r){r&&e.ContextMenuItems.deleteNext_(n,o)})}},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},e.ContextMenuItems.registerWorkspaceOptions_=function(){e.ContextMenuItems.registerUndo(),e.ContextMenuItems.registerRedo(),e.ContextMenuItems.registerCleanup(),e.ContextMenuItems.registerCollapse(),e.ContextMenuItems.registerExpand(),e.ContextMenuItems.registerDeleteAll()},e.ContextMenuItems.registerDuplicate=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.DUPLICATE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden"},callback:function(t){t.block&&e.duplicate(t.block)},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},e.ContextMenuItems.registerComment=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.getCommentIcon()?e.Msg.REMOVE_COMMENT:e.Msg.ADD_COMMENT},preconditionFn:function(t){return t=t.block,e.utils.userAgent.IE||t.isInFlyout||!t.workspace.options.comments||t.isCollapsed()||!t.isEditable()?"hidden":"enabled"},callback:function(t){(t=t.block).getCommentIcon()?t.setCommentText(null):t.setCommentText("")},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockComment",weight:2})},e.ContextMenuItems.registerInline=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.getInputsInline()?e.Msg.EXTERNAL_INPUTS:e.Msg.INLINE_INPUTS},preconditionFn:function(t){if(!(t=t.block).isInFlyout&&t.isMovable()&&!t.isCollapsed())for(var n=1;n<t.inputList.length;n++)if(t.inputList[n-1].type!=e.inputTypes.STATEMENT&&t.inputList[n].type!=e.inputTypes.STATEMENT)return"enabled";return"hidden"},callback:function(t){t.block.setInputsInline(!t.block.getInputsInline())},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockInline",weight:3})},e.ContextMenuItems.registerCollapseExpandBlock=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.isCollapsed()?e.Msg.EXPAND_BLOCK:e.Msg.COLLAPSE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback:function(t){t.block.setCollapsed(!t.block.isCollapsed())},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},e.ContextMenuItems.registerDisable=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.isEnabled()?e.Msg.DISABLE_BLOCK:e.Msg.ENABLE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.workspace.options.disable&&t.isEditable()?t.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback:function(t){t=t.block;var n=e.Events.getGroup();n||e.Events.setGroup(!0),t.setEnabled(!t.isEnabled()),n||e.Events.setGroup(!1)},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDisable",weight:5})},e.ContextMenuItems.registerDelete=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){var n=t.block;return t=n.getDescendants(!1).length,(n=n.getNextBlock())&&(t-=n.getDescendants(!1).length),1==t?e.Msg.DELETE_BLOCK:e.Msg.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn:function(t){return!t.block.isInFlyout&&t.block.isDeletable()?"enabled":"hidden"},callback:function(t){e.Events.setGroup(!0),t.block&&e.deleteBlock(t.block),e.Events.setGroup(!1)},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDelete",weight:6})},e.ContextMenuItems.registerHelp=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.HELP},preconditionFn:function(t){return("function"==typeof(t=t.block).helpUrl?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback:function(t){t.block.showHelp()},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockHelp",weight:7})},e.ContextMenuItems.registerBlockOptions_=function(){e.ContextMenuItems.registerDuplicate(),e.ContextMenuItems.registerComment(),e.ContextMenuItems.registerInline(),e.ContextMenuItems.registerCollapseExpandBlock(),e.ContextMenuItems.registerDisable(),e.ContextMenuItems.registerDelete(),e.ContextMenuItems.registerHelp()},e.ContextMenuItems.registerDefaultOptions=function(){e.ContextMenuItems.registerWorkspaceOptions_(),e.ContextMenuItems.registerBlockOptions_()},e.ContextMenuItems.registerDefaultOptions(),e.Mutator=function(t){e.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=t},e.utils.object.inherits(e.Mutator,e.Icon),e.Mutator.prototype.workspace_=null,e.Mutator.prototype.workspaceWidth_=0,e.Mutator.prototype.workspaceHeight_=0,e.Mutator.prototype.setBlock=function(t){this.block_=t},e.Mutator.prototype.getWorkspace=function(){return this.workspace_},e.Mutator.prototype.drawIcon_=function(t){e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},t),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},t),e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},t)},e.Mutator.prototype.iconClick_=function(t){this.block_.isEditable()&&e.Icon.prototype.iconClick_.call(this,t)},e.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{x:e.Bubble.BORDER_WIDTH,y:e.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var o,t=e.utils.xml.createElement("xml"),n=0;o=this.quarkNames_[n];n++){var r=e.utils.xml.createElement("block");r.setAttribute("type",o),t.appendChild(r)}else t=null;return(n=new e.Options({disable:!1,parentWorkspace:this.block_.workspace,media:this.block_.workspace.options.pathToMedia,rtl:this.block_.RTL,horizontalLayout:!1,renderer:this.block_.workspace.options.renderer,rendererOverrides:this.block_.workspace.options.rendererOverrides})).toolboxPosition=this.block_.RTL?e.utils.toolbox.Position.RIGHT:e.utils.toolbox.Position.LEFT,(o=!!t)&&(n.languageTree=e.utils.toolbox.convertToolboxDefToJson(t)),this.workspace_=new e.WorkspaceSvg(n),this.workspace_.isMutator=!0,this.workspace_.addChangeListener(e.Events.disableOrphans),t=o?this.workspace_.addFlyout(e.utils.Svg.G):null,n=this.workspace_.createDom("blocklyMutatorBackground"),t&&n.insertBefore(t,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(n),this.svgDialog_},e.Mutator.prototype.updateEditable=function(){e.Mutator.superClass_.updateEditable.call(this),this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&e.utils.dom.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&e.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly")))},e.Mutator.prototype.resizeBubble_=function(){var t=2*e.Bubble.BORDER_WIDTH,n=this.workspace_.getCanvas().getBBox(),o=n.width+n.x,r=n.height+3*t,a=this.workspace_.getFlyout();if(a){var h=a.getWorkspace().getMetricsManager().getScrollMetrics();r=Math.max(r,h.height+20),o+=a.getWidth()}this.block_.RTL&&(o=-n.x),o+=3*t,(Math.abs(this.workspaceWidth_-o)>t||Math.abs(this.workspaceHeight_-r)>t)&&(this.workspaceWidth_=o,this.workspaceHeight_=r,this.bubble_.setBubbleSize(o+t,r+t),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_),this.workspace_.setCachedParentSvgSize(this.workspaceWidth_,this.workspaceHeight_)),this.block_.RTL&&(t="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",t)),this.workspace_.resize()},e.Mutator.prototype.onBubbleMove_=function(){this.workspace_&&this.workspace_.recordDragTargets()},e.Mutator.prototype.setVisible=function(t){if(t!=this.isVisible())if(e.Events.fire(new(e.Events.get(e.Events.BUBBLE_OPEN))(this.block_,t,"mutator")),t){this.bubble_=new e.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerMoveEvent(this.onBubbleMove_.bind(this));var n=this.workspace_.options.languageTree;t=this.workspace_.getFlyout(),n&&(t.init(this.workspace_),t.show(n)),this.rootBlock_=this.block_.decompose(this.workspace_),n=this.rootBlock_.getDescendants(!1);for(var r,o=0;r=n[o];o++)r.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),t?(n=2*t.CORNER_RADIUS,t=this.rootBlock_.RTL?t.getWidth()+n:n):t=n=16,this.block_.RTL&&(t=-t),this.rootBlock_.moveBy(t,n),this.block_.saveConnections){var a=this,h=this.block_;h.saveConnections(this.rootBlock_),this.sourceListener_=function(){h.saveConnections(a.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.applyColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},e.Mutator.prototype.workspaceChanged_=function(t){if(!(t.isUiEvent||t.type==e.Events.CHANGE&&"disabled"==t.element)){if(!this.workspace_.isDragging()){t=this.workspace_.getTopBlocks(!1);for(var o,n=0;o=t[n];n++){var r=o.getRelativeToSurfaceXY();if(20>r.y&&o.moveBy(0,20-r.y),o.RTL){var a=-20,h=this.workspace_.getFlyout();h&&(a-=h.getWidth()),r.x>a&&o.moveBy(a-r.x,0)}else 20>r.x&&o.moveBy(20-r.x,0)}}if(this.rootBlock_.workspace==this.workspace_){if(e.Events.setGroup(!0),t=(t=(o=this.block_).mutationToDom())&&e.Xml.domToText(t),n=o.rendered,o.rendered=!1,o.compose(this.rootBlock_),o.rendered=n,o.initSvg(),o.rendered&&o.render(),t!=(n=(n=o.mutationToDom())&&e.Xml.domToText(n))){e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(o,"mutation",null,t,n));var R=e.Events.getGroup();setTimeout(function(){e.Events.setGroup(R),o.bumpNeighbours(),e.Events.setGroup(!1)},e.BUMP_DELAY)}this.workspace_.isDragging()||this.resizeBubble_(),e.Events.setGroup(!1)}}},e.Mutator.prototype.dispose=function(){this.block_.mutator=null,e.Icon.prototype.dispose.call(this)},e.Mutator.prototype.updateBlockStyle=function(){var t=this.workspace_;if(t&&t.getAllBlocks(!1)){for(var r,n=t.getAllBlocks(!1),o=0;r=n[o];o++)r.setStyle(r.getStyleName());if(o=t.getFlyout())for(t=o.workspace_.getAllBlocks(!1),o=0;r=t[o];o++)r.setStyle(r.getStyleName())}},e.Mutator.reconnect=function(t,n,o){if(!t||!t.getSourceBlock().workspace)return!1;o=n.getInput(o).connection;var r=t.targetBlock();return!(r&&r!=n||o.targetConnection==t||(o.isConnected()&&o.disconnect(),o.connect(t),0))},e.Mutator.findParentWs=function(t){var n=null;if(t&&t.options){var o=t.options.parentWorkspace;t.isFlyout?o&&o.options&&(n=o.options.parentWorkspace):o&&(n=o)}return n},e.FieldTextInput=function(t,n,o){this.spellcheck_=!0,e.FieldTextInput.superClass_.constructor.call(this,t,n,o),this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.htmlInput_=null,this.fullBlockClickTarget_=!1,this.workspace_=null},e.utils.object.inherits(e.FieldTextInput,e.Field),e.FieldTextInput.prototype.DEFAULT_VALUE="",e.FieldTextInput.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldTextInput(n,void 0,t)},e.FieldTextInput.prototype.SERIALIZABLE=!0,e.FieldTextInput.BORDERRADIUS=4,e.FieldTextInput.prototype.CURSOR="text",e.FieldTextInput.prototype.configure_=function(t){e.FieldTextInput.superClass_.configure_.call(this,t),"boolean"==typeof t.spellcheck&&(this.spellcheck_=t.spellcheck)},e.FieldTextInput.prototype.initView=function(){if(this.getConstants().FULL_BLOCK_FIELDS){for(var r,t=0,n=0,o=0;r=this.sourceBlock_.inputList[o];o++){for(var a=0;r.fieldRow[a];a++)t++;r.connection&&n++}this.fullBlockClickTarget_=1>=t&&this.sourceBlock_.outputConnection&&!n}else this.fullBlockClickTarget_=!1;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()},e.FieldTextInput.prototype.doClassValidation_=function(t){return null==t?null:String(t)},e.FieldTextInput.prototype.doValueInvalid_=function(t){this.isBeingEdited_&&(this.isTextValid_=!1,t=this.value_,this.value_=this.htmlInput_.untypedDefaultValue_,this.sourceBlock_&&e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,t,this.value_)))},e.FieldTextInput.prototype.doValueUpdate_=function(t){this.isTextValid_=!0,this.value_=t,this.isBeingEdited_||(this.isDirty_=!0)},e.FieldTextInput.prototype.applyColour=function(){this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS&&(this.borderRect_?this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR))},e.FieldTextInput.prototype.render_=function(){if(e.FieldTextInput.superClass_.render_.call(this),this.isBeingEdited_){this.resizeEditor_();var t=this.htmlInput_;this.isTextValid_?(e.utils.dom.removeClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!1)):(e.utils.dom.addClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!0))}},e.FieldTextInput.prototype.setSpellcheck=function(t){t!=this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))},e.FieldTextInput.prototype.showEditor_=function(t,n){this.workspace_=this.sourceBlock_.workspace,!(t=n||!1)&&(e.utils.userAgent.MOBILE||e.utils.userAgent.ANDROID||e.utils.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(t)},e.FieldTextInput.prototype.showPromptEditor_=function(){e.prompt(e.Msg.CHANGE_VALUE_TITLE,this.getText(),function(t){this.setValue(this.getValueFromEditorText_(t))}.bind(this))},e.FieldTextInput.prototype.showInlineEditor_=function(t){e.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,t||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())},e.FieldTextInput.prototype.widgetCreate_=function(){var t=e.WidgetDiv.DIV;e.utils.dom.addClass(this.getClickTarget_(),"editing");var n=document.createElement("input");n.className="blocklyHtmlInput",n.setAttribute("spellcheck",this.spellcheck_);var o=this.workspace_.getScale(),r=this.getConstants().FIELD_TEXT_FONTSIZE*o+"pt";if(t.style.fontSize=r,n.style.fontSize=r,r=e.FieldTextInput.BORDERRADIUS*o+"px",this.fullBlockClickTarget_){r=((r=this.getScaledBBox()).bottom-r.top)/2+"px";var a=this.sourceBlock_.getParent()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;n.style.border=1*o+"px solid "+a,t.style.borderRadius=r,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0px 0px 0px "+4*o+"px")}return n.style.borderRadius=r,t.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.untypedDefaultValue_=this.value_,n.oldValue_=null,this.resizeEditor_(),this.bindInputEvents_(n),n},e.FieldTextInput.prototype.widgetDispose_=function(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_&&this.onFinishEditing_(this.value_),this.unbindInputEvents_();var t=e.WidgetDiv.DIV.style;t.width="auto",t.height="auto",t.fontSize="",t.transition="",t.boxShadow="",this.htmlInput_=null,e.utils.dom.removeClass(this.getClickTarget_(),"editing")},e.FieldTextInput.prototype.bindInputEvents_=function(t){this.onKeyDownWrapper_=e.browserEvents.conditionalBind(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=e.browserEvents.conditionalBind(t,"input",this,this.onHtmlInputChange_)},e.FieldTextInput.prototype.unbindInputEvents_=function(){this.onKeyDownWrapper_&&(e.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(e.browserEvents.unbind(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)},e.FieldTextInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode==e.utils.KeyCodes.ENTER?(e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()):t.keyCode==e.utils.KeyCodes.ESC?(this.setValue(this.htmlInput_.untypedDefaultValue_),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()):t.keyCode==e.utils.KeyCodes.TAB&&(e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())},e.FieldTextInput.prototype.onHtmlInputChange_=function(t){(t=this.htmlInput_.value)!==this.htmlInput_.oldValue_&&(this.htmlInput_.oldValue_=t,e.Events.setGroup(!0),t=this.getValueFromEditorText_(t),this.setValue(t),this.forceRerender(),this.resizeEditor_(),e.Events.setGroup(!1))},e.FieldTextInput.prototype.setEditorValue_=function(t){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t)},e.FieldTextInput.prototype.resizeEditor_=function(){var t=e.WidgetDiv.DIV,n=this.getScaledBBox();t.style.width=n.right-n.left+"px",t.style.height=n.bottom-n.top+"px",n=new e.utils.Coordinate(this.sourceBlock_.RTL?n.right-t.offsetWidth:n.left,n.top),t.style.left=n.x+"px",t.style.top=n.y+"px"},e.FieldTextInput.prototype.isTabNavigable=function(){return!0},e.FieldTextInput.prototype.getText_=function(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null},e.FieldTextInput.prototype.getEditorText_=function(t){return String(t)},e.FieldTextInput.prototype.getValueFromEditorText_=function(t){return t},e.fieldRegistry.register("field_input",e.FieldTextInput),e.FieldAngle=function(t,n,o){this.clockwise_=e.FieldAngle.CLOCKWISE,this.offset_=e.FieldAngle.OFFSET,this.wrap_=e.FieldAngle.WRAP,this.round_=e.FieldAngle.ROUND,e.FieldAngle.superClass_.constructor.call(this,t,n,o),this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.line_=this.gauge_=this.editor_=null},e.utils.object.inherits(e.FieldAngle,e.FieldTextInput),e.FieldAngle.prototype.DEFAULT_VALUE=0,e.FieldAngle.fromJson=function(t){return new e.FieldAngle(t.angle,void 0,t)},e.FieldAngle.prototype.SERIALIZABLE=!0,e.FieldAngle.ROUND=15,e.FieldAngle.HALF=50,e.FieldAngle.CLOCKWISE=!1,e.FieldAngle.OFFSET=0,e.FieldAngle.WRAP=360,e.FieldAngle.RADIUS=e.FieldAngle.HALF-1,e.FieldAngle.prototype.configure_=function(t){switch(e.FieldAngle.superClass_.configure_.call(this,t),t.mode){case"compass":this.clockwise_=!0,this.offset_=90;break;case"protractor":this.clockwise_=!1,this.offset_=0}var n=t.clockwise;"boolean"==typeof n&&(this.clockwise_=n),null!=(n=t.offset)&&(n=Number(n),isNaN(n)||(this.offset_=n)),null!=(n=t.wrap)&&(n=Number(n),isNaN(n)||(this.wrap_=n)),null!=(t=t.round)&&(t=Number(t),isNaN(t)||(this.round_=t))},e.FieldAngle.prototype.initView=function(){e.FieldAngle.superClass_.initView.call(this),this.symbol_=e.utils.dom.createSvgElement(e.utils.Svg.TSPAN,{},null),this.symbol_.appendChild(document.createTextNode("\xb0")),this.textElement_.appendChild(this.symbol_)},e.FieldAngle.prototype.render_=function(){e.FieldAngle.superClass_.render_.call(this),this.updateGraph_()},e.FieldAngle.prototype.showEditor_=function(t){e.FieldAngle.superClass_.showEditor_.call(this,t,e.utils.userAgent.MOBILE||e.utils.userAgent.ANDROID||e.utils.userAgent.IPAD),this.dropdownCreate_(),e.DropDownDiv.getContentDiv().appendChild(this.editor_),e.DropDownDiv.setColour(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),e.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.updateGraph_()},e.FieldAngle.prototype.dropdownCreate_=function(){var t=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",height:2*e.FieldAngle.HALF+"px",width:2*e.FieldAngle.HALF+"px",style:"touch-action: none"},null),n=e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{cx:e.FieldAngle.HALF,cy:e.FieldAngle.HALF,r:e.FieldAngle.RADIUS,class:"blocklyAngleCircle"},t);this.gauge_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyAngleGauge"},t),this.line_=e.utils.dom.createSvgElement(e.utils.Svg.LINE,{x1:e.FieldAngle.HALF,y1:e.FieldAngle.HALF,class:"blocklyAngleLine"},t);for(var o=0;360>o;o+=15)e.utils.dom.createSvgElement(e.utils.Svg.LINE,{x1:e.FieldAngle.HALF+e.FieldAngle.RADIUS,y1:e.FieldAngle.HALF,x2:e.FieldAngle.HALF+e.FieldAngle.RADIUS-(o%45==0?10:5),y2:e.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+o+","+e.FieldAngle.HALF+","+e.FieldAngle.HALF+")"},t);this.clickWrapper_=e.browserEvents.conditionalBind(t,"click",this,this.hide_),this.clickSurfaceWrapper_=e.browserEvents.conditionalBind(n,"click",this,this.onMouseMove_,!0,!0),this.moveSurfaceWrapper_=e.browserEvents.conditionalBind(n,"mousemove",this,this.onMouseMove_,!0,!0),this.editor_=t},e.FieldAngle.prototype.dropdownDispose_=function(){this.clickWrapper_&&(e.browserEvents.unbind(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(e.browserEvents.unbind(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(e.browserEvents.unbind(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null},e.FieldAngle.prototype.hide_=function(){e.DropDownDiv.hideIfOwner(this),e.WidgetDiv.hide()},e.FieldAngle.prototype.onMouseMove_=function(t){var n=this.gauge_.ownerSVGElement.getBoundingClientRect(),o=t.clientX-n.left-e.FieldAngle.HALF;t=t.clientY-n.top-e.FieldAngle.HALF,n=Math.atan(-t/o),isNaN(n)||(n=e.utils.math.toDegrees(n),0>o?n+=180:0<t&&(n+=360),this.displayMouseOrKeyboardValue_(n=this.clockwise_?this.offset_+360-n:360-(this.offset_-n)))},e.FieldAngle.prototype.displayMouseOrKeyboardValue_=function(t){this.round_&&(t=Math.round(t/this.round_)*this.round_),(t=this.wrapValue_(t))!=this.value_&&this.setEditorValue_(t)},e.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var t=Number(this.getText())+this.offset_,n=e.utils.math.toRadians(t%360);t=["M ",e.FieldAngle.HALF,",",e.FieldAngle.HALF];var o=e.FieldAngle.HALF,r=e.FieldAngle.HALF;if(!isNaN(n)){var a=Number(this.clockwise_),h=e.utils.math.toRadians(this.offset_),R=Math.cos(h)*e.FieldAngle.RADIUS,L=Math.sin(h)*-e.FieldAngle.RADIUS;a&&(n=2*h-n),o+=Math.cos(n)*e.FieldAngle.RADIUS,r-=Math.sin(n)*e.FieldAngle.RADIUS,n=Math.abs(Math.floor((n-h)/Math.PI)%2),a&&(n=1-n),t.push(" l ",R,",",L," A ",e.FieldAngle.RADIUS,",",e.FieldAngle.RADIUS," 0 ",n," ",a," ",o,",",r," z")}this.gauge_.setAttribute("d",t.join("")),this.line_.setAttribute("x2",o),this.line_.setAttribute("y2",r)}},e.FieldAngle.prototype.onHtmlInputKeyDown_=function(t){var n;if(e.FieldAngle.superClass_.onHtmlInputKeyDown_.call(this,t),t.keyCode===e.utils.KeyCodes.LEFT?n=this.sourceBlock_.RTL?1:-1:t.keyCode===e.utils.KeyCodes.RIGHT?n=this.sourceBlock_.RTL?-1:1:t.keyCode===e.utils.KeyCodes.DOWN?n=-1:t.keyCode===e.utils.KeyCodes.UP&&(n=1),n){var o=this.getValue();this.displayMouseOrKeyboardValue_(o+n*this.round_),t.preventDefault(),t.stopPropagation()}},e.FieldAngle.prototype.doClassValidation_=function(t){return t=Number(t),isNaN(t)||!isFinite(t)?null:this.wrapValue_(t)},e.FieldAngle.prototype.wrapValue_=function(t){return 0>(t%=360)&&(t+=360),t>this.wrap_&&(t-=360),t},e.Css.register(".blocklyAngleCircle {,stroke: #444;,stroke-width: 1;,fill: #ddd;,fill-opacity: .8;,},.blocklyAngleMarks {,stroke: #444;,stroke-width: 1;,},.blocklyAngleGauge {,fill: #f88;,fill-opacity: .8;,pointer-events: none;,},.blocklyAngleLine {,stroke: #f00;,stroke-width: 2;,stroke-linecap: round;,pointer-events: none;,}".split(",")),e.fieldRegistry.register("field_angle",e.FieldAngle),e.FieldCheckbox=function(t,n,o){this.checkChar_=null,e.FieldCheckbox.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.FieldCheckbox,e.Field),e.FieldCheckbox.prototype.DEFAULT_VALUE=!1,e.FieldCheckbox.fromJson=function(t){return new e.FieldCheckbox(t.checked,void 0,t)},e.FieldCheckbox.CHECK_CHAR="\u2713",e.FieldCheckbox.prototype.SERIALIZABLE=!0,e.FieldCheckbox.prototype.CURSOR="default",e.FieldCheckbox.prototype.configure_=function(t){e.FieldCheckbox.superClass_.configure_.call(this,t),t.checkCharacter&&(this.checkChar_=t.checkCharacter)},e.FieldCheckbox.prototype.initView=function(){e.FieldCheckbox.superClass_.initView.call(this),e.utils.dom.addClass(this.textElement_,"blocklyCheckbox"),this.textElement_.style.display=this.value_?"block":"none"},e.FieldCheckbox.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)},e.FieldCheckbox.prototype.getDisplayText_=function(){return this.checkChar_||e.FieldCheckbox.CHECK_CHAR},e.FieldCheckbox.prototype.setCheckCharacter=function(t){this.checkChar_=t,this.forceRerender()},e.FieldCheckbox.prototype.showEditor_=function(){this.setValue(!this.value_)},e.FieldCheckbox.prototype.doClassValidation_=function(t){return!0===t||"TRUE"===t?"TRUE":!1===t||"FALSE"===t?"FALSE":null},e.FieldCheckbox.prototype.doValueUpdate_=function(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")},e.FieldCheckbox.prototype.getValue=function(){return this.value_?"TRUE":"FALSE"},e.FieldCheckbox.prototype.getValueBoolean=function(){return this.value_},e.FieldCheckbox.prototype.getText=function(){return String(this.convertValueToBool_(this.value_))},e.FieldCheckbox.prototype.convertValueToBool_=function(t){return"string"==typeof t?"TRUE"==t:!!t},e.fieldRegistry.register("field_checkbox",e.FieldCheckbox),e.FieldColour=function(t,n,o){e.FieldColour.superClass_.constructor.call(this,t,n,o),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null},e.utils.object.inherits(e.FieldColour,e.Field),e.FieldColour.fromJson=function(t){return new e.FieldColour(t.colour,void 0,t)},e.FieldColour.prototype.SERIALIZABLE=!0,e.FieldColour.prototype.CURSOR="default",e.FieldColour.prototype.isDirty_=!1,e.FieldColour.prototype.colours_=null,e.FieldColour.prototype.titles_=null,e.FieldColour.prototype.columns_=0,e.FieldColour.prototype.configure_=function(t){e.FieldColour.superClass_.configure_.call(this,t),t.colourOptions&&(this.colours_=t.colourOptions,this.titles_=t.colourTitles),t.columns&&(this.columns_=t.columns)},e.FieldColour.prototype.initView=function(){this.size_=new e.utils.Size(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.clickTarget_=this.sourceBlock_.getSvgRoot():(this.createBorderRect_(),this.borderRect_.style.fillOpacity="1")},e.FieldColour.prototype.applyColour=function(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())},e.FieldColour.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:e.utils.colour.parse(t)},e.FieldColour.prototype.doValueUpdate_=function(t){this.value_=t,this.borderRect_?this.borderRect_.style.fill=t:this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",t),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))},e.FieldColour.prototype.getText=function(){var t=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(t)&&(t="#"+t[1]+t[3]+t[5]),t},e.FieldColour.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),e.FieldColour.prototype.DEFAULT_VALUE=e.FieldColour.COLOURS[0],e.FieldColour.TITLES=[],e.FieldColour.COLUMNS=7,e.FieldColour.prototype.setColours=function(t,n){return this.colours_=t,n&&(this.titles_=n),this},e.FieldColour.prototype.setColumns=function(t){return this.columns_=t,this},e.FieldColour.prototype.showEditor_=function(){this.dropdownCreate_(),e.DropDownDiv.getContentDiv().appendChild(this.picker_),e.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:!0})},e.FieldColour.prototype.onClick_=function(t){null!==(t=(t=t.target)&&t.label)&&(this.setValue(t),e.DropDownDiv.hideIfOwner(this))},e.FieldColour.prototype.onKeyDown_=function(t){var n=!1;t.keyCode===e.utils.KeyCodes.UP?(this.moveHighlightBy_(0,-1),n=!0):t.keyCode===e.utils.KeyCodes.DOWN?(this.moveHighlightBy_(0,1),n=!0):t.keyCode===e.utils.KeyCodes.LEFT?(this.moveHighlightBy_(-1,0),n=!0):t.keyCode===e.utils.KeyCodes.RIGHT?(this.moveHighlightBy_(1,0),n=!0):t.keyCode===e.utils.KeyCodes.ENTER&&((n=this.getHighlighted_())&&null!==(n=n&&n.label)&&this.setValue(n),e.DropDownDiv.hideWithoutAnimation(),n=!0),n&&t.stopPropagation()},e.FieldColour.prototype.moveHighlightBy_=function(t,n){var o=this.colours_||e.FieldColour.COLOURS,r=this.columns_||e.FieldColour.COLUMNS,a=this.highlightedIndex_%r,h=Math.floor(this.highlightedIndex_/r);a+=t,h+=n,0>t?0>a&&0<h?(a=r-1,h--):0>a&&(a=0):0<t?a>r-1&&h<Math.floor(o.length/r)-1?(a=0,h++):a>r-1&&a--:0>n?0>h&&(h=0):0<n&&h>Math.floor(o.length/r)-1&&(h=Math.floor(o.length/r)-1),this.setHighlightedCell_(this.picker_.childNodes[h].childNodes[a],h*r+a)},e.FieldColour.prototype.onMouseMove_=function(t){var n=(t=t.target)&&Number(t.getAttribute("data-index"));null!==n&&n!==this.highlightedIndex_&&this.setHighlightedCell_(t,n)},e.FieldColour.prototype.onMouseEnter_=function(){this.picker_.focus({preventScroll:!0})},e.FieldColour.prototype.onMouseLeave_=function(){this.picker_.blur();var t=this.getHighlighted_();t&&e.utils.dom.removeClass(t,"blocklyColourHighlighted")},e.FieldColour.prototype.getHighlighted_=function(){var t=this.columns_||e.FieldColour.COLUMNS,n=this.picker_.childNodes[Math.floor(this.highlightedIndex_/t)];return n?n.childNodes[this.highlightedIndex_%t]:null},e.FieldColour.prototype.setHighlightedCell_=function(t,n){var o=this.getHighlighted_();o&&e.utils.dom.removeClass(o,"blocklyColourHighlighted"),e.utils.dom.addClass(t,"blocklyColourHighlighted"),this.highlightedIndex_=n,e.utils.aria.setState(this.picker_,e.utils.aria.State.ACTIVEDESCENDANT,t.getAttribute("id"))},e.FieldColour.prototype.dropdownCreate_=function(){var t=this.columns_||e.FieldColour.COLUMNS,n=this.colours_||e.FieldColour.COLOURS,o=this.titles_||e.FieldColour.TITLES,r=this.getValue(),a=document.createElement("table");a.className="blocklyColourTable",a.tabIndex=0,a.dir="ltr",e.utils.aria.setRole(a,e.utils.aria.Role.GRID),e.utils.aria.setState(a,e.utils.aria.State.EXPANDED,!0),e.utils.aria.setState(a,e.utils.aria.State.ROWCOUNT,Math.floor(n.length/t)),e.utils.aria.setState(a,e.utils.aria.State.COLCOUNT,t);for(var h,R=0;R<n.length;R++){R%t==0&&(h=document.createElement("tr"),e.utils.aria.setRole(h,e.utils.aria.Role.ROW),a.appendChild(h));var L=document.createElement("td");h.appendChild(L),L.label=n[R],L.title=o[R]||n[R],L.id=e.utils.IdGenerator.getNextUniqueId(),L.setAttribute("data-index",R),e.utils.aria.setRole(L,e.utils.aria.Role.GRIDCELL),e.utils.aria.setState(L,e.utils.aria.State.LABEL,n[R]),e.utils.aria.setState(L,e.utils.aria.State.SELECTED,n[R]==r),L.style.backgroundColor=n[R],n[R]==r&&(L.className="blocklyColourSelected",this.highlightedIndex_=R)}this.onClickWrapper_=e.browserEvents.conditionalBind(a,"click",this,this.onClick_,!0),this.onMouseMoveWrapper_=e.browserEvents.conditionalBind(a,"mousemove",this,this.onMouseMove_,!0),this.onMouseEnterWrapper_=e.browserEvents.conditionalBind(a,"mouseenter",this,this.onMouseEnter_,!0),this.onMouseLeaveWrapper_=e.browserEvents.conditionalBind(a,"mouseleave",this,this.onMouseLeave_,!0),this.onKeyDownWrapper_=e.browserEvents.conditionalBind(a,"keydown",this,this.onKeyDown_),this.picker_=a},e.FieldColour.prototype.dropdownDispose_=function(){this.onClickWrapper_&&(e.browserEvents.unbind(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(e.browserEvents.unbind(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(e.browserEvents.unbind(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(e.browserEvents.unbind(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(e.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null},e.Css.register([".blocklyColourTable {","border-collapse: collapse;","display: block;","outline: none;","padding: 1px;","}",".blocklyColourTable>tr>td {","border: .5px solid #888;","box-sizing: border-box;","cursor: pointer;","display: inline-block;","height: 20px;","padding: 0;","width: 20px;","}",".blocklyColourTable>tr>td.blocklyColourHighlighted {","border-color: #eee;","box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);","position: relative;","}",".blocklyColourSelected, .blocklyColourSelected:hover {","border-color: #eee !important;","outline: 1px solid #333;","position: relative;","}"]),e.fieldRegistry.register("field_colour",e.FieldColour),e.FieldDropdown=function(t,n,o){"function"!=typeof t&&e.FieldDropdown.validateOptions_(t),this.menuGenerator_=t,this.suffixField=this.prefixField=this.generatedOptions_=null,this.trimOptions_(),this.selectedOption_=this.getOptions(!1)[0],e.FieldDropdown.superClass_.constructor.call(this,this.selectedOption_[1],n,o),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null},e.utils.object.inherits(e.FieldDropdown,e.Field),e.FieldDropdown.fromJson=function(t){return new e.FieldDropdown(t.options,void 0,t)},e.FieldDropdown.prototype.fromXml=function(t){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t.textContent)},e.FieldDropdown.prototype.SERIALIZABLE=!0,e.FieldDropdown.CHECKMARK_OVERHANG=25,e.FieldDropdown.MAX_MENU_HEIGHT_VH=.45,e.FieldDropdown.IMAGE_Y_OFFSET=5,e.FieldDropdown.IMAGE_Y_PADDING=2*e.FieldDropdown.IMAGE_Y_OFFSET,e.FieldDropdown.ARROW_CHAR=e.utils.userAgent.ANDROID?"\u25bc":"\u25be",e.FieldDropdown.prototype.CURSOR="default",e.FieldDropdown.prototype.initView=function(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&e.utils.dom.addClass(this.borderRect_,"blocklyDropdownRect")},e.FieldDropdown.prototype.shouldAddBorderRect_=function(){return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!this.sourceBlock_.isShadow()},e.FieldDropdown.prototype.createTextArrow_=function(){this.arrow_=e.utils.dom.createSvgElement(e.utils.Svg.TSPAN,{},this.textElement_),this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?e.FieldDropdown.ARROW_CHAR+" ":" "+e.FieldDropdown.ARROW_CHAR)),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textContent_):this.textElement_.appendChild(this.arrow_)},e.FieldDropdown.prototype.createSVGArrow_=function(){this.svgArrow_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)},e.FieldDropdown.prototype.showEditor_=function(t){if(this.dropdownCreate_(),this.menu_.openingCoords=t&&"number"==typeof t.clientX?new e.utils.Coordinate(t.clientX,t.clientY):null,this.menu_.render(e.DropDownDiv.getContentDiv()),t=this.menu_.getElement(),e.utils.dom.addClass(t,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV){t=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().getColour():this.sourceBlock_.getColour();var n=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;e.DropDownDiv.setColour(t,n)}e.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()},e.FieldDropdown.prototype.dropdownCreate_=function(){var t=new e.Menu;t.setRole(e.utils.aria.Role.LISTBOX),this.menu_=t;var n=this.getOptions(!1);this.selectedMenuItem_=null;for(var o=0;o<n.length;o++){var r=n[o][0],a=n[o][1];if("object"==typeof r){var h=new Image(r.width,r.height);h.src=r.src,h.alt=r.alt||"",r=h}(r=new e.MenuItem(r,a)).setRole(e.utils.aria.Role.OPTION),r.setRightToLeft(this.sourceBlock_.RTL),r.setCheckable(!0),t.addChild(r),r.setChecked(a==this.value_),a==this.value_&&(this.selectedMenuItem_=r),r.onAction(this.handleMenuActionEvent_,this)}},e.FieldDropdown.prototype.dropdownDispose_=function(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()},e.FieldDropdown.prototype.handleMenuActionEvent_=function(t){e.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,t)},e.FieldDropdown.prototype.onItemSelected_=function(t,n){this.setValue(n.getValue())},e.FieldDropdown.prototype.trimOptions_=function(){var t=this.menuGenerator_;if(Array.isArray(t)){for(var n=!1,o=0;o<t.length;o++){var r=t[o][0];"string"==typeof r?t[o][0]=e.utils.replaceMessageReferences(r):(null!=r.alt&&(t[o][0].alt=e.utils.replaceMessageReferences(r.alt)),n=!0)}if(!(n||2>t.length)){for(n=[],o=0;o<t.length;o++)n.push(t[o][0]);o=e.utils.string.shortestStringLength(n),r=e.utils.string.commonWordPrefix(n,o);var a=e.utils.string.commonWordSuffix(n,o);!r&&!a||o<=r+a||(r&&(this.prefixField=n[0].substring(0,r-1)),a&&(this.suffixField=n[0].substr(1-a)),this.menuGenerator_=e.FieldDropdown.applyTrim_(t,r,a))}}},e.FieldDropdown.applyTrim_=function(t,n,o){for(var r=[],a=0;a<t.length;a++){var h=t[a][0],R=t[a][1];h=h.substring(n,h.length-o),r[a]=[h,R]}return r},e.FieldDropdown.prototype.isOptionListDynamic=function(){return"function"==typeof this.menuGenerator_},e.FieldDropdown.prototype.getOptions=function(t){return this.isOptionListDynamic()?(this.generatedOptions_&&t||(this.generatedOptions_=this.menuGenerator_.call(this),e.FieldDropdown.validateOptions_(this.generatedOptions_)),this.generatedOptions_):this.menuGenerator_},e.FieldDropdown.prototype.doClassValidation_=function(t){for(var a,n=!1,o=this.getOptions(!0),r=0;a=o[r];r++)if(a[1]==t){n=!0;break}return n?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)},e.FieldDropdown.prototype.doValueUpdate_=function(t){e.FieldDropdown.superClass_.doValueUpdate_.call(this,t),t=this.getOptions(!0);for(var o,n=0;o=t[n];n++)o[1]==this.value_&&(this.selectedOption_=o)},e.FieldDropdown.prototype.applyColour=function(){this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary),this.borderRect_.setAttribute("fill",this.menu_?this.sourceBlock_.style.colourTertiary:"transparent")),this.sourceBlock_&&this.arrow_&&(this.arrow_.style.fill=this.sourceBlock_.isShadow()?this.sourceBlock_.style.colourSecondary:this.sourceBlock_.style.colourPrimary)},e.FieldDropdown.prototype.render_=function(){this.textContent_.nodeValue="",this.imageElement_.style.display="none";var t=this.selectedOption_&&this.selectedOption_[0];t&&"object"==typeof t?this.renderSelectedImage_(t):this.renderSelectedText_(),this.positionBorderRect_()},e.FieldDropdown.prototype.renderSelectedImage_=function(t){this.imageElement_.style.display="",this.imageElement_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",t.src),this.imageElement_.setAttribute("height",t.height),this.imageElement_.setAttribute("width",t.width);var n=Number(t.height);t=Number(t.width);var o=!!this.borderRect_,r=Math.max(o?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,n+e.FieldDropdown.IMAGE_Y_PADDING);o=o?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var a=this.svgArrow_?this.positionSVGArrow_(t+o,r/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):e.utils.dom.getFastTextWidth(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);this.size_.width=t+a+2*o,this.size_.height=r;var h=0;this.sourceBlock_.RTL?this.imageElement_.setAttribute("x",o+a):(h=t+a,this.textElement_.setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",o)),this.imageElement_.setAttribute("y",r/2-n/2),this.positionTextElement_(h+o,t+a)},e.FieldDropdown.prototype.renderSelectedText_=function(){this.textContent_.nodeValue=this.getDisplayText_(),e.utils.dom.addClass(this.textElement_,"blocklyDropdownText"),this.textElement_.setAttribute("text-anchor","start");var t=!!this.borderRect_,n=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT),o=e.utils.dom.getFastTextWidth(this.textElement_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var r=0;this.svgArrow_&&(r=this.positionSVGArrow_(o+t,n/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=o+r+2*t,this.size_.height=n,this.positionTextElement_(t,o)},e.FieldDropdown.prototype.positionSVGArrow_=function(t,n){if(!this.svgArrow_)return 0;var o=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,r=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,a=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(this.sourceBlock_.RTL?o:t+r)+","+n+")"),a+r},e.FieldDropdown.prototype.getText_=function(){if(!this.selectedOption_)return null;var t=this.selectedOption_[0];return"object"==typeof t?t.alt:t},e.FieldDropdown.validateOptions_=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");for(var n=!1,o=0;o<t.length;++o){var r=t[o];Array.isArray(r)?"string"!=typeof r[1]?(n=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option id must be a string. Found "+r[1]+" in: ",r)):r[0]&&"string"!=typeof r[0]&&"string"!=typeof r[0].src&&(n=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option must have a string label or image description. Found"+r[0]+" in: ",r)):(n=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option must be an array. Found: ",r))}if(n)throw TypeError("Found invalid FieldDropdown options.")},e.fieldRegistry.register("field_dropdown",e.FieldDropdown),e.FieldLabelSerializable=function(t,n,o){e.FieldLabelSerializable.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.FieldLabelSerializable,e.FieldLabel),e.FieldLabelSerializable.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldLabelSerializable(n,void 0,t)},e.FieldLabelSerializable.prototype.EDITABLE=!1,e.FieldLabelSerializable.prototype.SERIALIZABLE=!0,e.fieldRegistry.register("field_label_serializable",e.FieldLabelSerializable),e.FieldImage=function(t,n,o,r,a,h,R){if(!t)throw Error("Src value of an image field is required");if(t=e.utils.replaceMessageReferences(t),o=Number(e.utils.replaceMessageReferences(o)),n=Number(e.utils.replaceMessageReferences(n)),isNaN(o)||isNaN(n))throw Error("Height and width values of an image field must cast to numbers.");if(0>=o||0>=n)throw Error("Height and width values of an image field must be greater than 0.");this.flipRtl_=!1,this.altText_="",e.FieldImage.superClass_.constructor.call(this,t,null,R),R||(this.flipRtl_=!!h,this.altText_=e.utils.replaceMessageReferences(r)||""),this.size_=new e.utils.Size(n,o+e.FieldImage.Y_PADDING),this.imageHeight_=o,this.clickHandler_=null,"function"==typeof a&&(this.clickHandler_=a),this.imageElement_=null},e.utils.object.inherits(e.FieldImage,e.Field),e.FieldImage.prototype.DEFAULT_VALUE="",e.FieldImage.fromJson=function(t){return new e.FieldImage(t.src,t.width,t.height,void 0,void 0,void 0,t)},e.FieldImage.Y_PADDING=1,e.FieldImage.prototype.EDITABLE=!1,e.FieldImage.prototype.isDirty_=!1,e.FieldImage.prototype.configure_=function(t){e.FieldImage.superClass_.configure_.call(this,t),this.flipRtl_=!!t.flipRtl,this.altText_=e.utils.replaceMessageReferences(t.alt)||""},e.FieldImage.prototype.initView=function(){this.imageElement_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")},e.FieldImage.prototype.updateSize_=function(){},e.FieldImage.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:t},e.FieldImage.prototype.doValueUpdate_=function(t){this.value_=t,this.imageElement_&&this.imageElement_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",String(this.value_))},e.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},e.FieldImage.prototype.setAlt=function(t){t!=this.altText_&&(this.altText_=t||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))},e.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},e.FieldImage.prototype.setOnClickHandler=function(t){this.clickHandler_=t},e.FieldImage.prototype.getText_=function(){return this.altText_},e.fieldRegistry.register("field_image",e.FieldImage),e.FieldMultilineInput=function(t,n,o){e.FieldMultilineInput.superClass_.constructor.call(this,t,n,o),this.textGroup_=null,this.maxLines_=1/0,this.isOverflowedY_=!1},e.utils.object.inherits(e.FieldMultilineInput,e.FieldTextInput),e.FieldMultilineInput.prototype.configure_=function(t){e.FieldMultilineInput.superClass_.configure_.call(this,t),t.maxLines&&this.setMaxLines(t.maxLines)},e.FieldMultilineInput.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldMultilineInput(n,void 0,t)},e.FieldMultilineInput.prototype.toXml=function(t){return t.textContent=this.getValue().replace(/\n/g,"&#10;"),t},e.FieldMultilineInput.prototype.fromXml=function(t){this.setValue(t.textContent.replace(/&#10;/g,"\n"))},e.FieldMultilineInput.prototype.initView=function(){this.createBorderRect_(),this.textGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyEditableText"},this.fieldGroup_)},e.FieldMultilineInput.prototype.getDisplayText_=function(){var t=this.getText();if(!t)return e.Field.NBSP;var n=t.split("\n");t="";for(var o=this.isOverflowedY_?this.maxLines_:n.length,r=0;r<o;r++){var a=n[r];a.length>this.maxDisplayLength?a=a.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&r===o-1&&(a=a.substring(0,a.length-3)+"..."),t+=a=a.replace(/\s/g,e.Field.NBSP),r!==o-1&&(t+="\n")}return this.sourceBlock_.RTL&&(t+="\u200f"),t},e.FieldMultilineInput.prototype.doValueUpdate_=function(t){e.FieldMultilineInput.superClass_.doValueUpdate_.call(this,t),this.isOverflowedY_=this.value_.split("\n").length>this.maxLines_},e.FieldMultilineInput.prototype.render_=function(){for(var t;t=this.textGroup_.firstChild;)this.textGroup_.removeChild(t);t=this.getDisplayText_().split("\n");for(var n=0,o=0;o<t.length;o++){var r=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:n+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(t[o])),n+=r}this.isBeingEdited_&&(t=this.htmlInput_,this.isOverflowedY_?e.utils.dom.addClass(t,"blocklyHtmlTextAreaInputOverflowedY"):e.utils.dom.removeClass(t,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(this.sourceBlock_.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),t=this.htmlInput_,this.isTextValid_?(e.utils.dom.removeClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!1)):(e.utils.dom.addClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!0)))},e.FieldMultilineInput.prototype.updateSize_=function(){for(var t=this.textGroup_.childNodes,n=0,o=0,r=0;r<t.length;r++){var a=e.utils.dom.getTextWidth(t[r]);a>n&&(n=a),o+=this.getConstants().FIELD_TEXT_HEIGHT+(0<r?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){t=this.value_.split("\n"),a=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText"});var h=this.getConstants().FIELD_TEXT_FONTSIZE,R=this.getConstants().FIELD_TEXT_FONTWEIGHT,L=this.getConstants().FIELD_TEXT_FONTFAMILY;for(r=0;r<t.length;r++){t[r].length>this.maxDisplayLength&&(t[r]=t[r].substring(0,this.maxDisplayLength)),a.textContent=t[r];var W=e.utils.dom.getFastTextWidth(a,h,R,L);W>n&&(n=W)}n+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(o+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,n+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",n),this.borderRect_.setAttribute("height",o)),this.size_.width=n,this.size_.height=o,this.positionBorderRect_()},e.FieldMultilineInput.prototype.showEditor_=function(t,n){e.FieldMultilineInput.superClass_.showEditor_.call(this,t,n),this.forceRerender()},e.FieldMultilineInput.prototype.widgetCreate_=function(){var t=e.WidgetDiv.DIV,n=this.workspace_.getScale(),o=document.createElement("textarea");o.className="blocklyHtmlInput blocklyHtmlTextAreaInput",o.setAttribute("spellcheck",this.spellcheck_);var r=this.getConstants().FIELD_TEXT_FONTSIZE*n+"pt";t.style.fontSize=r,o.style.fontSize=r,o.style.borderRadius=e.FieldTextInput.BORDERRADIUS*n+"px",r=this.getConstants().FIELD_BORDER_RECT_X_PADDING*n;var a=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*n/2;return o.style.padding=a+"px "+r+"px "+a+"px "+r+"px",r=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,o.style.lineHeight=r*n+"px",t.appendChild(o),o.value=o.defaultValue=this.getEditorText_(this.value_),o.untypedDefaultValue_=this.value_,o.oldValue_=null,e.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(o),o},e.FieldMultilineInput.prototype.setMaxLines=function(t){"number"==typeof t&&0<t&&t!==this.maxLines_&&(this.maxLines_=t,this.forceRerender())},e.FieldMultilineInput.prototype.getMaxLines=function(){return this.maxLines_},e.FieldMultilineInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode!==e.utils.KeyCodes.ENTER&&e.FieldMultilineInput.superClass_.onHtmlInputKeyDown_.call(this,t)},e.Css.register(".blocklyHtmlTextAreaInput {,font-family: monospace;,resize: none;,overflow: hidden;,height: 100%;,text-align: left;,},.blocklyHtmlTextAreaInputOverflowedY {,overflow-y: scroll;,}".split(",")),e.fieldRegistry.register("field_multilinetext",e.FieldMultilineInput),e.FieldNumber=function(t,n,o,r,a,h){this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,e.FieldNumber.superClass_.constructor.call(this,t,a,h),h||this.setConstraints(n,o,r)},e.utils.object.inherits(e.FieldNumber,e.FieldTextInput),e.FieldNumber.prototype.DEFAULT_VALUE=0,e.FieldNumber.fromJson=function(t){return new e.FieldNumber(t.value,void 0,void 0,void 0,void 0,t)},e.FieldNumber.prototype.SERIALIZABLE=!0,e.FieldNumber.prototype.configure_=function(t){e.FieldNumber.superClass_.configure_.call(this,t),this.setMinInternal_(t.min),this.setMaxInternal_(t.max),this.setPrecisionInternal_(t.precision)},e.FieldNumber.prototype.setConstraints=function(t,n,o){this.setMinInternal_(t),this.setMaxInternal_(n),this.setPrecisionInternal_(o),this.setValue(this.getValue())},e.FieldNumber.prototype.setMin=function(t){this.setMinInternal_(t),this.setValue(this.getValue())},e.FieldNumber.prototype.setMinInternal_=function(t){null==t?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))},e.FieldNumber.prototype.getMin=function(){return this.min_},e.FieldNumber.prototype.setMax=function(t){this.setMaxInternal_(t),this.setValue(this.getValue())},e.FieldNumber.prototype.setMaxInternal_=function(t){null==t?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))},e.FieldNumber.prototype.getMax=function(){return this.max_},e.FieldNumber.prototype.setPrecision=function(t){this.setPrecisionInternal_(t),this.setValue(this.getValue())},e.FieldNumber.prototype.setPrecisionInternal_=function(t){this.precision_=Number(t)||0;var n=String(this.precision_);-1!=n.indexOf("e")&&(n=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));var o=n.indexOf(".");this.decimalPlaces_=-1==o?t?0:null:n.length-o-1},e.FieldNumber.prototype.getPrecision=function(){return this.precision_},e.FieldNumber.prototype.doClassValidation_=function(t){return null===t||(t=(t=(t=(t=String(t)).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),t=Number(t||0),isNaN(t))?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),null!=this.decimalPlaces_&&(t=Number(t.toFixed(this.decimalPlaces_))),t)},e.FieldNumber.prototype.widgetCreate_=function(){var t=e.FieldNumber.superClass_.widgetCreate_.call(this);return-1/0<this.min_&&e.utils.aria.setState(t,e.utils.aria.State.VALUEMIN,this.min_),1/0>this.max_&&e.utils.aria.setState(t,e.utils.aria.State.VALUEMAX,this.max_),t},e.fieldRegistry.register("field_number",e.FieldNumber),e.FieldVariable=function(t,n,o,r,a){this.menuGenerator_=e.FieldVariable.dropdownCreate,this.defaultVariableName="string"==typeof t?t:"",this.size_=new e.utils.Size(0,0),a&&this.configure_(a),n&&this.setValidator(n),a||this.setTypes_(o,r)},e.utils.object.inherits(e.FieldVariable,e.FieldDropdown),e.FieldVariable.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.variable);return new e.FieldVariable(n,void 0,void 0,void 0,t)},e.FieldVariable.prototype.SERIALIZABLE=!0,e.FieldVariable.prototype.configure_=function(t){e.FieldVariable.superClass_.configure_.call(this,t),this.setTypes_(t.variableTypes,t.defaultType)},e.FieldVariable.prototype.initModel=function(){if(!this.variable_){var t=e.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,null,this.defaultVariableName,this.defaultType_);this.doValueUpdate_(t.getId())}},e.FieldVariable.prototype.shouldAddBorderRect_=function(){return e.FieldVariable.superClass_.shouldAddBorderRect_.call(this)&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!=this.sourceBlock_.type)},e.FieldVariable.prototype.fromXml=function(t){var n=t.getAttribute("id"),o=t.textContent,r=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(n=e.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,n,o,r),null!=r&&r!==n.type)throw Error("Serialized variable type with id '"+n.getId()+"' had type "+n.type+", and does not match variable field that references it: "+e.Xml.domToText(t)+".");this.setValue(n.getId())},e.FieldVariable.prototype.toXml=function(t){return this.initModel(),t.id=this.variable_.getId(),t.textContent=this.variable_.name,this.variable_.type&&t.setAttribute("variabletype",this.variable_.type),t},e.FieldVariable.prototype.setSourceBlock=function(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");e.FieldVariable.superClass_.setSourceBlock.call(this,t)},e.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null},e.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""},e.FieldVariable.prototype.getVariable=function(){return this.variable_},e.FieldVariable.prototype.getValidator=function(){return this.variable_?this.validator_:null},e.FieldVariable.prototype.doClassValidation_=function(t){if(null===t)return null;var n=e.Variables.getVariable(this.sourceBlock_.workspace,t);return n?this.typeIsAllowed_(n=n.type)?t:(console.warn("Variable type doesn't match this field!  Type was "+n),null):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)},e.FieldVariable.prototype.doValueUpdate_=function(t){this.variable_=e.Variables.getVariable(this.sourceBlock_.workspace,t),e.FieldVariable.superClass_.doValueUpdate_.call(this,t)},e.FieldVariable.prototype.typeIsAllowed_=function(t){var n=this.getVariableTypes_();if(!n)return!0;for(var o=0;o<n.length;o++)if(t==n[o])return!0;return!1},e.FieldVariable.prototype.getVariableTypes_=function(){var t=this.variableTypes;if(null===t&&this.sourceBlock_&&this.sourceBlock_.workspace)return this.sourceBlock_.workspace.getVariableTypes();if(0==(t=t||[""]).length)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t},e.FieldVariable.prototype.setTypes_=function(t,n){if(n=n||"",null==t||null==t)t=null;else{if(!Array.isArray(t))throw Error("'variableTypes' was not an array in the definition of a FieldVariable");for(var o=!1,r=0;r<t.length;r++)t[r]==n&&(o=!0);if(!o)throw Error("Invalid default type '"+n+"' in the definition of a FieldVariable")}this.defaultType_=n,this.variableTypes=t},e.FieldVariable.prototype.refreshVariableName=function(){this.forceRerender()},e.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var t=this.getText(),n=[];if(this.sourceBlock_&&this.sourceBlock_.workspace)for(var o=this.getVariableTypes_(),r=0;r<o.length;r++){var a=this.sourceBlock_.workspace.getVariablesOfType(o[r]);n=n.concat(a)}for(n.sort(e.VariableModel.compareByName),o=[],r=0;r<n.length;r++)o[r]=[n[r].name,n[r].getId()];return o.push([e.Msg.RENAME_VARIABLE,e.RENAME_VARIABLE_ID]),e.Msg.DELETE_VARIABLE&&o.push([e.Msg.DELETE_VARIABLE.replace("%1",t),e.DELETE_VARIABLE_ID]),o},e.FieldVariable.prototype.onItemSelected_=function(t,n){if(t=n.getValue(),this.sourceBlock_&&this.sourceBlock_.workspace){if(t==e.RENAME_VARIABLE_ID)return void e.Variables.renameVariable(this.sourceBlock_.workspace,this.variable_);if(t==e.DELETE_VARIABLE_ID)return void this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId())}this.setValue(t)},e.FieldVariable.prototype.referencesVariables=function(){return!0},e.fieldRegistry.register("field_variable",e.FieldVariable),e.utils.svgPaths={},e.utils.svgPaths.point=function(t,n){return" "+t+","+n+" "},e.utils.svgPaths.curve=function(t,n){return" "+t+n.join("")},e.utils.svgPaths.moveTo=function(t,n){return" M "+t+","+n+" "},e.utils.svgPaths.moveBy=function(t,n){return" m "+t+","+n+" "},e.utils.svgPaths.lineTo=function(t,n){return" l "+t+","+n+" "},e.utils.svgPaths.line=function(t){return" l"+t.join("")},e.utils.svgPaths.lineOnAxis=function(t,n){return" "+t+" "+n+" "},e.utils.svgPaths.arc=function(t,n,o,r){return t+" "+o+" "+o+" "+n+r},e.blockRendering.ConstantProvider=function(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.CORNER_RADIUS=8,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=e.utils.svgPaths.moveBy(0,0),this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_TEXT_BASELINE_CENTER=!e.utils.userAgent.IE&&!e.utils.userAgent.EDGE,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2),this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2}},e.blockRendering.ConstantProvider.prototype.init=function(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()},e.blockRendering.ConstantProvider.prototype.setTheme=function(t){this.blockStyles=Object.create(null);var o,n=t.blockStyles;for(o in n)this.blockStyles[o]=this.validatedBlockStyle_(n[o]);this.setDynamicProperties_(t)},e.blockRendering.ConstantProvider.prototype.setDynamicProperties_=function(t){this.setFontConstants_(t),this.setComponentConstants_(t),this.ADD_START_HATS=null!=t.startHats?t.startHats:this.ADD_START_HATS},e.blockRendering.ConstantProvider.prototype.setFontConstants_=function(t){this.FIELD_TEXT_FONTFAMILY=t.fontStyle&&null!=t.fontStyle.family?t.fontStyle.family:this.FIELD_TEXT_FONTFAMILY,this.FIELD_TEXT_FONTWEIGHT=t.fontStyle&&null!=t.fontStyle.weight?t.fontStyle.weight:this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTSIZE=t.fontStyle&&null!=t.fontStyle.size?t.fontStyle.size:this.FIELD_TEXT_FONTSIZE,t=e.utils.dom.measureFontMetrics("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=t.height,this.FIELD_TEXT_BASELINE=t.baseline},e.blockRendering.ConstantProvider.prototype.setComponentConstants_=function(t){this.CURSOR_COLOUR=t.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=t.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=t.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(t.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY},e.blockRendering.ConstantProvider.prototype.getBlockStyleForColour=function(t){var n="auto_"+t;return this.blockStyles[n]||(this.blockStyles[n]=this.createBlockStyle_(t)),{style:this.blockStyles[n],name:n}},e.blockRendering.ConstantProvider.prototype.getBlockStyle=function(t){return this.blockStyles[t||""]||(t&&0==t.indexOf("auto_")?this.getBlockStyleForColour(t.substring(5)).style:this.createBlockStyle_("#000000"))},e.blockRendering.ConstantProvider.prototype.createBlockStyle_=function(t){return this.validatedBlockStyle_({colourPrimary:t})},e.blockRendering.ConstantProvider.prototype.validatedBlockStyle_=function(t){var n={};return t&&e.utils.object.mixin(n,t),t=e.utils.parseBlockColour(n.colourPrimary||"#000"),n.colourPrimary=t.hex,n.colourSecondary=n.colourSecondary?e.utils.parseBlockColour(n.colourSecondary).hex:this.generateSecondaryColour_(n.colourPrimary),n.colourTertiary=n.colourTertiary?e.utils.parseBlockColour(n.colourTertiary).hex:this.generateTertiaryColour_(n.colourPrimary),n.hat=n.hat||"",n},e.blockRendering.ConstantProvider.prototype.generateSecondaryColour_=function(t){return e.utils.colour.blend("#fff",t,.6)||t},e.blockRendering.ConstantProvider.prototype.generateTertiaryColour_=function(t){return e.utils.colour.blend("#fff",t,.3)||t},e.blockRendering.ConstantProvider.prototype.dispose=function(){this.embossFilter_&&e.utils.dom.removeNode(this.embossFilter_),this.disabledPattern_&&e.utils.dom.removeNode(this.disabledPattern_),this.debugFilter_&&e.utils.dom.removeNode(this.debugFilter_),this.cssNode_=null},e.blockRendering.ConstantProvider.prototype.makeJaggedTeeth=function(){var t=this.JAGGED_TEETH_HEIGHT,n=this.JAGGED_TEETH_WIDTH;return{height:t,width:n,path:e.utils.svgPaths.line([e.utils.svgPaths.point(n,t/4),e.utils.svgPaths.point(2*-n,t/2),e.utils.svgPaths.point(n,t/4)])}},e.blockRendering.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,n=this.START_HAT_WIDTH;return{height:t,width:n,path:e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(30,-t),e.utils.svgPaths.point(70,-t),e.utils.svgPaths.point(n,0)])}},e.blockRendering.ConstantProvider.prototype.makePuzzleTab=function(){function t(h){var R=-(h=h?-1:1),L=o/2,W=L+2.5,nt=L+.5,et=e.utils.svgPaths.point(-n,h*L);return L=e.utils.svgPaths.point(n,h*L),e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(0,h*W),e.utils.svgPaths.point(-n,R*nt),et])+e.utils.svgPaths.curve("s",[e.utils.svgPaths.point(n,2.5*R),L])}var n=this.TAB_WIDTH,o=this.TAB_HEIGHT,r=t(!0),a=t(!1);return{type:this.SHAPES.PUZZLE,width:n,height:o,pathDown:a,pathUp:r}},e.blockRendering.ConstantProvider.prototype.makeNotch=function(){function t(R){return e.utils.svgPaths.line([e.utils.svgPaths.point(R*r,o),e.utils.svgPaths.point(3*R,0),e.utils.svgPaths.point(R*r,-o)])}var n=this.NOTCH_WIDTH,o=this.NOTCH_HEIGHT,r=(n-3)/2,a=t(1),h=t(-1);return{type:this.SHAPES.NOTCH,width:n,height:o,pathLeft:a,pathRight:h}},e.blockRendering.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS;return{width:t,height:t,pathTop:e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(-t,t)),pathBottom:e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(t,t))}},e.blockRendering.ConstantProvider.prototype.makeOutsideCorners=function(){var t=this.CORNER_RADIUS,n=e.utils.svgPaths.moveBy(0,t)+e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(t,-t)),o=e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(t,t)),r=e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(-t,-t));return{topLeft:n,topRight:o,bottomRight:e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(-t,t)),bottomLeft:r,rightHeight:t}},e.blockRendering.ConstantProvider.prototype.shapeFor=function(t){switch(t.type){case e.connectionTypes.INPUT_VALUE:case e.connectionTypes.OUTPUT_VALUE:return this.PUZZLE_TAB;case e.connectionTypes.PREVIOUS_STATEMENT:case e.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}},e.blockRendering.ConstantProvider.prototype.createDom=function(t,n,o){this.injectCSS_(n,o),t=e.utils.dom.createSvgElement(e.utils.Svg.DEFS,{},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},t),e.utils.dom.createSvgElement(e.utils.Svg.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},n),o=e.utils.dom.createSvgElement(e.utils.Svg.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},o),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},n),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},n),this.embossFilterId=n.id,this.embossFilter_=n,n=e.utils.dom.createSvgElement(e.utils.Svg.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},t),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:10,height:10,fill:"#aaa"},n),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},n),this.disabledPatternId=n.id,this.disabledPattern_=n,e.blockRendering.Debug&&(t=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},t),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.debugFilterId=t.id,this.debugFilter_=t)},e.blockRendering.ConstantProvider.prototype.injectCSS_=function(t,n){n=this.getCSS_(n),t="blockly-renderer-style-"+t,this.cssNode_=document.getElementById(t);var o=n.join("\n");this.cssNode_?this.cssNode_.firstChild.textContent=o:((n=document.createElement("style")).id=t,t=document.createTextNode(o),n.appendChild(t),document.head.insertBefore(n,document.head.firstChild),this.cssNode_=n)},e.blockRendering.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText, ",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect,",t+" .blocklyEditableText>rect {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","fill-opacity: .6;","stroke: none;","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text {","fill: #000;","}",t+" .blocklyFlyoutLabelText {","fill: #000;","}",t+" .blocklyText.blocklyBubbleText {","fill: #000;","}",t+" .blocklyEditableText:not(.editing):hover>rect {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","}",t+" .blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",t+" .blocklyHighlightedConnectionPath {","stroke: #fc3;","}",t+" .blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",t+" .blocklyReplaceable .blocklyPathLight,",t+" .blocklyReplaceable .blocklyPathDark {","display: none;","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},e.blockRendering.Types={NONE:0,FIELD:1,HAT:2,ICON:4,SPACER:8,BETWEEN_ROW_SPACER:16,IN_ROW_SPACER:32,EXTERNAL_VALUE_INPUT:64,INPUT:128,INLINE_INPUT:256,STATEMENT_INPUT:512,CONNECTION:1024,PREVIOUS_CONNECTION:2048,NEXT_CONNECTION:4096,OUTPUT_CONNECTION:8192,CORNER:16384,LEFT_SQUARE_CORNER:32768,LEFT_ROUND_CORNER:65536,RIGHT_SQUARE_CORNER:131072,RIGHT_ROUND_CORNER:262144,JAGGED_EDGE:524288,ROW:1048576,TOP_ROW:2097152,BOTTOM_ROW:4194304,INPUT_ROW:8388608},e.blockRendering.Types.LEFT_CORNER=e.blockRendering.Types.LEFT_SQUARE_CORNER|e.blockRendering.Types.LEFT_ROUND_CORNER,e.blockRendering.Types.RIGHT_CORNER=e.blockRendering.Types.RIGHT_SQUARE_CORNER|e.blockRendering.Types.RIGHT_ROUND_CORNER,e.blockRendering.Types.nextTypeValue_=16777216,e.blockRendering.Types.getType=function(t){return Object.prototype.hasOwnProperty.call(e.blockRendering.Types,t)||(e.blockRendering.Types[t]=e.blockRendering.Types.nextTypeValue_,e.blockRendering.Types.nextTypeValue_<<=1),e.blockRendering.Types[t]},e.blockRendering.Types.isField=function(t){return t.type&e.blockRendering.Types.FIELD},e.blockRendering.Types.isHat=function(t){return t.type&e.blockRendering.Types.HAT},e.blockRendering.Types.isIcon=function(t){return t.type&e.blockRendering.Types.ICON},e.blockRendering.Types.isSpacer=function(t){return t.type&e.blockRendering.Types.SPACER},e.blockRendering.Types.isInRowSpacer=function(t){return t.type&e.blockRendering.Types.IN_ROW_SPACER},e.blockRendering.Types.isInput=function(t){return t.type&e.blockRendering.Types.INPUT},e.blockRendering.Types.isExternalInput=function(t){return t.type&e.blockRendering.Types.EXTERNAL_VALUE_INPUT},e.blockRendering.Types.isInlineInput=function(t){return t.type&e.blockRendering.Types.INLINE_INPUT},e.blockRendering.Types.isStatementInput=function(t){return t.type&e.blockRendering.Types.STATEMENT_INPUT},e.blockRendering.Types.isPreviousConnection=function(t){return t.type&e.blockRendering.Types.PREVIOUS_CONNECTION},e.blockRendering.Types.isNextConnection=function(t){return t.type&e.blockRendering.Types.NEXT_CONNECTION},e.blockRendering.Types.isPreviousOrNextConnection=function(t){return t.type&(e.blockRendering.Types.PREVIOUS_CONNECTION|e.blockRendering.Types.NEXT_CONNECTION)},e.blockRendering.Types.isLeftRoundedCorner=function(t){return t.type&e.blockRendering.Types.LEFT_ROUND_CORNER},e.blockRendering.Types.isRightRoundedCorner=function(t){return t.type&e.blockRendering.Types.RIGHT_ROUND_CORNER},e.blockRendering.Types.isLeftSquareCorner=function(t){return t.type&e.blockRendering.Types.LEFT_SQUARE_CORNER},e.blockRendering.Types.isRightSquareCorner=function(t){return t.type&e.blockRendering.Types.RIGHT_SQUARE_CORNER},e.blockRendering.Types.isCorner=function(t){return t.type&e.blockRendering.Types.CORNER},e.blockRendering.Types.isJaggedEdge=function(t){return t.type&e.blockRendering.Types.JAGGED_EDGE},e.blockRendering.Types.isRow=function(t){return t.type&e.blockRendering.Types.ROW},e.blockRendering.Types.isBetweenRowSpacer=function(t){return t.type&e.blockRendering.Types.BETWEEN_ROW_SPACER},e.blockRendering.Types.isTopRow=function(t){return t.type&e.blockRendering.Types.TOP_ROW},e.blockRendering.Types.isBottomRow=function(t){return t.type&e.blockRendering.Types.BOTTOM_ROW},e.blockRendering.Types.isTopOrBottomRow=function(t){return t.type&(e.blockRendering.Types.TOP_ROW|e.blockRendering.Types.BOTTOM_ROW)},e.blockRendering.Types.isInputRow=function(t){return t.type&e.blockRendering.Types.INPUT_ROW},e.blockRendering.Measurable=function(t){this.height=this.width=0,this.type=e.blockRendering.Types.NONE,this.centerline=this.xPos=0,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT},e.blockRendering.Connection=function(t,n){e.blockRendering.Connection.superClass_.constructor.call(this,t),this.connectionModel=n,this.shape=this.constants_.shapeFor(n),this.isDynamicShape=!!this.shape.isDynamic,this.type|=e.blockRendering.Types.CONNECTION},e.utils.object.inherits(e.blockRendering.Connection,e.blockRendering.Measurable),e.blockRendering.OutputConnection=function(t,n){e.blockRendering.OutputConnection.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=0},e.utils.object.inherits(e.blockRendering.OutputConnection,e.blockRendering.Connection),e.blockRendering.PreviousConnection=function(t,n){e.blockRendering.PreviousConnection.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},e.utils.object.inherits(e.blockRendering.PreviousConnection,e.blockRendering.Connection),e.blockRendering.NextConnection=function(t,n){e.blockRendering.NextConnection.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},e.utils.object.inherits(e.blockRendering.NextConnection,e.blockRendering.Connection),e.blockRendering.InputConnection=function(t,n){e.blockRendering.InputConnection.superClass_.constructor.call(this,t,n.connection),this.type|=e.blockRendering.Types.INPUT,this.input=n,this.align=n.align,(this.connectedBlock=n.connection&&n.connection.targetBlock()?n.connection.targetBlock():null)?(t=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=t.width,this.connectedBlockHeight=t.height):this.connectedBlockHeight=this.connectedBlockWidth=0,this.connectionOffsetY=this.connectionOffsetX=0},e.utils.object.inherits(e.blockRendering.InputConnection,e.blockRendering.Connection),e.blockRendering.InlineInput=function(t,n){e.blockRendering.InlineInput.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY=this.isDynamicShape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=this.isDynamicShape?this.shape.connectionOffsetX(this.connectionWidth):0},e.utils.object.inherits(e.blockRendering.InlineInput,e.blockRendering.InputConnection),e.blockRendering.StatementInput=function(t,n){e.blockRendering.StatementInput.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width},e.utils.object.inherits(e.blockRendering.StatementInput,e.blockRendering.InputConnection),e.blockRendering.ExternalValueInput=function(t,n){e.blockRendering.ExternalValueInput.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width},e.utils.object.inherits(e.blockRendering.ExternalValueInput,e.blockRendering.InputConnection),e.blockRendering.Icon=function(t,n){e.blockRendering.Icon.superClass_.constructor.call(this,t),this.icon=n,this.isVisible=n.isVisible(),this.type|=e.blockRendering.Types.ICON,t=n.getCorrectedSize(),this.height=t.height,this.width=t.width},e.utils.object.inherits(e.blockRendering.Icon,e.blockRendering.Measurable),e.blockRendering.JaggedEdge=function(t){e.blockRendering.JaggedEdge.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width},e.utils.object.inherits(e.blockRendering.JaggedEdge,e.blockRendering.Measurable),e.blockRendering.Field=function(t,n,o){e.blockRendering.Field.superClass_.constructor.call(this,t),this.field=n,this.isEditable=n.EDITABLE,this.flipRtl=n.getFlipRtl(),this.type|=e.blockRendering.Types.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width,this.parentInput=o},e.utils.object.inherits(e.blockRendering.Field,e.blockRendering.Measurable),e.blockRendering.Hat=function(t){e.blockRendering.Hat.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height},e.utils.object.inherits(e.blockRendering.Hat,e.blockRendering.Measurable),e.blockRendering.SquareCorner=function(t,n){e.blockRendering.SquareCorner.superClass_.constructor.call(this,t),this.type=(n&&"left"!=n?e.blockRendering.Types.RIGHT_SQUARE_CORNER:e.blockRendering.Types.LEFT_SQUARE_CORNER)|e.blockRendering.Types.CORNER,this.width=this.height=this.constants_.NO_PADDING},e.utils.object.inherits(e.blockRendering.SquareCorner,e.blockRendering.Measurable),e.blockRendering.RoundCorner=function(t,n){e.blockRendering.RoundCorner.superClass_.constructor.call(this,t),this.type=(n&&"left"!=n?e.blockRendering.Types.RIGHT_ROUND_CORNER:e.blockRendering.Types.LEFT_ROUND_CORNER)|e.blockRendering.Types.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2},e.utils.object.inherits(e.blockRendering.RoundCorner,e.blockRendering.Measurable),e.blockRendering.InRowSpacer=function(t,n){e.blockRendering.InRowSpacer.superClass_.constructor.call(this,t),this.type=this.type|e.blockRendering.Types.SPACER|e.blockRendering.Types.IN_ROW_SPACER,this.width=n,this.height=this.constants_.SPACER_DEFAULT_HEIGHT},e.utils.object.inherits(e.blockRendering.InRowSpacer,e.blockRendering.Measurable),e.blockRendering.Row=function(t){this.type=e.blockRendering.Types.ROW,this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=this.hasStatement=this.hasExternalInput=!1,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT,this.align=null},e.blockRendering.Row.prototype.measure=function(){throw Error("Unexpected attempt to measure a base Row.")},e.blockRendering.Row.prototype.getLastInput=function(){for(var n,t=this.elements.length-1;n=this.elements[t];t--)if(e.blockRendering.Types.isInput(n))return n;return null},e.blockRendering.Row.prototype.startsWithElemSpacer=function(){return!0},e.blockRendering.Row.prototype.endsWithElemSpacer=function(){return!0},e.blockRendering.Row.prototype.getFirstSpacer=function(){for(var n,t=0;n=this.elements[t];t++)if(e.blockRendering.Types.isSpacer(n))return n;return null},e.blockRendering.Row.prototype.getLastSpacer=function(){for(var n,t=this.elements.length-1;n=this.elements[t];t--)if(e.blockRendering.Types.isSpacer(n))return n;return null},e.blockRendering.TopRow=function(t){e.blockRendering.TopRow.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.TOP_ROW,this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null},e.utils.object.inherits(e.blockRendering.TopRow,e.blockRendering.Row),e.blockRendering.TopRow.prototype.hasLeftSquareCorner=function(t){var n=(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection,o=t.getPreviousBlock();return!!t.outputConnection||n||!!o&&o.getNextBlock()==t},e.blockRendering.TopRow.prototype.hasRightSquareCorner=function(t){return!0},e.blockRendering.TopRow.prototype.measure=function(){for(var a,t=0,n=0,o=0,r=0;a=this.elements[r];r++)n+=a.width,e.blockRendering.Types.isSpacer(a)||(e.blockRendering.Types.isHat(a)?o=Math.max(o,a.ascenderHeight):t=Math.max(t,a.height));this.width=Math.max(this.minWidth,n),this.height=Math.max(this.minHeight,t)+o,this.capline=this.ascenderHeight=o,this.widthWithConnectedBlocks=this.width},e.blockRendering.TopRow.prototype.startsWithElemSpacer=function(){return!1},e.blockRendering.TopRow.prototype.endsWithElemSpacer=function(){return!1},e.blockRendering.BottomRow=function(t){e.blockRendering.BottomRow.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.BOTTOM_ROW,this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0},e.utils.object.inherits(e.blockRendering.BottomRow,e.blockRendering.Row),e.blockRendering.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection||!!t.getNextBlock()},e.blockRendering.BottomRow.prototype.hasRightSquareCorner=function(t){return!0},e.blockRendering.BottomRow.prototype.measure=function(){for(var a,t=0,n=0,o=0,r=0;a=this.elements[r];r++)n+=a.width,e.blockRendering.Types.isSpacer(a)||(e.blockRendering.Types.isNextConnection(a)?o=Math.max(o,a.height):t=Math.max(t,a.height));this.width=Math.max(this.minWidth,n),this.height=Math.max(this.minHeight,t)+o,this.descenderHeight=o,this.widthWithConnectedBlocks=this.width},e.blockRendering.BottomRow.prototype.startsWithElemSpacer=function(){return!1},e.blockRendering.BottomRow.prototype.endsWithElemSpacer=function(){return!1},e.blockRendering.SpacerRow=function(t,n,o){e.blockRendering.SpacerRow.superClass_.constructor.call(this,t),this.type=this.type|e.blockRendering.Types.SPACER|e.blockRendering.Types.BETWEEN_ROW_SPACER,this.width=o,this.height=n,this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.elements=[new e.blockRendering.InRowSpacer(this.constants_,o)]},e.utils.object.inherits(e.blockRendering.SpacerRow,e.blockRendering.Row),e.blockRendering.SpacerRow.prototype.measure=function(){},e.blockRendering.InputRow=function(t){e.blockRendering.InputRow.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.INPUT_ROW,this.connectedBlockWidths=0},e.utils.object.inherits(e.blockRendering.InputRow,e.blockRendering.Row),e.blockRendering.InputRow.prototype.measure=function(){this.width=this.minWidth,this.height=this.minHeight;for(var o,t=0,n=0;o=this.elements[n];n++)this.width+=o.width,e.blockRendering.Types.isInput(o)&&(e.blockRendering.Types.isStatementInput(o)?t+=o.connectedBlockWidth:e.blockRendering.Types.isExternalInput(o)&&0!=o.connectedBlockWidth&&(t+=o.connectedBlockWidth-o.connectionWidth)),e.blockRendering.Types.isSpacer(o)||(this.height=Math.max(this.height,o.height));this.connectedBlockWidths=t,this.widthWithConnectedBlocks=this.width+t},e.blockRendering.InputRow.prototype.endsWithElemSpacer=function(){return!this.hasExternalInput&&!this.hasStatement},e.blockRendering.RenderInfo=function(t,n){this.block_=n,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=n.outputConnection?new e.blockRendering.OutputConnection(this.constants_,n.outputConnection):null,this.isInline=n.getInputsInline()&&!n.isCollapsed(),this.isCollapsed=n.isCollapsed(),this.isInsertionMarker=n.isInsertionMarker(),this.RTL=n.RTL,this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.topRow=new e.blockRendering.TopRow(this.constants_),this.bottomRow=new e.blockRendering.BottomRow(this.constants_),this.startY=this.startX=0},e.blockRendering.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.blockRendering.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},e.blockRendering.RenderInfo.prototype.createRows_=function(){this.populateTopRow_(),this.rows.push(this.topRow);var t=new e.blockRendering.InputRow(this.constants_);this.inputRows.push(t);for(var r,n=this.block_.getIcons(),o=0;r=n[o];o++){var a=new e.blockRendering.Icon(this.constants_,r);this.isCollapsed&&r.collapseHidden?this.hiddenIcons.push(a):t.elements.push(a)}for(r=null,o=0;n=this.block_.inputList[o];o++)if(n.isVisible()){for(this.shouldStartNewRow_(n,r)&&(this.rows.push(t),t=new e.blockRendering.InputRow(this.constants_),this.inputRows.push(t)),r=0;a=n.fieldRow[r];r++)t.elements.push(new e.blockRendering.Field(this.constants_,a,n));this.addInput_(n,t),r=n}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new e.blockRendering.JaggedEdge(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)},e.blockRendering.RenderInfo.prototype.populateTopRow_=function(){var t=!!this.block_.previousConnection,n=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!t,o=this.topRow.hasLeftSquareCorner(this.block_)?e.blockRendering.SquareCorner:e.blockRendering.RoundCorner;this.topRow.elements.push(new o(this.constants_)),n?(t=new e.blockRendering.Hat(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new e.blockRendering.PreviousConnection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.topRow.minHeight=this.block_.inputList.length&&this.block_.inputList[0].type==e.inputTypes.STATEMENT&&!this.block_.isCollapsed()?this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.constants_.TOP_ROW_MIN_HEIGHT,o=this.topRow.hasRightSquareCorner(this.block_)?e.blockRendering.SquareCorner:e.blockRendering.RoundCorner,this.topRow.elements.push(new o(this.constants_,"right"))},e.blockRendering.RenderInfo.prototype.populateBottomRow_=function(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==e.inputTypes.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new e.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new e.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new e.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new e.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new e.blockRendering.RoundCorner(this.constants_,"right"))},e.blockRendering.RenderInfo.prototype.addInput_=function(t,n){this.isInline&&t.type==e.inputTypes.VALUE?(n.elements.push(new e.blockRendering.InlineInput(this.constants_,t)),n.hasInlineInput=!0):t.type==e.inputTypes.STATEMENT?(n.elements.push(new e.blockRendering.StatementInput(this.constants_,t)),n.hasStatement=!0):t.type==e.inputTypes.VALUE?(n.elements.push(new e.blockRendering.ExternalValueInput(this.constants_,t)),n.hasExternalInput=!0):t.type==e.inputTypes.DUMMY&&(n.minHeight=Math.max(n.minHeight,t.getSourceBlock()&&t.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),n.hasDummyInput=!0),null==n.align&&(n.align=t.align)},e.blockRendering.RenderInfo.prototype.shouldStartNewRow_=function(t,n){return!(!n||t.type!=e.inputTypes.STATEMENT&&n.type!=e.inputTypes.STATEMENT&&(t.type!=e.inputTypes.VALUE&&t.type!=e.inputTypes.DUMMY||this.isInline))},e.blockRendering.RenderInfo.prototype.addElemSpacing_=function(){for(var n,t=0;n=this.rows[t];t++){var o=n.elements;if(n.elements=[],n.startsWithElemSpacer()&&n.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,o[0]))),o.length){for(var r=0;r<o.length-1;r++){n.elements.push(o[r]);var a=this.getInRowSpacing_(o[r],o[r+1]);n.elements.push(new e.blockRendering.InRowSpacer(this.constants_,a))}n.elements.push(o[o.length-1]),n.endsWithElemSpacer()&&n.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(o[o.length-1],null)))}}},e.blockRendering.RenderInfo.prototype.getInRowSpacing_=function(t,n){if(!t&&n&&e.blockRendering.Types.isStatementInput(n))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(t&&e.blockRendering.Types.isInput(t)&&!n){if(e.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}return t&&e.blockRendering.Types.isLeftSquareCorner(t)&&n&&(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))?n.notchOffset:t&&e.blockRendering.Types.isLeftRoundedCorner(t)&&n&&(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))?n.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},e.blockRendering.RenderInfo.prototype.computeBounds_=function(){for(var a,t=0,n=0,o=0,r=0;a=this.rows[r];r++){if(a.measure(),n=Math.max(n,a.width),a.hasStatement){var h=a.getLastInput();t=Math.max(t,a.width-h.width)}o=Math.max(o,a.widthWithConnectedBlocks)}for(this.statementEdge=t,this.width=n,r=0;a=this.rows[r];r++)a.hasStatement&&(a.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(n,o),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)},e.blockRendering.RenderInfo.prototype.alignRowElements_=function(){for(var n,t=0;n=this.rows[t];t++)if(n.hasStatement)this.alignStatementRow_(n);else{var o=n.width;0<(o=this.getDesiredRowWidth_(n)-o)&&this.addAlignmentPadding_(n,o),e.blockRendering.Types.isTopOrBottomRow(n)&&(n.widthWithConnectedBlocks=n.width)}},e.blockRendering.RenderInfo.prototype.getDesiredRowWidth_=function(t){return this.width-this.startX},e.blockRendering.RenderInfo.prototype.addAlignmentPadding_=function(t,n){var o=t.getFirstSpacer(),r=t.getLastSpacer();(t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=n),t.align==e.constants.ALIGN.LEFT?r.width+=n:t.align==e.constants.ALIGN.CENTRE?(o.width+=n/2,r.width+=n/2):t.align==e.constants.ALIGN.RIGHT?o.width+=n:r.width+=n,t.width+=n},e.blockRendering.RenderInfo.prototype.alignStatementRow_=function(t){var n=t.getLastInput(),o=t.width-n.width,r=this.statementEdge;0<(o=r-o)&&this.addAlignmentPadding_(t,o),o=t.width,r=this.getDesiredRowWidth_(t),n.width+=r-o,n.height=Math.max(n.height,t.height),t.width+=r-o,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)},e.blockRendering.RenderInfo.prototype.addRowSpacing_=function(){var t=this.rows;this.rows=[];for(var n=0;n<t.length;n++)this.rows.push(t[n]),n!=t.length-1&&this.rows.push(this.makeSpacerRow_(t[n],t[n+1]))},e.blockRendering.RenderInfo.prototype.makeSpacerRow_=function(t,n){var o=this.getSpacerRowHeight_(t,n),r=this.getSpacerRowWidth_(t,n);return o=new e.blockRendering.SpacerRow(this.constants_,o,r),t.hasStatement&&(o.followsStatement=!0),n.hasStatement&&(o.precedesStatement=!0),o},e.blockRendering.RenderInfo.prototype.getSpacerRowWidth_=function(t,n){return this.width-this.startX},e.blockRendering.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){return this.constants_.MEDIUM_PADDING},e.blockRendering.RenderInfo.prototype.getElemCenterline_=function(t,n){return e.blockRendering.Types.isSpacer(n)?t.yPos+n.height/2:e.blockRendering.Types.isBottomRow(t)?(t=t.yPos+t.height-t.descenderHeight,e.blockRendering.Types.isNextConnection(n)?t+n.height/2:t-n.height/2):e.blockRendering.Types.isTopRow(t)?e.blockRendering.Types.isHat(n)?t.capline-n.height/2:t.capline+n.height/2:t.yPos+t.height/2},e.blockRendering.RenderInfo.prototype.recordElemPositions_=function(t){for(var r,n=t.xPos,o=0;r=t.elements[o];o++)e.blockRendering.Types.isSpacer(r)&&(r.height=t.height),r.xPos=n,r.centerline=this.getElemCenterline_(t,r),n+=r.width},e.blockRendering.RenderInfo.prototype.finalize_=function(){for(var r,t=0,n=0,o=0;r=this.rows[o];o++)r.yPos=n,r.xPos=this.startX,n+=r.height,t=Math.max(t,r.widthWithConnectedBlocks),this.recordElemPositions_(r);this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(t=Math.max(t,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.widthWithChildren=t+this.startX,this.height=n,this.startY=this.topRow.capline,this.bottomRow.baseline=n-this.bottomRow.descenderHeight},e.blockRendering.Debug=function(t){this.debugElements_=[],this.svgRoot_=null,this.constants_=t},e.blockRendering.Debug.config={rowSpacers:!0,elemSpacers:!0,rows:!0,elems:!0,connections:!0,blockBounds:!0,connectedBlockBounds:!0,render:!0},e.blockRendering.Debug.prototype.clearElems=function(){for(var n,t=0;n=this.debugElements_[t];t++)e.utils.dom.removeNode(n);this.debugElements_=[]},e.blockRendering.Debug.prototype.drawSpacerRow=function(t,n,o){if(e.blockRendering.Debug.config.rowSpacers){var r=Math.abs(t.height),a=0>t.height;a&&(n-=r),this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"rowSpacerRect blockRenderDebug",x:o?-(t.xPos+t.width):t.xPos,y:n,width:t.width,height:r,stroke:a?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawSpacerElem=function(t,n,o){if(e.blockRendering.Debug.config.elemSpacers){n=Math.abs(t.width);var r=0>t.width,a=r?t.xPos-n:t.xPos;o&&(a=-(a+n)),this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"elemSpacerRect blockRenderDebug",x:a,y:t.centerline-t.height/2,width:n,height:t.height,stroke:"pink",fill:r?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawRenderedElem=function(t,n){if(e.blockRendering.Debug.config.elems){var o=t.xPos;n&&(o=-(o+t.width)),this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:o,y:n=t.centerline-t.height/2,width:t.width,height:t.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_)),e.blockRendering.Types.isField(t)&&t.field instanceof e.FieldLabel&&this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:o,y:n+this.constants_.FIELD_TEXT_BASELINE,width:t.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_))}e.blockRendering.Types.isInput(t)&&e.blockRendering.Debug.config.connections&&this.drawConnection(t.connectionModel)},e.blockRendering.Debug.prototype.drawConnection=function(t){if(e.blockRendering.Debug.config.connections){if(t.type==e.connectionTypes.INPUT_VALUE)var n=4,o="magenta",r="none";else t.type==e.connectionTypes.OUTPUT_VALUE?(n=2,r=o="magenta"):t.type==e.connectionTypes.NEXT_STATEMENT?(n=4,o="goldenrod",r="none"):t.type==e.connectionTypes.PREVIOUS_STATEMENT&&(n=2,r=o="goldenrod");this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{class:"blockRenderDebug",cx:t.offsetInBlock_.x,cy:t.offsetInBlock_.y,r:n,fill:r,stroke:o},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawRenderedRow=function(t,n,o){e.blockRendering.Debug.config.rows&&(this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"elemRenderingRect blockRenderDebug",x:o?-(t.xPos+t.width):t.xPos,y:t.yPos,width:t.width,height:t.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),e.blockRendering.Types.isTopOrBottomRow(t)||e.blockRendering.Debug.config.connectedBlockBounds&&this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"connectedBlockWidth blockRenderDebug",x:o?-(t.xPos+t.widthWithConnectedBlocks):t.xPos,y:t.yPos,width:t.widthWithConnectedBlocks,height:t.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))},e.blockRendering.Debug.prototype.drawRowWithElements=function(t,n,o){for(var r=0,a=t.elements.length;r<a;r++){var h=t.elements[r];h?e.blockRendering.Types.isSpacer(h)?this.drawSpacerElem(h,t.height,o):this.drawRenderedElem(h,o):console.warn("A row has an undefined or null element.",t,h)}this.drawRenderedRow(t,n,o)},e.blockRendering.Debug.prototype.drawBoundingBox=function(t){if(e.blockRendering.Debug.config.blockBounds){var n=t.RTL?-t.width:0;this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blockBoundingBox blockRenderDebug",x:n,y:0,width:t.width,height:t.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_)),e.blockRendering.Debug.config.connectedBlockBounds&&this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blockRenderDebug",x:n=t.RTL?-t.widthWithChildren:0,y:0,width:t.widthWithChildren,height:t.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawDebug=function(t,n){this.clearElems(),this.svgRoot_=t.getSvgRoot(),this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);for(var a,o=0,r=0;a=n.rows[r];r++)e.blockRendering.Types.isBetweenRowSpacer(a)?this.drawSpacerRow(a,o,n.RTL):this.drawRowWithElements(a,o,n.RTL),o+=a.height;t.previousConnection&&this.drawConnection(t.previousConnection),t.nextConnection&&this.drawConnection(t.nextConnection),t.outputConnection&&this.drawConnection(t.outputConnection),n.rightSide&&this.drawRenderedElem(n.rightSide,n.RTL),this.drawBoundingBox(n),this.drawRender(t.pathObject.svgPath)},e.blockRendering.Debug.prototype.drawRender=function(t){e.blockRendering.Debug.config.render&&(t.setAttribute("filter","url(#"+this.constants_.debugFilterId+")"),setTimeout(function(){t.setAttribute("filter","")},100))},e.blockRendering.Drawer=function(t,n){this.block_=t,this.info_=n,this.topLeft_=t.getRelativeToSurfaceXY(),this.inlinePath_=this.outlinePath_="",this.constants_=n.getRenderer().getConstants()},e.blockRendering.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),e.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},e.blockRendering.Drawer.prototype.recordSizeOnBlock_=function(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren},e.blockRendering.Drawer.prototype.hideHiddenIcons_=function(){for(var n,t=0;n=this.info_.hiddenIcons[t];t++)n.icon.iconGroup_.setAttribute("display","none")},e.blockRendering.Drawer.prototype.drawOutline_=function(){this.drawTop_();for(var t=1;t<this.info_.rows.length-1;t++){var n=this.info_.rows[t];n.hasJaggedEdge?this.drawJaggedEdge_(n):n.hasStatement?this.drawStatementInput_(n):n.hasExternalInput?this.drawValueInput_(n):this.drawRightSideRow_(n)}this.drawBottom_(),this.drawLeft_()},e.blockRendering.Drawer.prototype.drawTop_=function(){var t=this.info_.topRow,n=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=e.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var r,o=0;r=n[o];o++)e.blockRendering.Types.isLeftRoundedCorner(r)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:e.blockRendering.Types.isRightRoundedCorner(r)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:e.blockRendering.Types.isPreviousConnection(r)?this.outlinePath_+=r.shape.pathLeft:e.blockRendering.Types.isHat(r)?this.outlinePath_+=this.constants_.START_HAT.path:e.blockRendering.Types.isSpacer(r)&&(this.outlinePath_+=e.utils.svgPaths.lineOnAxis("h",r.width));this.outlinePath_+=e.utils.svgPaths.lineOnAxis("v",t.height)},e.blockRendering.Drawer.prototype.drawJaggedEdge_=function(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+e.utils.svgPaths.lineOnAxis("v",t.height-this.constants_.JAGGED_TEETH.height)},e.blockRendering.Drawer.prototype.drawValueInput_=function(t){var n=t.getLastInput();this.positionExternalValueConnection_(t);var o="function"==typeof n.shape.pathDown?n.shape.pathDown(n.height):n.shape.pathDown;this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",n.xPos+n.width)+o+e.utils.svgPaths.lineOnAxis("v",t.height-n.connectionHeight)},e.blockRendering.Drawer.prototype.drawStatementInput_=function(t){var n=t.getLastInput(),o=n.xPos+n.notchOffset+n.shape.width;n=n.shape.pathRight+e.utils.svgPaths.lineOnAxis("h",-(n.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var r=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",o)+n+e.utils.svgPaths.lineOnAxis("v",r)+this.constants_.INSIDE_CORNERS.pathBottom+e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},e.blockRendering.Drawer.prototype.drawRightSideRow_=function(t){this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},e.blockRendering.Drawer.prototype.drawBottom_=function(){var t=this.info_.bottomRow,n=t.elements;this.positionNextConnection_();for(var h,o=0,r="",a=n.length-1;h=n[a];a--)e.blockRendering.Types.isNextConnection(h)?r+=h.shape.pathRight:e.blockRendering.Types.isLeftSquareCorner(h)?r+=e.utils.svgPaths.lineOnAxis("H",t.xPos):e.blockRendering.Types.isLeftRoundedCorner(h)?r+=this.constants_.OUTSIDE_CORNERS.bottomLeft:e.blockRendering.Types.isRightRoundedCorner(h)?(r+=this.constants_.OUTSIDE_CORNERS.bottomRight,o=this.constants_.OUTSIDE_CORNERS.rightHeight):e.blockRendering.Types.isSpacer(h)&&(r+=e.utils.svgPaths.lineOnAxis("h",-1*h.width));this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.baseline-o),this.outlinePath_+=r},e.blockRendering.Drawer.prototype.drawLeft_=function(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){var n=t.connectionOffsetY+t.height;t="function"==typeof t.shape.pathUp?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",n)+t}this.outlinePath_+="z"},e.blockRendering.Drawer.prototype.drawInternals_=function(){for(var n,t=0;n=this.info_.rows[t];t++)for(var r,o=0;r=n.elements[o];o++)e.blockRendering.Types.isInlineInput(r)?this.drawInlineInput_(r):(e.blockRendering.Types.isIcon(r)||e.blockRendering.Types.isField(r))&&this.layoutField_(r)},e.blockRendering.Drawer.prototype.layoutField_=function(t){if(e.blockRendering.Types.isField(t))var n=t.field.getSvgRoot();else e.blockRendering.Types.isIcon(t)&&(n=t.icon.iconGroup_);var o=t.centerline-t.height/2,r=t.xPos,a="";this.info_.RTL&&(r=-(r+t.width),t.flipRtl&&(r+=t.width,a="scale(-1 1)")),e.blockRendering.Types.isIcon(t)?(n.setAttribute("display","block"),n.setAttribute("transform","translate("+r+","+o+")"),t.icon.computeIconLocation()):n.setAttribute("transform","translate("+r+","+o+")"+a),this.info_.isInsertionMarker&&n.setAttribute("display","none")},e.blockRendering.Drawer.prototype.drawInlineInput_=function(t){var n=t.width,o=t.height,r=t.connectionOffsetY,a=t.connectionHeight+r;this.inlinePath_+=e.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-o/2)+e.utils.svgPaths.lineOnAxis("v",r)+t.shape.pathDown+e.utils.svgPaths.lineOnAxis("v",o-a)+e.utils.svgPaths.lineOnAxis("h",n-t.connectionWidth)+e.utils.svgPaths.lineOnAxis("v",-o)+"z",this.positionInlineInputConnection_(t)},e.blockRendering.Drawer.prototype.positionInlineInputConnection_=function(t){if(t.connectionModel){var o=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(o*=-1),t.connectionModel.setOffsetInBlock(o,t.centerline-t.height/2+t.connectionOffsetY)}},e.blockRendering.Drawer.prototype.positionStatementInputConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.statementEdge+n.notchOffset;this.info_.RTL&&(o*=-1),n.connectionModel.setOffsetInBlock(o,t.yPos)}},e.blockRendering.Drawer.prototype.positionExternalValueConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.width;this.info_.RTL&&(o*=-1),n.connectionModel.setOffsetInBlock(o,t.yPos)}},e.blockRendering.Drawer.prototype.positionPreviousConnection_=function(){var t=this.info_.topRow;if(t.connection){var n=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-n:n,0)}},e.blockRendering.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var n=t.connection,o=n.xPos;n.connectionModel.setOffsetInBlock(this.info_.RTL?-o:o,t.baseline)}},e.blockRendering.Drawer.prototype.positionOutputConnection_=function(){if(this.info_.outputConnection){var t=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}},e.Events.MarkerMove=function(t,n,o,r){var a=t?t.workspace.id:void 0;r&&r.getType()==e.ASTNode.types.WORKSPACE&&(a=r.getLocation().id),e.Events.MarkerMove.superClass_.constructor.call(this,a),this.blockId=t?t.id:null,this.oldNode=o,this.newNode=r,this.isCursor=n},e.utils.object.inherits(e.Events.MarkerMove,e.Events.UiBase),e.Events.MarkerMove.prototype.type=e.Events.MARKER_MOVE,e.Events.MarkerMove.prototype.toJson=function(){var t=e.Events.MarkerMove.superClass_.toJson.call(this);return t.isCursor=this.isCursor,t.blockId=this.blockId,t.oldNode=this.oldNode,t.newNode=this.newNode,t},e.Events.MarkerMove.prototype.fromJson=function(t){e.Events.MarkerMove.superClass_.fromJson.call(this,t),this.isCursor=t.isCursor,this.blockId=t.blockId,this.oldNode=t.oldNode,this.newNode=t.newNode},e.registry.register(e.registry.Type.EVENT,e.Events.MARKER_MOVE,e.Events.MarkerMove),e.blockRendering.MarkerSvg=function(t,n,o){this.workspace_=t,this.marker_=o,this.parent_=null,this.constants_=n,this.currentMarkerSvg=null,t=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=o.colour||t},e.blockRendering.MarkerSvg.CURSOR_CLASS="blocklyCursor",e.blockRendering.MarkerSvg.MARKER_CLASS="blocklyMarker",e.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER=.75,e.blockRendering.MarkerSvg.prototype.getSvgRoot=function(){return this.svgGroup_},e.blockRendering.MarkerSvg.prototype.getMarker=function(){return this.marker_},e.blockRendering.MarkerSvg.prototype.isCursor=function(){return"cursor"==this.marker_.type},e.blockRendering.MarkerSvg.prototype.createDom=function(){var t=this.isCursor()?e.blockRendering.MarkerSvg.CURSOR_CLASS:e.blockRendering.MarkerSvg.MARKER_CLASS;return this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:t},null),this.createDomInternal_(),this.svgGroup_},e.blockRendering.MarkerSvg.prototype.setParent_=function(t){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())),this.parent_=t},e.blockRendering.MarkerSvg.prototype.draw=function(t,n){if(n){this.constants_=this.workspace_.getRenderer().getConstants();var o=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker_.colour||o,this.applyColour_(n),this.showAtLocation_(n),this.fireMarkerEvent_(t,n),void 0!==(t=this.currentMarkerSvg.childNodes[0])&&t.beginElement&&t.beginElement()}else this.hide()},e.blockRendering.MarkerSvg.prototype.showAtLocation_=function(t){var n=t.getLocation().type;t.getType()==e.ASTNode.types.BLOCK?this.showWithBlock_(t):t.getType()==e.ASTNode.types.OUTPUT?this.showWithOutput_(t):n==e.connectionTypes.INPUT_VALUE?this.showWithInput_(t):n==e.connectionTypes.NEXT_STATEMENT?this.showWithNext_(t):t.getType()==e.ASTNode.types.PREVIOUS?this.showWithPrevious_(t):t.getType()==e.ASTNode.types.FIELD?this.showWithField_(t):t.getType()==e.ASTNode.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()==e.ASTNode.types.STACK&&this.showWithStack_(t)},e.blockRendering.MarkerSvg.prototype.showWithBlockPrevOutput_=function(t){var n=(t=t.getSourceBlock()).width,o=t.height,r=o*e.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER,a=this.constants_.CURSOR_BLOCK_PADDING;if(t.previousConnection){var h=this.constants_.shapeFor(t.previousConnection);this.positionPrevious_(n,a,r,h)}else t.outputConnection?(h=this.constants_.shapeFor(t.outputConnection),this.positionOutput_(n,o,h)):this.positionBlock_(n,a,r);this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithBlock_=function(t){this.showWithBlockPrevOutput_(t)},e.blockRendering.MarkerSvg.prototype.showWithPrevious_=function(t){this.showWithBlockPrevOutput_(t)},e.blockRendering.MarkerSvg.prototype.showWithOutput_=function(t){this.showWithBlockPrevOutput_(t)},e.blockRendering.MarkerSvg.prototype.showWithCoordinates_=function(t){var n=t.getWsCoordinate();t=n.x,this.workspace_.RTL&&(t-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(t,n=n.y,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace_),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithField_=function(t){var n=(t=t.getLocation()).getSize().width,o=t.getSize().height;this.positionRect_(0,0,n,o),this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithInput_=function(t){var n=(t=t.getLocation()).getSourceBlock();this.positionInput_(t),this.setParent_(n),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithNext_=function(t){var n=t.getLocation();t=n.getSourceBlock();var o=0;n=n.getOffsetInBlock().y;var r=t.getHeightWidth().width;this.workspace_.RTL&&(o=-r),this.positionLine_(o,n,r),this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithStack_=function(t){var n=(t=t.getLocation()).getHeightWidth(),o=n.width+this.constants_.CURSOR_STACK_PADDING,r=-this.constants_.CURSOR_STACK_PADDING/2,h=r;this.workspace_.RTL&&(h=-(o+r)),this.positionRect_(h,-this.constants_.CURSOR_STACK_PADDING/2,o,n=n.height+this.constants_.CURSOR_STACK_PADDING),this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showCurrent_=function(){this.hide(),this.currentMarkerSvg.style.display=""},e.blockRendering.MarkerSvg.prototype.positionBlock_=function(t,n,o){t=e.utils.svgPaths.moveBy(-n,o)+e.utils.svgPaths.lineOnAxis("V",-n)+e.utils.svgPaths.lineOnAxis("H",t+2*n)+e.utils.svgPaths.lineOnAxis("V",o),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},e.blockRendering.MarkerSvg.prototype.positionInput_=function(t){var n=t.getOffsetInBlock().x,o=t.getOffsetInBlock().y;t=e.utils.svgPaths.moveTo(0,0)+this.constants_.shapeFor(t).pathDown,this.markerInput_.setAttribute("d",t),this.markerInput_.setAttribute("transform","translate("+n+","+o+")"+(this.workspace_.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_},e.blockRendering.MarkerSvg.prototype.positionLine_=function(t,n,o){this.markerSvgLine_.setAttribute("x",t),this.markerSvgLine_.setAttribute("y",n),this.markerSvgLine_.setAttribute("width",o),this.currentMarkerSvg=this.markerSvgLine_},e.blockRendering.MarkerSvg.prototype.positionOutput_=function(t,n,o){t=e.utils.svgPaths.moveBy(t,0)+e.utils.svgPaths.lineOnAxis("h",-(t-o.width))+e.utils.svgPaths.lineOnAxis("v",this.constants_.TAB_OFFSET_FROM_TOP)+o.pathDown+e.utils.svgPaths.lineOnAxis("V",n)+e.utils.svgPaths.lineOnAxis("H",t),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},e.blockRendering.MarkerSvg.prototype.positionPrevious_=function(t,n,o,r){t=e.utils.svgPaths.moveBy(-n,o)+e.utils.svgPaths.lineOnAxis("V",-n)+e.utils.svgPaths.lineOnAxis("H",this.constants_.NOTCH_OFFSET_LEFT)+r.pathLeft+e.utils.svgPaths.lineOnAxis("H",t+2*n)+e.utils.svgPaths.lineOnAxis("V",o),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},e.blockRendering.MarkerSvg.prototype.positionRect_=function(t,n,o,r){this.markerSvgRect_.setAttribute("x",t),this.markerSvgRect_.setAttribute("y",n),this.markerSvgRect_.setAttribute("width",o),this.markerSvgRect_.setAttribute("height",r),this.currentMarkerSvg=this.markerSvgRect_},e.blockRendering.MarkerSvg.prototype.flipRtl_=function(t){t.setAttribute("transform","scale(-1 1)")},e.blockRendering.MarkerSvg.prototype.hide=function(){this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"},e.blockRendering.MarkerSvg.prototype.fireMarkerEvent_=function(t,n){var o=n.getSourceBlock();t=new(e.Events.get(e.Events.MARKER_MOVE))(o,this.isCursor(),t,n),e.Events.fire(t)},e.blockRendering.MarkerSvg.prototype.getBlinkProperties_=function(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}},e.blockRendering.MarkerSvg.prototype.createDomInternal_=function(){if(this.markerSvg_=e.utils.dom.createSvgElement(e.utils.Svg.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var t=this.getBlinkProperties_();e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerSvgLine_),e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerInput_),t.attributeName="stroke",e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerBlock_)}return this.markerSvg_},e.blockRendering.MarkerSvg.prototype.applyColour_=function(t){this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(this.markerSvgLine_.firstChild.setAttribute("values",t=this.colour_+";transparent;transparent;"),this.markerInput_.firstChild.setAttribute("values",t),this.markerBlock_.firstChild.setAttribute("values",t))},e.blockRendering.MarkerSvg.prototype.dispose=function(){this.svgGroup_&&e.utils.dom.removeNode(this.svgGroup_)},e.blockRendering.PathObject=function(t,n,o){this.constants=o,this.svgRoot=t,this.svgPath=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.style=n,this.markerSvg=this.cursorSvg=null},e.blockRendering.PathObject.prototype.setPath=function(t){this.svgPath.setAttribute("d",t)},e.blockRendering.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)")},e.blockRendering.PathObject.prototype.setCursorSvg=function(t){t?(this.svgRoot.appendChild(t),this.cursorSvg=t):this.cursorSvg=null},e.blockRendering.PathObject.prototype.setMarkerSvg=function(t){t?(this.cursorSvg?this.svgRoot.insertBefore(t,this.cursorSvg):this.svgRoot.appendChild(t),this.markerSvg=t):this.markerSvg=null},e.blockRendering.PathObject.prototype.applyColour=function(t){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(t.isShadow()),this.updateDisabled_(!t.isEnabled()||t.getInheritedDisabled())},e.blockRendering.PathObject.prototype.setStyle=function(t){this.style=t},e.blockRendering.PathObject.prototype.setClass_=function(t,n){n?e.utils.dom.addClass(this.svgRoot,t):e.utils.dom.removeClass(this.svgRoot,t)},e.blockRendering.PathObject.prototype.updateHighlighted=function(t){this.svgPath.setAttribute("filter",t?"url(#"+this.constants.embossFilterId+")":"none")},e.blockRendering.PathObject.prototype.updateShadow_=function(t){t&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},e.blockRendering.PathObject.prototype.updateDisabled_=function(t){this.setClass_("blocklyDisabled",t),t&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")},e.blockRendering.PathObject.prototype.updateSelected=function(t){this.setClass_("blocklySelected",t)},e.blockRendering.PathObject.prototype.updateDraggingDelete=function(t){this.setClass_("blocklyDraggingDelete",t)},e.blockRendering.PathObject.prototype.updateInsertionMarker=function(t){this.setClass_("blocklyInsertionMarker",t)},e.blockRendering.PathObject.prototype.updateMovable=function(t){this.setClass_("blocklyDraggable",t)},e.blockRendering.PathObject.prototype.updateReplacementFade=function(t){this.setClass_("blocklyReplaceable",t)},e.blockRendering.PathObject.prototype.updateShapeForInputHighlight=function(t,n){},e.blockRendering.Renderer=function(t){this.name=t,this.overrides=this.constants_=null},e.blockRendering.Renderer.prototype.getClassName=function(){return this.name+"-renderer"},e.blockRendering.Renderer.prototype.init=function(t,n){this.constants_=this.makeConstants_(),n&&(this.overrides=n,e.utils.object.mixin(this.constants_,n)),this.constants_.setTheme(t),this.constants_.init()},e.blockRendering.Renderer.prototype.createDom=function(t,n){this.constants_.createDom(t,this.name+"-"+n.name,"."+this.getClassName()+"."+n.getClassName())},e.blockRendering.Renderer.prototype.refreshDom=function(t,n){var o=this.getConstants();o.dispose(),this.constants_=this.makeConstants_(),this.overrides&&e.utils.object.mixin(this.constants_,this.overrides),this.constants_.randomIdentifier=o.randomIdentifier,this.constants_.setTheme(n),this.constants_.init(),this.createDom(t,n)},e.blockRendering.Renderer.prototype.dispose=function(){this.constants_&&this.constants_.dispose()},e.blockRendering.Renderer.prototype.makeConstants_=function(){return new e.blockRendering.ConstantProvider},e.blockRendering.Renderer.prototype.makeRenderInfo_=function(t){return new e.blockRendering.RenderInfo(this,t)},e.blockRendering.Renderer.prototype.makeDrawer_=function(t,n){return new e.blockRendering.Drawer(t,n)},e.blockRendering.Renderer.prototype.makeDebugger_=function(){if(!e.blockRendering.Debug)throw Error("Missing require for Blockly.blockRendering.Debug");return new e.blockRendering.Debug(this.getConstants())},e.blockRendering.Renderer.prototype.makeMarkerDrawer=function(t,n){return new e.blockRendering.MarkerSvg(t,this.getConstants(),n)},e.blockRendering.Renderer.prototype.makePathObject=function(t,n){return new e.blockRendering.PathObject(t,n,this.constants_)},e.blockRendering.Renderer.prototype.getConstants=function(){return this.constants_},e.blockRendering.Renderer.prototype.shouldHighlightConnection=function(t){return!0},e.blockRendering.Renderer.prototype.orphanCanConnectAtEnd=function(t,n,o){return!!e.Connection.getConnectionForOrphanedConnection(t,o===e.connectionTypes.OUTPUT_VALUE?n.outputConnection:n.previousConnection)},e.blockRendering.Renderer.prototype.getConnectionPreviewMethod=function(t,n,o){return n.type==e.connectionTypes.OUTPUT_VALUE||n.type==e.connectionTypes.PREVIOUS_STATEMENT?!t.isConnected()||this.orphanCanConnectAtEnd(o,t.targetBlock(),n.type)?e.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:e.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:e.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER},e.blockRendering.Renderer.prototype.render=function(t){e.blockRendering.useDebugger&&!t.renderingDebugger&&(t.renderingDebugger=this.makeDebugger_());var n=this.makeRenderInfo_(t);n.measure(),this.makeDrawer_(t,n).draw()},e.geras={},e.geras.ConstantProvider=function(){e.geras.ConstantProvider.superClass_.constructor.call(this),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2},e.utils.object.inherits(e.geras.ConstantProvider,e.blockRendering.ConstantProvider),e.geras.ConstantProvider.prototype.getCSS_=function(t){return e.geras.ConstantProvider.superClass_.getCSS_.call(this,t).concat([t+" .blocklyInsertionMarker>.blocklyPathLight,",t+" .blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"])},e.geras.Highlighter=function(t){this.info_=t,this.inlineSteps_=this.steps_="",this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH},e.geras.Highlighter.prototype.getPath=function(){return this.steps_+"\n"+this.inlineSteps_},e.geras.Highlighter.prototype.drawTopCorner=function(t){this.steps_+=e.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var o,n=0;o=t.elements[n];n++)e.blockRendering.Types.isLeftSquareCorner(o)?this.steps_+=this.highlightConstants_.START_POINT:e.blockRendering.Types.isLeftRoundedCorner(o)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):e.blockRendering.Types.isPreviousConnection(o)?this.steps_+=this.notchPaths_.pathLeft:e.blockRendering.Types.isHat(o)?this.steps_+=this.startPaths_.path(this.RTL_):e.blockRendering.Types.isSpacer(o)&&0!=o.width&&(this.steps_+=e.utils.svgPaths.lineOnAxis("H",o.xPos+o.width-this.highlightOffset_));this.steps_+=e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width-this.highlightOffset_)},e.geras.Highlighter.prototype.drawJaggedEdge_=function(t){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+e.utils.svgPaths.lineOnAxis("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset_))},e.geras.Highlighter.prototype.drawValueInput=function(t){var n=t.getLastInput();if(this.RTL_){var o=t.height-n.connectionHeight;this.steps_+=e.utils.svgPaths.moveTo(n.xPos+n.width-this.highlightOffset_,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+e.utils.svgPaths.lineOnAxis("v",o)}else this.steps_+=e.utils.svgPaths.moveTo(n.xPos+n.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)},e.geras.Highlighter.prototype.drawStatementInput=function(t){var n=t.getLastInput();if(this.RTL_){var o=t.height-2*this.insideCornerPaths_.height;this.steps_+=e.utils.svgPaths.moveTo(n.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+e.utils.svgPaths.lineOnAxis("v",o)+this.insideCornerPaths_.pathBottom(this.RTL_)+e.utils.svgPaths.lineTo(t.width-n.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=e.utils.svgPaths.moveTo(n.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+e.utils.svgPaths.lineTo(t.width-n.xPos-this.insideCornerPaths_.width,0)},e.geras.Highlighter.prototype.drawRightSideRow=function(t){var n=t.xPos+t.width-this.highlightOffset_;t.followsStatement&&(this.steps_+=e.utils.svgPaths.lineOnAxis("H",n)),this.RTL_&&(this.steps_+=e.utils.svgPaths.lineOnAxis("H",n),t.height>this.highlightOffset_&&(this.steps_+=e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height-this.highlightOffset_)))},e.geras.Highlighter.prototype.drawBottomRow=function(t){if(this.RTL_)this.steps_+=e.utils.svgPaths.lineOnAxis("V",t.baseline-this.highlightOffset_);else{var n=this.info_.bottomRow.elements[0];e.blockRendering.Types.isLeftSquareCorner(n)?this.steps_+=e.utils.svgPaths.moveTo(t.xPos+this.highlightOffset_,t.baseline-this.highlightOffset_):e.blockRendering.Types.isLeftRoundedCorner(n)&&(this.steps_+=e.utils.svgPaths.moveTo(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}},e.geras.Highlighter.prototype.drawLeft=function(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=e.utils.svgPaths.moveTo(this.info_.startX,t):(this.steps_+=e.utils.svgPaths.moveTo(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=e.utils.svgPaths.lineOnAxis("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e.blockRendering.Types.isLeftRoundedCorner((t=this.info_.topRow).elements[0])?this.steps_+=e.utils.svgPaths.lineOnAxis("V",this.outsideCornerPaths_.height):this.steps_+=e.utils.svgPaths.lineOnAxis("V",t.capline+this.highlightOffset_))},e.geras.Highlighter.prototype.drawInlineInput=function(t){var n=this.highlightOffset_,o=t.xPos+t.connectionWidth,r=t.centerline-t.height/2,a=t.width-t.connectionWidth,h=r+n;this.RTL_?(r=t.connectionOffsetY-n,t=t.height-(t.connectionOffsetY+t.connectionHeight)+n,this.inlineSteps_+=e.utils.svgPaths.moveTo(o-n,h)+e.utils.svgPaths.lineOnAxis("v",r)+this.puzzleTabPaths_.pathDown(this.RTL_)+e.utils.svgPaths.lineOnAxis("v",t)+e.utils.svgPaths.lineOnAxis("h",a)):this.inlineSteps_+=e.utils.svgPaths.moveTo(t.xPos+t.width+n,h)+e.utils.svgPaths.lineOnAxis("v",t.height)+e.utils.svgPaths.lineOnAxis("h",-a)+e.utils.svgPaths.moveTo(o,r+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)},e.geras.InlineInput=function(t,n){e.geras.InlineInput.superClass_.constructor.call(this,t,n),this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)},e.utils.object.inherits(e.geras.InlineInput,e.blockRendering.InlineInput),e.geras.StatementInput=function(t,n){e.geras.StatementInput.superClass_.constructor.call(this,t,n),this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)},e.utils.object.inherits(e.geras.StatementInput,e.blockRendering.StatementInput),e.geras.RenderInfo=function(t,n){e.geras.RenderInfo.superClass_.constructor.call(this,t,n)},e.utils.object.inherits(e.geras.RenderInfo,e.blockRendering.RenderInfo),e.geras.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.geras.RenderInfo.prototype.populateBottomRow_=function(){e.geras.RenderInfo.superClass_.populateBottomRow_.call(this),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==e.inputTypes.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)},e.geras.RenderInfo.prototype.addInput_=function(t,n){this.isInline&&t.type==e.inputTypes.VALUE?(n.elements.push(new e.geras.InlineInput(this.constants_,t)),n.hasInlineInput=!0):t.type==e.inputTypes.STATEMENT?(n.elements.push(new e.geras.StatementInput(this.constants_,t)),n.hasStatement=!0):t.type==e.inputTypes.VALUE?(n.elements.push(new e.blockRendering.ExternalValueInput(this.constants_,t)),n.hasExternalInput=!0):t.type==e.inputTypes.DUMMY&&(n.minHeight=Math.max(n.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),n.hasDummyInput=!0),this.isInline||null!=n.align||(n.align=t.align)},e.geras.RenderInfo.prototype.addElemSpacing_=function(){for(var o,t=!1,n=0;o=this.rows[n];n++)o.hasExternalInput&&(t=!0);for(n=0;o=this.rows[n];n++){var r=o.elements;if(o.elements=[],o.startsWithElemSpacer()&&o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(var a=0;a<r.length-1;a++){o.elements.push(r[a]);var h=this.getInRowSpacing_(r[a],r[a+1]);o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h))}o.elements.push(r[r.length-1]),o.endsWithElemSpacer()&&(h=this.getInRowSpacing_(r[r.length-1],null),t&&o.hasDummyInput&&(h+=this.constants_.TAB_WIDTH),o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h)))}}},e.geras.RenderInfo.prototype.getInRowSpacing_=function(t,n){if(!t)return n&&e.blockRendering.Types.isField(n)&&n.isEditable?this.constants_.MEDIUM_PADDING:n&&e.blockRendering.Types.isInlineInput(n)?this.constants_.MEDIUM_LARGE_PADDING:n&&e.blockRendering.Types.isStatementInput(n)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!e.blockRendering.Types.isInput(t)&&(!n||e.blockRendering.Types.isStatementInput(n)))return e.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:e.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:e.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:e.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:e.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:e.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInput(t)&&!n){if(e.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!e.blockRendering.Types.isInput(t)&&n&&e.blockRendering.Types.isInput(n)){if(e.blockRendering.Types.isField(t)&&t.isEditable){if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.SMALL_PADDING}else{if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.MEDIUM_LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(n))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(e.blockRendering.Types.isIcon(t)&&n&&!e.blockRendering.Types.isInput(n))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInlineInput(t)&&n&&e.blockRendering.Types.isField(n))return n.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isLeftSquareCorner(t)&&n){if(e.blockRendering.Types.isHat(n))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isPreviousConnection(n))return n.notchOffset;if(e.blockRendering.Types.isNextConnection(n))return n.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(e.blockRendering.Types.isLeftRoundedCorner(t)&&n){if(e.blockRendering.Types.isPreviousConnection(n))return n.notchOffset-this.constants_.CORNER_RADIUS;if(e.blockRendering.Types.isNextConnection(n))return n.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return e.blockRendering.Types.isField(t)&&n&&e.blockRendering.Types.isField(n)&&t.isEditable==n.isEditable||n&&e.blockRendering.Types.isJaggedEdge(n)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.geras.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){return e.blockRendering.Types.isTopRow(t)&&e.blockRendering.Types.isBottomRow(n)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:e.blockRendering.Types.isTopRow(t)||e.blockRendering.Types.isBottomRow(n)?this.constants_.NO_PADDING:t.hasExternalInput&&n.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&n.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&n.hasStatement||!t.hasStatement&&n.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.geras.RenderInfo.prototype.getElemCenterline_=function(t,n){if(e.blockRendering.Types.isSpacer(n))return t.yPos+n.height/2;if(e.blockRendering.Types.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,e.blockRendering.Types.isNextConnection(n)?t+n.height/2:t-n.height/2;if(e.blockRendering.Types.isTopRow(t))return e.blockRendering.Types.isHat(n)?t.capline-n.height/2:t.capline+n.height/2;var o=t.yPos;return e.blockRendering.Types.isField(n)||e.blockRendering.Types.isIcon(n)?(o+=n.height/2,(t.hasInlineInput||t.hasStatement)&&n.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(o+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):o=e.blockRendering.Types.isInlineInput(n)?o+n.height/2:o+t.height/2,o},e.geras.RenderInfo.prototype.alignRowElements_=function(){if(this.isInline){for(var r,t=0,n=null,o=this.rows.length-1;r=this.rows[o];o--)r.nextRightEdge=t,e.blockRendering.Types.isInputRow(r)&&(r.hasStatement&&this.alignStatementRow_(r),n&&n.hasStatement&&r.width<n.width?r.nextRightEdge=n.width:t=r.width,n=r);for(o=t=0;r=this.rows[o];o++)r.hasStatement?t=this.getDesiredRowWidth_(r):e.blockRendering.Types.isSpacer(r)?r.width=Math.max(t,r.nextRightEdge):(0<(t=Math.max(t,r.nextRightEdge)-r.width)&&this.addAlignmentPadding_(r,t),t=r.width)}else e.geras.RenderInfo.superClass_.alignRowElements_.call(this)},e.geras.RenderInfo.prototype.getDesiredRowWidth_=function(t){return this.isInline&&t.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:e.geras.RenderInfo.superClass_.getDesiredRowWidth_.call(this,t)},e.geras.RenderInfo.prototype.finalize_=function(){for(var r,t=0,n=0,o=0;r=this.rows[o];o++){r.yPos=n,r.xPos=this.startX,n+=r.height,t=Math.max(t,r.widthWithConnectedBlocks);var a=n-this.topRow.ascenderHeight;r==this.bottomRow&&a<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=a=this.constants_.MIN_BLOCK_HEIGHT-a,n+=a),this.recordElemPositions_(r)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(t=Math.max(t,this.block_.nextConnection.targetBlock().getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=n-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=n+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline},e.geras.Drawer=function(t,n){e.geras.Drawer.superClass_.constructor.call(this,t,n),this.highlighter_=new e.geras.Highlighter(n)},e.utils.object.inherits(e.geras.Drawer,e.blockRendering.Drawer),e.geras.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();var t=this.block_.pathObject;t.setPath(this.outlinePath_+"\n"+this.inlinePath_),t.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&t.flipRTL(),e.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},e.geras.Drawer.prototype.drawTop_=function(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),e.geras.Drawer.superClass_.drawTop_.call(this)},e.geras.Drawer.prototype.drawJaggedEdge_=function(t){this.highlighter_.drawJaggedEdge_(t),e.geras.Drawer.superClass_.drawJaggedEdge_.call(this,t)},e.geras.Drawer.prototype.drawValueInput_=function(t){this.highlighter_.drawValueInput(t),e.geras.Drawer.superClass_.drawValueInput_.call(this,t)},e.geras.Drawer.prototype.drawStatementInput_=function(t){this.highlighter_.drawStatementInput(t),e.geras.Drawer.superClass_.drawStatementInput_.call(this,t)},e.geras.Drawer.prototype.drawRightSideRow_=function(t){this.highlighter_.drawRightSideRow(t),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width)+e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},e.geras.Drawer.prototype.drawBottom_=function(){this.highlighter_.drawBottomRow(this.info_.bottomRow),e.geras.Drawer.superClass_.drawBottom_.call(this)},e.geras.Drawer.prototype.drawLeft_=function(){this.highlighter_.drawLeft(),e.geras.Drawer.superClass_.drawLeft_.call(this)},e.geras.Drawer.prototype.drawInlineInput_=function(t){this.highlighter_.drawInlineInput(t),e.geras.Drawer.superClass_.drawInlineInput_.call(this,t)},e.geras.Drawer.prototype.positionInlineInputConnection_=function(t){if(t.connectionModel){var o=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(o*=-1),t.connectionModel.setOffsetInBlock(o,t.centerline-t.height/2+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}},e.geras.Drawer.prototype.positionStatementInputConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.statementEdge+n.notchOffset;n.connectionModel.setOffsetInBlock(o=this.info_.RTL?-1*o:o+this.constants_.DARK_PATH_OFFSET,t.yPos+this.constants_.DARK_PATH_OFFSET)}},e.geras.Drawer.prototype.positionExternalValueConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(o*=-1),n.connectionModel.setOffsetInBlock(o,t.yPos)}},e.geras.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var n=t.connection,o=n.xPos;n.connectionModel.setOffsetInBlock((this.info_.RTL?-o:o)+this.constants_.DARK_PATH_OFFSET/2,t.baseline+this.constants_.DARK_PATH_OFFSET)}},e.geras.HighlightConstantProvider=function(t){this.constantProvider=t,this.OFFSET=.5,this.START_POINT=e.utils.svgPaths.moveBy(this.OFFSET,this.OFFSET)},e.geras.HighlightConstantProvider.prototype.init=function(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()},e.geras.HighlightConstantProvider.prototype.makeInsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,n=this.OFFSET,o=(1-Math.SQRT1_2)*(t+n)-n,r=e.utils.svgPaths.moveBy(o,o)+e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(-o-n,t-o)),a=e.utils.svgPaths.arc("a","0 0,0",t+n,e.utils.svgPaths.point(t+n,t+n)),h=e.utils.svgPaths.moveBy(o,-o)+e.utils.svgPaths.arc("a","0 0,0",t+n,e.utils.svgPaths.point(t-o,o+n));return{width:t+n,height:t,pathTop:function(R){return R?r:""},pathBottom:function(R){return R?a:h}}},e.geras.HighlightConstantProvider.prototype.makeOutsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,n=this.OFFSET,o=(1-Math.SQRT1_2)*(t-n)+n,r=e.utils.svgPaths.moveBy(o,o)+e.utils.svgPaths.arc("a","0 0,1",t-n,e.utils.svgPaths.point(t-o,-o+n)),a=e.utils.svgPaths.moveBy(n,t)+e.utils.svgPaths.arc("a","0 0,1",t-n,e.utils.svgPaths.point(t,-t+n)),h=-o,R=e.utils.svgPaths.moveBy(o,h)+e.utils.svgPaths.arc("a","0 0,1",t-n,e.utils.svgPaths.point(-o+n,-h-t));return{height:t,topLeft:function(L){return L?r:a},bottomLeft:function(){return R}}},e.geras.HighlightConstantProvider.prototype.makePuzzleTab=function(){var t=this.constantProvider.TAB_WIDTH,n=this.constantProvider.TAB_HEIGHT,o=e.utils.svgPaths.moveBy(-2,3.4-n)+e.utils.svgPaths.lineTo(-.45*t,-2.1),r=e.utils.svgPaths.lineOnAxis("v",2.5)+e.utils.svgPaths.moveBy(.97*-t,2.5)+e.utils.svgPaths.curve("q",[e.utils.svgPaths.point(.05*-t,10),e.utils.svgPaths.point(.3*t,9.5)])+e.utils.svgPaths.moveBy(.67*t,-1.9)+e.utils.svgPaths.lineOnAxis("v",2.5),a=e.utils.svgPaths.lineOnAxis("v",-1.5)+e.utils.svgPaths.moveBy(-.92*t,-.5)+e.utils.svgPaths.curve("q",[e.utils.svgPaths.point(-.19*t,-5.5),e.utils.svgPaths.point(0,-11)])+e.utils.svgPaths.moveBy(.92*t,1),h=e.utils.svgPaths.moveBy(-5,n-.7)+e.utils.svgPaths.lineTo(.46*t,-2.1);return{width:t,height:n,pathUp:function(R){return R?o:a},pathDown:function(R){return R?r:h}}},e.geras.HighlightConstantProvider.prototype.makeNotch=function(){return{pathLeft:e.utils.svgPaths.lineOnAxis("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}},e.geras.HighlightConstantProvider.prototype.makeJaggedTeeth=function(){return{pathLeft:e.utils.svgPaths.lineTo(5.1,2.6)+e.utils.svgPaths.moveBy(-10.2,6.8)+e.utils.svgPaths.lineTo(5.1,2.6),height:12,width:10.2}},e.geras.HighlightConstantProvider.prototype.makeStartHat=function(){var t=this.constantProvider.START_HAT.height,n=e.utils.svgPaths.moveBy(25,-8.7)+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(29.7,-6.2),e.utils.svgPaths.point(57.2,-.5),e.utils.svgPaths.point(75,8.7)]),o=e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(17.8,-9.2),e.utils.svgPaths.point(45.3,-14.9),e.utils.svgPaths.point(75,-8.7)])+e.utils.svgPaths.moveTo(100.5,t+.5);return{path:function(r){return r?n:o}}},e.geras.PathObject=function(t,n,o){this.constants=o,this.svgRoot=t,this.svgPathDark=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgRoot),this.svgPath=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.svgPathLight=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPathLight"},this.svgRoot),this.colourDark="#000000",this.style=n},e.utils.object.inherits(e.geras.PathObject,e.blockRendering.PathObject),e.geras.PathObject.prototype.setPath=function(t){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t)},e.geras.PathObject.prototype.setHighlightPath=function(t){this.svgPathLight.setAttribute("d",t)},e.geras.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")},e.geras.PathObject.prototype.applyColour=function(t){this.svgPathLight.style.display="",this.svgPathDark.style.display="",this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),e.geras.PathObject.superClass_.applyColour.call(this,t),this.svgPath.setAttribute("stroke","none")},e.geras.PathObject.prototype.setStyle=function(t){this.style=t,this.colourDark=e.utils.colour.blend("#000",this.style.colourPrimary,.2)||this.colourDark},e.geras.PathObject.prototype.updateHighlighted=function(t){t?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")},e.geras.PathObject.prototype.updateShadow_=function(t){t&&(this.svgPathLight.style.display="none",this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},e.geras.PathObject.prototype.updateDisabled_=function(t){e.geras.PathObject.superClass_.updateDisabled_.call(this,t),t&&this.svgPath.setAttribute("stroke","none")},e.geras.Renderer=function(t){e.geras.Renderer.superClass_.constructor.call(this,t),this.highlightConstants_=null},e.utils.object.inherits(e.geras.Renderer,e.blockRendering.Renderer),e.geras.Renderer.prototype.init=function(t,n){e.geras.Renderer.superClass_.init.call(this,t,n),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()},e.geras.Renderer.prototype.refreshDom=function(t,n){e.geras.Renderer.superClass_.refreshDom.call(this,t,n),this.getHighlightConstants().init()},e.geras.Renderer.prototype.makeConstants_=function(){return new e.geras.ConstantProvider},e.geras.Renderer.prototype.makeRenderInfo_=function(t){return new e.geras.RenderInfo(this,t)},e.geras.Renderer.prototype.makeDrawer_=function(t,n){return new e.geras.Drawer(t,n)},e.geras.Renderer.prototype.makePathObject=function(t,n){return new e.geras.PathObject(t,n,this.getConstants())},e.geras.Renderer.prototype.makeHighlightConstants_=function(){return new e.geras.HighlightConstantProvider(this.getConstants())},e.geras.Renderer.prototype.getHighlightConstants=function(){return this.highlightConstants_},e.blockRendering.register("geras",e.geras.Renderer),e.thrasos={},e.thrasos.RenderInfo=function(t,n){e.thrasos.RenderInfo.superClass_.constructor.call(this,t,n)},e.utils.object.inherits(e.thrasos.RenderInfo,e.blockRendering.RenderInfo),e.thrasos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.thrasos.RenderInfo.prototype.addElemSpacing_=function(){for(var o,t=!1,n=0;o=this.rows[n];n++)o.hasExternalInput&&(t=!0);for(n=0;o=this.rows[n];n++){var r=o.elements;o.elements=[],o.startsWithElemSpacer()&&o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,r[0])));for(var a=0;a<r.length-1;a++){o.elements.push(r[a]);var h=this.getInRowSpacing_(r[a],r[a+1]);o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h))}o.elements.push(r[r.length-1]),o.endsWithElemSpacer()&&(h=this.getInRowSpacing_(r[r.length-1],null),t&&o.hasDummyInput&&(h+=this.constants_.TAB_WIDTH),o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h)))}},e.thrasos.RenderInfo.prototype.getInRowSpacing_=function(t,n){if(!t)return n&&e.blockRendering.Types.isField(n)&&n.isEditable?this.constants_.MEDIUM_PADDING:n&&e.blockRendering.Types.isInlineInput(n)?this.constants_.MEDIUM_LARGE_PADDING:n&&e.blockRendering.Types.isStatementInput(n)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!e.blockRendering.Types.isInput(t)&&!n)return e.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:e.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:e.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:e.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:e.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:e.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInput(t)&&!n){if(e.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!e.blockRendering.Types.isInput(t)&&n&&e.blockRendering.Types.isInput(n)){if(e.blockRendering.Types.isField(t)&&t.isEditable){if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.SMALL_PADDING}else{if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.MEDIUM_LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(n))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(e.blockRendering.Types.isIcon(t)&&n&&!e.blockRendering.Types.isInput(n))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInlineInput(t)&&n&&e.blockRendering.Types.isField(n))return n.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isLeftSquareCorner(t)&&n){if(e.blockRendering.Types.isHat(n))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))return n.notchOffset}return e.blockRendering.Types.isLeftRoundedCorner(t)&&n?n.notchOffset-this.constants_.CORNER_RADIUS:e.blockRendering.Types.isField(t)&&n&&e.blockRendering.Types.isField(n)&&t.isEditable==n.isEditable||n&&e.blockRendering.Types.isJaggedEdge(n)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.thrasos.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){return e.blockRendering.Types.isTopRow(t)&&e.blockRendering.Types.isBottomRow(n)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:e.blockRendering.Types.isTopRow(t)||e.blockRendering.Types.isBottomRow(n)?this.constants_.NO_PADDING:t.hasExternalInput&&n.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&n.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&n.hasStatement||t.hasDummyInput||n.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.thrasos.RenderInfo.prototype.getElemCenterline_=function(t,n){if(e.blockRendering.Types.isSpacer(n))return t.yPos+n.height/2;if(e.blockRendering.Types.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,e.blockRendering.Types.isNextConnection(n)?t+n.height/2:t-n.height/2;if(e.blockRendering.Types.isTopRow(t))return e.blockRendering.Types.isHat(n)?t.capline-n.height/2:t.capline+n.height/2;var o=t.yPos;return e.blockRendering.Types.isField(n)&&t.hasStatement?o+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+n.height/2):o+t.height/2},e.thrasos.RenderInfo.prototype.finalize_=function(){for(var r,t=0,n=0,o=0;r=this.rows[o];o++){r.yPos=n,r.xPos=this.startX,n+=r.height,t=Math.max(t,r.widthWithConnectedBlocks);var a=n-this.topRow.ascenderHeight;r==this.bottomRow&&a<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=a=this.constants_.MIN_BLOCK_HEIGHT-a,n+=a),this.recordElemPositions_(r)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(t=Math.max(t,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.bottomRow.baseline=n-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX,this.height=n,this.startY=this.topRow.capline},e.thrasos.Renderer=function(t){e.thrasos.Renderer.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.thrasos.Renderer,e.blockRendering.Renderer),e.thrasos.Renderer.prototype.makeRenderInfo_=function(t){return new e.thrasos.RenderInfo(this,t)},e.blockRendering.register("thrasos",e.thrasos.Renderer),e.zelos={},e.zelos.ConstantProvider=function(){e.zelos.ConstantProvider.superClass_.constructor.call(this),this.SMALL_PADDING=this.GRID_UNIT=4,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TAB_OFFSET_FROM_TOP=0,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!0,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.replacementGlowFilter_=null},e.utils.object.inherits(e.zelos.ConstantProvider,e.blockRendering.ConstantProvider),e.zelos.ConstantProvider.prototype.setFontConstants_=function(t){e.zelos.ConstantProvider.superClass_.setFontConstants_.call(this,t),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING},e.zelos.ConstantProvider.prototype.init=function(){e.zelos.ConstantProvider.superClass_.init.call(this),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth},e.zelos.ConstantProvider.prototype.setDynamicProperties_=function(t){e.zelos.ConstantProvider.superClass_.setDynamicProperties_.call(this,t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var n=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=n&&!isNaN(n)?n:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(t=Number(t.getComponentStyle("replacementGlowSize")))&&!isNaN(t)?t:this.REPLACEMENT_GLOW_SIZE},e.zelos.ConstantProvider.prototype.dispose=function(){e.zelos.ConstantProvider.superClass_.dispose.call(this),this.selectedGlowFilter_&&e.utils.dom.removeNode(this.selectedGlowFilter_),this.replacementGlowFilter_&&e.utils.dom.removeNode(this.replacementGlowFilter_)},e.zelos.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,n=this.START_HAT_WIDTH;return{height:t,width:n,path:e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(25,-t),e.utils.svgPaths.point(71,-t),e.utils.svgPaths.point(n,0)])}},e.zelos.ConstantProvider.prototype.makeHexagonal=function(){function t(o,r,a){var h=o/2;return e.utils.svgPaths.lineTo(-(a=a?-1:1)*(h=h>n?n:h),o=(r?-1:1)*o/2)+e.utils.svgPaths.lineTo(a*h,o)}var n=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:function(o){return(o/=2)>n?n:o},height:function(o){return o},connectionOffsetY:function(o){return o/2},connectionOffsetX:function(o){return-o},pathDown:function(o){return t(o,!1,!1)},pathUp:function(o){return t(o,!0,!1)},pathRightDown:function(o){return t(o,!1,!0)},pathRightUp:function(o){return t(o,!1,!0)}}},e.zelos.ConstantProvider.prototype.makeRounded=function(){function t(r,a,h){var R=r>o?r-o:0;return e.utils.svgPaths.arc("a","0 0,1",r=(r>o?o:r)/2,e.utils.svgPaths.point((a?-1:1)*r,(a?-1:1)*r))+e.utils.svgPaths.lineOnAxis("v",(h?1:-1)*R)+e.utils.svgPaths.arc("a","0 0,1",r,e.utils.svgPaths.point((a?1:-1)*r,(a?-1:1)*r))}var n=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,o=2*n;return{type:this.SHAPES.ROUND,isDynamic:!0,width:function(r){return(r/=2)>n?n:r},height:function(r){return r},connectionOffsetY:function(r){return r/2},connectionOffsetX:function(r){return-r},pathDown:function(r){return t(r,!1,!1)},pathUp:function(r){return t(r,!0,!1)},pathRightDown:function(r){return t(r,!1,!0)},pathRightUp:function(r){return t(r,!1,!0)}}},e.zelos.ConstantProvider.prototype.makeSquared=function(){function t(o,r,a){return o-=2*n,e.utils.svgPaths.arc("a","0 0,1",n,e.utils.svgPaths.point((r?-1:1)*n,(r?-1:1)*n))+e.utils.svgPaths.lineOnAxis("v",(a?1:-1)*o)+e.utils.svgPaths.arc("a","0 0,1",n,e.utils.svgPaths.point((r?1:-1)*n,(r?-1:1)*n))}var n=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:function(o){return n},height:function(o){return o},connectionOffsetY:function(o){return o/2},connectionOffsetX:function(o){return-o},pathDown:function(o){return t(o,!1,!1)},pathUp:function(o){return t(o,!0,!1)},pathRightDown:function(o){return t(o,!1,!0)},pathRightUp:function(o){return t(o,!1,!0)}}},e.zelos.ConstantProvider.prototype.shapeFor=function(t){var n=t.getCheck();switch(!n&&t.targetConnection&&(n=t.targetConnection.getCheck()),t.type){case e.connectionTypes.INPUT_VALUE:case e.connectionTypes.OUTPUT_VALUE:if(null!=(t=t.getSourceBlock().getOutputShape()))switch(t){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return n&&-1!=n.indexOf("Boolean")?this.HEXAGONAL:(n&&-1!=n.indexOf("Number")||n&&n.indexOf("String"),this.ROUNDED);case e.connectionTypes.PREVIOUS_STATEMENT:case e.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}},e.zelos.ConstantProvider.prototype.makeNotch=function(){function t(nt){return e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/2,0),e.utils.svgPaths.point(nt*a*3/4,R/2),e.utils.svgPaths.point(nt*a,R)])+e.utils.svgPaths.line([e.utils.svgPaths.point(nt*a,h)])+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/4,R/2),e.utils.svgPaths.point(nt*a/2,R),e.utils.svgPaths.point(nt*a,R)])+e.utils.svgPaths.lineOnAxis("h",nt*r)+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/2,0),e.utils.svgPaths.point(nt*a*3/4,-R/2),e.utils.svgPaths.point(nt*a,-R)])+e.utils.svgPaths.line([e.utils.svgPaths.point(nt*a,-h)])+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/4,-R/2),e.utils.svgPaths.point(nt*a/2,-R),e.utils.svgPaths.point(nt*a,-R)])}var n=this.NOTCH_WIDTH,o=this.NOTCH_HEIGHT,r=n/3,a=r/3,h=o/2,R=h/2,L=t(1),W=t(-1);return{type:this.SHAPES.NOTCH,width:n,height:o,pathLeft:L,pathRight:W}},e.zelos.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS,n=e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(-t,t)),o=e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(-t,t));return{width:t,height:t,pathTop:n,pathBottom:e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(t,t)),rightWidth:t,rightHeight:t,pathTopRight:o,pathBottomRight:e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(t,t))}},e.zelos.ConstantProvider.prototype.generateSecondaryColour_=function(t){return e.utils.colour.blend("#000",t,.15)||t},e.zelos.ConstantProvider.prototype.generateTertiaryColour_=function(t){return e.utils.colour.blend("#000",t,.25)||t},e.zelos.ConstantProvider.prototype.createDom=function(t,n,o){e.zelos.ConstantProvider.superClass_.createDom.call(this,t,n,o),t=e.utils.dom.createSvgElement(e.utils.Svg.DEFS,{},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},n),o=e.utils.dom.createSvgElement(e.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},o),e.utils.dom.createSvgElement(e.utils.Svg.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},n),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},n),this.selectedGlowFilterId=n.id,this.selectedGlowFilter_=n,t=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},t),this.replacementGlowFilterId=t.id,this.replacementGlowFilter_=t},e.zelos.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText,",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect:not(.blocklyDropdownRect),",t+" .blocklyEditableText>rect:not(.blocklyDropdownRect) {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text,",t+" .blocklyNonEditableText>g>text,",t+" .blocklyEditableText>g>text {","fill: #575E75;","}",t+" .blocklyFlyoutLabelText {","fill: #575E75;","}",t+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>rect,",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","color: #575E75;","}",t+" .blocklyDropdownText {","fill: #fff !important;","}",t+".blocklyWidgetDiv .goog-menuitem,",t+".blocklyDropDownDiv .goog-menuitem {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","}",t+".blocklyDropDownDiv .goog-menuitem-content {","color: #fff;","}",t+" .blocklyHighlightedConnectionPath {","stroke: "+this.SELECTED_GLOW_COLOUR+";","}",t+" .blocklyDisabled > .blocklyOutlinePath {","fill: url(#blocklyDisabledPattern"+this.randomIdentifier+")","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},e.zelos.TopRow=function(t){e.zelos.TopRow.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.zelos.TopRow,e.blockRendering.TopRow),e.zelos.TopRow.prototype.endsWithElemSpacer=function(){return!1},e.zelos.TopRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection||(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection},e.zelos.TopRow.prototype.hasRightSquareCorner=function(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection},e.zelos.BottomRow=function(t){e.zelos.BottomRow.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.zelos.BottomRow,e.blockRendering.BottomRow),e.zelos.BottomRow.prototype.endsWithElemSpacer=function(){return!1},e.zelos.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection},e.zelos.BottomRow.prototype.hasRightSquareCorner=function(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection},e.zelos.RightConnectionShape=function(t){e.zelos.RightConnectionShape.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.getType("RIGHT_CONNECTION"),this.width=this.height=0},e.utils.object.inherits(e.zelos.RightConnectionShape,e.blockRendering.Measurable),e.zelos.RenderInfo=function(t,n){e.zelos.RenderInfo.superClass_.constructor.call(this,t,n),this.topRow=new e.zelos.TopRow(this.constants_),this.bottomRow=new e.zelos.BottomRow(this.constants_),this.isInline=!0,this.isMultiRow=!n.getInputsInline()||n.isCollapsed(),this.hasStatementInput=0<n.statementInputCount,this.rightSide=this.outputConnection?new e.zelos.RightConnectionShape(this.constants_):null},e.utils.object.inherits(e.zelos.RenderInfo,e.blockRendering.RenderInfo),e.zelos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.zelos.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},e.zelos.RenderInfo.prototype.shouldStartNewRow_=function(t,n){return!!n&&(t.type==e.inputTypes.STATEMENT||n.type==e.inputTypes.STATEMENT||(t.type==e.inputTypes.VALUE||t.type==e.inputTypes.DUMMY)&&(!this.isInline||this.isMultiRow))},e.zelos.RenderInfo.prototype.getDesiredRowWidth_=function(t){return t.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):e.zelos.RenderInfo.superClass_.getDesiredRowWidth_.call(this,t)},e.zelos.RenderInfo.prototype.getInRowSpacing_=function(t,n){return t&&n||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!t&&n&&e.blockRendering.Types.isStatementInput(n)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:t&&e.blockRendering.Types.isLeftRoundedCorner(t)&&n&&(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))?n.notchOffset-this.constants_.CORNER_RADIUS:t&&e.blockRendering.Types.isLeftSquareCorner(t)&&n&&e.blockRendering.Types.isHat(n)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING},e.zelos.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){if(e.blockRendering.Types.isTopRow(t)&&e.blockRendering.Types.isBottomRow(n))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;var o=e.blockRendering.Types.isInputRow(t)&&t.hasStatement,r=e.blockRendering.Types.isInputRow(n)&&n.hasStatement;return r||o?(t=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),r&&o?Math.max(t,this.constants_.DUMMY_INPUT_MIN_HEIGHT):t):e.blockRendering.Types.isTopRow(t)?t.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):e.blockRendering.Types.isBottomRow(n)?this.outputConnection?!n.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},e.zelos.RenderInfo.prototype.getSpacerRowWidth_=function(t,n){var o=this.width-this.startX;return e.blockRendering.Types.isInputRow(t)&&t.hasStatement||e.blockRendering.Types.isInputRow(n)&&n.hasStatement?Math.max(o,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):o},e.zelos.RenderInfo.prototype.getElemCenterline_=function(t,n){if(t.hasStatement&&!e.blockRendering.Types.isSpacer(n)&&!e.blockRendering.Types.isStatementInput(n))return t.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(e.blockRendering.Types.isInlineInput(n)){var o=n.connectedBlock;if(o&&o.outputConnection&&o.nextConnection)return t.yPos+o.height/2}return e.zelos.RenderInfo.superClass_.getElemCenterline_.call(this,t,n)},e.zelos.RenderInfo.prototype.addInput_=function(t,n){t.type==e.inputTypes.DUMMY&&n.hasDummyInput&&n.align==e.constants.ALIGN.LEFT&&t.align==e.constants.ALIGN.RIGHT&&(n.rightAlignedDummyInput=t),e.zelos.RenderInfo.superClass_.addInput_.call(this,t,n)},e.zelos.RenderInfo.prototype.addAlignmentPadding_=function(t,n){if(t.rightAlignedDummyInput){for(var o,a,r=0;(a=t.elements[r])&&(e.blockRendering.Types.isSpacer(a)&&(o=a),!e.blockRendering.Types.isField(a)||a.parentInput!=t.rightAlignedDummyInput);r++);if(o)return o.width+=n,void(t.width+=n)}e.zelos.RenderInfo.superClass_.addAlignmentPadding_.call(this,t,n)},e.zelos.RenderInfo.prototype.adjustXPosition_=function(){for(var t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH,n=t,o=2;o<this.rows.length-1;o+=2){var r=this.rows[o-1],a=this.rows[o],h=this.rows[o+1];if(r=2==o?!!this.topRow.hasPreviousConnection:!!r.followsStatement,h=o+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!h.precedesStatement,e.blockRendering.Types.isInputRow(a)&&a.hasStatement)a.measure(),n=a.width-a.getLastInput().width+t;else if(r&&(2==o||h)&&e.blockRendering.Types.isInputRow(a)&&!a.hasStatement){h=a.xPos,r=null;for(var L,R=0;L=a.elements[R];R++)e.blockRendering.Types.isSpacer(L)&&(r=L),!(r&&(e.blockRendering.Types.isField(L)||e.blockRendering.Types.isInput(L))&&h<n)||e.blockRendering.Types.isField(L)&&(L.field instanceof e.FieldLabel||L.field instanceof e.FieldImage)||(r.width+=n-h),h+=L.width}}},e.zelos.RenderInfo.prototype.finalizeOutputConnection_=function(){if(this.outputConnection&&this.outputConnection.isDynamicShape){for(var o,t=0,n=0;o=this.rows[n];n++)o.yPos=t,t+=o.height;this.height=t,t=this.outputConnection.shape.height(n=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height),n=this.outputConnection.shape.width(n),this.outputConnection.height=t,this.outputConnection.width=n,this.outputConnection.startX=n,this.outputConnection.connectionOffsetY=this.outputConnection.shape.connectionOffsetY(t),this.outputConnection.connectionOffsetX=this.outputConnection.shape.connectionOffsetX(n),o=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(o=n,this.rightSide.height=t,this.rightSide.width=o,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+o),this.startX=n,this.width+=n+o,this.widthWithChildren+=n+o}},e.zelos.RenderInfo.prototype.finalizeHorizontalAlignment_=function(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var o,t=0,n=0;o=this.rows[n];n++)if(e.blockRendering.Types.isInputRow(o)){t=o.elements[o.elements.length-2];var r=this.getNegativeSpacing_(o.elements[1]),a=this.getNegativeSpacing_(t),h=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-(t=r+a)<h&&(r=(t=this.width-h)/2,a=t/2),o.elements.unshift(new e.blockRendering.InRowSpacer(this.constants_,-r)),o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,-a))}if(t)for(this.width-=t,this.widthWithChildren-=t,this.rightSide.xPos-=t,n=0;o=this.rows[n];n++)e.blockRendering.Types.isTopOrBottomRow(o)&&(o.elements[1].width-=t,o.elements[1].widthWithConnectedBlocks-=t),o.width-=t,o.widthWithConnectedBlocks-=t}},e.zelos.RenderInfo.prototype.getNegativeSpacing_=function(t){if(!t)return 0;var n=this.outputConnection.width,o=this.outputConnection.shape.type,r=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)return o===r.SHAPES.ROUND?n-(o=this.height/2>(o=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH)?o:this.height/2)*(1-Math.sin(Math.acos((o-this.constants_.SMALL_PADDING)/o))):0;if(e.blockRendering.Types.isInlineInput(t)){var a=t.connectedBlock;return t=a?a.pathObject.outputShapeType:t.shape.type,a&&a.outputConnection&&(a.statementInputCount||a.nextConnection)||o==r.SHAPES.HEXAGONAL&&o!=t?0:n-this.constants_.SHAPE_IN_SHAPE_PADDING[o][t]}return e.blockRendering.Types.isField(t)?o==r.SHAPES.ROUND&&t.field instanceof e.FieldTextInput?n-2.75*r.GRID_UNIT:n-this.constants_.SHAPE_IN_SHAPE_PADDING[o][0]:e.blockRendering.Types.isIcon(t)?this.constants_.SMALL_PADDING:0},e.zelos.RenderInfo.prototype.finalizeVerticalAlignment_=function(){if(!this.outputConnection)for(var t=2;t<this.rows.length-1;t+=2){var n=this.rows[t-1],o=this.rows[t],r=this.rows[t+1],a=2==t,h=t+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!r.precedesStatement;if(a?this.topRow.hasPreviousConnection:n.followsStatement){var R=3==o.elements.length&&(o.elements[1].field instanceof e.FieldLabel||o.elements[1].field instanceof e.FieldImage);if(!a&&R)n.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.MEDIUM_PADDING;else if(a||h){if(h){for(a=!1,h=0;R=o.elements[h];h++)if(e.blockRendering.Types.isInlineInput(R)&&R.connectedBlock&&!R.connectedBlock.isShadow()&&40<=R.connectedBlock.getHeightWidth().height){a=!0;break}a&&(n.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.SMALL_PADDING)}}else n.height+=this.constants_.SMALL_PADDING}}},e.zelos.RenderInfo.prototype.finalize_=function(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),e.zelos.RenderInfo.superClass_.finalize_.call(this),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)},e.zelos.Drawer=function(t,n){e.zelos.Drawer.superClass_.constructor.call(this,t,n)},e.utils.object.inherits(e.zelos.Drawer,e.blockRendering.Drawer),e.zelos.Drawer.prototype.draw=function(){var t=this.block_.pathObject;t.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),t.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&t.flipRTL(),e.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_(),this.info_.outputConnection&&(t.outputShapeType=this.info_.outputConnection.shape.type),t.endDrawing()},e.zelos.Drawer.prototype.drawOutline_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):e.zelos.Drawer.superClass_.drawOutline_.call(this)},e.zelos.Drawer.prototype.drawLeft_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():e.zelos.Drawer.superClass_.drawLeft_.call(this)},e.zelos.Drawer.prototype.drawRightSideRow_=function(t){if(!(0>=t.height))if(t.precedesStatement||t.followsStatement){var n=this.constants_.INSIDE_CORNERS.rightHeight;this.outlinePath_+=(t.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<(n=t.height-(t.precedesStatement?n:0))?e.utils.svgPaths.lineOnAxis("V",t.yPos+n):"")+(t.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},e.zelos.Drawer.prototype.drawRightDynamicConnection_=function(){this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)},e.zelos.Drawer.prototype.drawLeftDynamicConnection_=function(){this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"},e.zelos.Drawer.prototype.drawFlatTop_=function(){var t=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=e.utils.svgPaths.moveBy(t.xPos,this.info_.startY),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("h",t.width)},e.zelos.Drawer.prototype.drawFlatBottom_=function(){var t=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.baseline),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("h",-t.width)},e.zelos.Drawer.prototype.drawInlineInput_=function(t){this.positionInlineInputConnection_(t);var n=t.input.name;if(!t.connectedBlock&&!this.info_.isInsertionMarker){var o=t.width-2*t.connectionWidth;t=e.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-t.height/2)+e.utils.svgPaths.lineOnAxis("h",o)+t.shape.pathRightDown(t.height)+e.utils.svgPaths.lineOnAxis("h",-o)+t.shape.pathUp(t.height)+"z",this.block_.pathObject.setOutlinePath(n,t)}},e.zelos.Drawer.prototype.drawStatementInput_=function(t){var n=t.getLastInput(),o=n.xPos+n.notchOffset+n.shape.width,r=n.shape.pathRight+e.utils.svgPaths.lineOnAxis("h",-(n.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,a=t.height-2*this.constants_.INSIDE_CORNERS.height;n=this.constants_.INSIDE_CORNERS.pathBottom+e.utils.svgPaths.lineOnAxis("h",n.notchOffset-this.constants_.INSIDE_CORNERS.width)+(n.connectedBottomNextConnection?"":n.shape.pathLeft),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",o)+r+e.utils.svgPaths.lineOnAxis("v",a)+n+e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},e.zelos.MarkerSvg=function(t,n,o){e.zelos.MarkerSvg.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.zelos.MarkerSvg,e.blockRendering.MarkerSvg),e.zelos.MarkerSvg.prototype.showWithInputOutput_=function(t){var n=t.getSourceBlock();t=t.getLocation().getOffsetInBlock(),this.positionCircle_(t.x,t.y),this.setParent_(n),this.showCurrent_()},e.zelos.MarkerSvg.prototype.showWithOutput_=function(t){this.showWithInputOutput_(t)},e.zelos.MarkerSvg.prototype.showWithInput_=function(t){this.showWithInputOutput_(t)},e.zelos.MarkerSvg.prototype.showWithBlock_=function(t){var n=(t=t.getLocation()).getHeightWidth();this.positionRect_(0,0,n.width,n.height),this.setParent_(t),this.showCurrent_()},e.zelos.MarkerSvg.prototype.positionCircle_=function(t,n){this.markerCircle_.setAttribute("cx",t),this.markerCircle_.setAttribute("cy",n),this.currentMarkerSvg=this.markerCircle_},e.zelos.MarkerSvg.prototype.hide=function(){e.zelos.MarkerSvg.superClass_.hide.call(this),this.markerCircle_.style.display="none"},e.zelos.MarkerSvg.prototype.createDomInternal_=function(){if(e.zelos.MarkerSvg.superClass_.createDomInternal_.call(this),this.markerCircle_=e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var t=this.getBlinkProperties_();e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerCircle_)}return this.markerSvg_},e.zelos.MarkerSvg.prototype.applyColour_=function(t){e.zelos.MarkerSvg.superClass_.applyColour_.call(this,t),this.markerCircle_.setAttribute("fill",this.colour_),this.markerCircle_.setAttribute("stroke",this.colour_),this.isCursor()&&this.markerCircle_.firstChild.setAttribute("values",this.colour_+";transparent;transparent;")},e.zelos.PathObject=function(t,n,o){e.zelos.PathObject.superClass_.constructor.call(this,t,n,o),this.constants=o,this.svgPathSelected_=null,this.outlines_=Object.create(null),this.outputShapeType=this.remainingOutlines_=null},e.utils.object.inherits(e.zelos.PathObject,e.blockRendering.PathObject),e.zelos.PathObject.prototype.setPath=function(t){e.zelos.PathObject.superClass_.setPath.call(this,t),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",t)},e.zelos.PathObject.prototype.applyColour=function(t){for(var n in e.zelos.PathObject.superClass_.applyColour.call(this,t),t.isShadow()&&t.getParent()&&this.svgPath.setAttribute("stroke",t.getParent().style.colourTertiary),this.outlines_)this.outlines_[n].setAttribute("fill",this.style.colourTertiary)},e.zelos.PathObject.prototype.flipRTL=function(){for(var t in e.zelos.PathObject.superClass_.flipRTL.call(this),this.outlines_)this.outlines_[t].setAttribute("transform","scale(-1 1)")},e.zelos.PathObject.prototype.updateSelected=function(t){this.setClass_("blocklySelected",t),t?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(!0),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)},e.zelos.PathObject.prototype.updateReplacementFade=function(t){this.setClass_("blocklyReplaceable",t),t?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")},e.zelos.PathObject.prototype.updateShapeForInputHighlight=function(t,n){t=t.getParentInput().name,(t=this.getOutlinePath_(t))&&(n?t.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):t.removeAttribute("filter"))},e.zelos.PathObject.prototype.beginDrawing=function(){for(var t in this.remainingOutlines_=Object.create(null),this.outlines_)this.remainingOutlines_[t]=1},e.zelos.PathObject.prototype.endDrawing=function(){if(this.remainingOutlines_)for(var t in this.remainingOutlines_)this.removeOutlinePath_(t);this.remainingOutlines_=null},e.zelos.PathObject.prototype.setOutlinePath=function(t,n){(t=this.getOutlinePath_(t)).setAttribute("d",n),t.setAttribute("fill",this.style.colourTertiary)},e.zelos.PathObject.prototype.getOutlinePath_=function(t){return this.outlines_[t]||(this.outlines_[t]=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines_&&delete this.remainingOutlines_[t],this.outlines_[t]},e.zelos.PathObject.prototype.removeOutlinePath_=function(t){this.outlines_[t].parentNode.removeChild(this.outlines_[t]),delete this.outlines_[t]},e.zelos.Renderer=function(t){e.zelos.Renderer.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.zelos.Renderer,e.blockRendering.Renderer),e.zelos.Renderer.prototype.makeConstants_=function(){return new e.zelos.ConstantProvider},e.zelos.Renderer.prototype.makeRenderInfo_=function(t){return new e.zelos.RenderInfo(this,t)},e.zelos.Renderer.prototype.makeDrawer_=function(t,n){return new e.zelos.Drawer(t,n)},e.zelos.Renderer.prototype.makeMarkerDrawer=function(t,n){return new e.zelos.MarkerSvg(t,this.getConstants(),n)},e.zelos.Renderer.prototype.makePathObject=function(t,n){return new e.zelos.PathObject(t,n,this.getConstants())},e.zelos.Renderer.prototype.shouldHighlightConnection=function(t){return t.type!=e.connectionTypes.INPUT_VALUE&&t.type!==e.connectionTypes.OUTPUT_VALUE},e.zelos.Renderer.prototype.getConnectionPreviewMethod=function(t,n,o){return n.type==e.connectionTypes.OUTPUT_VALUE?t.isConnected()?e.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:e.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:e.zelos.Renderer.superClass_.getConnectionPreviewMethod(t,n,o)},e.blockRendering.register("zelos",e.zelos.Renderer),e.Themes.Dark=e.Theme.defineTheme("dark",{base:e.Themes.Classic,componentStyles:{workspaceBackgroundColour:"#1e1e1e",toolboxBackgroundColour:"blackBackground",toolboxForegroundColour:"#fff",flyoutBackgroundColour:"#252526",flyoutForegroundColour:"#ccc",flyoutOpacity:1,scrollbarColour:"#797979",insertionMarkerColour:"#fff",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#d0d0d0",blackBackground:"#333"}}),e.Themes.Deuteranopia={},e.Themes.Deuteranopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#f2a72c",colourSecondary:"#f1c172",colourTertiary:"#da921c"},list_blocks:{colourPrimary:"#7d65ab",colourSecondary:"#a88be0",colourTertiary:"#66518e"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#795a07",colourSecondary:"#ac8726",colourTertiary:"#c4a03f"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"},variable_dynamic_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"}},e.Themes.Deuteranopia.categoryStyles={colour_category:{colour:"#f2a72c"},list_category:{colour:"#7d65ab"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#795a07"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#47025a"},variable_dynamic_category:{colour:"#47025a"}},e.Themes.Deuteranopia=new e.Theme("deuteranopia",e.Themes.Deuteranopia.defaultBlockStyles,e.Themes.Deuteranopia.categoryStyles),e.Themes.HighContrast={},e.Themes.HighContrast.defaultBlockStyles={colour_blocks:{colourPrimary:"#a52714",colourSecondary:"#FB9B8C",colourTertiary:"#FBE1DD"},list_blocks:{colourPrimary:"#4a148c",colourSecondary:"#AD7BE9",colourTertiary:"#CDB6E9"},logic_blocks:{colourPrimary:"#01579b",colourSecondary:"#64C7FF",colourTertiary:"#C5EAFF"},loop_blocks:{colourPrimary:"#33691e",colourSecondary:"#9AFF78",colourTertiary:"#E1FFD7"},math_blocks:{colourPrimary:"#1a237e",colourSecondary:"#8A9EFF",colourTertiary:"#DCE2FF"},procedure_blocks:{colourPrimary:"#006064",colourSecondary:"#77E6EE",colourTertiary:"#CFECEE"},text_blocks:{colourPrimary:"#004d40",colourSecondary:"#5ae27c",colourTertiary:"#D2FFDD"},variable_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},variable_dynamic_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},hat_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB",hat:"cap"}},e.Themes.HighContrast.categoryStyles={colour_category:{colour:"#a52714"},list_category:{colour:"#4a148c"},logic_category:{colour:"#01579b"},loop_category:{colour:"#33691e"},math_category:{colour:"#1a237e"},procedure_category:{colour:"#006064"},text_category:{colour:"#004d40"},variable_category:{colour:"#880e4f"},variable_dynamic_category:{colour:"#880e4f"}},e.Themes.HighContrast=new e.Theme("highcontrast",e.Themes.HighContrast.defaultBlockStyles,e.Themes.HighContrast.categoryStyles),e.Themes.HighContrast.setComponentStyle("selectedGlowColour","#000000"),e.Themes.HighContrast.setComponentStyle("selectedGlowSize",1),e.Themes.HighContrast.setComponentStyle("replacementGlowColour","#000000"),e.Themes.HighContrast.setFontStyle({family:null,weight:null,size:16}),e.Themes.Tritanopia={},e.Themes.Tritanopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#05427f",colourSecondary:"#2974c0",colourTertiary:"#2d74bb"},list_blocks:{colourPrimary:"#b69ce8",colourSecondary:"#ccbaef",colourTertiary:"#9176c5"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#aa1846",colourSecondary:"#d36185",colourTertiary:"#7c1636"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"},variable_dynamic_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"}},e.Themes.Tritanopia.categoryStyles={colour_category:{colour:"#05427f"},list_category:{colour:"#b69ce8"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#aa1846"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#4b2d84"},variable_dynamic_category:{colour:"#4b2d84"}},e.Themes.Tritanopia=new e.Theme("tritanopia",e.Themes.Tritanopia.defaultBlockStyles,e.Themes.Tritanopia.categoryStyles),e.requires={},e}.apply(X,[]))&&(B.exports=m)},18783:function(B,X,_){var m,e;m=[_(55484)],void 0!==(e=function(t){"use strict";return t.Blocks={},t.Blocks}.apply(X,m))&&(B.exports=e)},55484:function(B,X,_){var m,e;m=[_(81069)],void 0!==(e=function(t){"use strict";return t.Blocks.colour={},t.Constants={},t.Constants.Colour={},t.Constants.Colour.HUE=20,t.defineBlocksWithJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),t.Constants.Lists={},t.Constants.Lists.HUE=260,t.defineBlocksWithJsonArray([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),t.Blocks.lists_create_with={init:function(){this.setHelpUrl(t.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new t.Mutator(["lists_create_with_item"])),this.setTooltip(t.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("items",this.itemCount_),n},domToMutation:function(n){this.itemCount_=parseInt(n.getAttribute("items"),10),this.updateShape_()},decompose:function(n){var o=n.newBlock("lists_create_with_container");o.initSvg();for(var r=o.getInput("STACK").connection,a=0;a<this.itemCount_;a++){var h=n.newBlock("lists_create_with_item");h.initSvg(),r.connect(h.previousConnection),r=h.nextConnection}return o},compose:function(n){var o=n.getInputTargetBlock("STACK");for(n=[];o&&!o.isInsertionMarker();)n.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();for(o=0;o<this.itemCount_;o++){var r=this.getInput("ADD"+o).connection.targetConnection;r&&-1==n.indexOf(r)&&r.disconnect()}for(this.itemCount_=n.length,this.updateShape_(),o=0;o<this.itemCount_;o++)t.Mutator.reconnect(n[o],this,"ADD"+o)},saveConnections:function(n){n=n.getInputTargetBlock("STACK");for(var o=0;n;){var r=this.getInput("ADD"+o);n.valueConnection_=r&&r.connection.targetConnection,o++,n=n.nextConnection&&n.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(t.Msg.LISTS_CREATE_EMPTY_TITLE);for(var n=0;n<this.itemCount_;n++)if(!this.getInput("ADD"+n)){var o=this.appendValueInput("ADD"+n).setAlign(t.ALIGN_RIGHT);0==n&&o.appendField(t.Msg.LISTS_CREATE_WITH_INPUT_WITH)}for(;this.getInput("ADD"+n);)this.removeInput("ADD"+n),n++}},t.Blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(t.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},t.Blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},t.Blocks.lists_indexOf={init:function(){var n=[[t.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[t.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(t.Msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new t.FieldDropdown(n),"END"),this.setInputsInline(!0);var o=this;this.setTooltip(function(){return t.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",o.workspace.options.oneBasedIndex?"0":"-1")})}},t.Blocks.lists_getIndex={init:function(){var n=[[t.Msg.LISTS_GET_INDEX_GET,"GET"],[t.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[t.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[t.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),n=new t.FieldDropdown(n,function(r){r="REMOVE"==r,this.getSourceBlock().updateStatement_(r)}),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(n,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),t.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);var o=this;this.setTooltip(function(){var r=o.getFieldValue("MODE"),a=o.getFieldValue("WHERE"),h="";switch(r+" "+a){case"GET FROM_START":case"GET FROM_END":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"==a||"FROM_END"==a)&&(h+="  "+("FROM_START"==a?t.Msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",o.workspace.options.oneBasedIndex?"#1":"#0")),h})},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");n.setAttribute("statement",!this.outputConnection);var o=this.getInput("AT").type==t.INPUT_VALUE;return n.setAttribute("at",o),n},domToMutation:function(n){var o="true"==n.getAttribute("statement");this.updateStatement_(o),n="false"!=n.getAttribute("at"),this.updateAt_(n)},updateStatement_:function(n){n!=!this.outputConnection&&(this.unplug(!0,!0),n?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(n){this.removeInput("AT"),this.removeInput("ORDINAL",!0),n?(this.appendValueInput("AT").setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var o=new t.FieldDropdown(this.WHERE_OPTIONS,function(r){var a="FROM_START"==r||"FROM_END"==r;if(a!=n){var h=this.getSourceBlock();return h.updateAt_(a),h.setFieldValue(r,"WHERE"),null}});this.getInput("AT").appendField(o,"WHERE"),t.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},t.Blocks.lists_setIndex={init:function(){var n=[[t.Msg.LISTS_SET_INDEX_SET,"SET"],[t.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[t.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new t.FieldDropdown(n),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(t.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);var o=this;this.setTooltip(function(){var r=o.getFieldValue("MODE"),a=o.getFieldValue("WHERE"),h="";switch(r+" "+a){case"SET FROM_START":case"SET FROM_END":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"==a||"FROM_END"==a)&&(h+="  "+t.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",o.workspace.options.oneBasedIndex?"#1":"#0")),h})},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o=this.getInput("AT").type==t.INPUT_VALUE;return n.setAttribute("at",o),n},domToMutation:function(n){n="false"!=n.getAttribute("at"),this.updateAt_(n)},updateAt_:function(n){this.removeInput("AT"),this.removeInput("ORDINAL",!0),n?(this.appendValueInput("AT").setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var o=new t.FieldDropdown(this.WHERE_OPTIONS,function(r){var a="FROM_START"==r||"FROM_END"==r;if(a!=n){var h=this.getSourceBlock();return h.updateAt_(a),h.setFieldValue(r,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(o,"WHERE")}},t.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[t.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(t.Msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o=this.getInput("AT1").type==t.INPUT_VALUE;return n.setAttribute("at1",o),o=this.getInput("AT2").type==t.INPUT_VALUE,n.setAttribute("at2",o),n},domToMutation:function(n){var o="true"==n.getAttribute("at1");n="true"==n.getAttribute("at2"),this.updateAt_(1,o),this.updateAt_(2,n)},updateAt_:function(n,o){this.removeInput("AT"+n),this.removeInput("ORDINAL"+n,!0),o?(this.appendValueInput("AT"+n).setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+n).appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+n);var r=new t.FieldDropdown(this["WHERE_OPTIONS_"+n],function(a){var h="FROM_START"==a||"FROM_END"==a;if(h!=o){var R=this.getSourceBlock();return R.updateAt_(n,h),R.setFieldValue(a,"WHERE"+n),null}});this.getInput("AT"+n).appendField(r,"WHERE"+n),1==n&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),t.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},t.Blocks.lists_sort={init:function(){this.jsonInit({message0:t.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[t.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[t.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[t.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[t.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[t.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:t.Msg.LISTS_SORT_TOOLTIP,helpUrl:t.Msg.LISTS_SORT_HELPURL})}},t.Blocks.lists_split={init:function(){var n=this,o=new t.FieldDropdown([[t.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[t.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(r){n.updateType_(r)});this.setHelpUrl(t.Msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(o,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(t.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(function(){var r=n.getFieldValue("MODE");if("SPLIT"==r)return t.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"==r)return t.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+r)})},updateType_:function(n){if(this.getFieldValue("MODE")!=n){var o=this.getInput("INPUT").connection;o.setShadowDom(null);var r=o.targetBlock();r&&(o.disconnect(),r.isShadow()?r.dispose():this.bumpNeighbours())}"SPLIT"==n?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("mode",this.getFieldValue("MODE")),n},domToMutation:function(n){this.updateType_(n.getAttribute("mode"))}},t.Blocks.logic={},t.Constants.Logic={},t.Constants.Logic.HUE=210,t.defineBlocksWithJsonArray([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200f<","LT"],["\u200f\u2264","LTE"],["\u200f>","GT"],["\u200f\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]}]),t.defineBlocksWithJsonArray([{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),t.Constants.Logic.TOOLTIPS_BY_OP={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"},t.Extensions.register("logic_op_tooltip",t.Extensions.buildTooltipForDropdown("OP",t.Constants.Logic.TOOLTIPS_BY_OP)),t.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN={elseifCount_:0,elseCount_:0,suppressPrefixSuffix:!0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var n=t.utils.xml.createElement("mutation");return this.elseifCount_&&n.setAttribute("elseif",this.elseifCount_),this.elseCount_&&n.setAttribute("else",1),n},domToMutation:function(n){this.elseifCount_=parseInt(n.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(n.getAttribute("else"),10)||0,this.rebuildShape_()},decompose:function(n){var o=n.newBlock("controls_if_if");o.initSvg();for(var r=o.nextConnection,a=1;a<=this.elseifCount_;a++){var h=n.newBlock("controls_if_elseif");h.initSvg(),r.connect(h.previousConnection),r=h.nextConnection}return this.elseCount_&&((n=n.newBlock("controls_if_else")).initSvg(),r.connect(n.previousConnection)),o},compose:function(n){n=n.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;for(var o=[null],r=[null],a=null;n&&!n.isInsertionMarker();){switch(n.type){case"controls_if_elseif":this.elseifCount_++,o.push(n.valueConnection_),r.push(n.statementConnection_);break;case"controls_if_else":this.elseCount_++,a=n.statementConnection_;break;default:throw TypeError("Unknown block type: "+n.type)}n=n.nextConnection&&n.nextConnection.targetBlock()}this.updateShape_(),this.reconnectChildBlocks_(o,r,a)},saveConnections:function(n){n=n.nextConnection.targetBlock();for(var o=1;n;){switch(n.type){case"controls_if_elseif":var r=this.getInput("IF"+o),a=this.getInput("DO"+o);n.valueConnection_=r&&r.connection.targetConnection,n.statementConnection_=a&&a.connection.targetConnection,o++;break;case"controls_if_else":a=this.getInput("ELSE"),n.statementConnection_=a&&a.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+n.type)}n=n.nextConnection&&n.nextConnection.targetBlock()}},rebuildShape_:function(){var n=[null],o=[null],r=null;this.getInput("ELSE")&&(r=this.getInput("ELSE").connection.targetConnection);for(var a=1;this.getInput("IF"+a);){var h=this.getInput("IF"+a),R=this.getInput("DO"+a);n.push(h.connection.targetConnection),o.push(R.connection.targetConnection),a++}this.updateShape_(),this.reconnectChildBlocks_(n,o,r)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var n=1;this.getInput("IF"+n);)this.removeInput("IF"+n),this.removeInput("DO"+n),n++;for(n=1;n<=this.elseifCount_;n++)this.appendValueInput("IF"+n).setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+n).appendField(t.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(t.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(n,o,r){for(var a=1;a<=this.elseifCount_;a++)t.Mutator.reconnect(n[a],this,"IF"+a),t.Mutator.reconnect(o[a],this,"DO"+a);t.Mutator.reconnect(r,this,"ELSE")}},t.Extensions.registerMutator("controls_if_mutator",t.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN,null,["controls_if_elseif","controls_if_else"]),t.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?t.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?t.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?t.Msg.CONTROLS_IF_TOOLTIP_4:"":t.Msg.CONTROLS_IF_TOOLTIP_1}.bind(this))},t.Extensions.register("controls_if_tooltip",t.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION),t.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN={onchange:function(n){this.prevBlocks_||(this.prevBlocks_=[null,null]);var o=this.getInputTargetBlock("A"),r=this.getInputTargetBlock("B");o&&r&&!this.workspace.connectionChecker.doTypeChecks(o.outputConnection,r.outputConnection)&&(t.Events.setGroup(n.group),(n=this.prevBlocks_[0])!==o&&(o.unplug(),!n||n.isDisposed()||n.isShadow()||this.getInput("A").connection.connect(n.outputConnection)),(o=this.prevBlocks_[1])!==r&&(r.unplug(),!o||o.isDisposed()||o.isShadow()||this.getInput("B").connection.connect(o.outputConnection)),this.bumpNeighbours(),t.Events.setGroup(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},t.Constants.Logic.LOGIC_COMPARE_EXTENSION=function(){this.mixin(t.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN)},t.Extensions.register("logic_compare",t.Constants.Logic.LOGIC_COMPARE_EXTENSION),t.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN={prevParentConnection_:null,onchange:function(n){var o=this.getInputTargetBlock("THEN"),r=this.getInputTargetBlock("ELSE"),a=this.outputConnection.targetConnection;if((o||r)&&a)for(var h=0;2>h;h++){var R=1==h?o:r;R&&!R.workspace.connectionChecker.doTypeChecks(R.outputConnection,a)&&(t.Events.setGroup(n.group),a===this.prevParentConnection_?(this.unplug(),a.getSourceBlock().bumpNeighbours()):(R.unplug(),R.bumpNeighbours()),t.Events.setGroup(!1))}this.prevParentConnection_=a}},t.Extensions.registerMixin("logic_ternary",t.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN),t.Blocks.loops={},t.Constants.Loops={},t.Constants.Loops.HUE=120,t.defineBlocksWithJsonArray([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),t.Constants.Loops.WHILE_UNTIL_TOOLTIPS={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"},t.Extensions.register("controls_whileUntil_tooltip",t.Extensions.buildTooltipForDropdown("MODE",t.Constants.Loops.WHILE_UNTIL_TOOLTIPS)),t.Constants.Loops.BREAK_CONTINUE_TOOLTIPS={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"},t.Extensions.register("controls_flow_tooltip",t.Extensions.buildTooltipForDropdown("FLOW",t.Constants.Loops.BREAK_CONTINUE_TOOLTIPS)),t.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN={customContextMenu:function(n){if(!this.isInFlyout){var o=this.getField("VAR").getVariable(),r=o.name;if(!this.isCollapsed()&&null!=r){var a={enabled:!0};a.text=t.Msg.VARIABLES_SET_CREATE_GET.replace("%1",r),o=t.Variables.generateVariableFieldDom(o),(r=t.utils.xml.createElement("block")).setAttribute("type","variables_get"),r.appendChild(o),a.callback=t.ContextMenu.callbackFactory(this,r),n.push(a)}}}},t.Extensions.registerMixin("contextMenu_newGetVariableBlock",t.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN),t.Extensions.register("controls_for_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),t.Extensions.register("controls_forEach_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN={LOOP_TYPES:["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"],suppressPrefixSuffix:!0,getSurroundLoop:function(n){do{if(-1!=t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.LOOP_TYPES.indexOf(n.type))return n;n=n.getSurroundParent()}while(n);return null},onchange:function(n){if(this.workspace.isDragging&&!this.workspace.isDragging()&&n.type==t.Events.BLOCK_MOVE){var o=t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(this);if(this.setWarningText(o?null:t.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){var r=t.Events.getGroup();t.Events.setGroup(n.group),this.setEnabled(o),t.Events.setGroup(r)}}}},t.Extensions.registerMixin("controls_flow_in_loop_check",t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN),t.Blocks.math={},t.Constants.Math={},t.Constants.Math.HUE=230,t.defineBlocksWithJsonArray([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xbd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),t.Constants.Math.TOOLTIPS_BY_OP={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"},t.Extensions.register("math_op_tooltip",t.Extensions.buildTooltipForDropdown("OP",t.Constants.Math.TOOLTIPS_BY_OP)),t.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN={mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o="DIVISIBLE_BY"==this.getFieldValue("PROPERTY");return n.setAttribute("divisor_input",o),n},domToMutation:function(n){n="true"==n.getAttribute("divisor_input"),this.updateShape_(n)},updateShape_:function(n){var o=this.getInput("DIVISOR");n?o||this.appendValueInput("DIVISOR").setCheck("Number"):o&&this.removeInput("DIVISOR")}},t.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION=function(){this.getField("PROPERTY").setValidator(function(n){n="DIVISIBLE_BY"==n,this.getSourceBlock().updateShape_(n)})},t.Extensions.registerMutator("math_is_divisibleby_mutator",t.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN,t.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION),t.Extensions.register("math_change_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),t.Constants.Math.LIST_MODES_MUTATOR_MIXIN={updateType_:function(n){this.outputConnection.setCheck("MODE"==n?"Array":"Number")},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("op",this.getFieldValue("OP")),n},domToMutation:function(n){this.updateType_(n.getAttribute("op"))}},t.Constants.Math.LIST_MODES_MUTATOR_EXTENSION=function(){this.getField("OP").setValidator(function(n){this.updateType_(n)}.bind(this))},t.Extensions.registerMutator("math_modes_of_list_mutator",t.Constants.Math.LIST_MODES_MUTATOR_MIXIN,t.Constants.Math.LIST_MODES_MUTATOR_EXTENSION),t.Blocks.procedures={},t.Blocks.procedures_defnoreturn={init:function(){var n=t.Procedures.findLegalName("",this);(n=new t.FieldTextInput(n,t.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(n,"NAME").appendField("","PARAMS"),this.setMutator(new t.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(t.Msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(t.Msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:function(n){this.hasStatements_!==n&&(n?(this.appendStatementInput("STACK").appendField(t.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=n)},updateParams_:function(){var n="";this.arguments_.length&&(n=t.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),t.Events.disable();try{this.setFieldValue(n,"PARAMS")}finally{t.Events.enable()}},mutationToDom:function(n){var o=t.utils.xml.createElement("mutation");n&&o.setAttribute("name",this.getFieldValue("NAME"));for(var r=0;r<this.argumentVarModels_.length;r++){var a=t.utils.xml.createElement("arg"),h=this.argumentVarModels_[r];a.setAttribute("name",h.name),a.setAttribute("varid",h.getId()),n&&this.paramIds_&&a.setAttribute("paramId",this.paramIds_[r]),o.appendChild(a)}return this.hasStatements_||o.setAttribute("statements","false"),o},domToMutation:function(n){this.arguments_=[],this.argumentVarModels_=[];for(var r,o=0;r=n.childNodes[o];o++)if("arg"==r.nodeName.toLowerCase()){var a=r.getAttribute("name");r=r.getAttribute("varid")||r.getAttribute("varId"),this.arguments_.push(a),null!=(r=t.Variables.getOrCreateVariablePackage(this.workspace,r,a,""))?this.argumentVarModels_.push(r):console.log("Failed to create a variable with name "+a+", ignoring.")}this.updateParams_(),t.Procedures.mutateCallers(this),this.setStatements_("false"!==n.getAttribute("statements"))},decompose:function(n){var o=t.utils.xml.createElement("block");o.setAttribute("type","procedures_mutatorcontainer");var r=t.utils.xml.createElement("statement");r.setAttribute("name","STACK"),o.appendChild(r);for(var a=0;a<this.arguments_.length;a++){var h=t.utils.xml.createElement("block");h.setAttribute("type","procedures_mutatorarg");var R=t.utils.xml.createElement("field");R.setAttribute("name","NAME");var L=t.utils.xml.createTextNode(this.arguments_[a]);R.appendChild(L),h.appendChild(R),R=t.utils.xml.createElement("next"),h.appendChild(R),r.appendChild(h),r=R}return n=t.Xml.domToBlock(o,n),"procedures_defreturn"==this.type?n.setFieldValue(this.hasStatements_,"STATEMENTS"):n.removeInput("STATEMENT_INPUT"),t.Procedures.mutateCallers(this),n},compose:function(n){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];for(var o=n.getInputTargetBlock("STACK");o&&!o.isInsertionMarker();){var r=o.getFieldValue("NAME");this.arguments_.push(r),r=this.workspace.getVariable(r,""),this.argumentVarModels_.push(r),this.paramIds_.push(o.id),o=o.nextConnection&&o.nextConnection.targetBlock()}this.updateParams_(),t.Procedures.mutateCallers(this),null!==(n=n.getFieldValue("STATEMENTS"))&&this.hasStatements_!=(n="TRUE"==n)&&(n?(this.setStatements_(!0),t.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(n=this.getInput("STACK").connection,(this.statementConnection_=n.targetConnection)&&((n=n.targetBlock()).unplug(),n.bumpNeighbours()),this.setStatements_(!1)))},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(n,o){var r=this.workspace.getVariableById(n);if(""==r.type){r=r.name,o=this.workspace.getVariableById(o);for(var a=!1,h=0;h<this.argumentVarModels_.length;h++)this.argumentVarModels_[h].getId()==n&&(this.arguments_[h]=o.name,this.argumentVarModels_[h]=o,a=!0);a&&(this.displayRenamedVar_(r,o.name),t.Procedures.mutateCallers(this))}},updateVarName:function(n){for(var o=n.name,r=!1,a=0;a<this.argumentVarModels_.length;a++)if(this.argumentVarModels_[a].getId()==n.getId()){var h=this.arguments_[a];this.arguments_[a]=o,r=!0}r&&(this.displayRenamedVar_(h,o),t.Procedures.mutateCallers(this))},displayRenamedVar_:function(n,o){if(this.updateParams_(),this.mutator&&this.mutator.isVisible())for(var h,r=this.mutator.workspace_.getAllBlocks(!1),a=0;h=r[a];a++)"procedures_mutatorarg"==h.type&&t.Names.equals(n,h.getFieldValue("NAME"))&&h.setFieldValue(o,"NAME")},customContextMenu:function(n){if(!this.isInFlyout){var o={enabled:!0},r=this.getFieldValue("NAME");o.text=t.Msg.PROCEDURES_CREATE_DO.replace("%1",r);var a=t.utils.xml.createElement("mutation");for(a.setAttribute("name",r),r=0;r<this.arguments_.length;r++){var h=t.utils.xml.createElement("arg");h.setAttribute("name",this.arguments_[r]),a.appendChild(h)}if((r=t.utils.xml.createElement("block")).setAttribute("type",this.callType_),r.appendChild(a),o.callback=t.ContextMenu.callbackFactory(this,r),n.push(o),!this.isCollapsed())for(r=0;r<this.argumentVarModels_.length;r++)(o={enabled:!0}).text=t.Msg.VARIABLES_SET_CREATE_GET.replace("%1",(a=this.argumentVarModels_[r]).name),a=t.Variables.generateVariableFieldDom(a),(h=t.utils.xml.createElement("block")).setAttribute("type","variables_get"),h.appendChild(a),o.callback=t.ContextMenu.callbackFactory(this,h),n.push(o)}},callType_:"procedures_callnoreturn"},t.Blocks.procedures_defreturn={init:function(){var n=t.Procedures.findLegalName("",this);(n=new t.FieldTextInput(n,t.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(n,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(t.ALIGN_RIGHT).appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new t.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(t.Msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(t.Msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:t.Blocks.procedures_defnoreturn.setStatements_,updateParams_:t.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:t.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:t.Blocks.procedures_defnoreturn.domToMutation,decompose:t.Blocks.procedures_defnoreturn.decompose,compose:t.Blocks.procedures_defnoreturn.compose,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:t.Blocks.procedures_defnoreturn.getVars,getVarModels:t.Blocks.procedures_defnoreturn.getVarModels,renameVarById:t.Blocks.procedures_defnoreturn.renameVarById,updateVarName:t.Blocks.procedures_defnoreturn.updateVarName,displayRenamedVar_:t.Blocks.procedures_defnoreturn.displayRenamedVar_,customContextMenu:t.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"},t.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(t.Msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(t.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new t.FieldCheckbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}},t.Blocks.procedures_mutatorarg={init:function(){var n=new t.FieldTextInput(t.Procedures.DEFAULT_ARG,this.validator_);n.oldShowEditorFn_=n.showEditor_,n.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(t.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(n,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,n.onFinishEditing_=this.deleteIntermediateVars_,n.createdVariables_=[],n.onFinishEditing_("x")},validator_:function(n){var o=this.getSourceBlock(),r=t.Mutator.findParentWs(o.workspace);if(!(n=n.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;for(var a=(o.workspace.targetWorkspace||o.workspace).getAllBlocks(!1),h=n.toLowerCase(),R=0;R<a.length;R++)if(a[R].id!=this.getSourceBlock().id){var L=a[R].getFieldValue("NAME");if(L&&L.toLowerCase()==h)return null}return o.isInFlyout||((o=r.getVariable(n,""))&&o.name!=n&&r.renameVariableById(o.getId(),n),o||(o=r.createVariable(n,""))&&this.createdVariables_&&this.createdVariables_.push(o)),n},deleteIntermediateVars_:function(n){var o=t.Mutator.findParentWs(this.getSourceBlock().workspace);if(o)for(var r=0;r<this.createdVariables_.length;r++){var a=this.createdVariables_[r];a.name!=n&&o.deleteVariableById(a.getId())}}},t.Blocks.procedures_callnoreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(n,o){t.Names.equals(n,this.getProcedureCall())&&(this.setFieldValue(o,"NAME"),this.setTooltip((this.outputConnection?t.Msg.PROCEDURES_CALLRETURN_TOOLTIP:t.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",o)))},setProcedureParameters_:function(n,o){var r=t.Procedures.getDefinition(this.getProcedureCall(),this.workspace),a=r&&r.mutator&&r.mutator.isVisible();if(a||(this.quarkConnections_={},this.quarkIds_=null),o)if(n.join("\n")==this.arguments_.join("\n"))this.quarkIds_=o;else{if(o.length!=n.length)throw RangeError("paramNames and paramIds must be the same length.");this.setCollapsed(!1),this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),r=this.rendered,this.rendered=!1;for(var h=0;h<this.arguments_.length;h++){var R=this.getInput("ARG"+h);R&&(this.quarkConnections_[this.quarkIds_[h]]=R=R.connection.targetConnection,a&&R&&-1==o.indexOf(this.quarkIds_[h])&&(R.disconnect(),R.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(n),this.argumentVarModels_=[],h=0;h<this.arguments_.length;h++)n=t.Variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[h],""),this.argumentVarModels_.push(n);if(this.updateShape_(),this.quarkIds_=o)for(h=0;h<this.arguments_.length;h++)(o=this.quarkIds_[h])in this.quarkConnections_&&(t.Mutator.reconnect(R=this.quarkConnections_[o],this,"ARG"+h)||delete this.quarkConnections_[o]);(this.rendered=r)&&this.render()}},updateShape_:function(){for(var n=0;n<this.arguments_.length;n++){var o=this.getField("ARGNAME"+n);if(o){t.Events.disable();try{o.setValue(this.arguments_[n])}finally{t.Events.enable()}}else o=new t.FieldLabel(this.arguments_[n]),this.appendValueInput("ARG"+n).setAlign(t.ALIGN_RIGHT).appendField(o,"ARGNAME"+n).init()}for(;this.getInput("ARG"+n);)this.removeInput("ARG"+n),n++;(n=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(n.appendField(t.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),n.init()):this.getField("WITH")&&n.removeField("WITH"))},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");n.setAttribute("name",this.getProcedureCall());for(var o=0;o<this.arguments_.length;o++){var r=t.utils.xml.createElement("arg");r.setAttribute("name",this.arguments_[o]),n.appendChild(r)}return n},domToMutation:function(n){var o=n.getAttribute("name");this.renameProcedure(this.getProcedureCall(),o),o=[];for(var h,r=[],a=0;h=n.childNodes[a];a++)"arg"==h.nodeName.toLowerCase()&&(o.push(h.getAttribute("name")),r.push(h.getAttribute("paramId")));this.setProcedureParameters_(o,r)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(n){if(this.workspace&&!this.workspace.isFlyout&&n.recordUndo)if(n.type==t.Events.BLOCK_CREATE&&-1!=n.ids.indexOf(this.id)){var o=this.getProcedureCall();if(!(o=t.Procedures.getDefinition(o,this.workspace))||o.type==this.defType_&&JSON.stringify(o.getVars())==JSON.stringify(this.arguments_)||(o=null),!o){t.Events.setGroup(n.group),n=t.utils.xml.createElement("xml"),(o=t.utils.xml.createElement("block")).setAttribute("type",this.defType_);var r=this.getRelativeToSurfaceXY(),a=r.y+2*t.SNAP_RADIUS;o.setAttribute("x",r.x+t.SNAP_RADIUS*(this.RTL?-1:1)),o.setAttribute("y",a),r=this.mutationToDom(),o.appendChild(r),(r=t.utils.xml.createElement("field")).setAttribute("name","NAME"),(a=this.getProcedureCall())||(a=t.Procedures.findLegalName("",this),this.renameProcedure("",a)),r.appendChild(t.utils.xml.createTextNode(a)),o.appendChild(r),n.appendChild(o),t.Xml.domToWorkspace(n,this.workspace),t.Events.setGroup(!1)}}else n.type==t.Events.BLOCK_DELETE?(o=this.getProcedureCall(),(o=t.Procedures.getDefinition(o,this.workspace))||(t.Events.setGroup(n.group),this.dispose(!0),t.Events.setGroup(!1))):n.type==t.Events.CHANGE&&"disabled"==n.element&&(o=this.getProcedureCall(),(o=t.Procedures.getDefinition(o,this.workspace))&&o.id==n.blockId&&((o=t.Events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),t.Events.setGroup(n.group),n.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),t.Events.setGroup(o)))},customContextMenu:function(n){if(this.workspace.isMovable()){var o={enabled:!0};o.text=t.Msg.PROCEDURES_HIGHLIGHT_DEF;var r=this.getProcedureCall(),a=this.workspace;o.callback=function(){var h=t.Procedures.getDefinition(r,a);h&&(a.centerOnBlock(h.id),h.select())},n.push(o)}},defType_:"procedures_defnoreturn"},t.Blocks.procedures_callreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:t.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:t.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:t.Blocks.procedures_callnoreturn.setProcedureParameters_,updateShape_:t.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:t.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:t.Blocks.procedures_callnoreturn.domToMutation,getVars:t.Blocks.procedures_callnoreturn.getVars,getVarModels:t.Blocks.procedures_callnoreturn.getVarModels,onchange:t.Blocks.procedures_callnoreturn.onchange,customContextMenu:t.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defreturn"},t.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(t.Msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("value",Number(this.hasReturnValue_)),n},domToMutation:function(n){this.hasReturnValue_=1==n.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(n){if(this.workspace.isDragging&&!this.workspace.isDragging()){n=!1;var o=this;do{if(-1!=this.FUNCTION_TYPES.indexOf(o.type)){n=!0;break}o=o.getSurroundParent()}while(o);n?("procedures_defnoreturn"==o.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!=o.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setEnabled(!0)):(this.setWarningText(t.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setEnabled(!1))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},t.Blocks.texts={},t.Constants.Text={},t.Constants.Text.HUE=160,t.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"\xb6"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),t.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[t.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[t.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[t.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[t.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[t.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(t.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(t.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o=this.getInput("AT1").type==t.INPUT_VALUE;return n.setAttribute("at1",o),o=this.getInput("AT2").type==t.INPUT_VALUE,n.setAttribute("at2",o),n},domToMutation:function(n){var o="true"==n.getAttribute("at1");n="true"==n.getAttribute("at2"),this.updateAt_(1,o),this.updateAt_(2,n)},updateAt_:function(n,o){this.removeInput("AT"+n),this.removeInput("ORDINAL"+n,!0),o?(this.appendValueInput("AT"+n).setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+n).appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+n),2==n&&t.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg.TEXT_GET_SUBSTRING_TAIL));var r=new t.FieldDropdown(this["WHERE_OPTIONS_"+n],function(a){var h="FROM_START"==a||"FROM_END"==a;if(h!=o){var R=this.getSourceBlock();return R.updateAt_(n,h),R.setFieldValue(a,"WHERE"+n),null}});this.getInput("AT"+n).appendField(r,"WHERE"+n),1==n&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},t.Blocks.text_changeCase={init:function(){var n=[[t.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[t.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[t.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(t.Msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new t.FieldDropdown(n),"CASE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg.TEXT_CHANGECASE_TOOLTIP)}},t.Blocks.text_trim={init:function(){var n=[[t.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[t.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[t.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(t.Msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new t.FieldDropdown(n),"MODE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg.TEXT_TRIM_TOOLTIP)}},t.Blocks.text_print={init:function(){this.jsonInit({message0:t.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:t.Msg.TEXT_PRINT_TOOLTIP,helpUrl:t.Msg.TEXT_PRINT_HELPURL})}},t.Blocks.text_prompt_ext={init:function(){var n=[[t.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");var o=this;n=new t.FieldDropdown(n,function(r){o.updateType_(r)}),this.appendValueInput("TEXT").appendField(n,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==o.getFieldValue("TYPE")?t.Msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:function(n){this.outputConnection.setCheck("NUMBER"==n?"Number":"String")},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("type",this.getFieldValue("TYPE")),n},domToMutation:function(n){this.updateType_(n.getAttribute("type"))}},t.Blocks.text_prompt={init:function(){this.mixin(t.Constants.Text.QUOTE_IMAGE_MIXIN);var n=[[t.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],o=this;this.setHelpUrl(t.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),n=new t.FieldDropdown(n,function(r){o.updateType_(r)}),this.appendDummyInput().appendField(n,"TYPE").appendField(this.newQuote_(!0)).appendField(new t.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==o.getFieldValue("TYPE")?t.Msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:t.Blocks.text_prompt_ext.updateType_,mutationToDom:t.Blocks.text_prompt_ext.mutationToDom,domToMutation:t.Blocks.text_prompt_ext.domToMutation},t.Blocks.text_count={init:function(){this.jsonInit({message0:t.Msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:t.Msg.TEXT_COUNT_TOOLTIP,helpUrl:t.Msg.TEXT_COUNT_HELPURL})}},t.Blocks.text_replace={init:function(){this.jsonInit({message0:t.Msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg.TEXT_REPLACE_TOOLTIP,helpUrl:t.Msg.TEXT_REPLACE_HELPURL})}},t.Blocks.text_reverse={init:function(){this.jsonInit({message0:t.Msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg.TEXT_REVERSE_TOOLTIP,helpUrl:t.Msg.TEXT_REVERSE_HELPURL})}},t.Constants.Text.QUOTE_IMAGE_MIXIN={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(n){for(var r,o=0;r=this.inputList[o];o++)for(var h,a=0;h=r.fieldRow[a];a++)if(n==h.name)return r.insertFieldAt(a,this.newQuote_(!0)),void r.insertFieldAt(a+2,this.newQuote_(!1));console.warn('field named "'+n+'" not found in '+this.toDevString())},newQuote_:function(n){return new t.FieldImage((n=this.RTL?!n:n)?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,n?"\u201c":"\u201d")}},t.Constants.Text.TEXT_QUOTES_EXTENSION=function(){this.mixin(t.Constants.Text.QUOTE_IMAGE_MIXIN),this.quoteField_("TEXT")},t.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN={mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("items",this.itemCount_),n},domToMutation:function(n){this.itemCount_=parseInt(n.getAttribute("items"),10),this.updateShape_()},decompose:function(n){var o=n.newBlock("text_create_join_container");o.initSvg();for(var r=o.getInput("STACK").connection,a=0;a<this.itemCount_;a++){var h=n.newBlock("text_create_join_item");h.initSvg(),r.connect(h.previousConnection),r=h.nextConnection}return o},compose:function(n){var o=n.getInputTargetBlock("STACK");for(n=[];o&&!o.isInsertionMarker();)n.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();for(o=0;o<this.itemCount_;o++){var r=this.getInput("ADD"+o).connection.targetConnection;r&&-1==n.indexOf(r)&&r.disconnect()}for(this.itemCount_=n.length,this.updateShape_(),o=0;o<this.itemCount_;o++)t.Mutator.reconnect(n[o],this,"ADD"+o)},saveConnections:function(n){n=n.getInputTargetBlock("STACK");for(var o=0;n;){var r=this.getInput("ADD"+o);n.valueConnection_=r&&r.connection.targetConnection,o++,n=n.nextConnection&&n.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var n=0;n<this.itemCount_;n++)if(!this.getInput("ADD"+n)){var o=this.appendValueInput("ADD"+n).setAlign(t.ALIGN_RIGHT);0==n&&o.appendField(t.Msg.TEXT_JOIN_TITLE_CREATEWITH)}for(;this.getInput("ADD"+n);)this.removeInput("ADD"+n),n++}},t.Constants.Text.TEXT_JOIN_EXTENSION=function(){this.mixin(t.Constants.Text.QUOTE_IMAGE_MIXIN),this.itemCount_=2,this.updateShape_(),this.setMutator(new t.Mutator(["text_create_join_item"]))},t.Extensions.register("text_append_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),t.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION=function(){var n=this;this.setTooltip(function(){return t.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",n.workspace.options.oneBasedIndex?"0":"-1")})},t.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN={mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("at",!!this.isAt_),n},domToMutation:function(n){n="false"!=n.getAttribute("at"),this.updateAt_(n)},updateAt_:function(n){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),n&&(this.appendValueInput("AT").setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)),t.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg.TEXT_CHARAT_TAIL)),this.isAt_=n}},t.Constants.Text.TEXT_CHARAT_EXTENSION=function(){this.getField("WHERE").setValidator(function(o){(o="FROM_START"==o||"FROM_END"==o)!=this.isAt_&&this.getSourceBlock().updateAt_(o)}),this.updateAt_(!0);var n=this;this.setTooltip(function(){var o=n.getFieldValue("WHERE"),r=t.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"==o||"FROM_END"==o)&&(o="FROM_START"==o?t.Msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(r+="  "+o.replace("%1",n.workspace.options.oneBasedIndex?"#1":"#0")),r})},t.Extensions.register("text_indexOf_tooltip",t.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION),t.Extensions.register("text_quotes",t.Constants.Text.TEXT_QUOTES_EXTENSION),t.Extensions.registerMutator("text_join_mutator",t.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN,t.Constants.Text.TEXT_JOIN_EXTENSION),t.Extensions.registerMutator("text_charAt_mutator",t.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN,t.Constants.Text.TEXT_CHARAT_EXTENSION),t.Blocks.variables={},t.Constants.Variables={},t.Constants.Variables.HUE=330,t.defineBlocksWithJsonArray([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),t.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(n){if(this.isInFlyout)("variables_get"==this.type||"variables_get_reporter"==this.type)&&(o={text:t.Msg.RENAME_VARIABLE,enabled:!0,callback:t.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},h=this.getField("VAR").getText(),a={text:t.Msg.DELETE_VARIABLE.replace("%1",h),enabled:!0,callback:t.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},n.unshift(o),n.unshift(a));else{if("variables_get"==this.type)var o="variables_set",r=t.Msg.VARIABLES_GET_CREATE_SET;else o="variables_get",r=t.Msg.VARIABLES_SET_CREATE_GET;var a={enabled:0<this.workspace.remainingCapacity()},h=this.getField("VAR").getText();a.text=r.replace("%1",h),(r=t.utils.xml.createElement("field")).setAttribute("name","VAR"),r.appendChild(t.utils.xml.createTextNode(h)),(h=t.utils.xml.createElement("block")).setAttribute("type",o),h.appendChild(r),a.callback=t.ContextMenu.callbackFactory(this,h),n.push(a)}}},t.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();t.Variables.renameVariable(o,r)}},t.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();o.deleteVariableById(r.getId()),o.refreshToolboxSelection()}},t.Extensions.registerMixin("contextMenu_variableSetterGetter",t.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),t.Constants.VariablesDynamic={},t.Constants.VariablesDynamic.HUE=310,t.defineBlocksWithJsonArray([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),t.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(n){if(this.isInFlyout)("variables_get_dynamic"==this.type||"variables_get_reporter_dynamic"==this.type)&&(o={text:t.Msg.RENAME_VARIABLE,enabled:!0,callback:t.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},R=this.getField("VAR").getText(),h={text:t.Msg.DELETE_VARIABLE.replace("%1",R),enabled:!0,callback:t.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},n.unshift(o),n.unshift(h));else{var o=this.getFieldValue("VAR"),r=this.workspace.getVariableById(o).type;if("variables_get_dynamic"==this.type){o="variables_set_dynamic";var a=t.Msg.VARIABLES_GET_CREATE_SET}else o="variables_get_dynamic",a=t.Msg.VARIABLES_SET_CREATE_GET;var h={enabled:0<this.workspace.remainingCapacity()},R=this.getField("VAR").getText();h.text=a.replace("%1",R),(a=t.utils.xml.createElement("field")).setAttribute("name","VAR"),a.setAttribute("variabletype",r),a.appendChild(t.utils.xml.createTextNode(R)),(R=t.utils.xml.createElement("block")).setAttribute("type",o),R.appendChild(a),h.callback=t.ContextMenu.callbackFactory(this,R),n.push(h)}},onchange:function(n){n=this.getFieldValue("VAR"),n=t.Variables.getVariable(this.workspace,n),"variables_get_dynamic"==this.type?this.outputConnection.setCheck(n.type):this.getInput("VALUE").connection.setCheck(n.type)}},t.Constants.VariablesDynamic.RENAME_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();t.Variables.renameVariable(o,r)}},t.Constants.VariablesDynamic.DELETE_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();o.deleteVariableById(r.getId()),o.refreshToolboxSelection()}},t.Extensions.registerMixin("contextMenu_variableDynamicSetterGetter",t.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),t.Blocks}.apply(X,m))&&(B.exports=e)},25552:function(B,X,_){var m,e;m=[_(68210),_(63266),_(18783),_(30069)],void 0!==(e=function(t,n,o,r){"use strict";return t.setLocale(n),t.Blocks=t.Blocks||{},Object.keys(o).forEach(function(a){t.Blocks[a]=o[a]}),t.JavaScript=r,t}.apply(X,m))&&(B.exports=e)},68210:function(B,X,_){var m,e;m=[_(86931)],void 0!==(e=function(t){"use strict";return t.setLocale=function(n){t.Msg=t.Msg||{},Object.keys(n).forEach(function(o){t.Msg[o]=n[o]})},t}.apply(X,m))&&(B.exports=e)},76279:function(B,X,_){var m,e;m=[_(25552)],void 0!==(e=function(t){"use strict";return t}.apply(X,m))&&(B.exports=e)},30069:function(B,X,_){var m,e;m=[_(68210),_(69957)],void 0!==(e=function(t,n){"use strict";return t.JavaScript=n,n}.apply(X,m))&&(B.exports=e)},69957:function(B,X,_){var m,e;m=[_(81069)],void 0!==(e=function(t){"use strict";return t.JavaScript=new t.Generator("JavaScript"),t.JavaScript.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(t.utils.global).join(",")),t.JavaScript.ORDER_ATOMIC=0,t.JavaScript.ORDER_NEW=1.1,t.JavaScript.ORDER_MEMBER=1.2,t.JavaScript.ORDER_FUNCTION_CALL=2,t.JavaScript.ORDER_INCREMENT=3,t.JavaScript.ORDER_DECREMENT=3,t.JavaScript.ORDER_BITWISE_NOT=4.1,t.JavaScript.ORDER_UNARY_PLUS=4.2,t.JavaScript.ORDER_UNARY_NEGATION=4.3,t.JavaScript.ORDER_LOGICAL_NOT=4.4,t.JavaScript.ORDER_TYPEOF=4.5,t.JavaScript.ORDER_VOID=4.6,t.JavaScript.ORDER_DELETE=4.7,t.JavaScript.ORDER_AWAIT=4.8,t.JavaScript.ORDER_EXPONENTIATION=5,t.JavaScript.ORDER_MULTIPLICATION=5.1,t.JavaScript.ORDER_DIVISION=5.2,t.JavaScript.ORDER_MODULUS=5.3,t.JavaScript.ORDER_SUBTRACTION=6.1,t.JavaScript.ORDER_ADDITION=6.2,t.JavaScript.ORDER_BITWISE_SHIFT=7,t.JavaScript.ORDER_RELATIONAL=8,t.JavaScript.ORDER_IN=8,t.JavaScript.ORDER_INSTANCEOF=8,t.JavaScript.ORDER_EQUALITY=9,t.JavaScript.ORDER_BITWISE_AND=10,t.JavaScript.ORDER_BITWISE_XOR=11,t.JavaScript.ORDER_BITWISE_OR=12,t.JavaScript.ORDER_LOGICAL_AND=13,t.JavaScript.ORDER_LOGICAL_OR=14,t.JavaScript.ORDER_CONDITIONAL=15,t.JavaScript.ORDER_ASSIGNMENT=16,t.JavaScript.ORDER_YIELD=17,t.JavaScript.ORDER_COMMA=18,t.JavaScript.ORDER_NONE=99,t.JavaScript.ORDER_OVERRIDES=[[t.JavaScript.ORDER_FUNCTION_CALL,t.JavaScript.ORDER_MEMBER],[t.JavaScript.ORDER_FUNCTION_CALL,t.JavaScript.ORDER_FUNCTION_CALL],[t.JavaScript.ORDER_MEMBER,t.JavaScript.ORDER_MEMBER],[t.JavaScript.ORDER_MEMBER,t.JavaScript.ORDER_FUNCTION_CALL],[t.JavaScript.ORDER_LOGICAL_NOT,t.JavaScript.ORDER_LOGICAL_NOT],[t.JavaScript.ORDER_MULTIPLICATION,t.JavaScript.ORDER_MULTIPLICATION],[t.JavaScript.ORDER_ADDITION,t.JavaScript.ORDER_ADDITION],[t.JavaScript.ORDER_LOGICAL_AND,t.JavaScript.ORDER_LOGICAL_AND],[t.JavaScript.ORDER_LOGICAL_OR,t.JavaScript.ORDER_LOGICAL_OR]],t.JavaScript.isInitialized=!1,t.JavaScript.init=function(n){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new t.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(n.getVariableMap()),this.nameDB_.populateVariables(n),this.nameDB_.populateProcedures(n);for(var o=[],r=t.Variables.allDeveloperVariables(n),a=0;a<r.length;a++)o.push(this.nameDB_.getName(r[a],t.Names.DEVELOPER_VARIABLE_TYPE));for(n=t.Variables.allUsedVarModels(n),a=0;a<n.length;a++)o.push(this.nameDB_.getName(n[a].getId(),t.VARIABLE_CATEGORY_NAME));o.length&&(this.definitions_.variables="var "+o.join(", ")+";"),this.isInitialized=!0},t.JavaScript.finish=function(n){var o=t.utils.object.values(this.definitions_);return n=Object.getPrototypeOf(this).finish.call(this,n),this.isInitialized=!1,this.nameDB_.reset(),o.join("\n\n")+"\n\n\n"+n},t.JavaScript.scrubNakedValue=function(n){return n+";\n"},t.JavaScript.quote_=function(n){return"'"+(n=n.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},t.JavaScript.multiline_quote_=function(n){return n.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")},t.JavaScript.scrub_=function(n,o,r){var a="";if(!n.outputConnection||!n.outputConnection.targetConnection){var h=n.getCommentText();h&&(h=t.utils.string.wrap(h,this.COMMENT_WRAP-3),a+=this.prefixLines(h+"\n","// "));for(var R=0;R<n.inputList.length;R++)n.inputList[R].type==t.inputTypes.VALUE&&(h=n.inputList[R].connection.targetBlock())&&(h=this.allNestedComments(h))&&(a+=this.prefixLines(h,"// "))}return n=n.nextConnection&&n.nextConnection.targetBlock(),a+o+(r?"":this.blockToCode(n))},t.JavaScript.getAdjusted=function(n,o,r,a,h){r=r||0,h=h||this.ORDER_NONE,n.workspace.options.oneBasedIndex&&r--;var R=n.workspace.options.oneBasedIndex?"1":"0";if(n=0<r?this.valueToCode(n,o,this.ORDER_ADDITION)||R:0>r?this.valueToCode(n,o,this.ORDER_SUBTRACTION)||R:a?this.valueToCode(n,o,this.ORDER_UNARY_NEGATION)||R:this.valueToCode(n,o,h)||R,t.isNumber(n))n=Number(n)+r,a&&(n=-n);else{if(0<r){n=n+" + "+r;var L=this.ORDER_ADDITION}else 0>r&&(n=n+" - "+-r,L=this.ORDER_SUBTRACTION);a&&(n=r?"-("+n+")":"-"+n,L=this.ORDER_UNARY_NEGATION),L=Math.floor(L),h=Math.floor(h),L&&h>=L&&(n="("+n+")")}return n},t.JavaScript.colour={},t.JavaScript.colour_picker=function(n){return[t.JavaScript.quote_(n.getFieldValue("COLOUR")),t.JavaScript.ORDER_ATOMIC]},t.JavaScript.colour_random=function(n){return[t.JavaScript.provideFunction_("colourRandom",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.colour_rgb=function(n){var o=t.JavaScript.valueToCode(n,"RED",t.JavaScript.ORDER_NONE)||0,r=t.JavaScript.valueToCode(n,"GREEN",t.JavaScript.ORDER_NONE)||0;return n=t.JavaScript.valueToCode(n,"BLUE",t.JavaScript.ORDER_NONE)||0,[t.JavaScript.provideFunction_("colourRgb",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+o+", "+r+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.colour_blend=function(n){var o=t.JavaScript.valueToCode(n,"COLOUR1",t.JavaScript.ORDER_NONE)||"'#000000'",r=t.JavaScript.valueToCode(n,"COLOUR2",t.JavaScript.ORDER_NONE)||"'#000000'";return n=t.JavaScript.valueToCode(n,"RATIO",t.JavaScript.ORDER_NONE)||.5,[t.JavaScript.provideFunction_("colourBlend",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+o+", "+r+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists={},t.JavaScript.lists_create_empty=function(n){return["[]",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.lists_create_with=function(n){for(var o=Array(n.itemCount_),r=0;r<n.itemCount_;r++)o[r]=t.JavaScript.valueToCode(n,"ADD"+r,t.JavaScript.ORDER_NONE)||"null";return["["+o.join(", ")+"]",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.lists_repeat=function(n){return[t.JavaScript.provideFunction_("listsRepeat",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"])+"("+(t.JavaScript.valueToCode(n,"ITEM",t.JavaScript.ORDER_NONE)||"null")+", "+(n=t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_NONE)||"0")+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_length=function(n){return[(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"[]")+".length",t.JavaScript.ORDER_MEMBER]},t.JavaScript.lists_isEmpty=function(n){return["!"+(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"[]")+".length",t.JavaScript.ORDER_LOGICAL_NOT]},t.JavaScript.lists_indexOf=function(n){var o="FIRST"==n.getFieldValue("END")?"indexOf":"lastIndexOf",r=t.JavaScript.valueToCode(n,"FIND",t.JavaScript.ORDER_NONE)||"''";return o=(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"[]")+"."+o+"("+r+")",n.workspace.options.oneBasedIndex?[o+" + 1",t.JavaScript.ORDER_ADDITION]:[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_getIndex=function(n){var o=n.getFieldValue("MODE")||"GET",r=n.getFieldValue("WHERE")||"FROM_START",a=t.JavaScript.valueToCode(n,"VALUE","RANDOM"==r?t.JavaScript.ORDER_NONE:t.JavaScript.ORDER_MEMBER)||"[]";switch(r){case"FIRST":if("GET"==o)return[a+"[0]",t.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[a+".shift()",t.JavaScript.ORDER_MEMBER];if("REMOVE"==o)return a+".shift();\n";break;case"LAST":if("GET"==o)return[a+".slice(-1)[0]",t.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[a+".pop()",t.JavaScript.ORDER_MEMBER];if("REMOVE"==o)return a+".pop();\n";break;case"FROM_START":if(n=t.JavaScript.getAdjusted(n,"AT"),"GET"==o)return[a+"["+n+"]",t.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[a+".splice("+n+", 1)[0]",t.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return a+".splice("+n+", 1);\n";break;case"FROM_END":if(n=t.JavaScript.getAdjusted(n,"AT",1,!0),"GET"==o)return[a+".slice("+n+")[0]",t.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"==o)return[a+".splice("+n+", 1)[0]",t.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return a+".splice("+n+", 1);";break;case"RANDOM":if(a=t.JavaScript.provideFunction_("listsGetRandomItem",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+a+", "+("GET"!=o)+")","GET"==o||"GET_REMOVE"==o)return[a,t.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return a+";\n"}throw Error("Unhandled combination (lists_getIndex).")},t.JavaScript.lists_setIndex=function(n){function o(){if(r.match(/^\w+$/))return"";var L=t.JavaScript.nameDB_.getDistinctName("tmpList",t.VARIABLE_CATEGORY_NAME),W="var "+L+" = "+r+";\n";return r=L,W}var r=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_MEMBER)||"[]",a=n.getFieldValue("MODE")||"GET",h=n.getFieldValue("WHERE")||"FROM_START",R=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_ASSIGNMENT)||"null";switch(h){case"FIRST":if("SET"==a)return r+"[0] = "+R+";\n";if("INSERT"==a)return r+".unshift("+R+");\n";break;case"LAST":if("SET"==a)return(n=o())+(r+"[")+r+".length - 1] = "+R+";\n";if("INSERT"==a)return r+".push("+R+");\n";break;case"FROM_START":if(h=t.JavaScript.getAdjusted(n,"AT"),"SET"==a)return r+"["+h+"] = "+R+";\n";if("INSERT"==a)return r+".splice("+h+", 0, "+R+");\n";break;case"FROM_END":if(h=t.JavaScript.getAdjusted(n,"AT",1,!1,t.JavaScript.ORDER_SUBTRACTION),n=o(),"SET"==a)return n+(r+"[")+r+".length - "+h+"] = "+R+";\n";if("INSERT"==a)return n+(r+".splice(")+r+".length - "+h+", 0, "+R+");\n";break;case"RANDOM":if(n=o(),n+="var "+(h=t.JavaScript.nameDB_.getDistinctName("tmpX",t.VARIABLE_CATEGORY_NAME))+" = Math.floor(Math.random() * "+r+".length);\n","SET"==a)return n+(r+"[")+h+"] = "+R+";\n";if("INSERT"==a)return n+(r+".splice(")+h+", 0, "+R+");\n"}throw Error("Unhandled combination (lists_setIndex).")},t.JavaScript.lists.getIndex_=function(n,o,r){return"FIRST"==o?"0":"FROM_END"==o?n+".length - 1 - "+r:"LAST"==o?n+".length - 1":r},t.JavaScript.lists_getSublist=function(n){var o=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_MEMBER)||"[]",r=n.getFieldValue("WHERE1"),a=n.getFieldValue("WHERE2");if("FIRST"==r&&"LAST"==a)o+=".slice(0)";else if(o.match(/^\w+$/)||"FROM_END"!=r&&"FROM_START"==a){switch(r){case"FROM_START":var h=t.JavaScript.getAdjusted(n,"AT1");break;case"FROM_END":h=o+".length - "+(h=t.JavaScript.getAdjusted(n,"AT1",1,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":h="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(a){case"FROM_START":n=t.JavaScript.getAdjusted(n,"AT2",1);break;case"FROM_END":n=o+".length - "+(n=t.JavaScript.getAdjusted(n,"AT2",0,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"LAST":n=o+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}o=o+".slice("+h+", "+n+")"}else{h=t.JavaScript.getAdjusted(n,"AT1"),n=t.JavaScript.getAdjusted(n,"AT2");var R=t.JavaScript.lists.getIndex_,L={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};o=t.JavaScript.provideFunction_("subsequence"+L[r]+L[a],["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==r||"FROM_START"==r?", at1":"")+("FROM_END"==a||"FROM_START"==a?", at2":"")+") {","  var start = "+R("sequence",r,"at1")+";","  var end = "+R("sequence",a,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+o+("FROM_END"==r||"FROM_START"==r?", "+h:"")+("FROM_END"==a||"FROM_START"==a?", "+n:"")+")"}return[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_sort=function(n){var o=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_FUNCTION_CALL)||"[]",r="1"===n.getFieldValue("DIRECTION")?1:-1;return n=n.getFieldValue("TYPE"),[o+".slice().sort("+t.JavaScript.provideFunction_("listsGetSortCompare",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+n+'", '+r+"))",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_split=function(n){var o=t.JavaScript.valueToCode(n,"INPUT",t.JavaScript.ORDER_MEMBER),r=t.JavaScript.valueToCode(n,"DELIM",t.JavaScript.ORDER_NONE)||"''";if("SPLIT"==(n=n.getFieldValue("MODE")))o||(o="''"),n="split";else{if("JOIN"!=n)throw Error("Unknown mode: "+n);o||(o="[]"),n="join"}return[o+"."+n+"("+r+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_reverse=function(n){return[(t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.logic={},t.JavaScript.controls_if=function(n){var o=0,r="";t.JavaScript.STATEMENT_PREFIX&&(r+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,n));do{var a=t.JavaScript.valueToCode(n,"IF"+o,t.JavaScript.ORDER_NONE)||"false",h=t.JavaScript.statementToCode(n,"DO"+o);t.JavaScript.STATEMENT_SUFFIX&&(h=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n),t.JavaScript.INDENT)+h),r+=(0<o?" else ":"")+"if ("+a+") {\n"+h+"}",++o}while(n.getInput("IF"+o));return(n.getInput("ELSE")||t.JavaScript.STATEMENT_SUFFIX)&&(h=t.JavaScript.statementToCode(n,"ELSE"),t.JavaScript.STATEMENT_SUFFIX&&(h=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n),t.JavaScript.INDENT)+h),r+=" else {\n"+h+"}"),r+"\n"},t.JavaScript.controls_ifelse=t.JavaScript.controls_if,t.JavaScript.logic_compare=function(n){var o={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[n.getFieldValue("OP")],r="=="==o||"!="==o?t.JavaScript.ORDER_EQUALITY:t.JavaScript.ORDER_RELATIONAL;return[(t.JavaScript.valueToCode(n,"A",r)||"0")+" "+o+" "+(n=t.JavaScript.valueToCode(n,"B",r)||"0"),r]},t.JavaScript.logic_operation=function(n){var o="AND"==n.getFieldValue("OP")?"&&":"||",r="&&"==o?t.JavaScript.ORDER_LOGICAL_AND:t.JavaScript.ORDER_LOGICAL_OR,a=t.JavaScript.valueToCode(n,"A",r);if(n=t.JavaScript.valueToCode(n,"B",r),a||n){var h="&&"==o?"true":"false";a||(a=h),n||(n=h)}else n=a="false";return[a+" "+o+" "+n,r]},t.JavaScript.logic_negate=function(n){var o=t.JavaScript.ORDER_LOGICAL_NOT;return["!"+(t.JavaScript.valueToCode(n,"BOOL",o)||"true"),o]},t.JavaScript.logic_boolean=function(n){return["TRUE"==n.getFieldValue("BOOL")?"true":"false",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.logic_null=function(n){return["null",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.logic_ternary=function(n){return[(t.JavaScript.valueToCode(n,"IF",t.JavaScript.ORDER_CONDITIONAL)||"false")+" ? "+(t.JavaScript.valueToCode(n,"THEN",t.JavaScript.ORDER_CONDITIONAL)||"null")+" : "+(n=t.JavaScript.valueToCode(n,"ELSE",t.JavaScript.ORDER_CONDITIONAL)||"null"),t.JavaScript.ORDER_CONDITIONAL]},t.JavaScript.loops={},t.JavaScript.controls_repeat_ext=function(n){var o=n.getField("TIMES")?String(Number(n.getFieldValue("TIMES"))):t.JavaScript.valueToCode(n,"TIMES",t.JavaScript.ORDER_ASSIGNMENT)||"0",r=t.JavaScript.statementToCode(n,"DO");r=t.JavaScript.addLoopTrap(r,n),n="";var a=t.JavaScript.nameDB_.getDistinctName("count",t.VARIABLE_CATEGORY_NAME),h=o;return o.match(/^\w+$/)||t.isNumber(o)||(n+="var "+(h=t.JavaScript.nameDB_.getDistinctName("repeat_end",t.VARIABLE_CATEGORY_NAME))+" = "+o+";\n"),n+"for (var "+a+" = 0; "+a+" < "+h+"; "+a+"++) {\n"+r+"}\n"},t.JavaScript.controls_repeat=t.JavaScript.controls_repeat_ext,t.JavaScript.controls_whileUntil=function(n){var o="UNTIL"==n.getFieldValue("MODE"),r=t.JavaScript.valueToCode(n,"BOOL",o?t.JavaScript.ORDER_LOGICAL_NOT:t.JavaScript.ORDER_NONE)||"false",a=t.JavaScript.statementToCode(n,"DO");return o&&(r="!"+r),"while ("+r+") {\n"+(a=t.JavaScript.addLoopTrap(a,n))+"}\n"},t.JavaScript.controls_for=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME),r=t.JavaScript.valueToCode(n,"FROM",t.JavaScript.ORDER_ASSIGNMENT)||"0",a=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_ASSIGNMENT)||"0",h=t.JavaScript.valueToCode(n,"BY",t.JavaScript.ORDER_ASSIGNMENT)||"1",R=t.JavaScript.statementToCode(n,"DO");if(R=t.JavaScript.addLoopTrap(R,n),t.isNumber(r)&&t.isNumber(a)&&t.isNumber(h)){var L=Number(r)<=Number(a);n="for ("+o+" = "+r+"; "+o+(L?" <= ":" >= ")+a+"; "+o,n=(1==(o=Math.abs(Number(h)))?n+(L?"++":"--"):n+(L?" += ":" -= ")+o)+") {\n"+R+"}\n"}else n="",L=r,r.match(/^\w+$/)||t.isNumber(r)||(n+="var "+(L=t.JavaScript.nameDB_.getDistinctName(o+"_start",t.VARIABLE_CATEGORY_NAME))+" = "+r+";\n"),r=a,a.match(/^\w+$/)||t.isNumber(a)||(n+="var "+(r=t.JavaScript.nameDB_.getDistinctName(o+"_end",t.VARIABLE_CATEGORY_NAME))+" = "+a+";\n"),n+="var "+(a=t.JavaScript.nameDB_.getDistinctName(o+"_inc",t.VARIABLE_CATEGORY_NAME))+" = ",n=(n=t.isNumber(h)?n+(Math.abs(h)+";\n"):n+"Math.abs("+h+");\n")+"if ("+L+" > "+r+") {\n"+(t.JavaScript.INDENT+a)+" = -"+a+";\n",n+="}\n",n+="for ("+o+" = "+L+"; "+a+" >= 0 ? "+o+" <= "+r+" : "+o+" >= "+r+"; "+o+" += "+a+") {\n"+R+"}\n";return n},t.JavaScript.controls_forEach=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME),r=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_ASSIGNMENT)||"[]",a=t.JavaScript.statementToCode(n,"DO");a=t.JavaScript.addLoopTrap(a,n),n="";var h=r;return r.match(/^\w+$/)||(n+="var "+(h=t.JavaScript.nameDB_.getDistinctName(o+"_list",t.VARIABLE_CATEGORY_NAME))+" = "+r+";\n"),n+"for (var "+(r=t.JavaScript.nameDB_.getDistinctName(o+"_index",t.VARIABLE_CATEGORY_NAME))+" in "+h+") {\n"+(a=t.JavaScript.INDENT+o+" = "+h+"["+r+"];\n"+a)+"}\n"},t.JavaScript.controls_flow_statements=function(n){var o="";if(t.JavaScript.STATEMENT_PREFIX&&(o+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,n)),t.JavaScript.STATEMENT_SUFFIX&&(o+=t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n)),t.JavaScript.STATEMENT_PREFIX){var r=t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(n);r&&!r.suppressPrefixSuffix&&(o+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,r))}switch(n.getFieldValue("FLOW")){case"BREAK":return o+"break;\n";case"CONTINUE":return o+"continue;\n"}throw Error("Unknown flow statement.")},t.JavaScript.math={},t.JavaScript.math_number=function(n){return[n=Number(n.getFieldValue("NUM")),0<=n?t.JavaScript.ORDER_ATOMIC:t.JavaScript.ORDER_UNARY_NEGATION]},t.JavaScript.math_arithmetic=function(n){var o={ADD:[" + ",t.JavaScript.ORDER_ADDITION],MINUS:[" - ",t.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",t.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",t.JavaScript.ORDER_DIVISION],POWER:[null,t.JavaScript.ORDER_NONE]}[n.getFieldValue("OP")],r=o[0],a=t.JavaScript.valueToCode(n,"A",o=o[1])||"0";return n=t.JavaScript.valueToCode(n,"B",o)||"0",r?[a+r+n,o]:["Math.pow("+a+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_single=function(n){var o=n.getFieldValue("OP");if("NEG"==o)return"-"==(n=t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(n=" "+n),["-"+n,t.JavaScript.ORDER_UNARY_NEGATION];switch(n="SIN"==o||"COS"==o||"TAN"==o?t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_DIVISION)||"0":t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_NONE)||"0",o){case"ABS":var r="Math.abs("+n+")";break;case"ROOT":r="Math.sqrt("+n+")";break;case"LN":r="Math.log("+n+")";break;case"EXP":r="Math.exp("+n+")";break;case"POW10":r="Math.pow(10,"+n+")";break;case"ROUND":r="Math.round("+n+")";break;case"ROUNDUP":r="Math.ceil("+n+")";break;case"ROUNDDOWN":r="Math.floor("+n+")";break;case"SIN":r="Math.sin("+n+" / 180 * Math.PI)";break;case"COS":r="Math.cos("+n+" / 180 * Math.PI)";break;case"TAN":r="Math.tan("+n+" / 180 * Math.PI)"}if(r)return[r,t.JavaScript.ORDER_FUNCTION_CALL];switch(o){case"LOG10":r="Math.log("+n+") / Math.log(10)";break;case"ASIN":r="Math.asin("+n+") / Math.PI * 180";break;case"ACOS":r="Math.acos("+n+") / Math.PI * 180";break;case"ATAN":r="Math.atan("+n+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+o)}return[r,t.JavaScript.ORDER_DIVISION]},t.JavaScript.math_constant=function(n){return{PI:["Math.PI",t.JavaScript.ORDER_MEMBER],E:["Math.E",t.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",t.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",t.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",t.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",t.JavaScript.ORDER_ATOMIC]}[n.getFieldValue("CONSTANT")]},t.JavaScript.math_number_property=function(n){var o=t.JavaScript.valueToCode(n,"NUMBER_TO_CHECK",t.JavaScript.ORDER_MODULUS)||"0",r=n.getFieldValue("PROPERTY");if("PRIME"==r)return[t.JavaScript.provideFunction_("mathIsPrime",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+o+")",t.JavaScript.ORDER_FUNCTION_CALL];switch(r){case"EVEN":var a=o+" % 2 == 0";break;case"ODD":a=o+" % 2 == 1";break;case"WHOLE":a=o+" % 1 == 0";break;case"POSITIVE":a=o+" > 0";break;case"NEGATIVE":a=o+" < 0";break;case"DIVISIBLE_BY":a=o+" % "+(n=t.JavaScript.valueToCode(n,"DIVISOR",t.JavaScript.ORDER_MODULUS)||"0")+" == 0"}return[a,t.JavaScript.ORDER_EQUALITY]},t.JavaScript.math_change=function(n){var o=t.JavaScript.valueToCode(n,"DELTA",t.JavaScript.ORDER_ADDITION)||"0";return(n=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME))+" = (typeof "+n+" == 'number' ? "+n+" : 0) + "+o+";\n"},t.JavaScript.math_round=t.JavaScript.math_single,t.JavaScript.math_trig=t.JavaScript.math_single,t.JavaScript.math_on_list=function(n){var o=n.getFieldValue("OP");switch(o){case"SUM":n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_MEMBER)||"[]",n+=".reduce(function(x, y) {return x + y;})";break;case"MIN":n="Math.min.apply(null, "+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"MAX":n="Math.max.apply(null, "+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"AVERAGE":n=(o=t.JavaScript.provideFunction_("mathMean",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"MEDIAN":n=(o=t.JavaScript.provideFunction_("mathMedian",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"MODE":n=(o=t.JavaScript.provideFunction_("mathModes",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"STD_DEV":n=(o=t.JavaScript.provideFunction_("mathStandardDeviation",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"RANDOM":n=(o=t.JavaScript.provideFunction_("mathRandomList",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+o)}return[n,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_modulo=function(n){return[(t.JavaScript.valueToCode(n,"DIVIDEND",t.JavaScript.ORDER_MODULUS)||"0")+" % "+(n=t.JavaScript.valueToCode(n,"DIVISOR",t.JavaScript.ORDER_MODULUS)||"0"),t.JavaScript.ORDER_MODULUS]},t.JavaScript.math_constrain=function(n){return["Math.min(Math.max("+(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_NONE)||"0")+", "+(t.JavaScript.valueToCode(n,"LOW",t.JavaScript.ORDER_NONE)||"0")+"), "+(n=t.JavaScript.valueToCode(n,"HIGH",t.JavaScript.ORDER_NONE)||"Infinity")+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_random_int=function(n){var o=t.JavaScript.valueToCode(n,"FROM",t.JavaScript.ORDER_NONE)||"0";return n=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_NONE)||"0",[t.JavaScript.provideFunction_("mathRandomInt",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+o+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_random_float=function(n){return["Math.random()",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_atan2=function(n){var o=t.JavaScript.valueToCode(n,"X",t.JavaScript.ORDER_NONE)||"0";return["Math.atan2("+(t.JavaScript.valueToCode(n,"Y",t.JavaScript.ORDER_NONE)||"0")+", "+o+") / Math.PI * 180",t.JavaScript.ORDER_DIVISION]},t.JavaScript.procedures={},t.JavaScript.procedures_defreturn=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("NAME"),t.PROCEDURE_CATEGORY_NAME),r="";t.JavaScript.STATEMENT_PREFIX&&(r+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,n)),t.JavaScript.STATEMENT_SUFFIX&&(r+=t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n)),r&&(r=t.JavaScript.prefixLines(r,t.JavaScript.INDENT));var a="";t.JavaScript.INFINITE_LOOP_TRAP&&(a=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.INFINITE_LOOP_TRAP,n),t.JavaScript.INDENT));var h=t.JavaScript.statementToCode(n,"STACK"),R=t.JavaScript.valueToCode(n,"RETURN",t.JavaScript.ORDER_NONE)||"",L="";h&&R&&(L=r),R&&(R=t.JavaScript.INDENT+"return "+R+";\n");for(var W=[],nt=n.getVars(),et=0;et<nt.length;et++)W[et]=t.JavaScript.nameDB_.getName(nt[et],t.VARIABLE_CATEGORY_NAME);return r="function "+o+"("+W.join(", ")+") {\n"+r+a+h+L+R+"}",r=t.JavaScript.scrub_(n,r),t.JavaScript.definitions_["%"+o]=r,null},t.JavaScript.procedures_defnoreturn=t.JavaScript.procedures_defreturn,t.JavaScript.procedures_callreturn=function(n){for(var o=t.JavaScript.nameDB_.getName(n.getFieldValue("NAME"),t.PROCEDURE_CATEGORY_NAME),r=[],a=n.getVars(),h=0;h<a.length;h++)r[h]=t.JavaScript.valueToCode(n,"ARG"+h,t.JavaScript.ORDER_NONE)||"null";return[o+"("+r.join(", ")+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.procedures_callnoreturn=function(n){return t.JavaScript.procedures_callreturn(n)[0]+";\n"},t.JavaScript.procedures_ifreturn=function(n){var o="if ("+(t.JavaScript.valueToCode(n,"CONDITION",t.JavaScript.ORDER_NONE)||"false")+") {\n";return t.JavaScript.STATEMENT_SUFFIX&&(o+=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n),t.JavaScript.INDENT)),n.hasReturnValue_?(n=t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_NONE)||"null",o+=t.JavaScript.INDENT+"return "+n+";\n"):o+=t.JavaScript.INDENT+"return;\n",o+"}\n"},t.JavaScript.texts={},t.JavaScript.text=function(n){return[t.JavaScript.quote_(n.getFieldValue("TEXT")),t.JavaScript.ORDER_ATOMIC]},t.JavaScript.text_multiline=function(n){var o=-1!=(n=t.JavaScript.multiline_quote_(n.getFieldValue("TEXT"))).indexOf("+")?t.JavaScript.ORDER_ADDITION:t.JavaScript.ORDER_ATOMIC;return[n,o]},t.JavaScript.text.forceString_=function(n){return t.JavaScript.text.forceString_.strRegExp.test(n)?[n,t.JavaScript.ORDER_ATOMIC]:["String("+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/,t.JavaScript.text_join=function(n){switch(n.itemCount_){case 0:return["''",t.JavaScript.ORDER_ATOMIC];case 1:return n=t.JavaScript.valueToCode(n,"ADD0",t.JavaScript.ORDER_NONE)||"''",t.JavaScript.text.forceString_(n);case 2:var o=t.JavaScript.valueToCode(n,"ADD0",t.JavaScript.ORDER_NONE)||"''";return n=t.JavaScript.valueToCode(n,"ADD1",t.JavaScript.ORDER_NONE)||"''",[n=t.JavaScript.text.forceString_(o)[0]+" + "+t.JavaScript.text.forceString_(n)[0],t.JavaScript.ORDER_ADDITION];default:o=Array(n.itemCount_);for(var r=0;r<n.itemCount_;r++)o[r]=t.JavaScript.valueToCode(n,"ADD"+r,t.JavaScript.ORDER_NONE)||"''";return[n="["+o.join(",")+"].join('')",t.JavaScript.ORDER_FUNCTION_CALL]}},t.JavaScript.text_append=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME);return n=t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''",o+" += "+t.JavaScript.text.forceString_(n)[0]+";\n"},t.JavaScript.text_length=function(n){return[(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"''")+".length",t.JavaScript.ORDER_MEMBER]},t.JavaScript.text_isEmpty=function(n){return["!"+(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"''")+".length",t.JavaScript.ORDER_LOGICAL_NOT]},t.JavaScript.text_indexOf=function(n){var o="FIRST"==n.getFieldValue("END")?"indexOf":"lastIndexOf",r=t.JavaScript.valueToCode(n,"FIND",t.JavaScript.ORDER_NONE)||"''";return o=(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"''")+"."+o+"("+r+")",n.workspace.options.oneBasedIndex?[o+" + 1",t.JavaScript.ORDER_ADDITION]:[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_charAt=function(n){var o=n.getFieldValue("WHERE")||"FROM_START",r=t.JavaScript.valueToCode(n,"VALUE","RANDOM"==o?t.JavaScript.ORDER_NONE:t.JavaScript.ORDER_MEMBER)||"''";switch(o){case"FIRST":return[r+".charAt(0)",t.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[r+".slice(-1)",t.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[r+".charAt("+(n=t.JavaScript.getAdjusted(n,"AT"))+")",t.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[r+".slice("+(n=t.JavaScript.getAdjusted(n,"AT",1,!0))+").charAt(0)",t.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[t.JavaScript.provideFunction_("textRandomLetter",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+r+")",t.JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},t.JavaScript.text.getIndex_=function(n,o,r){return"FIRST"==o?"0":"FROM_END"==o?n+".length - 1 - "+r:"LAST"==o?n+".length - 1":r},t.JavaScript.text_getSubstring=function(n){var o=n.getFieldValue("WHERE1"),r=n.getFieldValue("WHERE2"),a="FROM_END"!=o&&"LAST"!=o&&"FROM_END"!=r&&"LAST"!=r,h=t.JavaScript.valueToCode(n,"STRING",a?t.JavaScript.ORDER_MEMBER:t.JavaScript.ORDER_NONE)||"''";if("FIRST"==o&&"LAST"==r)return[h,t.JavaScript.ORDER_NONE];if(h.match(/^'?\w+'?$/)||a){switch(o){case"FROM_START":a=t.JavaScript.getAdjusted(n,"AT1");break;case"FROM_END":a=h+".length - "+(a=t.JavaScript.getAdjusted(n,"AT1",1,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":a="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(r){case"FROM_START":n=t.JavaScript.getAdjusted(n,"AT2",1);break;case"FROM_END":n=h+".length - "+(n=t.JavaScript.getAdjusted(n,"AT2",0,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"LAST":n=h+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}o=h+".slice("+a+", "+n+")"}else{a=t.JavaScript.getAdjusted(n,"AT1"),n=t.JavaScript.getAdjusted(n,"AT2");var R=t.JavaScript.text.getIndex_,L={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};o=t.JavaScript.provideFunction_("subsequence"+L[o]+L[r],["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==o||"FROM_START"==o?", at1":"")+("FROM_END"==r||"FROM_START"==r?", at2":"")+") {","  var start = "+R("sequence",o,"at1")+";","  var end = "+R("sequence",r,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+h+("FROM_END"==o||"FROM_START"==o?", "+a:"")+("FROM_END"==r||"FROM_START"==r?", "+n:"")+")"}return[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_changeCase=function(n){var o={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[n.getFieldValue("CASE")];return n=t.JavaScript.valueToCode(n,"TEXT",o?t.JavaScript.ORDER_MEMBER:t.JavaScript.ORDER_NONE)||"''",[o?n+o:t.JavaScript.provideFunction_("textToTitleCase",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+"("+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_trim=function(n){var o={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[n.getFieldValue("MODE")];return[(t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_MEMBER)||"''")+o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_print=function(n){return"window.alert("+(t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''")+");\n"},t.JavaScript.text_prompt_ext=function(n){var o="window.prompt("+(n.getField("TEXT")?t.JavaScript.quote_(n.getFieldValue("TEXT")):t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''")+")";return"NUMBER"==n.getFieldValue("TYPE")&&(o="Number("+o+")"),[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_prompt=t.JavaScript.text_prompt_ext,t.JavaScript.text_count=function(n){var o=t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''";return n=t.JavaScript.valueToCode(n,"SUB",t.JavaScript.ORDER_NONE)||"''",[t.JavaScript.provideFunction_("textCount",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+o+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_replace=function(n){var o=t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''",r=t.JavaScript.valueToCode(n,"FROM",t.JavaScript.ORDER_NONE)||"''";return n=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_NONE)||"''",[t.JavaScript.provideFunction_("textReplace",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+o+", "+r+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_reverse=function(n){return[(t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_MEMBER)||"''")+".split('').reverse().join('')",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.variables={},t.JavaScript.variables_get=function(n){return[t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME),t.JavaScript.ORDER_ATOMIC]},t.JavaScript.variables_set=function(n){var o=t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_ASSIGNMENT)||"0";return t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME)+" = "+o+";\n"},t.JavaScript.variablesDynamic={},t.JavaScript.variables_get_dynamic=t.JavaScript.variables_get,t.JavaScript.variables_set_dynamic=t.JavaScript.variables_set,t.JavaScript}.apply(X,m))&&(B.exports=e)},63266:function(B,X,_){var m,e;m=[_(68210)],void 0!==(e=function(n){return(n={Msg:{}}).Msg.ADD_COMMENT="Add Comment",n.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",n.Msg.CHANGE_VALUE_TITLE="Change value:",n.Msg.CLEAN_UP="Clean up Blocks",n.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",n.Msg.COLLAPSE_ALL="Collapse Blocks",n.Msg.COLLAPSE_BLOCK="Collapse Block",n.Msg.COLOUR_BLEND_COLOUR1="colour 1",n.Msg.COLOUR_BLEND_COLOUR2="colour 2",n.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",n.Msg.COLOUR_BLEND_RATIO="ratio",n.Msg.COLOUR_BLEND_TITLE="blend",n.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",n.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",n.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",n.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",n.Msg.COLOUR_RANDOM_TITLE="random colour",n.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",n.Msg.COLOUR_RGB_BLUE="blue",n.Msg.COLOUR_RGB_GREEN="green",n.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",n.Msg.COLOUR_RGB_RED="red",n.Msg.COLOUR_RGB_TITLE="colour with",n.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",n.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",n.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",n.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",n.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",n.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",n.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",n.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",n.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",n.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",n.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",n.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",n.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",n.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",n.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",n.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",n.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",n.Msg.CONTROLS_IF_MSG_ELSE="else",n.Msg.CONTROLS_IF_MSG_ELSEIF="else if",n.Msg.CONTROLS_IF_MSG_IF="if",n.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",n.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",n.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",n.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",n.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",n.Msg.CONTROLS_REPEAT_INPUT_DO="do",n.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",n.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",n.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",n.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",n.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",n.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",n.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",n.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",n.Msg.DELETE_BLOCK="Delete Block",n.Msg.DELETE_VARIABLE="Delete the '%1' variable",n.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",n.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",n.Msg.DISABLE_BLOCK="Disable Block",n.Msg.DUPLICATE_BLOCK="Duplicate",n.Msg.DUPLICATE_COMMENT="Duplicate Comment",n.Msg.ENABLE_BLOCK="Enable Block",n.Msg.EXPAND_ALL="Expand Blocks",n.Msg.EXPAND_BLOCK="Expand Block",n.Msg.EXTERNAL_INPUTS="External Inputs",n.Msg.HELP="Help",n.Msg.INLINE_INPUTS="Inline Inputs",n.Msg.IOS_CANCEL="Cancel",n.Msg.IOS_ERROR="Error",n.Msg.IOS_OK="OK",n.Msg.IOS_PROCEDURES_ADD_INPUT="+ Add Input",n.Msg.IOS_PROCEDURES_ALLOW_STATEMENTS="Allow statements",n.Msg.IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR="This function has duplicate inputs.",n.Msg.IOS_PROCEDURES_INPUTS="INPUTS",n.Msg.IOS_VARIABLES_ADD_BUTTON="Add",n.Msg.IOS_VARIABLES_ADD_VARIABLE="+ Add Variable",n.Msg.IOS_VARIABLES_DELETE_BUTTON="Delete",n.Msg.IOS_VARIABLES_EMPTY_NAME_ERROR="You can't use an empty variable name.",n.Msg.IOS_VARIABLES_RENAME_BUTTON="Rename",n.Msg.IOS_VARIABLES_VARIABLE_NAME="Variable name",n.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",n.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",n.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",n.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",n.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",n.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",n.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",n.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",n.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",n.Msg.LISTS_GET_INDEX_FIRST="first",n.Msg.LISTS_GET_INDEX_FROM_END="# from end",n.Msg.LISTS_GET_INDEX_FROM_START="#",n.Msg.LISTS_GET_INDEX_GET="get",n.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",n.Msg.LISTS_GET_INDEX_LAST="last",n.Msg.LISTS_GET_INDEX_RANDOM="random",n.Msg.LISTS_GET_INDEX_REMOVE="remove",n.Msg.LISTS_GET_INDEX_TAIL="",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",n.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",n.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",n.Msg.LISTS_GET_SUBLIST_END_LAST="to last",n.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",n.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",n.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",n.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",n.Msg.LISTS_GET_SUBLIST_TAIL="",n.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",n.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",n.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",n.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",n.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",n.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",n.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",n.Msg.LISTS_INLIST="in list",n.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",n.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",n.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",n.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",n.Msg.LISTS_LENGTH_TITLE="length of %1",n.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",n.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",n.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",n.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",n.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",n.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",n.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",n.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",n.Msg.LISTS_SET_INDEX_INPUT_TO="as",n.Msg.LISTS_SET_INDEX_INSERT="insert at",n.Msg.LISTS_SET_INDEX_SET="set",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",n.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",n.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",n.Msg.LISTS_SORT_ORDER_DESCENDING="descending",n.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",n.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",n.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",n.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",n.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",n.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",n.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",n.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",n.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",n.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",n.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",n.Msg.LOGIC_BOOLEAN_FALSE="false",n.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",n.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",n.Msg.LOGIC_BOOLEAN_TRUE="true",n.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",n.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",n.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",n.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",n.Msg.LOGIC_NEGATE_TITLE="not %1",n.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",n.Msg.LOGIC_NULL="null",n.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",n.Msg.LOGIC_NULL_TOOLTIP="Returns null.",n.Msg.LOGIC_OPERATION_AND="and",n.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",n.Msg.LOGIC_OPERATION_OR="or",n.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",n.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",n.Msg.LOGIC_TERNARY_CONDITION="test",n.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",n.Msg.LOGIC_TERNARY_IF_FALSE="if false",n.Msg.LOGIC_TERNARY_IF_TRUE="if true",n.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",n.Msg.MATH_ADDITION_SYMBOL="+",n.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",n.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",n.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",n.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",n.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",n.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",n.Msg.MATH_CHANGE_TITLE="change %1 by %2",n.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",n.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",n.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03c0 (3.141\u2026), e (2.718\u2026), \u03c6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xbd) (0.707\u2026), or \u221e (infinity).",n.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",n.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",n.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",n.Msg.MATH_DIVISION_SYMBOL="\xf7",n.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",n.Msg.MATH_IS_EVEN="is even",n.Msg.MATH_IS_NEGATIVE="is negative",n.Msg.MATH_IS_ODD="is odd",n.Msg.MATH_IS_POSITIVE="is positive",n.Msg.MATH_IS_PRIME="is prime",n.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",n.Msg.MATH_IS_WHOLE="is whole",n.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",n.Msg.MATH_MODULO_TITLE="remainder of %1 \xf7 %2",n.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",n.Msg.MATH_MULTIPLICATION_SYMBOL="\xd7",n.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",n.Msg.MATH_NUMBER_TOOLTIP="A number.",n.Msg.MATH_ONLIST_HELPURL="",n.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",n.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",n.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",n.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",n.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",n.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",n.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",n.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",n.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",n.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",n.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",n.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",n.Msg.MATH_POWER_SYMBOL="^",n.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",n.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",n.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",n.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",n.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",n.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",n.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",n.Msg.MATH_ROUND_OPERATOR_ROUND="round",n.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",n.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",n.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",n.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",n.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",n.Msg.MATH_SINGLE_OP_ROOT="square root",n.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",n.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",n.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",n.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",n.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",n.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",n.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",n.Msg.MATH_SUBTRACTION_SYMBOL="-",n.Msg.MATH_TRIG_ACOS="acos",n.Msg.MATH_TRIG_ASIN="asin",n.Msg.MATH_TRIG_ATAN="atan",n.Msg.MATH_TRIG_COS="cos",n.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",n.Msg.MATH_TRIG_SIN="sin",n.Msg.MATH_TRIG_TAN="tan",n.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",n.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",n.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",n.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",n.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",n.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",n.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",n.Msg.NEW_NUMBER_VARIABLE="Create number variable...",n.Msg.NEW_STRING_VARIABLE="Create string variable...",n.Msg.NEW_VARIABLE="Create variable...",n.Msg.NEW_VARIABLE_TITLE="New variable name:",n.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",n.Msg.ORDINAL_NUMBER_SUFFIX="",n.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",n.Msg.PROCEDURES_BEFORE_PARAMS="with:",n.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",n.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",n.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",n.Msg.PROCEDURES_CREATE_DO="Create '%1'",n.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",n.Msg.PROCEDURES_DEFNORETURN_DO="",n.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",n.Msg.PROCEDURES_DEFNORETURN_TITLE="to",n.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",n.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_DEFRETURN_RETURN="return",n.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",n.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",n.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",n.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",n.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",n.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",n.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",n.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",n.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",n.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",n.Msg.REDO="Redo",n.Msg.REMOVE_COMMENT="Remove Comment",n.Msg.RENAME_VARIABLE="Rename variable...",n.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",n.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",n.Msg.TEXT_APPEND_TITLE="to %1 append text %2",n.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",n.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",n.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",n.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",n.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",n.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",n.Msg.TEXT_CHARAT_FIRST="get first letter",n.Msg.TEXT_CHARAT_FROM_END="get letter # from end",n.Msg.TEXT_CHARAT_FROM_START="get letter #",n.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",n.Msg.TEXT_CHARAT_LAST="get last letter",n.Msg.TEXT_CHARAT_RANDOM="get random letter",n.Msg.TEXT_CHARAT_TAIL="",n.Msg.TEXT_CHARAT_TITLE="in text %1 %2",n.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",n.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",n.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",n.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",n.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",n.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",n.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",n.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",n.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",n.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",n.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",n.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",n.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",n.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",n.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",n.Msg.TEXT_GET_SUBSTRING_TAIL="",n.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",n.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",n.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",n.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",n.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",n.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",n.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",n.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",n.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",n.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",n.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",n.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",n.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",n.Msg.TEXT_LENGTH_TITLE="length of %1",n.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",n.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",n.Msg.TEXT_PRINT_TITLE="print %1",n.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",n.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",n.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",n.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",n.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",n.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",n.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",n.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",n.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",n.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",n.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",n.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",n.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",n.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",n.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",n.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",n.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",n.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",n.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",n.Msg.TODAY="Today",n.Msg.UNDO="Undo",n.Msg.UNNAMED_KEY="unnamed",n.Msg.VARIABLES_DEFAULT_NAME="item",n.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",n.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",n.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",n.Msg.VARIABLES_SET="set %1 to %2",n.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",n.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",n.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",n.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",n.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",n.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",n.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",n.Msg.CONTROLS_FOREACH_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_FOR_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=n.Msg.CONTROLS_IF_MSG_ELSEIF,n.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=n.Msg.CONTROLS_IF_MSG_ELSE,n.Msg.CONTROLS_IF_IF_TITLE_IF=n.Msg.CONTROLS_IF_MSG_IF,n.Msg.CONTROLS_IF_MSG_THEN=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.LISTS_CREATE_WITH_ITEM_TITLE=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.LISTS_GET_INDEX_HELPURL=n.Msg.LISTS_INDEX_OF_HELPURL,n.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.MATH_CHANGE_TITLE_ITEM=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.PROCEDURES_DEFRETURN_COMMENT=n.Msg.PROCEDURES_DEFNORETURN_COMMENT,n.Msg.PROCEDURES_DEFRETURN_DO=n.Msg.PROCEDURES_DEFNORETURN_DO,n.Msg.PROCEDURES_DEFRETURN_PROCEDURE=n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,n.Msg.PROCEDURES_DEFRETURN_TITLE=n.Msg.PROCEDURES_DEFNORETURN_TITLE,n.Msg.TEXT_APPEND_VARIABLE=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.MATH_HUE="230",n.Msg.LOOPS_HUE="120",n.Msg.LISTS_HUE="260",n.Msg.LOGIC_HUE="210",n.Msg.VARIABLES_HUE="330",n.Msg.TEXTS_HUE="160",n.Msg.PROCEDURES_HUE="290",n.Msg.COLOUR_HUE="20",n.Msg.VARIABLES_DYNAMIC_HUE="310",n.Msg}.apply(X,m))&&(B.exports=e)},68266:function(B){B.exports=function(){"use strict";var X=navigator.userAgent,_=navigator.platform,C=/gecko\/\d/i.test(X),m=/MSIE \d/.test(X),e=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(X),t=/Edge\/(\d+)/.exec(X),n=m||e||t,o=n&&(m?document.documentMode||6:+(t||e)[1]),r=!t&&/WebKit\//.test(X),a=r&&/Qt\/\d+\.\d+/.test(X),h=!t&&/Chrome\//.test(X),R=/Opera\//.test(X),L=/Apple Computer/.test(navigator.vendor),W=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(X),nt=/PhantomJS/.test(X),et=L&&(/Mobile\/\w+/.test(X)||navigator.maxTouchPoints>2),Et=/Android/.test(X),It=et||Et||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(X),gt=et||/Mac/.test(_),wt=/\bCrOS\b/.test(X),Ut=/win/i.test(_),Jt=R&&X.match(/Version\/(\d*\.\d*)/);Jt&&(Jt=Number(Jt[1])),Jt&&Jt>=15&&(R=!1,r=!0);var Ct=gt&&(a||R&&(null==Jt||Jt<12.11)),bt=C||n&&o>=9;function at(f){return new RegExp("(^|\\s)"+f+"(?:$|\\s)\\s*")}var ct,ft=function(f,E){var M=f.className,D=at(E).exec(M);if(D){var P=M.slice(D.index+D[0].length);f.className=M.slice(0,D.index)+(P?D[1]+P:"")}};function lt(f){for(var E=f.childNodes.length;E>0;--E)f.removeChild(f.firstChild);return f}function Ft(f,E){return lt(f).appendChild(E)}function Mt(f,E,M,D){var P=document.createElement(f);if(M&&(P.className=M),D&&(P.style.cssText=D),"string"==typeof E)P.appendChild(document.createTextNode(E));else if(E)for(var K=0;K<E.length;++K)P.appendChild(E[K]);return P}function yt(f,E,M,D){var P=Mt(f,E,M,D);return P.setAttribute("role","presentation"),P}function rt(f,E){if(3==E.nodeType&&(E=E.parentNode),f.contains)return f.contains(E);do{if(11==E.nodeType&&(E=E.host),E==f)return!0}while(E=E.parentNode)}function se(){var f;try{f=document.activeElement}catch(E){f=document.body||null}for(;f&&f.shadowRoot&&f.shadowRoot.activeElement;)f=f.shadowRoot.activeElement;return f}function xt(f,E){var M=f.className;at(E).test(M)||(f.className+=(M?" ":"")+E)}function Lt(f,E){for(var M=f.split(" "),D=0;D<M.length;D++)M[D]&&!at(M[D]).test(E)&&(E+=" "+M[D]);return E}ct=document.createRange?function(f,E,M,D){var P=document.createRange();return P.setEnd(D||f,M),P.setStart(f,E),P}:function(f,E,M){var D=document.body.createTextRange();try{D.moveToElementText(f.parentNode)}catch(P){return D}return D.collapse(!0),D.moveEnd("character",M),D.moveStart("character",E),D};var de=function(f){f.select()};function _e(f){var E=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,E)}}function ce(f,E,M){for(var D in E||(E={}),f)f.hasOwnProperty(D)&&(!1!==M||!E.hasOwnProperty(D))&&(E[D]=f[D]);return E}function Ae(f,E,M,D,P){null==E&&-1==(E=f.search(/[^\s\u00a0]/))&&(E=f.length);for(var K=D||0,ut=P||0;;){var St=f.indexOf("\t",K);if(St<0||St>=E)return ut+(E-K);ut+=St-K,ut+=M-ut%M,K=St+1}}et?de=function(f){f.selectionStart=0,f.selectionEnd=f.value.length}:n&&(de=function(f){try{f.select()}catch(E){}});var Ne=function(){this.id=null,this.f=null,this.time=0,this.handler=_e(this.onTimeout,this)};function qe(f,E){for(var M=0;M<f.length;++M)if(f[M]==E)return M;return-1}Ne.prototype.onTimeout=function(f){f.id=0,f.time<=+new Date?f.f():setTimeout(f.handler,f.time-+new Date)},Ne.prototype.set=function(f,E){this.f=E;var M=+new Date+f;(!this.id||M<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,f),this.time=M)};var ei={toString:function(){return"CodeMirror.Pass"}},Me={scroll:!1},ri={origin:"*mouse"},Bt={origin:"+move"};function Ie(f,E,M){for(var D=0,P=0;;){var K=f.indexOf("\t",D);-1==K&&(K=f.length);var ut=K-D;if(K==f.length||P+ut>=E)return D+Math.min(ut,E-P);if(P+=K-D,D=K+1,(P+=M-P%M)>=E)return D}}var Xt=[""];function he(f){for(;Xt.length<=f;)Xt.push(Dt(Xt)+" ");return Xt[f]}function Dt(f){return f[f.length-1]}function ve(f,E){for(var M=[],D=0;D<f.length;D++)M[D]=E(f[D],D);return M}function gi(){}function Ee(f,E){var M;return Object.create?M=Object.create(f):(gi.prototype=f,M=new gi),E&&ce(E,M),M}var ne=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function ee(f){return/\w/.test(f)||f>"\x80"&&(f.toUpperCase()!=f.toLowerCase()||ne.test(f))}function Oe(f,E){return E?!!(E.source.indexOf("\\w")>-1&&ee(f))||E.test(f):ee(f)}function le(f){for(var E in f)if(f.hasOwnProperty(E)&&f[E])return!1;return!0}var me=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function ye(f){return f.charCodeAt(0)>=768&&me.test(f)}function Kt(f,E,M){for(;(M<0?E>0:E<f.length)&&ye(f.charAt(E));)E+=M;return E}function Zt(f,E,M){for(var D=E>M?-1:1;;){if(E==M)return E;var P=(E+M)/2,K=D<0?Math.ceil(P):Math.floor(P);if(K==E)return f(K)?E:M;f(K)?M=K:E=K+D}}var $e=null;function Ti(f,E,M){var D;$e=null;for(var P=0;P<f.length;++P){var K=f[P];if(K.from<E&&K.to>E)return P;K.to==E&&(K.from!=K.to&&"before"==M?D=P:$e=P),K.from==E&&(K.from!=K.to&&"before"!=M?D=P:$e=P)}return null!=D?D:$e}var vi=function(){function M($t){return $t<=247?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt($t):1424<=$t&&$t<=1524?"R":1536<=$t&&$t<=1785?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt($t-1536):1774<=$t&&$t<=2220?"r":8192<=$t&&$t<=8203?"w":8204==$t?"b":"L"}var D=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,P=/[stwN]/,K=/[LRr]/,ut=/[Lb1n]/,St=/[1n]/;function Ht($t,ke,ze){this.level=$t,this.from=ke,this.to=ze}return function($t,ke){var ze="ltr"==ke?"L":"R";if(0==$t.length||"ltr"==ke&&!D.test($t))return!1;for(var pi=$t.length,ui=[],xi=0;xi<pi;++xi)ui.push(M($t.charCodeAt(xi)));for(var ji=0,ln=ze;ji<pi;++ji){var vn=ui[ji];"m"==vn?ui[ji]=ln:ln=vn}for(var Dn=0,pn=ze;Dn<pi;++Dn){var Mn=ui[Dn];"1"==Mn&&"r"==pn?ui[Dn]="n":K.test(Mn)&&(pn=Mn,"r"==Mn&&(ui[Dn]="R"))}for(var eo=1,Zn=ui[0];eo<pi-1;++eo){var Ro=ui[eo];"+"==Ro&&"1"==Zn&&"1"==ui[eo+1]?ui[eo]="1":","==Ro&&Zn==ui[eo+1]&&("1"==Zn||"n"==Zn)&&(ui[eo]=Zn),Zn=Ro}for(var Er=0;Er<pi;++Er){var Ds=ui[Er];if(","==Ds)ui[Er]="N";else if("%"==Ds){var Vr=void 0;for(Vr=Er+1;Vr<pi&&"%"==ui[Vr];++Vr);for(var Da=Er&&"!"==ui[Er-1]||Vr<pi&&"1"==ui[Vr]?"1":"N",Fa=Er;Fa<Vr;++Fa)ui[Fa]=Da;Er=Vr-1}}for(var ys=0,Xo=ze;ys<pi;++ys){var as=ui[ys];"L"==Xo&&"1"==as?ui[ys]="L":K.test(as)&&(Xo=as)}for(var ls=0;ls<pi;++ls)if(P.test(ui[ls])){var S=void 0;for(S=ls+1;S<pi&&P.test(ui[S]);++S);for(var U="L"==(ls?ui[ls-1]:ze),it=U==("L"==(S<pi?ui[S]:ze))?U?"L":"R":ze,pt=ls;pt<S;++pt)ui[pt]=it;ls=S-1}for(var Yt,zt=[],oe=0;oe<pi;)if(ut.test(ui[oe])){var Se=oe;for(++oe;oe<pi&&ut.test(ui[oe]);++oe);zt.push(new Ht(0,Se,oe))}else{var we=oe,ii=zt.length,oi="rtl"==ke?1:0;for(++oe;oe<pi&&"L"!=ui[oe];++oe);for(var fi=we;fi<oe;)if(St.test(ui[fi])){we<fi&&(zt.splice(ii,0,new Ht(1,we,fi)),ii+=oi);var Si=fi;for(++fi;fi<oe&&St.test(ui[fi]);++fi);zt.splice(ii,0,new Ht(2,Si,fi)),ii+=oi,we=fi}else++fi;we<oe&&zt.splice(ii,0,new Ht(1,we,oe))}return"ltr"==ke&&(1==zt[0].level&&(Yt=$t.match(/^\s+/))&&(zt[0].from=Yt[0].length,zt.unshift(new Ht(0,0,Yt[0].length))),1==Dt(zt).level&&(Yt=$t.match(/\s+$/))&&(Dt(zt).to-=Yt[0].length,zt.push(new Ht(0,pi-Yt[0].length,pi)))),"rtl"==ke?zt.reverse():zt}}();function di(f,E){var M=f.order;return null==M&&(M=f.order=vi(f.text,E)),M}var Gi=[],Ri=function(f,E,M){if(f.addEventListener)f.addEventListener(E,M,!1);else if(f.attachEvent)f.attachEvent("on"+E,M);else{var D=f._handlers||(f._handlers={});D[E]=(D[E]||Gi).concat(M)}};function rn(f,E){return f._handlers&&f._handlers[E]||Gi}function ge(f,E,M){if(f.removeEventListener)f.removeEventListener(E,M,!1);else if(f.detachEvent)f.detachEvent("on"+E,M);else{var D=f._handlers,P=D&&D[E];if(P){var K=qe(P,M);K>-1&&(D[E]=P.slice(0,K).concat(P.slice(K+1)))}}}function De(f,E){var M=rn(f,E);if(M.length)for(var D=Array.prototype.slice.call(arguments,2),P=0;P<M.length;++P)M[P].apply(null,D)}function _i(f,E,M){return"string"==typeof E&&(E={type:E,preventDefault:function(){this.defaultPrevented=!0}}),De(f,M||E.type,f,E),Ce(E)||E.codemirrorIgnore}function yi(f){var E=f._handlers&&f._handlers.cursorActivity;if(E)for(var M=f.curOp.cursorActivityHandlers||(f.curOp.cursorActivityHandlers=[]),D=0;D<E.length;++D)-1==qe(M,E[D])&&M.push(E[D])}function Fi(f,E){return rn(f,E).length>0}function Ni(f){f.prototype.on=function(E,M){Ri(this,E,M)},f.prototype.off=function(E,M){ge(this,E,M)}}function mn(f){f.preventDefault?f.preventDefault():f.returnValue=!1}function si(f){f.stopPropagation?f.stopPropagation():f.cancelBubble=!0}function Ce(f){return null!=f.defaultPrevented?f.defaultPrevented:0==f.returnValue}function Vt(f){mn(f),si(f)}function vt(f){return f.target||f.srcElement}function Gt(f){var E=f.which;return null==E&&(1&f.button?E=1:2&f.button?E=3:4&f.button&&(E=2)),gt&&f.ctrlKey&&1==E&&(E=3),E}var He,tn,fe=function(){if(n&&o<9)return!1;var f=Mt("div");return"draggable"in f||"dragDrop"in f}();function $i(f){if(null==He){var E=Mt("span","\u200b");Ft(f,Mt("span",[E,document.createTextNode("x")])),0!=f.firstChild.offsetHeight&&(He=E.offsetWidth<=1&&E.offsetHeight>2&&!(n&&o<8))}var M=He?Mt("span","\u200b"):Mt("span","\xa0",null,"display: inline-block; width: 1px; margin-right: -1px");return M.setAttribute("cm-text",""),M}function In(f){if(null!=tn)return tn;var E=Ft(f,document.createTextNode("A\u062eA")),M=ct(E,0,1).getBoundingClientRect(),D=ct(E,1,2).getBoundingClientRect();return lt(f),!(!M||M.left==M.right)&&(tn=D.right-M.right<3)}var f,no=3!="\n\nb".split(/\n/).length?function(f){for(var E=0,M=[],D=f.length;E<=D;){var P=f.indexOf("\n",E);-1==P&&(P=f.length);var K=f.slice(E,"\r"==f.charAt(P-1)?P-1:P),ut=K.indexOf("\r");-1!=ut?(M.push(K.slice(0,ut)),E+=ut+1):(M.push(K),E=P+1)}return M}:function(f){return f.split(/\r\n?|\n/)},li=window.getSelection?function(f){try{return f.selectionStart!=f.selectionEnd}catch(E){return!1}}:function(f){var E;try{E=f.ownerDocument.selection.createRange()}catch(M){}return!(!E||E.parentElement()!=f)&&0!=E.compareEndPoints("StartToEnd",E)},Je="oncopy"in(f=Mt("div"))||(f.setAttribute("oncopy","return;"),"function"==typeof f.oncopy),xe=null;var Oi={},gn={};function kn(f,E){arguments.length>2&&(E.dependencies=Array.prototype.slice.call(arguments,2)),Oi[f]=E}function Do(f){if("string"==typeof f&&gn.hasOwnProperty(f))f=gn[f];else if(f&&"string"==typeof f.name&&gn.hasOwnProperty(f.name)){var E=gn[f.name];"string"==typeof E&&(E={name:E}),(f=Ee(E,f)).name=E.name}else{if("string"==typeof f&&/^[\w\-]+\/[\w\-]+\+xml$/.test(f))return Do("application/xml");if("string"==typeof f&&/^[\w\-]+\/[\w\-]+\+json$/.test(f))return Do("application/json")}return"string"==typeof f?{name:f}:f||{name:"null"}}function Zo(f,E){E=Do(E);var M=Oi[E.name];if(!M)return Zo(f,"text/plain");var D=M(f,E);if(qo.hasOwnProperty(E.name)){var P=qo[E.name];for(var K in P)!P.hasOwnProperty(K)||(D.hasOwnProperty(K)&&(D["_"+K]=D[K]),D[K]=P[K])}if(D.name=E.name,E.helperType&&(D.helperType=E.helperType),E.modeProps)for(var ut in E.modeProps)D[ut]=E.modeProps[ut];return D}var qo={};function yr(f,E){ce(E,qo.hasOwnProperty(f)?qo[f]:qo[f]={})}function xo(f,E){if(!0===E)return E;if(f.copyState)return f.copyState(E);var M={};for(var D in E){var P=E[D];P instanceof Array&&(P=P.concat([])),M[D]=P}return M}function vo(f,E){for(var M;f.innerMode&&(M=f.innerMode(E))&&M.mode!=f;)E=M.state,f=M.mode;return M||{mode:f,state:E}}function Fr(f,E,M){return!f.startState||f.startState(E,M)}var co=function(f,E,M){this.pos=this.start=0,this.string=f,this.tabSize=E||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=M};function Ii(f,E){if((E-=f.first)<0||E>=f.size)throw new Error("There is no line "+(E+f.first)+" in the document.");for(var M=f;!M.lines;)for(var D=0;;++D){var P=M.children[D],K=P.chunkSize();if(E<K){M=P;break}E-=K}return M.lines[E]}function Gn(f,E,M){var D=[],P=E.line;return f.iter(E.line,M.line+1,function(K){var ut=K.text;P==M.line&&(ut=ut.slice(0,M.ch)),P==E.line&&(ut=ut.slice(E.ch)),D.push(ut),++P}),D}function To(f,E,M){var D=[];return f.iter(E,M,function(P){D.push(P.text)}),D}function Uo(f,E){var M=E-f.height;if(M)for(var D=f;D;D=D.parent)D.height+=M}function yo(f){if(null==f.parent)return null;for(var E=f.parent,M=qe(E.lines,f),D=E.parent;D;E=D,D=D.parent)for(var P=0;D.children[P]!=E;++P)M+=D.children[P].chunkSize();return M+E.first}function Mo(f,E){var M=f.first;t:do{for(var D=0;D<f.children.length;++D){var P=f.children[D],K=P.height;if(E<K){f=P;continue t}E-=K,M+=P.chunkSize()}return M}while(!f.lines);for(var ut=0;ut<f.lines.length;++ut){var Ht=f.lines[ut].height;if(E<Ht)break;E-=Ht}return M+ut}function Qo(f,E){return E>=f.first&&E<f.first+f.size}function Oo(f,E){return String(f.lineNumberFormatter(E+f.firstLineNumber))}function Bi(f,E,M){if(void 0===M&&(M=null),!(this instanceof Bi))return new Bi(f,E,M);this.line=f,this.ch=E,this.sticky=M}function On(f,E){return f.line-E.line||f.ch-E.ch}function Wn(f,E){return f.sticky==E.sticky&&0==On(f,E)}function ae(f){return Bi(f.line,f.ch)}function Fe(f,E){return On(f,E)<0?E:f}function Mi(f,E){return On(f,E)<0?f:E}function Yi(f,E){return Math.max(f.first,Math.min(E,f.first+f.size-1))}function Ki(f,E){if(E.line<f.first)return Bi(f.first,0);var M=f.first+f.size-1;return E.line>M?Bi(M,Ii(f,M).text.length):function qn(f,E){var M=f.ch;return null==M||M>E?Bi(f.line,E):M<0?Bi(f.line,0):f}(E,Ii(f,E.line).text.length)}function ao(f,E){for(var M=[],D=0;D<E.length;D++)M[D]=Ki(f,E[D]);return M}co.prototype.eol=function(){return this.pos>=this.string.length},co.prototype.sol=function(){return this.pos==this.lineStart},co.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},co.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},co.prototype.eat=function(f){var E=this.string.charAt(this.pos);if("string"==typeof f?E==f:E&&(f.test?f.test(E):f(E)))return++this.pos,E},co.prototype.eatWhile=function(f){for(var E=this.pos;this.eat(f););return this.pos>E},co.prototype.eatSpace=function(){for(var f=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>f},co.prototype.skipToEnd=function(){this.pos=this.string.length},co.prototype.skipTo=function(f){var E=this.string.indexOf(f,this.pos);if(E>-1)return this.pos=E,!0},co.prototype.backUp=function(f){this.pos-=f},co.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ae(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Ae(this.string,this.lineStart,this.tabSize):0)},co.prototype.indentation=function(){return Ae(this.string,null,this.tabSize)-(this.lineStart?Ae(this.string,this.lineStart,this.tabSize):0)},co.prototype.match=function(f,E,M){if("string"!=typeof f){var K=this.string.slice(this.pos).match(f);return K&&K.index>0?null:(K&&!1!==E&&(this.pos+=K[0].length),K)}var D=function(ut){return M?ut.toLowerCase():ut};if(D(this.string.substr(this.pos,f.length))==D(f))return!1!==E&&(this.pos+=f.length),!0},co.prototype.current=function(){return this.string.slice(this.start,this.pos)},co.prototype.hideFirstChars=function(f,E){this.lineStart+=f;try{return E()}finally{this.lineStart-=f}},co.prototype.lookAhead=function(f){var E=this.lineOracle;return E&&E.lookAhead(f)},co.prototype.baseToken=function(){var f=this.lineOracle;return f&&f.baseToken(this.pos)};var lo=function(f,E){this.state=f,this.lookAhead=E},Rn=function(f,E,M,D){this.state=E,this.doc=f,this.line=M,this.maxLookAhead=D||0,this.baseTokens=null,this.baseTokenPos=1};function Kr(f,E,M,D){var P=[f.state.modeGen],K={};Ua(f,E.text,f.doc.mode,M,function($t,ke){return P.push($t,ke)},K,D);for(var ut=M.state,St=function($t){M.baseTokens=P;var ke=f.state.overlays[$t],ze=1,pi=0;M.state=!0,Ua(f,E.text,ke.mode,M,function(ui,xi){for(var ji=ze;pi<ui;){var ln=P[ze];ln>ui&&P.splice(ze,1,ui,P[ze+1],ln),ze+=2,pi=Math.min(ui,ln)}if(xi)if(ke.opaque)P.splice(ji,ze-ji,ui,"overlay "+xi),ze=ji+2;else for(;ji<ze;ji+=2){var vn=P[ji+1];P[ji+1]=(vn?vn+" ":"")+"overlay "+xi}},K),M.state=ut,M.baseTokens=null,M.baseTokenPos=1},Ht=0;Ht<f.state.overlays.length;++Ht)St(Ht);return{styles:P,classes:K.bgClass||K.textClass?K:null}}function _r(f,E,M){if(!E.styles||E.styles[0]!=f.state.modeGen){var D=rr(f,yo(E)),P=E.text.length>f.options.maxHighlightLength&&xo(f.doc.mode,D.state),K=Kr(f,E,D);P&&(D.state=P),E.stateAfter=D.save(!P),E.styles=K.styles,K.classes?E.styleClasses=K.classes:E.styleClasses&&(E.styleClasses=null),M===f.doc.highlightFrontier&&(f.doc.modeFrontier=Math.max(f.doc.modeFrontier,++f.doc.highlightFrontier))}return E.styles}function rr(f,E,M){var D=f.doc,P=f.display;if(!D.mode.startState)return new Rn(D,!0,E);var K=function Cr(f,E,M){for(var D,P,K=f.doc,ut=M?-1:E-(f.doc.mode.innerMode?1e3:100),St=E;St>ut;--St){if(St<=K.first)return K.first;var Ht=Ii(K,St-1),$t=Ht.stateAfter;if($t&&(!M||St+($t instanceof lo?$t.lookAhead:0)<=K.modeFrontier))return St;var ke=Ae(Ht.text,null,f.options.tabSize);(null==P||D>ke)&&(P=St-1,D=ke)}return P}(f,E,M),ut=K>D.first&&Ii(D,K-1).stateAfter,St=ut?Rn.fromSaved(D,ut,K):new Rn(D,Fr(D.mode),K);return D.iter(K,E,function(Ht){Or(f,Ht.text,St);var $t=St.line;Ht.stateAfter=$t==E-1||$t%5==0||$t>=P.viewFrom&&$t<P.viewTo?St.save():null,St.nextLine()}),M&&(D.modeFrontier=St.line),St}function Or(f,E,M,D){var P=f.doc.mode,K=new co(E,f.options.tabSize,M);for(K.start=K.pos=D||0,""==E&&uo(P,M.state);!K.eol();)Os(P,K,M.state),K.start=K.pos}function uo(f,E){if(f.blankLine)return f.blankLine(E);if(f.innerMode){var M=vo(f,E);if(M.mode.blankLine)return M.mode.blankLine(M.state)}}function Os(f,E,M,D){for(var P=0;P<10;P++){D&&(D[0]=vo(f,M).mode);var K=f.token(E,M);if(E.pos>E.start)return K}throw new Error("Mode "+f.name+" failed to advance stream.")}Rn.prototype.lookAhead=function(f){var E=this.doc.getLine(this.line+f);return null!=E&&f>this.maxLookAhead&&(this.maxLookAhead=f),E},Rn.prototype.baseToken=function(f){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=f;)this.baseTokenPos+=2;var E=this.baseTokens[this.baseTokenPos+1];return{type:E&&E.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-f}},Rn.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},Rn.fromSaved=function(f,E,M){return E instanceof lo?new Rn(f,xo(f.mode,E.state),M,E.lookAhead):new Rn(f,xo(f.mode,E),M)},Rn.prototype.save=function(f){var E=!1!==f?xo(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new lo(E,this.maxLookAhead):E};var Wr=function(f,E,M){this.start=f.start,this.end=f.pos,this.string=f.current(),this.type=E||null,this.state=M};function sr(f,E,M,D){var ut,ke,P=f.doc,K=P.mode,St=Ii(P,(E=Ki(P,E)).line),Ht=rr(f,E.line,M),$t=new co(St.text,f.options.tabSize,Ht);for(D&&(ke=[]);(D||$t.pos<E.ch)&&!$t.eol();)$t.start=$t.pos,ut=Os(K,$t,Ht.state),D&&ke.push(new Wr($t,ut,xo(P.mode,Ht.state)));return D?ke:new Wr($t,ut,Ht.state)}function wr(f,E){if(f)for(;;){var M=f.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!M)break;f=f.slice(0,M.index)+f.slice(M.index+M[0].length);var D=M[1]?"bgClass":"textClass";null==E[D]?E[D]=M[2]:new RegExp("(?:^|\\s)"+M[2]+"(?:$|\\s)").test(E[D])||(E[D]+=" "+M[2])}return f}function Ua(f,E,M,D,P,K,ut){var St=M.flattenSpans;null==St&&(St=f.options.flattenSpans);var ze,Ht=0,$t=null,ke=new co(E,f.options.tabSize,D),pi=f.options.addModeClass&&[null];for(""==E&&wr(uo(M,D.state),K);!ke.eol();){if(ke.pos>f.options.maxHighlightLength?(St=!1,ut&&Or(f,E,D,ke.pos),ke.pos=E.length,ze=null):ze=wr(Os(M,ke,D.state,pi),K),pi){var ui=pi[0].name;ui&&(ze="m-"+(ze?ui+" "+ze:ui))}if(!St||$t!=ze){for(;Ht<ke.start;)P(Ht=Math.min(ke.start,Ht+5e3),$t);$t=ze}ke.start=ke.pos}for(;Ht<ke.pos;){var xi=Math.min(ke.pos,Ht+5e3);P(xi,$t),Ht=xi}}var ya=!1,Vo=!1;function js(f,E,M){this.marker=f,this.from=E,this.to=M}function ia(f,E){if(f)for(var M=0;M<f.length;++M){var D=f[M];if(D.marker==E)return D}}function nl(f,E){for(var M,D=0;D<f.length;++D)f[D]!=E&&(M||(M=[])).push(f[D]);return M}function Xs(f,E){if(E.full)return null;var M=Qo(f,E.from.line)&&Ii(f,E.from.line).markedSpans,D=Qo(f,E.to.line)&&Ii(f,E.to.line).markedSpans;if(!M&&!D)return null;var P=E.from.ch,K=E.to.ch,ut=0==On(E.from,E.to),St=function Ys(f,E,M){var D;if(f)for(var P=0;P<f.length;++P){var K=f[P],ut=K.marker;null!=K.from&&!(ut.inclusiveLeft?K.from<=E:K.from<E)&&(K.from!=E||"bookmark"!=ut.type||M&&K.marker.insertLeft)||(D||(D=[])).push(new js(ut,K.from,null==K.to||(ut.inclusiveRight?K.to>=E:K.to>E)?null:K.to))}return D}(M,P,ut),Ht=function ol(f,E,M){var D;if(f)for(var P=0;P<f.length;++P){var K=f[P],ut=K.marker;(null==K.to||(ut.inclusiveRight?K.to>=E:K.to>E)||K.from==E&&"bookmark"==ut.type&&(!M||K.marker.insertLeft))&&(D||(D=[])).push(new js(ut,null==K.from||(ut.inclusiveLeft?K.from<=E:K.from<E)?null:K.from-E,null==K.to?null:K.to-E))}return D}(D,K,ut),$t=1==E.text.length,ke=Dt(E.text).length+($t?P:0);if(St)for(var ze=0;ze<St.length;++ze){var pi=St[ze];if(null==pi.to){var ui=ia(Ht,pi.marker);ui?$t&&(pi.to=null==ui.to?null:ui.to+ke):pi.to=P}}if(Ht)for(var xi=0;xi<Ht.length;++xi){var ji=Ht[xi];null!=ji.to&&(ji.to+=ke),null==ji.from?ia(St,ji.marker)||(ji.from=ke,$t&&(St||(St=[])).push(ji)):(ji.from+=ke,$t&&(St||(St=[])).push(ji))}St&&(St=ts(St)),Ht&&Ht!=St&&(Ht=ts(Ht));var vn=[St];if(!$t){var pn,Dn=E.text.length-2;if(Dn>0&&St)for(var Mn=0;Mn<St.length;++Mn)null==St[Mn].to&&(pn||(pn=[])).push(new js(St[Mn].marker,null,null));for(var eo=0;eo<Dn;++eo)vn.push(pn);vn.push(Ht)}return vn}function ts(f){for(var E=0;E<f.length;++E){var M=f[E];null!=M.from&&M.from==M.to&&!1!==M.marker.clearWhenEmpty&&f.splice(E--,1)}return f.length?f:null}function Ga(f){var E=f.markedSpans;if(E){for(var M=0;M<E.length;++M)E[M].marker.detachLine(f);f.markedSpans=null}}function es(f,E){if(E){for(var M=0;M<E.length;++M)E[M].marker.attachLine(f);f.markedSpans=E}}function Go(f){return f.inclusiveLeft?-1:0}function Bo(f){return f.inclusiveRight?1:0}function na(f,E){var M=f.lines.length-E.lines.length;if(0!=M)return M;var D=f.find(),P=E.find(),K=On(D.from,P.from)||Go(f)-Go(E);return K?-K:On(D.to,P.to)||Bo(f)-Bo(E)||E.id-f.id}function Ar(f,E){var D,M=Vo&&f.markedSpans;if(M)for(var P=void 0,K=0;K<M.length;++K)(P=M[K]).marker.collapsed&&null==(E?P.from:P.to)&&(!D||na(D,P.marker)<0)&&(D=P.marker);return D}function zr(f){return Ar(f,!0)}function oa(f){return Ar(f,!1)}function Br(f,E){var D,M=Vo&&f.markedSpans;if(M)for(var P=0;P<M.length;++P){var K=M[P];K.marker.collapsed&&(null==K.from||K.from<E)&&(null==K.to||K.to>E)&&(!D||na(D,K.marker)<0)&&(D=K.marker)}return D}function pa(f,E,M,D,P){var K=Ii(f,E),ut=Vo&&K.markedSpans;if(ut)for(var St=0;St<ut.length;++St){var Ht=ut[St];if(Ht.marker.collapsed){var $t=Ht.marker.find(0),ke=On($t.from,M)||Go(Ht.marker)-Go(P),ze=On($t.to,D)||Bo(Ht.marker)-Bo(P);if(!(ke>=0&&ze<=0||ke<=0&&ze>=0)&&(ke<=0&&(Ht.marker.inclusiveRight&&P.inclusiveLeft?On($t.to,M)>=0:On($t.to,M)>0)||ke>=0&&(Ht.marker.inclusiveRight&&P.inclusiveLeft?On($t.from,D)<=0:On($t.from,D)<0)))return!0}}}function kr(f){for(var E;E=zr(f);)f=E.find(-1,!0).line;return f}function ar(f,E){var M=Ii(f,E),D=kr(M);return M==D?E:yo(D)}function As(f,E){if(E>f.lastLine())return E;var D,M=Ii(f,E);if(!Lo(f,M))return E;for(;D=oa(M);)M=D.find(1,!0).line;return yo(M)+1}function Lo(f,E){var M=Vo&&E.markedSpans;if(M)for(var D=void 0,P=0;P<M.length;++P)if((D=M[P]).marker.collapsed){if(null==D.from)return!0;if(!D.marker.widgetNode&&0==D.from&&D.marker.inclusiveLeft&&Cs(f,E,D))return!0}}function Cs(f,E,M){if(null==M.to){var D=M.marker.find(1,!0);return Cs(f,D.line,ia(D.line.markedSpans,M.marker))}if(M.marker.inclusiveRight&&M.to==E.text.length)return!0;for(var P=void 0,K=0;K<E.markedSpans.length;++K)if((P=E.markedSpans[K]).marker.collapsed&&!P.marker.widgetNode&&P.from==M.to&&(null==P.to||P.to!=M.from)&&(P.marker.inclusiveLeft||M.marker.inclusiveRight)&&Cs(f,E,P))return!0}function hr(f){for(var E=0,M=(f=kr(f)).parent,D=0;D<M.lines.length;++D){var P=M.lines[D];if(P==f)break;E+=P.height}for(var K=M.parent;K;K=(M=K).parent)for(var ut=0;ut<K.children.length;++ut){var St=K.children[ut];if(St==M)break;E+=St.height}return E}function Oa(f){if(0==f.height)return 0;for(var M,E=f.text.length,D=f;M=zr(D);){var P=M.find(0,!0);D=P.from.line,E+=P.from.ch-P.to.ch}for(D=f;M=oa(D);){var K=M.find(0,!0);E-=D.text.length-K.from.ch,E+=(D=K.to.line).text.length-K.to.ch}return E}function Wa(f){var E=f.display,M=f.doc;E.maxLine=Ii(M,M.first),E.maxLineLength=Oa(E.maxLine),E.maxLineChanged=!0,M.iter(function(D){var P=Oa(D);P>E.maxLineLength&&(E.maxLineLength=P,E.maxLine=D)})}var hs=function(f,E,M){this.text=f,es(this,E),this.height=M?M(this):1};function ks(f){f.parent=null,Ga(f)}hs.prototype.lineNo=function(){return yo(this)},Ni(hs);var pl={},No={};function Pn(f,E){if(!f||/^\s*$/.test(f))return null;var M=E.addModeClass?No:pl;return M[f]||(M[f]=f.replace(/\S+/g,"cm-$&"))}function fa(f,E){var M=yt("span",null,null,r?"padding-right: .1px":null),D={pre:yt("pre",[M],"CodeMirror-line"),content:M,col:0,pos:0,cm:f,trailingSpace:!1,splitSpaces:f.getOption("lineWrapping")};E.measure={};for(var P=0;P<=(E.rest?E.rest.length:0);P++){var K=P?E.rest[P-1]:E.line,ut=void 0;D.pos=0,D.addToken=Q,In(f.display.measure)&&(ut=di(K,f.doc.direction))&&(D.addToken=j(D.addToken,ut)),D.map=[],Be(K,D,_r(f,K,E!=f.display.externalMeasured&&yo(K))),K.styleClasses&&(K.styleClasses.bgClass&&(D.bgClass=Lt(K.styleClasses.bgClass,D.bgClass||"")),K.styleClasses.textClass&&(D.textClass=Lt(K.styleClasses.textClass,D.textClass||""))),0==D.map.length&&D.map.push(0,0,D.content.appendChild($i(f.display.measure))),0==P?(E.measure.map=D.map,E.measure.cache={}):((E.measure.maps||(E.measure.maps=[])).push(D.map),(E.measure.caches||(E.measure.caches=[])).push({}))}if(r){var Ht=D.content.lastChild;(/\bcm-tab\b/.test(Ht.className)||Ht.querySelector&&Ht.querySelector(".cm-tab"))&&(D.content.className="cm-tab-wrap-hack")}return De(f,"renderLine",f,E.line,D.pre),D.pre.className&&(D.textClass=Lt(D.pre.className,D.textClass||"")),D}function kt(f){var E=Mt("span","\u2022","cm-invalidchar");return E.title="\\u"+f.charCodeAt(0).toString(16),E.setAttribute("aria-label",E.title),E}function Q(f,E,M,D,P,K,ut){if(E){var ke,St=f.splitSpaces?function V(f,E){if(f.length>1&&!/  /.test(f))return f;for(var M=E,D="",P=0;P<f.length;P++){var K=f.charAt(P);" "==K&&M&&(P==f.length-1||32==f.charCodeAt(P+1))&&(K="\xa0"),D+=K,M=" "==K}return D}(E,f.trailingSpace):E,Ht=f.cm.state.specialChars,$t=!1;if(Ht.test(E)){ke=document.createDocumentFragment();for(var ze=0;;){Ht.lastIndex=ze;var pi=Ht.exec(E),ui=pi?pi.index-ze:E.length-ze;if(ui){var xi=document.createTextNode(St.slice(ze,ze+ui));ke.appendChild(n&&o<9?Mt("span",[xi]):xi),f.map.push(f.pos,f.pos+ui,xi),f.col+=ui,f.pos+=ui}if(!pi)break;ze+=ui+1;var ji=void 0;if("\t"==pi[0]){var ln=f.cm.options.tabSize,vn=ln-f.col%ln;(ji=ke.appendChild(Mt("span",he(vn),"cm-tab"))).setAttribute("role","presentation"),ji.setAttribute("cm-text","\t"),f.col+=vn}else"\r"==pi[0]||"\n"==pi[0]?((ji=ke.appendChild(Mt("span","\r"==pi[0]?"\u240d":"\u2424","cm-invalidchar"))).setAttribute("cm-text",pi[0]),f.col+=1):((ji=f.cm.options.specialCharPlaceholder(pi[0])).setAttribute("cm-text",pi[0]),ke.appendChild(n&&o<9?Mt("span",[ji]):ji),f.col+=1);f.map.push(f.pos,f.pos+1,ji),f.pos++}}else f.col+=E.length,ke=document.createTextNode(St),f.map.push(f.pos,f.pos+E.length,ke),n&&o<9&&($t=!0),f.pos+=E.length;if(f.trailingSpace=32==St.charCodeAt(E.length-1),M||D||P||$t||K||ut){var Dn=M||"";D&&(Dn+=D),P&&(Dn+=P);var pn=Mt("span",[ke],Dn,K);if(ut)for(var Mn in ut)ut.hasOwnProperty(Mn)&&"style"!=Mn&&"class"!=Mn&&pn.setAttribute(Mn,ut[Mn]);return f.content.appendChild(pn)}f.content.appendChild(ke)}}function j(f,E){return function(M,D,P,K,ut,St,Ht){P=P?P+" cm-force-border":"cm-force-border";for(var $t=M.pos,ke=$t+D.length;;){for(var ze=void 0,pi=0;pi<E.length&&!((ze=E[pi]).to>$t&&ze.from<=$t);pi++);if(ze.to>=ke)return f(M,D,P,K,ut,St,Ht);f(M,D.slice(0,ze.to-$t),P,K,null,St,Ht),K=null,D=D.slice(ze.to-$t),$t=ze.to}}}function Ot(f,E,M,D){var P=!D&&M.widgetNode;P&&f.map.push(f.pos,f.pos+E,P),!D&&f.cm.display.input.needsContentAttribute&&(P||(P=f.content.appendChild(document.createElement("span"))),P.setAttribute("cm-marker",M.id)),P&&(f.cm.display.input.setUneditable(P),f.content.appendChild(P)),f.pos+=E,f.trailingSpace=!1}function Be(f,E,M){var D=f.markedSpans,P=f.text,K=0;if(D)for(var ze,pi,xi,ji,ln,vn,Dn,St=P.length,Ht=0,$t=1,ke="",ui=0;;){if(ui==Ht){xi=ji=ln=pi="",Dn=null,vn=null,ui=1/0;for(var pn=[],Mn=void 0,eo=0;eo<D.length;++eo){var Zn=D[eo],Ro=Zn.marker;if("bookmark"==Ro.type&&Zn.from==Ht&&Ro.widgetNode)pn.push(Ro);else if(Zn.from<=Ht&&(null==Zn.to||Zn.to>Ht||Ro.collapsed&&Zn.to==Ht&&Zn.from==Ht)){if(null!=Zn.to&&Zn.to!=Ht&&ui>Zn.to&&(ui=Zn.to,ji=""),Ro.className&&(xi+=" "+Ro.className),Ro.css&&(pi=(pi?pi+";":"")+Ro.css),Ro.startStyle&&Zn.from==Ht&&(ln+=" "+Ro.startStyle),Ro.endStyle&&Zn.to==ui&&(Mn||(Mn=[])).push(Ro.endStyle,Zn.to),Ro.title&&((Dn||(Dn={})).title=Ro.title),Ro.attributes)for(var Er in Ro.attributes)(Dn||(Dn={}))[Er]=Ro.attributes[Er];Ro.collapsed&&(!vn||na(vn.marker,Ro)<0)&&(vn=Zn)}else Zn.from>Ht&&ui>Zn.from&&(ui=Zn.from)}if(Mn)for(var Ds=0;Ds<Mn.length;Ds+=2)Mn[Ds+1]==ui&&(ji+=" "+Mn[Ds]);if(!vn||vn.from==Ht)for(var Vr=0;Vr<pn.length;++Vr)Ot(E,0,pn[Vr]);if(vn&&(vn.from||0)==Ht){if(Ot(E,(null==vn.to?St+1:vn.to)-Ht,vn.marker,null==vn.from),null==vn.to)return;vn.to==Ht&&(vn=!1)}}if(Ht>=St)break;for(var Da=Math.min(St,ui);;){if(ke){var Fa=Ht+ke.length;if(!vn){var ys=Fa>Da?ke.slice(0,Da-Ht):ke;E.addToken(E,ys,ze?ze+xi:xi,ln,Ht+ys.length==ui?ji:"",pi,Dn)}if(Fa>=Da){ke=ke.slice(Da-Ht),Ht=Da;break}Ht=Fa,ln=""}ke=P.slice(K,K=M[$t++]),ze=Pn(M[$t++],E.cm.options)}}else for(var ut=1;ut<M.length;ut+=2)E.addToken(E,P.slice(K,K=M[ut]),Pn(M[ut+1],E.cm.options))}function bi(f,E,M){this.line=E,this.rest=function Es(f){for(var E,M;E=oa(f);)f=E.find(1,!0).line,(M||(M=[])).push(f);return M}(E),this.size=this.rest?yo(Dt(this.rest))-M+1:1,this.node=this.text=null,this.hidden=Lo(f,E)}function un(f,E,M){for(var P,D=[],K=E;K<M;K=P){var ut=new bi(f.doc,Ii(f.doc,K),K);P=K+ut.size,D.push(ut)}return D}var Hn=null;var er=null;function fo(f,E){var M=rn(f,E);if(M.length){var P,D=Array.prototype.slice.call(arguments,2);Hn?P=Hn.delayedCallbacks:er?P=er:(P=er=[],setTimeout(xr,0));for(var K=function(St){P.push(function(){return M[St].apply(null,D)})},ut=0;ut<M.length;++ut)K(ut)}}function xr(){var f=er;er=null;for(var E=0;E<f.length;++E)f[E]()}function Jn(f,E,M,D){for(var P=0;P<E.changes.length;P++){var K=E.changes[P];"text"==K?za(f,E):"gutter"==K?Ta(f,E,M,D):"class"==K?xs(f,E):"widget"==K&&yc(f,E,D)}E.changes=null}function Ks(f){return f.node==f.text&&(f.node=Mt("div",null,null,"position: relative"),f.text.parentNode&&f.text.parentNode.replaceChild(f.node,f.text),f.node.appendChild(f.text),n&&o<8&&(f.node.style.zIndex=2)),f.node}function $r(f,E){var M=f.display.externalMeasured;return M&&M.line==E.line?(f.display.externalMeasured=null,E.measure=M.measure,M.built):fa(f,E)}function za(f,E){var M=E.text.className,D=$r(f,E);E.text==E.node&&(E.node=D.pre),E.text.parentNode.replaceChild(D.pre,E.text),E.text=D.pre,D.bgClass!=E.bgClass||D.textClass!=E.textClass?(E.bgClass=D.bgClass,E.textClass=D.textClass,xs(f,E)):M&&(E.text.className=M)}function xs(f,E){(function sl(f,E){var M=E.bgClass?E.bgClass+" "+(E.line.bgClass||""):E.line.bgClass;if(M&&(M+=" CodeMirror-linebackground"),E.background)M?E.background.className=M:(E.background.parentNode.removeChild(E.background),E.background=null);else if(M){var D=Ks(E);E.background=D.insertBefore(Mt("div",null,M),D.firstChild),f.display.input.setUneditable(E.background)}})(f,E),E.line.wrapClass?Ks(E).className=E.line.wrapClass:E.node!=E.text&&(E.node.className=""),E.text.className=(E.textClass?E.textClass+" "+(E.line.textClass||""):E.line.textClass)||""}function Ta(f,E,M,D){if(E.gutter&&(E.node.removeChild(E.gutter),E.gutter=null),E.gutterBackground&&(E.node.removeChild(E.gutterBackground),E.gutterBackground=null),E.line.gutterClass){var P=Ks(E);E.gutterBackground=Mt("div",null,"CodeMirror-gutter-background "+E.line.gutterClass,"left: "+(f.options.fixedGutter?D.fixedPos:-D.gutterTotalWidth)+"px; width: "+D.gutterTotalWidth+"px"),f.display.input.setUneditable(E.gutterBackground),P.insertBefore(E.gutterBackground,E.text)}var K=E.line.gutterMarkers;if(f.options.lineNumbers||K){var ut=Ks(E),St=E.gutter=Mt("div",null,"CodeMirror-gutter-wrapper","left: "+(f.options.fixedGutter?D.fixedPos:-D.gutterTotalWidth)+"px");if(St.setAttribute("aria-hidden","true"),f.display.input.setUneditable(St),ut.insertBefore(St,E.text),E.line.gutterClass&&(St.className+=" "+E.line.gutterClass),f.options.lineNumbers&&(!K||!K["CodeMirror-linenumbers"])&&(E.lineNumber=St.appendChild(Mt("div",Oo(f.options,M),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+D.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+f.display.lineNumInnerWidth+"px"))),K)for(var Ht=0;Ht<f.display.gutterSpecs.length;++Ht){var $t=f.display.gutterSpecs[Ht].className,ke=K.hasOwnProperty($t)&&K[$t];ke&&St.appendChild(Mt("div",[ke],"CodeMirror-gutter-elt","left: "+D.gutterLeft[$t]+"px; width: "+D.gutterWidth[$t]+"px"))}}}function yc(f,E,M){E.alignable&&(E.alignable=null);for(var D=at("CodeMirror-linewidget"),P=E.node.firstChild,K=void 0;P;P=K)K=P.nextSibling,D.test(P.className)&&E.node.removeChild(P);Ho(f,E,M)}function Xi(f,E,M,D){var P=$r(f,E);return E.text=E.node=P.pre,P.bgClass&&(E.bgClass=P.bgClass),P.textClass&&(E.textClass=P.textClass),xs(f,E),Ta(f,E,M,D),Ho(f,E,D),E.node}function Ho(f,E,M){if(ie(f,E.line,E,M,!0),E.rest)for(var D=0;D<E.rest.length;D++)ie(f,E.rest[D],E,M,!1)}function ie(f,E,M,D,P){if(E.widgets)for(var K=Ks(M),ut=0,St=E.widgets;ut<St.length;++ut){var Ht=St[ut],$t=Mt("div",[Ht.node],"CodeMirror-linewidget"+(Ht.className?" "+Ht.className:""));Ht.handleMouseEvents||$t.setAttribute("cm-ignore-events","true"),z(Ht,$t,M,D),f.display.input.setUneditable($t),P&&Ht.above?K.insertBefore($t,M.gutter||M.text):K.appendChild($t),fo(Ht,"redraw")}}function z(f,E,M,D){if(f.noHScroll){(M.alignable||(M.alignable=[])).push(E);var P=D.wrapperWidth;E.style.left=D.fixedPos+"px",f.coverGutter||(P-=D.gutterTotalWidth,E.style.paddingLeft=D.gutterTotalWidth+"px"),E.style.width=P+"px"}f.coverGutter&&(E.style.zIndex=5,E.style.position="relative",f.noHScroll||(E.style.marginLeft=-D.gutterTotalWidth+"px"))}function J(f){if(null!=f.height)return f.height;var E=f.doc.cm;if(!E)return 0;if(!rt(document.body,f.node)){var M="position: relative;";f.coverGutter&&(M+="margin-left: -"+E.display.gutters.offsetWidth+"px;"),f.noHScroll&&(M+="width: "+E.display.wrapper.clientWidth+"px;"),Ft(E.display.measure,Mt("div",[f.node],null,M))}return f.height=f.node.parentNode.offsetHeight}function _t(f,E){for(var M=vt(E);M!=f.wrapper;M=M.parentNode)if(!M||1==M.nodeType&&"true"==M.getAttribute("cm-ignore-events")||M.parentNode==f.sizer&&M!=f.mover)return!0}function Qt(f){return f.lineSpace.offsetTop}function Te(f){return f.mover.offsetHeight-f.lineSpace.offsetHeight}function Ye(f){if(f.cachedPaddingH)return f.cachedPaddingH;var E=Ft(f.measure,Mt("pre","x","CodeMirror-line-like")),M=window.getComputedStyle?window.getComputedStyle(E):E.currentStyle,D={left:parseInt(M.paddingLeft),right:parseInt(M.paddingRight)};return!isNaN(D.left)&&!isNaN(D.right)&&(f.cachedPaddingH=D),D}function Qe(f){return 50-f.display.nativeBarWidth}function mi(f){return f.display.scroller.clientWidth-Qe(f)-f.display.barWidth}function Ui(f){return f.display.scroller.clientHeight-Qe(f)-f.display.barHeight}function Tn(f,E,M){if(f.line==E)return{map:f.measure.map,cache:f.measure.cache};if(f.rest){for(var D=0;D<f.rest.length;D++)if(f.rest[D]==E)return{map:f.measure.maps[D],cache:f.measure.caches[D]};for(var P=0;P<f.rest.length;P++)if(yo(f.rest[P])>M)return{map:f.measure.maps[P],cache:f.measure.caches[P],before:!0}}}function po(f,E,M,D){return oo(f,jn(f,E),M,D)}function Un(f,E){if(E>=f.display.viewFrom&&E<f.display.viewTo)return f.display.view[Bs(f,E)];var M=f.display.externalMeasured;return M&&E>=M.lineN&&E<M.lineN+M.size?M:void 0}function jn(f,E){var M=yo(E),D=Un(f,M);D&&!D.text?D=null:D&&D.changes&&(Jn(f,D,M,ba(f)),f.curOp.forceUpdate=!0),D||(D=function $n(f,E){var M=yo(E=kr(E)),D=f.display.externalMeasured=new bi(f.doc,E,M);D.lineN=M;var P=D.built=fa(f,D);return D.text=P.pre,Ft(f.display.lineMeasure,P.pre),D}(f,E));var P=Tn(D,E,M);return{line:E,view:D,rect:null,map:P.map,cache:P.cache,before:P.before,hasHeights:!1}}function oo(f,E,M,D,P){E.before&&(M=-1);var ut,K=M+(D||"");return E.cache.hasOwnProperty(K)?ut=E.cache[K]:(E.rect||(E.rect=E.view.text.getBoundingClientRect()),E.hasHeights||(function hn(f,E,M){var D=f.options.lineWrapping,P=D&&mi(f);if(!E.measure.heights||D&&E.measure.width!=P){var K=E.measure.heights=[];if(D){E.measure.width=P;for(var ut=E.text.firstChild.getClientRects(),St=0;St<ut.length-1;St++){var Ht=ut[St],$t=ut[St+1];Math.abs(Ht.bottom-$t.bottom)>2&&K.push((Ht.bottom+$t.top)/2-M.top)}}K.push(M.bottom-M.top)}}(f,E.view,E.rect),E.hasHeights=!0),(ut=function Hr(f,E,M,D){var $t,P=dr(E.map,M,D),K=P.node,ut=P.start,St=P.end,Ht=P.collapse;if(3==K.nodeType){for(var ke=0;ke<4;ke++){for(;ut&&ye(E.line.text.charAt(P.coverStart+ut));)--ut;for(;P.coverStart+St<P.coverEnd&&ye(E.line.text.charAt(P.coverStart+St));)++St;if(($t=n&&o<9&&0==ut&&St==P.coverEnd-P.coverStart?K.parentNode.getBoundingClientRect():is(ct(K,ut,St).getClientRects(),D)).left||$t.right||0==ut)break;St=ut,ut-=1,Ht="right"}n&&o<11&&($t=function Ls(f,E){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function hi(f){if(null!=xe)return xe;var E=Ft(f,Mt("span","x")),M=E.getBoundingClientRect(),D=ct(E,0,1).getBoundingClientRect();return xe=Math.abs(M.left-D.left)>1}(f))return E;var M=screen.logicalXDPI/screen.deviceXDPI,D=screen.logicalYDPI/screen.deviceYDPI;return{left:E.left*M,right:E.right*M,top:E.top*D,bottom:E.bottom*D}}(f.display.measure,$t))}else{var ze;ut>0&&(Ht=D="right"),$t=f.options.lineWrapping&&(ze=K.getClientRects()).length>1?ze["right"==D?ze.length-1:0]:K.getBoundingClientRect()}if(n&&o<9&&!ut&&(!$t||!$t.left&&!$t.right)){var pi=K.parentNode.getClientRects()[0];$t=pi?{left:pi.left,right:pi.left+Ss(f.display),top:pi.top,bottom:pi.bottom}:Ko}for(var ui=$t.top-E.rect.top,xi=$t.bottom-E.rect.top,ji=(ui+xi)/2,ln=E.view.measure.heights,vn=0;vn<ln.length-1&&!(ji<ln[vn]);vn++);var Mn={left:("right"==Ht?$t.right:$t.left)-E.rect.left,right:("left"==Ht?$t.left:$t.right)-E.rect.left,top:vn?ln[vn-1]:0,bottom:ln[vn]};return!$t.left&&!$t.right&&(Mn.bogus=!0),f.options.singleCursorHeightPerLine||(Mn.rtop=ui,Mn.rbottom=xi),Mn}(f,E,M,D)).bogus||(E.cache[K]=ut)),{left:ut.left,right:ut.right,top:P?ut.rtop:ut.top,bottom:P?ut.rbottom:ut.bottom}}var Lr,Ko={left:0,right:0,top:0,bottom:0};function dr(f,E,M){for(var D,P,K,ut,St,Ht,$t=0;$t<f.length;$t+=3)if(Ht=f[$t+1],E<(St=f[$t])?(P=0,K=1,ut="left"):E<Ht?K=1+(P=E-St):($t==f.length-3||E==Ht&&f[$t+3]>E)&&(P=(K=Ht-St)-1,E>=Ht&&(ut="right")),null!=P){if(D=f[$t+2],St==Ht&&M==(D.insertLeft?"left":"right")&&(ut=M),"left"==M&&0==P)for(;$t&&f[$t-2]==f[$t-3]&&f[$t-1].insertLeft;)D=f[2+($t-=3)],ut="left";if("right"==M&&P==Ht-St)for(;$t<f.length-3&&f[$t+3]==f[$t+4]&&!f[$t+5].insertLeft;)D=f[($t+=3)+2],ut="right";break}return{node:D,start:P,end:K,collapse:ut,coverStart:St,coverEnd:Ht}}function is(f,E){var M=Ko;if("left"==E)for(var D=0;D<f.length&&(M=f[D]).left==M.right;D++);else for(var P=f.length-1;P>=0&&(M=f[P]).left==M.right;P--);return M}function ds(f){if(f.measure&&(f.measure.cache={},f.measure.heights=null,f.rest))for(var E=0;E<f.rest.length;E++)f.measure.caches[E]={}}function Sr(f){f.display.externalMeasure=null,lt(f.display.lineMeasure);for(var E=0;E<f.display.view.length;E++)ds(f.display.view[E])}function Js(f){Sr(f),f.display.cachedCharWidth=f.display.cachedTextHeight=f.display.cachedPaddingH=null,f.options.lineWrapping||(f.display.maxLineChanged=!0),f.display.lineNumChars=null}function $s(){return h&&Et?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Zs(){return h&&Et?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Aa(f){var E=0;if(f.widgets)for(var M=0;M<f.widgets.length;++M)f.widgets[M].above&&(E+=J(f.widgets[M]));return E}function ir(f,E,M,D,P){if(!P){var K=Aa(E);M.top+=K,M.bottom+=K}if("line"==D)return M;D||(D="local");var ut=hr(E);if("local"==D?ut+=Qt(f.display):ut-=f.display.viewOffset,"page"==D||"window"==D){var St=f.display.lineSpace.getBoundingClientRect();ut+=St.top+("window"==D?0:Zs());var Ht=St.left+("window"==D?0:$s());M.left+=Ht,M.right+=Ht}return M.top+=ut,M.bottom+=ut,M}function Qs(f,E,M){if("div"==M)return E;var D=E.left,P=E.top;if("page"==M)D-=$s(),P-=Zs();else if("local"==M||!M){var K=f.display.sizer.getBoundingClientRect();D+=K.left,P+=K.top}var ut=f.display.lineSpace.getBoundingClientRect();return{left:D-ut.left,top:P-ut.top}}function ja(f,E,M,D,P){return D||(D=Ii(f.doc,E.line)),ir(f,D,po(f,D,E.ch,P),M)}function ps(f,E,M,D,P,K){function ut(xi,ji){var ln=oo(f,P,xi,ji?"right":"left",K);return ji?ln.left=ln.right:ln.right=ln.left,ir(f,D,ln,M)}D=D||Ii(f.doc,E.line),P||(P=jn(f,D));var St=di(D,f.doc.direction),Ht=E.ch,$t=E.sticky;if(Ht>=D.text.length?(Ht=D.text.length,$t="before"):Ht<=0&&(Ht=0,$t="after"),!St)return ut("before"==$t?Ht-1:Ht,"before"==$t);function ke(xi,ji,ln){return ut(ln?xi-1:xi,1==St[ji].level!=ln)}var ze=Ti(St,Ht,$t),pi=$e,ui=ke(Ht,ze,"before"==$t);return null!=pi&&(ui.other=ke(Ht,pi,"before"!=$t)),ui}function Sn(f,E){var M=0;E=Ki(f.doc,E),f.options.lineWrapping||(M=Ss(f.display)*E.ch);var D=Ii(f.doc,E.line),P=hr(D)+Qt(f.display);return{left:M,right:M,top:P,bottom:P+D.height}}function Xn(f,E,M,D,P){var K=Bi(f,E,M);return K.xRel=P,D&&(K.outside=D),K}function Nn(f,E,M){var D=f.doc;if((M+=f.display.viewOffset)<0)return Xn(D.first,0,null,-1,-1);var P=Mo(D,M),K=D.first+D.size-1;if(P>K)return Xn(D.first+D.size-1,Ii(D,K).text.length,null,1,1);E<0&&(E=0);for(var ut=Ii(D,P);;){var St=Ps(f,ut,P,E,M),Ht=Br(ut,St.ch+(St.xRel>0||St.outside>0?1:0));if(!Ht)return St;var $t=Ht.find(1);if($t.line==P)return $t;ut=Ii(D,P=$t.line)}}function bo(f,E,M,D){D-=Aa(E);var P=E.text.length,K=Zt(function(ut){return oo(f,M,ut-1).bottom<=D},P,0);return{begin:K,end:P=Zt(function(ut){return oo(f,M,ut).top>D},K,P)}}function Eo(f,E,M,D){return M||(M=jn(f,E)),bo(f,E,M,ir(f,E,oo(f,M,D),"line").top)}function Ns(f,E,M,D){return!(f.bottom<=M)&&(f.top>M||(D?f.left:f.right)>E)}function Ps(f,E,M,D,P){P-=hr(E);var K=jn(f,E),ut=Aa(E),St=0,Ht=E.text.length,$t=!0,ke=di(E,f.doc.direction);if(ke){var ze=(f.options.lineWrapping?lr:ra)(f,E,M,K,ke,D,P);St=($t=1!=ze.level)?ze.from:ze.to-1,Ht=$t?ze.to:ze.from-1}var ji,ln,pi=null,ui=null,xi=Zt(function(eo){var Zn=oo(f,K,eo);return Zn.top+=ut,Zn.bottom+=ut,!!Ns(Zn,D,P,!1)&&(Zn.top<=P&&Zn.left<=D&&(pi=eo,ui=Zn),!0)},St,Ht),vn=!1;if(ui){var Dn=D-ui.left<ui.right-D,pn=Dn==$t;xi=pi+(pn?0:1),ln=pn?"after":"before",ji=Dn?ui.left:ui.right}else{!$t&&(xi==Ht||xi==St)&&xi++,ln=0==xi?"after":xi==E.text.length?"before":oo(f,K,xi-($t?1:0)).bottom+ut<=P==$t?"after":"before";var Mn=ps(f,Bi(M,xi,ln),"line",E,K);ji=Mn.left,vn=P<Mn.top?-1:P>=Mn.bottom?1:0}return Xn(M,xi=Kt(E.text,xi,1),ln,vn,D-ji)}function ra(f,E,M,D,P,K,ut){var St=Zt(function(ze){var pi=P[ze],ui=1!=pi.level;return Ns(ps(f,Bi(M,ui?pi.to:pi.from,ui?"before":"after"),"line",E,D),K,ut,!0)},0,P.length-1),Ht=P[St];if(St>0){var $t=1!=Ht.level,ke=ps(f,Bi(M,$t?Ht.from:Ht.to,$t?"after":"before"),"line",E,D);Ns(ke,K,ut,!0)&&ke.top>ut&&(Ht=P[St-1])}return Ht}function lr(f,E,M,D,P,K,ut){var St=bo(f,E,D,ut),Ht=St.begin,$t=St.end;/\s/.test(E.text.charAt($t-1))&&$t--;for(var ke=null,ze=null,pi=0;pi<P.length;pi++){var ui=P[pi];if(!(ui.from>=$t||ui.to<=Ht)){var ji=oo(f,D,1!=ui.level?Math.min($t,ui.to)-1:Math.max(Ht,ui.from)).right,ln=ji<K?K-ji+1e9:ji-K;(!ke||ze>ln)&&(ke=ui,ze=ln)}}return ke||(ke=P[P.length-1]),ke.from<Ht&&(ke={from:Ht,to:ke.to,level:ke.level}),ke.to>$t&&(ke={from:ke.from,to:$t,level:ke.level}),ke}function ns(f){if(null!=f.cachedTextHeight)return f.cachedTextHeight;if(null==Lr){Lr=Mt("pre",null,"CodeMirror-line-like");for(var E=0;E<49;++E)Lr.appendChild(document.createTextNode("x")),Lr.appendChild(Mt("br"));Lr.appendChild(document.createTextNode("x"))}Ft(f.measure,Lr);var M=Lr.offsetHeight/50;return M>3&&(f.cachedTextHeight=M),lt(f.measure),M||1}function Ss(f){if(null!=f.cachedCharWidth)return f.cachedCharWidth;var E=Mt("span","xxxxxxxxxx"),M=Mt("pre",[E],"CodeMirror-line-like");Ft(f.measure,M);var D=E.getBoundingClientRect(),P=(D.right-D.left)/10;return P>2&&(f.cachedCharWidth=P),P||10}function ba(f){for(var E=f.display,M={},D={},P=E.gutters.clientLeft,K=E.gutters.firstChild,ut=0;K;K=K.nextSibling,++ut){var St=f.display.gutterSpecs[ut].className;M[St]=K.offsetLeft+K.clientLeft+P,D[St]=K.clientWidth}return{fixedPos:jr(E),gutterTotalWidth:E.gutters.offsetWidth,gutterLeft:M,gutterWidth:D,wrapperWidth:E.wrapper.clientWidth}}function jr(f){return f.scroller.getBoundingClientRect().left-f.sizer.getBoundingClientRect().left}function Fs(f){var E=ns(f.display),M=f.options.lineWrapping,D=M&&Math.max(5,f.display.scroller.clientWidth/Ss(f.display)-3);return function(P){if(Lo(f.doc,P))return 0;var K=0;if(P.widgets)for(var ut=0;ut<P.widgets.length;ut++)P.widgets[ut].height&&(K+=P.widgets[ut].height);return M?K+(Math.ceil(P.text.length/D)||1)*E:K+E}}function Zl(f){var E=f.doc,M=Fs(f);E.iter(function(D){var P=M(D);P!=D.height&&Uo(D,P)})}function al(f,E,M,D){var P=f.display;if(!M&&"true"==vt(E).getAttribute("cm-not-content"))return null;var K,ut,St=P.lineSpace.getBoundingClientRect();try{K=E.clientX-St.left,ut=E.clientY-St.top}catch(ze){return null}var $t,Ht=Nn(f,K,ut);if(D&&Ht.xRel>0&&($t=Ii(f.doc,Ht.line).text).length==Ht.ch){var ke=Ae($t,$t.length,f.options.tabSize)-$t.length;Ht=Bi(Ht.line,Math.max(0,Math.round((K-Ye(f.display).left)/Ss(f.display))-ke))}return Ht}function Bs(f,E){if(E>=f.display.viewTo||(E-=f.display.viewFrom)<0)return null;for(var M=f.display.view,D=0;D<M.length;D++)if((E-=M[D].size)<0)return D}function Zr(f,E,M,D){null==E&&(E=f.doc.first),null==M&&(M=f.doc.first+f.doc.size),D||(D=0);var P=f.display;if(D&&M<P.viewTo&&(null==P.updateLineNumbers||P.updateLineNumbers>E)&&(P.updateLineNumbers=E),f.curOp.viewChanged=!0,E>=P.viewTo)Vo&&ar(f.doc,E)<P.viewTo&&Ya(f);else if(M<=P.viewFrom)Vo&&As(f.doc,M+D)>P.viewFrom?Ya(f):(P.viewFrom+=D,P.viewTo+=D);else if(E<=P.viewFrom&&M>=P.viewTo)Ya(f);else if(E<=P.viewFrom){var K=ka(f,M,M+D,1);K?(P.view=P.view.slice(K.index),P.viewFrom=K.lineN,P.viewTo+=D):Ya(f)}else if(M>=P.viewTo){var ut=ka(f,E,E,-1);ut?(P.view=P.view.slice(0,ut.index),P.viewTo=ut.lineN):Ya(f)}else{var St=ka(f,E,E,-1),Ht=ka(f,M,M+D,1);St&&Ht?(P.view=P.view.slice(0,St.index).concat(un(f,St.lineN,Ht.lineN)).concat(P.view.slice(Ht.index)),P.viewTo+=D):Ya(f)}var $t=P.externalMeasured;$t&&(M<$t.lineN?$t.lineN+=D:E<$t.lineN+$t.size&&(P.externalMeasured=null))}function sa(f,E,M){f.curOp.viewChanged=!0;var D=f.display,P=f.display.externalMeasured;if(P&&E>=P.lineN&&E<P.lineN+P.size&&(D.externalMeasured=null),!(E<D.viewFrom||E>=D.viewTo)){var K=D.view[Bs(f,E)];if(null!=K.node){var ut=K.changes||(K.changes=[]);-1==qe(ut,M)&&ut.push(M)}}}function Ya(f){f.display.viewFrom=f.display.viewTo=f.doc.first,f.display.view=[],f.display.viewOffset=0}function ka(f,E,M,D){var K,P=Bs(f,E),ut=f.display.view;if(!Vo||M==f.doc.first+f.doc.size)return{index:P,lineN:M};for(var St=f.display.viewFrom,Ht=0;Ht<P;Ht++)St+=ut[Ht].size;if(St!=E){if(D>0){if(P==ut.length-1)return null;K=St+ut[P].size-E,P++}else K=St-E;E+=K,M+=K}for(;ar(f.doc,M)!=M;){if(P==(D<0?0:ut.length-1))return null;M+=D*ut[P-(D<0?1:0)].size,P+=D}return{index:P,lineN:M}}function ll(f){for(var E=f.display.view,M=0,D=0;D<E.length;D++){var P=E[D];!P.hidden&&(!P.node||P.changes)&&++M}return M}function Ul(f){f.display.input.showSelection(f.display.input.prepareSelection())}function cl(f,E){void 0===E&&(E=!0);var M=f.doc,D={},P=D.cursors=document.createDocumentFragment(),K=D.selection=document.createDocumentFragment(),ut=f.options.$customCursor;ut&&(E=!0);for(var St=0;St<M.sel.ranges.length;St++)if(E||St!=M.sel.primIndex){var Ht=M.sel.ranges[St];if(!(Ht.from().line>=f.display.viewTo||Ht.to().line<f.display.viewFrom)){var $t=Ht.empty();if(ut){var ke=ut(f,Ht);ke&&fl(f,ke,P)}else($t||f.options.showCursorWhenSelecting)&&fl(f,Ht.head,P);$t||Fc(f,Ht,K)}}return D}function fl(f,E,M){var D=ps(f,E,"div",null,null,!f.options.singleCursorHeightPerLine),P=M.appendChild(Mt("div","\xa0","CodeMirror-cursor"));if(P.style.left=D.left+"px",P.style.top=D.top+"px",P.style.height=Math.max(0,D.bottom-D.top)*f.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(f.getWrapperElement().className)){var K=ja(f,E,"div",null,null),ut=K.right-K.left;P.style.width=(ut>0?ut:f.defaultCharWidth())+"px"}if(D.other){var St=M.appendChild(Mt("div","\xa0","CodeMirror-cursor CodeMirror-secondarycursor"));St.style.display="",St.style.left=D.other.left+"px",St.style.top=D.other.top+"px",St.style.height=.85*(D.other.bottom-D.other.top)+"px"}}function gl(f,E){return f.top-E.top||f.left-E.left}function Fc(f,E,M){var D=f.display,P=f.doc,K=document.createDocumentFragment(),ut=Ye(f.display),St=ut.left,Ht=Math.max(D.sizerWidth,mi(f)-D.sizer.offsetLeft)-ut.right,$t="ltr"==P.direction;function ke(pn,Mn,eo,Zn){Mn<0&&(Mn=0),Mn=Math.round(Mn),Zn=Math.round(Zn),K.appendChild(Mt("div",null,"CodeMirror-selected","position: absolute; left: "+pn+"px;\n                             top: "+Mn+"px; width: "+(null==eo?Ht-pn:eo)+"px;\n                             height: "+(Zn-Mn)+"px"))}function ze(pn,Mn,eo){var Er,Ds,Zn=Ii(P,pn),Ro=Zn.text.length;function Vr(ys,Xo){return ja(f,Bi(pn,ys),"div",Zn,Xo)}function Da(ys,Xo,as){var ls=Eo(f,Zn,null,ys),S="ltr"==Xo==("after"==as)?"left":"right";return Vr("after"==as?ls.begin:ls.end-(/\s/.test(Zn.text.charAt(ls.end-1))?2:1),S)[S]}var Fa=di(Zn,P.direction);return function We(f,E,M,D){if(!f)return D(E,M,"ltr",0);for(var P=!1,K=0;K<f.length;++K){var ut=f[K];(ut.from<M&&ut.to>E||E==M&&ut.to==E)&&(D(Math.max(ut.from,E),Math.min(ut.to,M),1==ut.level?"rtl":"ltr",K),P=!0)}P||D(E,M,"ltr")}(Fa,Mn||0,null==eo?Ro:eo,function(ys,Xo,as,ls){var S="ltr"==as,U=Vr(ys,S?"left":"right"),Y=Vr(Xo-1,S?"right":"left"),it=null==Mn&&0==ys,pt=null==eo&&Xo==Ro,zt=0==ls,Yt=!Fa||ls==Fa.length-1;if(Y.top-U.top<=3){var we=($t?it:pt)&&zt?St:(S?U:Y).left;ke(we,U.top,(($t?pt:it)&&Yt?Ht:(S?Y:U).right)-we,U.bottom)}else{var oi,fi,Si,zi;S?(oi=$t&&it&&zt?St:U.left,fi=$t?Ht:Da(ys,as,"before"),Si=$t?St:Da(Xo,as,"after"),zi=$t&&pt&&Yt?Ht:Y.right):(oi=$t?Da(ys,as,"before"):St,fi=!$t&&it&&zt?Ht:U.right,Si=!$t&&pt&&Yt?St:Y.left,zi=$t?Da(Xo,as,"after"):Ht),ke(oi,U.top,fi-oi,U.bottom),U.bottom<Y.top&&ke(St,U.bottom,null,Y.top),ke(Si,Y.top,zi-Si,Y.bottom)}(!Er||gl(U,Er)<0)&&(Er=U),gl(Y,Er)<0&&(Er=Y),(!Ds||gl(U,Ds)<0)&&(Ds=U),gl(Y,Ds)<0&&(Ds=Y)}),{start:Er,end:Ds}}var pi=E.from(),ui=E.to();if(pi.line==ui.line)ze(pi.line,pi.ch,ui.ch);else{var xi=Ii(P,pi.line),ji=Ii(P,ui.line),ln=kr(xi)==kr(ji),vn=ze(pi.line,pi.ch,ln?xi.text.length+1:null).end,Dn=ze(ui.line,ln?0:null,ui.ch).start;ln&&(vn.top<Dn.top-2?(ke(vn.right,vn.top,null,vn.bottom),ke(St,Dn.top,Dn.left,Dn.bottom)):ke(vn.right,vn.top,Dn.left-vn.right,vn.bottom)),vn.bottom<Dn.top&&ke(St,vn.bottom,null,Dn.top)}M.appendChild(K)}function ga(f){if(f.state.focused){var E=f.display;clearInterval(E.blinker);var M=!0;E.cursorDiv.style.visibility="",f.options.cursorBlinkRate>0?E.blinker=setInterval(function(){f.hasFocus()||xa(f),E.cursorDiv.style.visibility=(M=!M)?"":"hidden"},f.options.cursorBlinkRate):f.options.cursorBlinkRate<0&&(E.cursorDiv.style.visibility="hidden")}}function ql(f){f.hasFocus()||(f.display.input.focus(),f.state.focused||qs(f))}function Xa(f){f.state.delayingBlurEvent=!0,setTimeout(function(){f.state.delayingBlurEvent&&(f.state.delayingBlurEvent=!1,f.state.focused&&xa(f))},100)}function qs(f,E){f.state.delayingBlurEvent&&!f.state.draggingText&&(f.state.delayingBlurEvent=!1),"nocursor"!=f.options.readOnly&&(f.state.focused||(De(f,"focus",f,E),f.state.focused=!0,xt(f.display.wrapper,"CodeMirror-focused"),!f.curOp&&f.display.selForContextMenu!=f.doc.sel&&(f.display.input.reset(),r&&setTimeout(function(){return f.display.input.reset(!0)},20)),f.display.input.receivedFocus()),ga(f))}function xa(f,E){f.state.delayingBlurEvent||(f.state.focused&&(De(f,"blur",f,E),f.state.focused=!1,ft(f.display.wrapper,"CodeMirror-focused")),clearInterval(f.display.blinker),setTimeout(function(){f.state.focused||(f.display.shift=!1)},150))}function Hs(f){for(var E=f.display,M=E.lineDiv.offsetTop,D=Math.max(0,E.scroller.getBoundingClientRect().top),P=E.lineDiv.getBoundingClientRect().top,K=0,ut=0;ut<E.view.length;ut++){var St=E.view[ut],Ht=f.options.lineWrapping,$t=void 0,ke=0;if(!St.hidden){if(P+=St.line.height,n&&o<8){var ze=St.node.offsetTop+St.node.offsetHeight;$t=ze-M,M=ze}else{var pi=St.node.getBoundingClientRect();$t=pi.bottom-pi.top,!Ht&&St.text.firstChild&&(ke=St.text.firstChild.getBoundingClientRect().right-pi.left-1)}var ui=St.line.height-$t;if((ui>.005||ui<-.005)&&(P<D&&(K-=ui),Uo(St.line,$t),Ea(St.line),St.rest))for(var xi=0;xi<St.rest.length;xi++)Ea(St.rest[xi]);if(ke>f.display.sizerWidth){var ji=Math.ceil(ke/Ss(f.display));ji>f.display.maxLineLength&&(f.display.maxLineLength=ji,f.display.maxLine=St.line,f.display.maxLineChanged=!0)}}}Math.abs(K)>2&&(E.scroller.scrollTop+=K)}function Ea(f){if(f.widgets)for(var E=0;E<f.widgets.length;++E){var M=f.widgets[E],D=M.node.parentNode;D&&(M.height=D.offsetHeight)}}function Cl(f,E,M){var D=M&&null!=M.top?Math.max(0,M.top):f.scroller.scrollTop;D=Math.floor(D-Qt(f));var P=M&&null!=M.bottom?M.bottom:D+f.wrapper.clientHeight,K=Mo(E,D),ut=Mo(E,P);if(M&&M.ensure){var St=M.ensure.from.line,Ht=M.ensure.to.line;St<K?(K=St,ut=Mo(E,hr(Ii(E,St))+f.wrapper.clientHeight)):Math.min(Ht,E.lastLine())>=ut&&(K=Mo(E,hr(Ii(E,Ht))-f.wrapper.clientHeight),ut=Ht)}return{from:K,to:Math.max(ut,K+1)}}function Bc(f,E){var M=f.display,D=ns(f.display);E.top<0&&(E.top=0);var P=f.curOp&&null!=f.curOp.scrollTop?f.curOp.scrollTop:M.scroller.scrollTop,K=Ui(f),ut={};E.bottom-E.top>K&&(E.bottom=E.top+K);var St=f.doc.height+Te(M),$t=E.bottom>St-D;if(E.top<P)ut.scrollTop=E.top<D?0:E.top;else if(E.bottom>P+K){var ke=Math.min(E.top,($t?St:E.bottom)-K);ke!=P&&(ut.scrollTop=ke)}var ze=f.options.fixedGutter?0:M.gutters.offsetWidth,pi=f.curOp&&null!=f.curOp.scrollLeft?f.curOp.scrollLeft:M.scroller.scrollLeft-ze,ui=mi(f)-M.gutters.offsetWidth,xi=E.right-E.left>ui;return xi&&(E.right=E.left+ui),E.left<10?ut.scrollLeft=0:E.left<pi?ut.scrollLeft=Math.max(0,E.left+ze-(xi?0:10)):E.right>ui+pi-3&&(ut.scrollLeft=E.right+(xi?0:10)-ui),ut}function dt(f,E){null!=E&&(Wt(f),f.curOp.scrollTop=(null==f.curOp.scrollTop?f.doc.scrollTop:f.curOp.scrollTop)+E)}function ot(f){Wt(f);var E=f.getCursor();f.curOp.scrollToPos={from:E,to:E,margin:f.options.cursorScrollMargin}}function q(f,E,M){(null!=E||null!=M)&&Wt(f),null!=E&&(f.curOp.scrollLeft=E),null!=M&&(f.curOp.scrollTop=M)}function Wt(f){var E=f.curOp.scrollToPos;E&&(f.curOp.scrollToPos=null,pe(f,Sn(f,E.from),Sn(f,E.to),E.margin))}function pe(f,E,M,D){var P=Bc(f,{left:Math.min(E.left,M.left),top:Math.min(E.top,M.top)-D,right:Math.max(E.right,M.right),bottom:Math.max(E.bottom,M.bottom)+D});q(f,P.scrollLeft,P.scrollTop)}function Ve(f,E){Math.abs(f.doc.scrollTop-E)<2||(C||Su(f,{top:E}),ti(f,E,!0),C&&Su(f),Rl(f,100))}function ti(f,E,M){E=Math.max(0,Math.min(f.display.scroller.scrollHeight-f.display.scroller.clientHeight,E)),(f.display.scroller.scrollTop!=E||M)&&(f.doc.scrollTop=E,f.display.scrollbars.setScrollTop(E),f.display.scroller.scrollTop!=E&&(f.display.scroller.scrollTop=E))}function Li(f,E,M,D){E=Math.max(0,Math.min(E,f.display.scroller.scrollWidth-f.display.scroller.clientWidth)),(!(M?E==f.doc.scrollLeft:Math.abs(f.doc.scrollLeft-E)<2)||D)&&(f.doc.scrollLeft=E,Nr(f),f.display.scroller.scrollLeft!=E&&(f.display.scroller.scrollLeft=E),f.display.scrollbars.setScrollLeft(E))}function wn(f){var E=f.display,M=E.gutters.offsetWidth,D=Math.round(f.doc.height+Te(f.display));return{clientHeight:E.scroller.clientHeight,viewHeight:E.wrapper.clientHeight,scrollWidth:E.scroller.scrollWidth,clientWidth:E.scroller.clientWidth,viewWidth:E.wrapper.clientWidth,barLeft:f.options.fixedGutter?M:0,docHeight:D,scrollHeight:D+Qe(f)+E.barHeight,nativeBarWidth:E.nativeBarWidth,gutterWidth:M}}var Co=function(f,E,M){this.cm=M;var D=this.vert=Mt("div",[Mt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),P=this.horiz=Mt("div",[Mt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");D.tabIndex=P.tabIndex=-1,f(D),f(P),Ri(D,"scroll",function(){D.clientHeight&&E(D.scrollTop,"vertical")}),Ri(P,"scroll",function(){P.clientWidth&&E(P.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,n&&o<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Co.prototype.update=function(f){var E=f.scrollWidth>f.clientWidth+1,M=f.scrollHeight>f.clientHeight+1,D=f.nativeBarWidth;return M?(this.vert.style.display="block",this.vert.style.bottom=E?D+"px":"0",this.vert.firstChild.style.height=Math.max(0,f.scrollHeight-f.clientHeight+(f.viewHeight-(E?D:0)))+"px"):(this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0"),E?(this.horiz.style.display="block",this.horiz.style.right=M?D+"px":"0",this.horiz.style.left=f.barLeft+"px",this.horiz.firstChild.style.width=Math.max(0,f.scrollWidth-f.clientWidth+(f.viewWidth-f.barLeft-(M?D:0)))+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&f.clientHeight>0&&(0==D&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:M?D:0,bottom:E?D:0}},Co.prototype.setScrollLeft=function(f){this.horiz.scrollLeft!=f&&(this.horiz.scrollLeft=f),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Co.prototype.setScrollTop=function(f){this.vert.scrollTop!=f&&(this.vert.scrollTop=f),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Co.prototype.zeroWidthHack=function(){this.horiz.style.height=this.vert.style.width=gt&&!W?"12px":"18px",this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Ne,this.disableVert=new Ne},Co.prototype.enableZeroWidthBar=function(f,E,M){f.style.pointerEvents="auto",E.set(1e3,function D(){var P=f.getBoundingClientRect();("vert"==M?document.elementFromPoint(P.right-1,(P.top+P.bottom)/2):document.elementFromPoint((P.right+P.left)/2,P.bottom-1))!=f?f.style.pointerEvents="none":E.set(1e3,D)})},Co.prototype.clear=function(){var f=this.horiz.parentNode;f.removeChild(this.horiz),f.removeChild(this.vert)};var Kn=function(){};function Jo(f,E){E||(E=wn(f));var M=f.display.barWidth,D=f.display.barHeight;pr(f,E);for(var P=0;P<4&&M!=f.display.barWidth||D!=f.display.barHeight;P++)M!=f.display.barWidth&&f.options.lineWrapping&&Hs(f),pr(f,wn(f)),M=f.display.barWidth,D=f.display.barHeight}function pr(f,E){var M=f.display,D=M.scrollbars.update(E);M.sizer.style.paddingRight=(M.barWidth=D.right)+"px",M.sizer.style.paddingBottom=(M.barHeight=D.bottom)+"px",M.heightForcer.style.borderBottom=D.bottom+"px solid transparent",D.right&&D.bottom?(M.scrollbarFiller.style.display="block",M.scrollbarFiller.style.height=D.bottom+"px",M.scrollbarFiller.style.width=D.right+"px"):M.scrollbarFiller.style.display="",D.bottom&&f.options.coverGutterNextToScrollbar&&f.options.fixedGutter?(M.gutterFiller.style.display="block",M.gutterFiller.style.height=D.bottom+"px",M.gutterFiller.style.width=E.gutterWidth+"px"):M.gutterFiller.style.display=""}Kn.prototype.update=function(){return{bottom:0,right:0}},Kn.prototype.setScrollLeft=function(){},Kn.prototype.setScrollTop=function(){},Kn.prototype.clear=function(){};var Sl={native:Co,null:Kn};function Us(f){f.display.scrollbars&&(f.display.scrollbars.clear(),f.display.scrollbars.addClass&&ft(f.display.wrapper,f.display.scrollbars.addClass)),f.display.scrollbars=new Sl[f.options.scrollbarStyle](function(E){f.display.wrapper.insertBefore(E,f.display.scrollbarFiller),Ri(E,"mousedown",function(){f.state.focused&&setTimeout(function(){return f.display.input.focus()},0)}),E.setAttribute("cm-not-content","true")},function(E,M){"horizontal"==M?Li(f,E):Ve(f,E)},f),f.display.scrollbars.addClass&&xt(f.display.wrapper,f.display.scrollbars.addClass)}var fs=0;function Vs(f){f.curOp={cm:f,viewChanged:!1,startHeight:f.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++fs,markArrays:null},function Po(f){Hn?Hn.ops.push(f):f.ownsGroup=Hn={ops:[f],delayedCallbacks:[]}}(f.curOp)}function Ka(f){var E=f.curOp;E&&function Fo(f,E){var M=f.ownsGroup;if(M)try{!function Yo(f){var E=f.delayedCallbacks,M=0;do{for(;M<E.length;M++)E[M].call(null);for(var D=0;D<f.ops.length;D++){var P=f.ops[D];if(P.cursorActivityHandlers)for(;P.cursorActivityCalled<P.cursorActivityHandlers.length;)P.cursorActivityHandlers[P.cursorActivityCalled++].call(null,P.cm)}}while(M<E.length)}(M)}finally{Hn=null,E(M)}}(E,function(M){for(var D=0;D<M.ops.length;D++)M.ops[D].cm.curOp=null;!function os(f){for(var E=f.ops,M=0;M<E.length;M++)_l(E[M]);for(var D=0;D<E.length;D++)Ja(E[D]);for(var P=0;P<E.length;P++)nu(E[P]);for(var K=0;K<E.length;K++)_a(E[K]);for(var ut=0;ut<E.length;ut++)Vl(E[ut])}(M)})}function _l(f){var E=f.cm,M=E.display;(function th(f){var E=f.display;!E.scrollbarsClipped&&E.scroller.offsetWidth&&(E.nativeBarWidth=E.scroller.offsetWidth-E.scroller.clientWidth,E.heightForcer.style.height=Qe(f)+"px",E.sizer.style.marginBottom=-E.nativeBarWidth+"px",E.sizer.style.borderRightWidth=Qe(f)+"px",E.scrollbarsClipped=!0)})(E),f.updateMaxLine&&Wa(E),f.mustUpdate=f.viewChanged||f.forceUpdate||null!=f.scrollTop||f.scrollToPos&&(f.scrollToPos.from.line<M.viewFrom||f.scrollToPos.to.line>=M.viewTo)||M.maxLineChanged&&E.options.lineWrapping,f.update=f.mustUpdate&&new Tr(E,f.mustUpdate&&{top:f.scrollTop,ensure:f.scrollToPos},f.forceUpdate)}function Ja(f){f.updatedDisplay=f.mustUpdate&&bc(f.cm,f.update)}function nu(f){var E=f.cm,M=E.display;f.updatedDisplay&&Hs(E),f.barMeasure=wn(E),M.maxLineChanged&&!E.options.lineWrapping&&(f.adjustWidthTo=po(E,M.maxLine,M.maxLine.text.length).left+3,E.display.sizerWidth=f.adjustWidthTo,f.barMeasure.scrollWidth=Math.max(M.scroller.clientWidth,M.sizer.offsetLeft+f.adjustWidthTo+Qe(E)+E.display.barWidth),f.maxScrollLeft=Math.max(0,M.sizer.offsetLeft+f.adjustWidthTo-mi(E))),(f.updatedDisplay||f.selectionChanged)&&(f.preparedSelection=M.input.prepareSelection())}function _a(f){var E=f.cm;null!=f.adjustWidthTo&&(E.display.sizer.style.minWidth=f.adjustWidthTo+"px",f.maxScrollLeft<E.doc.scrollLeft&&Li(E,Math.min(E.display.scroller.scrollLeft,f.maxScrollLeft),!0),E.display.maxLineChanged=!1);var M=f.focus&&f.focus==se();f.preparedSelection&&E.display.input.showSelection(f.preparedSelection,M),(f.updatedDisplay||f.startHeight!=E.doc.height)&&Jo(E,f.barMeasure),f.updatedDisplay&&Ru(E,f.barMeasure),f.selectionChanged&&ga(E),E.state.focused&&f.updateInput&&E.display.input.reset(f.typing),M&&ql(f.cm)}function Vl(f){var E=f.cm,M=E.display,D=E.doc;f.updatedDisplay&&Bu(E,f.update),null!=M.wheelStartX&&(null!=f.scrollTop||null!=f.scrollLeft||f.scrollToPos)&&(M.wheelStartX=M.wheelStartY=null),null!=f.scrollTop&&ti(E,f.scrollTop,f.forceScroll),null!=f.scrollLeft&&Li(E,f.scrollLeft,!0,!0),f.scrollToPos&&function tc(f,E){if(!_i(f,"scrollCursorIntoView")){var M=f.display,D=M.sizer.getBoundingClientRect(),P=null;if(E.top+D.top<0?P=!0:E.bottom+D.top>(window.innerHeight||document.documentElement.clientHeight)&&(P=!1),null!=P&&!nt){var K=Mt("div","\u200b",null,"position: absolute;\n                         top: "+(E.top-M.viewOffset-Qt(f.display))+"px;\n                         height: "+(E.bottom-E.top+Qe(f)+M.barHeight)+"px;\n                         left: "+E.left+"px; width: "+Math.max(2,E.right-E.left)+"px;");f.display.lineSpace.appendChild(K),K.scrollIntoView(P),f.display.lineSpace.removeChild(K)}}}(E,function sc(f,E,M,D){var P;null==D&&(D=0),!f.options.lineWrapping&&E==M&&(M="before"==E.sticky?Bi(E.line,E.ch+1,"before"):E,E=E.ch?Bi(E.line,"before"==E.sticky?E.ch-1:E.ch,"after"):E);for(var K=0;K<5;K++){var ut=!1,St=ps(f,E),Ht=M&&M!=E?ps(f,M):St,$t=Bc(f,P={left:Math.min(St.left,Ht.left),top:Math.min(St.top,Ht.top)-D,right:Math.max(St.left,Ht.left),bottom:Math.max(St.bottom,Ht.bottom)+D}),ke=f.doc.scrollTop,ze=f.doc.scrollLeft;if(null!=$t.scrollTop&&(Ve(f,$t.scrollTop),Math.abs(f.doc.scrollTop-ke)>1&&(ut=!0)),null!=$t.scrollLeft&&(Li(f,$t.scrollLeft),Math.abs(f.doc.scrollLeft-ze)>1&&(ut=!0)),!ut)break}return P}(E,Ki(D,f.scrollToPos.from),Ki(D,f.scrollToPos.to),f.scrollToPos.margin));var K=f.maybeHiddenMarkers,ut=f.maybeUnhiddenMarkers;if(K)for(var St=0;St<K.length;++St)K[St].lines.length||De(K[St],"hide");if(ut)for(var Ht=0;Ht<ut.length;++Ht)ut[Ht].lines.length&&De(ut[Ht],"unhide");M.wrapper.offsetHeight&&(D.scrollTop=E.display.scroller.scrollTop),f.changeObjs&&De(E,"changes",E,f.changeObjs),f.update&&f.update.finish()}function gs(f,E){if(f.curOp)return E();Vs(f);try{return E()}finally{Ka(f)}}function Rr(f,E){return function(){if(f.curOp)return E.apply(f,arguments);Vs(f);try{return E.apply(f,arguments)}finally{Ka(f)}}}function Dr(f){return function(){if(this.curOp)return f.apply(this,arguments);Vs(this);try{return f.apply(this,arguments)}finally{Ka(this)}}}function nr(f){return function(){var E=this.cm;if(!E||E.curOp)return f.apply(this,arguments);Vs(E);try{return f.apply(this,arguments)}finally{Ka(E)}}}function Rl(f,E){f.doc.highlightFrontier<f.display.viewTo&&f.state.highlight.set(E,_e(ou,f))}function ou(f){var E=f.doc;if(!(E.highlightFrontier>=f.display.viewTo)){var M=+new Date+f.options.workTime,D=rr(f,E.highlightFrontier),P=[];E.iter(D.line,Math.min(E.first+E.size,f.display.viewTo+500),function(K){if(D.line>=f.display.viewFrom){var ut=K.styles,St=K.text.length>f.options.maxHighlightLength?xo(E.mode,D.state):null,Ht=Kr(f,K,D,!0);St&&(D.state=St),K.styles=Ht.styles;var $t=K.styleClasses,ke=Ht.classes;ke?K.styleClasses=ke:$t&&(K.styleClasses=null);for(var ze=!ut||ut.length!=K.styles.length||$t!=ke&&(!$t||!ke||$t.bgClass!=ke.bgClass||$t.textClass!=ke.textClass),pi=0;!ze&&pi<ut.length;++pi)ze=ut[pi]!=K.styles[pi];ze&&P.push(D.line),K.stateAfter=D.save(),D.nextLine()}else K.text.length<=f.options.maxHighlightLength&&Or(f,K.text,D),K.stateAfter=D.line%5==0?D.save():null,D.nextLine();if(+new Date>M)return Rl(f,f.options.workDelay),!0}),E.highlightFrontier=D.line,E.modeFrontier=Math.max(E.modeFrontier,D.line),P.length&&gs(f,function(){for(var K=0;K<P.length;K++)sa(f,P[K],"text")})}}var Tr=function(f,E,M){var D=f.display;this.viewport=E,this.visible=Cl(D,f.doc,E),this.editorIsHidden=!D.wrapper.offsetWidth,this.wrapperHeight=D.wrapper.clientHeight,this.wrapperWidth=D.wrapper.clientWidth,this.oldDisplayWidth=mi(f),this.force=M,this.dims=ba(f),this.events=[]};function bc(f,E){var M=f.display,D=f.doc;if(E.editorIsHidden)return Ya(f),!1;if(!E.force&&E.visible.from>=M.viewFrom&&E.visible.to<=M.viewTo&&(null==M.updateLineNumbers||M.updateLineNumbers>=M.viewTo)&&M.renderedView==M.view&&0==ll(f))return!1;Gl(f)&&(Ya(f),E.dims=ba(f));var P=D.first+D.size,K=Math.max(E.visible.from-f.options.viewportMargin,D.first),ut=Math.min(P,E.visible.to+f.options.viewportMargin);M.viewFrom<K&&K-M.viewFrom<20&&(K=Math.max(D.first,M.viewFrom)),M.viewTo>ut&&M.viewTo-ut<20&&(ut=Math.min(P,M.viewTo)),Vo&&(K=ar(f.doc,K),ut=As(f.doc,ut));var St=K!=M.viewFrom||ut!=M.viewTo||M.lastWrapHeight!=E.wrapperHeight||M.lastWrapWidth!=E.wrapperWidth;(function Ql(f,E,M){var D=f.display;0==D.view.length||E>=D.viewTo||M<=D.viewFrom?(D.view=un(f,E,M),D.viewFrom=E):(D.viewFrom>E?D.view=un(f,E,D.viewFrom).concat(D.view):D.viewFrom<E&&(D.view=D.view.slice(Bs(f,E))),D.viewFrom=E,D.viewTo<M?D.view=D.view.concat(un(f,D.viewTo,M)):D.viewTo>M&&(D.view=D.view.slice(0,Bs(f,M)))),D.viewTo=M})(f,K,ut),M.viewOffset=hr(Ii(f.doc,M.viewFrom)),f.display.mover.style.top=M.viewOffset+"px";var Ht=ll(f);if(!St&&0==Ht&&!E.force&&M.renderedView==M.view&&(null==M.updateLineNumbers||M.updateLineNumbers>=M.viewTo))return!1;var $t=function Fu(f){if(f.hasFocus())return null;var E=se();if(!E||!rt(f.display.lineDiv,E))return null;var M={activeElt:E};if(window.getSelection){var D=window.getSelection();D.anchorNode&&D.extend&&rt(f.display.lineDiv,D.anchorNode)&&(M.anchorNode=D.anchorNode,M.anchorOffset=D.anchorOffset,M.focusNode=D.focusNode,M.focusOffset=D.focusOffset)}return M}(f);return Ht>4&&(M.lineDiv.style.display="none"),function eh(f,E,M){var D=f.display,P=f.options.lineNumbers,K=D.lineDiv,ut=K.firstChild;function St(xi){var ji=xi.nextSibling;return r&&gt&&f.display.currentWheelTarget==xi?xi.style.display="none":xi.parentNode.removeChild(xi),ji}for(var Ht=D.view,$t=D.viewFrom,ke=0;ke<Ht.length;ke++){var ze=Ht[ke];if(!ze.hidden)if(ze.node&&ze.node.parentNode==K){for(;ut!=ze.node;)ut=St(ut);var ui=P&&null!=E&&E<=$t&&ze.lineNumber;ze.changes&&(qe(ze.changes,"gutter")>-1&&(ui=!1),Jn(f,ze,$t,M)),ui&&(lt(ze.lineNumber),ze.lineNumber.appendChild(document.createTextNode(Oo(f.options,$t)))),ut=ze.node.nextSibling}else{var pi=Xi(f,ze,$t,M);K.insertBefore(pi,ut)}$t+=ze.size}for(;ut;)ut=St(ut)}(f,M.updateLineNumbers,E.dims),Ht>4&&(M.lineDiv.style.display=""),M.renderedView=M.view,function Cu(f){if(f&&f.activeElt&&f.activeElt!=se()&&(f.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(f.activeElt.nodeName)&&f.anchorNode&&rt(document.body,f.anchorNode)&&rt(document.body,f.focusNode))){var E=window.getSelection(),M=document.createRange();M.setEnd(f.anchorNode,f.anchorOffset),M.collapse(!1),E.removeAllRanges(),E.addRange(M),E.extend(f.focusNode,f.focusOffset)}}($t),lt(M.cursorDiv),lt(M.selectionDiv),M.gutters.style.height=M.sizer.style.minHeight=0,St&&(M.lastWrapHeight=E.wrapperHeight,M.lastWrapWidth=E.wrapperWidth,Rl(f,400)),M.updateLineNumbers=null,!0}function Bu(f,E){for(var M=E.viewport,D=!0;;D=!1){if(D&&f.options.lineWrapping&&E.oldDisplayWidth!=mi(f))D&&(E.visible=Cl(f.display,f.doc,M));else if(M&&null!=M.top&&(M={top:Math.min(f.doc.height+Te(f.display)-Ui(f),M.top)}),E.visible=Cl(f.display,f.doc,M),E.visible.from>=f.display.viewFrom&&E.visible.to<=f.display.viewTo)break;if(!bc(f,E))break;Hs(f);var P=wn(f);Ul(f),Jo(f,P),Ru(f,P),E.force=!1}E.signal(f,"update",f),(f.display.viewFrom!=f.display.reportedViewFrom||f.display.viewTo!=f.display.reportedViewTo)&&(E.signal(f,"viewportChange",f,f.display.viewFrom,f.display.viewTo),f.display.reportedViewFrom=f.display.viewFrom,f.display.reportedViewTo=f.display.viewTo)}function Su(f,E){var M=new Tr(f,E);if(bc(f,M)){Hs(f),Bu(f,M);var D=wn(f);Ul(f),Jo(f,D),Ru(f,D),M.finish()}}function ac(f){f.sizer.style.marginLeft=f.gutters.offsetWidth+"px",fo(f,"gutterChanged",f)}function Ru(f,E){f.display.sizer.style.minHeight=E.docHeight+"px",f.display.heightForcer.style.top=E.docHeight+"px",f.display.gutters.style.height=E.docHeight+f.display.barHeight+Qe(f)+"px"}function Nr(f){var E=f.display,M=E.view;if(E.alignWidgets||E.gutters.firstChild&&f.options.fixedGutter){for(var D=jr(E)-E.scroller.scrollLeft+f.doc.scrollLeft,P=E.gutters.offsetWidth,K=D+"px",ut=0;ut<M.length;ut++)if(!M[ut].hidden){f.options.fixedGutter&&(M[ut].gutter&&(M[ut].gutter.style.left=K),M[ut].gutterBackground&&(M[ut].gutterBackground.style.left=K));var St=M[ut].alignable;if(St)for(var Ht=0;Ht<St.length;Ht++)St[Ht].style.left=K}f.options.fixedGutter&&(E.gutters.style.left=D+P+"px")}}function Gl(f){if(!f.options.lineNumbers)return!1;var E=f.doc,M=Oo(f.options,E.first+E.size-1),D=f.display;if(M.length!=D.lineNumChars){var P=D.measure.appendChild(Mt("div",[Mt("div",M)],"CodeMirror-linenumber CodeMirror-gutter-elt")),K=P.firstChild.offsetWidth,ut=P.offsetWidth-K;return D.lineGutter.style.width="",D.lineNumInnerWidth=Math.max(K,D.lineGutter.offsetWidth-ut)+1,D.lineNumWidth=D.lineNumInnerWidth+ut,D.lineNumChars=D.lineNumInnerWidth?M.length:-1,D.lineGutter.style.width=D.lineNumWidth+"px",ac(f.display),!0}return!1}function ec(f,E){for(var M=[],D=!1,P=0;P<f.length;P++){var K=f[P],ut=null;if("string"!=typeof K&&(ut=K.style,K=K.className),"CodeMirror-linenumbers"==K){if(!E)continue;D=!0}M.push({className:K,style:ut})}return E&&!D&&M.push({className:"CodeMirror-linenumbers",style:null}),M}function Rs(f){var E=f.gutters,M=f.gutterSpecs;lt(E),f.lineGutter=null;for(var D=0;D<M.length;++D){var P=M[D],K=P.className,ut=P.style,St=E.appendChild(Mt("div",null,"CodeMirror-gutter "+K));ut&&(St.style.cssText=ut),"CodeMirror-linenumbers"==K&&(f.lineGutter=St,St.style.width=(f.lineNumWidth||1)+"px")}E.style.display=M.length?"":"none",ac(f)}function $a(f){Rs(f.display),Zr(f),Nr(f)}function Ca(f,E,M,D){var P=this;this.input=M,P.scrollbarFiller=Mt("div",null,"CodeMirror-scrollbar-filler"),P.scrollbarFiller.setAttribute("cm-not-content","true"),P.gutterFiller=Mt("div",null,"CodeMirror-gutter-filler"),P.gutterFiller.setAttribute("cm-not-content","true"),P.lineDiv=yt("div",null,"CodeMirror-code"),P.selectionDiv=Mt("div",null,null,"position: relative; z-index: 1"),P.cursorDiv=Mt("div",null,"CodeMirror-cursors"),P.measure=Mt("div",null,"CodeMirror-measure"),P.lineMeasure=Mt("div",null,"CodeMirror-measure"),P.lineSpace=yt("div",[P.measure,P.lineMeasure,P.selectionDiv,P.cursorDiv,P.lineDiv],null,"position: relative; outline: none");var K=yt("div",[P.lineSpace],"CodeMirror-lines");P.mover=Mt("div",[K],null,"position: relative"),P.sizer=Mt("div",[P.mover],"CodeMirror-sizer"),P.sizerWidth=null,P.heightForcer=Mt("div",null,null,"position: absolute; height: 50px; width: 1px;"),P.gutters=Mt("div",null,"CodeMirror-gutters"),P.lineGutter=null,P.scroller=Mt("div",[P.sizer,P.heightForcer,P.gutters],"CodeMirror-scroll"),P.scroller.setAttribute("tabIndex","-1"),P.wrapper=Mt("div",[P.scrollbarFiller,P.gutterFiller,P.scroller],"CodeMirror"),P.wrapper.setAttribute("translate","no"),n&&o<8&&(P.gutters.style.zIndex=-1,P.scroller.style.paddingRight=0),!r&&!(C&&It)&&(P.scroller.draggable=!0),f&&(f.appendChild?f.appendChild(P.wrapper):f(P.wrapper)),P.viewFrom=P.viewTo=E.first,P.reportedViewFrom=P.reportedViewTo=E.first,P.view=[],P.renderedView=null,P.externalMeasured=null,P.viewOffset=0,P.lastWrapHeight=P.lastWrapWidth=0,P.updateLineNumbers=null,P.nativeBarWidth=P.barHeight=P.barWidth=0,P.scrollbarsClipped=!1,P.lineNumWidth=P.lineNumInnerWidth=P.lineNumChars=null,P.alignWidgets=!1,P.cachedCharWidth=P.cachedTextHeight=P.cachedPaddingH=null,P.maxLine=null,P.maxLineLength=0,P.maxLineChanged=!1,P.wheelDX=P.wheelDY=P.wheelStartX=P.wheelStartY=null,P.shift=!1,P.selForContextMenu=null,P.activeTouch=null,P.gutterSpecs=ec(D.gutters,D.lineNumbers),Rs(P),M.init(P)}Tr.prototype.signal=function(f,E){Fi(f,E)&&this.events.push(arguments)},Tr.prototype.finish=function(){for(var f=0;f<this.events.length;f++)De.apply(null,this.events[f])};var aa=0,Za=null;function La(f){var E=f.wheelDeltaX,M=f.wheelDeltaY;return null==E&&f.detail&&f.axis==f.HORIZONTAL_AXIS&&(E=f.detail),null==M&&f.detail&&f.axis==f.VERTICAL_AXIS?M=f.detail:null==M&&(M=f.wheelDelta),{x:E,y:M}}function Ec(f){var E=La(f);return E.x*=Za,E.y*=Za,E}function Hc(f,E){var M=La(E),D=M.x,P=M.y,K=Za;0===E.deltaMode&&(D=E.deltaX,P=E.deltaY,K=1);var ut=f.display,St=ut.scroller,$t=St.scrollHeight>St.clientHeight;if(D&&St.scrollWidth>St.clientWidth||P&&$t){if(P&&gt&&r)t:for(var ke=E.target,ze=ut.view;ke!=St;ke=ke.parentNode)for(var pi=0;pi<ze.length;pi++)if(ze[pi].node==ke){f.display.currentWheelTarget=ke;break t}if(D&&!C&&!R&&null!=K)return P&&$t&&Ve(f,Math.max(0,St.scrollTop+P*K)),Li(f,Math.max(0,St.scrollLeft+D*K)),(!P||P&&$t)&&mn(E),void(ut.wheelStartX=null);if(P&&null!=K){var ui=P*K,xi=f.doc.scrollTop,ji=xi+ut.wrapper.clientHeight;ui<0?xi=Math.max(0,xi+ui-50):ji=Math.min(f.doc.height,ji+ui+50),Su(f,{top:xi,bottom:ji})}aa<20&&0!==E.deltaMode&&(null==ut.wheelStartX?(ut.wheelStartX=St.scrollLeft,ut.wheelStartY=St.scrollTop,ut.wheelDX=D,ut.wheelDY=P,setTimeout(function(){if(null!=ut.wheelStartX){var ln=St.scrollLeft-ut.wheelStartX,vn=St.scrollTop-ut.wheelStartY,Dn=vn&&ut.wheelDY&&vn/ut.wheelDY||ln&&ut.wheelDX&&ln/ut.wheelDX;ut.wheelStartX=ut.wheelStartY=null,Dn&&(Za=(Za*aa+Dn)/(aa+1),++aa)}},200)):(ut.wheelDX+=D,ut.wheelDY+=P))}}n?Za=-.53:C?Za=15:h?Za=-.7:L&&(Za=-1/3);var ma=function(f,E){this.ranges=f,this.primIndex=E};ma.prototype.primary=function(){return this.ranges[this.primIndex]},ma.prototype.equals=function(f){if(f==this)return!0;if(f.primIndex!=this.primIndex||f.ranges.length!=this.ranges.length)return!1;for(var E=0;E<this.ranges.length;E++){var M=this.ranges[E],D=f.ranges[E];if(!Wn(M.anchor,D.anchor)||!Wn(M.head,D.head))return!1}return!0},ma.prototype.deepCopy=function(){for(var f=[],E=0;E<this.ranges.length;E++)f[E]=new Wo(ae(this.ranges[E].anchor),ae(this.ranges[E].head));return new ma(f,this.primIndex)},ma.prototype.somethingSelected=function(){for(var f=0;f<this.ranges.length;f++)if(!this.ranges[f].empty())return!0;return!1},ma.prototype.contains=function(f,E){E||(E=f);for(var M=0;M<this.ranges.length;M++){var D=this.ranges[M];if(On(E,D.from())>=0&&On(f,D.to())<=0)return M}return-1};var Wo=function(f,E){this.anchor=f,this.head=E};function Na(f,E,M){var D=f&&f.options.selectionsMayTouch,P=E[M];E.sort(function(pi,ui){return On(pi.from(),ui.from())}),M=qe(E,P);for(var K=1;K<E.length;K++){var ut=E[K],St=E[K-1],Ht=On(St.to(),ut.from());if(D&&!ut.empty()?Ht>0:Ht>=0){var $t=Mi(St.from(),ut.from()),ke=Fe(St.to(),ut.to()),ze=St.empty()?ut.from()==ut.head:St.from()==St.head;K<=M&&--M,E.splice(--K,2,new Wo(ze?ke:$t,ze?$t:ke))}}return new ma(E,M)}function Il(f,E){return new ma([new Wo(f,E||f)],0)}function Wl(f){return f.text?Bi(f.from.line+f.text.length-1,Dt(f.text).length+(1==f.text.length?f.from.ch:0)):f.to}function Is(f,E){if(On(f,E.from)<0)return f;if(On(f,E.to)<=0)return Wl(E);var M=f.line+E.text.length-(E.to.line-E.from.line)-1,D=f.ch;return f.line==E.to.line&&(D+=Wl(E).ch-E.to.ch),Bi(M,D)}function Qa(f,E){for(var M=[],D=0;D<f.sel.ranges.length;D++){var P=f.sel.ranges[D];M.push(new Wo(Is(P.anchor,E),Is(P.head,E)))}return Na(f.cm,M,f.sel.primIndex)}function ic(f,E,M){return f.line==E.line?Bi(M.line,f.ch-E.ch+M.ch):Bi(M.line+(f.line-E.line),f.ch)}function wl(f){f.doc.mode=Zo(f.options,f.doc.modeOption),nc(f)}function nc(f){f.doc.iter(function(E){E.stateAfter&&(E.stateAfter=null),E.styles&&(E.styles=null)}),f.doc.modeFrontier=f.doc.highlightFrontier=f.doc.first,Rl(f,100),f.state.modeGen++,f.curOp&&Zr(f)}function Cc(f,E){return 0==E.from.ch&&0==E.to.ch&&""==Dt(E.text)&&(!f.cm||f.cm.options.wholeLineUpdateBefore)}function _s(f,E,M,D){function P(Dn){return M?M[Dn]:null}function K(Dn,pn,Mn){(function Jr(f,E,M,D){f.text=E,f.stateAfter&&(f.stateAfter=null),f.styles&&(f.styles=null),null!=f.order&&(f.order=null),Ga(f),es(f,M);var P=D?D(f):1;P!=f.height&&Uo(f,P)})(Dn,pn,Mn,D),fo(Dn,"change",Dn,E)}function ut(Dn,pn){for(var Mn=[],eo=Dn;eo<pn;++eo)Mn.push(new hs($t[eo],P(eo),D));return Mn}var St=E.from,Ht=E.to,$t=E.text,ke=Ii(f,St.line),ze=Ii(f,Ht.line),pi=Dt($t),ui=P($t.length-1),xi=Ht.line-St.line;if(E.full)f.insert(0,ut(0,$t.length)),f.remove($t.length,f.size-$t.length);else if(Cc(f,E)){var ji=ut(0,$t.length-1);K(ze,ze.text,ui),xi&&f.remove(St.line,xi),ji.length&&f.insert(St.line,ji)}else if(ke==ze)if(1==$t.length)K(ke,ke.text.slice(0,St.ch)+pi+ke.text.slice(Ht.ch),ui);else{var ln=ut(1,$t.length-1);ln.push(new hs(pi+ke.text.slice(Ht.ch),ui,D)),K(ke,ke.text.slice(0,St.ch)+$t[0],P(0)),f.insert(St.line+1,ln)}else if(1==$t.length)K(ke,ke.text.slice(0,St.ch)+$t[0]+ze.text.slice(Ht.ch),P(0)),f.remove(St.line+1,xi);else{K(ke,ke.text.slice(0,St.ch)+$t[0],P(0)),K(ze,pi+ze.text.slice(Ht.ch),ui);var vn=ut(1,$t.length-1);xi>1&&f.remove(St.line+1,xi-1),f.insert(St.line+1,vn)}fo(f,"change",f,E)}function ml(f,E,M){!function D(P,K,ut){if(P.linked)for(var St=0;St<P.linked.length;++St){var Ht=P.linked[St];if(Ht.doc!=K){var $t=ut&&Ht.sharedHist;M&&!$t||(E(Ht.doc,$t),D(Ht.doc,P,$t))}}}(f,null,!0)}function Ao(f,E){if(E.cm)throw new Error("This document is already in use.");f.doc=E,E.cm=f,Zl(f),wl(f),Uc(f),f.options.direction=E.direction,f.options.lineWrapping||Wa(f),f.options.mode=E.modeOption,Zr(f)}function Uc(f){("rtl"==f.doc.direction?xt:ft)(f.display.lineDiv,"CodeMirror-rtl")}function lc(f){this.done=[],this.undone=[],this.undoDepth=f?f.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=f?f.maxGeneration:1}function Vc(f,E){var M={from:ae(E.from),to:Wl(E),text:Gn(f,E.from,E.to)};return Ml(f,M,E.from.line,E.to.line+1),ml(f,function(D){return Ml(D,M,E.from.line,E.to.line+1)},!0),M}function Dl(f){for(;f.length&&Dt(f).ranges;)f.pop()}function Mr(f,E,M,D){var P=f.history;P.undone.length=0;var ut,St,K=+new Date;if((P.lastOp==D||P.lastOrigin==E.origin&&E.origin&&("+"==E.origin.charAt(0)&&P.lastModTime>K-(f.cm?f.cm.options.historyEventDelay:500)||"*"==E.origin.charAt(0)))&&(ut=function Gc(f,E){return E?(Dl(f.done),Dt(f.done)):f.done.length&&!Dt(f.done).ranges?Dt(f.done):f.done.length>1&&!f.done[f.done.length-2].ranges?(f.done.pop(),Dt(f.done)):void 0}(P,P.lastOp==D)))St=Dt(ut.changes),0==On(E.from,E.to)&&0==On(E.from,St.to)?St.to=Wl(E):ut.changes.push(Vc(f,E));else{var Ht=Dt(P.done);for((!Ht||!Ht.ranges)&&ru(f.sel,P.done),ut={changes:[Vc(f,E)],generation:P.generation},P.done.push(ut);P.done.length>P.undoDepth;)P.done.shift(),P.done[0].ranges||P.done.shift()}P.done.push(M),P.generation=++P.maxGeneration,P.lastModTime=P.lastSelTime=K,P.lastOp=P.lastSelOp=D,P.lastOrigin=P.lastSelOrigin=E.origin,St||De(f,"historyAdded")}function cc(f,E,M,D){var P=f.history,K=D&&D.origin;M==P.lastSelOp||K&&P.lastSelOrigin==K&&(P.lastModTime==P.lastSelTime&&P.lastOrigin==K||function Iu(f,E,M,D){var P=E.charAt(0);return"*"==P||"+"==P&&M.ranges.length==D.ranges.length&&M.somethingSelected()==D.somethingSelected()&&new Date-f.history.lastSelTime<=(f.cm?f.cm.options.historyEventDelay:500)}(f,K,Dt(P.done),E))?P.done[P.done.length-1]=E:ru(E,P.done),P.lastSelTime=+new Date,P.lastSelOrigin=K,P.lastSelOp=M,D&&!1!==D.clearRedo&&Dl(P.undone)}function ru(f,E){var M=Dt(E);M&&M.ranges&&M.equals(f)||E.push(f)}function Ml(f,E,M,D){var P=E["spans_"+f.id],K=0;f.iter(Math.max(f.first,M),Math.min(f.first+f.size,D),function(ut){ut.markedSpans&&((P||(P=E["spans_"+f.id]={}))[K]=ut.markedSpans),++K})}function qa(f){if(!f)return null;for(var E,M=0;M<f.length;++M)f[M].marker.explicitlyCleared?E||(E=f.slice(0,M)):E&&E.push(f[M]);return E?E.length?E:null:f}function Wc(f,E){var M=function ta(f,E){var M=E["spans_"+f.id];if(!M)return null;for(var D=[],P=0;P<E.text.length;++P)D.push(qa(M[P]));return D}(f,E),D=Xs(f,E);if(!M)return D;if(!D)return M;for(var P=0;P<M.length;++P){var K=M[P],ut=D[P];if(K&&ut)t:for(var St=0;St<ut.length;++St){for(var Ht=ut[St],$t=0;$t<K.length;++$t)if(K[$t].marker==Ht.marker)continue t;K.push(Ht)}else ut&&(M[P]=ut)}return M}function ul(f,E,M){for(var D=[],P=0;P<f.length;++P){var K=f[P];if(K.ranges)D.push(M?ma.prototype.deepCopy.call(K):K);else{var ut=K.changes,St=[];D.push({changes:St});for(var Ht=0;Ht<ut.length;++Ht){var $t=ut[Ht],ke=void 0;if(St.push({from:$t.from,to:$t.to,text:$t.text}),E)for(var ze in $t)(ke=ze.match(/^spans_(\d+)$/))&&qe(E,Number(ke[1]))>-1&&(Dt(St)[ze]=$t[ze],delete $t[ze])}}}return D}function Yr(f,E,M,D){if(D){var P=f.anchor;if(M){var K=On(E,P)<0;K!=On(M,P)<0?(P=E,E=M):K!=On(E,M)<0&&(E=M)}return new Wo(P,E)}return new Wo(M||E,E)}function Ol(f,E,M,D,P){null==P&&(P=f.cm&&(f.cm.display.shift||f.extend)),ca(f,new ma([Yr(f.sel.primary(),E,M,P)],0),D)}function Sa(f,E,M){for(var D=[],P=f.cm&&(f.cm.display.shift||f.extend),K=0;K<f.sel.ranges.length;K++)D[K]=Yr(f.sel.ranges[K],E[K],null,P);ca(f,Na(f.cm,D,f.sel.primIndex),M)}function oc(f,E,M,D){var P=f.sel.ranges.slice(0);P[E]=M,ca(f,Na(f.cm,P,f.sel.primIndex),D)}function Sc(f,E,M,D){ca(f,Il(E,M),D)}function wu(f,E,M){var D=f.history.done,P=Dt(D);P&&P.ranges?(D[D.length-1]=E,Ra(f,E,M)):ca(f,E,M)}function ca(f,E,M){Ra(f,E,M),cc(f,f.sel,f.cm?f.cm.curOp.id:NaN,M)}function Ra(f,E,M){(Fi(f,"beforeSelectionChange")||f.cm&&Fi(f.cm,"beforeSelectionChange"))&&(E=function nh(f,E,M){var D={ranges:E.ranges,update:function(P){this.ranges=[];for(var K=0;K<P.length;K++)this.ranges[K]=new Wo(Ki(f,P[K].anchor),Ki(f,P[K].head))},origin:M&&M.origin};return De(f,"beforeSelectionChange",f,D),f.cm&&De(f.cm,"beforeSelectionChange",f.cm,D),D.ranges!=E.ranges?Na(f.cm,D.ranges,D.ranges.length-1):E}(f,E,M));var D=M&&M.bias||(On(E.primary().head,f.sel.primary().head)<0?-1:1);vl(f,Al(f,E,D,!0)),(!M||!1!==M.scroll)&&f.cm&&"nocursor"!=f.cm.getOption("readOnly")&&ot(f.cm)}function vl(f,E){E.equals(f.sel)||(f.sel=E,f.cm&&(f.cm.curOp.updateInput=1,f.cm.curOp.selectionChanged=!0,yi(f.cm)),fo(f,"cursorActivity",f))}function Rc(f){vl(f,Al(f,f.sel,null,!1))}function Al(f,E,M,D){for(var P,K=0;K<E.ranges.length;K++){var ut=E.ranges[K],St=E.ranges.length==f.sel.ranges.length&&f.sel.ranges[K],Ht=zc(f,ut.anchor,St&&St.anchor,M,D),$t=zc(f,ut.head,St&&St.head,M,D);(P||Ht!=ut.anchor||$t!=ut.head)&&(P||(P=E.ranges.slice(0,K)),P[K]=new Wo(Ht,$t))}return P?Na(f.cm,P,E.primIndex):E}function zl(f,E,M,D,P){var K=Ii(f,E.line);if(K.markedSpans)for(var ut=0;ut<K.markedSpans.length;++ut){var St=K.markedSpans[ut],Ht=St.marker,$t="selectLeft"in Ht?!Ht.selectLeft:Ht.inclusiveLeft,ke="selectRight"in Ht?!Ht.selectRight:Ht.inclusiveRight;if((null==St.from||($t?St.from<=E.ch:St.from<E.ch))&&(null==St.to||(ke?St.to>=E.ch:St.to>E.ch))){if(P&&(De(Ht,"beforeCursorEnter"),Ht.explicitlyCleared)){if(K.markedSpans){--ut;continue}break}if(!Ht.atomic)continue;if(M){var ze=Ht.find(D<0?1:-1),pi=void 0;if((D<0?ke:$t)&&(ze=Ia(f,ze,-D,ze&&ze.line==E.line?K:null)),ze&&ze.line==E.line&&(pi=On(ze,M))&&(D<0?pi<0:pi>0))return zl(f,ze,E,D,P)}var ui=Ht.find(D<0?-1:1);return(D<0?$t:ke)&&(ui=Ia(f,ui,D,ui.line==E.line?K:null)),ui?zl(f,ui,E,D,P):null}}return E}function zc(f,E,M,D,P){var K=D||1;return zl(f,E,M,K,P)||!P&&zl(f,E,M,K,!0)||zl(f,E,M,-K,P)||!P&&zl(f,E,M,-K,!0)||(f.cantEdit=!0,Bi(f.first,0))}function Ia(f,E,M,D){return M<0&&0==E.ch?E.line>f.first?Ki(f,Bi(E.line-1)):null:M>0&&E.ch==(D||Ii(f,E.line)).text.length?E.line<f.first+f.size-1?Bi(E.line+1,0):null:new Bi(E.line,E.ch+M)}function jc(f){f.setSelection(Bi(f.firstLine(),0),Bi(f.lastLine()),Me)}function Ic(f,E,M){var D={canceled:!1,from:E.from,to:E.to,text:E.text,origin:E.origin,cancel:function(){return D.canceled=!0}};return M&&(D.update=function(P,K,ut,St){P&&(D.from=Ki(f,P)),K&&(D.to=Ki(f,K)),ut&&(D.text=ut),void 0!==St&&(D.origin=St)}),De(f,"beforeChange",f,D),f.cm&&De(f.cm,"beforeChange",f.cm,D),D.canceled?(f.cm&&(f.cm.curOp.updateInput=2),null):{from:D.from,to:D.to,text:D.text,origin:D.origin}}function uc(f,E,M){if(f.cm){if(!f.cm.curOp)return Rr(f.cm,uc)(f,E,M);if(f.cm.state.suppressEdits)return}if(!(Fi(f,"beforeChange")||f.cm&&Fi(f.cm,"beforeChange"))||(E=Ic(f,E,!0))){var D=ya&&!M&&function rl(f,E,M){var D=null;if(f.iter(E.line,M.line+1,function(ui){if(ui.markedSpans)for(var xi=0;xi<ui.markedSpans.length;++xi){var ji=ui.markedSpans[xi].marker;ji.readOnly&&(!D||-1==qe(D,ji))&&(D||(D=[])).push(ji)}}),!D)return null;for(var P=[{from:E,to:M}],K=0;K<D.length;++K)for(var ut=D[K],St=ut.find(0),Ht=0;Ht<P.length;++Ht){var $t=P[Ht];if(!(On($t.to,St.from)<0||On($t.from,St.to)>0)){var ke=[Ht,1],ze=On($t.from,St.from),pi=On($t.to,St.to);(ze<0||!ut.inclusiveLeft&&!ze)&&ke.push({from:$t.from,to:St.from}),(pi>0||!ut.inclusiveRight&&!pi)&&ke.push({from:St.to,to:$t.to}),P.splice.apply(P,ke),Ht+=ke.length-3}}return P}(f,E.from,E.to);if(D)for(var P=D.length-1;P>=0;--P)cr(f,{from:D[P].from,to:D[P].to,text:P?[""]:E.text,origin:E.origin});else cr(f,E)}}function cr(f,E){if(1!=E.text.length||""!=E.text[0]||0!=On(E.from,E.to)){var M=Qa(f,E);Mr(f,E,M,f.cm?f.cm.curOp.id:NaN),wc(f,E,M,Xs(f,E));var D=[];ml(f,function(P,K){!K&&-1==qe(D,P.history)&&(su(P.history,E),D.push(P.history)),wc(P,E,null,Xs(P,E))})}}function jl(f,E,M){var D=f.cm&&f.cm.state.suppressEdits;if(!D||M){for(var K,P=f.history,ut=f.sel,St="undo"==E?P.done:P.undone,Ht="undo"==E?P.undone:P.done,$t=0;$t<St.length&&(K=St[$t],!(M?K.ranges&&!K.equals(f.sel):!K.ranges));$t++);if($t!=St.length){for(P.lastOrigin=P.lastSelOrigin=null;;){if(!(K=St.pop()).ranges){if(D)return void St.push(K);break}if(ru(K,Ht),M&&!K.equals(f.sel))return void ca(f,K,{clearRedo:!1});ut=K}var ke=[];ru(ut,Ht),Ht.push({changes:ke,generation:P.generation}),P.generation=K.generation||++P.maxGeneration;for(var ze=Fi(f,"beforeChange")||f.cm&&Fi(f.cm,"beforeChange"),pi=function(ji){var ln=K.changes[ji];if(ln.origin=E,ze&&!Ic(f,ln,!1))return St.length=0,{};ke.push(Vc(f,ln));var vn=ji?Qa(f,ln):Dt(St);wc(f,ln,vn,Wc(f,ln)),!ji&&f.cm&&f.cm.scrollIntoView({from:ln.from,to:Wl(ln)});var Dn=[];ml(f,function(pn,Mn){!Mn&&-1==qe(Dn,pn.history)&&(su(pn.history,ln),Dn.push(pn.history)),wc(pn,ln,null,Wc(pn,ln))})},ui=K.changes.length-1;ui>=0;--ui){var xi=pi(ui);if(xi)return xi.v}}}}function kl(f,E){if(0!=E&&(f.first+=E,f.sel=new ma(ve(f.sel.ranges,function(P){return new Wo(Bi(P.anchor.line+E,P.anchor.ch),Bi(P.head.line+E,P.head.ch))}),f.sel.primIndex),f.cm)){Zr(f.cm,f.first,f.first-E,E);for(var M=f.cm.display,D=M.viewFrom;D<M.viewTo;D++)sa(f.cm,D,"gutter")}}function wc(f,E,M,D){if(f.cm&&!f.cm.curOp)return Rr(f.cm,wc)(f,E,M,D);if(E.to.line<f.first)kl(f,E.text.length-1-(E.to.line-E.from.line));else if(!(E.from.line>f.lastLine())){if(E.from.line<f.first){var P=E.text.length-1-(f.first-E.from.line);kl(f,P),E={from:Bi(f.first,0),to:Bi(E.to.line+P,E.to.ch),text:[Dt(E.text)],origin:E.origin}}var K=f.lastLine();E.to.line>K&&(E={from:E.from,to:Bi(K,Ii(f,K).text.length),text:[E.text[0]],origin:E.origin}),E.removed=Gn(f,E.from,E.to),M||(M=Qa(f,E)),f.cm?function Du(f,E,M){var D=f.doc,P=f.display,K=E.from,ut=E.to,St=!1,Ht=K.line;f.options.lineWrapping||(Ht=yo(kr(Ii(D,K.line))),D.iter(Ht,ut.line+1,function(ui){if(ui==P.maxLine)return St=!0,!0})),D.sel.contains(E.from,E.to)>-1&&yi(f),_s(D,E,M,Fs(f)),f.options.lineWrapping||(D.iter(Ht,K.line+E.text.length,function(ui){var xi=Oa(ui);xi>P.maxLineLength&&(P.maxLine=ui,P.maxLineLength=xi,P.maxLineChanged=!0,St=!1)}),St&&(f.curOp.updateMaxLine=!0)),function us(f,E){if(f.modeFrontier=Math.min(f.modeFrontier,E),!(f.highlightFrontier<E-10)){for(var M=f.first,D=E-1;D>M;D--){var P=Ii(f,D).stateAfter;if(P&&(!(P instanceof lo)||D+P.lookAhead<E)){M=D+1;break}}f.highlightFrontier=Math.min(f.highlightFrontier,M)}}(D,K.line),Rl(f,400);var $t=E.text.length-(ut.line-K.line)-1;E.full?Zr(f):K.line!=ut.line||1!=E.text.length||Cc(f.doc,E)?Zr(f,K.line,ut.line+1,$t):sa(f,K.line,"text");var ke=Fi(f,"changes"),ze=Fi(f,"change");if(ze||ke){var pi={from:K,to:ut,text:E.text,removed:E.removed,origin:E.origin};ze&&fo(f,"change",f,pi),ke&&(f.curOp.changeObjs||(f.curOp.changeObjs=[])).push(pi)}f.display.selForContextMenu=null}(f.cm,E,D):_s(f,E,D),Ra(f,M,Me),f.cantEdit&&zc(f,Bi(f.firstLine(),0))&&(f.cantEdit=!1)}}function Yl(f,E,M,D,P){var K;D||(D=M),On(D,M)<0&&(M=(K=[D,M])[0],D=K[1]),"string"==typeof E&&(E=f.splitLines(E)),uc(f,{from:M,to:D,text:E,origin:P})}function Yc(f,E,M,D){M<f.line?f.line+=D:E<f.line&&(f.line=E,f.ch=0)}function rc(f,E,M,D){for(var P=0;P<f.length;++P){var K=f[P],ut=!0;if(K.ranges){K.copied||((K=f[P]=K.deepCopy()).copied=!0);for(var St=0;St<K.ranges.length;St++)Yc(K.ranges[St].anchor,E,M,D),Yc(K.ranges[St].head,E,M,D)}else{for(var Ht=0;Ht<K.changes.length;++Ht){var $t=K.changes[Ht];if(M<$t.from.line)$t.from=Bi($t.from.line+D,$t.from.ch),$t.to=Bi($t.to.line+D,$t.to.ch);else if(E<=$t.to.line){ut=!1;break}}ut||(f.splice(0,P+1),P=0)}}}function su(f,E){var M=E.from.line,D=E.to.line,P=E.text.length-(D-M)-1;rc(f.done,M,D,P),rc(f.undone,M,D,P)}function Dc(f,E,M,D){var P=E,K=E;return"number"==typeof E?K=Ii(f,Yi(f,E)):P=yo(E),null==P?null:(D(K,P)&&f.cm&&sa(f.cm,P,M),K)}function Xc(f){this.lines=f,this.parent=null;for(var E=0,M=0;M<f.length;++M)f[M].parent=this,E+=f[M].height;this.height=E}function xl(f){this.children=f;for(var E=0,M=0,D=0;D<f.length;++D){var P=f[D];E+=P.chunkSize(),M+=P.height,P.parent=this}this.size=E,this.height=M,this.parent=null}Wo.prototype.from=function(){return Mi(this.anchor,this.head)},Wo.prototype.to=function(){return Fe(this.anchor,this.head)},Wo.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},Xc.prototype={chunkSize:function(){return this.lines.length},removeInner:function(f,E){for(var M=f,D=f+E;M<D;++M){var P=this.lines[M];this.height-=P.height,ks(P),fo(P,"delete")}this.lines.splice(f,E)},collapse:function(f){f.push.apply(f,this.lines)},insertInner:function(f,E,M){this.height+=M,this.lines=this.lines.slice(0,f).concat(E).concat(this.lines.slice(f));for(var D=0;D<E.length;++D)E[D].parent=this},iterN:function(f,E,M){for(var D=f+E;f<D;++f)if(M(this.lines[f]))return!0}},xl.prototype={chunkSize:function(){return this.size},removeInner:function(f,E){this.size-=E;for(var M=0;M<this.children.length;++M){var D=this.children[M],P=D.chunkSize();if(f<P){var K=Math.min(E,P-f),ut=D.height;if(D.removeInner(f,K),this.height-=ut-D.height,P==K&&(this.children.splice(M--,1),D.parent=null),0==(E-=K))break;f=0}else f-=P}if(this.size-E<25&&(this.children.length>1||!(this.children[0]instanceof Xc))){var St=[];this.collapse(St),this.children=[new Xc(St)],this.children[0].parent=this}},collapse:function(f){for(var E=0;E<this.children.length;++E)this.children[E].collapse(f)},insertInner:function(f,E,M){this.size+=E.length,this.height+=M;for(var D=0;D<this.children.length;++D){var P=this.children[D],K=P.chunkSize();if(f<=K){if(P.insertInner(f,E,M),P.lines&&P.lines.length>50){for(var ut=P.lines.length%25+25,St=ut;St<P.lines.length;){var Ht=new Xc(P.lines.slice(St,St+=25));P.height-=Ht.height,this.children.splice(++D,0,Ht),Ht.parent=this}P.lines=P.lines.slice(0,ut),this.maybeSpill()}break}f-=K}},maybeSpill:function(){if(!(this.children.length<=10)){var f=this;do{var M=new xl(f.children.splice(f.children.length-5,5));if(f.parent){f.size-=M.size,f.height-=M.height;var P=qe(f.parent.children,f);f.parent.children.splice(P+1,0,M)}else{var D=new xl(f.children);D.parent=f,f.children=[D,M],f=D}M.parent=f.parent}while(f.children.length>10);f.parent.maybeSpill()}},iterN:function(f,E,M){for(var D=0;D<this.children.length;++D){var P=this.children[D],K=P.chunkSize();if(f<K){var ut=Math.min(E,K-f);if(P.iterN(f,ut,M))return!0;if(0==(E-=ut))break;f=0}else f-=K}}};var Ll=function(f,E,M){if(M)for(var D in M)M.hasOwnProperty(D)&&(this[D]=M[D]);this.doc=f,this.node=E};function tl(f,E,M){hr(E)<(f.curOp&&f.curOp.scrollTop||f.doc.scrollTop)&&dt(f,M)}Ll.prototype.clear=function(){var f=this.doc.cm,E=this.line.widgets,M=this.line,D=yo(M);if(null!=D&&E){for(var P=0;P<E.length;++P)E[P]==this&&E.splice(P--,1);E.length||(M.widgets=null);var K=J(this);Uo(M,Math.max(0,M.height-K)),f&&(gs(f,function(){tl(f,M,-K),sa(f,D,"widget")}),fo(f,"lineWidgetCleared",f,this,D))}},Ll.prototype.changed=function(){var f=this,E=this.height,M=this.doc.cm,D=this.line;this.height=null;var P=J(this)-E;!P||(Lo(this.doc,D)||Uo(D,D.height+P),M&&gs(M,function(){M.curOp.forceUpdate=!0,tl(M,D,P),fo(M,"lineWidgetChanged",M,f,yo(D))}))},Ni(Ll);var Hu=0,yl=function(f,E){this.lines=[],this.type=E,this.doc=f,this.id=++Hu};function Tl(f,E,M,D,P){if(D&&D.shared)return function hc(f,E,M,D,P){(D=ce(D)).shared=!1;var K=[Tl(f,E,M,D,P)],ut=K[0],St=D.widgetNode;return ml(f,function(Ht){St&&(D.widgetNode=St.cloneNode(!0)),K.push(Tl(Ht,Ki(Ht,E),Ki(Ht,M),D,P));for(var $t=0;$t<Ht.linked.length;++$t)if(Ht.linked[$t].isParent)return;ut=Dt(K)}),new hl(K,ut)}(f,E,M,D,P);if(f.cm&&!f.cm.curOp)return Rr(f.cm,Tl)(f,E,M,D,P);var K=new yl(f,P),ut=On(E,M);if(D&&ce(D,K,!1),ut>0||0==ut&&!1!==K.clearWhenEmpty)return K;if(K.replacedWith&&(K.collapsed=!0,K.widgetNode=yt("span",[K.replacedWith],"CodeMirror-widget"),D.handleMouseEvents||K.widgetNode.setAttribute("cm-ignore-events","true"),D.insertLeft&&(K.widgetNode.insertLeft=!0)),K.collapsed){if(pa(f,E.line,E,M,K)||E.line!=M.line&&pa(f,M.line,E,M,K))throw new Error("Inserting collapsed marker partially overlapping an existing one");!function dl(){Vo=!0}()}K.addToHistory&&Mr(f,{from:E,to:M,origin:"markText"},f.sel,NaN);var $t,St=E.line,Ht=f.cm;if(f.iter(St,M.line+1,function(ze){Ht&&K.collapsed&&!Ht.options.lineWrapping&&kr(ze)==Ht.display.maxLine&&($t=!0),K.collapsed&&St!=E.line&&Uo(ze,0),function Va(f,E,M){var D=M&&window.WeakSet&&(M.markedSpans||(M.markedSpans=new WeakSet));D&&D.has(f.markedSpans)?f.markedSpans.push(E):(f.markedSpans=f.markedSpans?f.markedSpans.concat([E]):[E],D&&D.add(f.markedSpans)),E.marker.attachLine(f)}(ze,new js(K,St==E.line?E.ch:null,St==M.line?M.ch:null),f.cm&&f.cm.curOp),++St}),K.collapsed&&f.iter(E.line,M.line+1,function(ze){Lo(f,ze)&&Uo(ze,0)}),K.clearOnEnter&&Ri(K,"beforeCursorEnter",function(){return K.clear()}),K.readOnly&&(function Ma(){ya=!0}(),(f.history.done.length||f.history.undone.length)&&f.clearHistory()),K.collapsed&&(K.id=++Hu,K.atomic=!0),Ht){if($t&&(Ht.curOp.updateMaxLine=!0),K.collapsed)Zr(Ht,E.line,M.line+1);else if(K.className||K.startStyle||K.endStyle||K.css||K.attributes||K.title)for(var ke=E.line;ke<=M.line;ke++)sa(Ht,ke,"text");K.atomic&&Rc(Ht.doc),fo(Ht,"markerAdded",Ht,K)}return K}yl.prototype.clear=function(){if(!this.explicitlyCleared){var f=this.doc.cm,E=f&&!f.curOp;if(E&&Vs(f),Fi(this,"clear")){var M=this.find();M&&fo(this,"clear",M.from,M.to)}for(var D=null,P=null,K=0;K<this.lines.length;++K){var ut=this.lines[K],St=ia(ut.markedSpans,this);f&&!this.collapsed?sa(f,yo(ut),"text"):f&&(null!=St.to&&(P=yo(ut)),null!=St.from&&(D=yo(ut))),ut.markedSpans=nl(ut.markedSpans,St),null==St.from&&this.collapsed&&!Lo(this.doc,ut)&&f&&Uo(ut,ns(f.display))}if(f&&this.collapsed&&!f.options.lineWrapping)for(var Ht=0;Ht<this.lines.length;++Ht){var $t=kr(this.lines[Ht]),ke=Oa($t);ke>f.display.maxLineLength&&(f.display.maxLine=$t,f.display.maxLineLength=ke,f.display.maxLineChanged=!0)}null!=D&&f&&this.collapsed&&Zr(f,D,P+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,f&&Rc(f.doc)),f&&fo(f,"markerCleared",f,this,D,P),E&&Ka(f),this.parent&&this.parent.clear()}},yl.prototype.find=function(f,E){null==f&&"bookmark"==this.type&&(f=1);for(var M,D,P=0;P<this.lines.length;++P){var K=this.lines[P],ut=ia(K.markedSpans,this);if(null!=ut.from&&(M=Bi(E?K:yo(K),ut.from),-1==f))return M;if(null!=ut.to&&(D=Bi(E?K:yo(K),ut.to),1==f))return D}return M&&{from:M,to:D}},yl.prototype.changed=function(){var f=this,E=this.find(-1,!0),M=this,D=this.doc.cm;!E||!D||gs(D,function(){var P=E.line,K=yo(E.line),ut=Un(D,K);if(ut&&(ds(ut),D.curOp.selectionChanged=D.curOp.forceUpdate=!0),D.curOp.updateMaxLine=!0,!Lo(M.doc,P)&&null!=M.height){var St=M.height;M.height=null;var Ht=J(M)-St;Ht&&Uo(P,P.height+Ht)}fo(D,"markerChanged",D,f)})},yl.prototype.attachLine=function(f){if(!this.lines.length&&this.doc.cm){var E=this.doc.cm.curOp;(!E.maybeHiddenMarkers||-1==qe(E.maybeHiddenMarkers,this))&&(E.maybeUnhiddenMarkers||(E.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(f)},yl.prototype.detachLine=function(f){if(this.lines.splice(qe(this.lines,f),1),!this.lines.length&&this.doc.cm){var E=this.doc.cm.curOp;(E.maybeHiddenMarkers||(E.maybeHiddenMarkers=[])).push(this)}},Ni(yl);var hl=function(f,E){this.markers=f,this.primary=E;for(var M=0;M<f.length;++M)f[M].parent=this};function va(f){return f.findMarks(Bi(f.first,0),f.clipPos(Bi(f.lastLine())),function(E){return E.parent})}function Nl(f){for(var E=function(D){var P=f[D],K=[P.primary.doc];ml(P.primary.doc,function(Ht){return K.push(Ht)});for(var ut=0;ut<P.markers.length;ut++){var St=P.markers[ut];-1==qe(K,St.doc)&&(St.parent=null,P.markers.splice(ut--,1))}},M=0;M<f.length;M++)E(M)}hl.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var f=0;f<this.markers.length;++f)this.markers[f].clear();fo(this,"clear")}},hl.prototype.find=function(f,E){return this.primary.find(f,E)},Ni(hl);var Uu=0,ms=function(f,E,M,D,P){if(!(this instanceof ms))return new ms(f,E,M,D,P);null==M&&(M=0),xl.call(this,[new Xc([new hs("",null)])]),this.first=M,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=M;var K=Bi(M,0);this.sel=Il(K),this.history=new lc(null),this.id=++Uu,this.modeOption=E,this.lineSep=D,this.direction="rtl"==P?"rtl":"ltr",this.extend=!1,"string"==typeof f&&(f=this.splitLines(f)),_s(this,{from:K,to:K,text:f}),ca(this,Il(K),Me)};ms.prototype=Ee(xl.prototype,{constructor:ms,iter:function(f,E,M){M?this.iterN(f-this.first,E-f,M):this.iterN(this.first,this.first+this.size,f)},insert:function(f,E){for(var M=0,D=0;D<E.length;++D)M+=E[D].height;this.insertInner(f-this.first,E,M)},remove:function(f,E){this.removeInner(f-this.first,E)},getValue:function(f){var E=To(this,this.first,this.first+this.size);return!1===f?E:E.join(f||this.lineSeparator())},setValue:nr(function(f){var E=Bi(this.first,0),M=this.first+this.size-1;uc(this,{from:E,to:Bi(M,Ii(this,M).text.length),text:this.splitLines(f),origin:"setValue",full:!0},!0),this.cm&&q(this.cm,0,0),ca(this,Il(E),Me)}),replaceRange:function(f,E,M,D){Yl(this,f,E=Ki(this,E),M=M?Ki(this,M):E,D)},getRange:function(f,E,M){var D=Gn(this,Ki(this,f),Ki(this,E));return!1===M?D:D.join(""===M?"":M||this.lineSeparator())},getLine:function(f){var E=this.getLineHandle(f);return E&&E.text},getLineHandle:function(f){if(Qo(this,f))return Ii(this,f)},getLineNumber:function(f){return yo(f)},getLineHandleVisualStart:function(f){return"number"==typeof f&&(f=Ii(this,f)),kr(f)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(f){return Ki(this,f)},getCursor:function(f){var E=this.sel.primary();return null==f||"head"==f?E.head:"anchor"==f?E.anchor:"end"==f||"to"==f||!1===f?E.to():E.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:nr(function(f,E,M){Sc(this,Ki(this,"number"==typeof f?Bi(f,E||0):f),null,M)}),setSelection:nr(function(f,E,M){Sc(this,Ki(this,f),Ki(this,E||f),M)}),extendSelection:nr(function(f,E,M){Ol(this,Ki(this,f),E&&Ki(this,E),M)}),extendSelections:nr(function(f,E){Sa(this,ao(this,f),E)}),extendSelectionsBy:nr(function(f,E){Sa(this,ao(this,ve(this.sel.ranges,f)),E)}),setSelections:nr(function(f,E,M){if(f.length){for(var D=[],P=0;P<f.length;P++)D[P]=new Wo(Ki(this,f[P].anchor),Ki(this,f[P].head||f[P].anchor));null==E&&(E=Math.min(f.length-1,this.sel.primIndex)),ca(this,Na(this.cm,D,E),M)}}),addSelection:nr(function(f,E,M){var D=this.sel.ranges.slice(0);D.push(new Wo(Ki(this,f),Ki(this,E||f))),ca(this,Na(this.cm,D,D.length-1),M)}),getSelection:function(f){for(var M,E=this.sel.ranges,D=0;D<E.length;D++){var P=Gn(this,E[D].from(),E[D].to());M=M?M.concat(P):P}return!1===f?M:M.join(f||this.lineSeparator())},getSelections:function(f){for(var E=[],M=this.sel.ranges,D=0;D<M.length;D++){var P=Gn(this,M[D].from(),M[D].to());!1!==f&&(P=P.join(f||this.lineSeparator())),E[D]=P}return E},replaceSelection:function(f,E,M){for(var D=[],P=0;P<this.sel.ranges.length;P++)D[P]=f;this.replaceSelections(D,E,M||"+input")},replaceSelections:nr(function(f,E,M){for(var D=[],P=this.sel,K=0;K<P.ranges.length;K++){var ut=P.ranges[K];D[K]={from:ut.from(),to:ut.to(),text:this.splitLines(f[K]),origin:M}}for(var St=E&&"end"!=E&&function ih(f,E,M){for(var D=[],P=Bi(f.first,0),K=P,ut=0;ut<E.length;ut++){var St=E[ut],Ht=ic(St.from,P,K),$t=ic(Wl(St),P,K);if(P=St.to,K=$t,"around"==M){var ke=f.sel.ranges[ut],ze=On(ke.head,ke.anchor)<0;D[ut]=new Wo(ze?$t:Ht,ze?Ht:$t)}else D[ut]=new Wo(Ht,Ht)}return new ma(D,f.sel.primIndex)}(this,D,E),Ht=D.length-1;Ht>=0;Ht--)uc(this,D[Ht]);St?wu(this,St):this.cm&&ot(this.cm)}),undo:nr(function(){jl(this,"undo")}),redo:nr(function(){jl(this,"redo")}),undoSelection:nr(function(){jl(this,"undo",!0)}),redoSelection:nr(function(){jl(this,"redo",!0)}),setExtending:function(f){this.extend=f},getExtending:function(){return this.extend},historySize:function(){for(var f=this.history,E=0,M=0,D=0;D<f.done.length;D++)f.done[D].ranges||++E;for(var P=0;P<f.undone.length;P++)f.undone[P].ranges||++M;return{undo:E,redo:M}},clearHistory:function(){var f=this;this.history=new lc(this.history),ml(this,function(E){return E.history=f.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(f){return f&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(f){return this.history.generation==(f||this.cleanGeneration)},getHistory:function(){return{done:ul(this.history.done),undone:ul(this.history.undone)}},setHistory:function(f){var E=this.history=new lc(this.history);E.done=ul(f.done.slice(0),null,!0),E.undone=ul(f.undone.slice(0),null,!0)},setGutterMarker:nr(function(f,E,M){return Dc(this,f,"gutter",function(D){var P=D.gutterMarkers||(D.gutterMarkers={});return P[E]=M,!M&&le(P)&&(D.gutterMarkers=null),!0})}),clearGutter:nr(function(f){var E=this;this.iter(function(M){M.gutterMarkers&&M.gutterMarkers[f]&&Dc(E,M,"gutter",function(){return M.gutterMarkers[f]=null,le(M.gutterMarkers)&&(M.gutterMarkers=null),!0})})}),lineInfo:function(f){var E;if("number"==typeof f){if(!(Qo(this,f)&&(E=f,f=Ii(this,f))))return null}else if(null==(E=yo(f)))return null;return{line:E,handle:f,text:f.text,gutterMarkers:f.gutterMarkers,textClass:f.textClass,bgClass:f.bgClass,wrapClass:f.wrapClass,widgets:f.widgets}},addLineClass:nr(function(f,E,M){return Dc(this,f,"gutter"==E?"gutter":"class",function(D){var P="text"==E?"textClass":"background"==E?"bgClass":"gutter"==E?"gutterClass":"wrapClass";if(D[P]){if(at(M).test(D[P]))return!1;D[P]+=" "+M}else D[P]=M;return!0})}),removeLineClass:nr(function(f,E,M){return Dc(this,f,"gutter"==E?"gutter":"class",function(D){var P="text"==E?"textClass":"background"==E?"bgClass":"gutter"==E?"gutterClass":"wrapClass",K=D[P];if(!K)return!1;if(null==M)D[P]=null;else{var ut=K.match(at(M));if(!ut)return!1;var St=ut.index+ut[0].length;D[P]=K.slice(0,ut.index)+(ut.index&&St!=K.length?" ":"")+K.slice(St)||null}return!0})}),addLineWidget:nr(function(f,E,M){return function Kc(f,E,M,D){var P=new Ll(f,M,D),K=f.cm;return K&&P.noHScroll&&(K.display.alignWidgets=!0),Dc(f,E,"widget",function(ut){var St=ut.widgets||(ut.widgets=[]);if(null==P.insertAt?St.push(P):St.splice(Math.min(St.length,Math.max(0,P.insertAt)),0,P),P.line=ut,K&&!Lo(f,ut)){var Ht=hr(ut)<f.scrollTop;Uo(ut,ut.height+J(P)),Ht&&dt(K,P.height),K.curOp.forceUpdate=!0}return!0}),K&&fo(K,"lineWidgetAdded",K,P,"number"==typeof E?E:yo(E)),P}(this,f,E,M)}),removeLineWidget:function(f){f.clear()},markText:function(f,E,M){return Tl(this,Ki(this,f),Ki(this,E),M,M&&M.type||"range")},setBookmark:function(f,E){var M={replacedWith:E&&(null==E.nodeType?E.widget:E),insertLeft:E&&E.insertLeft,clearWhenEmpty:!1,shared:E&&E.shared,handleMouseEvents:E&&E.handleMouseEvents};return Tl(this,f=Ki(this,f),f,M,"bookmark")},findMarksAt:function(f){var E=[],M=Ii(this,(f=Ki(this,f)).line).markedSpans;if(M)for(var D=0;D<M.length;++D){var P=M[D];(null==P.from||P.from<=f.ch)&&(null==P.to||P.to>=f.ch)&&E.push(P.marker.parent||P.marker)}return E},findMarks:function(f,E,M){f=Ki(this,f),E=Ki(this,E);var D=[],P=f.line;return this.iter(f.line,E.line+1,function(K){var ut=K.markedSpans;if(ut)for(var St=0;St<ut.length;St++){var Ht=ut[St];!(null!=Ht.to&&P==f.line&&f.ch>=Ht.to||null==Ht.from&&P!=f.line||null!=Ht.from&&P==E.line&&Ht.from>=E.ch)&&(!M||M(Ht.marker))&&D.push(Ht.marker.parent||Ht.marker)}++P}),D},getAllMarks:function(){var f=[];return this.iter(function(E){var M=E.markedSpans;if(M)for(var D=0;D<M.length;++D)null!=M[D].from&&f.push(M[D].marker)}),f},posFromIndex:function(f){var E,M=this.first,D=this.lineSeparator().length;return this.iter(function(P){var K=P.text.length+D;if(K>f)return E=f,!0;f-=K,++M}),Ki(this,Bi(M,E))},indexFromPos:function(f){var E=(f=Ki(this,f)).ch;if(f.line<this.first||f.ch<0)return 0;var M=this.lineSeparator().length;return this.iter(this.first,f.line,function(D){E+=D.text.length+M}),E},copy:function(f){var E=new ms(To(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return E.scrollTop=this.scrollTop,E.scrollLeft=this.scrollLeft,E.sel=this.sel,E.extend=!1,f&&(E.history.undoDepth=this.history.undoDepth,E.setHistory(this.getHistory())),E},linkedDoc:function(f){f||(f={});var E=this.first,M=this.first+this.size;null!=f.from&&f.from>E&&(E=f.from),null!=f.to&&f.to<M&&(M=f.to);var D=new ms(To(this,E,M),f.mode||this.modeOption,E,this.lineSep,this.direction);return f.sharedHist&&(D.history=this.history),(this.linked||(this.linked=[])).push({doc:D,sharedHist:f.sharedHist}),D.linked=[{doc:this,isParent:!0,sharedHist:f.sharedHist}],function au(f,E){for(var M=0;M<E.length;M++){var D=E[M],P=D.find(),K=f.clipPos(P.from),ut=f.clipPos(P.to);if(On(K,ut)){var St=Tl(f,K,ut,D.primary,D.primary.type);D.markers.push(St),St.parent=D}}}(D,va(this)),D},unlinkDoc:function(f){if(f instanceof zo&&(f=f.doc),this.linked)for(var E=0;E<this.linked.length;++E)if(this.linked[E].doc==f){this.linked.splice(E,1),f.unlinkDoc(this),Nl(va(this));break}if(f.history==this.history){var D=[f.id];ml(f,function(P){return D.push(P.id)},!0),f.history=new lc(null),f.history.done=ul(this.history.done,D),f.history.undone=ul(this.history.undone,D)}},iterLinkedDocs:function(f){ml(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(f){return this.lineSep?f.split(this.lineSep):no(f)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:nr(function(f){"rtl"!=f&&(f="ltr"),f!=this.direction&&(this.direction=f,this.iter(function(E){return E.order=null}),this.cm&&function la(f){gs(f,function(){Uc(f),Zr(f)})}(this.cm))})}),ms.prototype.eachLine=ms.prototype.iter;var Mc=0;function mt(f){var E=this;if(Re(E),!_i(E,f)&&!_t(E.display,f)){mn(f),n&&(Mc=+new Date);var M=al(E,f,!0),D=f.dataTransfer.files;if(M&&!E.isReadOnly())if(D&&D.length&&window.FileReader&&window.File)for(var P=D.length,K=Array(P),ut=0,St=function(){++ut==P&&Rr(E,function(){var ui={from:M=Ki(E.doc,M),to:M,text:E.doc.splitLines(K.filter(function(xi){return null!=xi}).join(E.doc.lineSeparator())),origin:"paste"};uc(E.doc,ui),wu(E.doc,Il(Ki(E.doc,M),Ki(E.doc,Wl(ui))))})()},Ht=function(ui,xi){if(E.options.allowDropFileTypes&&-1==qe(E.options.allowDropFileTypes,ui.type))St();else{var ji=new FileReader;ji.onerror=function(){return St()},ji.onload=function(){var ln=ji.result;/[\x00-\x08\x0e-\x1f]{2}/.test(ln)||(K[xi]=ln),St()},ji.readAsText(ui)}},$t=0;$t<D.length;$t++)Ht(D[$t],$t);else{if(E.state.draggingText&&E.doc.sel.contains(M)>-1)return E.state.draggingText(f),void setTimeout(function(){return E.display.input.focus()},20);try{var ke=f.dataTransfer.getData("Text");if(ke){var ze;if(E.state.draggingText&&!E.state.draggingText.copy&&(ze=E.listSelections()),Ra(E.doc,Il(M,M)),ze)for(var pi=0;pi<ze.length;++pi)Yl(E.doc,"",ze[pi].anchor,ze[pi].head,"drag");E.replaceSelection(ke,"around","paste"),E.display.input.focus()}}catch(ui){}}}}function Re(f){f.display.dragCursor&&(f.display.lineSpace.removeChild(f.display.dragCursor),f.display.dragCursor=null)}function Ue(f){if(document.getElementsByClassName){for(var E=document.getElementsByClassName("CodeMirror"),M=[],D=0;D<E.length;D++){var P=E[D].CodeMirror;P&&M.push(P)}M.length&&M[0].operation(function(){for(var K=0;K<M.length;K++)f(M[K])})}}var ci=!1;function Ze(){ci||(function ai(){var f;Ri(window,"resize",function(){null==f&&(f=setTimeout(function(){f=null,Ue(ki)},100))}),Ri(window,"blur",function(){return Ue(xa)})}(),ci=!0)}function ki(f){var E=f.display;E.cachedCharWidth=E.cachedTextHeight=E.cachedPaddingH=null,E.scrollbarsClipped=!1,f.setSize()}for(var Ai={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Vi=0;Vi<10;Vi++)Ai[Vi+48]=Ai[Vi+96]=String(Vi);for(var to=65;to<=90;to++)Ai[to]=String.fromCharCode(to);for(var zn=1;zn<=12;zn++)Ai[zn+111]=Ai[zn+63235]="F"+zn;var ho={};function Ur(f){var E=f.split(/-(?!$)/);f=E[E.length-1];for(var M,D,P,K,ut=0;ut<E.length-1;ut++){var St=E[ut];if(/^(cmd|meta|m)$/i.test(St))K=!0;else if(/^a(lt)?$/i.test(St))M=!0;else if(/^(c|ctrl|control)$/i.test(St))D=!0;else{if(!/^s(hift)?$/i.test(St))throw new Error("Unrecognized modifier name: "+St);P=!0}}return M&&(f="Alt-"+f),D&&(f="Ctrl-"+f),K&&(f="Cmd-"+f),P&&(f="Shift-"+f),f}function br(f){var E={};for(var M in f)if(f.hasOwnProperty(M)){var D=f[M];if(/^(name|fallthrough|(de|at)tach)$/.test(M))continue;if("..."==D){delete f[M];continue}for(var P=ve(M.split(" "),Ur),K=0;K<P.length;K++){var ut=void 0,St=void 0;K==P.length-1?(St=P.join(" "),ut=D):(St=P.slice(0,K+1).join(" "),ut="...");var Ht=E[St];if(Ht){if(Ht!=ut)throw new Error("Inconsistent bindings for "+St)}else E[St]=ut}delete f[M]}for(var $t in E)f[$t]=E[$t];return f}function $o(f,E,M,D){var P=(E=ua(E)).call?E.call(f,D):E[f];if(!1===P)return"nothing";if("..."===P)return"multi";if(null!=P&&M(P))return"handled";if(E.fallthrough){if("[object Array]"!=Object.prototype.toString.call(E.fallthrough))return $o(f,E.fallthrough,M,D);for(var K=0;K<E.fallthrough.length;K++){var ut=$o(f,E.fallthrough[K],M,D);if(ut)return ut}}}function fr(f){var E="string"==typeof f?f:Ai[f.keyCode];return"Ctrl"==E||"Alt"==E||"Shift"==E||"Mod"==E}function Xr(f,E,M){var D=f;return E.altKey&&"Alt"!=D&&(f="Alt-"+f),(Ct?E.metaKey:E.ctrlKey)&&"Ctrl"!=D&&(f="Ctrl-"+f),(Ct?E.ctrlKey:E.metaKey)&&"Mod"!=D&&(f="Cmd-"+f),!M&&E.shiftKey&&"Shift"!=D&&(f="Shift-"+f),f}function mr(f,E){if(R&&34==f.keyCode&&f.char)return!1;var M=Ai[f.keyCode];return null!=M&&!f.altGraphKey&&(3==f.keyCode&&f.code&&(M=f.code),Xr(M,f,E))}function ua(f){return"string"==typeof f?ho[f]:f}function rs(f,E){for(var M=f.doc.sel.ranges,D=[],P=0;P<M.length;P++){for(var K=E(M[P]);D.length&&On(K.from,Dt(D).to)<=0;){var ut=D.pop();if(On(ut.from,K.from)<0){K.from=ut.from;break}}D.push(K)}gs(f,function(){for(var St=D.length-1;St>=0;St--)Yl(f.doc,"",D[St].from,D[St].to,"+delete");ot(f)})}function ws(f,E,M){var D=Kt(f.text,E+M,M);return D<0||D>f.text.length?null:D}function bl(f,E,M){var D=ws(f,E.ch,M);return null==D?null:new Bi(E.line,D,M<0?"after":"before")}function lu(f,E,M,D,P){if(f){"rtl"==E.doc.direction&&(P=-P);var K=di(M,E.doc.direction);if(K){var $t,ut=P<0?Dt(K):K[0],Ht=P<0==(1==ut.level)?"after":"before";if(ut.level>0||"rtl"==E.doc.direction){var ke=jn(E,M),ze=oo(E,ke,$t=P<0?M.text.length-1:0).top;$t=Zt(function(pi){return oo(E,ke,pi).top==ze},P<0==(1==ut.level)?ut.from:ut.to-1,$t),"before"==Ht&&($t=ws(M,$t,1))}else $t=P<0?ut.to:ut.from;return new Bi(D,$t,Ht)}}return new Bi(D,P<0?M.text.length:0,P<0?"before":"after")}ho.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ho.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ho.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},ho.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ho.default=gt?ho.macDefault:ho.pcDefault;var Vu={selectAll:jc,singleSelection:function(f){return f.setSelection(f.getCursor("anchor"),f.getCursor("head"),Me)},killLine:function(f){return rs(f,function(E){if(E.empty()){var M=Ii(f.doc,E.head.line).text.length;return E.head.ch==M&&E.head.line<f.lastLine()?{from:E.head,to:Bi(E.head.line+1,0)}:{from:E.head,to:Bi(E.head.line,M)}}return{from:E.from(),to:E.to()}})},deleteLine:function(f){return rs(f,function(E){return{from:Bi(E.from().line,0),to:Ki(f.doc,Bi(E.to().line+1,0))}})},delLineLeft:function(f){return rs(f,function(E){return{from:Bi(E.from().line,0),to:E.from()}})},delWrappedLineLeft:function(f){return rs(f,function(E){var M=f.charCoords(E.head,"div").top+5;return{from:f.coordsChar({left:0,top:M},"div"),to:E.from()}})},delWrappedLineRight:function(f){return rs(f,function(E){var M=f.charCoords(E.head,"div").top+5,D=f.coordsChar({left:f.display.lineDiv.offsetWidth+100,top:M},"div");return{from:E.from(),to:D}})},undo:function(f){return f.undo()},redo:function(f){return f.redo()},undoSelection:function(f){return f.undoSelection()},redoSelection:function(f){return f.redoSelection()},goDocStart:function(f){return f.extendSelection(Bi(f.firstLine(),0))},goDocEnd:function(f){return f.extendSelection(Bi(f.lastLine()))},goLineStart:function(f){return f.extendSelectionsBy(function(E){return Oc(f,E.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(f){return f.extendSelectionsBy(function(E){return Ac(f,E.head)},{origin:"+move",bias:1})},goLineEnd:function(f){return f.extendSelectionsBy(function(E){return function Gu(f,E){var M=Ii(f.doc,E),D=function tr(f){for(var E;E=oa(f);)f=E.find(1,!0).line;return f}(M);return D!=M&&(E=yo(D)),lu(!0,f,M,E,-1)}(f,E.head.line)},{origin:"+move",bias:-1})},goLineRight:function(f){return f.extendSelectionsBy(function(E){var M=f.cursorCoords(E.head,"div").top+5;return f.coordsChar({left:f.display.lineDiv.offsetWidth+100,top:M},"div")},Bt)},goLineLeft:function(f){return f.extendSelectionsBy(function(E){var M=f.cursorCoords(E.head,"div").top+5;return f.coordsChar({left:0,top:M},"div")},Bt)},goLineLeftSmart:function(f){return f.extendSelectionsBy(function(E){var M=f.cursorCoords(E.head,"div").top+5,D=f.coordsChar({left:0,top:M},"div");return D.ch<f.getLine(D.line).search(/\S/)?Ac(f,E.head):D},Bt)},goLineUp:function(f){return f.moveV(-1,"line")},goLineDown:function(f){return f.moveV(1,"line")},goPageUp:function(f){return f.moveV(-1,"page")},goPageDown:function(f){return f.moveV(1,"page")},goCharLeft:function(f){return f.moveH(-1,"char")},goCharRight:function(f){return f.moveH(1,"char")},goColumnLeft:function(f){return f.moveH(-1,"column")},goColumnRight:function(f){return f.moveH(1,"column")},goWordLeft:function(f){return f.moveH(-1,"word")},goGroupRight:function(f){return f.moveH(1,"group")},goGroupLeft:function(f){return f.moveH(-1,"group")},goWordRight:function(f){return f.moveH(1,"word")},delCharBefore:function(f){return f.deleteH(-1,"codepoint")},delCharAfter:function(f){return f.deleteH(1,"char")},delWordBefore:function(f){return f.deleteH(-1,"word")},delWordAfter:function(f){return f.deleteH(1,"word")},delGroupBefore:function(f){return f.deleteH(-1,"group")},delGroupAfter:function(f){return f.deleteH(1,"group")},indentAuto:function(f){return f.indentSelection("smart")},indentMore:function(f){return f.indentSelection("add")},indentLess:function(f){return f.indentSelection("subtract")},insertTab:function(f){return f.replaceSelection("\t")},insertSoftTab:function(f){for(var E=[],M=f.listSelections(),D=f.options.tabSize,P=0;P<M.length;P++){var K=M[P].from(),ut=Ae(f.getLine(K.line),K.ch,D);E.push(he(D-ut%D))}f.replaceSelections(E)},defaultTab:function(f){f.somethingSelected()?f.indentSelection("add"):f.execCommand("insertTab")},transposeChars:function(f){return gs(f,function(){for(var E=f.listSelections(),M=[],D=0;D<E.length;D++)if(E[D].empty()){var P=E[D].head,K=Ii(f.doc,P.line).text;if(K)if(P.ch==K.length&&(P=new Bi(P.line,P.ch-1)),P.ch>0)P=new Bi(P.line,P.ch+1),f.replaceRange(K.charAt(P.ch-1)+K.charAt(P.ch-2),Bi(P.line,P.ch-2),P,"+transpose");else if(P.line>f.doc.first){var ut=Ii(f.doc,P.line-1).text;ut&&(P=new Bi(P.line,1),f.replaceRange(K.charAt(0)+f.doc.lineSeparator()+ut.charAt(ut.length-1),Bi(P.line-1,ut.length-1),P,"+transpose"))}M.push(new Wo(P,P))}f.setSelections(M)})},newlineAndIndent:function(f){return gs(f,function(){for(var E=f.listSelections(),M=E.length-1;M>=0;M--)f.replaceRange(f.doc.lineSeparator(),E[M].anchor,E[M].head,"+input");E=f.listSelections();for(var D=0;D<E.length;D++)f.indentLine(E[D].from().line,null,!0);ot(f)})},openLine:function(f){return f.replaceSelection("\n","start")},toggleOverwrite:function(f){return f.toggleOverwrite()}};function Oc(f,E){var M=Ii(f.doc,E),D=kr(M);return D!=M&&(E=yo(D)),lu(!0,f,D,E,1)}function Ac(f,E){var M=Oc(f,E.line),D=Ii(f.doc,M.line),P=di(D,f.doc.direction);if(!P||0==P[0].level){var K=Math.max(M.ch,D.text.search(/\S/));return Bi(M.line,E.line==M.line&&E.ch<=K&&E.ch?0:K,M.sticky)}return M}function Jc(f,E,M){if("string"==typeof E&&!(E=Vu[E]))return!1;f.display.input.ensurePolled();var D=f.display.shift,P=!1;try{f.isReadOnly()&&(f.state.suppressEdits=!0),M&&(f.display.shift=!1),P=E(f)!=ei}finally{f.display.shift=D,f.state.suppressEdits=!1}return P}var oh=new Ne;function Mu(f,E,M,D){var P=f.state.keySeq;if(P){if(fr(E))return"handled";if(/\'$/.test(E)?f.state.keySeq=null:oh.set(50,function(){f.state.keySeq==P&&(f.state.keySeq=null,f.display.input.reset())}),rh(f,P+" "+E,M,D))return!0}return rh(f,E,M,D)}function rh(f,E,M,D){var P=function dc(f,E,M){for(var D=0;D<f.state.keyMaps.length;D++){var P=$o(E,f.state.keyMaps[D],M,f);if(P)return P}return f.options.extraKeys&&$o(E,f.options.extraKeys,M,f)||$o(E,f.options.keyMap,M,f)}(f,E,D);return"multi"==P&&(f.state.keySeq=E),"handled"==P&&fo(f,"keyHandled",f,E,M),("handled"==P||"multi"==P)&&(mn(M),ga(f)),!!P}function Wu(f,E){var M=mr(E,!0);return!!M&&(E.shiftKey&&!f.state.keySeq?Mu(f,"Shift-"+M,E,function(D){return Jc(f,D,!0)})||Mu(f,M,E,function(D){if("string"==typeof D?/^go[A-Z]/.test(D):D.motion)return Jc(f,D)}):Mu(f,M,E,function(D){return Jc(f,D)}))}var cu=null;function pc(f){var E=this;if(!(f.target&&f.target!=E.display.input.getField()||(E.curOp.focus=se(),_i(E,f)))){n&&o<11&&27==f.keyCode&&(f.returnValue=!1);var M=f.keyCode;E.display.shift=16==M||f.shiftKey;var D=Wu(E,f);R&&(cu=D?M:null,!D&&88==M&&!Je&&(gt?f.metaKey:f.ctrlKey)&&E.replaceSelection("",null,"cut")),C&&!gt&&!D&&46==M&&f.shiftKey&&!f.ctrlKey&&document.execCommand&&document.execCommand("cut"),18==M&&!/\bCodeMirror-crosshair\b/.test(E.display.lineDiv.className)&&function uu(f){var E=f.display.lineDiv;function M(D){(18==D.keyCode||!D.altKey)&&(ft(E,"CodeMirror-crosshair"),ge(document,"keyup",M),ge(document,"mouseover",M))}xt(E,"CodeMirror-crosshair"),Ri(document,"keyup",M),Ri(document,"mouseover",M)}(E)}}function zu(f){16==f.keyCode&&(this.doc.sel.shift=!1),_i(this,f)}function Ch(f){var E=this;if(!(f.target&&f.target!=E.display.input.getField()||_t(E.display,f)||_i(E,f)||f.ctrlKey&&!f.altKey||gt&&f.metaKey)){var M=f.keyCode,D=f.charCode;if(R&&M==cu)return cu=null,void mn(f);if(!R||f.which&&!(f.which<10)||!Wu(E,f)){var P=String.fromCharCode(null==D?M:D);"\b"!=P&&(function sh(f,E,M){return Mu(f,"'"+M+"'",E,function(D){return Jc(f,D,!0)})}(E,f,P)||E.display.input.onKeyPress(f))}}}var hu,$c,ju=function(f,E,M){this.time=f,this.pos=E,this.button=M};function ah(f){var E=this,M=E.display;if(!(_i(E,f)||M.activeTouch&&M.input.supportsTouch())){if(M.input.ensurePolled(),M.shift=f.shiftKey,_t(M,f))return void(r||(M.scroller.draggable=!1,setTimeout(function(){return M.scroller.draggable=!0},100)));if(!Zc(E,f)){var D=al(E,f),P=Gt(f),K=D?function Sh(f,E){var M=+new Date;return $c&&$c.compare(M,f,E)?(hu=$c=null,"triple"):hu&&hu.compare(M,f,E)?($c=new ju(M,f,E),hu=null,"double"):(hu=new ju(M,f,E),$c=null,"single")}(D,P):"single";window.focus(),1==P&&E.state.selectingText&&E.state.selectingText(f),(!D||!function Rh(f,E,M,D,P){var K="Click";return"double"==D?K="Double"+K:"triple"==D&&(K="Triple"+K),Mu(f,Xr(K=(1==E?"Left":2==E?"Middle":"Right")+K,P),P,function(ut){if("string"==typeof ut&&(ut=Vu[ut]),!ut)return!1;var St=!1;try{f.isReadOnly()&&(f.state.suppressEdits=!0),St=ut(f,M)!=ei}finally{f.state.suppressEdits=!1}return St})}(E,P,D,K,f))&&(1==P?D?function wh(f,E,M,D){n?setTimeout(_e(ql,f),0):f.curOp.focus=se();var ut,P=function Ih(f,E,M){var D=f.getOption("configureMouse"),P=D?D(f,E,M):{};return null==P.unit&&(P.unit=(wt?M.shiftKey&&M.metaKey:M.altKey)?"rectangle":"single"==E?"char":"double"==E?"word":"line"),(null==P.extend||f.doc.extend)&&(P.extend=f.doc.extend||M.shiftKey),null==P.addNew&&(P.addNew=gt?M.metaKey:M.ctrlKey),null==P.moveOnDrag&&(P.moveOnDrag=!(gt?M.altKey:M.ctrlKey)),P}(f,M,D),K=f.doc.sel;f.options.dragDrop&&fe&&!f.isReadOnly()&&"single"==M&&(ut=K.contains(E))>-1&&(On((ut=K.ranges[ut]).from(),E)<0||E.xRel>0)&&(On(ut.to(),E)>0||E.xRel<0)?function Ou(f,E,M,D){var P=f.display,K=!1,ut=Rr(f,function($t){r&&(P.scroller.draggable=!1),f.state.draggingText=!1,f.state.delayingBlurEvent&&(f.hasFocus()?f.state.delayingBlurEvent=!1:Xa(f)),ge(P.wrapper.ownerDocument,"mouseup",ut),ge(P.wrapper.ownerDocument,"mousemove",St),ge(P.scroller,"dragstart",Ht),ge(P.scroller,"drop",ut),K||(mn($t),D.addNew||Ol(f.doc,M,null,null,D.extend),r&&!L||n&&9==o?setTimeout(function(){P.wrapper.ownerDocument.body.focus({preventScroll:!0}),P.input.focus()},20):P.input.focus())}),St=function($t){K=K||Math.abs(E.clientX-$t.clientX)+Math.abs(E.clientY-$t.clientY)>=10},Ht=function(){return K=!0};r&&(P.scroller.draggable=!0),f.state.draggingText=ut,ut.copy=!D.moveOnDrag,Ri(P.wrapper.ownerDocument,"mouseup",ut),Ri(P.wrapper.ownerDocument,"mousemove",St),Ri(P.scroller,"dragstart",Ht),Ri(P.scroller,"drop",ut),f.state.delayingBlurEvent=!0,setTimeout(function(){return P.input.focus()},20),P.scroller.dragDrop&&P.scroller.dragDrop()}(f,D,E,P):function Dh(f,E,M,D){n&&Xa(f);var P=f.display,K=f.doc;mn(E);var ut,St,Ht=K.sel,$t=Ht.ranges;if(D.addNew&&!D.extend?(St=K.sel.contains(M),ut=St>-1?$t[St]:new Wo(M,M)):(ut=K.sel.primary(),St=K.sel.primIndex),"rectangle"==D.unit)D.addNew||(ut=new Wo(M,M)),M=al(f,E,!0,!0),St=-1;else{var ke=Au(f,M,D.unit);ut=D.extend?Yr(ut,ke.anchor,ke.head,D.extend):ke}D.addNew?-1==St?(St=$t.length,ca(K,Na(f,$t.concat([ut]),St),{scroll:!1,origin:"*mouse"})):$t.length>1&&$t[St].empty()&&"char"==D.unit&&!D.extend?(ca(K,Na(f,$t.slice(0,St).concat($t.slice(St+1)),0),{scroll:!1,origin:"*mouse"}),Ht=K.sel):oc(K,St,ut,ri):(St=0,ca(K,new ma([ut],0),ri),Ht=K.sel);var ze=M;function pi(pn){if(0!=On(ze,pn))if(ze=pn,"rectangle"==D.unit){for(var Mn=[],eo=f.options.tabSize,Zn=Ae(Ii(K,M.line).text,M.ch,eo),Ro=Ae(Ii(K,pn.line).text,pn.ch,eo),Er=Math.min(Zn,Ro),Ds=Math.max(Zn,Ro),Vr=Math.min(M.line,pn.line),Da=Math.min(f.lastLine(),Math.max(M.line,pn.line));Vr<=Da;Vr++){var Fa=Ii(K,Vr).text,ys=Ie(Fa,Er,eo);Er==Ds?Mn.push(new Wo(Bi(Vr,ys),Bi(Vr,ys))):Fa.length>ys&&Mn.push(new Wo(Bi(Vr,ys),Bi(Vr,Ie(Fa,Ds,eo))))}Mn.length||Mn.push(new Wo(M,M)),ca(K,Na(f,Ht.ranges.slice(0,St).concat(Mn),St),{origin:"*mouse",scroll:!1}),f.scrollIntoView(pn)}else{var S,Xo=ut,as=Au(f,pn,D.unit),ls=Xo.anchor;On(as.anchor,ls)>0?(S=as.head,ls=Mi(Xo.from(),as.anchor)):(S=as.anchor,ls=Fe(Xo.to(),as.head));var U=Ht.ranges.slice(0);U[St]=function fc(f,E){var M=E.anchor,D=E.head,P=Ii(f.doc,M.line);if(0==On(M,D)&&M.sticky==D.sticky)return E;var K=di(P);if(!K)return E;var ut=Ti(K,M.ch,M.sticky),St=K[ut];if(St.from!=M.ch&&St.to!=M.ch)return E;var $t,Ht=ut+(St.from==M.ch==(1!=St.level)?0:1);if(0==Ht||Ht==K.length)return E;if(D.line!=M.line)$t=(D.line-M.line)*("ltr"==f.doc.direction?1:-1)>0;else{var ke=Ti(K,D.ch,D.sticky),ze=ke-ut||(D.ch-M.ch)*(1==St.level?-1:1);$t=ke==Ht-1||ke==Ht?ze<0:ze>0}var pi=K[Ht+($t?-1:0)],ui=$t==(1==pi.level),xi=ui?pi.from:pi.to,ji=ui?"after":"before";return M.ch==xi&&M.sticky==ji?E:new Wo(new Bi(M.line,xi,ji),D)}(f,new Wo(Ki(K,ls),S)),ca(K,Na(f,U,St),ri)}}var ui=P.wrapper.getBoundingClientRect(),xi=0;function ji(pn){var Mn=++xi,eo=al(f,pn,!0,"rectangle"==D.unit);if(eo)if(0!=On(eo,ze)){f.curOp.focus=se(),pi(eo);var Zn=Cl(P,K);(eo.line>=Zn.to||eo.line<Zn.from)&&setTimeout(Rr(f,function(){xi==Mn&&ji(pn)}),150)}else{var Ro=pn.clientY<ui.top?-20:pn.clientY>ui.bottom?20:0;Ro&&setTimeout(Rr(f,function(){xi==Mn&&(P.scroller.scrollTop+=Ro,ji(pn))}),50)}}function ln(pn){f.state.selectingText=!1,xi=1/0,pn&&(mn(pn),P.input.focus()),ge(P.wrapper.ownerDocument,"mousemove",vn),ge(P.wrapper.ownerDocument,"mouseup",Dn),K.history.lastSelOrigin=null}var vn=Rr(f,function(pn){0!==pn.buttons&&Gt(pn)?ji(pn):ln(pn)}),Dn=Rr(f,ln);f.state.selectingText=Dn,Ri(P.wrapper.ownerDocument,"mousemove",vn),Ri(P.wrapper.ownerDocument,"mouseup",Dn)}(f,D,E,P)}(E,D,K,f):vt(f)==M.scroller&&mn(f):2==P?(D&&Ol(E.doc,D),setTimeout(function(){return M.input.focus()},20)):3==P&&(bt?E.display.input.onContextMenu(f):Xa(E)))}}}function Au(f,E,M){if("char"==M)return new Wo(E,E);if("word"==M)return f.findWordAt(E);if("line"==M)return new Wo(Bi(E.line,0),Ki(f.doc,Bi(E.line+1,0)));var D=M(f,E);return new Wo(D.from,D.to)}function wa(f,E,M,D){var P,K;if(E.touches)P=E.touches[0].clientX,K=E.touches[0].clientY;else try{P=E.clientX,K=E.clientY}catch(pi){return!1}if(P>=Math.floor(f.display.gutters.getBoundingClientRect().right))return!1;D&&mn(E);var ut=f.display,St=ut.lineDiv.getBoundingClientRect();if(K>St.bottom||!Fi(f,M))return Ce(E);K-=St.top-ut.viewOffset;for(var Ht=0;Ht<f.display.gutterSpecs.length;++Ht){var $t=ut.gutters.childNodes[Ht];if($t&&$t.getBoundingClientRect().right>=P)return De(f,M,f,Mo(f.doc,K),f.display.gutterSpecs[Ht].className,E),Ce(E)}}function Zc(f,E){return wa(f,E,"gutterClick",!0)}function Xl(f,E){_t(f.display,E)||function lh(f,E){return!!Fi(f,"gutterContextMenu")&&wa(f,E,"gutterContextMenu",!1)}(f,E)||_i(f,E,"contextmenu")||bt||f.display.input.onContextMenu(E)}function ha(f){f.display.wrapper.className=f.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+f.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Js(f)}ju.prototype.compare=function(f,E,M){return this.time+400>f&&0==On(E,this.pos)&&M==this.button};var Pl={toString:function(){return"CodeMirror.Init"}},Qc={},du={};function kc(f,E,M){if(!E!=!(M&&M!=Pl)){var P=f.display.dragFunctions,K=E?Ri:ge;K(f.display.scroller,"dragstart",P.start),K(f.display.scroller,"dragenter",P.enter),K(f.display.scroller,"dragover",P.over),K(f.display.scroller,"dragleave",P.leave),K(f.display.scroller,"drop",P.drop)}}function ch(f){f.options.lineWrapping?(xt(f.display.wrapper,"CodeMirror-wrap"),f.display.sizer.style.minWidth="",f.display.sizerWidth=null):(ft(f.display.wrapper,"CodeMirror-wrap"),Wa(f)),Zl(f),Zr(f),Js(f),setTimeout(function(){return Jo(f)},100)}function zo(f,E){var M=this;if(!(this instanceof zo))return new zo(f,E);this.options=E=E?ce(E):{},ce(Qc,E,!1);var D=E.value;"string"==typeof D?D=new ms(D,E.mode,null,E.lineSeparator,E.direction):E.mode&&(D.modeOption=E.mode),this.doc=D;var P=new zo.inputStyles[E.inputStyle](this),K=this.display=new Ca(f,D,P,E);for(var ut in K.wrapper.CodeMirror=this,ha(this),E.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Us(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new Ne,keySeq:null,specialChars:null},E.autofocus&&!It&&K.input.focus(),n&&o<11&&setTimeout(function(){return M.display.input.reset(!0)},20),function Oh(f){var E=f.display;Ri(E.scroller,"mousedown",Rr(f,ah)),Ri(E.scroller,"dblclick",n&&o<11?Rr(f,function(Ht){if(!_i(f,Ht)){var $t=al(f,Ht);if($t&&!Zc(f,Ht)&&!_t(f.display,Ht)){mn(Ht);var ke=f.findWordAt($t);Ol(f.doc,ke.anchor,ke.head)}}}):function(Ht){return _i(f,Ht)||mn(Ht)}),Ri(E.scroller,"contextmenu",function(Ht){return Xl(f,Ht)}),Ri(E.input.getField(),"contextmenu",function(Ht){E.scroller.contains(Ht.target)||Xl(f,Ht)});var M,D={end:0};function P(){E.activeTouch&&(M=setTimeout(function(){return E.activeTouch=null},1e3),(D=E.activeTouch).end=+new Date)}function K(Ht){if(1!=Ht.touches.length)return!1;var $t=Ht.touches[0];return $t.radiusX<=1&&$t.radiusY<=1}function ut(Ht,$t){if(null==$t.left)return!0;var ke=$t.left-Ht.left,ze=$t.top-Ht.top;return ke*ke+ze*ze>400}Ri(E.scroller,"touchstart",function(Ht){if(!_i(f,Ht)&&!K(Ht)&&!Zc(f,Ht)){E.input.ensurePolled(),clearTimeout(M);var $t=+new Date;E.activeTouch={start:$t,moved:!1,prev:$t-D.end<=300?D:null},1==Ht.touches.length&&(E.activeTouch.left=Ht.touches[0].pageX,E.activeTouch.top=Ht.touches[0].pageY)}}),Ri(E.scroller,"touchmove",function(){E.activeTouch&&(E.activeTouch.moved=!0)}),Ri(E.scroller,"touchend",function(Ht){var $t=E.activeTouch;if($t&&!_t(E,Ht)&&null!=$t.left&&!$t.moved&&new Date-$t.start<300){var ze,ke=f.coordsChar(E.activeTouch,"page");ze=!$t.prev||ut($t,$t.prev)?new Wo(ke,ke):!$t.prev.prev||ut($t,$t.prev.prev)?f.findWordAt(ke):new Wo(Bi(ke.line,0),Ki(f.doc,Bi(ke.line+1,0))),f.setSelection(ze.anchor,ze.head),f.focus(),mn(Ht)}P()}),Ri(E.scroller,"touchcancel",P),Ri(E.scroller,"scroll",function(){E.scroller.clientHeight&&(Ve(f,E.scroller.scrollTop),Li(f,E.scroller.scrollLeft,!0),De(f,"scroll",f))}),Ri(E.scroller,"mousewheel",function(Ht){return Hc(f,Ht)}),Ri(E.scroller,"DOMMouseScroll",function(Ht){return Hc(f,Ht)}),Ri(E.wrapper,"scroll",function(){return E.wrapper.scrollTop=E.wrapper.scrollLeft=0}),E.dragFunctions={enter:function(Ht){_i(f,Ht)||Vt(Ht)},over:function(Ht){_i(f,Ht)||(function te(f,E){var M=al(f,E);if(M){var D=document.createDocumentFragment();fl(f,M,D),f.display.dragCursor||(f.display.dragCursor=Mt("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),f.display.lineSpace.insertBefore(f.display.dragCursor,f.display.cursorDiv)),Ft(f.display.dragCursor,D)}}(f,Ht),Vt(Ht))},start:function(Ht){return function Rt(f,E){if(n&&(!f.state.draggingText||+new Date-Mc<100))Vt(E);else if(!_i(f,E)&&!_t(f.display,E)&&(E.dataTransfer.setData("Text",f.getSelection()),E.dataTransfer.effectAllowed="copyMove",E.dataTransfer.setDragImage&&!L)){var M=Mt("img",null,null,"position: fixed; left: 0; top: 0;");M.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",R&&(M.width=M.height=1,f.display.wrapper.appendChild(M),M._top=M.offsetTop),E.dataTransfer.setDragImage(M,0,0),R&&M.parentNode.removeChild(M)}}(f,Ht)},drop:Rr(f,mt),leave:function(Ht){_i(f,Ht)||Re(f)}};var St=E.input.getField();Ri(St,"keyup",function(Ht){return zu.call(f,Ht)}),Ri(St,"keydown",Rr(f,pc)),Ri(St,"keypress",Rr(f,Ch)),Ri(St,"focus",function(Ht){return qs(f,Ht)}),Ri(St,"blur",function(Ht){return xa(f,Ht)})}(this),Ze(),Vs(this),this.curOp.forceUpdate=!0,Ao(this,D),E.autofocus&&!It||this.hasFocus()?setTimeout(function(){M.hasFocus()&&!M.state.focused&&qs(M)},20):xa(this),du)du.hasOwnProperty(ut)&&du[ut](this,E[ut],Pl);Gl(this),E.finishInit&&E.finishInit(this);for(var St=0;St<pu.length;++St)pu[St](this);Ka(this),r&&E.lineWrapping&&"optimizelegibility"==getComputedStyle(K.lineDiv).textRendering&&(K.lineDiv.style.textRendering="auto")}zo.defaults=Qc,zo.optionHandlers=du;var pu=[];function xc(f,E,M,D){var K,P=f.doc;null==M&&(M="add"),"smart"==M&&(P.mode.indent?K=rr(f,E).state:M="prev");var ut=f.options.tabSize,St=Ii(P,E),Ht=Ae(St.text,null,ut);St.stateAfter&&(St.stateAfter=null);var ke,$t=St.text.match(/^\s*/)[0];if(D||/\S/.test(St.text)){if("smart"==M&&((ke=P.mode.indent(K,St.text.slice($t.length),St.text))==ei||ke>150)){if(!D)return;M="prev"}}else ke=0,M="not";"prev"==M?ke=E>P.first?Ae(Ii(P,E-1).text,null,ut):0:"add"==M?ke=Ht+f.options.indentUnit:"subtract"==M?ke=Ht-f.options.indentUnit:"number"==typeof M&&(ke=Ht+M),ke=Math.max(0,ke);var ze="",pi=0;if(f.options.indentWithTabs)for(var ui=Math.floor(ke/ut);ui;--ui)pi+=ut,ze+="\t";if(pi<ke&&(ze+=he(ke-pi)),ze!=$t)return Yl(P,ze,Bi(E,0),Bi(E,$t.length),"+input"),St.stateAfter=null,!0;for(var xi=0;xi<P.sel.ranges.length;xi++){var ji=P.sel.ranges[xi];if(ji.head.line==E&&ji.head.ch<$t.length){var ln=Bi(E,$t.length);oc(P,xi,new Wo(ln,ln));break}}}zo.defineInitHook=function(f){return pu.push(f)};var El=null;function Lc(f){El=f}function fu(f,E,M,D,P){var K=f.doc;f.display.shift=!1,D||(D=K.sel);var ut=+new Date-200,St="paste"==P||f.state.pasteIncoming>ut,Ht=no(E),$t=null;if(St&&D.ranges.length>1)if(El&&El.text.join("\n")==E){if(D.ranges.length%El.text.length==0){$t=[];for(var ke=0;ke<El.text.length;ke++)$t.push(K.splitLines(El.text[ke]))}}else Ht.length==D.ranges.length&&f.options.pasteLinesPerSelection&&($t=ve(Ht,function(vn){return[vn]}));for(var ze=f.curOp.updateInput,pi=D.ranges.length-1;pi>=0;pi--){var ui=D.ranges[pi],xi=ui.from(),ji=ui.to();ui.empty()&&(M&&M>0?xi=Bi(xi.line,xi.ch-M):f.state.overwrite&&!St?ji=Bi(ji.line,Math.min(Ii(K,ji.line).text.length,ji.ch+Dt(Ht).length)):St&&El&&El.lineWise&&El.text.join("\n")==Ht.join("\n")&&(xi=ji=Bi(xi.line,0)));var ln={from:xi,to:ji,text:$t?$t[pi%$t.length]:Ht,origin:P||(St?"paste":f.state.cutIncoming>ut?"cut":"+input")};uc(f.doc,ln),fo(f,"inputRead",f,ln)}E&&!St&&uh(f,E),ot(f),f.curOp.updateInput<2&&(f.curOp.updateInput=ze),f.curOp.typing=!0,f.state.pasteIncoming=f.state.cutIncoming=-1}function ku(f,E){var M=f.clipboardData&&f.clipboardData.getData("Text");if(M)return f.preventDefault(),!E.isReadOnly()&&!E.options.disableInput&&gs(E,function(){return fu(E,M,0,null,"paste")}),!0}function uh(f,E){if(f.options.electricChars&&f.options.smartIndent)for(var M=f.doc.sel,D=M.ranges.length-1;D>=0;D--){var P=M.ranges[D];if(!(P.head.ch>100||D&&M.ranges[D-1].head.line==P.head.line)){var K=f.getModeAt(P.head),ut=!1;if(K.electricChars){for(var St=0;St<K.electricChars.length;St++)if(E.indexOf(K.electricChars.charAt(St))>-1){ut=xc(f,P.head.line,"smart");break}}else K.electricInput&&K.electricInput.test(Ii(f.doc,P.head.line).text.slice(0,P.head.ch))&&(ut=xc(f,P.head.line,"smart"));ut&&fo(f,"electricInput",f,P.head.line)}}}function Kl(f){for(var E=[],M=[],D=0;D<f.doc.sel.ranges.length;D++){var P=f.doc.sel.ranges[D].head.line,K={anchor:Bi(P,0),head:Bi(P+1,0)};M.push(K),E.push(f.getRange(K.anchor,K.head))}return{text:E,ranges:M}}function gu(f,E,M,D){f.setAttribute("autocorrect",M?"":"off"),f.setAttribute("autocapitalize",D?"":"off"),f.setAttribute("spellcheck",!!E)}function qc(){var f=Mt("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),E=Mt("div",[f],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return r?f.style.width="1000px":f.setAttribute("wrap","off"),et&&(f.style.border="1px solid black"),gu(f),E}function gc(f,E,M,D,P){var K=E,ut=M,St=Ii(f,E.line),Ht=P&&"rtl"==f.direction?-M:M;function ke(Dn){var pn;if("codepoint"==D){var Mn=St.text.charCodeAt(E.ch+(M>0?0:-1));pn=isNaN(Mn)?null:new Bi(E.line,Math.max(0,Math.min(St.text.length,E.ch+M*((M>0?Mn>=55296&&Mn<56320:Mn>=56320&&Mn<57343)?2:1))),-M)}else pn=P?function Gh(f,E,M,D){var P=di(E,f.doc.direction);if(!P)return bl(E,M,D);M.ch>=E.text.length?(M.ch=E.text.length,M.sticky="before"):M.ch<=0&&(M.ch=0,M.sticky="after");var K=Ti(P,M.ch,M.sticky),ut=P[K];if("ltr"==f.doc.direction&&ut.level%2==0&&(D>0?ut.to>M.ch:ut.from<M.ch))return bl(E,M,D);var Ht,St=function(vn,Dn){return ws(E,vn instanceof Bi?vn.ch:vn,Dn)},$t=function(vn){return f.options.lineWrapping?(Ht=Ht||jn(f,E),Eo(f,E,Ht,vn)):{begin:0,end:E.text.length}},ke=$t("before"==M.sticky?St(M,-1):M.ch);if("rtl"==f.doc.direction||1==ut.level){var ze=1==ut.level==D<0,pi=St(M,ze?1:-1);if(null!=pi&&(ze?pi<=ut.to&&pi<=ke.end:pi>=ut.from&&pi>=ke.begin))return new Bi(M.line,pi,ze?"before":"after")}var xi=function(vn,Dn,pn){for(;vn>=0&&vn<P.length;vn+=Dn){var eo=P[vn],Zn=Dn>0==(1!=eo.level),Ro=Zn?pn.begin:St(pn.end,-1);if(eo.from<=Ro&&Ro<eo.to||(Ro=Zn?eo.from:St(eo.to,-1),pn.begin<=Ro&&Ro<pn.end))return Er=Ro,Zn?new Bi(M.line,St(Er,1),"before"):new Bi(M.line,Er,"after")}var Er},ji=xi(K+D,D,ke);if(ji)return ji;var ln=D>0?ke.end:St(ke.begin,-1);return null==ln||D>0&&ln==E.text.length||!(ji=xi(D>0?0:P.length-1,D,$t(ln)))?null:ji}(f.cm,St,E,M):bl(St,E,M);if(null==pn){if(Dn||!function $t(){var Dn=E.line+Ht;return!(Dn<f.first||Dn>=f.first+f.size)&&(E=new Bi(Dn,E.ch,E.sticky),St=Ii(f,Dn))}())return!1;E=lu(P,f.cm,St,E.line,Ht)}else E=pn;return!0}if("char"==D||"codepoint"==D)ke();else if("column"==D)ke(!0);else if("word"==D||"group"==D)for(var ze=null,pi="group"==D,ui=f.cm&&f.cm.getHelper(E,"wordChars"),xi=!0;!(M<0)||ke(!xi);xi=!1){var ji=St.text.charAt(E.ch)||"\n",ln=Oe(ji,ui)?"w":pi&&"\n"==ji?"n":!pi||/\s/.test(ji)?null:"p";if(pi&&!xi&&!ln&&(ln="s"),ze&&ze!=ln){M<0&&(M=1,ke(),E.sticky="after");break}if(ln&&(ze=ln),M>0&&!ke(!xi))break}var vn=zc(f,E,K,ut,!0);return Wn(K,vn)&&(vn.hitSide=!0),vn}function _u(f,E,M,D){var ut,$t,P=f.doc,K=E.left;if("page"==D){var St=Math.min(f.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),Ht=Math.max(St-.5*ns(f.display),3);ut=(M>0?E.bottom:E.top)+M*Ht}else"line"==D&&(ut=M>0?E.bottom+3:E.top-3);for(;($t=Nn(f,K,ut)).outside;){if(M<0?ut<=0:ut>=P.height){$t.hitSide=!0;break}ut+=5*M}return $t}var ur=function(f){this.cm=f,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Ne,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function Ah(f,E){var M=Un(f,E.line);if(!M||M.hidden)return null;var D=Ii(f.doc,E.line),P=Tn(M,D,E.line),K=di(D,f.doc.direction),ut="left";K&&(ut=Ti(K,E.ch)%2?"right":"left");var Ht=dr(P.map,E.ch,ut);return Ht.offset="right"==Ht.collapse?Ht.end:Ht.start,Ht}function Pa(f,E){return E&&(f.bad=!0),f}function xu(f,E,M){var D;if(E==f.display.lineDiv){if(!(D=f.display.lineDiv.childNodes[M]))return Pa(f.clipPos(Bi(f.display.viewTo-1)),!0);E=null,M=0}else for(D=E;;D=D.parentNode){if(!D||D==f.display.lineDiv)return null;if(D.parentNode&&D.parentNode==f.display.lineDiv)break}for(var P=0;P<f.display.view.length;P++){var K=f.display.view[P];if(K.node==D)return hh(K,E,M)}}function hh(f,E,M){var D=f.text.firstChild,P=!1;if(!E||!rt(D,E))return Pa(Bi(yo(f.line),0),!0);if(E==D&&(P=!0,E=D.childNodes[M],M=0,!E)){var K=f.rest?Dt(f.rest):f.line;return Pa(Bi(yo(K),K.text.length),P)}var ut=3==E.nodeType?E:null,St=E;for(!ut&&1==E.childNodes.length&&3==E.firstChild.nodeType&&(ut=E.firstChild,M&&(M=ut.nodeValue.length));St.parentNode!=D;)St=St.parentNode;var Ht=f.measure,$t=Ht.maps;function ke(ln,vn,Dn){for(var pn=-1;pn<($t?$t.length:0);pn++)for(var Mn=pn<0?Ht.map:$t[pn],eo=0;eo<Mn.length;eo+=3){var Zn=Mn[eo+2];if(Zn==ln||Zn==vn){var Ro=yo(pn<0?f.line:f.rest[pn]),Er=Mn[eo]+Dn;return(Dn<0||Zn!=ln)&&(Er=Mn[eo+(Dn?1:0)]),Bi(Ro,Er)}}}var ze=ke(ut,St,M);if(ze)return Pa(ze,P);for(var pi=St.nextSibling,ui=ut?ut.nodeValue.length-M:0;pi;pi=pi.nextSibling){if(ze=ke(pi,pi.firstChild,0))return Pa(Bi(ze.line,ze.ch-ui),P);ui+=pi.textContent.length}for(var xi=St.previousSibling,ji=M;xi;xi=xi.previousSibling){if(ze=ke(xi,xi.firstChild,-1))return Pa(Bi(ze.line,ze.ch+ji),P);ji+=xi.textContent.length}}ur.prototype.init=function(f){var E=this,M=this,D=M.cm,P=M.div=f.lineDiv;function K(St){for(var Ht=St.target;Ht;Ht=Ht.parentNode){if(Ht==P)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(Ht.className))break}return!1}function ut(St){if(K(St)&&!_i(D,St)){if(D.somethingSelected())Lc({lineWise:!1,text:D.getSelections()}),"cut"==St.type&&D.replaceSelection("",null,"cut");else{if(!D.options.lineWiseCopyCut)return;var Ht=Kl(D);Lc({lineWise:!0,text:Ht.text}),"cut"==St.type&&D.operation(function(){D.setSelections(Ht.ranges,0,Me),D.replaceSelection("",null,"cut")})}if(St.clipboardData){St.clipboardData.clearData();var $t=El.text.join("\n");if(St.clipboardData.setData("Text",$t),St.clipboardData.getData("Text")==$t)return void St.preventDefault()}var ke=qc(),ze=ke.firstChild;D.display.lineSpace.insertBefore(ke,D.display.lineSpace.firstChild),ze.value=El.text.join("\n");var pi=se();de(ze),setTimeout(function(){D.display.lineSpace.removeChild(ke),pi.focus(),pi==P&&M.showPrimarySelection()},50)}}P.contentEditable=!0,gu(P,D.options.spellcheck,D.options.autocorrect,D.options.autocapitalize),Ri(P,"paste",function(St){!K(St)||_i(D,St)||ku(St,D)||o<=11&&setTimeout(Rr(D,function(){return E.updateFromDOM()}),20)}),Ri(P,"compositionstart",function(St){E.composing={data:St.data,done:!1}}),Ri(P,"compositionupdate",function(St){E.composing||(E.composing={data:St.data,done:!1})}),Ri(P,"compositionend",function(St){E.composing&&(St.data!=E.composing.data&&E.readFromDOMSoon(),E.composing.done=!0)}),Ri(P,"touchstart",function(){return M.forceCompositionEnd()}),Ri(P,"input",function(){E.composing||E.readFromDOMSoon()}),Ri(P,"copy",ut),Ri(P,"cut",ut)},ur.prototype.screenReaderLabelChanged=function(f){f?this.div.setAttribute("aria-label",f):this.div.removeAttribute("aria-label")},ur.prototype.prepareSelection=function(){var f=cl(this.cm,!1);return f.focus=se()==this.div,f},ur.prototype.showSelection=function(f,E){!f||!this.cm.display.view.length||((f.focus||E)&&this.showPrimarySelection(),this.showMultipleSelections(f))},ur.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},ur.prototype.showPrimarySelection=function(){var f=this.getSelection(),E=this.cm,M=E.doc.sel.primary(),D=M.from(),P=M.to();if(E.display.viewTo==E.display.viewFrom||D.line>=E.display.viewTo||P.line<E.display.viewFrom)f.removeAllRanges();else{var K=xu(E,f.anchorNode,f.anchorOffset),ut=xu(E,f.focusNode,f.focusOffset);if(!K||K.bad||!ut||ut.bad||0!=On(Mi(K,ut),D)||0!=On(Fe(K,ut),P)){var St=E.display.view,Ht=D.line>=E.display.viewFrom&&Ah(E,D)||{node:St[0].measure.map[2],offset:0},$t=P.line<E.display.viewTo&&Ah(E,P);if(!$t){var ke=St[St.length-1].measure,ze=ke.maps?ke.maps[ke.maps.length-1]:ke.map;$t={node:ze[ze.length-1],offset:ze[ze.length-2]-ze[ze.length-3]}}if(!Ht||!$t)return void f.removeAllRanges();var ui,pi=f.rangeCount&&f.getRangeAt(0);try{ui=ct(Ht.node,Ht.offset,$t.offset,$t.node)}catch(xi){}ui&&(!C&&E.state.focused?(f.collapse(Ht.node,Ht.offset),ui.collapsed||(f.removeAllRanges(),f.addRange(ui))):(f.removeAllRanges(),f.addRange(ui)),pi&&null==f.anchorNode?f.addRange(pi):C&&this.startGracePeriod()),this.rememberSelection()}}},ur.prototype.startGracePeriod=function(){var f=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){f.gracePeriod=!1,f.selectionChanged()&&f.cm.operation(function(){return f.cm.curOp.selectionChanged=!0})},20)},ur.prototype.showMultipleSelections=function(f){Ft(this.cm.display.cursorDiv,f.cursors),Ft(this.cm.display.selectionDiv,f.selection)},ur.prototype.rememberSelection=function(){var f=this.getSelection();this.lastAnchorNode=f.anchorNode,this.lastAnchorOffset=f.anchorOffset,this.lastFocusNode=f.focusNode,this.lastFocusOffset=f.focusOffset},ur.prototype.selectionInEditor=function(){var f=this.getSelection();if(!f.rangeCount)return!1;var E=f.getRangeAt(0).commonAncestorContainer;return rt(this.div,E)},ur.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&((!this.selectionInEditor()||se()!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},ur.prototype.blur=function(){this.div.blur()},ur.prototype.getField=function(){return this.div},ur.prototype.supportsTouch=function(){return!0},ur.prototype.receivedFocus=function(){var f=this,E=this;this.selectionInEditor()?setTimeout(function(){return f.pollSelection()},20):gs(this.cm,function(){return E.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function M(){E.cm.state.focused&&(E.pollSelection(),E.polling.set(E.cm.options.pollInterval,M))})},ur.prototype.selectionChanged=function(){var f=this.getSelection();return f.anchorNode!=this.lastAnchorNode||f.anchorOffset!=this.lastAnchorOffset||f.focusNode!=this.lastFocusNode||f.focusOffset!=this.lastFocusOffset},ur.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var f=this.getSelection(),E=this.cm;if(Et&&h&&this.cm.display.gutterSpecs.length&&function mu(f){for(var E=f;E;E=E.parentNode)if(/CodeMirror-gutter-wrapper/.test(E.className))return!0;return!1}(f.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var M=xu(E,f.anchorNode,f.anchorOffset),D=xu(E,f.focusNode,f.focusOffset);M&&D&&gs(E,function(){ca(E.doc,Il(M,D),Me),(M.bad||D.bad)&&(E.curOp.selectionChanged=!0)})}}},ur.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var K,ut,St,f=this.cm,E=f.display,M=f.doc.sel.primary(),D=M.from(),P=M.to();if(0==D.ch&&D.line>f.firstLine()&&(D=Bi(D.line-1,Ii(f.doc,D.line-1).length)),P.ch==Ii(f.doc,P.line).text.length&&P.line<f.lastLine()&&(P=Bi(P.line+1,0)),D.line<E.viewFrom||P.line>E.viewTo-1)return!1;D.line==E.viewFrom||0==(K=Bs(f,D.line))?(ut=yo(E.view[0].line),St=E.view[0].node):(ut=yo(E.view[K].line),St=E.view[K-1].node.nextSibling);var $t,ke,Ht=Bs(f,P.line);if(Ht==E.view.length-1?($t=E.viewTo-1,ke=E.lineDiv.lastChild):($t=yo(E.view[Ht+1].line)-1,ke=E.view[Ht+1].node.previousSibling),!St)return!1;for(var ze=f.doc.splitLines(function Fl(f,E,M,D,P){var K="",ut=!1,St=f.doc.lineSeparator(),Ht=!1;function ke(){ut&&(K+=St,Ht&&(K+=St),ut=Ht=!1)}function ze(ui){ui&&(ke(),K+=ui)}function pi(ui){if(1==ui.nodeType){var xi=ui.getAttribute("cm-text");if(xi)return void ze(xi);var ln,ji=ui.getAttribute("cm-marker");if(ji){var vn=f.findMarks(Bi(D,0),Bi(P+1,0),function $t(ui){return function(xi){return xi.id==ui}}(+ji));return void(vn.length&&(ln=vn[0].find(0))&&ze(Gn(f.doc,ln.from,ln.to).join(St)))}if("false"==ui.getAttribute("contenteditable"))return;var Dn=/^(pre|div|p|li|table|br)$/i.test(ui.nodeName);if(!/^br$/i.test(ui.nodeName)&&0==ui.textContent.length)return;Dn&&ke();for(var pn=0;pn<ui.childNodes.length;pn++)pi(ui.childNodes[pn]);/^(pre|p)$/i.test(ui.nodeName)&&(Ht=!0),Dn&&(ut=!0)}else 3==ui.nodeType&&ze(ui.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;pi(E),E!=M;)E=E.nextSibling,Ht=!1;return K}(f,St,ke,ut,$t)),pi=Gn(f.doc,Bi(ut,0),Bi($t,Ii(f.doc,$t).text.length));ze.length>1&&pi.length>1;)if(Dt(ze)==Dt(pi))ze.pop(),pi.pop(),$t--;else{if(ze[0]!=pi[0])break;ze.shift(),pi.shift(),ut++}for(var ui=0,xi=0,ji=ze[0],ln=pi[0],vn=Math.min(ji.length,ln.length);ui<vn&&ji.charCodeAt(ui)==ln.charCodeAt(ui);)++ui;for(var Dn=Dt(ze),pn=Dt(pi),Mn=Math.min(Dn.length-(1==ze.length?ui:0),pn.length-(1==pi.length?ui:0));xi<Mn&&Dn.charCodeAt(Dn.length-xi-1)==pn.charCodeAt(pn.length-xi-1);)++xi;if(1==ze.length&&1==pi.length&&ut==D.line)for(;ui&&ui>D.ch&&Dn.charCodeAt(Dn.length-xi-1)==pn.charCodeAt(pn.length-xi-1);)ui--,xi++;ze[ze.length-1]=Dn.slice(0,Dn.length-xi).replace(/^\u200b+/,""),ze[0]=ze[0].slice(ui).replace(/\u200b+$/,"");var eo=Bi(ut,ui),Zn=Bi($t,pi.length?Dt(pi).length-xi:0);return ze.length>1||ze[0]||On(eo,Zn)?(Yl(f.doc,ze,eo,Zn,"+input"),!0):void 0},ur.prototype.ensurePolled=function(){this.forceCompositionEnd()},ur.prototype.reset=function(){this.forceCompositionEnd()},ur.prototype.forceCompositionEnd=function(){!this.composing||(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},ur.prototype.readFromDOMSoon=function(){var f=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(f.readDOMTimeout=null,f.composing){if(!f.composing.done)return;f.composing=null}f.updateFromDOM()},80))},ur.prototype.updateFromDOM=function(){var f=this;(this.cm.isReadOnly()||!this.pollContent())&&gs(this.cm,function(){return Zr(f.cm)})},ur.prototype.setUneditable=function(f){f.contentEditable="false"},ur.prototype.onKeyPress=function(f){0==f.charCode||this.composing||(f.preventDefault(),this.cm.isReadOnly()||Rr(this.cm,fu)(this.cm,String.fromCharCode(null==f.charCode?f.keyCode:f.charCode),0))},ur.prototype.readOnlyChanged=function(f){this.div.contentEditable=String("nocursor"!=f)},ur.prototype.onContextMenu=function(){},ur.prototype.resetPosition=function(){},ur.prototype.needsContentAttribute=!0;var vs=function(f){this.cm=f,this.prevInput="",this.pollingFast=!1,this.polling=new Ne,this.hasSelection=!1,this.composing=null};vs.prototype.init=function(f){var E=this,M=this,D=this.cm;this.createField(f);var P=this.textarea;function K(ut){if(!_i(D,ut)){if(D.somethingSelected())Lc({lineWise:!1,text:D.getSelections()});else{if(!D.options.lineWiseCopyCut)return;var St=Kl(D);Lc({lineWise:!0,text:St.text}),"cut"==ut.type?D.setSelections(St.ranges,null,Me):(M.prevInput="",P.value=St.text.join("\n"),de(P))}"cut"==ut.type&&(D.state.cutIncoming=+new Date)}}f.wrapper.insertBefore(this.wrapper,f.wrapper.firstChild),et&&(P.style.width="0px"),Ri(P,"input",function(){n&&o>=9&&E.hasSelection&&(E.hasSelection=null),M.poll()}),Ri(P,"paste",function(ut){_i(D,ut)||ku(ut,D)||(D.state.pasteIncoming=+new Date,M.fastPoll())}),Ri(P,"cut",K),Ri(P,"copy",K),Ri(f.scroller,"paste",function(ut){if(!_t(f,ut)&&!_i(D,ut)){if(!P.dispatchEvent)return D.state.pasteIncoming=+new Date,void M.focus();var St=new Event("paste");St.clipboardData=ut.clipboardData,P.dispatchEvent(St)}}),Ri(f.lineSpace,"selectstart",function(ut){_t(f,ut)||mn(ut)}),Ri(P,"compositionstart",function(){var ut=D.getCursor("from");M.composing&&M.composing.range.clear(),M.composing={start:ut,range:D.markText(ut,D.getCursor("to"),{className:"CodeMirror-composing"})}}),Ri(P,"compositionend",function(){M.composing&&(M.poll(),M.composing.range.clear(),M.composing=null)})},vs.prototype.createField=function(f){this.wrapper=qc(),this.textarea=this.wrapper.firstChild},vs.prototype.screenReaderLabelChanged=function(f){f?this.textarea.setAttribute("aria-label",f):this.textarea.removeAttribute("aria-label")},vs.prototype.prepareSelection=function(){var f=this.cm,E=f.display,M=f.doc,D=cl(f);if(f.options.moveInputWithCursor){var P=ps(f,M.sel.primary().head,"div"),K=E.wrapper.getBoundingClientRect(),ut=E.lineDiv.getBoundingClientRect();D.teTop=Math.max(0,Math.min(E.wrapper.clientHeight-10,P.top+ut.top-K.top)),D.teLeft=Math.max(0,Math.min(E.wrapper.clientWidth-10,P.left+ut.left-K.left))}return D},vs.prototype.showSelection=function(f){var M=this.cm.display;Ft(M.cursorDiv,f.cursors),Ft(M.selectionDiv,f.selection),null!=f.teTop&&(this.wrapper.style.top=f.teTop+"px",this.wrapper.style.left=f.teLeft+"px")},vs.prototype.reset=function(f){if(!this.contextMenuPending&&!this.composing){var E=this.cm;if(E.somethingSelected()){this.prevInput="";var M=E.getSelection();this.textarea.value=M,E.state.focused&&de(this.textarea),n&&o>=9&&(this.hasSelection=M)}else f||(this.prevInput=this.textarea.value="",n&&o>=9&&(this.hasSelection=null))}},vs.prototype.getField=function(){return this.textarea},vs.prototype.supportsTouch=function(){return!1},vs.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!It||se()!=this.textarea))try{this.textarea.focus()}catch(f){}},vs.prototype.blur=function(){this.textarea.blur()},vs.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},vs.prototype.receivedFocus=function(){this.slowPoll()},vs.prototype.slowPoll=function(){var f=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){f.poll(),f.cm.state.focused&&f.slowPoll()})},vs.prototype.fastPoll=function(){var f=!1,E=this;E.pollingFast=!0,E.polling.set(20,function M(){E.poll()||f?(E.pollingFast=!1,E.slowPoll()):(f=!0,E.polling.set(60,M))})},vs.prototype.poll=function(){var f=this,E=this.cm,M=this.textarea,D=this.prevInput;if(this.contextMenuPending||!E.state.focused||li(M)&&!D&&!this.composing||E.isReadOnly()||E.options.disableInput||E.state.keySeq)return!1;var P=M.value;if(P==D&&!E.somethingSelected())return!1;if(n&&o>=9&&this.hasSelection===P||gt&&/[\uf700-\uf7ff]/.test(P))return E.display.input.reset(),!1;if(E.doc.sel==E.display.selForContextMenu){var K=P.charCodeAt(0);if(8203==K&&!D&&(D="\u200b"),8666==K)return this.reset(),this.cm.execCommand("undo")}for(var ut=0,St=Math.min(D.length,P.length);ut<St&&D.charCodeAt(ut)==P.charCodeAt(ut);)++ut;return gs(E,function(){fu(E,P.slice(ut),D.length-ut,null,f.composing?"*compose":null),P.length>1e3||P.indexOf("\n")>-1?M.value=f.prevInput="":f.prevInput=P,f.composing&&(f.composing.range.clear(),f.composing.range=E.markText(f.composing.start,E.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},vs.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},vs.prototype.onKeyPress=function(){n&&o>=9&&(this.hasSelection=null),this.fastPoll()},vs.prototype.onContextMenu=function(f){var E=this,M=E.cm,D=M.display,P=E.textarea;E.contextMenuPending&&E.contextMenuPending();var K=al(M,f),ut=D.scroller.scrollTop;if(K&&!R){M.options.resetSelectionOnContextMenu&&-1==M.doc.sel.contains(K)&&Rr(M,ca)(M.doc,Il(K),Me);var ze,Ht=P.style.cssText,$t=E.wrapper.style.cssText,ke=E.wrapper.offsetParent.getBoundingClientRect();if(E.wrapper.style.cssText="position: static",P.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(f.clientY-ke.top-5)+"px; left: "+(f.clientX-ke.left-5)+"px;\n      z-index: 1000; background: "+(n?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",r&&(ze=window.scrollY),D.input.focus(),r&&window.scrollTo(null,ze),D.input.reset(),M.somethingSelected()||(P.value=E.prevInput=" "),E.contextMenuPending=ui,D.selForContextMenu=M.doc.sel,clearTimeout(D.detectingSelectAll),n&&o>=9&&pi(),bt){Vt(f);var xi=function(){ge(window,"mouseup",xi),setTimeout(ui,20)};Ri(window,"mouseup",xi)}else setTimeout(ui,50)}function pi(){if(null!=P.selectionStart){var ji=M.somethingSelected(),ln="\u200b"+(ji?P.value:"");P.value="\u21da",P.value=ln,E.prevInput=ji?"":"\u200b",P.selectionStart=1,P.selectionEnd=ln.length,D.selForContextMenu=M.doc.sel}}function ui(){if(E.contextMenuPending==ui&&(E.contextMenuPending=!1,E.wrapper.style.cssText=$t,P.style.cssText=Ht,n&&o<9&&D.scrollbars.setScrollTop(D.scroller.scrollTop=ut),null!=P.selectionStart)){(!n||n&&o<9)&&pi();var ji=0,ln=function(){D.selForContextMenu==M.doc.sel&&0==P.selectionStart&&P.selectionEnd>0&&"\u200b"==E.prevInput?Rr(M,jc)(M):ji++<10?D.detectingSelectAll=setTimeout(ln,500):(D.selForContextMenu=null,D.input.reset())};D.detectingSelectAll=setTimeout(ln,200)}}},vs.prototype.readOnlyChanged=function(f){f||this.reset(),this.textarea.disabled="nocursor"==f,this.textarea.readOnly=!!f},vs.prototype.setUneditable=function(){},vs.prototype.needsContentAttribute=!1,function Mh(f){var E=f.optionHandlers;function M(D,P,K,ut){f.defaults[D]=P,K&&(E[D]=ut?function(St,Ht,$t){$t!=Pl&&K(St,Ht,$t)}:K)}f.defineOption=M,f.Init=Pl,M("value","",function(D,P){return D.setValue(P)},!0),M("mode",null,function(D,P){D.doc.modeOption=P,wl(D)},!0),M("indentUnit",2,wl,!0),M("indentWithTabs",!1),M("smartIndent",!0),M("tabSize",4,function(D){nc(D),Js(D),Zr(D)},!0),M("lineSeparator",null,function(D,P){if(D.doc.lineSep=P,P){var K=[],ut=D.doc.first;D.doc.iter(function(Ht){for(var $t=0;;){var ke=Ht.text.indexOf(P,$t);if(-1==ke)break;$t=ke+P.length,K.push(Bi(ut,ke))}ut++});for(var St=K.length-1;St>=0;St--)Yl(D.doc,P,K[St],Bi(K[St].line,K[St].ch+P.length))}}),M("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(D,P,K){D.state.specialChars=new RegExp(P.source+(P.test("\t")?"":"|\t"),"g"),K!=Pl&&D.refresh()}),M("specialCharPlaceholder",kt,function(D){return D.refresh()},!0),M("electricChars",!0),M("inputStyle",It?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),M("spellcheck",!1,function(D,P){return D.getInputField().spellcheck=P},!0),M("autocorrect",!1,function(D,P){return D.getInputField().autocorrect=P},!0),M("autocapitalize",!1,function(D,P){return D.getInputField().autocapitalize=P},!0),M("rtlMoveVisually",!Ut),M("wholeLineUpdateBefore",!0),M("theme","default",function(D){ha(D),$a(D)},!0),M("keyMap","default",function(D,P,K){var ut=ua(P),St=K!=Pl&&ua(K);St&&St.detach&&St.detach(D,ut),ut.attach&&ut.attach(D,St||null)}),M("extraKeys",null),M("configureMouse",null),M("lineWrapping",!1,ch,!0),M("gutters",[],function(D,P){D.display.gutterSpecs=ec(P,D.options.lineNumbers),$a(D)},!0),M("fixedGutter",!0,function(D,P){D.display.gutters.style.left=P?jr(D.display)+"px":"0",D.refresh()},!0),M("coverGutterNextToScrollbar",!1,function(D){return Jo(D)},!0),M("scrollbarStyle","native",function(D){Us(D),Jo(D),D.display.scrollbars.setScrollTop(D.doc.scrollTop),D.display.scrollbars.setScrollLeft(D.doc.scrollLeft)},!0),M("lineNumbers",!1,function(D,P){D.display.gutterSpecs=ec(D.options.gutters,P),$a(D)},!0),M("firstLineNumber",1,$a,!0),M("lineNumberFormatter",function(D){return D},$a,!0),M("showCursorWhenSelecting",!1,Ul,!0),M("resetSelectionOnContextMenu",!0),M("lineWiseCopyCut",!0),M("pasteLinesPerSelection",!0),M("selectionsMayTouch",!1),M("readOnly",!1,function(D,P){"nocursor"==P&&(xa(D),D.display.input.blur()),D.display.input.readOnlyChanged(P)}),M("screenReaderLabel",null,function(D,P){D.display.input.screenReaderLabelChanged(P=""===P?null:P)}),M("disableInput",!1,function(D,P){P||D.display.input.reset()},!0),M("dragDrop",!0,kc),M("allowDropFileTypes",null),M("cursorBlinkRate",530),M("cursorScrollMargin",0),M("cursorHeight",1,Ul,!0),M("singleCursorHeightPerLine",!0,Ul,!0),M("workTime",100),M("workDelay",100),M("flattenSpans",!0,nc,!0),M("addModeClass",!1,nc,!0),M("pollInterval",100),M("undoDepth",200,function(D,P){return D.doc.history.undoDepth=P}),M("historyEventDelay",1250),M("viewportMargin",10,function(D){return D.refresh()},!0),M("maxHighlightLength",1e4,nc,!0),M("moveInputWithCursor",!0,function(D,P){P||D.display.input.resetPosition()}),M("tabindex",null,function(D,P){return D.display.input.getField().tabIndex=P||""}),M("autofocus",null),M("direction","ltr",function(D,P){return D.doc.setDirection(P)},!0),M("phrases",null)}(zo),function Yu(f){var E=f.optionHandlers,M=f.helpers={};f.prototype={constructor:f,focus:function(){window.focus(),this.display.input.focus()},setOption:function(D,P){var K=this.options,ut=K[D];K[D]==P&&"mode"!=D||(K[D]=P,E.hasOwnProperty(D)&&Rr(this,E[D])(this,P,ut),De(this,"optionChange",this,D))},getOption:function(D){return this.options[D]},getDoc:function(){return this.doc},addKeyMap:function(D,P){this.state.keyMaps[P?"push":"unshift"](ua(D))},removeKeyMap:function(D){for(var P=this.state.keyMaps,K=0;K<P.length;++K)if(P[K]==D||P[K].name==D)return P.splice(K,1),!0},addOverlay:Dr(function(D,P){var K=D.token?D:f.getMode(this.options,D);if(K.startState)throw new Error("Overlays may not be stateful.");(function je(f,E,M){for(var D=0,P=M(E);D<f.length&&M(f[D])<=P;)D++;f.splice(D,0,E)})(this.state.overlays,{mode:K,modeSpec:D,opaque:P&&P.opaque,priority:P&&P.priority||0},function(ut){return ut.priority}),this.state.modeGen++,Zr(this)}),removeOverlay:Dr(function(D){for(var P=this.state.overlays,K=0;K<P.length;++K){var ut=P[K].modeSpec;if(ut==D||"string"==typeof D&&ut.name==D)return P.splice(K,1),this.state.modeGen++,void Zr(this)}}),indentLine:Dr(function(D,P,K){"string"!=typeof P&&"number"!=typeof P&&(P=null==P?this.options.smartIndent?"smart":"prev":P?"add":"subtract"),Qo(this.doc,D)&&xc(this,D,P,K)}),indentSelection:Dr(function(D){for(var P=this.doc.sel.ranges,K=-1,ut=0;ut<P.length;ut++){var St=P[ut];if(St.empty())St.head.line>K&&(xc(this,St.head.line,D,!0),K=St.head.line,ut==this.doc.sel.primIndex&&ot(this));else{var Ht=St.from(),$t=St.to(),ke=Math.max(K,Ht.line);K=Math.min(this.lastLine(),$t.line-($t.ch?0:1))+1;for(var ze=ke;ze<K;++ze)xc(this,ze,D);var pi=this.doc.sel.ranges;0==Ht.ch&&P.length==pi.length&&pi[ut].from().ch>0&&oc(this.doc,ut,new Wo(Ht,pi[ut].to()),Me)}}}),getTokenAt:function(D,P){return sr(this,D,P)},getLineTokens:function(D,P){return sr(this,Bi(D),P,!0)},getTokenTypeAt:function(D){D=Ki(this.doc,D);var Ht,P=_r(this,Ii(this.doc,D.line)),K=0,ut=(P.length-1)/2,St=D.ch;if(0==St)Ht=P[2];else for(;;){var $t=K+ut>>1;if(($t?P[2*$t-1]:0)>=St)ut=$t;else{if(!(P[2*$t+1]<St)){Ht=P[2*$t+2];break}K=$t+1}}var ke=Ht?Ht.indexOf("overlay "):-1;return ke<0?Ht:0==ke?null:Ht.slice(0,ke-1)},getModeAt:function(D){var P=this.doc.mode;return P.innerMode?f.innerMode(P,this.getTokenAt(D).state).mode:P},getHelper:function(D,P){return this.getHelpers(D,P)[0]},getHelpers:function(D,P){var K=[];if(!M.hasOwnProperty(P))return K;var ut=M[P],St=this.getModeAt(D);if("string"==typeof St[P])ut[St[P]]&&K.push(ut[St[P]]);else if(St[P])for(var Ht=0;Ht<St[P].length;Ht++){var $t=ut[St[P][Ht]];$t&&K.push($t)}else St.helperType&&ut[St.helperType]?K.push(ut[St.helperType]):ut[St.name]&&K.push(ut[St.name]);for(var ke=0;ke<ut._global.length;ke++){var ze=ut._global[ke];ze.pred(St,this)&&-1==qe(K,ze.val)&&K.push(ze.val)}return K},getStateAfter:function(D,P){var K=this.doc;return rr(this,(D=Yi(K,null==D?K.first+K.size-1:D))+1,P).state},cursorCoords:function(D,P){var ut=this.doc.sel.primary();return ps(this,null==D?ut.head:"object"==typeof D?Ki(this.doc,D):D?ut.from():ut.to(),P||"page")},charCoords:function(D,P){return ja(this,Ki(this.doc,D),P||"page")},coordsChar:function(D,P){return Nn(this,(D=Qs(this,D,P||"page")).left,D.top)},lineAtHeight:function(D,P){return D=Qs(this,{top:D,left:0},P||"page").top,Mo(this.doc,D+this.display.viewOffset)},heightAtLine:function(D,P,K){var St,ut=!1;if("number"==typeof D){var Ht=this.doc.first+this.doc.size-1;D<this.doc.first?D=this.doc.first:D>Ht&&(D=Ht,ut=!0),St=Ii(this.doc,D)}else St=D;return ir(this,St,{top:0,left:0},P||"page",K||ut).top+(ut?this.doc.height-hr(St):0)},defaultTextHeight:function(){return ns(this.display)},defaultCharWidth:function(){return Ss(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(D,P,K,ut,St){var Ht=this.display,$t=(D=ps(this,Ki(this.doc,D))).bottom,ke=D.left;if(P.style.position="absolute",P.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(P),Ht.sizer.appendChild(P),"over"==ut)$t=D.top;else if("above"==ut||"near"==ut){var ze=Math.max(Ht.wrapper.clientHeight,this.doc.height),pi=Math.max(Ht.sizer.clientWidth,Ht.lineSpace.clientWidth);("above"==ut||D.bottom+P.offsetHeight>ze)&&D.top>P.offsetHeight?$t=D.top-P.offsetHeight:D.bottom+P.offsetHeight<=ze&&($t=D.bottom),ke+P.offsetWidth>pi&&(ke=pi-P.offsetWidth)}P.style.top=$t+"px",P.style.left=P.style.right="","right"==St?(ke=Ht.sizer.clientWidth-P.offsetWidth,P.style.right="0px"):("left"==St?ke=0:"middle"==St&&(ke=(Ht.sizer.clientWidth-P.offsetWidth)/2),P.style.left=ke+"px"),K&&function Tc(f,E){var M=Bc(f,E);null!=M.scrollTop&&Ve(f,M.scrollTop),null!=M.scrollLeft&&Li(f,M.scrollLeft)}(this,{left:ke,top:$t,right:ke+P.offsetWidth,bottom:$t+P.offsetHeight})},triggerOnKeyDown:Dr(pc),triggerOnKeyPress:Dr(Ch),triggerOnKeyUp:zu,triggerOnMouseDown:Dr(ah),execCommand:function(D){if(Vu.hasOwnProperty(D))return Vu[D].call(null,this)},triggerElectric:Dr(function(D){uh(this,D)}),findPosH:function(D,P,K,ut){var St=1;P<0&&(St=-1,P=-P);for(var Ht=Ki(this.doc,D),$t=0;$t<P&&!(Ht=gc(this.doc,Ht,St,K,ut)).hitSide;++$t);return Ht},moveH:Dr(function(D,P){var K=this;this.extendSelectionsBy(function(ut){return K.display.shift||K.doc.extend||ut.empty()?gc(K.doc,ut.head,D,P,K.options.rtlMoveVisually):D<0?ut.from():ut.to()},Bt)}),deleteH:Dr(function(D,P){var ut=this.doc;this.doc.sel.somethingSelected()?ut.replaceSelection("",null,"+delete"):rs(this,function(St){var Ht=gc(ut,St.head,D,P,!1);return D<0?{from:Ht,to:St.head}:{from:St.head,to:Ht}})}),findPosV:function(D,P,K,ut){var St=1,Ht=ut;P<0&&(St=-1,P=-P);for(var $t=Ki(this.doc,D),ke=0;ke<P;++ke){var ze=ps(this,$t,"div");if(null==Ht?Ht=ze.left:ze.left=Ht,($t=_u(this,ze,St,K)).hitSide)break}return $t},moveV:Dr(function(D,P){var K=this,ut=this.doc,St=[],Ht=!this.display.shift&&!ut.extend&&ut.sel.somethingSelected();if(ut.extendSelectionsBy(function(ke){if(Ht)return D<0?ke.from():ke.to();var ze=ps(K,ke.head,"div");null!=ke.goalColumn&&(ze.left=ke.goalColumn),St.push(ze.left);var pi=_u(K,ze,D,P);return"page"==P&&ke==ut.sel.primary()&&dt(K,ja(K,pi,"div").top-ze.top),pi},Bt),St.length)for(var $t=0;$t<ut.sel.ranges.length;$t++)ut.sel.ranges[$t].goalColumn=St[$t]}),findWordAt:function(D){var K=Ii(this.doc,D.line).text,ut=D.ch,St=D.ch;if(K){var Ht=this.getHelper(D,"wordChars");"before"!=D.sticky&&St!=K.length||!ut?++St:--ut;for(var $t=K.charAt(ut),ke=Oe($t,Ht)?function(ze){return Oe(ze,Ht)}:/\s/.test($t)?function(ze){return/\s/.test(ze)}:function(ze){return!/\s/.test(ze)&&!Oe(ze)};ut>0&&ke(K.charAt(ut-1));)--ut;for(;St<K.length&&ke(K.charAt(St));)++St}return new Wo(Bi(D.line,ut),Bi(D.line,St))},toggleOverwrite:function(D){null!=D&&D==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?xt(this.display.cursorDiv,"CodeMirror-overwrite"):ft(this.display.cursorDiv,"CodeMirror-overwrite"),De(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==se()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Dr(function(D,P){q(this,D,P)}),getScrollInfo:function(){var D=this.display.scroller;return{left:D.scrollLeft,top:D.scrollTop,height:D.scrollHeight-Qe(this)-this.display.barHeight,width:D.scrollWidth-Qe(this)-this.display.barWidth,clientHeight:Ui(this),clientWidth:mi(this)}},scrollIntoView:Dr(function(D,P){null==D?(D={from:this.doc.sel.primary().head,to:null},null==P&&(P=this.options.cursorScrollMargin)):"number"==typeof D?D={from:Bi(D,0),to:null}:null==D.from&&(D={from:D,to:null}),D.to||(D.to=D.from),D.margin=P||0,null!=D.from.line?function At(f,E){Wt(f),f.curOp.scrollToPos=E}(this,D):pe(this,D.from,D.to,D.margin)}),setSize:Dr(function(D,P){var K=this,ut=function(Ht){return"number"==typeof Ht||/^\d+$/.test(String(Ht))?Ht+"px":Ht};null!=D&&(this.display.wrapper.style.width=ut(D)),null!=P&&(this.display.wrapper.style.height=ut(P)),this.options.lineWrapping&&Sr(this);var St=this.display.viewFrom;this.doc.iter(St,this.display.viewTo,function(Ht){if(Ht.widgets)for(var $t=0;$t<Ht.widgets.length;$t++)if(Ht.widgets[$t].noHScroll){sa(K,St,"widget");break}++St}),this.curOp.forceUpdate=!0,De(this,"refresh",this)}),operation:function(D){return gs(this,D)},startOperation:function(){return Vs(this)},endOperation:function(){return Ka(this)},refresh:Dr(function(){var D=this.display.cachedTextHeight;Zr(this),this.curOp.forceUpdate=!0,Js(this),q(this,this.doc.scrollLeft,this.doc.scrollTop),ac(this.display),(null==D||Math.abs(D-ns(this.display))>.5||this.options.lineWrapping)&&Zl(this),De(this,"refresh",this)}),swapDoc:Dr(function(D){var P=this.doc;return P.cm=null,this.state.selectingText&&this.state.selectingText(),Ao(this,D),Js(this),this.display.input.reset(),q(this,D.scrollLeft,D.scrollTop),this.curOp.forceScroll=!0,fo(this,"swapDoc",this,P),P}),phrase:function(D){var P=this.options.phrases;return P&&Object.prototype.hasOwnProperty.call(P,D)?P[D]:D},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ni(f),f.registerHelper=function(D,P,K){M.hasOwnProperty(D)||(M[D]=f[D]={_global:[]}),M[D][P]=K},f.registerGlobalHelper=function(D,P,K,ut){f.registerHelper(D,P,ut),M[D]._global.push({pred:K,val:ut})}}(zo);var fh="iter insert remove copy getEditor constructor".split(" ");for(var Lu in ms.prototype)ms.prototype.hasOwnProperty(Lu)&&qe(fh,Lu)<0&&(zo.prototype[Lu]=function(f){return function(){return f.apply(this.doc,arguments)}}(ms.prototype[Lu]));return Ni(ms),zo.inputStyles={textarea:vs,contenteditable:ur},zo.defineMode=function(f){!zo.defaults.mode&&"null"!=f&&(zo.defaults.mode=f),kn.apply(this,arguments)},zo.defineMIME=function so(f,E){gn[f]=E},zo.defineMode("null",function(){return{token:function(f){return f.skipToEnd()}}}),zo.defineMIME("text/plain","null"),zo.defineExtension=function(f,E){zo.prototype[f]=E},zo.defineDocExtension=function(f,E){ms.prototype[f]=E},zo.fromTextArea=function dh(f,E){if((E=E?ce(E):{}).value=f.value,!E.tabindex&&f.tabIndex&&(E.tabindex=f.tabIndex),!E.placeholder&&f.placeholder&&(E.placeholder=f.placeholder),null==E.autofocus){var M=se();E.autofocus=M==f||null!=f.getAttribute("autofocus")&&M==document.body}function D(){f.value=St.getValue()}var P;if(f.form&&(Ri(f.form,"submit",D),!E.leaveSubmitMethodAlone)){var K=f.form;P=K.submit;try{var ut=K.submit=function(){D(),K.submit=P,K.submit(),K.submit=ut}}catch(Ht){}}E.finishInit=function(Ht){Ht.save=D,Ht.getTextArea=function(){return f},Ht.toTextArea=function(){Ht.toTextArea=isNaN,D(),f.parentNode.removeChild(Ht.getWrapperElement()),f.style.display="",f.form&&(ge(f.form,"submit",D),!E.leaveSubmitMethodAlone&&"function"==typeof f.form.submit&&(f.form.submit=P))}},f.style.display="none";var St=zo(function(Ht){return f.parentNode.insertBefore(Ht,f.nextSibling)},E);return St},function ph(f){f.off=ge,f.on=Ri,f.wheelEventPixels=Ec,f.Doc=ms,f.splitLines=no,f.countColumn=Ae,f.findColumn=Ie,f.isWordChar=ee,f.Pass=ei,f.signal=De,f.Line=hs,f.changeEnd=Wl,f.scrollbarModel=Sl,f.Pos=Bi,f.cmpPos=On,f.modes=Oi,f.mimeModes=gn,f.resolveMode=Do,f.getMode=Zo,f.modeExtensions=qo,f.extendMode=yr,f.copyState=xo,f.startState=Fr,f.innerMode=vo,f.commands=Vu,f.keyMap=ho,f.keyName=mr,f.isModifierKey=fr,f.lookupKey=$o,f.normalizeKeyMap=br,f.StringStream=co,f.SharedTextMarker=hl,f.TextMarker=yl,f.LineWidget=Ll,f.e_preventDefault=mn,f.e_stopPropagation=si,f.e_stop=Vt,f.addClass=xt,f.contains=rt,f.rmClass=ft,f.keyNames=Ai}(zo),zo.version="5.65.0",zo}()},64166:(B,X,_)=>{!function(C){"use strict";C.defineMode("javascript",function(m,e){var Et,It,t=m.indentUnit,n=e.statementIndent,o=e.jsonld,r=e.json||o,a=!1!==e.trackScope,h=e.typescript,R=e.wordCharacters||/[\w$\xa1-\uffff]/,L=function(){function ae(lo){return{type:lo,style:"keyword"}}var Fe=ae("keyword a"),Mi=ae("keyword b"),Yi=ae("keyword c"),Ki=ae("keyword d"),qn=ae("operator"),ao={type:"atom",style:"atom"};return{if:ae("if"),while:Fe,with:Fe,else:Mi,do:Mi,try:Mi,finally:Mi,return:Ki,break:Ki,continue:Ki,new:ae("new"),delete:Yi,void:Yi,throw:Yi,debugger:ae("debugger"),var:ae("var"),const:ae("var"),let:ae("var"),function:ae("function"),catch:ae("catch"),for:ae("for"),switch:ae("switch"),case:ae("case"),default:ae("default"),in:qn,typeof:qn,instanceof:qn,true:ao,false:ao,null:ao,undefined:ao,NaN:ao,Infinity:ao,this:ae("this"),class:ae("class"),super:ae("atom"),yield:Yi,export:ae("export"),import:ae("import"),extends:Yi,await:Yi}}(),W=/[+\-*&%=<>!?|~^@]/,nt=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function gt(ae,Fe,Mi){return Et=ae,It=Mi,Fe}function wt(ae,Fe){var Mi=ae.next();if('"'==Mi||"'"==Mi)return Fe.tokenize=function Ut(ae){return function(Fe,Mi){var Ki,Yi=!1;if(o&&"@"==Fe.peek()&&Fe.match(nt))return Mi.tokenize=wt,gt("jsonld-keyword","meta");for(;null!=(Ki=Fe.next())&&(Ki!=ae||Yi);)Yi=!Yi&&"\\"==Ki;return Yi||(Mi.tokenize=wt),gt("string","string")}}(Mi),Fe.tokenize(ae,Fe);if("."==Mi&&ae.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return gt("number","number");if("."==Mi&&ae.match(".."))return gt("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(Mi))return gt(Mi);if("="==Mi&&ae.eat(">"))return gt("=>","operator");if("0"==Mi&&ae.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return gt("number","number");if(/\d/.test(Mi))return ae.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),gt("number","number");if("/"==Mi)return ae.eat("*")?(Fe.tokenize=Jt,Jt(ae,Fe)):ae.eat("/")?(ae.skipToEnd(),gt("comment","comment")):Wn(ae,Fe,1)?(function et(ae){for(var Mi,Fe=!1,Yi=!1;null!=(Mi=ae.next());){if(!Fe){if("/"==Mi&&!Yi)return;"["==Mi?Yi=!0:Yi&&"]"==Mi&&(Yi=!1)}Fe=!Fe&&"\\"==Mi}}(ae),ae.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),gt("regexp","string-2")):(ae.eat("="),gt("operator","operator",ae.current()));if("`"==Mi)return Fe.tokenize=Ct,Ct(ae,Fe);if("#"==Mi&&"!"==ae.peek())return ae.skipToEnd(),gt("meta","meta");if("#"==Mi&&ae.eatWhile(R))return gt("variable","property");if("<"==Mi&&ae.match("!--")||"-"==Mi&&ae.match("->")&&!/\S/.test(ae.string.slice(0,ae.start)))return ae.skipToEnd(),gt("comment","comment");if(W.test(Mi))return(">"!=Mi||!Fe.lexical||">"!=Fe.lexical.type)&&(ae.eat("=")?("!"==Mi||"="==Mi)&&ae.eat("="):/[<>*+\-|&?]/.test(Mi)&&(ae.eat(Mi),">"==Mi&&ae.eat(Mi))),"?"==Mi&&ae.eat(".")?gt("."):gt("operator","operator",ae.current());if(R.test(Mi)){ae.eatWhile(R);var Yi=ae.current();if("."!=Fe.lastType){if(L.propertyIsEnumerable(Yi)){var Ki=L[Yi];return gt(Ki.type,Ki.style,Yi)}if("async"==Yi&&ae.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return gt("async","keyword",Yi)}return gt("variable","variable",Yi)}}function Jt(ae,Fe){for(var Yi,Mi=!1;Yi=ae.next();){if("/"==Yi&&Mi){Fe.tokenize=wt;break}Mi="*"==Yi}return gt("comment","comment")}function Ct(ae,Fe){for(var Yi,Mi=!1;null!=(Yi=ae.next());){if(!Mi&&("`"==Yi||"$"==Yi&&ae.eat("{"))){Fe.tokenize=wt;break}Mi=!Mi&&"\\"==Yi}return gt("quasi","string-2",ae.current())}function at(ae,Fe){Fe.fatArrowAt&&(Fe.fatArrowAt=null);var Mi=ae.string.indexOf("=>",ae.start);if(!(Mi<0)){if(h){var Yi=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(ae.string.slice(ae.start,Mi));Yi&&(Mi=Yi.index)}for(var Ki=0,qn=!1,ao=Mi-1;ao>=0;--ao){var lo=ae.string.charAt(ao),Rn="([{}])".indexOf(lo);if(Rn>=0&&Rn<3){if(!Ki){++ao;break}if(0==--Ki){"("==lo&&(qn=!0);break}}else if(Rn>=3&&Rn<6)++Ki;else if(R.test(lo))qn=!0;else if(/["'\/`]/.test(lo))for(;;--ao){if(0==ao)return;if(ae.string.charAt(ao-1)==lo&&"\\"!=ae.string.charAt(ao-2)){ao--;break}}else if(qn&&!Ki){++ao;break}}qn&&!Ki&&(Fe.fatArrowAt=ao)}}var ft={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function lt(ae,Fe,Mi,Yi,Ki,qn){this.indented=ae,this.column=Fe,this.type=Mi,this.prev=Ki,this.info=qn,null!=Yi&&(this.align=Yi)}function Ft(ae,Fe){if(!a)return!1;for(var Mi=ae.localVars;Mi;Mi=Mi.next)if(Mi.name==Fe)return!0;for(var Yi=ae.context;Yi;Yi=Yi.prev)for(Mi=Yi.vars;Mi;Mi=Mi.next)if(Mi.name==Fe)return!0}function Mt(ae,Fe,Mi,Yi,Ki){var qn=ae.cc;for(yt.state=ae,yt.stream=Ki,yt.marked=null,yt.cc=qn,yt.style=Fe,ae.lexical.hasOwnProperty("align")||(ae.lexical.align=!0);;)if((qn.length?qn.pop():r?Xt:Bt)(Mi,Yi)){for(;qn.length&&qn[qn.length-1].lex;)qn.pop()();return yt.marked?yt.marked:"variable"==Mi&&Ft(ae,Yi)?"variable-2":Fe}}var yt={state:null,column:null,marked:null,cc:null};function ct(){for(var ae=arguments.length-1;ae>=0;ae--)yt.cc.push(arguments[ae])}function rt(){return ct.apply(null,arguments),!0}function se(ae,Fe){for(var Mi=Fe;Mi;Mi=Mi.next)if(Mi.name==ae)return!0;return!1}function xt(ae){var Fe=yt.state;if(yt.marked="def",a){if(Fe.context)if("var"==Fe.lexical.info&&Fe.context&&Fe.context.block){var Mi=Lt(ae,Fe.context);if(null!=Mi)return void(Fe.context=Mi)}else if(!se(ae,Fe.localVars))return void(Fe.localVars=new ce(ae,Fe.localVars));e.globalVars&&!se(ae,Fe.globalVars)&&(Fe.globalVars=new ce(ae,Fe.globalVars))}}function Lt(ae,Fe){if(Fe){if(Fe.block){var Mi=Lt(ae,Fe.prev);return Mi?Mi==Fe.prev?Fe:new _e(Mi,Fe.vars,!0):null}return se(ae,Fe.vars)?Fe:new _e(Fe.prev,new ce(ae,Fe.vars),!1)}return null}function de(ae){return"public"==ae||"private"==ae||"protected"==ae||"abstract"==ae||"readonly"==ae}function _e(ae,Fe,Mi){this.prev=ae,this.vars=Fe,this.block=Mi}function ce(ae,Fe){this.name=ae,this.next=Fe}var Ae=new ce("this",new ce("arguments",null));function Ne(){yt.state.context=new _e(yt.state.context,yt.state.localVars,!1),yt.state.localVars=Ae}function qe(){yt.state.context=new _e(yt.state.context,yt.state.localVars,!0),yt.state.localVars=null}function Di(){yt.state.localVars=yt.state.context.vars,yt.state.context=yt.state.context.prev}function ei(ae,Fe){var Mi=function(){var Yi=yt.state,Ki=Yi.indented;if("stat"==Yi.lexical.type)Ki=Yi.lexical.indented;else for(var qn=Yi.lexical;qn&&")"==qn.type&&qn.align;qn=qn.prev)Ki=qn.indented;Yi.lexical=new lt(Ki,yt.stream.column(),ae,null,Yi.lexical,Fe)};return Mi.lex=!0,Mi}function Me(){var ae=yt.state;ae.lexical.prev&&(")"==ae.lexical.type&&(ae.indented=ae.lexical.indented),ae.lexical=ae.lexical.prev)}function ri(ae){return function Fe(Mi){return Mi==ae?rt():";"==ae||"}"==Mi||")"==Mi||"]"==Mi?ct():rt(Fe)}}function Bt(ae,Fe){return"var"==ae?rt(ei("vardef",Fe),$i,ri(";"),Me):"keyword a"==ae?rt(ei("form"),Dt,Bt,Me):"keyword b"==ae?rt(ei("form"),Bt,Me):"keyword d"==ae?yt.stream.match(/^\s*$/,!1)?rt():rt(ei("stat"),je,ri(";"),Me):"debugger"==ae?rt(ri(";")):"{"==ae?rt(ei("}"),qe,Ri,Me,Di):";"==ae?rt():"if"==ae?("else"==yt.state.lexical.info&&yt.state.cc[yt.state.cc.length-1]==Me&&yt.state.cc.pop()(),rt(ei("form"),Dt,Bt,Me,xe)):"function"==ae?rt(kn):"for"==ae?rt(ei("form"),qe,hi,Bt,Di,Me):"class"==ae||h&&"interface"==Fe?(yt.marked="keyword",rt(ei("form","class"==ae?ae:Fe),yr,Me)):"variable"==ae?h&&"declare"==Fe?(yt.marked="keyword",rt(Bt)):h&&("module"==Fe||"enum"==Fe||"type"==Fe)&&yt.stream.match(/^\s*\w/,!1)?(yt.marked="keyword","enum"==Fe?rt(Oo):"type"==Fe?rt(Do,ri("operator"),yi,ri(";")):rt(ei("form"),tn,ri("{"),ei("}"),Ri,Me,Me)):h&&"namespace"==Fe?(yt.marked="keyword",rt(ei("form"),Xt,Bt,Me)):h&&"abstract"==Fe?(yt.marked="keyword",rt(Bt)):rt(ei("stat"),Zt):"switch"==ae?rt(ei("form"),Dt,ri("{"),ei("}","switch"),qe,Ri,Me,Me,Di):"case"==ae?rt(Xt,ri(":")):"default"==ae?rt(ri(":")):"catch"==ae?rt(ei("form"),Ne,Ie,Bt,Me,Di):"export"==ae?rt(ei("stat"),co,Me):"import"==ae?rt(ei("stat"),Gn,Me):"async"==ae?rt(Bt):"@"==Fe?rt(Xt,Bt):ct(ei("stat"),Xt,ri(";"),Me)}function Ie(ae){if("("==ae)return rt(Zo,ri(")"))}function Xt(ae,Fe){return ve(ae,Fe,!1)}function he(ae,Fe){return ve(ae,Fe,!0)}function Dt(ae){return"("!=ae?ct():rt(ei(")"),je,ri(")"),Me)}function ve(ae,Fe,Mi){if(yt.state.fatArrowAt==yt.stream.start){var Yi=Mi?le:Oe;if("("==ae)return rt(Ne,ei(")"),di(Zo,")"),Me,ri("=>"),Yi,Di);if("variable"==ae)return ct(Ne,tn,ri("=>"),Yi,Di)}var Ki=Mi?Ee:gi;return ft.hasOwnProperty(ae)?rt(Ki):"function"==ae?rt(kn,Ki):"class"==ae||h&&"interface"==Fe?(yt.marked="keyword",rt(ei("form"),qo,Me)):"keyword c"==ae||"async"==ae?rt(Mi?he:Xt):"("==ae?rt(ei(")"),je,ri(")"),Me,Ki):"operator"==ae||"spread"==ae?rt(Mi?he:Xt):"["==ae?rt(ei("]"),Qo,Me,Ki):"{"==ae?Gi($e,"}",null,Ki):"quasi"==ae?ct(ne,Ki):"new"==ae?rt(function me(ae){return function(Fe){return"."==Fe?rt(ae?Kt:ye):"variable"==Fe&&h?rt(Gt,ae?Ee:gi):ct(ae?he:Xt)}}(Mi)):rt()}function je(ae){return ae.match(/[;\}\)\],]/)?ct():ct(Xt)}function gi(ae,Fe){return","==ae?rt(je):Ee(ae,Fe,!1)}function Ee(ae,Fe,Mi){var Yi=0==Mi?gi:Ee,Ki=0==Mi?Xt:he;if("=>"==ae)return rt(Ne,Mi?le:Oe,Di);if("operator"==ae)return/\+\+|--/.test(Fe)||h&&"!"==Fe?rt(Yi):h&&"<"==Fe&&yt.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?rt(ei(">"),di(yi,">"),Me,Yi):"?"==Fe?rt(Xt,ri(":"),Ki):rt(Ki);if("quasi"==ae)return ct(ne,Yi);if(";"!=ae){if("("==ae)return Gi(he,")","call",Yi);if("."==ae)return rt(We,Yi);if("["==ae)return rt(ei("]"),je,ri("]"),Me,Yi);if(h&&"as"==Fe)return yt.marked="keyword",rt(yi,Yi);if("regexp"==ae)return yt.state.lastType=yt.marked="operator",yt.stream.backUp(yt.stream.pos-yt.stream.start-1),rt(Ki)}}function ne(ae,Fe){return"quasi"!=ae?ct():"${"!=Fe.slice(Fe.length-2)?rt(ne):rt(je,ee)}function ee(ae){if("}"==ae)return yt.marked="string-2",yt.state.tokenize=Ct,rt(ne)}function Oe(ae){return at(yt.stream,yt.state),ct("{"==ae?Bt:Xt)}function le(ae){return at(yt.stream,yt.state),ct("{"==ae?Bt:he)}function ye(ae,Fe){if("target"==Fe)return yt.marked="keyword",rt(gi)}function Kt(ae,Fe){if("target"==Fe)return yt.marked="keyword",rt(Ee)}function Zt(ae){return":"==ae?rt(Me,Bt):ct(gi,ri(";"),Me)}function We(ae){if("variable"==ae)return yt.marked="property",rt()}function $e(ae,Fe){return"async"==ae?(yt.marked="property",rt($e)):"variable"==ae||"keyword"==yt.style?(yt.marked="property","get"==Fe||"set"==Fe?rt(Ti):(h&&yt.state.fatArrowAt==yt.stream.start&&(Mi=yt.stream.match(/^\s*:\s*/,!1))&&(yt.state.fatArrowAt=yt.stream.pos+Mi[0].length),rt(vi))):"number"==ae||"string"==ae?(yt.marked=o?"property":yt.style+" property",rt(vi)):"jsonld-keyword"==ae?rt(vi):h&&de(Fe)?(yt.marked="keyword",rt($e)):"["==ae?rt(Xt,rn,ri("]"),vi):"spread"==ae?rt(he,vi):"*"==Fe?(yt.marked="keyword",rt($e)):":"==ae?ct(vi):void 0;var Mi}function Ti(ae){return"variable"!=ae?ct(vi):(yt.marked="property",rt(kn))}function vi(ae){return":"==ae?rt(he):"("==ae?ct(kn):void 0}function di(ae,Fe,Mi){function Yi(Ki,qn){if(Mi?Mi.indexOf(Ki)>-1:","==Ki){var ao=yt.state.lexical;return"call"==ao.info&&(ao.pos=(ao.pos||0)+1),rt(function(lo,Rn){return lo==Fe||Rn==Fe?ct():ct(ae)},Yi)}return Ki==Fe||qn==Fe?rt():Mi&&Mi.indexOf(";")>-1?ct(ae):rt(ri(Fe))}return function(Ki,qn){return Ki==Fe||qn==Fe?rt():ct(ae,Yi)}}function Gi(ae,Fe,Mi){for(var Yi=3;Yi<arguments.length;Yi++)yt.cc.push(arguments[Yi]);return rt(ei(Fe,Mi),di(ae,Fe),Me)}function Ri(ae){return"}"==ae?rt():ct(Bt,Ri)}function rn(ae,Fe){if(h){if(":"==ae)return rt(yi);if("?"==Fe)return rt(rn)}}function ge(ae,Fe){if(h&&(":"==ae||"in"==Fe))return rt(yi)}function De(ae){if(h&&":"==ae)return yt.stream.match(/^\s*\w+\s+is\b/,!1)?rt(Xt,_i,yi):rt(yi)}function _i(ae,Fe){if("is"==Fe)return yt.marked="keyword",rt()}function yi(ae,Fe){return"keyof"==Fe||"typeof"==Fe||"infer"==Fe||"readonly"==Fe?(yt.marked="keyword",rt("typeof"==Fe?he:yi)):"variable"==ae||"void"==Fe?(yt.marked="type",rt(vt)):"|"==Fe||"&"==Fe?rt(yi):"string"==ae||"number"==ae||"atom"==ae?rt(vt):"["==ae?rt(ei("]"),di(yi,"]",","),Me,vt):"{"==ae?rt(ei("}"),Ni,Me,vt):"("==ae?rt(di(Vt,")"),Fi,vt):"<"==ae?rt(di(yi,">"),yi):"quasi"==ae?ct(si,vt):void 0}function Fi(ae){if("=>"==ae)return rt(yi)}function Ni(ae){return ae.match(/[\}\)\]]/)?rt():","==ae||";"==ae?rt(Ni):ct(mn,Ni)}function mn(ae,Fe){return"variable"==ae||"keyword"==yt.style?(yt.marked="property",rt(mn)):"?"==Fe||"number"==ae||"string"==ae?rt(mn):":"==ae?rt(yi):"["==ae?rt(ri("variable"),ge,ri("]"),mn):"("==ae?ct(so,mn):ae.match(/[;\}\)\],]/)?void 0:rt()}function si(ae,Fe){return"quasi"!=ae?ct():"${"!=Fe.slice(Fe.length-2)?rt(si):rt(yi,Ce)}function Ce(ae){if("}"==ae)return yt.marked="string-2",yt.state.tokenize=Ct,rt(si)}function Vt(ae,Fe){return"variable"==ae&&yt.stream.match(/^\s*[?:]/,!1)||"?"==Fe?rt(Vt):":"==ae?rt(yi):"spread"==ae?rt(Vt):ct(yi)}function vt(ae,Fe){return"<"==Fe?rt(ei(">"),di(yi,">"),Me,vt):"|"==Fe||"."==ae||"&"==Fe?rt(yi):"["==ae?rt(yi,ri("]"),vt):"extends"==Fe||"implements"==Fe?(yt.marked="keyword",rt(yi)):"?"==Fe?rt(yi,ri(":"),yi):void 0}function Gt(ae,Fe){if("<"==Fe)return rt(ei(">"),di(yi,">"),Me,vt)}function fe(){return ct(yi,He)}function He(ae,Fe){if("="==Fe)return rt(yi)}function $i(ae,Fe){return"enum"==Fe?(yt.marked="keyword",rt(Oo)):ct(tn,rn,li,Je)}function tn(ae,Fe){return h&&de(Fe)?(yt.marked="keyword",rt(tn)):"variable"==ae?(xt(Fe),rt()):"spread"==ae?rt(tn):"["==ae?Gi(no,"]"):"{"==ae?Gi(In,"}"):void 0}function In(ae,Fe){return"variable"!=ae||yt.stream.match(/^\s*:/,!1)?("variable"==ae&&(yt.marked="property"),"spread"==ae?rt(tn):"}"==ae?ct():"["==ae?rt(Xt,ri("]"),ri(":"),In):rt(ri(":"),tn,li)):(xt(Fe),rt(li))}function no(){return ct(tn,li)}function li(ae,Fe){if("="==Fe)return rt(he)}function Je(ae){if(","==ae)return rt($i)}function xe(ae,Fe){if("keyword b"==ae&&"else"==Fe)return rt(ei("form","else"),Bt,Me)}function hi(ae,Fe){return"await"==Fe?rt(hi):"("==ae?rt(ei(")"),Oi,Me):void 0}function Oi(ae){return"var"==ae?rt($i,gn):"variable"==ae?rt(gn):ct(gn)}function gn(ae,Fe){return")"==ae?rt():";"==ae?rt(gn):"in"==Fe||"of"==Fe?(yt.marked="keyword",rt(Xt,gn)):ct(Xt,gn)}function kn(ae,Fe){return"*"==Fe?(yt.marked="keyword",rt(kn)):"variable"==ae?(xt(Fe),rt(kn)):"("==ae?rt(Ne,ei(")"),di(Zo,")"),Me,De,Bt,Di):h&&"<"==Fe?rt(ei(">"),di(fe,">"),Me,kn):void 0}function so(ae,Fe){return"*"==Fe?(yt.marked="keyword",rt(so)):"variable"==ae?(xt(Fe),rt(so)):"("==ae?rt(Ne,ei(")"),di(Zo,")"),Me,De,Di):h&&"<"==Fe?rt(ei(">"),di(fe,">"),Me,so):void 0}function Do(ae,Fe){return"keyword"==ae||"variable"==ae?(yt.marked="type",rt(Do)):"<"==Fe?rt(ei(">"),di(fe,">"),Me):void 0}function Zo(ae,Fe){return"@"==Fe&&rt(Xt,Zo),"spread"==ae?rt(Zo):h&&de(Fe)?(yt.marked="keyword",rt(Zo)):h&&"this"==ae?rt(rn,li):ct(tn,rn,li)}function qo(ae,Fe){return"variable"==ae?yr(ae,Fe):xo(ae,Fe)}function yr(ae,Fe){if("variable"==ae)return xt(Fe),rt(xo)}function xo(ae,Fe){return"<"==Fe?rt(ei(">"),di(fe,">"),Me,xo):"extends"==Fe||"implements"==Fe||h&&","==ae?("implements"==Fe&&(yt.marked="keyword"),rt(h?yi:Xt,xo)):"{"==ae?rt(ei("}"),vo,Me):void 0}function vo(ae,Fe){return"async"==ae||"variable"==ae&&("static"==Fe||"get"==Fe||"set"==Fe||h&&de(Fe))&&yt.stream.match(/^\s+[\w$\xa1-\uffff]/,!1)?(yt.marked="keyword",rt(vo)):"variable"==ae||"keyword"==yt.style?(yt.marked="property",rt(Fr,vo)):"number"==ae||"string"==ae?rt(Fr,vo):"["==ae?rt(Xt,rn,ri("]"),Fr,vo):"*"==Fe?(yt.marked="keyword",rt(vo)):h&&"("==ae?ct(so,vo):";"==ae||","==ae?rt(vo):"}"==ae?rt():"@"==Fe?rt(Xt,vo):void 0}function Fr(ae,Fe){if("!"==Fe||"?"==Fe)return rt(Fr);if(":"==ae)return rt(yi,li);if("="==Fe)return rt(he);var Mi=yt.state.lexical.prev;return ct(Mi&&"interface"==Mi.info?so:kn)}function co(ae,Fe){return"*"==Fe?(yt.marked="keyword",rt(Mo,ri(";"))):"default"==Fe?(yt.marked="keyword",rt(Xt,ri(";"))):"{"==ae?rt(di(Ii,"}"),Mo,ri(";")):ct(Bt)}function Ii(ae,Fe){return"as"==Fe?(yt.marked="keyword",rt(ri("variable"))):"variable"==ae?ct(he,Ii):void 0}function Gn(ae){return"string"==ae?rt():"("==ae?ct(Xt):"."==ae?ct(gi):ct(To,Uo,Mo)}function To(ae,Fe){return"{"==ae?Gi(To,"}"):("variable"==ae&&xt(Fe),"*"==Fe&&(yt.marked="keyword"),rt(yo))}function Uo(ae){if(","==ae)return rt(To,Uo)}function yo(ae,Fe){if("as"==Fe)return yt.marked="keyword",rt(To)}function Mo(ae,Fe){if("from"==Fe)return yt.marked="keyword",rt(Xt)}function Qo(ae){return"]"==ae?rt():ct(di(he,"]"))}function Oo(){return ct(ei("form"),tn,ri("{"),ei("}"),di(Bi,"}"),Me,Me)}function Bi(){return ct(tn,li)}function Wn(ae,Fe,Mi){return Fe.tokenize==wt&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(Fe.lastType)||"quasi"==Fe.lastType&&/\{\s*$/.test(ae.string.slice(0,ae.pos-(Mi||0)))}return Di.lex=!0,Me.lex=!0,{startState:function(ae){var Fe={tokenize:wt,lastType:"sof",cc:[],lexical:new lt((ae||0)-t,0,"block",!1),localVars:e.localVars,context:e.localVars&&new _e(null,null,!1),indented:ae||0};return e.globalVars&&"object"==typeof e.globalVars&&(Fe.globalVars=e.globalVars),Fe},token:function(ae,Fe){if(ae.sol()&&(Fe.lexical.hasOwnProperty("align")||(Fe.lexical.align=!1),Fe.indented=ae.indentation(),at(ae,Fe)),Fe.tokenize!=Jt&&ae.eatSpace())return null;var Mi=Fe.tokenize(ae,Fe);return"comment"==Et?Mi:(Fe.lastType="operator"!=Et||"++"!=It&&"--"!=It?Et:"incdec",Mt(Fe,Mi,Et,It,ae))},indent:function(ae,Fe){if(ae.tokenize==Jt||ae.tokenize==Ct)return C.Pass;if(ae.tokenize!=wt)return 0;var Ki,Mi=Fe&&Fe.charAt(0),Yi=ae.lexical;if(!/^\s*else\b/.test(Fe))for(var qn=ae.cc.length-1;qn>=0;--qn){var ao=ae.cc[qn];if(ao==Me)Yi=Yi.prev;else if(ao!=xe&&ao!=Di)break}for(;("stat"==Yi.type||"form"==Yi.type)&&("}"==Mi||(Ki=ae.cc[ae.cc.length-1])&&(Ki==gi||Ki==Ee)&&!/^[,\.=+\-*:?[\(]/.test(Fe));)Yi=Yi.prev;n&&")"==Yi.type&&"stat"==Yi.prev.type&&(Yi=Yi.prev);var lo=Yi.type,Rn=Mi==lo;return"vardef"==lo?Yi.indented+("operator"==ae.lastType||","==ae.lastType?Yi.info.length+1:0):"form"==lo&&"{"==Mi?Yi.indented:"form"==lo?Yi.indented+t:"stat"==lo?Yi.indented+(function On(ae,Fe){return"operator"==ae.lastType||","==ae.lastType||W.test(Fe.charAt(0))||/[,.]/.test(Fe.charAt(0))}(ae,Fe)?n||t:0):"switch"!=Yi.info||Rn||0==e.doubleIndentSwitch?Yi.align?Yi.column+(Rn?0:1):Yi.indented+(Rn?0:t):Yi.indented+(/^(?:case|default)\b/.test(Fe)?t:2*t)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:r?null:"/*",blockCommentEnd:r?null:"*/",blockCommentContinue:r?null:" * ",lineComment:r?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:r?"json":"javascript",jsonldMode:o,jsonMode:r,expressionAllowed:Wn,skipExpression:function(ae){Mt(ae,"atom","atom","true",new C.StringStream("",2,null))}}}),C.registerHelper("wordChars","javascript",/[\w$]/),C.defineMIME("text/javascript","javascript"),C.defineMIME("text/ecmascript","javascript"),C.defineMIME("application/javascript","javascript"),C.defineMIME("application/x-javascript","javascript"),C.defineMIME("application/ecmascript","javascript"),C.defineMIME("application/json",{name:"javascript",json:!0}),C.defineMIME("application/x-json",{name:"javascript",json:!0}),C.defineMIME("application/manifest+json",{name:"javascript",json:!0}),C.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),C.defineMIME("text/typescript",{name:"javascript",typescript:!0}),C.defineMIME("application/typescript",{name:"javascript",typescript:!0})}(_(68266))},70697:function(B){B.exports=function(){"use strict";function X(mt){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Rt){return typeof Rt}:function(Rt){return Rt&&"function"==typeof Symbol&&Rt.constructor===Symbol&&Rt!==Symbol.prototype?"symbol":typeof Rt})(mt)}var mt,C=(mt={},function(te){var Re=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"introjs-stamp";return mt[Re]=mt[Re]||0,void 0===te[Re]&&(te[Re]=mt[Re]++),te[Re]});function m(mt,Rt,te){if(mt)for(var Re=0,Ue=mt.length;Re<Ue;Re++)Rt(mt[Re],Re);"function"==typeof te&&te()}var e=new function mt(){var Rt="introjs_event";this._id=function(te,Re,Ue,ci){return Re+C(Ue)+(ci?"_".concat(C(ci)):"")},this.on=function(te,Re,Ue,ci,Ze){var ai=this._id.apply(this,arguments),ki=function(Vi){return Ue.call(ci||te,Vi||window.event)};"addEventListener"in te?te.addEventListener(Re,ki,Ze):"attachEvent"in te&&te.attachEvent("on".concat(Re),ki),te[Rt]=te[Rt]||{},te[Rt][ai]=ki},this.off=function(te,Re,Ue,ci,Ze){var ai=this._id.apply(this,arguments),ki=te[Rt]&&te[Rt][ai];!ki||("removeEventListener"in te?te.removeEventListener(Re,ki,Ze):"detachEvent"in te&&te.detachEvent("on".concat(Re),ki),te[Rt][ai]=null)}},t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(mt,Rt){return mt(Rt={exports:{}},Rt.exports),Rt.exports}var Me,ri,o=function(mt){return mt&&mt.Math==Math&&mt},r=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof t&&t)||function(){return this}()||Function("return this")(),a=function(mt){try{return!!mt()}catch(Rt){return!0}},h=!a(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),R=Function.prototype.call,L=R.bind?R.bind(R):function(){return R.apply(R,arguments)},W={}.propertyIsEnumerable,nt=Object.getOwnPropertyDescriptor,It={f:nt&&!W.call({1:2},1)?function(Rt){var te=nt(this,Rt);return!!te&&te.enumerable}:W},gt=function(mt,Rt){return{enumerable:!(1&mt),configurable:!(2&mt),writable:!(4&mt),value:Rt}},wt=Function.prototype,Ut=wt.bind,Jt=wt.call,Ct=Ut&&Ut.bind(Jt),bt=Ut?function(mt){return mt&&Ct(Jt,mt)}:function(mt){return mt&&function(){return Jt.apply(mt,arguments)}},at=bt({}.toString),ft=bt("".slice),lt=function(mt){return ft(at(mt),8,-1)},Ft=r.Object,Mt=bt("".split),yt=a(function(){return!Ft("z").propertyIsEnumerable(0)})?function(mt){return"String"==lt(mt)?Mt(mt,""):Ft(mt)}:Ft,ct=r.TypeError,rt=function(mt){if(null==mt)throw ct("Can't call method on "+mt);return mt},se=function(mt){return yt(rt(mt))},xt=function(mt){return"function"==typeof mt},Lt=function(mt){return"object"==typeof mt?null!==mt:xt(mt)},de=function(mt){return xt(mt)?mt:void 0},_e=function(mt,Rt){return arguments.length<2?de(r[mt]):r[mt]&&r[mt][Rt]},ce=bt({}.isPrototypeOf),Ae=_e("navigator","userAgent")||"",Ne=r.process,qe=r.Deno,Di=Ne&&Ne.versions||qe&&qe.version,ei=Di&&Di.v8;ei&&(ri=(Me=ei.split("."))[0]>0&&Me[0]<4?1:+(Me[0]+Me[1])),!ri&&Ae&&(!(Me=Ae.match(/Edge\/(\d+)/))||Me[1]>=74)&&(Me=Ae.match(/Chrome\/(\d+)/))&&(ri=+Me[1]);var Bt=ri,Ie=!!Object.getOwnPropertySymbols&&!a(function(){var mt=Symbol();return!String(mt)||!(Object(mt)instanceof Symbol)||!Symbol.sham&&Bt&&Bt<41}),Xt=Ie&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,he=r.Object,Dt=Xt?function(mt){return"symbol"==typeof mt}:function(mt){var Rt=_e("Symbol");return xt(Rt)&&ce(Rt.prototype,he(mt))},ve=r.String,je=function(mt){try{return ve(mt)}catch(Rt){return"Object"}},gi=r.TypeError,Ee=function(mt){if(xt(mt))return mt;throw gi(je(mt)+" is not a function")},ne=function(mt,Rt){var te=mt[Rt];return null==te?void 0:Ee(te)},ee=r.TypeError,le=Object.defineProperty,me=function(mt,Rt){try{le(r,mt,{value:Rt,configurable:!0,writable:!0})}catch(te){r[mt]=Rt}return Rt},ye="__core-js_shared__",Zt=r[ye]||me(ye,{}),We=n(function(mt){(mt.exports=function(Rt,te){return Zt[Rt]||(Zt[Rt]=void 0!==te?te:{})})("versions",[]).push({version:"3.19.1",mode:"global",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})}),$e=r.Object,Ti=function(mt){return $e(rt(mt))},vi=bt({}.hasOwnProperty),di=Object.hasOwn||function(Rt,te){return vi(Ti(Rt),te)},Gi=0,Ri=Math.random(),rn=bt(1..toString),ge=function(mt){return"Symbol("+(void 0===mt?"":mt)+")_"+rn(++Gi+Ri,36)},De=We("wks"),_i=r.Symbol,yi=_i&&_i.for,Fi=Xt?_i:_i&&_i.withoutSetter||ge,Ni=function(mt){if(!di(De,mt)||!Ie&&"string"!=typeof De[mt]){var Rt="Symbol."+mt;De[mt]=Ie&&di(_i,mt)?_i[mt]:Xt&&yi?yi(Rt):Fi(Rt)}return De[mt]},mn=r.TypeError,si=Ni("toPrimitive"),Ce=function(mt,Rt){if(!Lt(mt)||Dt(mt))return mt;var Re,te=ne(mt,si);if(te){if(void 0===Rt&&(Rt="default"),Re=L(te,mt,Rt),!Lt(Re)||Dt(Re))return Re;throw mn("Can't convert object to primitive value")}return void 0===Rt&&(Rt="number"),function(mt,Rt){var te,Re;if("string"===Rt&&xt(te=mt.toString)&&!Lt(Re=L(te,mt))||xt(te=mt.valueOf)&&!Lt(Re=L(te,mt))||"string"!==Rt&&xt(te=mt.toString)&&!Lt(Re=L(te,mt)))return Re;throw ee("Can't convert object to primitive value")}(mt,Rt)},Vt=function(mt){var Rt=Ce(mt,"string");return Dt(Rt)?Rt:Rt+""},vt=r.document,Gt=Lt(vt)&&Lt(vt.createElement),fe=function(mt){return Gt?vt.createElement(mt):{}},He=!h&&!a(function(){return 7!=Object.defineProperty(fe("div"),"a",{get:function(){return 7}}).a}),$i=Object.getOwnPropertyDescriptor,In={f:h?$i:function(Rt,te){if(Rt=se(Rt),te=Vt(te),He)try{return $i(Rt,te)}catch(Re){}if(di(Rt,te))return gt(!L(It.f,Rt,te),Rt[te])}},no=r.String,li=r.TypeError,Je=function(mt){if(Lt(mt))return mt;throw li(no(mt)+" is not an object")},xe=r.TypeError,hi=Object.defineProperty,gn={f:h?hi:function(Rt,te,Re){if(Je(Rt),te=Vt(te),Je(Re),He)try{return hi(Rt,te,Re)}catch(Ue){}if("get"in Re||"set"in Re)throw xe("Accessors not supported");return"value"in Re&&(Rt[te]=Re.value),Rt}},kn=h?function(mt,Rt,te){return gn.f(mt,Rt,gt(1,te))}:function(mt,Rt,te){return mt[Rt]=te,mt},so=bt(Function.toString);xt(Zt.inspectSource)||(Zt.inspectSource=function(mt){return so(mt)});var Gn,To,Uo,Do=Zt.inspectSource,Zo=r.WeakMap,qo=xt(Zo)&&/native code/.test(Do(Zo)),yr=We("keys"),xo=function(mt){return yr[mt]||(yr[mt]=ge(mt))},vo={},Fr="Object already initialized",co=r.TypeError;if(qo||Zt.state){var Qo=Zt.state||(Zt.state=new(0,r.WeakMap)),Oo=bt(Qo.get),Bi=bt(Qo.has),On=bt(Qo.set);Gn=function(mt,Rt){if(Bi(Qo,mt))throw new co(Fr);return Rt.facade=mt,On(Qo,mt,Rt),Rt},To=function(mt){return Oo(Qo,mt)||{}},Uo=function(mt){return Bi(Qo,mt)}}else{var Wn=xo("state");vo[Wn]=!0,Gn=function(mt,Rt){if(di(mt,Wn))throw new co(Fr);return Rt.facade=mt,kn(mt,Wn,Rt),Rt},To=function(mt){return di(mt,Wn)?mt[Wn]:{}},Uo=function(mt){return di(mt,Wn)}}var ae={set:Gn,get:To,has:Uo,enforce:function(mt){return Uo(mt)?To(mt):Gn(mt,{})},getterFor:function(mt){return function(Rt){var te;if(!Lt(Rt)||(te=To(Rt)).type!==mt)throw co("Incompatible receiver, "+mt+" required");return te}}},Fe=Function.prototype,Mi=h&&Object.getOwnPropertyDescriptor,Yi=di(Fe,"name"),ao={EXISTS:Yi,PROPER:Yi&&"something"===function(){}.name,CONFIGURABLE:Yi&&(!h||h&&Mi(Fe,"name").configurable)},lo=n(function(mt){var Rt=ao.CONFIGURABLE,te=ae.get,Re=ae.enforce,Ue=String(String).split("String");(mt.exports=function(ci,Ze,ai,ki){var ho,Ai=!!ki&&!!ki.unsafe,Vi=!!ki&&!!ki.enumerable,to=!!ki&&!!ki.noTargetGet,zn=ki&&void 0!==ki.name?ki.name:Ze;xt(ai)&&("Symbol("===String(zn).slice(0,7)&&(zn="["+String(zn).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!di(ai,"name")||Rt&&ai.name!==zn)&&kn(ai,"name",zn),(ho=Re(ai)).source||(ho.source=Ue.join("string"==typeof zn?zn:""))),ci!==r?(Ai?!to&&ci[Ze]&&(Vi=!0):delete ci[Ze],Vi?ci[Ze]=ai:kn(ci,Ze,ai)):Vi?ci[Ze]=ai:me(Ze,ai)})(Function.prototype,"toString",function(){return xt(this)&&te(this).source||Do(this)})}),Rn=Math.ceil,Kr=Math.floor,_r=function(mt){var Rt=+mt;return Rt!=Rt||0===Rt?0:(Rt>0?Kr:Rn)(Rt)},rr=Math.max,Or=Math.min,uo=function(mt,Rt){var te=_r(mt);return te<0?rr(te+Rt,0):Or(te,Rt)},Os=Math.min,Wr=function(mt){return mt>0?Os(_r(mt),9007199254740991):0},sr=function(mt){return Wr(mt.length)},wr=function(mt){return function(Rt,te,Re){var ai,Ue=se(Rt),ci=sr(Ue),Ze=uo(Re,ci);if(mt&&te!=te){for(;ci>Ze;)if((ai=Ue[Ze++])!=ai)return!0}else for(;ci>Ze;Ze++)if((mt||Ze in Ue)&&Ue[Ze]===te)return mt||Ze||0;return!mt&&-1}},Ua={includes:wr(!0),indexOf:wr(!1)},Cr=Ua.indexOf,us=bt([].push),ya=function(mt,Rt){var ci,te=se(mt),Re=0,Ue=[];for(ci in te)!di(vo,ci)&&di(te,ci)&&us(Ue,ci);for(;Rt.length>Re;)di(te,ci=Rt[Re++])&&(~Cr(Ue,ci)||us(Ue,ci));return Ue},Vo=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ma=Vo.concat("length","prototype"),js={f:Object.getOwnPropertyNames||function(Rt){return ya(Rt,Ma)}},nl={f:Object.getOwnPropertySymbols},Va=bt([].concat),Ys=_e("Reflect","ownKeys")||function(Rt){var te=js.f(Je(Rt)),Re=nl.f;return Re?Va(te,Re(Rt)):te},ol=function(mt,Rt){for(var te=Ys(Rt),Re=gn.f,Ue=In.f,ci=0;ci<te.length;ci++){var Ze=te[ci];di(mt,Ze)||Re(mt,Ze,Ue(Rt,Ze))}},Xs=/#|\.prototype\./,ts=function(mt,Rt){var te=Ga[rl(mt)];return te==Go||te!=es&&(xt(Rt)?a(Rt):!!Rt)},rl=ts.normalize=function(mt){return String(mt).replace(Xs,".").toLowerCase()},Ga=ts.data={},es=ts.NATIVE="N",Go=ts.POLYFILL="P",Bo=ts,na=In.f,Ar=function(mt,Rt){var Ze,ai,ki,Ai,Vi,te=mt.target,Re=mt.global,Ue=mt.stat;if(Ze=Re?r:Ue?r[te]||me(te,{}):(r[te]||{}).prototype)for(ai in Rt){if(Ai=Rt[ai],ki=mt.noTargetGet?(Vi=na(Ze,ai))&&Vi.value:Ze[ai],!Bo(Re?ai:te+(Ue?".":"#")+ai,mt.forced)&&void 0!==ki){if(typeof Ai==typeof ki)continue;ol(Ai,ki)}(mt.sham||ki&&ki.sham)&&kn(Ai,"sham",!0),lo(Ze,ai,Ai,mt)}},oa={};oa[Ni("toStringTag")]="z";var bi,Br="[object z]"===String(oa),pa=Ni("toStringTag"),kr=r.Object,tr="Arguments"==lt(function(){return arguments}()),ar=Br?lt:function(mt){var Rt,te,Re;return void 0===mt?"Undefined":null===mt?"Null":"string"==typeof(te=function(mt,Rt){try{return mt[Rt]}catch(te){}}(Rt=kr(mt),pa))?te:tr?lt(Rt):"Object"==(Re=lt(Rt))&&xt(Rt.callee)?"Arguments":Re},As=r.String,Lo=function(mt){if("Symbol"===ar(mt))throw TypeError("Cannot convert a Symbol value to a string");return As(mt)},Cs=function(){var mt=Je(this),Rt="";return mt.global&&(Rt+="g"),mt.ignoreCase&&(Rt+="i"),mt.multiline&&(Rt+="m"),mt.dotAll&&(Rt+="s"),mt.unicode&&(Rt+="u"),mt.sticky&&(Rt+="y"),Rt},hr=r.RegExp,Oa=a(function(){var mt=hr("a","y");return mt.lastIndex=2,null!=mt.exec("abcd")}),Wa=a(function(){var mt=hr("^r","gy");return mt.lastIndex=2,null!=mt.exec("str")}),hs={UNSUPPORTED_Y:Oa,BROKEN_CARET:Wa},Jr=Object.keys||function(Rt){return ya(Rt,Vo)},ks=h?Object.defineProperties:function(Rt,te){Je(Rt);for(var ai,Re=se(te),Ue=Jr(te),ci=Ue.length,Ze=0;ci>Ze;)gn.f(Rt,ai=Ue[Ze++],Re[ai]);return Rt},pl=_e("document","documentElement"),fa="prototype",kt="script",Q=xo("IE_PROTO"),V=function(){},j=function(mt){return"<script>"+mt+"</"+kt+">"},Ot=function(mt){mt.write(j("")),mt.close();var Rt=mt.parentWindow.Object;return mt=null,Rt},un=function(){try{bi=new ActiveXObject("htmlfile")}catch(Rt){}un="undefined"!=typeof document?document.domain&&bi?Ot(bi):function(){var te,mt=fe("iframe");return mt.style.display="none",pl.appendChild(mt),mt.src=String("javascript:"),(te=mt.contentWindow.document).open(),te.write(j("document.F=Object")),te.close(),te.F}():Ot(bi);for(var mt=Vo.length;mt--;)delete un[fa][Vo[mt]];return un()};vo[Q]=!0;var Hn=Object.create||function(Rt,te){var Re;return null!==Rt?(V[fa]=Je(Rt),Re=new V,V[fa]=null,Re[Q]=Rt):Re=un(),void 0===te?Re:ks(Re,te)},Po=r.RegExp,Yo=a(function(){var mt=Po(".","s");return!(mt.dotAll&&mt.exec("\n")&&"s"===mt.flags)}),Fo=r.RegExp,er=a(function(){var mt=Fo("(?<a>b)","g");return"b"!==mt.exec("b").groups.a||"bc"!=="b".replace(mt,"$<a>c")}),fo=ae.get,xr=We("native-string-replace",String.prototype.replace),Jn=RegExp.prototype.exec,Ks=Jn,sl=bt("".charAt),$r=bt("".indexOf),za=bt("".replace),xs=bt("".slice),Ta=function(){var mt=/a/,Rt=/b*/g;return L(Jn,mt,"a"),L(Jn,Rt,"a"),0!==mt.lastIndex||0!==Rt.lastIndex}(),yc=hs.UNSUPPORTED_Y||hs.BROKEN_CARET,Xi=void 0!==/()??/.exec("")[1];(Ta||Xi||yc||Yo||er)&&(Ks=function(Rt){var Ze,ai,ki,Ai,Vi,to,zn,te=this,Re=fo(te),Ue=Lo(Rt),ci=Re.raw;if(ci)return ci.lastIndex=te.lastIndex,Ze=L(Ks,ci,Ue),te.lastIndex=ci.lastIndex,Ze;var ho=Re.groups,Ur=yc&&te.sticky,br=L(Cs,te),$o=te.source,fr=0,Xr=Ue;if(Ur&&(br=za(br,"y",""),-1===$r(br,"g")&&(br+="g"),Xr=xs(Ue,te.lastIndex),te.lastIndex>0&&(!te.multiline||te.multiline&&"\n"!==sl(Ue,te.lastIndex-1))&&($o="(?: "+$o+")",Xr=" "+Xr,fr++),ai=new RegExp("^(?:"+$o+")",br)),Xi&&(ai=new RegExp("^"+$o+"$(?!\\s)",br)),Ta&&(ki=te.lastIndex),Ai=L(Jn,Ur?ai:te,Xr),Ur?Ai?(Ai.input=xs(Ai.input,fr),Ai[0]=xs(Ai[0],fr),Ai.index=te.lastIndex,te.lastIndex+=Ai[0].length):te.lastIndex=0:Ta&&Ai&&(te.lastIndex=te.global?Ai.index+Ai[0].length:ki),Xi&&Ai&&Ai.length>1&&L(xr,Ai[0],ai,function(){for(Vi=1;Vi<arguments.length-2;Vi++)void 0===arguments[Vi]&&(Ai[Vi]=void 0)}),Ai&&ho)for(Ai.groups=to=Hn(null),Vi=0;Vi<ho.length;Vi++)to[(zn=ho[Vi])[0]]=Ai[zn[1]];return Ai});var ie=Ks;Ar({target:"RegExp",proto:!0,forced:/./.exec!==ie},{exec:ie});var z=Ni("species"),J=RegExp.prototype,_t=function(mt,Rt,te,Re){var Ue=Ni(mt),ci=!a(function(){var Ai={};return Ai[Ue]=function(){return 7},7!=""[mt](Ai)}),Ze=ci&&!a(function(){var Ai=!1,Vi=/a/;return"split"===mt&&((Vi={}).constructor={},Vi.constructor[z]=function(){return Vi},Vi.flags="",Vi[Ue]=/./[Ue]),Vi.exec=function(){return Ai=!0,null},Vi[Ue](""),!Ai});if(!ci||!Ze||te){var ai=bt(/./[Ue]),ki=Rt(Ue,""[mt],function(Ai,Vi,to,zn,ho){var Ur=bt(Ai),br=Vi.exec;return br===ie||br===J.exec?ci&&!ho?{done:!0,value:ai(Vi,to,zn)}:{done:!0,value:Ur(to,Vi,zn)}:{done:!1}});lo(String.prototype,mt,ki[0]),lo(J,Ue,ki[1])}Re&&kn(J[Ue],"sham",!0)},Qt=bt("".charAt),Te=bt("".charCodeAt),Ye=bt("".slice),Qe=function(mt){return function(Rt,te){var Ze,ai,Re=Lo(rt(Rt)),Ue=_r(te),ci=Re.length;return Ue<0||Ue>=ci?mt?"":void 0:(Ze=Te(Re,Ue))<55296||Ze>56319||Ue+1===ci||(ai=Te(Re,Ue+1))<56320||ai>57343?mt?Qt(Re,Ue):Ze:mt?Ye(Re,Ue,Ue+2):ai-56320+(Ze-55296<<10)+65536}},Ui=(Qe(!1),Qe(!0)),hn=function(mt,Rt,te){return Rt+(te?Ui(mt,Rt).length:1)},Tn=r.TypeError,$n=function(mt,Rt){var te=mt.exec;if(xt(te)){var Re=L(te,mt,Rt);return null!==Re&&Je(Re),Re}if("RegExp"===lt(mt))return L(ie,mt,Rt);throw Tn("RegExp#exec called on incompatible receiver")};_t("match",function(mt,Rt,te){return[function(Ue){var ci=rt(this),Ze=null==Ue?void 0:ne(Ue,mt);return Ze?L(Ze,Ue,ci):new RegExp(Ue)[mt](Lo(ci))},function(Re){var Ue=Je(this),ci=Lo(Re),Ze=te(Rt,Ue,ci);if(Ze.done)return Ze.value;if(!Ue.global)return $n(Ue,ci);var ai=Ue.unicode;Ue.lastIndex=0;for(var Vi,ki=[],Ai=0;null!==(Vi=$n(Ue,ci));){var to=Lo(Vi[0]);ki[Ai]=to,""===to&&(Ue.lastIndex=hn(ci,Wr(Ue.lastIndex),ai)),Ai++}return 0===Ai?null:ki}]});var po=Array.isArray||function(Rt){return"Array"==lt(Rt)},Un=function(mt,Rt,te){var Re=Vt(Rt);Re in mt?gn.f(mt,Re,gt(0,te)):mt[Re]=te},jn=function(){},oo=[],Ko=_e("Reflect","construct"),dr=/^\s*(?:class|function)\b/,is=bt(dr.exec),Hr=!dr.exec(jn),Ls=function(mt){if(!xt(mt))return!1;try{return Ko(jn,oo,mt),!0}catch(Rt){return!1}},Sr=!Ko||a(function(){var mt;return Ls(Ls.call)||!Ls(Object)||!Ls(function(){mt=!0})||mt})?function(mt){if(!xt(mt))return!1;switch(ar(mt)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return Hr||!!is(dr,Do(mt))}:Ls,Js=Ni("species"),$s=r.Array,Aa=function(mt,Rt){return new(function(mt){var Rt;return po(mt)&&(Sr(Rt=mt.constructor)&&(Rt===$s||po(Rt.prototype))||Lt(Rt)&&null===(Rt=Rt[Js]))&&(Rt=void 0),void 0===Rt?$s:Rt}(mt))(0===Rt?0:Rt)},ir=Ni("species"),Qs=function(mt){return Bt>=51||!a(function(){var Rt=[];return(Rt.constructor={})[ir]=function(){return{foo:1}},1!==Rt[mt](Boolean).foo})},ja=Ni("isConcatSpreadable"),ps=9007199254740991,Sn="Maximum allowed index exceeded",Xn=r.TypeError,Nn=Bt>=51||!a(function(){var mt=[];return mt[ja]=!1,mt.concat()[0]!==mt}),bo=Qs("concat"),Eo=function(mt){if(!Lt(mt))return!1;var Rt=mt[ja];return void 0!==Rt?!!Rt:po(mt)};Ar({target:"Array",proto:!0,forced:!Nn||!bo},{concat:function(Rt){var ci,Ze,ai,ki,Ai,te=Ti(this),Re=Aa(te,0),Ue=0;for(ci=-1,ai=arguments.length;ci<ai;ci++)if(Eo(Ai=-1===ci?te:arguments[ci])){if(Ue+(ki=sr(Ai))>ps)throw Xn(Sn);for(Ze=0;Ze<ki;Ze++,Ue++)Ze in Ai&&Un(Re,Ue,Ai[Ze])}else{if(Ue>=ps)throw Xn(Sn);Un(Re,Ue++,Ai)}return Re.length=Ue,Re}}),Br||lo(Object.prototype,"toString",Br?{}.toString:function(){return"[object "+ar(this)+"]"},{unsafe:!0});var ra=ao.PROPER,lr="toString",Lr=RegExp.prototype,ns=Lr[lr],Ss=bt(Cs);(a(function(){return"/a/b"!=ns.call({source:"a",flags:"b"})})||ra&&ns.name!=lr)&&lo(RegExp.prototype,lr,function(){var Rt=Je(this),te=Lo(Rt.source),Re=Rt.flags;return"/"+te+"/"+Lo(void 0===Re&&ce(Lr,Rt)&&!("flags"in Lr)?Ss(Rt):Re)},{unsafe:!0});var Fs=Function.prototype,Zl=Fs.apply,Bs=Fs.call,Zr="object"==typeof Reflect&&Reflect.apply||(Fs.bind?Bs.bind(Zl):function(){return Bs.apply(Zl,arguments)}),sa=Ni("match"),Ya=function(mt){var Rt;return Lt(mt)&&(void 0!==(Rt=mt[sa])?!!Rt:"RegExp"==lt(mt))},ka=r.TypeError,ll=Ni("species"),Ul=function(mt,Rt){var Re,te=Je(mt).constructor;return void 0===te||null==(Re=Je(te)[ll])?Rt:function(mt){if(Sr(mt))return mt;throw ka(je(mt)+" is not a constructor")}(Re)},cl=bt([].slice),fl=hs.UNSUPPORTED_Y,gl=4294967295,Fc=Math.min,ga=[].push,ql=bt(/./.exec),Xa=bt(ga),qs=bt("".slice),xa=!a(function(){var mt=/(?:)/,Rt=mt.exec;mt.exec=function(){return Rt.apply(this,arguments)};var te="ab".split(mt);return 2!==te.length||"a"!==te[0]||"b"!==te[1]});function Hs(mt,Rt){if(mt instanceof SVGElement){var te=mt.getAttribute("class")||"";te.match(Rt)||mt.setAttribute("class","".concat(te," ").concat(Rt))}else void 0!==mt.classList?m(Rt.split(" "),function(Ue){mt.classList.add(Ue)}):mt.className.match(Rt)||(mt.className+=" ".concat(Rt))}function Ea(mt,Rt){var te="";return mt.currentStyle?te=mt.currentStyle[Rt]:document.defaultView&&document.defaultView.getComputedStyle&&(te=document.defaultView.getComputedStyle(mt,null).getPropertyValue(Rt)),te&&te.toLowerCase?te.toLowerCase():te}function sc(mt){var Rt=mt.element;if(this._options.scrollToElement){var te=function tc(mt){var Rt=window.getComputedStyle(mt),te="absolute"===Rt.position,Re=/(auto|scroll)/;if("fixed"===Rt.position)return document.body;for(var Ue=mt;Ue=Ue.parentElement;)if(Rt=window.getComputedStyle(Ue),(!te||"static"!==Rt.position)&&Re.test(Rt.overflow+Rt.overflowY+Rt.overflowX))return Ue;return document.body}(Rt);te!==document.body&&(te.scrollTop=Rt.offsetTop-te.offsetTop)}}function Tc(){if(void 0!==window.innerWidth)return{width:window.innerWidth,height:window.innerHeight};var mt=document.documentElement;return{width:mt.clientWidth,height:mt.clientHeight}}function dt(mt,Rt,te){var Ue,Re=Rt.element;if("off"!==mt&&this._options.scrollToElement&&(Ue="tooltip"===mt?te.getBoundingClientRect():Re.getBoundingClientRect(),!function Bc(mt){var Rt=mt.getBoundingClientRect();return Rt.top>=0&&Rt.left>=0&&Rt.bottom+80<=window.innerHeight&&Rt.right<=window.innerWidth}(Re))){var ci=Tc().height;Ue.bottom-(Ue.bottom-Ue.top)<0||Re.clientHeight>ci?window.scrollBy(0,Ue.top-(ci/2-Ue.height/2)-this._options.scrollPadding):window.scrollBy(0,Ue.top-(ci/2-Ue.height/2)+this._options.scrollPadding)}}function ot(mt){mt.setAttribute("role","button"),mt.tabIndex=0}_t("split",function(mt,Rt,te){var Re;return Re="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(Ue,ci){var Ze=Lo(rt(this)),ai=void 0===ci?gl:ci>>>0;if(0===ai)return[];if(void 0===Ue)return[Ze];if(!Ya(Ue))return L(Rt,Ze,Ue,ai);for(var zn,ho,Ur,ki=[],Vi=0,to=new RegExp(Ue.source,(Ue.ignoreCase?"i":"")+(Ue.multiline?"m":"")+(Ue.unicode?"u":"")+(Ue.sticky?"y":"")+"g");(zn=L(ie,to,Ze))&&!((ho=to.lastIndex)>Vi&&(Xa(ki,qs(Ze,Vi,zn.index)),zn.length>1&&zn.index<Ze.length&&Zr(ga,ki,cl(zn,1)),Ur=zn[0].length,Vi=ho,ki.length>=ai));)to.lastIndex===zn.index&&to.lastIndex++;return Vi===Ze.length?(Ur||!ql(to,""))&&Xa(ki,""):Xa(ki,qs(Ze,Vi)),ki.length>ai?cl(ki,0,ai):ki}:"0".split(void 0,0).length?function(Ue,ci){return void 0===Ue&&0===ci?[]:L(Rt,this,Ue,ci)}:Rt,[function(ci,Ze){var ai=rt(this),ki=null==ci?void 0:ne(ci,mt);return ki?L(ki,ci,ai,Ze):L(Re,Lo(ai),ci,Ze)},function(Ue,ci){var Ze=Je(this),ai=Lo(Ue),ki=te(Re,Ze,ai,ci,Re!==Rt);if(ki.done)return ki.value;var Ai=Ul(Ze,RegExp),Vi=Ze.unicode,zn=new Ai(fl?"^(?:"+Ze.source+")":Ze,(Ze.ignoreCase?"i":"")+(Ze.multiline?"m":"")+(Ze.unicode?"u":"")+(fl?"g":"y")),ho=void 0===ci?gl:ci>>>0;if(0===ho)return[];if(0===ai.length)return null===$n(zn,ai)?[ai]:[];for(var Ur=0,br=0,$o=[];br<ai.length;){zn.lastIndex=fl?0:br;var Xr,fr=$n(zn,fl?qs(ai,br):ai);if(null===fr||(Xr=Fc(Wr(zn.lastIndex+(fl?br:0)),ai.length))===Ur)br=hn(ai,br,Vi);else{if(Xa($o,qs(ai,Ur,br)),$o.length===ho)return $o;for(var mr=1;mr<=fr.length-1;mr++)if(Xa($o,fr[mr]),$o.length===ho)return $o;br=Ur=Xr}}return Xa($o,qs(ai,Ur)),$o}]},!xa,fl);var q=Object.assign,At=Object.defineProperty,Wt=bt([].concat),pe=!q||a(function(){if(h&&1!==q({b:1},q(At({},"a",{enumerable:!0,get:function(){At(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var mt={},Rt={},te=Symbol(),Re="abcdefghijklmnopqrst";return mt[te]=7,Re.split("").forEach(function(Ue){Rt[Ue]=Ue}),7!=q({},mt)[te]||Jr(q({},Rt)).join("")!=Re})?function(Rt,te){for(var Re=Ti(Rt),Ue=arguments.length,ci=1,Ze=nl.f,ai=It.f;Ue>ci;)for(var zn,ki=yt(arguments[ci++]),Ai=Ze?Wt(Jr(ki),Ze(ki)):Jr(ki),Vi=Ai.length,to=0;Vi>to;)zn=Ai[to++],(!h||L(ai,ki,zn))&&(Re[zn]=ki[zn]);return Re}:q;function Ve(mt){var Rt=mt.parentNode;return!(!Rt||"HTML"===Rt.nodeName)&&("fixed"===Ea(mt,"position")||Ve(Rt))}function ti(mt,Rt){var te=document.body,Re=document.documentElement,Ue=window.pageYOffset||Re.scrollTop||te.scrollTop,ci=window.pageXOffset||Re.scrollLeft||te.scrollLeft;Rt=Rt||te;var Ze=mt.getBoundingClientRect(),ai=Rt.getBoundingClientRect(),ki=Ea(Rt,"position"),Ai={width:Ze.width,height:Ze.height};return"body"!==Rt.tagName.toLowerCase()&&"relative"===ki||"sticky"===ki?Object.assign(Ai,{top:Ze.top-ai.top,left:Ze.left-ai.left}):Ve(mt)?Object.assign(Ai,{top:Ze.top,left:Ze.left}):Object.assign(Ai,{top:Ze.top+Ue,left:Ze.left+ci})}Ar({target:"Object",stat:!0,forced:Object.assign!==pe},{assign:pe});var Li=Math.floor,wn=bt("".charAt),Co=bt("".replace),Kn=bt("".slice),Jo=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,pr=/\$([$&'`]|\d{1,2})/g,Sl=function(mt,Rt,te,Re,Ue,ci){var Ze=te+mt.length,ai=Re.length,ki=pr;return void 0!==Ue&&(Ue=Ti(Ue),ki=Jo),Co(ci,ki,function(Ai,Vi){var to;switch(wn(Vi,0)){case"$":return"$";case"&":return mt;case"`":return Kn(Rt,0,te);case"'":return Kn(Rt,Ze);case"<":to=Ue[Kn(Vi,1,-1)];break;default:var zn=+Vi;if(0===zn)return Ai;if(zn>ai){var ho=Li(zn/10);return 0===ho?Ai:ho<=ai?void 0===Re[ho-1]?wn(Vi,1):Re[ho-1]+wn(Vi,1):Ai}to=Re[zn-1]}return void 0===to?"":to})},Us=Ni("replace"),fs=Math.max,Vs=Math.min,Ka=bt([].concat),os=bt([].push),_l=bt("".indexOf),Ja=bt("".slice),nu=function(mt){return void 0===mt?mt:String(mt)},_a="$0"==="a".replace(/./,"$0"),Vl=!!/./[Us]&&""===/./[Us]("a","$0"),gs=!a(function(){var mt=/./;return mt.exec=function(){var Rt=[];return Rt.groups={a:"7"},Rt},"7"!=="".replace(mt,"$<a>")});function Rr(mt,Rt){if(mt instanceof SVGElement){var te=mt.getAttribute("class")||"";mt.setAttribute("class",te.replace(Rt,"").replace(/^\s+|\s+$/g,""))}else mt.className=mt.className.replace(Rt,"").replace(/^\s+|\s+$/g,"")}function Dr(mt,Rt){var te="";if(mt.style.cssText&&(te+=mt.style.cssText),"string"==typeof Rt)te+=Rt;else for(var Re in Rt)te+="".concat(Re,":").concat(Rt[Re],";");mt.style.cssText=te}function nr(mt){if(mt){if(!this._introItems[this._currentStep])return;var Rt=this._introItems[this._currentStep],te=ti(Rt.element,this._targetElement),Re=this._options.helperElementPadding;Ve(Rt.element)?Hs(mt,"introjs-fixedTooltip"):Rr(mt,"introjs-fixedTooltip"),"floating"===Rt.position&&(Re=0),Dr(mt,{width:"".concat(te.width+Re,"px"),height:"".concat(te.height+Re,"px"),top:"".concat(te.top-Re/2,"px"),left:"".concat(te.left-Re/2,"px")})}}_t("replace",function(mt,Rt,te){var Re=Vl?"$":"$0";return[function(ci,Ze){var ai=rt(this),ki=null==ci?void 0:ne(ci,Us);return ki?L(ki,ci,ai,Ze):L(Rt,Lo(ai),ci,Ze)},function(Ue,ci){var Ze=Je(this),ai=Lo(Ue);if("string"==typeof ci&&-1===_l(ci,Re)&&-1===_l(ci,"$<")){var ki=te(Rt,Ze,ai,ci);if(ki.done)return ki.value}var Ai=xt(ci);Ai||(ci=Lo(ci));var Vi=Ze.global;if(Vi){var to=Ze.unicode;Ze.lastIndex=0}for(var zn=[];;){var ho=$n(Ze,ai);if(null===ho||(os(zn,ho),!Vi))break;""===Lo(ho[0])&&(Ze.lastIndex=hn(ai,Wr(Ze.lastIndex),to))}for(var br="",$o=0,fr=0;fr<zn.length;fr++){for(var Xr=Lo((ho=zn[fr])[0]),mr=fs(Vs(_r(ho.index),ai.length),0),ua=[],rs=1;rs<ho.length;rs++)os(ua,nu(ho[rs]));var ws=ho.groups;if(Ai){var bl=Ka([Xr],ua,mr,ai);void 0!==ws&&os(bl,ws);var lu=Lo(Zr(ci,void 0,bl))}else lu=Sl(Xr,ai,mr,ua,ws,ci);mr>=$o&&(br+=Ja(ai,$o,mr)+lu,$o=mr+Xr.length)}return br+Ja(ai,$o)}]},!gs||!_a||Vl);var Rl=Ni("unscopables"),ou=Array.prototype;null==ou[Rl]&&gn.f(ou,Rl,{configurable:!0,value:Hn(null)});var th=Ua.includes;Ar({target:"Array",proto:!0},{includes:function(Rt){return th(this,Rt,arguments.length>1?arguments[1]:void 0)}}),function(mt){ou[Rl][mt]=!0}("includes");var Fu=Qs("slice"),Cu=Ni("species"),bc=r.Array,Bu=Math.max;Ar({target:"Array",proto:!0,forced:!Fu},{slice:function(Rt,te){var ai,ki,Ai,Re=se(this),Ue=sr(Re),ci=uo(Rt,Ue),Ze=uo(void 0===te?Ue:te,Ue);if(po(Re)&&((Sr(ai=Re.constructor)&&(ai===bc||po(ai.prototype))||Lt(ai)&&null===(ai=ai[Cu]))&&(ai=void 0),ai===bc||void 0===ai))return cl(Re,ci,Ze);for(ki=new(void 0===ai?bc:ai)(Bu(Ze-ci,0)),Ai=0;ci<Ze;ci++,Ai++)ci in Re&&Un(ki,Ai,Re[ci]);return ki.length=Ai,ki}});var Su=r.TypeError,eh=function(mt){if(Ya(mt))throw Su("The method doesn't accept regular expressions");return mt},ac=Ni("match"),Nr=bt("".indexOf);Ar({target:"String",proto:!0,forced:!function(mt){var Rt=/./;try{"/./"[mt](Rt)}catch(te){try{return Rt[ac]=!1,"/./"[mt](Rt)}catch(Re){}}return!1}("includes")},{includes:function(Rt){return!!~Nr(Lo(rt(this)),Lo(eh(Rt)),arguments.length>1?arguments[1]:void 0)}});var Gl=function(mt,Rt){var te=[][mt];return!!te&&a(function(){te.call(null,Rt||function(){throw 1},1)})},ec=bt([].join),Rs=yt!=Object,$a=Gl("join",",");Ar({target:"Array",proto:!0,forced:Rs||!$a},{join:function(Rt){return ec(se(this),void 0===Rt?",":Rt)}});var Ca=bt(bt.bind),Za=bt([].push),La=function(mt){var Rt=1==mt,te=2==mt,Re=3==mt,Ue=4==mt,ci=6==mt,Ze=7==mt,ai=5==mt||ci;return function(ki,Ai,Vi,to){for(var mr,ua,zn=Ti(ki),ho=yt(zn),Ur=function(mt,Rt){return Ee(mt),void 0===Rt?mt:Ca?Ca(mt,Rt):function(){return mt.apply(Rt,arguments)}}(Ai,Vi),br=sr(ho),$o=0,fr=to||Aa,Xr=Rt?fr(ki,br):te||Ze?fr(ki,0):void 0;br>$o;$o++)if((ai||$o in ho)&&(ua=Ur(mr=ho[$o],$o,zn),mt))if(Rt)Xr[$o]=ua;else if(ua)switch(mt){case 3:return!0;case 5:return mr;case 6:return $o;case 2:Za(Xr,mr)}else switch(mt){case 4:return!1;case 7:Za(Xr,mr)}return ci?-1:Re||Ue?Ue:Xr}},Hc=[La(0),La(1),La(2),La(3),La(4),La(5),La(6),La(7)][2];function Wo(mt,Rt,te,Re,Ue){return mt.left+Rt+te.width>Re.width?(Ue.style.left="".concat(Re.width-te.width-mt.left,"px"),!1):(Ue.style.left="".concat(Rt,"px"),!0)}function Na(mt,Rt,te,Re){return mt.left+mt.width-Rt-te.width<0?(Re.style.left="".concat(-mt.left,"px"),!1):(Re.style.right="".concat(Rt,"px"),!0)}Ar({target:"Array",proto:!0,forced:!Qs("filter")},{filter:function(Rt){return Hc(this,Rt,arguments.length>1?arguments[1]:void 0)}});var Il=Qs("splice"),Wl=r.TypeError,Is=Math.max,Qa=Math.min,ic=9007199254740991,ih="Maximum allowed length exceeded";function wl(mt,Rt){mt.includes(Rt)&&mt.splice(mt.indexOf(Rt),1)}function Cc(mt,Rt,te){var Re=this._options.positionPrecedence.slice(),Ue=Tc(),ci=ti(Rt).height+10,Ze=ti(Rt).width+20,ai=mt.getBoundingClientRect(),ki="floating";ai.bottom+ci>Ue.height&&wl(Re,"bottom"),ai.top-ci<0&&wl(Re,"top"),ai.right+Ze>Ue.width&&wl(Re,"right"),ai.left-Ze<0&&wl(Re,"left");var Vi,to,Ai=-1!==(to=(Vi=te||"").indexOf("-"))?Vi.substr(to):"";return te&&(te=te.split("-")[0]),Re.length&&(ki=Re.includes(te)?te:Re[0]),["top","bottom"].includes(ki)&&(ki+=function nc(mt,Rt,te,Re){var ci=Rt/2,Ze=Math.min(te.width,window.screen.width),ai=["-left-aligned","-middle-aligned","-right-aligned"];return Ze-mt<Rt&&wl(ai,"-left-aligned"),(mt<ci||Ze-mt<ci)&&wl(ai,"-middle-aligned"),mt<Rt&&wl(ai,"-right-aligned"),ai.length?ai.includes(Re)?Re:ai[0]:"-middle-aligned"}(ai.left,Ze,Ue,Ai)),ki}function _s(mt,Rt,te,Re){var ci,Ze,ai,ki,Ai;if(Re=Re||!1,Rt.style.top=null,Rt.style.right=null,Rt.style.bottom=null,Rt.style.left=null,Rt.style.marginLeft=null,Rt.style.marginTop=null,te.style.display="inherit",this._introItems[this._currentStep])switch(Rt.className=["introjs-tooltip","string"==typeof(ci=this._introItems[this._currentStep]).tooltipClass?ci.tooltipClass:this._options.tooltipClass].filter(Boolean).join(" "),Rt.setAttribute("role","dialog"),"floating"!==(Ai=this._introItems[this._currentStep].position)&&this._options.autoPosition&&(Ai=Cc.call(this,mt,Rt,Ai)),ai=ti(mt),Ze=ti(Rt),ki=Tc(),Hs(Rt,"introjs-".concat(Ai)),Ai){case"top-right-aligned":te.className="introjs-arrow bottom-right";var to=0;Na(ai,to,Ze,Rt),Rt.style.bottom="".concat(ai.height+20,"px");break;case"top-middle-aligned":te.className="introjs-arrow bottom-middle";var zn=ai.width/2-Ze.width/2;Re&&(zn+=5),Na(ai,zn,Ze,Rt)&&(Rt.style.right=null,Wo(ai,zn,Ze,ki,Rt)),Rt.style.bottom="".concat(ai.height+20,"px");break;case"top-left-aligned":case"top":te.className="introjs-arrow bottom",Wo(ai,Re?0:15,Ze,ki,Rt),Rt.style.bottom="".concat(ai.height+20,"px");break;case"right":Rt.style.left="".concat(ai.width+20,"px"),ai.top+Ze.height>ki.height?(te.className="introjs-arrow left-bottom",Rt.style.top="-".concat(Ze.height-ai.height-20,"px")):te.className="introjs-arrow left";break;case"left":!Re&&!0===this._options.showStepNumbers&&(Rt.style.top="15px"),ai.top+Ze.height>ki.height?(Rt.style.top="-".concat(Ze.height-ai.height-20,"px"),te.className="introjs-arrow right-bottom"):te.className="introjs-arrow right",Rt.style.right="".concat(ai.width+20,"px");break;case"floating":te.style.display="none",Rt.style.left="50%",Rt.style.top="50%",Rt.style.marginLeft="-".concat(Ze.width/2,"px"),Rt.style.marginTop="-".concat(Ze.height/2,"px");break;case"bottom-right-aligned":te.className="introjs-arrow top-right",Na(ai,to=0,Ze,Rt),Rt.style.top="".concat(ai.height+20,"px");break;case"bottom-middle-aligned":te.className="introjs-arrow top-middle",zn=ai.width/2-Ze.width/2,Re&&(zn+=5),Na(ai,zn,Ze,Rt)&&(Rt.style.right=null,Wo(ai,zn,Ze,ki,Rt)),Rt.style.top="".concat(ai.height+20,"px");break;default:te.className="introjs-arrow top",Wo(ai,0,Ze,ki,Rt),Rt.style.top="".concat(ai.height+20,"px")}}function ml(){m(document.querySelectorAll(".introjs-showElement"),function(Rt){Rr(Rt,/introjs-[a-zA-Z]+/g)})}function Ao(mt,Rt){var te=document.createElement(mt);Rt=Rt||{};var Re=/^(?:role|data-|aria-)/;for(var Ue in Rt){var ci=Rt[Ue];"style"===Ue?Dr(te,ci):Ue.match(Re)?te.setAttribute(Ue,ci):te[Ue]=ci}return te}function Uc(mt,Rt,te){if(te){var Re=Rt.style.opacity||"1";Dr(Rt,{opacity:"0"}),window.setTimeout(function(){Dr(Rt,{opacity:Re})},10)}mt.appendChild(Rt)}function la(){return parseInt(this._currentStep+1,10)/this._introItems.length*100}function lc(){var mt=document.querySelector(".introjs-disableInteraction");null===mt&&(mt=Ao("div",{className:"introjs-disableInteraction"}),this._targetElement.appendChild(mt)),nr.call(this,mt)}function Vc(mt){var Rt=this,te=Ao("div",{className:"introjs-bullets"});!1===this._options.showBullets&&(te.style.display="none");var Re=Ao("ul");Re.setAttribute("role","tablist");var Ue=function(){Rt.goToStep(this.getAttribute("data-stepnumber"))};return m(this._introItems,function(ci,Ze){var ai=ci.step,ki=Ao("li"),Ai=Ao("a");ki.setAttribute("role","presentation"),Ai.setAttribute("role","tab"),Ai.onclick=Ue,Ze===mt.step-1&&(Ai.className="active"),ot(Ai),Ai.innerHTML="&nbsp;",Ai.setAttribute("data-stepnumber",ai),ki.appendChild(Ai),Re.appendChild(ki)}),te.appendChild(Re),te}function Dl(mt,Rt){if(this._options.showBullets){var te=document.querySelector(".introjs-bullets");te.parentNode.replaceChild(Vc.call(this,Rt),te)}}function Gc(mt,Rt){this._options.showBullets&&(mt.querySelector(".introjs-bullets li > a.active").className="",mt.querySelector('.introjs-bullets li > a[data-stepnumber="'.concat(Rt.step,'"]')).className="active")}function Mr(){var mt=Ao("div");mt.className="introjs-progress",!1===this._options.showProgress&&(mt.style.display="none");var Rt=Ao("div",{className:"introjs-progressbar"});return this._options.progressBarAdditionalClass&&(Rt.className+=" "+this._options.progressBarAdditionalClass),Rt.setAttribute("role","progress"),Rt.setAttribute("aria-valuemin",0),Rt.setAttribute("aria-valuemax",100),Rt.setAttribute("aria-valuenow",la.call(this)),Rt.style.cssText="width:".concat(la.call(this),"%;"),mt.appendChild(Rt),mt}function Iu(mt){mt.querySelector(".introjs-progress .introjs-progressbar").style.cssText="width:".concat(la.call(this),"%;"),mt.querySelector(".introjs-progress .introjs-progressbar").setAttribute("aria-valuenow",la.call(this))}function cc(mt){var Rt=this;void 0!==this._introChangeCallback&&this._introChangeCallback.call(this,mt.element);var Ze,ai,ki,te=this,Re=document.querySelector(".introjs-helperLayer"),Ue=document.querySelector(".introjs-tooltipReferenceLayer"),ci="introjs-helperLayer";if("string"==typeof mt.highlightClass&&(ci+=" ".concat(mt.highlightClass)),"string"==typeof this._options.highlightClass&&(ci+=" ".concat(this._options.highlightClass)),null!==Re&&null!==Ue){var Ai=Ue.querySelector(".introjs-helperNumberLayer"),Vi=Ue.querySelector(".introjs-tooltiptext"),to=Ue.querySelector(".introjs-tooltip-title"),zn=Ue.querySelector(".introjs-arrow"),ho=Ue.querySelector(".introjs-tooltip");ki=Ue.querySelector(".introjs-skipbutton"),ai=Ue.querySelector(".introjs-prevbutton"),Ze=Ue.querySelector(".introjs-nextbutton"),Re.className=ci,ho.style.opacity=0,ho.style.display="none",sc.call(te,mt),nr.call(te,Re),nr.call(te,Ue),ml(),te._lastShowElementTimer&&window.clearTimeout(te._lastShowElementTimer),te._lastShowElementTimer=window.setTimeout(function(){null!==Ai&&(Ai.innerHTML="".concat(mt.step," of ").concat(Rt._introItems.length)),Vi.innerHTML=mt.intro,to.innerHTML=mt.title,ho.style.display="block",_s.call(te,mt.element,ho,zn),Gc.call(te,Ue,mt),Iu.call(te,Ue),ho.style.opacity=1,(null!=Ze&&/introjs-donebutton/gi.test(Ze.className)||null!=Ze)&&Ze.focus(),dt.call(te,mt.scrollTo,mt,Vi)},350)}else{var Ur=Ao("div",{className:ci}),br=Ao("div",{className:"introjs-tooltipReferenceLayer"}),$o=Ao("div",{className:"introjs-arrow"}),fr=Ao("div",{className:"introjs-tooltip"}),Xr=Ao("div",{className:"introjs-tooltiptext"}),mr=Ao("div",{className:"introjs-tooltip-header"}),ua=Ao("h1",{className:"introjs-tooltip-title"}),rs=Ao("div");Dr(Ur,{"box-shadow":"0 0 1px 2px rgba(33, 33, 33, 0.8), rgba(33, 33, 33, ".concat(te._options.overlayOpacity.toString(),") 0 0 0 5000px")}),sc.call(te,mt),nr.call(te,Ur),nr.call(te,br),Uc(this._targetElement,Ur,!0),Uc(this._targetElement,br),Xr.innerHTML=mt.intro,ua.innerHTML=mt.title,rs.className="introjs-tooltipbuttons",!1===this._options.showButtons&&(rs.style.display="none"),mr.appendChild(ua),fr.appendChild(mr),fr.appendChild(Xr),fr.appendChild(Vc.call(this,mt)),fr.appendChild(Mr.call(this));var ws=Ao("div");!0===this._options.showStepNumbers&&(ws.className="introjs-helperNumberLayer",ws.innerHTML="".concat(mt.step," of ").concat(this._introItems.length),fr.appendChild(ws)),fr.appendChild($o),br.appendChild(fr),(Ze=Ao("a")).onclick=function(){te._introItems.length-1!==te._currentStep?qa.call(te):/introjs-donebutton/gi.test(Ze.className)&&("function"==typeof te._introCompleteCallback&&te._introCompleteCallback.call(te,te._currentStep,"done"),va.call(te,te._targetElement))},ot(Ze),Ze.innerHTML=this._options.nextLabel,(ai=Ao("a")).onclick=function(){0!==te._currentStep&&ta.call(te)},ot(ai),ai.innerHTML=this._options.prevLabel,ot(ki=Ao("a",{className:"introjs-skipbutton"})),ki.innerHTML=this._options.skipLabel,ki.onclick=function(){te._introItems.length-1===te._currentStep&&"function"==typeof te._introCompleteCallback&&te._introCompleteCallback.call(te,te._currentStep,"skip"),"function"==typeof te._introSkipCallback&&te._introSkipCallback.call(te),va.call(te,te._targetElement)},mr.appendChild(ki),this._introItems.length>1&&rs.appendChild(ai),rs.appendChild(Ze),fr.appendChild(rs),_s.call(te,mt.element,fr,$o),dt.call(this,mt.scrollTo,mt,fr)}var bl=te._targetElement.querySelector(".introjs-disableInteraction");bl&&bl.parentNode.removeChild(bl),mt.disableInteraction&&lc.call(te),0===this._currentStep&&this._introItems.length>1?(null!=Ze&&(Ze.className="".concat(this._options.buttonClass," introjs-nextbutton"),Ze.innerHTML=this._options.nextLabel),!0===this._options.hidePrev?(null!=ai&&(ai.className="".concat(this._options.buttonClass," introjs-prevbutton introjs-hidden")),null!=Ze&&Hs(Ze,"introjs-fullbutton")):null!=ai&&(ai.className="".concat(this._options.buttonClass," introjs-prevbutton introjs-disabled"))):this._introItems.length-1===this._currentStep||1===this._introItems.length?(null!=ai&&(ai.className="".concat(this._options.buttonClass," introjs-prevbutton")),!0===this._options.hideNext?(null!=Ze&&(Ze.className="".concat(this._options.buttonClass," introjs-nextbutton introjs-hidden")),null!=ai&&Hs(ai,"introjs-fullbutton")):null!=Ze&&(!0===this._options.nextToDone?(Ze.innerHTML=this._options.doneLabel,Hs(Ze,"".concat(this._options.buttonClass," introjs-nextbutton introjs-donebutton"))):Ze.className="".concat(this._options.buttonClass," introjs-nextbutton introjs-disabled"))):(null!=ai&&(ai.className="".concat(this._options.buttonClass," introjs-prevbutton")),null!=Ze&&(Ze.className="".concat(this._options.buttonClass," introjs-nextbutton"),Ze.innerHTML=this._options.nextLabel)),null!=ai&&ai.setAttribute("role","button"),null!=Ze&&Ze.setAttribute("role","button"),null!=ki&&ki.setAttribute("role","button"),null!=Ze&&Ze.focus(),function Cl(mt){var Rt=mt.element;Hs(Rt,"introjs-showElement");var te=Ea(Rt,"position");"absolute"!==te&&"relative"!==te&&"sticky"!==te&&"fixed"!==te&&Hs(Rt,"introjs-relativePosition")}(mt),void 0!==this._introAfterChangeCallback&&this._introAfterChangeCallback.call(this,mt.element)}function ru(mt){this._currentStep=mt-2,void 0!==this._introItems&&qa.call(this)}function Ml(mt){this._currentStepNumber=mt,void 0!==this._introItems&&qa.call(this)}function qa(){var mt=this;this._direction="forward",void 0!==this._currentStepNumber&&m(this._introItems,function(Re,Ue){Re.step===mt._currentStepNumber&&(mt._currentStep=Ue-1,mt._currentStepNumber=void 0)}),void 0===this._currentStep?this._currentStep=0:++this._currentStep;var Rt=this._introItems[this._currentStep],te=!0;return void 0!==this._introBeforeChangeCallback&&(te=this._introBeforeChangeCallback.call(this,Rt&&Rt.element)),!1===te?(--this._currentStep,!1):this._introItems.length<=this._currentStep?("function"==typeof this._introCompleteCallback&&this._introCompleteCallback.call(this,this._currentStep,"end"),void va.call(this,this._targetElement)):void cc.call(this,Rt)}function ta(){if(this._direction="backward",0===this._currentStep)return!1;--this._currentStep;var mt=this._introItems[this._currentStep],Rt=!0;if(void 0!==this._introBeforeChangeCallback&&(Rt=this._introBeforeChangeCallback.call(this,mt&&mt.element)),!1===Rt)return++this._currentStep,!1;cc.call(this,mt)}function Wc(){return this._currentStep}function ul(mt){var Rt=void 0===mt.code?mt.which:mt.code;if(null===Rt&&(Rt=null===mt.charCode?mt.keyCode:mt.charCode),"Escape"!==Rt&&27!==Rt||!0!==this._options.exitOnEsc){if("ArrowLeft"===Rt||37===Rt)ta.call(this);else if("ArrowRight"===Rt||39===Rt)qa.call(this);else if("Enter"===Rt||"NumpadEnter"===Rt||13===Rt){var te=mt.target||mt.srcElement;te&&te.className.match("introjs-prevbutton")?ta.call(this):te&&te.className.match("introjs-skipbutton")?(this._introItems.length-1===this._currentStep&&"function"==typeof this._introCompleteCallback&&this._introCompleteCallback.call(this,this._currentStep,"skip"),va.call(this,this._targetElement)):te&&te.getAttribute("data-stepnumber")?te.click():qa.call(this),mt.preventDefault?mt.preventDefault():mt.returnValue=!1}}else va.call(this,this._targetElement)}function Yr(mt){if(null===mt||"object"!==X(mt)||void 0!==mt.nodeType)return mt;var Rt={};for(var te in mt)Rt[te]=void 0!==window.jQuery&&mt[te]instanceof window.jQuery?mt[te]:Yr(mt[te]);return Rt}function Sa(mt){var Rt=document.querySelector(".introjs-hints");return Rt?Rt.querySelectorAll(mt):[]}function oc(mt){var Rt=Sa('.introjs-hint[data-step="'.concat(mt,'"]'))[0];zl.call(this),Rt&&Hs(Rt,"introjs-hidehint"),void 0!==this._hintCloseCallback&&this._hintCloseCallback.call(this,mt)}function Sc(){var mt=this;m(Sa(".introjs-hint"),function(te){oc.call(mt,te.getAttribute("data-step"))})}function nh(){var mt=this,Rt=Sa(".introjs-hint");Rt&&Rt.length?m(Rt,function(te){wu.call(mt,te.getAttribute("data-step"))}):zc.call(this,this._targetElement)}function wu(mt){var Rt=Sa('.introjs-hint[data-step="'.concat(mt,'"]'))[0];Rt&&Rr(Rt,/introjs-hidehint/g)}function ca(){var mt=this;m(Sa(".introjs-hint"),function(te){Ra.call(mt,te.getAttribute("data-step"))}),e.off(document,"click",zl,this,!1),e.off(window,"resize",Ia,this,!0),this._hintsAutoRefreshFunction&&e.off(window,"scroll",this._hintsAutoRefreshFunction,this,!0)}function Ra(mt){var Rt=Sa('.introjs-hint[data-step="'.concat(mt,'"]'))[0];Rt&&Rt.parentNode.removeChild(Rt)}function vl(){var mt=this,Rt=this,te=document.querySelector(".introjs-hints");null===te&&(te=Ao("div",{className:"introjs-hints"}));m(this._introItems,function(Ue,ci){if(!document.querySelector('.introjs-hint[data-step="'.concat(ci,'"]'))){var Ze=Ao("a",{className:"introjs-hint"});ot(Ze),Ze.onclick=function(ci){return function(Ze){var ai=Ze||window.event;ai.stopPropagation&&ai.stopPropagation(),null!==ai.cancelBubble&&(ai.cancelBubble=!0),Al.call(Rt,ci)}}(ci),Ue.hintAnimation||Hs(Ze,"introjs-hint-no-anim"),Ve(Ue.element)&&Hs(Ze,"introjs-fixedhint");var ai=Ao("div",{className:"introjs-hint-dot"}),ki=Ao("div",{className:"introjs-hint-pulse"});Ze.appendChild(ai),Ze.appendChild(ki),Ze.setAttribute("data-step",ci),Ue.targetElement=Ue.element,Ue.element=Ze,Rc.call(mt,Ue.hintPosition,Ze,Ue.targetElement),te.appendChild(Ze)}}),document.body.appendChild(te),void 0!==this._hintsAddedCallback&&this._hintsAddedCallback.call(this),this._options.hintAutoRefreshInterval>=0&&(this._hintsAutoRefreshFunction=function Ol(mt,Rt){var Re,te=this;return function(){for(var Ue=arguments.length,ci=new Array(Ue),Ze=0;Ze<Ue;Ze++)ci[Ze]=arguments[Ze];clearTimeout(Re),Re=setTimeout(function(){mt.apply(te,ci)},Rt)}}(function(){return Ia.call(mt)},this._options.hintAutoRefreshInterval),e.on(window,"scroll",this._hintsAutoRefreshFunction,this,!0))}function Rc(mt,Rt,te){var Re=Rt.style,Ue=ti.call(this,te);switch(mt){default:case"top-left":Re.left="".concat(Ue.left,"px"),Re.top="".concat(Ue.top,"px");break;case"top-right":Re.left="".concat(Ue.left+Ue.width-20,"px"),Re.top="".concat(Ue.top,"px");break;case"bottom-left":Re.left="".concat(Ue.left,"px"),Re.top="".concat(Ue.top+Ue.height-20,"px");break;case"bottom-right":Re.left="".concat(Ue.left+Ue.width-20,"px"),Re.top="".concat(Ue.top+Ue.height-20,"px");break;case"middle-left":Re.left="".concat(Ue.left,"px"),Re.top="".concat(Ue.top+(Ue.height-20)/2,"px");break;case"middle-right":Re.left="".concat(Ue.left+Ue.width-20,"px"),Re.top="".concat(Ue.top+(Ue.height-20)/2,"px");break;case"middle-middle":Re.left="".concat(Ue.left+(Ue.width-20)/2,"px"),Re.top="".concat(Ue.top+(Ue.height-20)/2,"px");break;case"bottom-middle":Re.left="".concat(Ue.left+(Ue.width-20)/2,"px"),Re.top="".concat(Ue.top+Ue.height-20,"px");break;case"top-middle":Re.left="".concat(Ue.left+(Ue.width-20)/2,"px"),Re.top="".concat(Ue.top,"px")}}function Al(mt){var Rt=document.querySelector('.introjs-hint[data-step="'.concat(mt,'"]')),te=this._introItems[mt];void 0!==this._hintClickCallback&&this._hintClickCallback.call(this,Rt,te,mt);var Re=zl.call(this);if(parseInt(Re,10)!==mt){var Ue=Ao("div",{className:"introjs-tooltip"}),ci=Ao("div"),Ze=Ao("div"),ai=Ao("div");Ue.onclick=function(Vi){Vi.stopPropagation?Vi.stopPropagation():Vi.cancelBubble=!0},ci.className="introjs-tooltiptext";var ki=Ao("p");if(ki.innerHTML=te.hint,ci.appendChild(ki),this._options.hintShowButton){var Ai=Ao("a");Ai.className=this._options.buttonClass,Ai.setAttribute("role","button"),Ai.innerHTML=this._options.hintButtonLabel,Ai.onclick=oc.bind(this,mt),ci.appendChild(Ai)}Ze.className="introjs-arrow",Ue.appendChild(Ze),Ue.appendChild(ci),this._currentStep=Rt.getAttribute("data-step"),ai.className="introjs-tooltipReferenceLayer introjs-hintReference",ai.setAttribute("data-step",Rt.getAttribute("data-step")),nr.call(this,ai),ai.appendChild(Ue),document.body.appendChild(ai),_s.call(this,Rt,Ue,Ze,!0)}}function zl(){var mt=document.querySelector(".introjs-hintReference");if(mt){var Rt=mt.getAttribute("data-step");return mt.parentNode.removeChild(mt),Rt}}function zc(mt){var Rt=this;if(this._introItems=[],this._options.hints)m(this._options.hints,function(Re){var Ue=Yr(Re);"string"==typeof Ue.element&&(Ue.element=document.querySelector(Ue.element)),Ue.hintPosition=Ue.hintPosition||Rt._options.hintPosition,Ue.hintAnimation=Ue.hintAnimation||Rt._options.hintAnimation,null!==Ue.element&&Rt._introItems.push(Ue)});else{var te=mt.querySelectorAll("*[data-hint]");if(!te||!te.length)return!1;m(te,function(Re){var Ue=Re.getAttribute("data-hintanimation");Ue=Ue?"true"===Ue:Rt._options.hintAnimation,Rt._introItems.push({element:Re,hint:Re.getAttribute("data-hint"),hintPosition:Re.getAttribute("data-hintposition")||Rt._options.hintPosition,hintAnimation:Ue,tooltipClass:Re.getAttribute("data-tooltipclass"),position:Re.getAttribute("data-position")||Rt._options.tooltipPosition})})}vl.call(this),e.on(document,"click",zl,this,!1),e.on(window,"resize",Ia,this,!0)}function Ia(){var mt=this;m(this._introItems,function(Rt){var te=Rt.targetElement;void 0!==te&&Rc.call(mt,Rt.hintPosition,Rt.element,te)})}Ar({target:"Array",proto:!0,forced:!Il},{splice:function(Rt,te){var ai,ki,Ai,Vi,to,zn,Re=Ti(this),Ue=sr(Re),ci=uo(Rt,Ue),Ze=arguments.length;if(0===Ze?ai=ki=0:1===Ze?(ai=0,ki=Ue-ci):(ai=Ze-2,ki=Qa(Is(_r(te),0),Ue-ci)),Ue+ai-ki>ic)throw Wl(ih);for(Ai=Aa(Re,ki),Vi=0;Vi<ki;Vi++)(to=ci+Vi)in Re&&Un(Ai,Vi,Re[to]);if(Ai.length=ki,ai<ki){for(Vi=ci;Vi<Ue-ki;Vi++)zn=Vi+ai,(to=Vi+ki)in Re?Re[zn]=Re[to]:delete Re[zn];for(Vi=Ue;Vi>Ue-ki+ai;Vi--)delete Re[Vi-1]}else if(ai>ki)for(Vi=Ue-ki;Vi>ci;Vi--)zn=Vi+ai-1,(to=Vi+ki-1)in Re?Re[zn]=Re[to]:delete Re[zn];for(Vi=0;Vi<ai;Vi++)Re[Vi+ci]=arguments[Vi+2];return Re.length=Ue-ki+ai,Ai}});var jc=Math.floor,Ic=function(mt,Rt){var te=mt.length,Re=jc(te/2);return te<8?uc(mt,Rt):cr(mt,Ic(cl(mt,0,Re),Rt),Ic(cl(mt,Re),Rt),Rt)},uc=function(mt,Rt){for(var Ue,ci,te=mt.length,Re=1;Re<te;){for(ci=Re,Ue=mt[Re];ci&&Rt(mt[ci-1],Ue)>0;)mt[ci]=mt[--ci];ci!==Re++&&(mt[ci]=Ue)}return mt},cr=function(mt,Rt,te,Re){for(var Ue=Rt.length,ci=te.length,Ze=0,ai=0;Ze<Ue||ai<ci;)mt[Ze+ai]=Ze<Ue&&ai<ci?Re(Rt[Ze],te[ai])<=0?Rt[Ze++]:te[ai++]:Ze<Ue?Rt[Ze++]:te[ai++];return mt},jl=Ic,kl=Ae.match(/firefox\/(\d+)/i),wc=!!kl&&+kl[1],Du=/MSIE|Trident/.test(Ae),Yl=Ae.match(/AppleWebKit\/(\d+)\./),Yc=!!Yl&&+Yl[1],rc=[],su=bt(rc.sort),Dc=bt(rc.push),Xc=a(function(){rc.sort(void 0)}),xl=a(function(){rc.sort(null)}),Ll=Gl("sort"),tl=!a(function(){if(Bt)return Bt<70;if(!(wc&&wc>3)){if(Du)return!0;if(Yc)return Yc<603;var Rt,te,Re,Ue,mt="";for(Rt=65;Rt<76;Rt++){switch(te=String.fromCharCode(Rt),Rt){case 66:case 69:case 70:case 72:Re=3;break;case 68:case 71:Re=4;break;default:Re=2}for(Ue=0;Ue<47;Ue++)rc.push({k:te+Ue,v:Re})}for(rc.sort(function(ci,Ze){return Ze.v-ci.v}),Ue=0;Ue<rc.length;Ue++)te=rc[Ue].k.charAt(0),mt.charAt(mt.length-1)!==te&&(mt+=te);return"DGBEFHACIJK"!==mt}});function yl(mt){var Rt=this,te=mt.querySelectorAll("*[data-intro]"),Re=[];if(this._options.steps)m(this._options.steps,function(Ai){var Vi=Yr(Ai);if(Vi.step=Re.length+1,Vi.title=Vi.title||"","string"==typeof Vi.element&&(Vi.element=document.querySelector(Vi.element)),null==Vi.element){var to=document.querySelector(".introjsFloatingElement");null===to&&(to=Ao("div",{className:"introjsFloatingElement"}),document.body.appendChild(to)),Vi.element=to,Vi.position="floating"}Vi.position=Vi.position||Rt._options.tooltipPosition,Vi.scrollTo=Vi.scrollTo||Rt._options.scrollTo,void 0===Vi.disableInteraction&&(Vi.disableInteraction=Rt._options.disableInteraction),null!==Vi.element&&Re.push(Vi)});else{var ci;if(te.length<1)return[];m(te,function(Ai){if((!Rt._options.group||Ai.getAttribute("data-intro-group")===Rt._options.group)&&"none"!==Ai.style.display){var Vi=parseInt(Ai.getAttribute("data-step"),10);ci=Ai.hasAttribute("data-disable-interaction")?!!Ai.getAttribute("data-disable-interaction"):Rt._options.disableInteraction,Vi>0&&(Re[Vi-1]={element:Ai,title:Ai.getAttribute("data-title")||"",intro:Ai.getAttribute("data-intro"),step:parseInt(Ai.getAttribute("data-step"),10),tooltipClass:Ai.getAttribute("data-tooltipclass"),highlightClass:Ai.getAttribute("data-highlightclass"),position:Ai.getAttribute("data-position")||Rt._options.tooltipPosition,scrollTo:Ai.getAttribute("data-scrollto")||Rt._options.scrollTo,disableInteraction:ci})}});var Ze=0;m(te,function(Ai){if((!Rt._options.group||Ai.getAttribute("data-intro-group")===Rt._options.group)&&null===Ai.getAttribute("data-step")){for(;void 0!==Re[Ze];)Ze++;ci=Ai.hasAttribute("data-disable-interaction")?!!Ai.getAttribute("data-disable-interaction"):Rt._options.disableInteraction,Re[Ze]={element:Ai,title:Ai.getAttribute("data-title")||"",intro:Ai.getAttribute("data-intro"),step:Ze+1,tooltipClass:Ai.getAttribute("data-tooltipclass"),highlightClass:Ai.getAttribute("data-highlightclass"),position:Ai.getAttribute("data-position")||Rt._options.tooltipPosition,scrollTo:Ai.getAttribute("data-scrollto")||Rt._options.scrollTo,disableInteraction:ci}}})}for(var ai=[],ki=0;ki<Re.length;ki++)Re[ki]&&ai.push(Re[ki]);return(Re=ai).sort(function(Ai,Vi){return Ai.step-Vi.step}),Re}function Tl(mt){var Rt=document.querySelector(".introjs-tooltipReferenceLayer"),te=document.querySelector(".introjs-helperLayer"),Re=document.querySelector(".introjs-disableInteraction");if(nr.call(this,te),nr.call(this,Rt),nr.call(this,Re),mt&&(this._introItems=yl.call(this,this._targetElement),Dl.call(this,Rt,this._introItems[this._currentStep]),Iu.call(this,Rt)),null!=this._currentStep){var Ue=document.querySelector(".introjs-arrow"),ci=document.querySelector(".introjs-tooltip");ci&&Ue&&_s.call(this,this._introItems[this._currentStep].element,ci,Ue)}return Ia.call(this),this}function hl(){Tl.call(this)}function hc(mt,Rt){if(mt&&mt.parentElement){var te=mt.parentElement;Rt?(Dr(mt,{opacity:"0"}),window.setTimeout(function(){try{te.removeChild(mt)}catch(Re){}},500)):te.removeChild(mt)}}function va(mt,Rt){var te=!0;if(void 0!==this._introBeforeExitCallback&&(te=this._introBeforeExitCallback.call(this)),Rt||!1!==te){var Re=mt.querySelectorAll(".introjs-overlay");Re&&Re.length&&m(Re,function(ki){return hc(ki)}),hc(mt.querySelector(".introjs-helperLayer"),!0),hc(mt.querySelector(".introjs-tooltipReferenceLayer")),hc(mt.querySelector(".introjs-disableInteraction")),hc(document.querySelector(".introjsFloatingElement")),ml(),e.off(window,"keydown",ul,this,!0),e.off(window,"resize",hl,this,!0),void 0!==this._introExitCallback&&this._introExitCallback.call(this),this._currentStep=void 0}}function au(mt){var Rt=this,te=Ao("div",{className:"introjs-overlay"});return Dr(te,{top:0,bottom:0,left:0,right:0,position:"fixed"}),mt.appendChild(te),!0===this._options.exitOnOverlayClick&&(Dr(te,{cursor:"pointer"}),te.onclick=function(){va.call(Rt,mt)}),!0}function Nl(mt){void 0!==this._introStartCallback&&this._introStartCallback.call(this,mt);var Rt=yl.call(this,mt);return 0===Rt.length||(this._introItems=Rt,au.call(this,mt)&&(qa.call(this),this._options.keyboardNavigation&&e.on(window,"keydown",ul,this,!0),e.on(window,"resize",hl,this,!0))),!1}function ms(mt){this._targetElement=mt,this._introItems=[],this._options={nextLabel:"Next",prevLabel:"Back",skipLabel:"\xd7",doneLabel:"Done",hidePrev:!1,hideNext:!1,nextToDone:!0,tooltipPosition:"bottom",tooltipClass:"",group:"",highlightClass:"",exitOnEsc:!0,exitOnOverlayClick:!0,showStepNumbers:!1,keyboardNavigation:!0,showButtons:!0,showBullets:!0,showProgress:!1,scrollToElement:!0,scrollTo:"element",scrollPadding:30,overlayOpacity:.5,autoPosition:!0,positionPrecedence:["bottom","top","right","left"],disableInteraction:!1,helperElementPadding:10,hintPosition:"top-middle",hintButtonLabel:"Got it",hintShowButton:!0,hintAutoRefreshInterval:10,hintAnimation:!0,buttonClass:"introjs-button",progressBarAdditionalClass:!1}}Ar({target:"Array",proto:!0,forced:Xc||!xl||!Ll||!tl},{sort:function(Rt){void 0!==Rt&&Ee(Rt);var te=Ti(this);if(tl)return void 0===Rt?su(te):su(te,Rt);var ci,Ze,Re=[],Ue=sr(te);for(Ze=0;Ze<Ue;Ze++)Ze in te&&Dc(Re,te[Ze]);for(jl(Re,function(mt){return function(Rt,te){return void 0===te?-1:void 0===Rt?1:void 0!==mt?+mt(Rt,te)||0:Lo(Rt)>Lo(te)?1:-1}}(Rt)),ci=Re.length,Ze=0;Ze<ci;)te[Ze]=Re[Ze++];for(;Ze<Ue;)delete te[Ze++];return te}});var Mc=function mt(Rt){var te;if("object"===X(Rt))te=new ms(Rt);else if("string"==typeof Rt){var Re=document.querySelector(Rt);if(!Re)throw new Error("There is no element with given selector.");te=new ms(Re)}else te=new ms(document.body);return mt.instances[C(te,"introjs-instance")]=te,te};return Mc.version="4.3.0",Mc.instances={},Mc.fn=ms.prototype={clone:function(){return new ms(this)},setOption:function(Rt,te){return this._options[Rt]=te,this},setOptions:function(Rt){return this._options=function _(mt,Rt){var Re,te={};for(Re in mt)te[Re]=mt[Re];for(Re in Rt)te[Re]=Rt[Re];return te}(this._options,Rt),this},start:function(){return Nl.call(this,this._targetElement),this},goToStep:function(Rt){return ru.call(this,Rt),this},addStep:function(Rt){return this._options.steps||(this._options.steps=[]),this._options.steps.push(Rt),this},addSteps:function(Rt){if(Rt.length){for(var te=0;te<Rt.length;te++)this.addStep(Rt[te]);return this}},goToStepNumber:function(Rt){return Ml.call(this,Rt),this},nextStep:function(){return qa.call(this),this},previousStep:function(){return ta.call(this),this},currentStep:function(){return Wc.call(this)},exit:function(Rt){return va.call(this,this._targetElement,Rt),this},refresh:function(Rt){return Tl.call(this,Rt),this},onbeforechange:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for onbeforechange was not a function");return this._introBeforeChangeCallback=Rt,this},onchange:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for onchange was not a function.");return this._introChangeCallback=Rt,this},onafterchange:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for onafterchange was not a function");return this._introAfterChangeCallback=Rt,this},oncomplete:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for oncomplete was not a function.");return this._introCompleteCallback=Rt,this},onhintsadded:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for onhintsadded was not a function.");return this._hintsAddedCallback=Rt,this},onhintclick:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for onhintclick was not a function.");return this._hintClickCallback=Rt,this},onhintclose:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for onhintclose was not a function.");return this._hintCloseCallback=Rt,this},onstart:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for onstart was not a function.");return this._introStartCallback=Rt,this},onexit:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for onexit was not a function.");return this._introExitCallback=Rt,this},onskip:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for onskip was not a function.");return this._introSkipCallback=Rt,this},onbeforeexit:function(Rt){if("function"!=typeof Rt)throw new Error("Provided callback for onbeforeexit was not a function.");return this._introBeforeExitCallback=Rt,this},addHints:function(){return zc.call(this,this._targetElement),this},hideHint:function(Rt){return oc.call(this,Rt),this},hideHints:function(){return Sc.call(this),this},showHint:function(Rt){return wu.call(this,Rt),this},showHints:function(){return nh.call(this),this},removeHints:function(){return ca.call(this),this},removeHint:function(Rt){return Ra().call(this,Rt),this},showHintDialog:function(Rt){return Al.call(this,Rt),this}},Mc}()},61135:(B,X,_)=>{"use strict";_.d(X,{X:()=>m});var C=_(77579);class m extends C.x{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){const{hasError:t,thrownError:n,_value:o}=this;if(t)throw n;return this._throwIfClosed(),o}next(t){super.next(this._value=t)}}},68306:(B,X,_)=>{"use strict";_.d(X,{y:()=>R});var C=_(70930),m=_(50727),e=_(48822),t=_(44671);var r=_(42416),a=_(30576),h=_(72806);let R=(()=>{class et{constructor(It){It&&(this._subscribe=It)}lift(It){const gt=new et;return gt.source=this,gt.operator=It,gt}subscribe(It,gt,wt){const Ut=function nt(et){return et&&et instanceof C.Lv||function W(et){return et&&(0,a.m)(et.next)&&(0,a.m)(et.error)&&(0,a.m)(et.complete)}(et)&&(0,m.Nn)(et)}(It)?It:new C.Hp(It,gt,wt);return(0,h.x)(()=>{const{operator:Jt,source:Ct}=this;Ut.add(Jt?Jt.call(Ut,Ct):Ct?this._subscribe(Ut):this._trySubscribe(Ut))}),Ut}_trySubscribe(It){try{return this._subscribe(It)}catch(gt){It.error(gt)}}forEach(It,gt){return new(gt=L(gt))((wt,Ut)=>{let Jt;Jt=this.subscribe(Ct=>{try{It(Ct)}catch(bt){Ut(bt),null==Jt||Jt.unsubscribe()}},Ut,wt)})}_subscribe(It){var gt;return null===(gt=this.source)||void 0===gt?void 0:gt.subscribe(It)}[e.L](){return this}pipe(...It){return function o(et){return 0===et.length?t.y:1===et.length?et[0]:function(It){return et.reduce((gt,wt)=>wt(gt),It)}}(It)(this)}toPromise(It){return new(It=L(It))((gt,wt)=>{let Ut;this.subscribe(Jt=>Ut=Jt,Jt=>wt(Jt),()=>gt(Ut))})}}return et.create=Et=>new et(Et),et})();function L(et){var Et;return null!==(Et=null!=et?et:r.v.Promise)&&void 0!==Et?Et:Promise}},77579:(B,X,_)=>{"use strict";_.d(X,{x:()=>r});var C=_(68306),m=_(50727);const t=(0,_(83888).d)(h=>function(){h(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var n=_(38737),o=_(72806);let r=(()=>{class h extends C.y{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(L){const W=new a(this,this);return W.operator=L,W}_throwIfClosed(){if(this.closed)throw new t}next(L){(0,o.x)(()=>{if(this._throwIfClosed(),!this.isStopped){const W=this.observers.slice();for(const nt of W)nt.next(L)}})}error(L){(0,o.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=L;const{observers:W}=this;for(;W.length;)W.shift().error(L)}})}complete(){(0,o.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:L}=this;for(;L.length;)L.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var L;return(null===(L=this.observers)||void 0===L?void 0:L.length)>0}_trySubscribe(L){return this._throwIfClosed(),super._trySubscribe(L)}_subscribe(L){return this._throwIfClosed(),this._checkFinalizedStatuses(L),this._innerSubscribe(L)}_innerSubscribe(L){const{hasError:W,isStopped:nt,observers:et}=this;return W||nt?m.Lc:(et.push(L),new m.w0(()=>(0,n.P)(et,L)))}_checkFinalizedStatuses(L){const{hasError:W,thrownError:nt,isStopped:et}=this;W?L.error(nt):et&&L.complete()}asObservable(){const L=new C.y;return L.source=this,L}}return h.create=(R,L)=>new a(R,L),h})();class a extends r{constructor(R,L){super(),this.destination=R,this.source=L}next(R){var L,W;null===(W=null===(L=this.destination)||void 0===L?void 0:L.next)||void 0===W||W.call(L,R)}error(R){var L,W;null===(W=null===(L=this.destination)||void 0===L?void 0:L.error)||void 0===W||W.call(L,R)}complete(){var R,L;null===(L=null===(R=this.destination)||void 0===R?void 0:R.complete)||void 0===L||L.call(R)}_subscribe(R){var L,W;return null!==(W=null===(L=this.source)||void 0===L?void 0:L.subscribe(R))&&void 0!==W?W:m.Lc}}},70930:(B,X,_)=>{"use strict";_.d(X,{Hp:()=>nt,Lv:()=>W});var C=_(30576),m=_(50727),e=_(42416),t=_(87849),n=_(25032);const o=h("C",void 0,void 0);function h(wt,Ut,Jt){return{kind:wt,value:Ut,error:Jt}}var R=_(43410),L=_(72806);class W extends m.w0{constructor(Ut){super(),this.isStopped=!1,Ut?(this.destination=Ut,(0,m.Nn)(Ut)&&Ut.add(this)):this.destination=gt}static create(Ut,Jt,Ct){return new nt(Ut,Jt,Ct)}next(Ut){this.isStopped?It(function a(wt){return h("N",wt,void 0)}(Ut),this):this._next(Ut)}error(Ut){this.isStopped?It(function r(wt){return h("E",void 0,wt)}(Ut),this):(this.isStopped=!0,this._error(Ut))}complete(){this.isStopped?It(o,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ut){this.destination.next(Ut)}_error(Ut){try{this.destination.error(Ut)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class nt extends W{constructor(Ut,Jt,Ct){let bt;if(super(),(0,C.m)(Ut))bt=Ut;else if(Ut){let at;({next:bt,error:Jt,complete:Ct}=Ut),this&&e.v.useDeprecatedNextContext?(at=Object.create(Ut),at.unsubscribe=()=>this.unsubscribe()):at=Ut,bt=null==bt?void 0:bt.bind(at),Jt=null==Jt?void 0:Jt.bind(at),Ct=null==Ct?void 0:Ct.bind(at)}this.destination={next:bt?et(bt):n.Z,error:et(null!=Jt?Jt:Et),complete:Ct?et(Ct):n.Z}}}function et(wt,Ut){return(...Jt)=>{try{wt(...Jt)}catch(Ct){e.v.useDeprecatedSynchronousErrorHandling?(0,L.O)(Ct):(0,t.h)(Ct)}}}function Et(wt){throw wt}function It(wt,Ut){const{onStoppedNotification:Jt}=e.v;Jt&&R.z.setTimeout(()=>Jt(wt,Ut))}const gt={closed:!0,next:n.Z,error:Et,complete:n.Z}},50727:(B,X,_)=>{"use strict";_.d(X,{Lc:()=>o,w0:()=>n,Nn:()=>r});var C=_(30576);const e=(0,_(83888).d)(h=>function(L){h(this),this.message=L?`${L.length} errors occurred during unsubscription:\n${L.map((W,nt)=>`${nt+1}) ${W.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=L});var t=_(38737);class n{constructor(R){this.initialTeardown=R,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let R;if(!this.closed){this.closed=!0;const{_parentage:L}=this;if(L)if(this._parentage=null,Array.isArray(L))for(const et of L)et.remove(this);else L.remove(this);const{initialTeardown:W}=this;if((0,C.m)(W))try{W()}catch(et){R=et instanceof e?et.errors:[et]}const{_teardowns:nt}=this;if(nt){this._teardowns=null;for(const et of nt)try{a(et)}catch(Et){R=null!=R?R:[],Et instanceof e?R=[...R,...Et.errors]:R.push(Et)}}if(R)throw new e(R)}}add(R){var L;if(R&&R!==this)if(this.closed)a(R);else{if(R instanceof n){if(R.closed||R._hasParent(this))return;R._addParent(this)}(this._teardowns=null!==(L=this._teardowns)&&void 0!==L?L:[]).push(R)}}_hasParent(R){const{_parentage:L}=this;return L===R||Array.isArray(L)&&L.includes(R)}_addParent(R){const{_parentage:L}=this;this._parentage=Array.isArray(L)?(L.push(R),L):L?[L,R]:R}_removeParent(R){const{_parentage:L}=this;L===R?this._parentage=null:Array.isArray(L)&&(0,t.P)(L,R)}remove(R){const{_teardowns:L}=this;L&&(0,t.P)(L,R),R instanceof n&&R._removeParent(this)}}n.EMPTY=(()=>{const h=new n;return h.closed=!0,h})();const o=n.EMPTY;function r(h){return h instanceof n||h&&"closed"in h&&(0,C.m)(h.remove)&&(0,C.m)(h.add)&&(0,C.m)(h.unsubscribe)}function a(h){(0,C.m)(h)?h():h.unsubscribe()}},42416:(B,X,_)=>{"use strict";_.d(X,{v:()=>C});const C={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},39841:(B,X,_)=>{"use strict";_.d(X,{a:()=>R});var C=_(68306),m=_(54742),e=_(32076),t=_(44671),n=_(83268),o=_(63269),r=_(31810),a=_(25403),h=_(39672);function R(...nt){const et=(0,o.yG)(nt),Et=(0,o.jO)(nt),{args:It,keys:gt}=(0,m.D)(nt);if(0===It.length)return(0,e.D)([],et);const wt=new C.y(function L(nt,et,Et=t.y){return It=>{W(et,()=>{const{length:gt}=nt,wt=new Array(gt);let Ut=gt,Jt=gt;for(let Ct=0;Ct<gt;Ct++)W(et,()=>{const bt=(0,e.D)(nt[Ct],et);let at=!1;bt.subscribe(new a.Q(It,ft=>{wt[Ct]=ft,at||(at=!0,Jt--),Jt||It.next(Et(wt.slice()))},()=>{--Ut||It.complete()}))},It)},It)}}(It,et,gt?Ut=>(0,r.n)(gt,Ut):t.y));return Et?wt.pipe((0,n.Z)(Et)):wt}function W(nt,et,Et){nt?(0,h.f)(Et,nt,et):et()}},97272:(B,X,_)=>{"use strict";_.d(X,{z:()=>n});var C=_(8189),e=_(63269),t=_(32076);function n(...o){return function m(){return(0,C.J)(1)}()((0,t.D)(o,(0,e.yG)(o)))}},49770:(B,X,_)=>{"use strict";_.d(X,{P:()=>e});var C=_(68306),m=_(38421);function e(t){return new C.y(n=>{(0,m.Xf)(t()).subscribe(n)})}},60515:(B,X,_)=>{"use strict";_.d(X,{E:()=>m});const m=new(_(68306).y)(n=>n.complete())},4128:(B,X,_)=>{"use strict";_.d(X,{D:()=>a});var C=_(68306),m=_(54742),e=_(38421),t=_(63269),n=_(25403),o=_(83268),r=_(31810);function a(...h){const R=(0,t.jO)(h),{args:L,keys:W}=(0,m.D)(h),nt=new C.y(et=>{const{length:Et}=L;if(!Et)return void et.complete();const It=new Array(Et);let gt=Et,wt=Et;for(let Ut=0;Ut<Et;Ut++){let Jt=!1;(0,e.Xf)(L[Ut]).subscribe(new n.Q(et,Ct=>{Jt||(Jt=!0,wt--),It[Ut]=Ct},()=>gt--,void 0,()=>{(!gt||!Jt)&&(wt||et.next(W?(0,r.n)(W,It):It),et.complete())}))}});return R?nt.pipe((0,o.Z)(R)):nt}},32076:(B,X,_)=>{"use strict";_.d(X,{D:()=>ft});var C=_(38421),m=_(39672),e=_(54482),t=_(25403);function n(lt,Ft=0){return(0,e.e)((Mt,yt)=>{Mt.subscribe(new t.Q(yt,ct=>(0,m.f)(yt,lt,()=>yt.next(ct),Ft),()=>(0,m.f)(yt,lt,()=>yt.complete(),Ft),ct=>(0,m.f)(yt,lt,()=>yt.error(ct),Ft)))})}function o(lt,Ft=0){return(0,e.e)((Mt,yt)=>{yt.add(lt.schedule(()=>Mt.subscribe(yt),Ft))})}var h=_(68306),L=_(2202),W=_(30576);function et(lt,Ft){if(!lt)throw new Error("Iterable cannot be null");return new h.y(Mt=>{(0,m.f)(Mt,Ft,()=>{const yt=lt[Symbol.asyncIterator]();(0,m.f)(Mt,Ft,()=>{yt.next().then(ct=>{ct.done?Mt.complete():Mt.next(ct.value)})},0,!0)})})}var Et=_(93670),It=_(28239),gt=_(81144),wt=_(26495),Ut=_(12206),Jt=_(44532),Ct=_(53260);function ft(lt,Ft){return Ft?function at(lt,Ft){if(null!=lt){if((0,Et.c)(lt))return function r(lt,Ft){return(0,C.Xf)(lt).pipe(o(Ft),n(Ft))}(lt,Ft);if((0,gt.z)(lt))return function R(lt,Ft){return new h.y(Mt=>{let yt=0;return Ft.schedule(function(){yt===lt.length?Mt.complete():(Mt.next(lt[yt++]),Mt.closed||this.schedule())})})}(lt,Ft);if((0,It.t)(lt))return function a(lt,Ft){return(0,C.Xf)(lt).pipe(o(Ft),n(Ft))}(lt,Ft);if((0,Ut.D)(lt))return et(lt,Ft);if((0,wt.T)(lt))return function nt(lt,Ft){return new h.y(Mt=>{let yt;return(0,m.f)(Mt,Ft,()=>{yt=lt[L.h](),(0,m.f)(Mt,Ft,()=>{let ct,rt;try{({value:ct,done:rt}=yt.next())}catch(se){return void Mt.error(se)}rt?Mt.complete():Mt.next(ct)},0,!0)}),()=>(0,W.m)(null==yt?void 0:yt.return)&&yt.return()})}(lt,Ft);if((0,Ct.L)(lt))return function bt(lt,Ft){return et((0,Ct.Q)(lt),Ft)}(lt,Ft)}throw(0,Jt.z)(lt)}(lt,Ft):(0,C.Xf)(lt)}},54968:(B,X,_)=>{"use strict";_.d(X,{R:()=>R});var C=_(38421),m=_(68306),e=_(95577),t=_(81144),n=_(30576),o=_(83268);const r=["addListener","removeListener"],a=["addEventListener","removeEventListener"],h=["on","off"];function R(Et,It,gt,wt){if((0,n.m)(gt)&&(wt=gt,gt=void 0),wt)return R(Et,It,gt).pipe((0,o.Z)(wt));const[Ut,Jt]=function et(Et){return(0,n.m)(Et.addEventListener)&&(0,n.m)(Et.removeEventListener)}(Et)?a.map(Ct=>bt=>Et[Ct](It,bt,gt)):function W(Et){return(0,n.m)(Et.addListener)&&(0,n.m)(Et.removeListener)}(Et)?r.map(L(Et,It)):function nt(Et){return(0,n.m)(Et.on)&&(0,n.m)(Et.off)}(Et)?h.map(L(Et,It)):[];if(!Ut&&(0,t.z)(Et))return(0,e.z)(Ct=>R(Ct,It,gt))((0,C.Xf)(Et));if(!Ut)throw new TypeError("Invalid event target");return new m.y(Ct=>{const bt=(...at)=>Ct.next(1<at.length?at:at[0]);return Ut(bt),()=>Jt(bt)})}function L(Et,It){return gt=>wt=>Et[gt](It,wt)}},38421:(B,X,_)=>{"use strict";_.d(X,{Xf:()=>nt});var C=_(35987),m=_(81144),e=_(28239),t=_(68306),n=_(93670),o=_(12206),r=_(44532),a=_(26495),h=_(53260),R=_(30576),L=_(87849),W=_(48822);function nt(Ct){if(Ct instanceof t.y)return Ct;if(null!=Ct){if((0,n.c)(Ct))return function et(Ct){return new t.y(bt=>{const at=Ct[W.L]();if((0,R.m)(at.subscribe))return at.subscribe(bt);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ct);if((0,m.z)(Ct))return function Et(Ct){return new t.y(bt=>{for(let at=0;at<Ct.length&&!bt.closed;at++)bt.next(Ct[at]);bt.complete()})}(Ct);if((0,e.t)(Ct))return function It(Ct){return new t.y(bt=>{Ct.then(at=>{bt.closed||(bt.next(at),bt.complete())},at=>bt.error(at)).then(null,L.h)})}(Ct);if((0,o.D)(Ct))return wt(Ct);if((0,a.T)(Ct))return function gt(Ct){return new t.y(bt=>{for(const at of Ct)if(bt.next(at),bt.closed)return;bt.complete()})}(Ct);if((0,h.L)(Ct))return function Ut(Ct){return wt((0,h.Q)(Ct))}(Ct)}throw(0,r.z)(Ct)}function wt(Ct){return new t.y(bt=>{(function Jt(Ct,bt){var at,ft,lt,Ft;return(0,C.mG)(this,void 0,void 0,function*(){try{for(at=(0,C.KL)(Ct);!(ft=yield at.next()).done;)if(bt.next(ft.value),bt.closed)return}catch(Mt){lt={error:Mt}}finally{try{ft&&!ft.done&&(Ft=at.return)&&(yield Ft.call(at))}finally{if(lt)throw lt.error}}bt.complete()})})(Ct,bt).catch(at=>bt.error(at))})}},56451:(B,X,_)=>{"use strict";_.d(X,{T:()=>o});var C=_(8189),m=_(38421),e=_(60515),t=_(63269),n=_(32076);function o(...r){const a=(0,t.yG)(r),h=(0,t._6)(r,1/0),R=r;return R.length?1===R.length?(0,m.Xf)(R[0]):(0,C.J)(h)((0,n.D)(R,a)):e.E}},39646:(B,X,_)=>{"use strict";_.d(X,{of:()=>e});var C=_(63269),m=_(32076);function e(...t){const n=(0,C.yG)(t);return(0,m.D)(t,n)}},5963:(B,X,_)=>{"use strict";_.d(X,{H:()=>n});var C=_(68306),m=_(34986),e=_(93532);function n(o=0,r,a=m.P){let h=-1;return null!=r&&((0,e.K)(r)?a=r:h=r),new C.y(R=>{let L=function t(o){return o instanceof Date&&!isNaN(o)}(o)?+o-a.now():o;L<0&&(L=0);let W=0;return a.schedule(function(){R.closed||(R.next(W++),0<=h?this.schedule(void 0,h):R.complete())},L)})}},25403:(B,X,_)=>{"use strict";_.d(X,{Q:()=>m});var C=_(70930);class m extends C.Lv{constructor(t,n,o,r,a){super(t),this.onFinalize=a,this._next=n?function(h){try{n(h)}catch(R){t.error(R)}}:super._next,this._error=r?function(h){try{r(h)}catch(R){t.error(R)}finally{this.unsubscribe()}}:super._error,this._complete=o?function(){try{o()}catch(h){t.error(h)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}},70262:(B,X,_)=>{"use strict";_.d(X,{K:()=>t});var C=_(38421),m=_(25403),e=_(54482);function t(n){return(0,e.e)((o,r)=>{let R,a=null,h=!1;a=o.subscribe(new m.Q(r,void 0,void 0,L=>{R=(0,C.Xf)(n(L,t(n)(o))),a?(a.unsubscribe(),a=null,R.subscribe(r)):h=!0})),h&&(a.unsubscribe(),a=null,R.subscribe(r))})}},24351:(B,X,_)=>{"use strict";_.d(X,{b:()=>e});var C=_(95577),m=_(30576);function e(t,n){return(0,m.m)(n)?(0,C.z)(t,n,1):(0,C.z)(t,1)}},78372:(B,X,_)=>{"use strict";_.d(X,{b:()=>t});var C=_(34986),m=_(54482),e=_(25403);function t(n,o=C.z){return(0,m.e)((r,a)=>{let h=null,R=null,L=null;const W=()=>{if(h){h.unsubscribe(),h=null;const et=R;R=null,a.next(et)}};function nt(){const et=L+n,Et=o.now();if(Et<et)return h=this.schedule(void 0,et-Et),void a.add(h);W()}r.subscribe(new e.Q(a,et=>{R=et,L=o.now(),h||(h=o.schedule(nt,n),a.add(h))},()=>{W(),a.complete()},void 0,()=>{R=h=null}))})}},91005:(B,X,_)=>{"use strict";_.d(X,{g:()=>W});var C=_(34986),m=_(97272),e=_(95698),t=_(54482),n=_(25403),o=_(25032),a=_(69718),h=_(95577);function R(nt,et){return et?Et=>(0,m.z)(et.pipe((0,e.q)(1),function r(){return(0,t.e)((nt,et)=>{nt.subscribe(new n.Q(et,o.Z))})}()),Et.pipe(R(nt))):(0,h.z)((Et,It)=>nt(Et,It).pipe((0,e.q)(1),(0,a.h)(Et)))}var L=_(5963);function W(nt,et=C.z){const Et=(0,L.H)(nt,et);return R(()=>Et)}},71884:(B,X,_)=>{"use strict";_.d(X,{x:()=>t});var C=_(44671),m=_(54482),e=_(25403);function t(o,r=C.y){return o=null!=o?o:n,(0,m.e)((a,h)=>{let R,L=!0;a.subscribe(new e.Q(h,W=>{const nt=r(W);(L||!o(R,nt))&&(L=!1,R=nt,h.next(W))}))})}function n(o,r){return o===r}},39300:(B,X,_)=>{"use strict";_.d(X,{h:()=>e});var C=_(54482),m=_(25403);function e(t,n){return(0,C.e)((o,r)=>{let a=0;o.subscribe(new m.Q(r,h=>t.call(n,h,a++)&&r.next(h)))})}},28746:(B,X,_)=>{"use strict";_.d(X,{x:()=>m});var C=_(54482);function m(e){return(0,C.e)((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}},54004:(B,X,_)=>{"use strict";_.d(X,{U:()=>e});var C=_(54482),m=_(25403);function e(t,n){return(0,C.e)((o,r)=>{let a=0;o.subscribe(new m.Q(r,h=>{r.next(t.call(n,h,a++))}))})}},69718:(B,X,_)=>{"use strict";_.d(X,{h:()=>m});var C=_(54004);function m(e){return(0,C.U)(()=>e)}},8189:(B,X,_)=>{"use strict";_.d(X,{J:()=>e});var C=_(95577),m=_(44671);function e(t=1/0){return(0,C.z)(m.y,t)}},95577:(B,X,_)=>{"use strict";_.d(X,{z:()=>a});var C=_(54004),m=_(38421),e=_(54482),t=_(39672),n=_(25403),r=_(30576);function a(h,R,L=1/0){return(0,r.m)(R)?a((W,nt)=>(0,C.U)((et,Et)=>R(W,et,nt,Et))((0,m.Xf)(h(W,nt))),L):("number"==typeof R&&(L=R),(0,e.e)((W,nt)=>function o(h,R,L,W,nt,et,Et,It){const gt=[];let wt=0,Ut=0,Jt=!1;const Ct=()=>{Jt&&!gt.length&&!wt&&R.complete()},bt=ft=>wt<W?at(ft):gt.push(ft),at=ft=>{et&&R.next(ft),wt++;let lt=!1;(0,m.Xf)(L(ft,Ut++)).subscribe(new n.Q(R,Ft=>{null==nt||nt(Ft),et?bt(Ft):R.next(Ft)},()=>{lt=!0},void 0,()=>{if(lt)try{for(wt--;gt.length&&wt<W;){const Ft=gt.shift();Et?(0,t.f)(R,Et,()=>at(Ft)):at(Ft)}Ct()}catch(Ft){R.error(Ft)}}))};return h.subscribe(new n.Q(R,bt,()=>{Jt=!0,Ct()})),()=>{null==It||It()}}(W,nt,h,L)))}},13099:(B,X,_)=>{"use strict";_.d(X,{B:()=>o});var C=_(32076),m=_(95698),e=_(77579),t=_(70930),n=_(54482);function o(a={}){const{connector:h=(()=>new e.x),resetOnError:R=!0,resetOnComplete:L=!0,resetOnRefCountZero:W=!0}=a;return nt=>{let et=null,Et=null,It=null,gt=0,wt=!1,Ut=!1;const Jt=()=>{null==Et||Et.unsubscribe(),Et=null},Ct=()=>{Jt(),et=It=null,wt=Ut=!1},bt=()=>{const at=et;Ct(),null==at||at.unsubscribe()};return(0,n.e)((at,ft)=>{gt++,!Ut&&!wt&&Jt();const lt=It=null!=It?It:h();ft.add(()=>{gt--,0===gt&&!Ut&&!wt&&(Et=r(bt,W))}),lt.subscribe(ft),et||(et=new t.Hp({next:Ft=>lt.next(Ft),error:Ft=>{Ut=!0,Jt(),Et=r(Ct,R,Ft),lt.error(Ft)},complete:()=>{wt=!0,Jt(),Et=r(Ct,L),lt.complete()}}),(0,C.D)(at).subscribe(et))})(nt)}}function r(a,h,...R){return!0===h?(a(),null):!1===h?null:h(...R).pipe((0,m.q)(1)).subscribe(()=>a())}},35684:(B,X,_)=>{"use strict";_.d(X,{T:()=>m});var C=_(39300);function m(e){return(0,C.h)((t,n)=>e<=n)}},68675:(B,X,_)=>{"use strict";_.d(X,{O:()=>t});var C=_(97272),m=_(63269),e=_(54482);function t(...n){const o=(0,m.yG)(n);return(0,e.e)((r,a)=>{(o?(0,C.z)(n,r,o):(0,C.z)(n,r)).subscribe(a)})}},63900:(B,X,_)=>{"use strict";_.d(X,{w:()=>t});var C=_(38421),m=_(54482),e=_(25403);function t(n,o){return(0,m.e)((r,a)=>{let h=null,R=0,L=!1;const W=()=>L&&!h&&a.complete();r.subscribe(new e.Q(a,nt=>{null==h||h.unsubscribe();let et=0;const Et=R++;(0,C.Xf)(n(nt,Et)).subscribe(h=new e.Q(a,It=>a.next(o?o(nt,It,Et,et++):It),()=>{h=null,W()}))},()=>{L=!0,W()}))})}},95698:(B,X,_)=>{"use strict";_.d(X,{q:()=>t});var C=_(60515),m=_(54482),e=_(25403);function t(n){return n<=0?()=>C.E:(0,m.e)((o,r)=>{let a=0;o.subscribe(new e.Q(r,h=>{++a<=n&&(r.next(h),n<=a&&r.complete())}))})}},82722:(B,X,_)=>{"use strict";_.d(X,{R:()=>n});var C=_(54482),m=_(25403),e=_(38421),t=_(25032);function n(o){return(0,C.e)((r,a)=>{(0,e.Xf)(o).subscribe(new m.Q(a,()=>a.complete(),t.Z)),!a.closed&&r.subscribe(a)})}},18505:(B,X,_)=>{"use strict";_.d(X,{b:()=>n});var C=_(30576),m=_(54482),e=_(25403),t=_(44671);function n(o,r,a){const h=(0,C.m)(o)||r||a?{next:o,error:r,complete:a}:o;return h?(0,m.e)((R,L)=>{var W;null===(W=h.subscribe)||void 0===W||W.call(h);let nt=!0;R.subscribe(new e.Q(L,et=>{var Et;null===(Et=h.next)||void 0===Et||Et.call(h,et),L.next(et)},()=>{var et;nt=!1,null===(et=h.complete)||void 0===et||et.call(h),L.complete()},et=>{var Et;nt=!1,null===(Et=h.error)||void 0===Et||Et.call(h,et),L.error(et)},()=>{var et,Et;nt&&(null===(et=h.unsubscribe)||void 0===et||et.call(h)),null===(Et=h.finalize)||void 0===Et||Et.call(h)}))}):t.y}},84408:(B,X,_)=>{"use strict";_.d(X,{o:()=>n});var C=_(50727);class m extends C.w0{constructor(r,a){super()}schedule(r,a=0){return this}}const e={setInterval(...o){const{delegate:r}=e;return((null==r?void 0:r.setInterval)||setInterval)(...o)},clearInterval(o){const{delegate:r}=e;return((null==r?void 0:r.clearInterval)||clearInterval)(o)},delegate:void 0};var t=_(38737);class n extends m{constructor(r,a){super(r,a),this.scheduler=r,this.work=a,this.pending=!1}schedule(r,a=0){if(this.closed)return this;this.state=r;const h=this.id,R=this.scheduler;return null!=h&&(this.id=this.recycleAsyncId(R,h,a)),this.pending=!0,this.delay=a,this.id=this.id||this.requestAsyncId(R,this.id,a),this}requestAsyncId(r,a,h=0){return e.setInterval(r.flush.bind(r,this),h)}recycleAsyncId(r,a,h=0){if(null!=h&&this.delay===h&&!1===this.pending)return a;e.clearInterval(a)}execute(r,a){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const h=this._execute(r,a);if(h)return h;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(r,a){let R,h=!1;try{this.work(r)}catch(L){h=!0,R=L||new Error("Scheduled action threw falsy error")}if(h)return this.unsubscribe(),R}unsubscribe(){if(!this.closed){const{id:r,scheduler:a}=this,{actions:h}=a;this.work=this.state=this.scheduler=null,this.pending=!1,(0,t.P)(h,this),null!=r&&(this.id=this.recycleAsyncId(a,r,null)),this.delay=null,super.unsubscribe()}}}},97565:(B,X,_)=>{"use strict";_.d(X,{v:()=>e});var C=_(26063);class m{constructor(n,o=m.now){this.schedulerActionCtor=n,this.now=o}schedule(n,o=0,r){return new this.schedulerActionCtor(this,n).schedule(r,o)}}m.now=C.l.now;class e extends m{constructor(n,o=m.now){super(n,o),this.actions=[],this._active=!1,this._scheduled=void 0}flush(n){const{actions:o}=this;if(this._active)return void o.push(n);let r;this._active=!0;do{if(r=n.execute(n.state,n.delay))break}while(n=o.shift());if(this._active=!1,r){for(;n=o.shift();)n.unsubscribe();throw r}}}},53101:(B,X,_)=>{"use strict";_.d(X,{E:()=>et});var C=_(84408);let e,m=1;const t={};function n(It){return It in t&&(delete t[It],!0)}const o={setImmediate(It){const gt=m++;return t[gt]=!0,e||(e=Promise.resolve()),e.then(()=>n(gt)&&It()),gt},clearImmediate(It){n(It)}},{setImmediate:a,clearImmediate:h}=o,R={setImmediate(...It){const{delegate:gt}=R;return((null==gt?void 0:gt.setImmediate)||a)(...It)},clearImmediate(It){const{delegate:gt}=R;return((null==gt?void 0:gt.clearImmediate)||h)(It)},delegate:void 0};var W=_(97565);const et=new class nt extends W.v{flush(gt){this._active=!0,this._scheduled=void 0;const{actions:wt}=this;let Ut,Jt=-1;gt=gt||wt.shift();const Ct=wt.length;do{if(Ut=gt.execute(gt.state,gt.delay))break}while(++Jt<Ct&&(gt=wt.shift()));if(this._active=!1,Ut){for(;++Jt<Ct&&(gt=wt.shift());)gt.unsubscribe();throw Ut}}}(class L extends C.o{constructor(gt,wt){super(gt,wt),this.scheduler=gt,this.work=wt}requestAsyncId(gt,wt,Ut=0){return null!==Ut&&Ut>0?super.requestAsyncId(gt,wt,Ut):(gt.actions.push(this),gt._scheduled||(gt._scheduled=R.setImmediate(gt.flush.bind(gt,void 0))))}recycleAsyncId(gt,wt,Ut=0){if(null!=Ut&&Ut>0||null==Ut&&this.delay>0)return super.recycleAsyncId(gt,wt,Ut);0===gt.actions.length&&(R.clearImmediate(wt),gt._scheduled=void 0)}})},34986:(B,X,_)=>{"use strict";_.d(X,{z:()=>e,P:()=>t});var C=_(84408);const e=new(_(97565).v)(C.o),t=e},26063:(B,X,_)=>{"use strict";_.d(X,{l:()=>C});const C={now:()=>(C.delegate||Date).now(),delegate:void 0}},43410:(B,X,_)=>{"use strict";_.d(X,{z:()=>C});const C={setTimeout(...m){const{delegate:e}=C;return((null==e?void 0:e.setTimeout)||setTimeout)(...m)},clearTimeout(m){const{delegate:e}=C;return((null==e?void 0:e.clearTimeout)||clearTimeout)(m)},delegate:void 0}},2202:(B,X,_)=>{"use strict";_.d(X,{h:()=>m});const m=function C(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},48822:(B,X,_)=>{"use strict";_.d(X,{L:()=>C});const C="function"==typeof Symbol&&Symbol.observable||"@@observable"},63269:(B,X,_)=>{"use strict";_.d(X,{jO:()=>t,yG:()=>n,_6:()=>o});var C=_(30576),m=_(93532);function e(r){return r[r.length-1]}function t(r){return(0,C.m)(e(r))?r.pop():void 0}function n(r){return(0,m.K)(e(r))?r.pop():void 0}function o(r,a){return"number"==typeof e(r)?r.pop():a}},54742:(B,X,_)=>{"use strict";_.d(X,{D:()=>n});const{isArray:C}=Array,{getPrototypeOf:m,prototype:e,keys:t}=Object;function n(r){if(1===r.length){const a=r[0];if(C(a))return{args:a,keys:null};if(function o(r){return r&&"object"==typeof r&&m(r)===e}(a)){const h=t(a);return{args:h.map(R=>a[R]),keys:h}}}return{args:r,keys:null}}},38737:(B,X,_)=>{"use strict";function C(m,e){if(m){const t=m.indexOf(e);0<=t&&m.splice(t,1)}}_.d(X,{P:()=>C})},83888:(B,X,_)=>{"use strict";function C(m){const t=m(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}_.d(X,{d:()=>C})},31810:(B,X,_)=>{"use strict";function C(m,e){return m.reduce((t,n,o)=>(t[n]=e[o],t),{})}_.d(X,{n:()=>C})},72806:(B,X,_)=>{"use strict";_.d(X,{x:()=>e,O:()=>t});var C=_(42416);let m=null;function e(n){if(C.v.useDeprecatedSynchronousErrorHandling){const o=!m;if(o&&(m={errorThrown:!1,error:null}),n(),o){const{errorThrown:r,error:a}=m;if(m=null,r)throw a}}else n()}function t(n){C.v.useDeprecatedSynchronousErrorHandling&&m&&(m.errorThrown=!0,m.error=n)}},39672:(B,X,_)=>{"use strict";function C(m,e,t,n=0,o=!1){const r=e.schedule(function(){t(),o?m.add(this.schedule(null,n)):this.unsubscribe()},n);if(m.add(r),!o)return r}_.d(X,{f:()=>C})},44671:(B,X,_)=>{"use strict";function C(m){return m}_.d(X,{y:()=>C})},81144:(B,X,_)=>{"use strict";_.d(X,{z:()=>C});const C=m=>m&&"number"==typeof m.length&&"function"!=typeof m},12206:(B,X,_)=>{"use strict";_.d(X,{D:()=>m});var C=_(30576);function m(e){return Symbol.asyncIterator&&(0,C.m)(null==e?void 0:e[Symbol.asyncIterator])}},30576:(B,X,_)=>{"use strict";function C(m){return"function"==typeof m}_.d(X,{m:()=>C})},93670:(B,X,_)=>{"use strict";_.d(X,{c:()=>e});var C=_(48822),m=_(30576);function e(t){return(0,m.m)(t[C.L])}},26495:(B,X,_)=>{"use strict";_.d(X,{T:()=>e});var C=_(2202),m=_(30576);function e(t){return(0,m.m)(null==t?void 0:t[C.h])}},28239:(B,X,_)=>{"use strict";_.d(X,{t:()=>m});var C=_(30576);function m(e){return(0,C.m)(null==e?void 0:e.then)}},53260:(B,X,_)=>{"use strict";_.d(X,{Q:()=>e,L:()=>t});var C=_(35987),m=_(30576);function e(n){return(0,C.FC)(this,arguments,function*(){const r=n.getReader();try{for(;;){const{value:a,done:h}=yield(0,C.qq)(r.read());if(h)return yield(0,C.qq)(void 0);yield yield(0,C.qq)(a)}}finally{r.releaseLock()}})}function t(n){return(0,m.m)(null==n?void 0:n.getReader)}},93532:(B,X,_)=>{"use strict";_.d(X,{K:()=>m});var C=_(30576);function m(e){return e&&(0,C.m)(e.schedule)}},54482:(B,X,_)=>{"use strict";_.d(X,{A:()=>m,e:()=>e});var C=_(30576);function m(t){return(0,C.m)(null==t?void 0:t.lift)}function e(t){return n=>{if(m(n))return n.lift(function(o){try{return t(o,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}},83268:(B,X,_)=>{"use strict";_.d(X,{Z:()=>t});var C=_(54004);const{isArray:m}=Array;function t(n){return(0,C.U)(o=>function e(n,o){return m(o)?n(...o):n(o)}(n,o))}},25032:(B,X,_)=>{"use strict";function C(){}_.d(X,{Z:()=>C})},87849:(B,X,_)=>{"use strict";_.d(X,{h:()=>e});var C=_(42416),m=_(43410);function e(t){m.z.setTimeout(()=>{const{onUnhandledError:n}=C.v;if(!n)throw t;n(t)})}},44532:(B,X,_)=>{"use strict";function C(m){return new TypeError(`You provided ${null!==m&&"object"==typeof m?"an invalid object":`'${m}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}_.d(X,{z:()=>C})},82734:function(B,X){var m;void 0!==(m=function(){"use strict";function t(R,L,W){var nt=new XMLHttpRequest;nt.open("GET",R),nt.responseType="blob",nt.onload=function(){h(nt.response,L,W)},nt.onerror=function(){console.error("could not download file")},nt.send()}function n(R){var L=new XMLHttpRequest;L.open("HEAD",R,!1);try{L.send()}catch(W){}return 200<=L.status&&299>=L.status}function o(R){try{R.dispatchEvent(new MouseEvent("click"))}catch(W){var L=document.createEvent("MouseEvents");L.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),R.dispatchEvent(L)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(R,L,W){var nt=r.URL||r.webkitURL,et=document.createElement("a");et.download=L=L||R.name||"download",et.rel="noopener","string"==typeof R?(et.href=R,et.origin===location.origin?o(et):n(et.href)?t(R,L,W):o(et,et.target="_blank")):(et.href=nt.createObjectURL(R),setTimeout(function(){nt.revokeObjectURL(et.href)},4e4),setTimeout(function(){o(et)},0))}:"msSaveOrOpenBlob"in navigator?function(R,L,W){if(L=L||R.name||"download","string"!=typeof R)navigator.msSaveOrOpenBlob(function e(R,L){return void 0===L?L={autoBom:!1}:"object"!=typeof L&&(console.warn("Deprecated: Expected third argument to be a object"),L={autoBom:!L}),L.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(R.type)?new Blob(["\ufeff",R],{type:R.type}):R}(R,W),L);else if(n(R))t(R,L,W);else{var nt=document.createElement("a");nt.href=R,nt.target="_blank",setTimeout(function(){o(nt)})}}:function(R,L,W,nt){if((nt=nt||open("","_blank"))&&(nt.document.title=nt.document.body.innerText="downloading..."),"string"==typeof R)return t(R,L,W);var et="application/octet-stream"===R.type,Et=/constructor/i.test(r.HTMLElement)||r.safari,It=/CriOS\/[\d]+/.test(navigator.userAgent);if((It||et&&Et||a)&&"undefined"!=typeof FileReader){var gt=new FileReader;gt.onloadend=function(){var Jt=gt.result;Jt=It?Jt:Jt.replace(/^data:[^;]*;/,"data:attachment/file;"),nt?nt.location.href=Jt:location=Jt,nt=null},gt.readAsDataURL(R)}else{var wt=r.URL||r.webkitURL,Ut=wt.createObjectURL(R);nt?nt.location=Ut:location.href=Ut,nt=null,setTimeout(function(){wt.revokeObjectURL(Ut)},4e4)}});r.saveAs=h.saveAs=h,B.exports=h}.apply(X,[]))&&(B.exports=m)},86942:(B,X,_)=>{"use strict";var C,m,e;_.r(X),_.d(X,{Synth:()=>C}),function(){var t=window.URL||window.webkitURL,n=window.Blob;if(!t||!n)throw new Error("This browser does not support AudioSynth");var o=!1,r=null,a=function(nt,et){return[new Uint8Array([et,et>>8]),new Uint8Array([et,et>>8,et>>16,et>>24])][nt]},h=function(nt,et,Et,It){Object.defineProperty(this,nt,{value:et,writable:!!Et,enumerable:!!It})},R=function(nt,et,Et){h.call(this,nt,et,Et,!0)};e=function(){this.__init__.apply(this,arguments)};var L=h.bind(e.prototype),W=R.bind(e.prototype);L("__init__",function(nt,et,Et){if(!o)throw new Error("AudioSynthInstrument can only be instantiated from the createInstrument method of the AudioSynth object.");h.call(this,"_parent",nt),R.call(this,"name",et),h.call(this,"_soundID",Et)}),W("play",function(nt,et,Et){return this._parent.play(this._soundID,nt,et,Et)}),W("generate",function(nt,et,Et){return this._parent.generate(this._soundID,nt,et,Et)}),L=h.bind((m=function nt(){return r instanceof nt?r:(this.__init__(),this)}).prototype),W=R.bind(m.prototype),L("_debug",!1,!0),L("_bitsPerSample",16),L("_channels",1),L("_sampleRate",44100,!0),W("setSampleRate",function(nt){return this._sampleRate=Math.max(Math.min(0|nt,44100),4e3),this._clearCache(),this._sampleRate}),W("getSampleRate",function(){return this._sampleRate}),L("_volume",32768,!0),W("setVolume",function(nt){return nt=parseFloat(nt),isNaN(nt)&&(nt=0),nt=Math.round(32768*nt),this._volume=Math.max(Math.min(0|nt,32768),0),this._clearCache(),this._volume}),W("getVolume",function(){return Math.round(this._volume/32768*1e4)/1e4}),L("_notes",{C:261.63,"C#":277.18,D:293.66,"D#":311.13,E:329.63,F:349.23,"F#":369.99,G:392,"G#":415.3,A:440,"A#":466.16,B:493.88}),L("_fileCache",[],!0),L("_temp",{},!0),L("_sounds",[],!0),L("_mod",[function(nt,et,Et,It){return Math.sin(2*Math.PI*(nt/et)*Et+It)}]),L("_resizeCache",function(){for(var nt=this._fileCache,et=this._sounds.length;nt.length<et;){for(var Et=[],It=0;It<8;It++){var gt={};for(var wt in this._notes)gt[wt]={};Et.push(gt)}nt.push(Et)}}),L("_clearCache",function(){this._fileCache=[],this._resizeCache()}),W("generate",function(nt,et,Et,It){var gt=this._sounds[nt];if(!gt)for(var wt=0;wt<this._sounds.length;wt++)if(this._sounds[wt].name==nt){gt=this._sounds[wt],nt=wt;break}if(!gt)throw new Error("Invalid sound or sound ID: "+nt);var Ut=(new Date).valueOf();this._temp={},Et|=0,Et=Math.min(8,Math.max(1,Et));var Jt=It?parseFloat(It):2;if(void 0===this._notes[et])throw new Error(et+" is not a valid note.");if(void 0!==this._fileCache[nt][Et-1][et][Jt])return this._debug&&console.log((new Date).valueOf()-Ut,"ms to retrieve (cached)"),this._fileCache[nt][Et-1][et][Jt];var Ct=this._notes[et]*Math.pow(2,Et-4),bt=this._sampleRate,at=this._volume,ft=this._channels,lt=this._bitsPerSample,Ft=gt.attack(bt,Ct,at),Mt=gt.dampen(bt,Ct,at),yt=gt.wave,ct={modulate:this._mod,vars:this._temp},rt=0,xt=new Uint8Array(new ArrayBuffer(Math.ceil(bt*Jt*2))),Lt=bt*Ft|0,de=bt*Jt|0;for(wt=0;wt!==Lt;wt++)rt=at*(wt/(bt*Ft))*yt.call(ct,wt,bt,Ct,at),xt[wt<<1]=rt,xt[1+(wt<<1)]=rt>>8;for(;wt!==de;wt++)rt=at*Math.pow(1-(wt-bt*Ft)/(bt*(Jt-Ft)),Mt)*yt.call(ct,wt,bt,Ct,at),xt[wt<<1]=rt,xt[1+(wt<<1)]=rt>>8;var _e=["RIFF",a(1,52),"WAVE","fmt ",a(1,16),a(0,1),a(0,ft),a(1,bt),a(1,bt*ft*lt/8),a(0,ft*lt/8),a(0,lt),"data",a(1,xt.length*ft*lt/8),xt],ce=new n(_e,{type:"audio/wav"}),Ae=t.createObjectURL(ce);return this._fileCache[nt][Et-1][et][Jt]=Ae,this._debug&&console.log((new Date).valueOf()-Ut,"ms to generate"),Ae}),W("play",function(nt,et,Et,It){var gt=this.generate(nt,et,Et,It);return new Audio(gt).play(),!0}),W("debug",function(){this._debug=!0}),W("createInstrument",function(nt){var et=0,Et=!1;if("string"==typeof nt){for(var It=0;It<this._sounds.length;It++)if(this._sounds[It].name==nt){Et=!0,et=It;break}}else this._sounds[nt]&&(nt=this._sounds[et=nt].name,Et=!0);if(!Et)throw new Error("Invalid sound or sound ID: "+nt);o=!0;var gt=new e(this,nt,et);return o=!1,gt}),W("listSounds",function(){for(var nt=[],et=0;et<this._sounds.length;et++)nt.push(this._sounds[et].name);return nt}),L("__init__",function(){this._resizeCache()}),W("loadSoundProfile",function(){for(var nt=0,et=arguments.length;nt<et;nt++){var Et=arguments[nt];if(!(Et instanceof Object))throw new Error("Invalid sound profile.");this._sounds.push(Et)}return this._resizeCache(),!0}),W("loadModulationFunction",function(){for(var nt=0,et=arguments.length;nt<et;nt++){var Et=arguments[nt];if("function"!=typeof Et)throw new Error("Invalid modulation function.");this._mod.push(Et)}return!0}),r=new m,C=r}(),C.loadModulationFunction(function(t,n,o,r){return 1*Math.sin(2*Math.PI*(t/n*o)+r)},function(t,n,o,r){return 1*Math.sin(4*Math.PI*(t/n*o)+r)},function(t,n,o,r){return 1*Math.sin(8*Math.PI*(t/n*o)+r)},function(t,n,o,r){return 1*Math.sin(.5*Math.PI*(t/n*o)+r)},function(t,n,o,r){return 1*Math.sin(.25*Math.PI*(t/n*o)+r)},function(t,n,o,r){return.5*Math.sin(2*Math.PI*(t/n*o)+r)},function(t,n,o,r){return.5*Math.sin(4*Math.PI*(t/n*o)+r)},function(t,n,o,r){return.5*Math.sin(8*Math.PI*(t/n*o)+r)},function(t,n,o,r){return.5*Math.sin(.5*Math.PI*(t/n*o)+r)},function(t,n,o,r){return.5*Math.sin(.25*Math.PI*(t/n*o)+r)}),C.loadSoundProfile({name:"piano",attack:function(){return.002},dampen:function(t,n,o){return Math.pow(.5*Math.log(n*o/t),2)},wave:function(t,n,o,r){var a=this.modulate[0];return this.modulate[1](t,n,o,Math.pow(a(t,n,o,0),2)+.75*a(t,n,o,.25)+.1*a(t,n,o,.5))}},{name:"organ",attack:function(){return.3},dampen:function(t,n){return 1+.01*n},wave:function(t,n,o){var r=this.modulate[0];return this.modulate[1](t,n,o,r(t,n,o,0)+.5*r(t,n,o,.25)+.25*r(t,n,o,.5))}},{name:"acoustic",attack:function(){return.002},dampen:function(){return 1},wave:function(t,n,o){var r=this.vars;r.valueTable=r.valueTable?r.valueTable:[],void 0===r.playVal&&(r.playVal=0),void 0===r.periodCount&&(r.periodCount=0);var a=r.valueTable,h=r.playVal,R=r.periodCount,L=n/o,W=Math.floor(100*(L-Math.floor(L))),nt=!1;if(a.length<=Math.ceil(L))return a.push(2*Math.round(Math.random())-1),a[a.length-1];a[h]=.5*(a[h>=a.length-1?0:h+1]+a[h]),h>=Math.floor(L)&&(h<Math.ceil(L)?R%100>=W&&(nt=!0,a[h+1]=.5*(a[0]+a[h+1]),r.periodCount++):nt=!0);var et=a[h];return nt?r.playVal=0:r.playVal++,et}},{name:"edm",attack:function(){return.002},dampen:function(){return 1},wave:function(t,n,o){var r=this.modulate[0],a=this.modulate.slice(1);return a[0](t,n,o,a[9](t,n,o,a[2](t,n,o,Math.pow(r(t,n,o,0),3)+Math.pow(r(t,n,o,.5),5)+Math.pow(r(t,n,o,1),7)))+a[8](t,n,o,r(t,n,o,1.75)))}})},35235:function(B,X,_){var m,e;m=[_(34316)],void 0!==(e=function(t){"use strict";return t}.apply(X,m))&&(B.exports=e)},34316:function(B,X){var m;void 0!==(m=function(){"use strict";var e={connectionTypes:{INPUT_VALUE:1,OUTPUT_VALUE:2,NEXT_STATEMENT:3,PREVIOUS_STATEMENT:4},constants:{},LINE_MODE_MULTIPLIER:40,PAGE_MODE_MULTIPLIER:125,DRAG_RADIUS:5,FLYOUT_DRAG_RADIUS:10,SNAP_RADIUS:28};return e.CONNECTING_SNAP_RADIUS=e.SNAP_RADIUS,e.CURRENT_CONNECTION_PREFERENCE=8,e.BUMP_DELAY=250,e.BUMP_RANDOMNESS=10,e.COLLAPSE_CHARS=30,e.LONGPRESS=750,e.SOUND_LIMIT=100,e.DRAG_STACK=!0,e.HSV_SATURATION=.45,e.HSV_VALUE=.65,e.SPRITE={width:96,height:124,url:"sprites.png"},e.constants.ALIGN={LEFT:-1,CENTRE:0,RIGHT:1},e.DRAG_NONE=0,e.DRAG_STICKY=1,e.DRAG_BEGIN=1,e.DRAG_FREE=2,e.OPPOSITE_TYPE=[],e.OPPOSITE_TYPE[e.connectionTypes.INPUT_VALUE]=e.connectionTypes.OUTPUT_VALUE,e.OPPOSITE_TYPE[e.connectionTypes.OUTPUT_VALUE]=e.connectionTypes.INPUT_VALUE,e.OPPOSITE_TYPE[e.connectionTypes.NEXT_STATEMENT]=e.connectionTypes.PREVIOUS_STATEMENT,e.OPPOSITE_TYPE[e.connectionTypes.PREVIOUS_STATEMENT]=e.connectionTypes.NEXT_STATEMENT,e.VARIABLE_CATEGORY_NAME="VARIABLE",e.VARIABLE_DYNAMIC_CATEGORY_NAME="VARIABLE_DYNAMIC",e.PROCEDURE_CATEGORY_NAME="PROCEDURE",e.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",e.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",e.constants.COLLAPSED_INPUT_NAME="_TEMP_COLLAPSED_INPUT",e.constants.COLLAPSED_FIELD_NAME="_TEMP_COLLAPSED_FIELD",e.utils={},e.utils.global=function(){return"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:this}(),e.Msg={},e.utils.global.Blockly||(e.utils.global.Blockly={}),e.utils.global.Blockly.Msg||(e.utils.global.Blockly.Msg=e.Msg),e.utils.colour={},e.utils.colour.parse=function(t){t=String(t).toLowerCase().trim();var n=e.utils.colour.names[t];if(n||(n="0x"==t.substring(0,2)?"#"+t.substring(2):t,/^#[0-9a-f]{6}$/.test(n="#"==n[0]?n:"#"+n)))return n;if(/^#[0-9a-f]{3}$/.test(n))return["#",n[1],n[1],n[2],n[2],n[3],n[3]].join("");var o=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return o&&(t=Number(o[1]),n=Number(o[2]),o=Number(o[3]),0<=t&&256>t&&0<=n&&256>n&&0<=o&&256>o)?e.utils.colour.rgbToHex(t,n,o):null},e.utils.colour.rgbToHex=function(t,n,o){return n=t<<16|n<<8|o,16>t?"#"+(16777216|n).toString(16).substr(1):"#"+n.toString(16)},e.utils.colour.hexToRgb=function(t){return(t=e.utils.colour.parse(t))?[(t=parseInt(t.substr(1),16))>>16,t>>8&255,255&t]:[0,0,0]},e.utils.colour.hsvToHex=function(t,n,o){var r=0,a=0,h=0;if(0==n)h=a=r=o;else{var R=Math.floor(t/60),L=t/60-R;t=o*(1-n);var W=o*(1-n*L);switch(n=o*(1-n*(1-L)),R){case 1:r=W,a=o,h=t;break;case 2:r=t,a=o,h=n;break;case 3:r=t,a=W,h=o;break;case 4:r=n,a=t,h=o;break;case 5:r=o,a=t,h=W;break;case 6:case 0:r=o,a=n,h=t}}return e.utils.colour.rgbToHex(Math.floor(r),Math.floor(a),Math.floor(h))},e.utils.colour.blend=function(t,n,o){return(t=e.utils.colour.parse(t))&&(n=e.utils.colour.parse(n))?(t=e.utils.colour.hexToRgb(t),n=e.utils.colour.hexToRgb(n),e.utils.colour.rgbToHex(Math.round(n[0]+o*(t[0]-n[0])),Math.round(n[1]+o*(t[1]-n[1])),Math.round(n[2]+o*(t[2]-n[2])))):null},e.utils.colour.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},e.utils.Coordinate=function(t,n){this.x=t,this.y=n},e.utils.Coordinate.equals=function(t,n){return t==n||!(!t||!n)&&t.x==n.x&&t.y==n.y},e.utils.Coordinate.distance=function(t,n){var o=t.x-n.x;return t=t.y-n.y,Math.sqrt(o*o+t*t)},e.utils.Coordinate.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},e.utils.Coordinate.difference=function(t,n){return new e.utils.Coordinate(t.x-n.x,t.y-n.y)},e.utils.Coordinate.sum=function(t,n){return new e.utils.Coordinate(t.x+n.x,t.y+n.y)},e.utils.Coordinate.prototype.clone=function(){return new e.utils.Coordinate(this.x,this.y)},e.utils.Coordinate.prototype.scale=function(t){return this.x*=t,this.y*=t,this},e.utils.Coordinate.prototype.translate=function(t,n){return this.x+=t,this.y+=n,this},e.utils.Rect=function(t,n,o,r){this.top=t,this.bottom=n,this.left=o,this.right=r},e.utils.Rect.prototype.contains=function(t,n){return t>=this.left&&t<=this.right&&n>=this.top&&n<=this.bottom},e.utils.Rect.prototype.intersects=function(t){return!(this.left>t.right||this.right<t.left||this.top>t.bottom||this.bottom<t.top)},e.utils.string={},e.utils.string.startsWith=function(t,n){return 0==t.lastIndexOf(n,0)},e.utils.string.shortestStringLength=function(t){return t.length?t.reduce(function(n,o){return n.length<o.length?n:o}).length:0},e.utils.string.commonWordPrefix=function(t,n){if(!t.length)return 0;if(1==t.length)return t[0].length;var o=0;n=n||e.utils.string.shortestStringLength(t);for(var r=0;r<n;r++){for(var a=t[0][r],h=1;h<t.length;h++)if(a!=t[h][r])return o;" "==a&&(o=r+1)}for(h=1;h<t.length;h++)if((a=t[h][r])&&" "!=a)return o;return n},e.utils.string.commonWordSuffix=function(t,n){if(!t.length)return 0;if(1==t.length)return t[0].length;var o=0;n=n||e.utils.string.shortestStringLength(t);for(var r=0;r<n;r++){for(var a=t[0].substr(-r-1,1),h=1;h<t.length;h++)if(a!=t[h].substr(-r-1,1))return o;" "==a&&(o=r+1)}for(h=1;h<t.length;h++)if((a=t[h].charAt(t[h].length-r-1))&&" "!=a)return o;return n},e.utils.string.wrap=function(t,n){t=t.split("\n");for(var o=0;o<t.length;o++)t[o]=e.utils.string.wrapLine_(t[o],n);return t.join("\n")},e.utils.string.wrapLine_=function(t,n){if(t.length<=n)return t;for(var o=t.trim().split(/\s+/),r=0;r<o.length;r++)o[r].length>n&&(n=o[r].length);r=-1/0;var a=1;do{var h=r,R=t;t=[];var L=o.length/a,W=1;for(r=0;r<o.length-1;r++)W<(r+1.5)/L?(W++,t[r]=!0):t[r]=!1;t=e.utils.string.wrapMutate_(o,t,n),r=e.utils.string.wrapScore_(o,t,n),t=e.utils.string.wrapToText_(o,t),a++}while(r>h);return R},e.utils.string.wrapScore_=function(t,n,o){for(var r=[0],a=[],h=0;h<t.length;h++)r[r.length-1]+=t[h].length,!0===n[h]?(r.push(0),a.push(t[h].charAt(t[h].length-1))):!1===n[h]&&r[r.length-1]++;for(t=Math.max.apply(Math,r),h=n=0;h<r.length;h++)n-=2*Math.pow(Math.abs(o-r[h]),1.5),n-=Math.pow(t-r[h],1.5),-1!=".?!".indexOf(a[h])?n+=o/3:-1!=",;)]}".indexOf(a[h])&&(n+=o/4);return 1<r.length&&r[r.length-1]<=r[r.length-2]&&(n+=.5),n},e.utils.string.wrapMutate_=function(t,n,o){for(var a,r=e.utils.string.wrapScore_(t,n,o),h=0;h<n.length-1;h++)if(n[h]!=n[h+1]){var R=[].concat(n);R[h]=!R[h],R[h+1]=!R[h+1];var L=e.utils.string.wrapScore_(t,R,o);L>r&&(r=L,a=R)}return a?e.utils.string.wrapMutate_(t,a,o):n},e.utils.string.wrapToText_=function(t,n){for(var o=[],r=0;r<t.length;r++)o.push(t[r]),void 0!==n[r]&&o.push(n[r]?"\n":" ");return o.join("")},e.utils.Size=function(t,n){this.width=t,this.height=n},e.utils.Size.equals=function(t,n){return t==n||!(!t||!n)&&t.width==n.width&&t.height==n.height},e.utils.style={},e.utils.style.getSize=function(t){if("none"!=e.utils.style.getStyle_(t,"display"))return e.utils.style.getSizeWithDisplay_(t);var n=t.style,o=n.display,r=n.visibility,a=n.position;n.visibility="hidden",n.position="absolute",n.display="inline";var h=t.offsetWidth;return t=t.offsetHeight,n.display=o,n.position=a,n.visibility=r,new e.utils.Size(h,t)},e.utils.style.getSizeWithDisplay_=function(t){return new e.utils.Size(t.offsetWidth,t.offsetHeight)},e.utils.style.getStyle_=function(t,n){return e.utils.style.getComputedStyle(t,n)||e.utils.style.getCascadedStyle(t,n)||t.style&&t.style[n]},e.utils.style.getComputedStyle=function(t,n){return document.defaultView&&document.defaultView.getComputedStyle&&(t=document.defaultView.getComputedStyle(t,null))&&(t[n]||t.getPropertyValue(n))||""},e.utils.style.getCascadedStyle=function(t,n){return t.currentStyle?t.currentStyle[n]:null},e.utils.style.getPageOffset=function(t){var n=new e.utils.Coordinate(0,0);t=t.getBoundingClientRect();var o=document.documentElement;return o=new e.utils.Coordinate(window.pageXOffset||o.scrollLeft,window.pageYOffset||o.scrollTop),n.x=t.left+o.x,n.y=t.top+o.y,n},e.utils.style.getViewportPageOffset=function(){var t=document.body,n=document.documentElement;return new e.utils.Coordinate(t.scrollLeft||n.scrollLeft,t.scrollTop||n.scrollTop)},e.utils.style.setElementShown=function(t,n){t.style.display=n?"":"none"},e.utils.style.isRightToLeft=function(t){return"rtl"==e.utils.style.getStyle_(t,"direction")},e.utils.style.getBorderBox=function(t){var n=e.utils.style.getComputedStyle(t,"borderLeftWidth"),o=e.utils.style.getComputedStyle(t,"borderRightWidth"),r=e.utils.style.getComputedStyle(t,"borderTopWidth");return t=e.utils.style.getComputedStyle(t,"borderBottomWidth"),{top:parseFloat(r),right:parseFloat(o),bottom:parseFloat(t),left:parseFloat(n)}},e.utils.style.scrollIntoContainerView=function(t,n,o){t=e.utils.style.getContainerOffsetToScrollInto(t,n,o),n.scrollLeft=t.x,n.scrollTop=t.y},e.utils.style.getContainerOffsetToScrollInto=function(t,n,o){var r=e.utils.style.getPageOffset(t),a=e.utils.style.getPageOffset(n),h=e.utils.style.getBorderBox(n),R=r.x-a.x-h.left;return r=r.y-a.y-h.top,a=e.utils.style.getSizeWithDisplay_(t),t=n.clientWidth-a.width,a=n.clientHeight-a.height,h=n.scrollLeft,n=n.scrollTop,o?(h+=R-t/2,n+=r-a/2):(h+=Math.min(R,Math.max(R-t,0)),n+=Math.min(r,Math.max(r-a,0))),new e.utils.Coordinate(h,n)},e.utils.userAgent={},function(t){function n(r){return-1!=o.indexOf(r.toUpperCase())}e.utils.userAgent.raw=t;var o=e.utils.userAgent.raw.toUpperCase();e.utils.userAgent.IE=n("Trident")||n("MSIE"),e.utils.userAgent.EDGE=n("Edge"),e.utils.userAgent.JAVA_FX=n("JavaFX"),e.utils.userAgent.CHROME=(n("Chrome")||n("CriOS"))&&!e.utils.userAgent.EDGE,e.utils.userAgent.WEBKIT=n("WebKit")&&!e.utils.userAgent.EDGE,e.utils.userAgent.GECKO=n("Gecko")&&!e.utils.userAgent.WEBKIT&&!e.utils.userAgent.IE&&!e.utils.userAgent.EDGE,e.utils.userAgent.ANDROID=n("Android"),t=e.utils.global.navigator&&e.utils.global.navigator.maxTouchPoints,e.utils.userAgent.IPAD=n("iPad")||n("Macintosh")&&0<t,e.utils.userAgent.IPOD=n("iPod"),e.utils.userAgent.IPHONE=n("iPhone")&&!e.utils.userAgent.IPAD&&!e.utils.userAgent.IPOD,e.utils.userAgent.MAC=n("Macintosh"),e.utils.userAgent.TABLET=e.utils.userAgent.IPAD||e.utils.userAgent.ANDROID&&!n("Mobile")||n("Silk"),e.utils.userAgent.MOBILE=!e.utils.userAgent.TABLET&&(e.utils.userAgent.IPOD||e.utils.userAgent.IPHONE||e.utils.userAgent.ANDROID||n("IEMobile"))}(e.utils.global.navigator&&e.utils.global.navigator.userAgent||""),e.utils.noEvent=function(t){t.preventDefault(),t.stopPropagation()},e.utils.isTargetInput=function(t){return"textarea"==t.target.type||"text"==t.target.type||"number"==t.target.type||"email"==t.target.type||"password"==t.target.type||"search"==t.target.type||"tel"==t.target.type||"url"==t.target.type||t.target.isContentEditable||t.target.dataset&&"true"==t.target.dataset.isTextInput},e.utils.getRelativeXY=function(t){var n=new e.utils.Coordinate(0,0),o=t.getAttribute("x");return o&&(n.x=parseInt(o,10)),(o=t.getAttribute("y"))&&(n.y=parseInt(o,10)),(o=(o=t.getAttribute("transform"))&&o.match(e.utils.getRelativeXY.XY_REGEX_))&&(n.x+=Number(o[1]),o[3]&&(n.y+=Number(o[3]))),(t=t.getAttribute("style"))&&-1<t.indexOf("translate")&&(t=t.match(e.utils.getRelativeXY.XY_STYLE_REGEX_))&&(n.x+=Number(t[1]),t[3]&&(n.y+=Number(t[3]))),n},e.utils.getInjectionDivXY_=function(t){for(var n=0,o=0;t;){var r=e.utils.getRelativeXY(t);if(n+=r.x,o+=r.y,-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;t=t.parentNode}return new e.utils.Coordinate(n,o)},e.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,e.utils.getRelativeXY.XY_STYLE_REGEX_=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,e.utils.isRightButton=function(t){return!(!t.ctrlKey||!e.utils.userAgent.MAC)||2==t.button},e.utils.mouseToSvg=function(t,n,o){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,o||(o=n.getScreenCTM().inverse()),r.matrixTransform(o)},e.utils.getScrollDeltaPixels=function(t){switch(t.deltaMode){default:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*e.LINE_MODE_MULTIPLIER,y:t.deltaY*e.LINE_MODE_MULTIPLIER};case 2:return{x:t.deltaX*e.PAGE_MODE_MULTIPLIER,y:t.deltaY*e.PAGE_MODE_MULTIPLIER}}},e.utils.tokenizeInterpolation=function(t){return e.utils.tokenizeInterpolation_(t,!0)},e.utils.replaceMessageReferences=function(t){return"string"!=typeof t?t:(t=e.utils.tokenizeInterpolation_(t,!1)).length?String(t[0]):""},e.utils.checkMessageReferences=function(t){for(var n=!0,o=e.Msg,r=t.match(/%{BKY_[A-Z]\w*}/gi),a=0;a<r.length;a++)null==o[r[a].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+r[a]+" in "+t),n=!1);return n},e.utils.tokenizeInterpolation_=function(t,n){var o=[],r=t.split("");r.push("");var a=0;t=[];for(var h=null,R=0;R<r.length;R++){var L=r[R];0==a?"%"==L?((L=t.join(""))&&o.push(L),t.length=0,a=1):t.push(L):1==a?"%"==L?(t.push(L),a=0):n&&"0"<=L&&"9">=L?(a=2,h=L,(L=t.join(""))&&o.push(L),t.length=0):"{"==L?a=3:(t.push("%",L),a=0):2==a?"0"<=L&&"9">=L?h+=L:(o.push(parseInt(h,10)),R--,a=0):3==a&&(""==L?(t.splice(0,0,"%{"),R--,a=0):"}"!=L?t.push(L):(a=t.join(""),/[A-Z]\w*/i.test(a)?(L=a.toUpperCase(),(L=e.utils.string.startsWith(L,"BKY_")?L.substring(4):null)&&L in e.Msg?"string"==typeof(a=e.Msg[L])?Array.prototype.push.apply(o,e.utils.tokenizeInterpolation_(a,n)):o.push(n?String(a):a):o.push("%{"+a+"}")):o.push("%{"+a+"}"),a=t.length=0))}for((L=t.join(""))&&o.push(L),n=[],R=t.length=0;R<o.length;++R)"string"==typeof o[R]?t.push(o[R]):((L=t.join(""))&&n.push(L),t.length=0,n.push(o[R]));return(L=t.join(""))&&n.push(L),t.length=0,n},e.utils.genUid=function(){for(var t=e.utils.genUid.soup_.length,n=[],o=0;20>o;o++)n[o]=e.utils.genUid.soup_.charAt(Math.random()*t);return n.join("")},e.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e.utils.is3dSupported=function(){if(void 0!==e.utils.is3dSupported.cached_)return e.utils.is3dSupported.cached_;if(!e.utils.global.getComputedStyle)return!1;var t=document.createElement("p"),n="none",o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var r in document.body.insertBefore(t,null),o)if(void 0!==t.style[r]){if(t.style[r]="translate3d(1px,1px,1px)",!(n=e.utils.global.getComputedStyle(t)))return document.body.removeChild(t),!1;n=n.getPropertyValue(o[r])}return document.body.removeChild(t),e.utils.is3dSupported.cached_="none"!==n,e.utils.is3dSupported.cached_},e.utils.runAfterPageLoad=function(t){if("object"!=typeof document)throw Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"==document.readyState)t();else var n=setInterval(function(){"complete"==document.readyState&&(clearInterval(n),t())},10)},e.utils.getViewportBBox=function(){var t=e.utils.style.getViewportPageOffset();return new e.utils.Rect(t.y,document.documentElement.clientHeight+t.y,t.x,document.documentElement.clientWidth+t.x)},e.utils.arrayRemove=function(t,n){return-1!=(n=t.indexOf(n))&&(t.splice(n,1),!0)},e.utils.getDocumentScroll=function(){var t=document.documentElement,n=window;return e.utils.userAgent.IE&&n.pageYOffset!=t.scrollTop?new e.utils.Coordinate(t.scrollLeft,t.scrollTop):new e.utils.Coordinate(n.pageXOffset||t.scrollLeft,n.pageYOffset||t.scrollTop)},e.utils.getBlockTypeCounts=function(t,n){var o=Object.create(null),r=t.getDescendants(!0);for(n&&(t=t.getNextBlock())&&(t=r.indexOf(t),r.splice(t,r.length-t)),t=0;n=r[t];t++)o[n.type]?o[n.type]++:o[n.type]=1;return o},e.utils.screenToWsCoordinates=function(t,n){var o=n.x;n=n.y;var r=t.getInjectionDiv().getBoundingClientRect();return o=new e.utils.Coordinate(o-r.left,n-r.top),n=t.getOriginOffsetInPixels(),e.utils.Coordinate.difference(o,n).scale(1/t.scale)},e.utils.parseBlockColour=function(t){var n="string"==typeof t?e.utils.replaceMessageReferences(t):t,o=Number(n);if(!isNaN(o)&&0<=o&&360>=o)return{hue:o,hex:e.utils.colour.hsvToHex(o,e.HSV_SATURATION,255*e.HSV_VALUE)};if(o=e.utils.colour.parse(n))return{hue:null,hex:o};throw o='Invalid colour: "'+n+'"',t!=n&&(o+=' (from "'+t+'")'),Error(o)},e.Touch={},e.Touch.TOUCH_ENABLED="ontouchstart"in e.utils.global||!!(e.utils.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!e.utils.global.navigator||!e.utils.global.navigator.maxTouchPoints&&!e.utils.global.navigator.msMaxTouchPoints),e.Touch.touchIdentifier_=null,e.Touch.TOUCH_MAP={},e.utils.global.PointerEvent?e.Touch.TOUCH_MAP={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]}:e.Touch.TOUCH_ENABLED&&(e.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]}),e.longPid_=0,e.longStart=function(t,n){e.longStop_(),t.changedTouches&&1!=t.changedTouches.length||(e.longPid_=setTimeout(function(){t.changedTouches&&(t.button=2,t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY),n&&n.handleRightClick(t)},e.LONGPRESS))},e.longStop_=function(){e.longPid_&&(clearTimeout(e.longPid_),e.longPid_=0)},e.Touch.clearTouchIdentifier=function(){e.Touch.touchIdentifier_=null},e.Touch.shouldHandleEvent=function(t){return!e.Touch.isMouseOrTouchEvent(t)||e.Touch.checkTouchIdentifier(t)},e.Touch.getTouchIdentifierFromEvent=function(t){return null!=t.pointerId?t.pointerId:t.changedTouches&&t.changedTouches[0]&&null!=t.changedTouches[0].identifier?t.changedTouches[0].identifier:"mouse"},e.Touch.checkTouchIdentifier=function(t){var n=e.Touch.getTouchIdentifierFromEvent(t);return null!=e.Touch.touchIdentifier_?e.Touch.touchIdentifier_==n:("mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type)&&(e.Touch.touchIdentifier_=n,!0)},e.Touch.setClientFromTouch=function(t){if(e.utils.string.startsWith(t.type,"touch")){var n=t.changedTouches[0];t.clientX=n.clientX,t.clientY=n.clientY}},e.Touch.isMouseOrTouchEvent=function(t){return e.utils.string.startsWith(t.type,"touch")||e.utils.string.startsWith(t.type,"mouse")||e.utils.string.startsWith(t.type,"pointer")},e.Touch.isTouchEvent=function(t){return e.utils.string.startsWith(t.type,"touch")||e.utils.string.startsWith(t.type,"pointer")},e.Touch.splitEventByTouches=function(t){var n=[];if(t.changedTouches)for(var o=0;o<t.changedTouches.length;o++)n[o]={type:t.type,changedTouches:[t.changedTouches[o]],target:t.target,stopPropagation:function(){t.stopPropagation()},preventDefault:function(){t.preventDefault()}};else n.push(t);return n},e.browserEvents={},e.browserEvents.conditionalBind=function(t,n,o,r,a,h){var R=!1,L=function(It){var gt=!a;It=e.Touch.splitEventByTouches(It);for(var Ut,wt=0;Ut=It[wt];wt++)(!gt||e.Touch.shouldHandleEvent(Ut))&&(e.Touch.setClientFromTouch(Ut),o?r.call(o,Ut):r(Ut),R=!0)},W=[];if(e.utils.global.PointerEvent&&n in e.Touch.TOUCH_MAP)for(var et,nt=0;et=e.Touch.TOUCH_MAP[n][nt];nt++)t.addEventListener(et,L,!1),W.push([t,et,L]);else if(t.addEventListener(n,L,!1),W.push([t,n,L]),n in e.Touch.TOUCH_MAP){var Et=function(It){L(It),R&&!h&&It.preventDefault()};for(nt=0;et=e.Touch.TOUCH_MAP[n][nt];nt++)t.addEventListener(et,Et,!1),W.push([t,et,Et])}return W},e.browserEvents.bind=function(t,n,o,r){var a=function(nt){o?r.call(o,nt):r(nt)},h=[];if(e.utils.global.PointerEvent&&n in e.Touch.TOUCH_MAP)for(var L,R=0;L=e.Touch.TOUCH_MAP[n][R];R++)t.addEventListener(L,a,!1),h.push([t,L,a]);else if(t.addEventListener(n,a,!1),h.push([t,n,a]),n in e.Touch.TOUCH_MAP){var W=function(nt){if(nt.changedTouches&&1==nt.changedTouches.length){var et=nt.changedTouches[0];nt.clientX=et.clientX,nt.clientY=et.clientY}a(nt),nt.preventDefault()};for(R=0;L=e.Touch.TOUCH_MAP[n][R];R++)t.addEventListener(L,W,!1),h.push([t,L,W])}return h},e.browserEvents.unbind=function(t){for(;t.length;){var n=t.pop(),o=n[2];n[0].removeEventListener(n[1],o,!1)}return o},e.ComponentManager=function(){this.componentData_=Object.create(null),this.capabilityToComponentIds_=Object.create(null)},e.ComponentManager.prototype.addComponent=function(t,n){var o=t.component.id;if(!n&&this.componentData_[o])throw Error('Plugin "'+o+'" with capabilities "'+this.componentData_[o].capabilities+'" already added.');this.componentData_[o]=t,n=[];for(var r=0;r<t.capabilities.length;r++){var a=String(t.capabilities[r]).toLowerCase();n.push(a),void 0===this.capabilityToComponentIds_[a]?this.capabilityToComponentIds_[a]=[o]:this.capabilityToComponentIds_[a].push(o)}this.componentData_[o].capabilities=n},e.ComponentManager.prototype.removeComponent=function(t){var n=this.componentData_[t];if(n){for(var o=0;o<n.capabilities.length;o++){var r=String(n.capabilities[o]).toLowerCase();this.capabilityToComponentIds_[r].splice(this.capabilityToComponentIds_[r].indexOf(t),1)}delete this.componentData_[t]}},e.ComponentManager.prototype.addCapability=function(t,n){if(!this.getComponent(t))throw Error('Cannot add capability, "'+n+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,n)?console.warn('Plugin "'+t+'already has capability "'+n+'"'):(n=String(n).toLowerCase(),this.componentData_[t].capabilities.push(n),this.capabilityToComponentIds_[n].push(t))},e.ComponentManager.prototype.removeCapability=function(t,n){if(!this.getComponent(t))throw Error('Cannot remove capability, "'+n+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,n)?(n=String(n).toLowerCase(),this.componentData_[t].capabilities.splice(this.componentData_[t].capabilities.indexOf(n),1),this.capabilityToComponentIds_[n].splice(this.capabilityToComponentIds_[n].indexOf(t),1)):console.warn('Plugin "'+t+"doesn't have capability \""+n+'" to remove')},e.ComponentManager.prototype.hasCapability=function(t,n){return n=String(n).toLowerCase(),-1!==this.componentData_[t].capabilities.indexOf(n)},e.ComponentManager.prototype.getComponent=function(t){return this.componentData_[t]&&this.componentData_[t].component},e.ComponentManager.prototype.getComponents=function(t,n){if(t=String(t).toLowerCase(),!(t=this.capabilityToComponentIds_[t]))return[];var o=[];if(n){var r=[],a=this.componentData_;t.forEach(function(h){r.push(a[h])}),r.sort(function(h,R){return h.weight-R.weight}),r.forEach(function(h){o.push(h.component)})}else a=this.componentData_,t.forEach(function(h){o.push(a[h].component)});return o},e.ComponentManager.Capability=function(t){this.name_=t},e.ComponentManager.Capability.prototype.toString=function(){return this.name_},e.ComponentManager.Capability.POSITIONABLE=new e.ComponentManager.Capability("positionable"),e.ComponentManager.Capability.DRAG_TARGET=new e.ComponentManager.Capability("drag_target"),e.ComponentManager.Capability.DELETE_AREA=new e.ComponentManager.Capability("delete_area"),e.ComponentManager.Capability.AUTOHIDEABLE=new e.ComponentManager.Capability("autohideable"),e.utils.Svg=function(t){this.tagName_=t},e.utils.Svg.prototype.toString=function(){return this.tagName_},e.utils.Svg.ANIMATE=new e.utils.Svg("animate"),e.utils.Svg.CIRCLE=new e.utils.Svg("circle"),e.utils.Svg.CLIPPATH=new e.utils.Svg("clipPath"),e.utils.Svg.DEFS=new e.utils.Svg("defs"),e.utils.Svg.FECOMPOSITE=new e.utils.Svg("feComposite"),e.utils.Svg.FECOMPONENTTRANSFER=new e.utils.Svg("feComponentTransfer"),e.utils.Svg.FEFLOOD=new e.utils.Svg("feFlood"),e.utils.Svg.FEFUNCA=new e.utils.Svg("feFuncA"),e.utils.Svg.FEGAUSSIANBLUR=new e.utils.Svg("feGaussianBlur"),e.utils.Svg.FEPOINTLIGHT=new e.utils.Svg("fePointLight"),e.utils.Svg.FESPECULARLIGHTING=new e.utils.Svg("feSpecularLighting"),e.utils.Svg.FILTER=new e.utils.Svg("filter"),e.utils.Svg.FOREIGNOBJECT=new e.utils.Svg("foreignObject"),e.utils.Svg.G=new e.utils.Svg("g"),e.utils.Svg.IMAGE=new e.utils.Svg("image"),e.utils.Svg.LINE=new e.utils.Svg("line"),e.utils.Svg.PATH=new e.utils.Svg("path"),e.utils.Svg.PATTERN=new e.utils.Svg("pattern"),e.utils.Svg.POLYGON=new e.utils.Svg("polygon"),e.utils.Svg.RECT=new e.utils.Svg("rect"),e.utils.Svg.SVG=new e.utils.Svg("svg"),e.utils.Svg.TEXT=new e.utils.Svg("text"),e.utils.Svg.TSPAN=new e.utils.Svg("tspan"),e.utils.dom={},e.utils.dom.SVG_NS="http://www.w3.org/2000/svg",e.utils.dom.HTML_NS="http://www.w3.org/1999/xhtml",e.utils.dom.XLINK_NS="http://www.w3.org/1999/xlink",e.utils.dom.NodeType={ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8,DOCUMENT_POSITION_CONTAINED_BY:16},e.utils.dom.cacheWidths_=null,e.utils.dom.cacheReference_=0,e.utils.dom.canvasContext_=null,e.utils.dom.createSvgElement=function(t,n,o){for(var r in t=document.createElementNS(e.utils.dom.SVG_NS,String(t)),n)t.setAttribute(r,n[r]);return document.body.runtimeStyle&&(t.runtimeStyle=t.currentStyle=t.style),o&&o.appendChild(t),t},e.utils.dom.addClass=function(t,n){var o=t.getAttribute("class")||"";return-1==(" "+o+" ").indexOf(" "+n+" ")&&(o&&(o+=" "),t.setAttribute("class",o+n),!0)},e.utils.dom.removeClasses=function(t,n){n=n.split(" ");for(var o=0;o<n.length;o++)e.utils.dom.removeClass(t,n[o])},e.utils.dom.removeClass=function(t,n){var o=t.getAttribute("class");if(-1==(" "+o+" ").indexOf(" "+n+" "))return!1;o=o.split(/\s+/);for(var r=0;r<o.length;r++)o[r]&&o[r]!=n||(o.splice(r,1),r--);return o.length?t.setAttribute("class",o.join(" ")):t.removeAttribute("class"),!0},e.utils.dom.hasClass=function(t,n){return-1!=(" "+t.getAttribute("class")+" ").indexOf(" "+n+" ")},e.utils.dom.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},e.utils.dom.insertAfter=function(t,n){var o=n.nextSibling;if(!(n=n.parentNode))throw Error("Reference node has no parent.");o?n.insertBefore(t,o):n.appendChild(t)},e.utils.dom.containsNode=function(t,n){return!!(t.compareDocumentPosition(n)&e.utils.dom.NodeType.DOCUMENT_POSITION_CONTAINED_BY)},e.utils.dom.setCssTransform=function(t,n){t.style.transform=n,t.style["-webkit-transform"]=n},e.utils.dom.startTextWidthCache=function(){e.utils.dom.cacheReference_++,e.utils.dom.cacheWidths_||(e.utils.dom.cacheWidths_=Object.create(null))},e.utils.dom.stopTextWidthCache=function(){e.utils.dom.cacheReference_--,e.utils.dom.cacheReference_||(e.utils.dom.cacheWidths_=null)},e.utils.dom.getTextWidth=function(t){var o,n=t.textContent+"\n"+t.className.baseVal;if(e.utils.dom.cacheWidths_&&(o=e.utils.dom.cacheWidths_[n]))return o;try{o=e.utils.userAgent.IE||e.utils.userAgent.EDGE?t.getBBox().width:t.getComputedTextLength()}catch(r){return 8*t.textContent.length}return e.utils.dom.cacheWidths_&&(e.utils.dom.cacheWidths_[n]=o),o},e.utils.dom.getFastTextWidth=function(t,n,o,r){return e.utils.dom.getFastTextWidthWithSizeString(t,n+"pt",o,r)},e.utils.dom.getFastTextWidthWithSizeString=function(t,n,o,r){var h,a=t.textContent;return t=a+"\n"+t.className.baseVal,e.utils.dom.cacheWidths_&&(h=e.utils.dom.cacheWidths_[t])||(e.utils.dom.canvasContext_||((h=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(h),e.utils.dom.canvasContext_=h.getContext("2d")),e.utils.dom.canvasContext_.font=o+" "+n+" "+r,h=e.utils.dom.canvasContext_.measureText(a).width,e.utils.dom.cacheWidths_&&(e.utils.dom.cacheWidths_[t]=h)),h},e.utils.dom.measureFontMetrics=function(t,n,o,r){var a=document.createElement("span");a.style.font=o+" "+n+" "+r,a.textContent=t,(t=document.createElement("div")).style.width="1px",t.style.height="0px",(n=document.createElement("div")).setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),n.appendChild(a),n.appendChild(t),document.body.appendChild(n);try{o={},n.style.alignItems="baseline",o.baseline=t.offsetTop-a.offsetTop,n.style.alignItems="flex-end",o.height=t.offsetTop-a.offsetTop}finally{document.body.removeChild(n)}return o},e.utils.math={},e.utils.math.toRadians=function(t){return t*Math.PI/180},e.utils.math.toDegrees=function(t){return 180*t/Math.PI},e.utils.math.clamp=function(t,n,o){if(o<t){var r=o;o=t,t=r}return Math.max(t,Math.min(n,o))},e.DropDownDiv=function(){},e.DropDownDiv.boundsElement_=null,e.DropDownDiv.owner_=null,e.DropDownDiv.positionToField_=null,e.DropDownDiv.ARROW_SIZE=16,e.DropDownDiv.BORDER_SIZE=1,e.DropDownDiv.ARROW_HORIZONTAL_PADDING=12,e.DropDownDiv.PADDING_Y=16,e.DropDownDiv.ANIMATION_TIME=.25,e.DropDownDiv.animateOutTimer_=null,e.DropDownDiv.onHide_=null,e.DropDownDiv.rendererClassName_="",e.DropDownDiv.themeClassName_="",e.DropDownDiv.createDom=function(){if(!e.DropDownDiv.DIV_){var t=document.createElement("div");t.className="blocklyDropDownDiv",(e.parentContainer||document.body).appendChild(t),e.DropDownDiv.DIV_=t;var n=document.createElement("div");n.className="blocklyDropDownContent",t.appendChild(n),e.DropDownDiv.content_=n,(n=document.createElement("div")).className="blocklyDropDownArrow",t.appendChild(n),e.DropDownDiv.arrow_=n,e.DropDownDiv.DIV_.style.opacity=0,e.DropDownDiv.DIV_.style.transition="transform "+e.DropDownDiv.ANIMATION_TIME+"s, opacity "+e.DropDownDiv.ANIMATION_TIME+"s",t.addEventListener("focusin",function(){e.utils.dom.addClass(t,"blocklyFocused")}),t.addEventListener("focusout",function(){e.utils.dom.removeClass(t,"blocklyFocused")})}},e.DropDownDiv.setBoundsElement=function(t){e.DropDownDiv.boundsElement_=t},e.DropDownDiv.getContentDiv=function(){return e.DropDownDiv.content_},e.DropDownDiv.clearContent=function(){e.DropDownDiv.content_.textContent="",e.DropDownDiv.content_.style.width=""},e.DropDownDiv.setColour=function(t,n){e.DropDownDiv.DIV_.style.backgroundColor=t,e.DropDownDiv.DIV_.style.borderColor=n},e.DropDownDiv.showPositionedByBlock=function(t,n,o,r){return e.DropDownDiv.showPositionedByRect_(e.DropDownDiv.getScaledBboxOfBlock_(n),t,o,r)},e.DropDownDiv.showPositionedByField=function(t,n,o){return e.DropDownDiv.positionToField_=!0,e.DropDownDiv.showPositionedByRect_(e.DropDownDiv.getScaledBboxOfField_(t),t,n,o)},e.DropDownDiv.getScaledBboxOfBlock_=function(t){var n=t.getSvgRoot(),o=n.getBBox(),r=t.workspace.scale;return t=o.height*r,o=o.width*r,n=e.utils.style.getPageOffset(n),new e.utils.Rect(n.y,n.y+t,n.x,n.x+o)},e.DropDownDiv.getScaledBboxOfField_=function(t){return t=t.getScaledBBox(),new e.utils.Rect(t.top,t.bottom,t.left,t.right)},e.DropDownDiv.showPositionedByRect_=function(t,n,o,r){var a=t.left+(t.right-t.left)/2,h=t.bottom;t=t.top,r&&(t+=r);for(var R=(r=n.getSourceBlock()).workspace;R.options.parentWorkspace;)R=R.options.parentWorkspace;return e.DropDownDiv.setBoundsElement(R.getParentSvg().parentNode),e.DropDownDiv.show(n,r.RTL,a,h,a,t,o)},e.DropDownDiv.show=function(t,n,o,r,a,h,R){return e.DropDownDiv.owner_=t,e.DropDownDiv.onHide_=R||null,(t=e.DropDownDiv.DIV_).style.direction=n?"rtl":"ltr",n=e.getMainWorkspace(),e.DropDownDiv.rendererClassName_=n.getRenderer().getClassName(),e.DropDownDiv.themeClassName_=n.getTheme().getClassName(),e.utils.dom.addClass(t,e.DropDownDiv.rendererClassName_),e.utils.dom.addClass(t,e.DropDownDiv.themeClassName_),e.DropDownDiv.positionInternal_(o,r,a,h)},e.DropDownDiv.getBoundsInfo_=function(){var t=e.utils.style.getPageOffset(e.DropDownDiv.boundsElement_),n=e.utils.style.getSize(e.DropDownDiv.boundsElement_);return{left:t.x,right:t.x+n.width,top:t.y,bottom:t.y+n.height,width:n.width,height:n.height}},e.DropDownDiv.getPositionMetrics_=function(t,n,o,r){var a=e.DropDownDiv.getBoundsInfo_(),h=e.utils.style.getSize(e.DropDownDiv.DIV_);return n+h.height<a.bottom?e.DropDownDiv.getPositionBelowMetrics_(t,n,a,h):r-h.height>a.top?e.DropDownDiv.getPositionAboveMetrics_(o,r,a,h):n+h.height<document.documentElement.clientHeight?e.DropDownDiv.getPositionBelowMetrics_(t,n,a,h):r-h.height>document.documentElement.clientTop?e.DropDownDiv.getPositionAboveMetrics_(o,r,a,h):e.DropDownDiv.getPositionTopOfPageMetrics_(t,a,h)},e.DropDownDiv.getPositionBelowMetrics_=function(t,n,o,r){return{initialX:(t=e.DropDownDiv.getPositionX(t,o.left,o.right,r.width)).divX,initialY:n,finalX:t.divX,finalY:n+e.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:-(e.DropDownDiv.ARROW_SIZE/2+e.DropDownDiv.BORDER_SIZE),arrowAtTop:!0,arrowVisible:!0}},e.DropDownDiv.getPositionAboveMetrics_=function(t,n,o,r){return{initialX:(t=e.DropDownDiv.getPositionX(t,o.left,o.right,r.width)).divX,initialY:n-r.height,finalX:t.divX,finalY:n-r.height-e.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:r.height-2*e.DropDownDiv.BORDER_SIZE-e.DropDownDiv.ARROW_SIZE/2,arrowAtTop:!1,arrowVisible:!0}},e.DropDownDiv.getPositionTopOfPageMetrics_=function(t,n,o){return{initialX:(t=e.DropDownDiv.getPositionX(t,n.left,n.right,o.width)).divX,initialY:0,finalX:t.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},e.DropDownDiv.getPositionX=function(t,n,o,r){var a=t;return t=e.utils.math.clamp(n,t-r/2,o-r),{arrowX:r=e.utils.math.clamp(n=e.DropDownDiv.ARROW_HORIZONTAL_PADDING,(a-=e.DropDownDiv.ARROW_SIZE/2)-t,r-n-e.DropDownDiv.ARROW_SIZE),divX:t}},e.DropDownDiv.isVisible=function(){return!!e.DropDownDiv.owner_},e.DropDownDiv.hideIfOwner=function(t,n){return e.DropDownDiv.owner_===t&&(n?e.DropDownDiv.hideWithoutAnimation():e.DropDownDiv.hide(),!0)},e.DropDownDiv.hide=function(){var t=e.DropDownDiv.DIV_;t.style.transform="translate(0, 0)",t.style.opacity=0,e.DropDownDiv.animateOutTimer_=setTimeout(function(){e.DropDownDiv.hideWithoutAnimation()},1e3*e.DropDownDiv.ANIMATION_TIME),e.DropDownDiv.onHide_&&(e.DropDownDiv.onHide_(),e.DropDownDiv.onHide_=null)},e.DropDownDiv.hideWithoutAnimation=function(){if(e.DropDownDiv.isVisible()){e.DropDownDiv.animateOutTimer_&&clearTimeout(e.DropDownDiv.animateOutTimer_);var t=e.DropDownDiv.DIV_;t.style.transform="",t.style.left="",t.style.top="",t.style.opacity=0,t.style.display="none",t.style.backgroundColor="",t.style.borderColor="",e.DropDownDiv.onHide_&&(e.DropDownDiv.onHide_(),e.DropDownDiv.onHide_=null),e.DropDownDiv.clearContent(),e.DropDownDiv.owner_=null,e.DropDownDiv.rendererClassName_&&(e.utils.dom.removeClass(t,e.DropDownDiv.rendererClassName_),e.DropDownDiv.rendererClassName_=""),e.DropDownDiv.themeClassName_&&(e.utils.dom.removeClass(t,e.DropDownDiv.themeClassName_),e.DropDownDiv.themeClassName_=""),e.getMainWorkspace().markFocused()}},e.DropDownDiv.positionInternal_=function(t,n,o,r){(t=e.DropDownDiv.getPositionMetrics_(t,n,o,r)).arrowVisible?(e.DropDownDiv.arrow_.style.display="",e.DropDownDiv.arrow_.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",e.DropDownDiv.arrow_.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):e.DropDownDiv.arrow_.style.display="none",n=Math.floor(t.initialX),o=Math.floor(t.initialY),r=Math.floor(t.finalX);var a=Math.floor(t.finalY),h=e.DropDownDiv.DIV_;return h.style.left=n+"px",h.style.top=o+"px",h.style.display="block",h.style.opacity=1,h.style.transform="translate("+(r-n)+"px,"+(a-o)+"px)",!!t.arrowAtTop},e.DropDownDiv.repositionForWindowResize=function(){if(e.DropDownDiv.owner_){var t=e.DropDownDiv.owner_,n=t.getSourceBlock();t=e.DropDownDiv.positionToField_?e.DropDownDiv.getScaledBboxOfField_(t):e.DropDownDiv.getScaledBboxOfBlock_(n),e.DropDownDiv.positionInternal_(n=t.left+(t.right-t.left)/2,t.bottom,n,t.top)}else e.DropDownDiv.hide()},e.registry={},e.registry.typeMap_=Object.create(null),e.registry.DEFAULT="default",e.registry.Type=function(t){this.name_=t},e.registry.Type.prototype.toString=function(){return this.name_},e.registry.Type.CONNECTION_CHECKER=new e.registry.Type("connectionChecker"),e.registry.Type.CURSOR=new e.registry.Type("cursor"),e.registry.Type.EVENT=new e.registry.Type("event"),e.registry.Type.FIELD=new e.registry.Type("field"),e.registry.Type.RENDERER=new e.registry.Type("renderer"),e.registry.Type.TOOLBOX=new e.registry.Type("toolbox"),e.registry.Type.THEME=new e.registry.Type("theme"),e.registry.Type.TOOLBOX_ITEM=new e.registry.Type("toolboxItem"),e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX=new e.registry.Type("flyoutsVerticalToolbox"),e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX=new e.registry.Type("flyoutsHorizontalToolbox"),e.registry.Type.METRICS_MANAGER=new e.registry.Type("metricsManager"),e.registry.Type.BLOCK_DRAGGER=new e.registry.Type("blockDragger"),e.registry.register=function(t,n,o,r){if(!(t instanceof e.registry.Type)&&"string"!=typeof t||""==String(t).trim())throw Error('Invalid type "'+t+'". The type must be a non-empty string or a Blockly.registry.Type.');if(t=String(t).toLowerCase(),"string"!=typeof n||""==n.trim())throw Error('Invalid name "'+n+'". The name must be a non-empty string.');if(n=n.toLowerCase(),!o)throw Error("Can not register a null value");var a=e.registry.typeMap_[t];if(a||(a=e.registry.typeMap_[t]=Object.create(null)),e.registry.validate_(t,o),!r&&a[n])throw Error('Name "'+n+'" with type "'+t+'" already registered.');a[n]=o},e.registry.validate_=function(t,n){if(t===String(e.registry.Type.FIELD)&&"function"!=typeof n.fromJson)throw Error('Type "'+t+'" must have a fromJson function')},e.registry.unregister=function(t,n){t=String(t).toLowerCase(),n=n.toLowerCase();var o=e.registry.typeMap_[t];o&&o[n]?delete e.registry.typeMap_[t][n]:console.warn("Unable to unregister ["+n+"]["+t+"] from the registry.")},e.registry.getItem_=function(t,n,o){t=String(t).toLowerCase(),n=n.toLowerCase();var r=e.registry.typeMap_[t];if(!r||!r[n]){if(n="Unable to find ["+n+"]["+t+"] in the registry.",o)throw Error(n+" You must require or register a "+t+" plugin.");return console.warn(n),null}return r[n]},e.registry.hasItem=function(t,n){return t=String(t).toLowerCase(),n=n.toLowerCase(),!!(t=e.registry.typeMap_[t])&&!!t[n]},e.registry.getClass=function(t,n,o){return e.registry.getItem_(t,n,o)},e.registry.getObject=function(t,n,o){return e.registry.getItem_(t,n,o)},e.registry.getClassFromOptions=function(t,n,o){return"function"==typeof(n=n.plugins[t.toString()]||e.registry.DEFAULT)?n:e.registry.getClass(t,n,o)},e.Events={},e.Events.group_="",e.Events.recordUndo=!0,e.Events.disabled_=0,e.Events.CREATE="create",e.Events.BLOCK_CREATE=e.Events.CREATE,e.Events.DELETE="delete",e.Events.BLOCK_DELETE=e.Events.DELETE,e.Events.CHANGE="change",e.Events.BLOCK_CHANGE=e.Events.CHANGE,e.Events.MOVE="move",e.Events.BLOCK_MOVE=e.Events.MOVE,e.Events.VAR_CREATE="var_create",e.Events.VAR_DELETE="var_delete",e.Events.VAR_RENAME="var_rename",e.Events.UI="ui",e.Events.BLOCK_DRAG="drag",e.Events.SELECTED="selected",e.Events.CLICK="click",e.Events.MARKER_MOVE="marker_move",e.Events.BUBBLE_OPEN="bubble_open",e.Events.TRASHCAN_OPEN="trashcan_open",e.Events.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.Events.THEME_CHANGE="theme_change",e.Events.VIEWPORT_CHANGE="viewport_change",e.Events.COMMENT_CREATE="comment_create",e.Events.COMMENT_DELETE="comment_delete",e.Events.COMMENT_CHANGE="comment_change",e.Events.COMMENT_MOVE="comment_move",e.Events.FINISHED_LOADING="finished_loading",e.Events.BUMP_EVENTS=[e.Events.BLOCK_CREATE,e.Events.BLOCK_MOVE,e.Events.COMMENT_CREATE,e.Events.COMMENT_MOVE],e.Events.FIRE_QUEUE_=[],e.Events.fire=function(t){e.Events.isEnabled()&&(e.Events.FIRE_QUEUE_.length||setTimeout(e.Events.fireNow_,0),e.Events.FIRE_QUEUE_.push(t))},e.Events.fireNow_=function(){for(var o,t=e.Events.filter(e.Events.FIRE_QUEUE_,!0),n=e.Events.FIRE_QUEUE_.length=0;o=t[n];n++)if(o.workspaceId){var r=e.Workspace.getById(o.workspaceId);r&&r.fireChangeListener(o)}},e.Events.filter=function(t,n){t=t.slice(),n||t.reverse();for(var h,o=[],r=Object.create(null),a=0;h=t[a];a++)if(!h.isNull()){var R=[h.isUiEvent?e.Events.UI:h.type,h.blockId,h.workspaceId].join(" "),L=r[R],W=L?L.event:null;L?h.type==e.Events.MOVE&&L.index==a-1?(W.newParentId=h.newParentId,W.newInputName=h.newInputName,W.newCoordinate=h.newCoordinate,L.index=a):h.type==e.Events.CHANGE&&h.element==W.element&&h.name==W.name?W.newValue=h.newValue:h.type==e.Events.VIEWPORT_CHANGE?(W.viewTop=h.viewTop,W.viewLeft=h.viewLeft,W.scale=h.scale,W.oldScale=h.oldScale):(h.type!=e.Events.CLICK||W.type!=e.Events.BUBBLE_OPEN)&&(r[R]={event:h,index:a},o.push(h)):(r[R]={event:h,index:a},o.push(h))}for(t=o.filter(function(nt){return!nt.isNull()}),n||t.reverse(),a=1;h=t[a];a++)h.type==e.Events.CHANGE&&"mutation"==h.element&&t.unshift(t.splice(a,1)[0]);return t},e.Events.clearPendingUndo=function(){for(var n,t=0;n=e.Events.FIRE_QUEUE_[t];t++)n.recordUndo=!1},e.Events.disable=function(){e.Events.disabled_++},e.Events.enable=function(){e.Events.disabled_--},e.Events.isEnabled=function(){return 0==e.Events.disabled_},e.Events.getGroup=function(){return e.Events.group_},e.Events.setGroup=function(t){e.Events.group_="boolean"==typeof t?t?e.utils.genUid():"":t},e.Events.getDescendantIds=function(t){var n=[];t=t.getDescendants(!1);for(var r,o=0;r=t[o];o++)n[o]=r.id;return n},e.Events.fromJson=function(t,n){var o=e.Events.get(t.type);if(!o)throw Error("Unknown event type.");return(o=new o).fromJson(t),o.workspaceId=n.id,o},e.Events.get=function(t){return e.registry.getClass(e.registry.Type.EVENT,t)},e.Events.disableOrphans=function(t){if((t.type==e.Events.MOVE||t.type==e.Events.CREATE)&&t.workspaceId){var n=e.Workspace.getById(t.workspaceId),o=n.getBlockById(t.blockId);if(o){t=e.Events.recordUndo;try{e.Events.recordUndo=!1;var r=o.getParent();if(r&&r.isEnabled()){var h,a=o.getDescendants(!1);for(n=0;h=a[n];n++)h.setEnabled(!0)}else if((o.outputConnection||o.previousConnection)&&!n.isDragging())do{o.setEnabled(!1),o=o.getNextBlock()}while(o)}finally{e.Events.recordUndo=t}}}},e.Events.Abstract=function(){this.isBlank=null,this.workspaceId=void 0,this.group=e.Events.getGroup(),this.recordUndo=e.Events.recordUndo},e.Events.Abstract.prototype.isUiEvent=!1,e.Events.Abstract.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),t},e.Events.Abstract.prototype.fromJson=function(t){this.isBlank=!1,this.group=t.group},e.Events.Abstract.prototype.isNull=function(){return!1},e.Events.Abstract.prototype.run=function(t){},e.Events.Abstract.prototype.getEventWorkspace_=function(){if(this.workspaceId)var t=e.Workspace.getById(this.workspaceId);if(!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t},e.utils.object={},e.utils.object.inherits=function(t,n){t.superClass_=n.prototype,t.prototype=Object.create(n.prototype),t.prototype.constructor=t},e.utils.object.mixin=function(t,n){for(var o in n)t[o]=n[o]},e.utils.object.deepMerge=function(t,n){for(var o in n)t[o]=null!=n[o]&&"object"==typeof n[o]?e.utils.object.deepMerge(t[o]||Object.create(null),n[o]):n[o];return t},e.utils.object.values=function(t){return Object.values?Object.values(t):Object.keys(t).map(function(n){return t[n]})},e.utils.xml={},e.utils.xml.NAME_SPACE="https://developers.google.com/blockly/xml",e.utils.xml.document=function(){return document},e.utils.xml.createElement=function(t){return e.utils.xml.document().createElementNS(e.utils.xml.NAME_SPACE,t)},e.utils.xml.createTextNode=function(t){return e.utils.xml.document().createTextNode(t)},e.utils.xml.textToDomDocument=function(t){return(new DOMParser).parseFromString(t,"text/xml")},e.utils.xml.domToText=function(t){return(new XMLSerializer).serializeToString(t)},e.inputTypes={VALUE:e.connectionTypes.INPUT_VALUE,STATEMENT:e.connectionTypes.NEXT_STATEMENT,DUMMY:5},e.Xml={},e.Xml.workspaceToDom=function(t,n){var o=e.utils.xml.createElement("xml"),r=e.Xml.variablesToDom(e.Variables.allUsedVarModels(t));r.hasChildNodes()&&o.appendChild(r);var h,a=t.getTopComments(!0);for(r=0;h=a[r];r++)o.appendChild(h.toXmlWithXY(n));for(t=t.getTopBlocks(!0),r=0;a=t[r];r++)o.appendChild(e.Xml.blockToDomWithXY(a,n));return o},e.Xml.variablesToDom=function(t){for(var r,n=e.utils.xml.createElement("variables"),o=0;r=t[o];o++){var a=e.utils.xml.createElement("variable");a.appendChild(e.utils.xml.createTextNode(r.name)),r.type&&a.setAttribute("type",r.type),a.id=r.getId(),n.appendChild(a)}return n},e.Xml.blockToDomWithXY=function(t,n){if(t.isInsertionMarker()&&!(t=t.getChildren(!1)[0]))return new DocumentFragment;var o;t.workspace.RTL&&(o=t.workspace.getWidth()),n=e.Xml.blockToDom(t,n);var r=t.getRelativeToSurfaceXY();return n.setAttribute("x",Math.round(t.workspace.RTL?o-r.x:r.x)),n.setAttribute("y",Math.round(r.y)),n},e.Xml.fieldToDom_=function(t){if(t.isSerializable()){var n=e.utils.xml.createElement("field");return n.setAttribute("name",t.name||""),t.toXml(n)}return null},e.Xml.allFieldsToDom_=function(t,n){for(var r,o=0;r=t.inputList[o];o++)for(var h,a=0;h=r.fieldRow[a];a++)(h=e.Xml.fieldToDom_(h))&&n.appendChild(h)},e.Xml.blockToDom=function(t,n){if(t.isInsertionMarker())return(t=t.getChildren(!1)[0])?e.Xml.blockToDom(t):new DocumentFragment;var o=e.utils.xml.createElement(t.isShadow()?"shadow":"block");if(o.setAttribute("type",t.type),n||o.setAttribute("id",t.id),t.mutationToDom){var r=t.mutationToDom();r&&(r.hasChildNodes()||r.hasAttributes())&&o.appendChild(r)}if(e.Xml.allFieldsToDom_(t,o),r=t.getCommentText()){var a=t.commentModel.size,h=t.commentModel.pinned,R=e.utils.xml.createElement("comment");R.appendChild(e.utils.xml.createTextNode(r)),R.setAttribute("pinned",h),R.setAttribute("h",a.height),R.setAttribute("w",a.width),o.appendChild(R)}for(t.data&&((r=e.utils.xml.createElement("data")).appendChild(e.utils.xml.createTextNode(t.data)),o.appendChild(r)),r=0;a=t.inputList[r];r++){var L;if(h=!0,a.type!=e.inputTypes.DUMMY){var W=a.connection.targetBlock();a.type==e.inputTypes.VALUE?L=e.utils.xml.createElement("value"):a.type==e.inputTypes.STATEMENT&&(L=e.utils.xml.createElement("statement")),!(R=a.connection.getShadowDom())||W&&W.isShadow()||L.appendChild(e.Xml.cloneShadow_(R,n)),W&&(R=e.Xml.blockToDom(W,n)).nodeType==e.utils.dom.NodeType.ELEMENT_NODE&&(L.appendChild(R),h=!1),L.setAttribute("name",a.name),h||o.appendChild(L)}}return null!=t.inputsInline&&t.inputsInline!=t.inputsInlineDefault&&o.setAttribute("inline",t.inputsInline),t.isCollapsed()&&o.setAttribute("collapsed",!0),t.isEnabled()||o.setAttribute("disabled",!0),t.isDeletable()||t.isShadow()||o.setAttribute("deletable",!1),t.isMovable()||t.isShadow()||o.setAttribute("movable",!1),t.isEditable()||o.setAttribute("editable",!1),(r=t.getNextBlock())&&(R=e.Xml.blockToDom(r,n)).nodeType==e.utils.dom.NodeType.ELEMENT_NODE&&((L=e.utils.xml.createElement("next")).appendChild(R),o.appendChild(L)),!(R=t.nextConnection&&t.nextConnection.getShadowDom())||r&&r.isShadow()||L.appendChild(e.Xml.cloneShadow_(R,n)),o},e.Xml.cloneShadow_=function(t,n){for(var r,o=t=t.cloneNode(!0);o;)if(n&&"shadow"==o.nodeName&&o.removeAttribute("id"),o.firstChild)o=o.firstChild;else{for(;o&&!o.nextSibling;)r=o,o=o.parentNode,r.nodeType==e.utils.dom.NodeType.TEXT_NODE&&""==r.data.trim()&&o.firstChild!=r&&e.utils.dom.removeNode(r);o&&(r=o,o=o.nextSibling,r.nodeType==e.utils.dom.NodeType.TEXT_NODE&&""==r.data.trim()&&e.utils.dom.removeNode(r))}return t},e.Xml.domToText=function(t){return e.utils.xml.domToText(t).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},e.Xml.domToPrettyText=function(t){t=e.Xml.domToText(t).split("<");for(var n="",o=1;o<t.length;o++){var r=t[o];"/"==r[0]&&(n=n.substring(2)),t[o]=n+"<"+r,"/"!=r[0]&&"/>"!=r.slice(-2)&&(n+="  ")}return(t=(t=t.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},e.Xml.textToDom=function(t){var n=e.utils.xml.textToDomDocument(t);if(!n||!n.documentElement||n.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+t);return n.documentElement},e.Xml.clearWorkspaceAndLoadFromXml=function(t,n){return n.setResizesEnabled(!1),n.clear(),t=e.Xml.domToWorkspace(t,n),n.setResizesEnabled(!0),t},e.Xml.domToWorkspace=function(t,n){if(t instanceof e.Workspace){var o=t;t=n,n=o,console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var r;n.RTL&&(r=n.getWidth()),o=[],e.utils.dom.startTextWidthCache();var a=e.Events.getGroup();a||e.Events.setGroup(!0),n.setResizesEnabled&&n.setResizesEnabled(!1);var h=!0;try{for(var L,R=0;L=t.childNodes[R];R++){var W=L.nodeName.toLowerCase(),nt=L;if("block"==W||"shadow"==W&&!e.Events.recordUndo){var et=e.Xml.domToBlock(nt,n);o.push(et.id);var Et=nt.hasAttribute("x")?parseInt(nt.getAttribute("x"),10):10,It=nt.hasAttribute("y")?parseInt(nt.getAttribute("y"),10):10;isNaN(Et)||isNaN(It)||et.moveBy(n.RTL?r-Et:Et,It),h=!1}else{if("shadow"==W)throw TypeError("Shadow block cannot be a top-level block.");if("comment"==W)n.rendered?e.WorkspaceCommentSvg?e.WorkspaceCommentSvg.fromXml(nt,n,r):console.warn("Missing require for Blockly.WorkspaceCommentSvg, ignoring workspace comment."):e.WorkspaceComment?e.WorkspaceComment.fromXml(nt,n):console.warn("Missing require for Blockly.WorkspaceComment, ignoring workspace comment.");else if("variables"==W){if(!h)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");e.Xml.domToVariables(nt,n),h=!1}}}}finally{a||e.Events.setGroup(!1),e.utils.dom.stopTextWidthCache()}return n.setResizesEnabled&&n.setResizesEnabled(!0),e.Events.fire(new(e.Events.get(e.Events.FINISHED_LOADING))(n)),o},e.Xml.appendDomToWorkspace=function(t,n){var o;if(Object.prototype.hasOwnProperty.call(n,"scale")&&(o=n.getBlocksBoundingBox()),t=e.Xml.domToWorkspace(t,n),o&&o.top!=o.bottom){var r=o.bottom,a=n.RTL?o.right:o.left,h=1/0,R=-1/0,L=1/0;for(o=0;o<t.length;o++){var W=n.getBlockById(t[o]).getRelativeToSurfaceXY();W.y<L&&(L=W.y),W.x<h&&(h=W.x),W.x>R&&(R=W.x)}for(r=r-L+10,a=n.RTL?a-R:a-h,o=0;o<t.length;o++)n.getBlockById(t[o]).moveBy(a,r)}return t},e.Xml.domToBlock=function(t,n){if(t instanceof e.Workspace){var o=t;t=n,n=o,console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}e.Events.disable(),o=n.getAllVariables();try{var r=e.Xml.domToBlockHeadless_(t,n),a=r.getDescendants(!1);if(n.rendered){r.setConnectionTracking(!1);for(var h=a.length-1;0<=h;h--)a[h].initSvg();for(h=a.length-1;0<=h;h--)a[h].render(!1);setTimeout(function(){r.disposed||r.setConnectionTracking(!0)},1),r.updateDisabled(),n.resizeContents()}else for(h=a.length-1;0<=h;h--)a[h].initModel()}finally{e.Events.enable()}if(e.Events.isEnabled()){for(t=e.Variables.getAddedVariables(n,o),h=0;h<t.length;h++)n=t[h],e.Events.fire(new(e.Events.get(e.Events.VAR_CREATE))(n));e.Events.fire(new(e.Events.get(e.Events.CREATE))(r))}return r},e.Xml.domToVariables=function(t,n){for(var r,o=0;r=t.childNodes[o];o++)if(r.nodeType==e.utils.dom.NodeType.ELEMENT_NODE){var a=r.getAttribute("type"),h=r.getAttribute("id");n.createVariable(r.textContent,a,h)}},e.Xml.mapSupportedXmlTags_=function(t){for(var r,n={mutation:[],comment:[],data:[],field:[],input:[],next:[]},o=0;r=t.childNodes[o];o++)if(r.nodeType!=e.utils.dom.NodeType.TEXT_NODE)switch(r.nodeName.toLowerCase()){case"mutation":n.mutation.push(r);break;case"comment":if(!e.Comment){console.warn("Missing require for Blockly.Comment, ignoring block comment.");break}n.comment.push(r);break;case"data":n.data.push(r);break;case"title":case"field":n.field.push(r);break;case"value":case"statement":n.input.push(r);break;case"next":n.next.push(r);break;default:console.warn("Ignoring unknown tag: "+r.nodeName)}return n},e.Xml.applyMutationTagNodes_=function(t,n){for(var a,o=!1,r=0;a=t[r];r++)n.domToMutation&&(n.domToMutation(a),n.initSvg&&(o=!0));return o},e.Xml.applyCommentTagNodes_=function(t,n){for(var r,o=0;r=t[o];o++){var a=r.textContent,h="true"==r.getAttribute("pinned"),R=parseInt(r.getAttribute("w"),10);r=parseInt(r.getAttribute("h"),10),n.setCommentText(a),n.commentModel.pinned=h,isNaN(R)||isNaN(r)||(n.commentModel.size=new e.utils.Size(R,r)),h&&n.getCommentIcon&&!n.isInFlyout&&setTimeout(function(){n.getCommentIcon().setVisible(!0)},1)}},e.Xml.applyDataTagNodes_=function(t,n){for(var r,o=0;r=t[o];o++)n.data=r.textContent},e.Xml.applyFieldTagNodes_=function(t,n){for(var r,o=0;r=t[o];o++){var a=r.getAttribute("name");e.Xml.domToField_(n,a,r)}},e.Xml.findChildBlocks_=function(t){for(var r,n={childBlockElement:null,childShadowElement:null},o=0;r=t.childNodes[o];o++)r.nodeType==e.utils.dom.NodeType.ELEMENT_NODE&&("block"==r.nodeName.toLowerCase()?n.childBlockElement=r:"shadow"==r.nodeName.toLowerCase()&&(n.childShadowElement=r));return n},e.Xml.applyInputTagNodes_=function(t,n,o,r){for(var h,a=0;h=t[a];a++){var R=h.getAttribute("name"),L=o.getInput(R);if(!L){console.warn("Ignoring non-existent input "+R+" in block "+r);break}if((h=e.Xml.findChildBlocks_(h)).childBlockElement){if(!L.connection)throw TypeError("Input connection does not exist.");e.Xml.domToBlockHeadless_(h.childBlockElement,n,L.connection,!1)}h.childShadowElement&&L.connection.setShadowDom(h.childShadowElement)}},e.Xml.applyNextTagNodes_=function(t,n,o){for(var a,r=0;a=t[r];r++){if((a=e.Xml.findChildBlocks_(a)).childBlockElement){if(!o.nextConnection)throw TypeError("Next statement does not exist.");if(o.nextConnection.isConnected())throw TypeError("Next statement is already connected.");e.Xml.domToBlockHeadless_(a.childBlockElement,n,o.nextConnection,!0)}a.childShadowElement&&o.nextConnection&&o.nextConnection.setShadowDom(a.childShadowElement)}},e.Xml.domToBlockHeadless_=function(t,n,o,r){var a=t.getAttribute("type");if(!a)throw TypeError("Block type unspecified: "+t.outerHTML);var h=t.getAttribute("id");h=n.newBlock(a,h);var R=e.Xml.mapSupportedXmlTags_(t),L=e.Xml.applyMutationTagNodes_(R.mutation,h);if(e.Xml.applyCommentTagNodes_(R.comment,h),e.Xml.applyDataTagNodes_(R.data,h),o)if(r){if(!h.previousConnection)throw TypeError("Next block does not have previous statement.");o.connect(h.previousConnection)}else if(h.outputConnection)o.connect(h.outputConnection);else{if(!h.previousConnection)throw TypeError("Child block does not have output or previous statement.");o.connect(h.previousConnection)}if(e.Xml.applyFieldTagNodes_(R.field,h),e.Xml.applyInputTagNodes_(R.input,n,h,a),e.Xml.applyNextTagNodes_(R.next,n,h),L&&h.initSvg(),(n=t.getAttribute("inline"))&&h.setInputsInline("true"==n),(n=t.getAttribute("disabled"))&&h.setEnabled("true"!=n&&"disabled"!=n),(n=t.getAttribute("deletable"))&&h.setDeletable("true"==n),(n=t.getAttribute("movable"))&&h.setMovable("true"==n),(n=t.getAttribute("editable"))&&h.setEditable("true"==n),(n=t.getAttribute("collapsed"))&&h.setCollapsed("true"==n),"shadow"==t.nodeName.toLowerCase()){for(t=h.getChildren(!1),n=0;o=t[n];n++)if(!o.isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(h.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");h.setShadow(!0)}return h},e.Xml.domToField_=function(t,n,o){var r=t.getField(n);r?r.fromXml(o):console.warn("Ignoring non-existent field "+n+" in block "+t.type)},e.Xml.deleteNext=function(t){for(var o,n=0;o=t.childNodes[n];n++)if("next"==o.nodeName.toLowerCase()){t.removeChild(o);break}},e.Events.BlockBase=function(t){e.Events.BlockBase.superClass_.constructor.call(this),this.blockId=(this.isBlank=void 0===t)?"":t.id,this.workspaceId=this.isBlank?"":t.workspace.id},e.utils.object.inherits(e.Events.BlockBase,e.Events.Abstract),e.Events.BlockBase.prototype.toJson=function(){var t=e.Events.BlockBase.superClass_.toJson.call(this);return t.blockId=this.blockId,t},e.Events.BlockBase.prototype.fromJson=function(t){e.Events.BlockBase.superClass_.fromJson.call(this,t),this.blockId=t.blockId},e.Events.BlockChange=function(t,n,o,r,a){e.Events.Change.superClass_.constructor.call(this,t),t&&(this.element=void 0===n?"":n,this.name=void 0===o?"":o,this.oldValue=void 0===r?"":r,this.newValue=void 0===a?"":a)},e.utils.object.inherits(e.Events.BlockChange,e.Events.BlockBase),e.Events.Change=e.Events.BlockChange,e.Events.BlockChange.prototype.type=e.Events.CHANGE,e.Events.BlockChange.prototype.toJson=function(){var t=e.Events.BlockChange.superClass_.toJson.call(this);return t.element=this.element,this.name&&(t.name=this.name),t.oldValue=this.oldValue,t.newValue=this.newValue,t},e.Events.BlockChange.prototype.fromJson=function(t){e.Events.BlockChange.superClass_.fromJson.call(this,t),this.element=t.element,this.name=t.name,this.oldValue=t.oldValue,this.newValue=t.newValue},e.Events.BlockChange.prototype.isNull=function(){return this.oldValue==this.newValue},e.Events.BlockChange.prototype.run=function(t){var n=this.getEventWorkspace_().getBlockById(this.blockId);if(n)switch(n.mutator&&n.mutator.setVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(n=n.getField(this.name))?n.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":n.setCommentText(t||null);break;case"collapsed":n.setCollapsed(!!t);break;case"disabled":n.setEnabled(!t);break;case"inline":n.setInputsInline(!!t);break;case"mutation":var o="";if(n.mutationToDom&&(o=(o=n.mutationToDom())&&e.Xml.domToText(o)),n.domToMutation){var r=e.Xml.textToDom(t||"<mutation/>");n.domToMutation(r)}e.Events.fire(new e.Events.BlockChange(n,"mutation",null,o,t));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existent block: "+this.blockId)},e.Events.Create=function(t){e.Events.Create.superClass_.constructor.call(this,t),t&&(t.isShadow()&&(this.recordUndo=!1),this.xml=t.workspace.rendered?e.Xml.blockToDomWithXY(t):e.Xml.blockToDom(t),this.ids=e.Events.getDescendantIds(t))},e.utils.object.inherits(e.Events.Create,e.Events.BlockBase),e.Events.BlockCreate=e.Events.Create,e.Events.Create.prototype.type=e.Events.CREATE,e.Events.Create.prototype.toJson=function(){var t=e.Events.Create.superClass_.toJson.call(this);return t.xml=e.Xml.domToText(this.xml),t.ids=this.ids,this.recordUndo||(t.recordUndo=this.recordUndo),t},e.Events.Create.prototype.fromJson=function(t){e.Events.Create.superClass_.fromJson.call(this,t),this.xml=e.Xml.textToDom(t.xml),this.ids=t.ids,void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},e.Events.Create.prototype.run=function(t){var n=this.getEventWorkspace_();if(t)(t=e.utils.xml.createElement("xml")).appendChild(this.xml),e.Xml.domToWorkspace(t,n);else{t=0;for(var o;o=this.ids[t];t++){var r=n.getBlockById(o);r?r.dispose(!1):o==this.blockId&&console.warn("Can't uncreate non-existent block: "+o)}}},e.Events.Delete=function(t){if(e.Events.Delete.superClass_.constructor.call(this,t),t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");t.isShadow()&&(this.recordUndo=!1),this.oldXml=t.workspace.rendered?e.Xml.blockToDomWithXY(t):e.Xml.blockToDom(t),this.ids=e.Events.getDescendantIds(t)}},e.utils.object.inherits(e.Events.Delete,e.Events.BlockBase),e.Events.BlockDelete=e.Events.Delete,e.Events.Delete.prototype.type=e.Events.DELETE,e.Events.Delete.prototype.toJson=function(){var t=e.Events.Delete.superClass_.toJson.call(this);return t.oldXml=e.Xml.domToText(this.oldXml),t.ids=this.ids,this.recordUndo||(t.recordUndo=this.recordUndo),t},e.Events.Delete.prototype.fromJson=function(t){e.Events.Delete.superClass_.fromJson.call(this,t),this.oldXml=e.Xml.textToDom(t.oldXml),this.ids=t.ids,void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},e.Events.Delete.prototype.run=function(t){var n=this.getEventWorkspace_();if(t){t=0;for(var o;o=this.ids[t];t++){var r=n.getBlockById(o);r?r.dispose(!1):o==this.blockId&&console.warn("Can't delete non-existent block: "+o)}}else(t=e.utils.xml.createElement("xml")).appendChild(this.oldXml),e.Xml.domToWorkspace(t,n)},e.Events.Move=function(t){e.Events.Move.superClass_.constructor.call(this,t),t&&(t.isShadow()&&(this.recordUndo=!1),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)},e.utils.object.inherits(e.Events.Move,e.Events.BlockBase),e.Events.BlockMove=e.Events.Move,e.Events.Move.prototype.type=e.Events.MOVE,e.Events.Move.prototype.toJson=function(){var t=e.Events.Move.superClass_.toJson.call(this);return this.newParentId&&(t.newParentId=this.newParentId),this.newInputName&&(t.newInputName=this.newInputName),this.newCoordinate&&(t.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),this.recordUndo||(t.recordUndo=this.recordUndo),t},e.Events.Move.prototype.fromJson=function(t){if(e.Events.Move.superClass_.fromJson.call(this,t),this.newParentId=t.newParentId,this.newInputName=t.newInputName,t.newCoordinate){var n=t.newCoordinate.split(",");this.newCoordinate=new e.utils.Coordinate(Number(n[0]),Number(n[1]))}void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},e.Events.Move.prototype.recordNew=function(){var t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate},e.Events.Move.prototype.currentLocation_=function(){var t=this.getEventWorkspace_().getBlockById(this.blockId),n={},o=t.getParent();return o?(n.parentId=o.id,(t=o.getInputWithBlock(t))&&(n.inputName=t.name)):n.coordinate=t.getRelativeToSurfaceXY(),n},e.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&e.utils.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},e.Events.Move.prototype.run=function(t){var n=this.getEventWorkspace_(),o=n.getBlockById(this.blockId);if(o){var r=t?this.newParentId:this.oldParentId,a=t?this.newInputName:this.oldInputName,h=t?this.newCoordinate:this.oldCoordinate;if(t=null,r&&!(t=n.getBlockById(r)))return void console.warn("Can't connect to non-existent block: "+r);if(o.getParent()&&o.unplug(),h)a=o.getRelativeToSurfaceXY(),o.moveBy(h.x-a.x,h.y-a.y);else{if(n=(o=o.outputConnection||o.previousConnection).type,a){if(t=t.getInput(a))var R=t.connection}else n==e.connectionTypes.PREVIOUS_STATEMENT&&(R=t.nextConnection);R?o.connect(R):console.warn("Can't connect to non-existent input: "+a)}}else console.warn("Can't move non-existent block: "+this.blockId)},e.registry.register(e.registry.Type.EVENT,e.Events.CREATE,e.Events.Create),e.registry.register(e.registry.Type.EVENT,e.Events.DELETE,e.Events.Delete),e.registry.register(e.registry.Type.EVENT,e.Events.CHANGE,e.Events.BlockChange),e.registry.register(e.registry.Type.EVENT,e.Events.MOVE,e.Events.Move),e.Events.FinishedLoading=function(t){this.isBlank=void 0===t,this.workspaceId=t?t.id:"",this.group=e.Events.getGroup(),this.recordUndo=!1},e.utils.object.inherits(e.Events.FinishedLoading,e.Events.Abstract),e.Events.FinishedLoading.prototype.type=e.Events.FINISHED_LOADING,e.Events.FinishedLoading.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),this.workspaceId&&(t.workspaceId=this.workspaceId),t},e.Events.FinishedLoading.prototype.fromJson=function(t){this.isBlank=!1,this.workspaceId=t.workspaceId,this.group=t.group},e.registry.register(e.registry.Type.EVENT,e.Events.FINISHED_LOADING,e.Events.FinishedLoading),e.Events.UiBase=function(t){e.Events.UiBase.superClass_.constructor.call(this),this.isBlank=void 0===t,this.workspaceId=t||"",this.recordUndo=!1},e.utils.object.inherits(e.Events.UiBase,e.Events.Abstract),e.Events.UiBase.prototype.isUiEvent=!0,e.Events.Ui=function(t,n,o,r){e.Events.Ui.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.element=void 0===n?"":n,this.oldValue=void 0===o?"":o,this.newValue=void 0===r?"":r},e.utils.object.inherits(e.Events.Ui,e.Events.UiBase),e.Events.Ui.prototype.type=e.Events.UI,e.Events.Ui.prototype.toJson=function(){var t=e.Events.Ui.superClass_.toJson.call(this);return t.element=this.element,void 0!==this.newValue&&(t.newValue=this.newValue),this.blockId&&(t.blockId=this.blockId),t},e.Events.Ui.prototype.fromJson=function(t){e.Events.Ui.superClass_.fromJson.call(this,t),this.element=t.element,this.newValue=t.newValue,this.blockId=t.blockId},e.registry.register(e.registry.Type.EVENT,e.Events.UI,e.Events.Ui),e.Events.VarBase=function(t){e.Events.VarBase.superClass_.constructor.call(this),this.varId=(this.isBlank=void 0===t)?"":t.getId(),this.workspaceId=this.isBlank?"":t.workspace.id},e.utils.object.inherits(e.Events.VarBase,e.Events.Abstract),e.Events.VarBase.prototype.toJson=function(){var t=e.Events.VarBase.superClass_.toJson.call(this);return t.varId=this.varId,t},e.Events.VarBase.prototype.fromJson=function(t){e.Events.VarBase.superClass_.toJson.call(this),this.varId=t.varId},e.Events.VarCreate=function(t){e.Events.VarCreate.superClass_.constructor.call(this,t),t&&(this.varType=t.type,this.varName=t.name)},e.utils.object.inherits(e.Events.VarCreate,e.Events.VarBase),e.Events.VarCreate.prototype.type=e.Events.VAR_CREATE,e.Events.VarCreate.prototype.toJson=function(){var t=e.Events.VarCreate.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},e.Events.VarCreate.prototype.fromJson=function(t){e.Events.VarCreate.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},e.Events.VarCreate.prototype.run=function(t){var n=this.getEventWorkspace_();t?n.createVariable(this.varName,this.varType,this.varId):n.deleteVariableById(this.varId)},e.Events.VarDelete=function(t){e.Events.VarDelete.superClass_.constructor.call(this,t),t&&(this.varType=t.type,this.varName=t.name)},e.utils.object.inherits(e.Events.VarDelete,e.Events.VarBase),e.Events.VarDelete.prototype.type=e.Events.VAR_DELETE,e.Events.VarDelete.prototype.toJson=function(){var t=e.Events.VarDelete.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},e.Events.VarDelete.prototype.fromJson=function(t){e.Events.VarDelete.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},e.Events.VarDelete.prototype.run=function(t){var n=this.getEventWorkspace_();t?n.deleteVariableById(this.varId):n.createVariable(this.varName,this.varType,this.varId)},e.Events.VarRename=function(t,n){e.Events.VarRename.superClass_.constructor.call(this,t),t&&(this.oldName=t.name,this.newName=void 0===n?"":n)},e.utils.object.inherits(e.Events.VarRename,e.Events.VarBase),e.Events.VarRename.prototype.type=e.Events.VAR_RENAME,e.Events.VarRename.prototype.toJson=function(){var t=e.Events.VarRename.superClass_.toJson.call(this);return t.oldName=this.oldName,t.newName=this.newName,t},e.Events.VarRename.prototype.fromJson=function(t){e.Events.VarRename.superClass_.fromJson.call(this,t),this.oldName=t.oldName,this.newName=t.newName},e.Events.VarRename.prototype.run=function(t){this.getEventWorkspace_().renameVariableById(this.varId,t?this.newName:this.oldName)},e.registry.register(e.registry.Type.EVENT,e.Events.VAR_CREATE,e.Events.VarCreate),e.registry.register(e.registry.Type.EVENT,e.Events.VAR_DELETE,e.Events.VarDelete),e.registry.register(e.registry.Type.EVENT,e.Events.VAR_RENAME,e.Events.VarRename),e.BlockDragSurfaceSvg=function(t){this.container_=t,this.createDom()},e.BlockDragSurfaceSvg.prototype.SVG_=null,e.BlockDragSurfaceSvg.prototype.dragGroup_=null,e.BlockDragSurfaceSvg.prototype.container_=null,e.BlockDragSurfaceSvg.prototype.scale_=1,e.BlockDragSurfaceSvg.prototype.surfaceXY_=null,e.BlockDragSurfaceSvg.prototype.childSurfaceXY_=new e.utils.Coordinate(0,0),e.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},this.SVG_))},e.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(t){if(this.dragGroup_.childNodes.length)throw Error("Already dragging a block.");this.dragGroup_.appendChild(t),this.SVG_.style.display="block",this.surfaceXY_=new e.utils.Coordinate(0,0)},e.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(t,n,o){this.scale_=o,t=t.toFixed(0),n=n.toFixed(0),this.childSurfaceXY_.x=parseInt(t,10),this.childSurfaceXY_.y=parseInt(n,10),this.dragGroup_.setAttribute("transform","translate("+t+","+n+") scale("+o+")")},e.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var t=this.surfaceXY_.x,n=this.surfaceXY_.y;t=t.toFixed(0),n=n.toFixed(0),this.SVG_.style.display="block",e.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+n+"px, 0px)")},e.BlockDragSurfaceSvg.prototype.translateBy=function(t,n){this.surfaceXY_=new e.utils.Coordinate(this.surfaceXY_.x+t,this.surfaceXY_.y+n),this.translateSurfaceInternal_()},e.BlockDragSurfaceSvg.prototype.translateSurface=function(t,n){this.surfaceXY_=new e.utils.Coordinate(t*this.scale_,n*this.scale_),this.translateSurfaceInternal_()},e.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var t=e.utils.getRelativeXY(this.SVG_);return new e.utils.Coordinate(t.x/this.scale_,t.y/this.scale_)},e.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},e.BlockDragSurfaceSvg.prototype.getSvgRoot=function(){return this.SVG_},e.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},e.BlockDragSurfaceSvg.prototype.getWsTranslation=function(){return this.childSurfaceXY_.clone()},e.BlockDragSurfaceSvg.prototype.clearAndHide=function(t){if(t?t.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",this.dragGroup_.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY_=null},e.Css={},e.Css.injected_=!1,e.Css.register=function(t){if(e.Css.injected_)throw Error("CSS already injected");Array.prototype.push.apply(e.Css.CONTENT,t),t.length=0},e.Css.inject=function(t,n){if(!e.Css.injected_){e.Css.injected_=!0;var o=e.Css.CONTENT.join("\n");e.Css.CONTENT.length=0,t&&(t=n.replace(/[\\/]$/,""),o=o.replace(/<<<PATH>>>/g,t),(t=document.createElement("style")).id="blockly-common-style",o=document.createTextNode(o),t.appendChild(o),document.head.insertBefore(t,document.head.firstChild))}},e.Css.CONTENT=[".blocklySvg {","background-color: #fff;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none;","}",".blocklyNonSelectable {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyBlockCanvas.blocklyCanvasTransitioning,",".blocklyBubbleCanvas.blocklyCanvasTransitioning {","transition: transform .5s;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;","font: 9pt sans-serif;","opacity: .9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: absolute;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-color: #dadce0;","background-color: #fff;","border-radius: 2px;","padding: 4px;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","overflow-x: hidden;","position: relative;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyArrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".blocklyArrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #515A5A;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPathLight {","fill: none;","stroke-linecap: round;","stroke-width: 1;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: .8;","stroke-opacity: .8;","}",".blocklyDragging>.blocklyPathDark {","display: none;","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyDisabled>.blocklyPathLight,",".blocklyDisabled>.blocklyPathDark {","display: none;","}",".blocklyInsertionMarker>.blocklyPath,",".blocklyInsertionMarker>.blocklyPathLight,",".blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: .2;","stroke: none;","}",".blocklyMultilineText {","font-family: monospace;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyText text {","cursor: default;","}",".blocklySvg text,",".blocklyBlockDragSurface text {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyHtmlInput {","border: none;","border-radius: 4px;","height: 100%;","margin: 0;","outline: none;","padding: 0;","width: 100%;","text-align: center;","display: block;","box-sizing: border-box;","}",".blocklyHtmlInput::-ms-clear {","display: none;","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: #ddd;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal,",".blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: #ccc;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyVerticalMarker {","stroke-width: 3px;","fill: rgba(255,255,255,.5);","pointer-events: none;","}",".blocklyComputeCanvas {","position: absolute;","width: 0;","height: 0;","}",".blocklyNoPointerEvents {","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","border-radius: 2px;","padding: 0 !important;","}",".blocklyDropdownMenu .blocklyMenuItem {","padding-left: 28px;","}",".blocklyDropdownMenu .blocklyMenuItemRtl {","padding-left: 5px;","padding-right: 28px;","}",".blocklyWidgetDiv .blocklyMenu {","background: #fff;","border: 1px solid transparent;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","font: normal 13px Arial, sans-serif;","margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","max-height: 100%;","z-index: 20000;","}",".blocklyWidgetDiv .blocklyMenu.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv .blocklyMenu {","background: inherit;","border: inherit;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","position: relative;","z-index: 20000;","}",".blocklyMenuItem {","border: none;","color: #000;","cursor: pointer;","list-style: none;","margin: 0;","min-width: 7em;","padding: 6px 15px;","white-space: nowrap;","}",".blocklyMenuItemDisabled {","color: #ccc;","cursor: inherit;","}",".blocklyMenuItemHighlight {","background-color: rgba(0,0,0,.1);","}",".blocklyMenuItemCheckbox {","height: 16px;","position: absolute;","width: 16px;","}",".blocklyMenuItemSelected .blocklyMenuItemCheckbox {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;","float: left;","margin-left: -24px;","position: static;","}",".blocklyMenuItemRtl .blocklyMenuItemCheckbox {","float: right;","margin-right: -24px;","}"],e.Grid=function(t,n){this.gridPattern_=t,this.spacing_=n.spacing,this.length_=n.length,this.line2_=(this.line1_=t.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=n.snap},e.Grid.prototype.scale_=1,e.Grid.prototype.dispose=function(){this.gridPattern_=null},e.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},e.Grid.prototype.getSpacing=function(){return this.spacing_},e.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},e.Grid.prototype.update=function(t){this.scale_=t;var n=this.spacing_*t||100;this.gridPattern_.setAttribute("width",n),this.gridPattern_.setAttribute("height",n);var o=(n=Math.floor(this.spacing_/2)+.5)-this.length_/2,r=n+this.length_/2;this.setLineAttributes_(this.line1_,t,o*=t,r*=t,n*=t,n),this.setLineAttributes_(this.line2_,t,n,n,o,r)},e.Grid.prototype.setLineAttributes_=function(t,n,o,r,a,h){t&&(t.setAttribute("stroke-width",n),t.setAttribute("x1",o),t.setAttribute("y1",a),t.setAttribute("x2",r),t.setAttribute("y2",h))},e.Grid.prototype.moveTo=function(t,n){this.gridPattern_.setAttribute("x",t),this.gridPattern_.setAttribute("y",n),(e.utils.userAgent.IE||e.utils.userAgent.EDGE)&&this.update(this.scale_)},e.Grid.createDom=function(t,n,o){return t=e.utils.dom.createSvgElement(e.utils.Svg.PATTERN,{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},o),0<n.length&&0<n.spacing?(e.utils.dom.createSvgElement(e.utils.Svg.LINE,{stroke:n.colour},t),1<n.length&&e.utils.dom.createSvgElement(e.utils.Svg.LINE,{stroke:n.colour},t)):e.utils.dom.createSvgElement(e.utils.Svg.LINE,{},t),t},e.Theme=function(t,n,o,r){this.name=t,this.blockStyles=n||Object.create(null),this.categoryStyles=o||Object.create(null),this.componentStyles=r||Object.create(null),this.fontStyle=Object.create(null),this.startHats=null,e.registry.register(e.registry.Type.THEME,t,this)},e.Theme.prototype.getClassName=function(){return this.name+"-theme"},e.Theme.prototype.setBlockStyle=function(t,n){this.blockStyles[t]=n},e.Theme.prototype.setCategoryStyle=function(t,n){this.categoryStyles[t]=n},e.Theme.prototype.getComponentStyle=function(t){return(t=this.componentStyles[t])&&"string"==typeof t&&this.getComponentStyle(t)?this.getComponentStyle(t):t?String(t):null},e.Theme.prototype.setComponentStyle=function(t,n){this.componentStyles[t]=n},e.Theme.prototype.setFontStyle=function(t){this.fontStyle=t},e.Theme.prototype.setStartHats=function(t){this.startHats=t},e.Theme.defineTheme=function(t,n){var o=new e.Theme(t),r=n.base;return r&&("string"==typeof r&&(r=e.registry.getObject(e.registry.Type.THEME,r)),r instanceof e.Theme&&(e.utils.object.deepMerge(o,r),o.name=t)),e.utils.object.deepMerge(o.blockStyles,n.blockStyles),e.utils.object.deepMerge(o.categoryStyles,n.categoryStyles),e.utils.object.deepMerge(o.componentStyles,n.componentStyles),e.utils.object.deepMerge(o.fontStyle,n.fontStyle),null!=n.startHats&&(o.startHats=n.startHats),o},e.Themes={},e.Themes.Classic={},e.Themes.Classic.defaultBlockStyles={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},e.Themes.Classic.categoryStyles={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},e.Themes.Classic=new e.Theme("classic",e.Themes.Classic.defaultBlockStyles,e.Themes.Classic.categoryStyles),e.utils.IdGenerator={},e.utils.IdGenerator.nextId_=0,e.utils.IdGenerator.getNextUniqueId=function(){return"blockly-"+(e.utils.IdGenerator.nextId_++).toString(36)},e.utils.Metrics=function(){},e.utils.toolbox={},e.utils.toolbox.CATEGORY_TOOLBOX_KIND="categoryToolbox",e.utils.toolbox.FLYOUT_TOOLBOX_KIND="flyoutToolbox",e.utils.toolbox.Position={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3},e.utils.toolbox.convertToolboxDefToJson=function(t){return t?((t instanceof Element||"string"==typeof t)&&(t=e.utils.toolbox.parseToolboxTree(t),t=e.utils.toolbox.convertToToolboxJson_(t)),e.utils.toolbox.validateToolbox_(t),t):null},e.utils.toolbox.validateToolbox_=function(t){var n=t.kind;if(t=t.contents,n&&n!=e.utils.toolbox.FLYOUT_TOOLBOX_KIND&&n!=e.utils.toolbox.CATEGORY_TOOLBOX_KIND)throw Error("Invalid toolbox kind "+n+". Please supply either "+e.utils.toolbox.FLYOUT_TOOLBOX_KIND+" or "+e.utils.toolbox.CATEGORY_TOOLBOX_KIND);if(!t)throw Error("Toolbox must have a contents attribute.")},e.utils.toolbox.convertFlyoutDefToJsonArray=function(t){return t?t.contents?t.contents:Array.isArray(t)&&0<t.length&&!t[0].nodeType?t:e.utils.toolbox.xmlToJsonArray_(t):[]},e.utils.toolbox.hasCategories=function(t){if(!t)return!1;var n=t.kind;return n?n==e.utils.toolbox.CATEGORY_TOOLBOX_KIND:!!t.contents.filter(function(o){return"CATEGORY"==o.kind.toUpperCase()}).length},e.utils.toolbox.isCategoryCollapsible=function(t){return!(!t||!t.contents||!t.contents.filter(function(n){return"CATEGORY"==n.kind.toUpperCase()}).length)},e.utils.toolbox.convertToToolboxJson_=function(t){var n={contents:e.utils.toolbox.xmlToJsonArray_(t)};return t instanceof Node&&e.utils.toolbox.addAttributes_(t,n),n},e.utils.toolbox.xmlToJsonArray_=function(t){var r,n=[],o=t.childNodes;for(o||(o=t),t=0;r=o[t];t++)if(r.tagName){var a={},h=r.tagName.toUpperCase();a.kind=h,"BLOCK"==h?a.blockxml=r:r.childNodes&&0<r.childNodes.length&&(a.contents=e.utils.toolbox.xmlToJsonArray_(r)),e.utils.toolbox.addAttributes_(r,a),n.push(a)}return n},e.utils.toolbox.addAttributes_=function(t,n){for(var o=0;o<t.attributes.length;o++){var r=t.attributes[o];-1<r.nodeName.indexOf("css-")?(n.cssconfig=n.cssconfig||{},n.cssconfig[r.nodeName.replace("css-","")]=r.value):n[r.nodeName]=r.value}},e.utils.toolbox.parseToolboxTree=function(t){if(t){if("string"!=typeof t&&(e.utils.userAgent.IE&&t.outerHTML?t=t.outerHTML:t instanceof Element||(t=null)),"string"==typeof t&&"xml"!=(t=e.Xml.textToDom(t)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else t=null;return t},e.Options=function(t){var n=!!t.readOnly;if(n)var o=null,r=!1,a=!1,h=!1,R=!1,L=!1,W=!1;else{o=e.utils.toolbox.convertToolboxDefToJson(t.toolbox),r=e.utils.toolbox.hasCategories(o),void 0===(a=t.trashcan)&&(a=r);var nt=t.maxTrashcanContents;a?void 0===nt&&(nt=32):nt=0,void 0===(h=t.collapse)&&(h=r),void 0===(R=t.comments)&&(R=r),void 0===(L=t.disable)&&(L=r),void 0===(W=t.sounds)&&(W=!0)}var et=!!t.rtl,Et=t.horizontalLayout;void 0===Et&&(Et=!1);var It=t.toolboxPosition;It="end"!==It,It=Et?It?e.utils.toolbox.Position.TOP:e.utils.toolbox.Position.BOTTOM:It==et?e.utils.toolbox.Position.RIGHT:e.utils.toolbox.Position.LEFT;var gt=t.css;void 0===gt&&(gt=!0);var wt="https://blockly-demo.appspot.com/static/media/";t.media?wt=t.media:t.path&&(wt=t.path+"media/");var Ut=void 0===t.oneBasedIndex||!!t.oneBasedIndex,Jt=t.renderer||"geras",Ct=t.plugins||{};this.RTL=et,this.oneBasedIndex=Ut,this.collapse=h,this.comments=R,this.disable=L,this.readOnly=n,this.maxBlocks=t.maxBlocks||1/0,this.maxInstances=t.maxInstances,this.pathToMedia=wt,this.hasCategories=r,this.moveOptions=e.Options.parseMoveOptions_(t,r),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=a,this.maxTrashcanContents=nt,this.hasSounds=W,this.hasCss=gt,this.horizontalLayout=Et,this.languageTree=o,this.gridOptions=e.Options.parseGridOptions_(t),this.zoomOptions=e.Options.parseZoomOptions_(t),this.toolboxPosition=It,this.theme=e.Options.parseThemeOptions_(t),this.renderer=Jt,this.rendererOverrides=t.rendererOverrides,this.gridPattern=null,this.parentWorkspace=t.parentWorkspace,this.plugins=Ct},e.BlocklyOptions=function(){},e.Options.parseMoveOptions_=function(t,n){var o=t.move||{},r={};return void 0===o.scrollbars&&void 0===t.scrollbars?r.scrollbars=n:"object"==typeof o.scrollbars?(r.scrollbars={},r.scrollbars.horizontal=!!o.scrollbars.horizontal,r.scrollbars.vertical=!!o.scrollbars.vertical,r.scrollbars.horizontal&&r.scrollbars.vertical?r.scrollbars=!0:r.scrollbars.horizontal||r.scrollbars.vertical||(r.scrollbars=!1)):r.scrollbars=!!o.scrollbars||!!t.scrollbars,r.wheel=r.scrollbars&&void 0!==o.wheel?!!o.wheel:"object"==typeof r.scrollbars,r.drag=!(!r.scrollbars||void 0!==o.drag&&!o.drag),r},e.Options.parseZoomOptions_=function(t){var n={};return n.controls=void 0!==(t=t.zoom||{}).controls&&!!t.controls,n.wheel=void 0!==t.wheel&&!!t.wheel,n.startScale=void 0===t.startScale?1:Number(t.startScale),n.maxScale=void 0===t.maxScale?3:Number(t.maxScale),n.minScale=void 0===t.minScale?.3:Number(t.minScale),n.scaleSpeed=void 0===t.scaleSpeed?1.2:Number(t.scaleSpeed),n.pinch=void 0===t.pinch?n.wheel||n.controls:!!t.pinch,n},e.Options.parseGridOptions_=function(t){t=t.grid||{};var n={};return n.spacing=Number(t.spacing)||0,n.colour=t.colour||"#888",n.length=void 0===t.length?1:Number(t.length),n.snap=0<n.spacing&&!!t.snap,n},e.Options.parseThemeOptions_=function(t){return"string"==typeof(t=t.theme||e.Themes.Classic)?e.registry.getObject(e.registry.Type.THEME,t):t instanceof e.Theme?t:e.Theme.defineTheme(t.name||"builtin"+e.utils.IdGenerator.getNextUniqueId(),t)},e.Options.parseToolboxTree=function(t){return e.utils.deprecation.warn("Blockly.Options.parseToolboxTree","September 2020","September 2021","Blockly.utils.toolbox.parseToolboxTree"),e.utils.toolbox.parseToolboxTree(t)},e.ScrollbarPair=function(t,n,o,r,a){this.workspace_=t,o=void 0===o||o;var h=(n=void 0===n||n)&&o;n&&(this.hScroll=new e.Scrollbar(t,!0,h,r,a)),o&&(this.vScroll=new e.Scrollbar(t,!1,h,r,a)),h&&(this.corner_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{height:e.Scrollbar.scrollbarThickness,width:e.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),e.utils.dom.insertAfter(this.corner_,t.getBubbleCanvas())),this.oldHostMetrics_=null},e.ScrollbarPair.prototype.dispose=function(){e.utils.dom.removeNode(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)},e.ScrollbarPair.prototype.resize=function(){var t=this.workspace_.getMetrics();if(t){var n=!1,o=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth==t.scrollWidth&&this.oldHostMetrics_.viewLeft==t.viewLeft&&this.oldHostMetrics_.scrollLeft==t.scrollLeft||(n=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight==t.scrollHeight&&this.oldHostMetrics_.viewTop==t.viewTop&&this.oldHostMetrics_.scrollTop==t.scrollTop||(o=!0)):o=n=!0,n||o){try{e.Events.disable(),this.hScroll&&n&&this.hScroll.resize(t),this.vScroll&&o&&this.vScroll.resize(t)}finally{e.Events.enable()}this.workspace_.maybeFireViewportChangeEvent()}this.hScroll&&this.vScroll&&(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position.y)),this.oldHostMetrics_=t}},e.ScrollbarPair.prototype.canScrollHorizontally=function(){return!!this.hScroll},e.ScrollbarPair.prototype.canScrollVertically=function(){return!!this.vScroll},e.ScrollbarPair.prototype.setOrigin=function(t,n){this.hScroll&&this.hScroll.setOrigin(t,n),this.vScroll&&this.vScroll.setOrigin(t,n)},e.ScrollbarPair.prototype.set=function(t,n,o){this.hScroll&&this.hScroll.set(t,!1),this.vScroll&&this.vScroll.set(n,!1),(o||void 0===o)&&(t={},this.hScroll&&(t.x=this.hScroll.getRatio_()),this.vScroll&&(t.y=this.vScroll.getRatio_()),this.workspace_.setMetrics(t))},e.ScrollbarPair.prototype.setX=function(t){this.hScroll&&this.hScroll.set(t,!0)},e.ScrollbarPair.prototype.setY=function(t){this.vScroll&&this.vScroll.set(t,!0)},e.ScrollbarPair.prototype.setContainerVisible=function(t){this.hScroll&&this.hScroll.setContainerVisible(t),this.vScroll&&this.vScroll.setContainerVisible(t)},e.ScrollbarPair.prototype.isVisible=function(){var t=!1;return this.hScroll&&(t=this.hScroll.isVisible()),this.vScroll&&(t=t||this.vScroll.isVisible()),t},e.ScrollbarPair.prototype.resizeContent=function(t){this.hScroll&&this.hScroll.resizeContentHorizontal(t),this.vScroll&&this.vScroll.resizeContentVertical(t)},e.ScrollbarPair.prototype.resizeView=function(t){this.hScroll&&this.hScroll.resizeViewHorizontal(t),this.vScroll&&this.vScroll.resizeViewVertical(t)},e.Scrollbar=function(t,n,o,r,a){this.workspace_=t,this.pair_=o||!1,this.horizontal_=n,this.margin_=void 0!==a?a:e.Scrollbar.DEFAULT_SCROLLBAR_MARGIN,this.ratio=this.oldHostMetrics_=null,this.createDom_(r),this.position=new e.utils.Coordinate(0,0),t=e.Scrollbar.scrollbarThickness,n?(this.svgBackground_.setAttribute("height",t),this.outerSvg_.setAttribute("height",t),this.svgHandle_.setAttribute("height",t-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",t),this.outerSvg_.setAttribute("width",t),this.svgHandle_.setAttribute("width",t-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=e.browserEvents.conditionalBind(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=e.browserEvents.conditionalBind(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)},e.Scrollbar.prototype.origin_=new e.utils.Coordinate(0,0),e.Scrollbar.prototype.startDragMouse_=0,e.Scrollbar.prototype.scrollbarLength_=0,e.Scrollbar.prototype.handleLength_=0,e.Scrollbar.prototype.handlePosition_=0,e.Scrollbar.prototype.isVisible_=!0,e.Scrollbar.prototype.containerVisible_=!0,e.Scrollbar.scrollbarThickness=15,e.Touch.TOUCH_ENABLED&&(e.Scrollbar.scrollbarThickness=25),e.Scrollbar.DEFAULT_SCROLLBAR_MARGIN=.5,e.Scrollbar.metricsAreEquivalent_=function(t,n){return t.viewWidth==n.viewWidth&&t.viewHeight==n.viewHeight&&t.viewLeft==n.viewLeft&&t.viewTop==n.viewTop&&t.absoluteTop==n.absoluteTop&&t.absoluteLeft==n.absoluteLeft&&t.scrollWidth==n.scrollWidth&&t.scrollHeight==n.scrollHeight&&t.scrollLeft==n.scrollLeft&&t.scrollTop==n.scrollTop},e.Scrollbar.prototype.dispose=function(){this.cleanUp_(),e.browserEvents.unbind(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,e.browserEvents.unbind(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,e.utils.dom.removeNode(this.outerSvg_),this.svgBackground_=this.svgGroup_=this.outerSvg_=null,this.svgHandle_&&(this.workspace_.getThemeManager().unsubscribe(this.svgHandle_),this.svgHandle_=null),this.workspace_=null},e.Scrollbar.prototype.constrainHandleLength_=function(t){return 0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength_)},e.Scrollbar.prototype.setHandleLength_=function(t){this.handleLength_=t,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},e.Scrollbar.prototype.constrainHandlePosition_=function(t){return 0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength_-this.handleLength_)},e.Scrollbar.prototype.setHandlePosition=function(t){this.handlePosition_=t,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},e.Scrollbar.prototype.setScrollbarLength_=function(t){this.scrollbarLength_=t,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollbarLength_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollbarLength_)},e.Scrollbar.prototype.setPosition=function(t,n){this.position.x=t,this.position.y=n,e.utils.dom.setCssTransform(this.outerSvg_,"translate("+(this.position.x+this.origin_.x)+"px,"+(this.position.y+this.origin_.y)+"px)")},e.Scrollbar.prototype.resize=function(t){!t&&!(t=this.workspace_.getMetrics())||this.oldHostMetrics_&&e.Scrollbar.metricsAreEquivalent_(t,this.oldHostMetrics_)||(this.horizontal_?this.resizeHorizontal_(t):this.resizeVertical_(t),this.oldHostMetrics_=t,this.updateMetrics_())},e.Scrollbar.prototype.requiresViewResize_=function(t){return!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==t.viewWidth||this.oldHostMetrics_.viewHeight!==t.viewHeight||this.oldHostMetrics_.absoluteLeft!==t.absoluteLeft||this.oldHostMetrics_.absoluteTop!==t.absoluteTop},e.Scrollbar.prototype.resizeHorizontal_=function(t){this.requiresViewResize_(t)?this.resizeViewHorizontal(t):this.resizeContentHorizontal(t)},e.Scrollbar.prototype.resizeViewHorizontal=function(t){var n=t.viewWidth-2*this.margin_;this.pair_&&(n-=e.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,n)),n=t.absoluteLeft+this.margin_,this.pair_&&this.workspace_.RTL&&(n+=e.Scrollbar.scrollbarThickness),this.setPosition(n,t.absoluteTop+t.viewHeight-e.Scrollbar.scrollbarThickness-this.margin_),this.resizeContentHorizontal(t)},e.Scrollbar.prototype.resizeContentHorizontal=function(t){if(t.viewWidth>=t.scrollWidth)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var n=this.scrollbarLength_*t.viewWidth/t.scrollWidth;n=this.constrainHandleLength_(n),this.setHandleLength_(n);var o=this.scrollbarLength_-this.handleLength_;t=this.constrainHandlePosition_(t=(t.viewLeft-t.scrollLeft)/(n=t.scrollWidth-t.viewWidth)*o),this.setHandlePosition(t),this.ratio=o/n}},e.Scrollbar.prototype.resizeVertical_=function(t){this.requiresViewResize_(t)?this.resizeViewVertical(t):this.resizeContentVertical(t)},e.Scrollbar.prototype.resizeViewVertical=function(t){var n=t.viewHeight-2*this.margin_;this.pair_&&(n-=e.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,n)),this.setPosition(this.workspace_.RTL?t.absoluteLeft+this.margin_:t.absoluteLeft+t.viewWidth-e.Scrollbar.scrollbarThickness-this.margin_,t.absoluteTop+this.margin_),this.resizeContentVertical(t)},e.Scrollbar.prototype.resizeContentVertical=function(t){if(t.viewHeight>=t.scrollHeight)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var n=this.scrollbarLength_*t.viewHeight/t.scrollHeight;n=this.constrainHandleLength_(n),this.setHandleLength_(n);var o=this.scrollbarLength_-this.handleLength_;t=this.constrainHandlePosition_(t=(t.viewTop-t.scrollTop)/(n=t.scrollHeight-t.viewHeight)*o),this.setHandlePosition(t),this.ratio=o/n}},e.Scrollbar.prototype.createDom_=function(t){var n="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");t&&(n+=" "+t),this.outerSvg_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{class:n},null),this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},this.outerSvg_),this.svgBackground_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyScrollbarBackground"},this.svgGroup_),t=Math.floor((e.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyScrollbarHandle",rx:t,ry:t},this.svgGroup_),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarOpacity","fill-opacity"),e.utils.dom.insertAfter(this.outerSvg_,this.workspace_.getParentSvg())},e.Scrollbar.prototype.isVisible=function(){return this.isVisible_},e.Scrollbar.prototype.setContainerVisible=function(t){var n=t!=this.containerVisible_;this.containerVisible_=t,n&&this.updateDisplay_()},e.Scrollbar.prototype.setVisible=function(t){var n=t!=this.isVisible();if(this.pair_)throw Error("Unable to toggle visibility of paired scrollbars.");this.isVisible_=t,n&&this.updateDisplay_()},e.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},e.Scrollbar.prototype.onMouseDownBar_=function(t){if(this.workspace_.markFocused(),e.Touch.clearTouchIdentifier(),this.cleanUp_(),e.utils.isRightButton(t))t.stopPropagation();else{var n=e.utils.mouseToSvg(t,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());n=this.horizontal_?n.x:n.y;var o=e.utils.getInjectionDivXY_(this.svgHandle_),r=this.handlePosition_,a=.95*this.handleLength_;n<=(o=this.horizontal_?o.x:o.y)?r-=a:n>=o+this.handleLength_&&(r+=a),this.setHandlePosition(this.constrainHandlePosition_(r)),this.updateMetrics_(),t.stopPropagation(),t.preventDefault()}},e.Scrollbar.prototype.onMouseDownHandle_=function(t){this.workspace_.markFocused(),this.cleanUp_(),e.utils.isRightButton(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse_=this.horizontal_?t.clientX:t.clientY,e.Scrollbar.onMouseUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",this,this.onMouseUpHandle_),e.Scrollbar.onMouseMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",this,this.onMouseMoveHandle_),t.stopPropagation(),t.preventDefault())},e.Scrollbar.prototype.onMouseMoveHandle_=function(t){this.setHandlePosition(this.constrainHandlePosition_(this.startDragHandle+((this.horizontal_?t.clientX:t.clientY)-this.startDragMouse_))),this.updateMetrics_()},e.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),e.Touch.clearTouchIdentifier(),this.cleanUp_()},e.Scrollbar.prototype.cleanUp_=function(){e.hideChaff(!0),e.Scrollbar.onMouseUpWrapper_&&(e.browserEvents.unbind(e.Scrollbar.onMouseUpWrapper_),e.Scrollbar.onMouseUpWrapper_=null),e.Scrollbar.onMouseMoveWrapper_&&(e.browserEvents.unbind(e.Scrollbar.onMouseMoveWrapper_),e.Scrollbar.onMouseMoveWrapper_=null)},e.Scrollbar.prototype.getRatio_=function(){var t=this.handlePosition_/(this.scrollbarLength_-this.handleLength_);return isNaN(t)&&(t=0),t},e.Scrollbar.prototype.updateMetrics_=function(){var t=this.getRatio_(),n={};this.horizontal_?n.x=t:n.y=t,this.workspace_.setMetrics(n)},e.Scrollbar.prototype.set=function(t,n){this.setHandlePosition(this.constrainHandlePosition_(t*this.ratio)),(n||void 0===n)&&this.updateMetrics_()},e.Scrollbar.prototype.setOrigin=function(t,n){this.origin_=new e.utils.Coordinate(t,n)},e.Tooltip={},e.Tooltip.visible=!1,e.Tooltip.blocked_=!1,e.Tooltip.LIMIT=50,e.Tooltip.mouseOutPid_=0,e.Tooltip.showPid_=0,e.Tooltip.lastX_=0,e.Tooltip.lastY_=0,e.Tooltip.element_=null,e.Tooltip.poisonedElement_=null,e.Tooltip.OFFSET_X=0,e.Tooltip.OFFSET_Y=10,e.Tooltip.RADIUS_OK=10,e.Tooltip.HOVER_MS=750,e.Tooltip.MARGINS=5,e.Tooltip.DIV=null,e.Tooltip.getTooltipOfObject=function(t){if(t=e.Tooltip.getTargetObject_(t)){for(t=t.tooltip;"function"==typeof t;)t=t();if("string"!=typeof t)throw Error("Tooltip function must return a string.");return t}return""},e.Tooltip.getTargetObject_=function(t){for(;t&&t.tooltip;){if("string"==typeof t.tooltip||"function"==typeof t.tooltip)return t;t=t.tooltip}return null},e.Tooltip.createDom=function(){e.Tooltip.DIV||(e.Tooltip.DIV=document.createElement("div"),e.Tooltip.DIV.className="blocklyTooltipDiv",(e.parentContainer||document.body).appendChild(e.Tooltip.DIV))},e.Tooltip.bindMouseEvents=function(t){t.mouseOverWrapper_=e.browserEvents.bind(t,"mouseover",null,e.Tooltip.onMouseOver_),t.mouseOutWrapper_=e.browserEvents.bind(t,"mouseout",null,e.Tooltip.onMouseOut_),t.addEventListener("mousemove",e.Tooltip.onMouseMove_,!1)},e.Tooltip.unbindMouseEvents=function(t){t&&(e.browserEvents.unbind(t.mouseOverWrapper_),e.browserEvents.unbind(t.mouseOutWrapper_),t.removeEventListener("mousemove",e.Tooltip.onMouseMove_))},e.Tooltip.onMouseOver_=function(t){e.Tooltip.blocked_||(t=e.Tooltip.getTargetObject_(t.currentTarget),e.Tooltip.element_!=t&&(e.Tooltip.hide(),e.Tooltip.poisonedElement_=null,e.Tooltip.element_=t),clearTimeout(e.Tooltip.mouseOutPid_))},e.Tooltip.onMouseOut_=function(t){e.Tooltip.blocked_||(e.Tooltip.mouseOutPid_=setTimeout(function(){e.Tooltip.element_=null,e.Tooltip.poisonedElement_=null,e.Tooltip.hide()},1),clearTimeout(e.Tooltip.showPid_))},e.Tooltip.onMouseMove_=function(t){if(e.Tooltip.element_&&e.Tooltip.element_.tooltip&&!e.Tooltip.blocked_)if(e.Tooltip.visible){var n=e.Tooltip.lastX_-t.pageX;t=e.Tooltip.lastY_-t.pageY,Math.sqrt(n*n+t*t)>e.Tooltip.RADIUS_OK&&e.Tooltip.hide()}else e.Tooltip.poisonedElement_!=e.Tooltip.element_&&(clearTimeout(e.Tooltip.showPid_),e.Tooltip.lastX_=t.pageX,e.Tooltip.lastY_=t.pageY,e.Tooltip.showPid_=setTimeout(e.Tooltip.show_,e.Tooltip.HOVER_MS))},e.Tooltip.dispose=function(){e.Tooltip.element_=null,e.Tooltip.poisonedElement_=null,e.Tooltip.hide()},e.Tooltip.hide=function(){e.Tooltip.visible&&(e.Tooltip.visible=!1,e.Tooltip.DIV&&(e.Tooltip.DIV.style.display="none")),e.Tooltip.showPid_&&clearTimeout(e.Tooltip.showPid_)},e.Tooltip.block=function(){e.Tooltip.hide(),e.Tooltip.blocked_=!0},e.Tooltip.unblock=function(){e.Tooltip.blocked_=!1},e.Tooltip.show_=function(){if(!e.Tooltip.blocked_&&(e.Tooltip.poisonedElement_=e.Tooltip.element_,e.Tooltip.DIV)){e.Tooltip.DIV.textContent="";var t=e.Tooltip.getTooltipOfObject(e.Tooltip.element_);t=(t=e.utils.string.wrap(t,e.Tooltip.LIMIT)).split("\n");for(var n=0;n<t.length;n++){var o=document.createElement("div");o.appendChild(document.createTextNode(t[n])),e.Tooltip.DIV.appendChild(o)}t=e.Tooltip.element_.RTL,n=document.documentElement.clientWidth,o=document.documentElement.clientHeight,e.Tooltip.DIV.style.direction=t?"rtl":"ltr",e.Tooltip.DIV.style.display="block",e.Tooltip.visible=!0;var r=e.Tooltip.lastX_;r=t?r-(e.Tooltip.OFFSET_X+e.Tooltip.DIV.offsetWidth):r+e.Tooltip.OFFSET_X;var a=e.Tooltip.lastY_+e.Tooltip.OFFSET_Y;a+e.Tooltip.DIV.offsetHeight>o+window.scrollY&&(a-=e.Tooltip.DIV.offsetHeight+2*e.Tooltip.OFFSET_Y),t?r=Math.max(e.Tooltip.MARGINS-window.scrollX,r):r+e.Tooltip.DIV.offsetWidth>n+window.scrollX-2*e.Tooltip.MARGINS&&(r=n-e.Tooltip.DIV.offsetWidth-2*e.Tooltip.MARGINS),e.Tooltip.DIV.style.top=a+"px",e.Tooltip.DIV.style.left=r+"px"}},e.utils.aria={},e.utils.aria.ARIA_PREFIX_="aria-",e.utils.aria.ROLE_ATTRIBUTE_="role",e.utils.aria.Role={GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",LISTBOX:"listbox",MENU:"menu",MENUITEM:"menuitem",MENUITEMCHECKBOX:"menuitemcheckbox",OPTION:"option",PRESENTATION:"presentation",ROW:"row",TREE:"tree",TREEITEM:"treeitem"},e.utils.aria.State={ACTIVEDESCENDANT:"activedescendant",COLCOUNT:"colcount",DISABLED:"disabled",EXPANDED:"expanded",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",ORIENTATION:"orientation",POSINSET:"posinset",ROWCOUNT:"rowcount",SELECTED:"selected",SETSIZE:"setsize",VALUEMAX:"valuemax",VALUEMIN:"valuemin"},e.utils.aria.setRole=function(t,n){t.setAttribute(e.utils.aria.ROLE_ATTRIBUTE_,n)},e.utils.aria.setState=function(t,n,o){Array.isArray(o)&&(o=o.join(" ")),t.setAttribute(e.utils.aria.ARIA_PREFIX_+n,o)},e.IASTNodeLocation=function(){},e.IASTNodeLocationSvg=function(){},e.IASTNodeLocationWithBlock=function(){},e.IKeyboardAccessible=function(){},e.utils.deprecation={},e.utils.deprecation.warn=function(t,n,o,r){t=t+" was deprecated on "+n+" and will be deleted on "+o+".",r&&(t+="\nUse "+r+" instead."),console.warn(t)},e.Connection=function(t,n){this.sourceBlock_=t,this.type=n},e.Connection.CAN_CONNECT=0,e.Connection.REASON_SELF_CONNECTION=1,e.Connection.REASON_WRONG_TYPE=2,e.Connection.REASON_TARGET_NULL=3,e.Connection.REASON_CHECKS_FAILED=4,e.Connection.REASON_DIFFERENT_WORKSPACES=5,e.Connection.REASON_SHADOW_PARENT=6,e.Connection.REASON_DRAG_CHECKS_FAILED=7,e.Connection.prototype.targetConnection=null,e.Connection.prototype.disposed=!1,e.Connection.prototype.check_=null,e.Connection.prototype.shadowDom_=null,e.Connection.prototype.x=0,e.Connection.prototype.y=0,e.Connection.prototype.connect_=function(t){var L,n=e.connectionTypes.INPUT_VALUE,o=this.getSourceBlock(),r=t.getSourceBlock();if(t.isConnected()&&t.disconnect(),this.isConnected()){var a=this.getShadowDom(!0);this.shadowDom_=null;var h=this.targetBlock();if(h.isShadow())h.dispose(!1);else{this.disconnect();var R=h}this.shadowDom_=a}e.Events.isEnabled()&&(L=new(e.Events.get(e.Events.BLOCK_MOVE))(r)),e.Connection.connectReciprocally_(this,t),r.setParent(o),L&&(L.recordNew(),e.Events.fire(L)),R&&((r=e.Connection.getConnectionForOrphanedConnection(r,t=this.type===n?R.outputConnection:R.previousConnection))?t.connect(r):t.onFailedConnect(this))},e.Connection.prototype.dispose=function(){if(this.isConnected()){this.setShadowDom(null);var t=this.targetBlock();t&&t.unplug()}this.disposed=!0},e.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},e.Connection.prototype.isSuperior=function(){return this.type==e.connectionTypes.INPUT_VALUE||this.type==e.connectionTypes.NEXT_STATEMENT},e.Connection.prototype.isConnected=function(){return!!this.targetConnection},e.Connection.prototype.canConnectWithReason=function(t){return e.utils.deprecation.warn("Connection.prototype.canConnectWithReason","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnectWithReason(this,t,!1)},e.Connection.prototype.checkConnection=function(t){e.utils.deprecation.warn("Connection.prototype.checkConnection","July 2020","July 2021","the workspace's connection checker");var n=this.getConnectionChecker(),o=n.canConnectWithReason(this,t,!1);if(o!=e.Connection.CAN_CONNECT)throw Error(n.getErrorMessage(o,this,t))},e.Connection.prototype.getConnectionChecker=function(){return this.sourceBlock_.workspace.connectionChecker},e.Connection.prototype.isConnectionAllowed=function(t){return e.utils.deprecation.warn("Connection.prototype.isConnectionAllowed","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,t,!0)},e.Connection.prototype.onFailedConnect=function(t){},e.Connection.prototype.connect=function(t){if(this.targetConnection!=t&&this.getConnectionChecker().canConnect(this,t,!1)){var n=e.Events.getGroup();n||e.Events.setGroup(!0),this.isSuperior()?this.connect_(t):t.connect_(this),n||e.Events.setGroup(!1)}},e.Connection.connectReciprocally_=function(t,n){if(!t||!n)throw Error("Cannot connect null connections.");t.targetConnection=n,n.targetConnection=t},e.Connection.getSingleConnection_=function(t,n){for(var h,o=null,r=(n=n.outputConnection).getConnectionChecker(),a=0;h=t.inputList[a];a++)if((h=h.connection)&&r.canConnect(n,h,!1)){if(o)return null;o=h}return o},e.Connection.getConnectionForOrphanedOutput_=function(t,n){for(var o;o=e.Connection.getSingleConnection_(t,n);)if(!(t=o.targetBlock())||t.isShadow())return o;return null},e.Connection.getConnectionForOrphanedConnection=function(t,n){if(n.type===e.connectionTypes.OUTPUT_VALUE)return e.Connection.getConnectionForOrphanedOutput_(t,n.getSourceBlock());t=t.lastConnectionInStack(!0);var o=n.getConnectionChecker();return t&&o.canConnect(n,t,!1)?t:null},e.Connection.prototype.disconnect=function(){var t=this.targetConnection;if(!t)throw Error("Source connection not connected.");if(t.targetConnection!=this)throw Error("Target connection not connected to source connection.");if(this.isSuperior()){var n=this.sourceBlock_,o=t.getSourceBlock();t=this}else n=t.getSourceBlock(),o=this.sourceBlock_;var r=e.Events.getGroup();r||e.Events.setGroup(!0),this.disconnectInternal_(n,o),o.isShadow()||t.respawnShadow_(),r||e.Events.setGroup(!1)},e.Connection.prototype.disconnectInternal_=function(t,n){var o;e.Events.isEnabled()&&(o=new(e.Events.get(e.Events.BLOCK_MOVE))(n)),this.targetConnection=this.targetConnection.targetConnection=null,n.setParent(null),o&&(o.recordNew(),e.Events.fire(o))},e.Connection.prototype.respawnShadow_=function(){var t=this.getSourceBlock(),n=this.getShadowDom();if(t.workspace&&n)if((t=e.Xml.domToBlock(n,t.workspace)).outputConnection)this.connect(t.outputConnection);else{if(!t.previousConnection)throw Error("Child block does not have output or previous statement.");this.connect(t.previousConnection)}},e.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},e.Connection.prototype.checkType=function(t){return e.utils.deprecation.warn("Connection.prototype.checkType","October 2019","January 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,t,!1)},e.Connection.prototype.checkType_=function(t){return e.utils.deprecation.warn("Connection.prototype.checkType_","October 2019","January 2021","the workspace's connection checker"),this.checkType(t)},e.Connection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},e.Connection.prototype.setCheck=function(t){return t?(Array.isArray(t)||(t=[t]),this.check_=t,this.onCheckChanged_()):this.check_=null,this},e.Connection.prototype.getCheck=function(){return this.check_},e.Connection.prototype.setShadowDom=function(t){this.shadowDom_=t,(t=this.targetBlock())?t.isShadow()&&(t.dispose(!1),this.respawnShadow_()):this.respawnShadow_()},e.Connection.prototype.getShadowDom=function(t){return t&&this.targetBlock().isShadow()?e.Xml.blockToDom(this.targetBlock()):this.shadowDom_},e.Connection.prototype.neighbours=function(t){return[]},e.Connection.prototype.getParentInput=function(){for(var t=null,n=this.sourceBlock_.inputList,o=0;o<n.length;o++)if(n[o].connection===this){t=n[o];break}return t},e.Connection.prototype.toString=function(){var t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection==this)var n="Output Connection of ";else if(t.previousConnection==this)n="Previous Connection of ";else if(t.nextConnection==this)n="Next Connection of ";else{n=null;for(var r,o=0;r=t.inputList[o];o++)if(r.connection==this){n=r;break}if(!n)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";n='Input "'+n.name+'" connection on '}return n+t.toDevString()},e.IConnectionChecker=function(){},e.ConnectionChecker=function(){},e.ConnectionChecker.prototype.canConnect=function(t,n,o,r){return this.canConnectWithReason(t,n,o,r)==e.Connection.CAN_CONNECT},e.ConnectionChecker.prototype.canConnectWithReason=function(t,n,o,r){var a=this.doSafetyChecks(t,n);return a!=e.Connection.CAN_CONNECT?a:this.doTypeChecks(t,n)?o&&!this.doDragChecks(t,n,r||0)?e.Connection.REASON_DRAG_CHECKS_FAILED:e.Connection.CAN_CONNECT:e.Connection.REASON_CHECKS_FAILED},e.ConnectionChecker.prototype.getErrorMessage=function(t,n,o){switch(t){case e.Connection.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case e.Connection.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case e.Connection.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case e.Connection.REASON_TARGET_NULL:return"Target connection is null.";case e.Connection.REASON_CHECKS_FAILED:return"Connection checks failed. "+n+" expected "+n.getCheck()+", found "+o.getCheck();case e.Connection.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case e.Connection.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";default:return"Unknown connection failure: this should never happen!"}},e.ConnectionChecker.prototype.doSafetyChecks=function(t,n){if(!t||!n)return e.Connection.REASON_TARGET_NULL;if(t.isSuperior())var o=t.getSourceBlock(),r=n.getSourceBlock();else r=t.getSourceBlock(),o=n.getSourceBlock();return o==r?e.Connection.REASON_SELF_CONNECTION:n.type!=e.OPPOSITE_TYPE[t.type]?e.Connection.REASON_WRONG_TYPE:o.workspace!==r.workspace?e.Connection.REASON_DIFFERENT_WORKSPACES:o.isShadow()&&!r.isShadow()?e.Connection.REASON_SHADOW_PARENT:e.Connection.CAN_CONNECT},e.ConnectionChecker.prototype.doTypeChecks=function(t,n){if(t=t.getCheck(),n=n.getCheck(),!t||!n)return!0;for(var o=0;o<t.length;o++)if(-1!=n.indexOf(t[o]))return!0;return!1},e.ConnectionChecker.prototype.doDragChecks=function(t,n,o){if(t.distanceFrom(n)>o||n.getSourceBlock().isInsertionMarker())return!1;switch(n.type){case e.connectionTypes.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t,n);case e.connectionTypes.OUTPUT_VALUE:if(n.isConnected()&&!n.targetBlock().isInsertionMarker()||t.isConnected())return!1;break;case e.connectionTypes.INPUT_VALUE:if(n.isConnected()&&!n.targetBlock().isMovable()&&!n.targetBlock().isShadow())return!1;break;case e.connectionTypes.NEXT_STATEMENT:if(n.isConnected()&&!t.getSourceBlock().nextConnection&&!n.targetBlock().isShadow()&&n.targetBlock().nextConnection)return!1;break;default:return!1}return-1==e.draggingConnections.indexOf(n)},e.ConnectionChecker.prototype.canConnectToPrevious_=function(t,n){return!(t.targetConnection||-1!=e.draggingConnections.indexOf(n)||n.targetConnection&&(!(t=n.targetBlock()).isInsertionMarker()||t.getPreviousBlock()))},e.registry.register(e.registry.Type.CONNECTION_CHECKER,e.registry.DEFAULT,e.ConnectionChecker),e.VariableMap=function(t){this.variableMap_=Object.create(null),this.workspace=t},e.VariableMap.prototype.clear=function(){this.variableMap_=Object.create(null)},e.VariableMap.prototype.renameVariable=function(t,n){var o=this.getVariable(n,t.type),r=this.workspace.getAllBlocks(!1);e.Events.setGroup(!0);try{o&&o.getId()!=t.getId()?this.renameVariableWithConflict_(t,n,o,r):this.renameVariableAndUses_(t,n,r)}finally{e.Events.setGroup(!1)}},e.VariableMap.prototype.renameVariableById=function(t,n){var o=this.getVariableById(t);if(!o)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(o,n)},e.VariableMap.prototype.renameVariableAndUses_=function(t,n,o){for(e.Events.fire(new(e.Events.get(e.Events.VAR_RENAME))(t,n)),t.name=n,n=0;n<o.length;n++)o[n].updateVarName(t)},e.VariableMap.prototype.renameVariableWithConflict_=function(t,n,o,r){var a=t.type;for(n!=o.name&&this.renameVariableAndUses_(o,n,r),n=0;n<r.length;n++)r[n].renameVarById(t.getId(),o.getId());e.Events.fire(new(e.Events.get(e.Events.VAR_DELETE))(t)),t=this.getVariablesOfType(a).indexOf(t),this.variableMap_[a].splice(t,1)},e.VariableMap.prototype.createVariable=function(t,n,o){var r=this.getVariable(t,n);if(r){if(o&&r.getId()!=o)throw Error('Variable "'+t+'" is already in use and its id is "'+r.getId()+'" which conflicts with the passed in id, "'+o+'".');return r}if(o&&this.getVariableById(o))throw Error('Variable id, "'+o+'", is already in use.');return r=o||e.utils.genUid(),r=new e.VariableModel(this.workspace,t,n=n||"",r),(t=this.variableMap_[n]||[]).push(r),delete this.variableMap_[n],this.variableMap_[n]=t,r},e.VariableMap.prototype.deleteVariable=function(t){for(var r,n=this.variableMap_[t.type],o=0;r=n[o];o++)if(r.getId()==t.getId()){n.splice(o,1),e.Events.fire(new(e.Events.get(e.Events.VAR_DELETE))(t));break}},e.VariableMap.prototype.deleteVariableById=function(t){var n=this.getVariableById(t);if(n){var a,o=n.name,r=this.getVariableUsesById(t);for(t=0;a=r[t];t++)if("procedures_defnoreturn"==a.type||"procedures_defreturn"==a.type)return t=a.getFieldValue("NAME"),o=e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",o).replace("%2",t),void e.alert(o);var h=this;1<r.length?(o=e.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(r.length)).replace("%2",o),e.confirm(o,function(R){R&&n&&h.deleteVariableInternal(n,r)})):h.deleteVariableInternal(n,r)}else console.warn("Can't delete non-existent variable: "+t)},e.VariableMap.prototype.deleteVariableInternal=function(t,n){var o=e.Events.getGroup();o||e.Events.setGroup(!0);try{for(var r=0;r<n.length;r++)n[r].dispose(!0);this.deleteVariable(t)}finally{o||e.Events.setGroup(!1)}},e.VariableMap.prototype.getVariable=function(t,n){if(n=this.variableMap_[n||""])for(var r,o=0;r=n[o];o++)if(e.Names.equals(r.name,t))return r;return null},e.VariableMap.prototype.getVariableById=function(t){for(var n=Object.keys(this.variableMap_),o=0;o<n.length;o++)for(var h,r=n[o],a=0;h=this.variableMap_[r][a];a++)if(h.getId()==t)return h;return null},e.VariableMap.prototype.getVariablesOfType=function(t){return(t=this.variableMap_[t||""])?t.slice():[]},e.VariableMap.prototype.getVariableTypes=function(t){var n={};e.utils.object.mixin(n,this.variableMap_),t&&t.getPotentialVariableMap()&&e.utils.object.mixin(n,t.getPotentialVariableMap().variableMap_),t=Object.keys(n),n=!1;for(var o=0;o<t.length;o++)""==t[o]&&(n=!0);return n||t.push(""),t},e.VariableMap.prototype.getAllVariables=function(){var n,t=[];for(n in this.variableMap_)t=t.concat(this.variableMap_[n]);return t},e.VariableMap.prototype.getAllVariableNames=function(){var n,t=[];for(n in this.variableMap_)for(var a,o=this.variableMap_[n],r=0;a=o[r];r++)t.push(a.name);return t},e.VariableMap.prototype.getVariableUsesById=function(t){for(var n=[],o=this.workspace.getAllBlocks(!1),r=0;r<o.length;r++){var a=o[r].getVarModels();if(a)for(var h=0;h<a.length;h++)a[h].getId()==t&&n.push(o[r])}return n},e.Workspace=function(t){this.id=e.utils.genUid(),e.Workspace.WorkspaceDB_[this.id]=this,this.options=t||new e.Options({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(e.registry.getClassFromOptions(e.registry.Type.CONNECTION_CHECKER,this.options,!0))(this),this.topBlocks_=[],this.topComments_=[],this.commentDB_=Object.create(null),this.listeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.typedBlocksDB_=Object.create(null),this.variableMap_=new e.VariableMap(this),this.potentialVariableMap_=null},e.Workspace.prototype.rendered=!1,e.Workspace.prototype.isClearing=!1,e.Workspace.prototype.MAX_UNDO=1024,e.Workspace.prototype.connectionDBList=null,e.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete e.Workspace.WorkspaceDB_[this.id]},e.Workspace.SCAN_ANGLE=3,e.Workspace.prototype.sortObjects_=function(t,n){return t=t.getRelativeToSurfaceXY(),n=n.getRelativeToSurfaceXY(),t.y+e.Workspace.prototype.sortObjects_.offset*t.x-(n.y+e.Workspace.prototype.sortObjects_.offset*n.x)},e.Workspace.prototype.addTopBlock=function(t){this.topBlocks_.push(t)},e.Workspace.prototype.removeTopBlock=function(t){if(!e.utils.arrayRemove(this.topBlocks_,t))throw Error("Block not present in workspace's list of top-most blocks.")},e.Workspace.prototype.getTopBlocks=function(t){var n=[].concat(this.topBlocks_);return t&&1<n.length&&(this.sortObjects_.offset=Math.sin(e.utils.math.toRadians(e.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),n.sort(this.sortObjects_)),n},e.Workspace.prototype.addTypedBlock=function(t){this.typedBlocksDB_[t.type]||(this.typedBlocksDB_[t.type]=[]),this.typedBlocksDB_[t.type].push(t)},e.Workspace.prototype.removeTypedBlock=function(t){this.typedBlocksDB_[t.type].splice(this.typedBlocksDB_[t.type].indexOf(t),1),this.typedBlocksDB_[t.type].length||delete this.typedBlocksDB_[t.type]},e.Workspace.prototype.getBlocksByType=function(t,n){return this.typedBlocksDB_[t]?(t=this.typedBlocksDB_[t].slice(0),n&&1<t.length&&(this.sortObjects_.offset=Math.sin(e.utils.math.toRadians(e.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t):[]},e.Workspace.prototype.addTopComment=function(t){this.topComments_.push(t),this.commentDB_[t.id]&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB_[t.id]=t},e.Workspace.prototype.removeTopComment=function(t){if(!e.utils.arrayRemove(this.topComments_,t))throw Error("Comment not present in workspace's list of top-most comments.");delete this.commentDB_[t.id]},e.Workspace.prototype.getTopComments=function(t){var n=[].concat(this.topComments_);return t&&1<n.length&&(this.sortObjects_.offset=Math.sin(e.utils.math.toRadians(e.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),n.sort(this.sortObjects_)),n},e.Workspace.prototype.getAllBlocks=function(t){if(t){t=this.getTopBlocks(!0);for(var n=[],o=0;o<t.length;o++)n.push.apply(n,t[o].getDescendants(!0))}else for(n=this.getTopBlocks(!1),o=0;o<n.length;o++)n.push.apply(n,n[o].getChildren(!1));return n.filter(function(r){return!r.isInsertionMarker()})},e.Workspace.prototype.clear=function(){this.isClearing=!0;try{var t=e.Events.getGroup();for(t||e.Events.setGroup(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose(!1);for(;this.topComments_.length;)this.topComments_[this.topComments_.length-1].dispose(!1);t||e.Events.setGroup(!1),this.variableMap_.clear(),this.potentialVariableMap_&&this.potentialVariableMap_.clear()}finally{this.isClearing=!1}},e.Workspace.prototype.renameVariableById=function(t,n){this.variableMap_.renameVariableById(t,n)},e.Workspace.prototype.createVariable=function(t,n,o){return this.variableMap_.createVariable(t,n,o)},e.Workspace.prototype.getVariableUsesById=function(t){return this.variableMap_.getVariableUsesById(t)},e.Workspace.prototype.deleteVariableById=function(t){this.variableMap_.deleteVariableById(t)},e.Workspace.prototype.getVariable=function(t,n){return this.variableMap_.getVariable(t,n)},e.Workspace.prototype.getVariableById=function(t){return this.variableMap_.getVariableById(t)},e.Workspace.prototype.getVariablesOfType=function(t){return this.variableMap_.getVariablesOfType(t)},e.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes(this)},e.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},e.Workspace.prototype.getAllVariableNames=function(){return this.variableMap_.getAllVariableNames()},e.Workspace.prototype.getWidth=function(){return 0},e.Workspace.prototype.newBlock=function(t,n){return new e.Block(this,t,n)},e.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length},e.Workspace.prototype.remainingCapacityOfType=function(t){return this.options.maxInstances?(void 0!==this.options.maxInstances[t]?this.options.maxInstances[t]:1/0)-this.getBlocksByType(t,!1).length:1/0},e.Workspace.prototype.isCapacityAvailable=function(t){if(!this.hasBlockLimits())return!0;var o,n=0;for(o in t){if(t[o]>this.remainingCapacityOfType(o))return!1;n+=t[o]}return!(n>this.remainingCapacity())},e.Workspace.prototype.hasBlockLimits=function(){return this.options.maxBlocks!=1/0||!!this.options.maxInstances},e.Workspace.prototype.getUndoStack=function(){return this.undoStack_},e.Workspace.prototype.getRedoStack=function(){return this.redoStack_},e.Workspace.prototype.undo=function(t){var n=t?this.redoStack_:this.undoStack_,o=t?this.undoStack_:this.redoStack_,r=n.pop();if(r){for(var a=[r];n.length&&r.group&&r.group==n[n.length-1].group;)a.push(n.pop());for(n=0;r=a[n];n++)o.push(r);a=e.Events.filter(a,t),e.Events.recordUndo=!1;try{for(n=0;r=a[n];n++)r.run(t)}finally{e.Events.recordUndo=!0}}},e.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,e.Events.clearPendingUndo()},e.Workspace.prototype.addChangeListener=function(t){return this.listeners_.push(t),t},e.Workspace.prototype.removeChangeListener=function(t){e.utils.arrayRemove(this.listeners_,t)},e.Workspace.prototype.fireChangeListener=function(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(var o,n=0;o=this.listeners_[n];n++)o(t)},e.Workspace.prototype.getBlockById=function(t){return this.blockDB_[t]||null},e.Workspace.prototype.setBlockById=function(t,n){this.blockDB_[t]=n},e.Workspace.prototype.removeBlockById=function(t){delete this.blockDB_[t]},e.Workspace.prototype.getCommentById=function(t){return this.commentDB_[t]||null},e.Workspace.prototype.allInputsFilled=function(t){for(var r,n=this.getTopBlocks(!1),o=0;r=n[o];o++)if(!r.allInputsFilled(t))return!1;return!0},e.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_},e.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new e.VariableMap(this)},e.Workspace.prototype.getVariableMap=function(){return this.variableMap_},e.Workspace.prototype.setVariableMap=function(t){this.variableMap_=t},e.Workspace.WorkspaceDB_=Object.create(null),e.Workspace.getById=function(t){return e.Workspace.WorkspaceDB_[t]||null},e.Workspace.getAll=function(){var n,t=[];for(n in e.Workspace.WorkspaceDB_)t.push(e.Workspace.WorkspaceDB_[n]);return t},e.WorkspaceDragSurfaceSvg=function(t){this.container_=t,this.createDom()},e.WorkspaceDragSurfaceSvg.prototype.SVG_=null,e.WorkspaceDragSurfaceSvg.prototype.container_=null,e.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null),this.container_.appendChild(this.SVG_))},e.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(t,n){t=t.toFixed(0),n=n.toFixed(0),this.SVG_.style.display="block",e.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+n+"px, 0px)")},e.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return e.utils.getRelativeXY(this.SVG_)},e.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(t){if(!t)throw Error("Couldn't clear and hide the drag surface: missing new surface.");var n=this.SVG_.childNodes[0],o=this.SVG_.childNodes[1];if(!(n&&o&&e.utils.dom.hasClass(n,"blocklyBlockCanvas")&&e.utils.dom.hasClass(o,"blocklyBubbleCanvas")))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(null!=this.previousSibling_?e.utils.dom.insertAfter(n,this.previousSibling_):t.insertBefore(n,t.firstChild),e.utils.dom.insertAfter(o,n),this.SVG_.style.display="none",this.SVG_.childNodes.length)throw Error("Drag surface was not cleared.");e.utils.dom.setCssTransform(this.SVG_,""),this.previousSibling_=null},e.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(t,n,o,r,a,h){if(this.SVG_.childNodes.length)throw Error("Already dragging a block.");this.previousSibling_=o,t.setAttribute("transform","translate(0, 0) scale("+h+")"),n.setAttribute("transform","translate(0, 0) scale("+h+")"),this.SVG_.setAttribute("width",r),this.SVG_.setAttribute("height",a),this.SVG_.appendChild(t),this.SVG_.appendChild(n),this.SVG_.style.display="block"},e.blockRendering={},e.blockRendering.useDebugger=!1,e.blockRendering.register=function(t,n){e.registry.register(e.registry.Type.RENDERER,t,n)},e.blockRendering.unregister=function(t){e.registry.unregister(e.registry.Type.RENDERER,t)},e.blockRendering.startDebugger=function(){e.blockRendering.useDebugger=!0},e.blockRendering.stopDebugger=function(){e.blockRendering.useDebugger=!1},e.blockRendering.init=function(t,n,o){return(t=new(e.registry.getClass(e.registry.Type.RENDERER,t))(t)).init(n,o),t},e.ASTNode=function(t,n,o){if(!n)throw Error("Cannot create a node without a location.");this.type_=t,this.isConnection_=e.ASTNode.isConnectionType_(t),this.location_=n,this.wsCoordinate_=null,this.processParams_(o||null)},e.ASTNode.types={FIELD:"field",BLOCK:"block",INPUT:"input",OUTPUT:"output",NEXT:"next",PREVIOUS:"previous",STACK:"stack",WORKSPACE:"workspace"},e.ASTNode.NAVIGATE_ALL_FIELDS=!1,e.ASTNode.DEFAULT_OFFSET_Y=-20,e.ASTNode.isConnectionType_=function(t){switch(t){case e.ASTNode.types.PREVIOUS:case e.ASTNode.types.NEXT:case e.ASTNode.types.INPUT:case e.ASTNode.types.OUTPUT:return!0}return!1},e.ASTNode.createFieldNode=function(t){return t?new e.ASTNode(e.ASTNode.types.FIELD,t):null},e.ASTNode.createConnectionNode=function(t){if(!t)return null;var n=t.type;return n==e.connectionTypes.INPUT_VALUE||n==e.connectionTypes.NEXT_STATEMENT&&t.getParentInput()?e.ASTNode.createInputNode(t.getParentInput()):n==e.connectionTypes.NEXT_STATEMENT?new e.ASTNode(e.ASTNode.types.NEXT,t):n==e.connectionTypes.OUTPUT_VALUE?new e.ASTNode(e.ASTNode.types.OUTPUT,t):n==e.connectionTypes.PREVIOUS_STATEMENT?new e.ASTNode(e.ASTNode.types.PREVIOUS,t):null},e.ASTNode.createInputNode=function(t){return t&&t.connection?new e.ASTNode(e.ASTNode.types.INPUT,t.connection):null},e.ASTNode.createBlockNode=function(t){return t?new e.ASTNode(e.ASTNode.types.BLOCK,t):null},e.ASTNode.createStackNode=function(t){return t?new e.ASTNode(e.ASTNode.types.STACK,t):null},e.ASTNode.createWorkspaceNode=function(t,n){return n&&t?new e.ASTNode(e.ASTNode.types.WORKSPACE,t,{wsCoordinate:n}):null},e.ASTNode.createTopNode=function(t){var n=t.previousConnection||t.outputConnection;return n?e.ASTNode.createConnectionNode(n):e.ASTNode.createBlockNode(t)},e.ASTNode.prototype.processParams_=function(t){t&&t.wsCoordinate&&(this.wsCoordinate_=t.wsCoordinate)},e.ASTNode.prototype.getLocation=function(){return this.location_},e.ASTNode.prototype.getType=function(){return this.type_},e.ASTNode.prototype.getWsCoordinate=function(){return this.wsCoordinate_},e.ASTNode.prototype.isConnection=function(){return this.isConnection_},e.ASTNode.prototype.findNextForInput_=function(){var o,t=this.location_.getParentInput(),n=t.getSourceBlock();for(t=n.inputList.indexOf(t)+1;o=n.inputList[t];t++){for(var h,r=o.fieldRow,a=0;h=r[a];a++)if(h.isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(h);if(o.connection)return e.ASTNode.createInputNode(o)}return null},e.ASTNode.prototype.findNextForField_=function(){var t=this.location_,n=t.getParentInput(),o=t.getSourceBlock(),r=o.inputList.indexOf(n);for(t=n.fieldRow.indexOf(t)+1;n=o.inputList[r];r++){for(var a=n.fieldRow;t<a.length;){if(a[t].isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(a[t]);t++}if(t=0,n.connection)return e.ASTNode.createInputNode(n)}return null},e.ASTNode.prototype.findPrevForInput_=function(){for(var r,t=this.location_.getParentInput(),n=t.getSourceBlock(),o=n.inputList.indexOf(t);r=n.inputList[o];o--){if(r.connection&&r!==t)return e.ASTNode.createInputNode(r);for(var h,a=(r=r.fieldRow).length-1;h=r[a];a--)if(h.isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(h)}return null},e.ASTNode.prototype.findPrevForField_=function(){var a,t=this.location_,n=t.getParentInput(),o=t.getSourceBlock(),r=o.inputList.indexOf(n);for(t=n.fieldRow.indexOf(t)-1;a=o.inputList[r];r--){if(a.connection&&a!==n)return e.ASTNode.createInputNode(a);for(a=a.fieldRow;-1<t;){if(a[t].isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(a[t]);t--}0<=r-1&&(t=o.inputList[r-1].fieldRow.length-1)}return null},e.ASTNode.prototype.navigateBetweenStacks_=function(t){var n=this.getLocation();if(n instanceof e.Block||(n=n.getSourceBlock()),!n||!n.workspace)return null;var o=n.getRootBlock();n=o.workspace.getTopBlocks(!0);for(var a,r=0;a=n[r];r++)if(o.id==a.id)return-1==(t=r+(t?1:-1))||t==n.length?null:e.ASTNode.createStackNode(n[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")},e.ASTNode.prototype.findTopASTNodeForBlock_=function(t){var n=t.previousConnection||t.outputConnection;return n?e.ASTNode.createConnectionNode(n):e.ASTNode.createBlockNode(t)},e.ASTNode.prototype.getOutAstNodeForBlock_=function(t){if(!t)return null;var n=(t=t.getTopStackBlock()).previousConnection||t.outputConnection;return n&&n.targetConnection&&n.targetConnection.getParentInput()?e.ASTNode.createInputNode(n.targetConnection.getParentInput()):e.ASTNode.createStackNode(t)},e.ASTNode.prototype.findFirstFieldOrInput_=function(t){t=t.inputList;for(var o,n=0;o=t[n];n++){for(var h,r=o.fieldRow,a=0;h=r[a];a++)if(h.isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(h);if(o.connection)return e.ASTNode.createInputNode(o)}return null},e.ASTNode.prototype.getSourceBlock=function(){return this.getType()===e.ASTNode.types.BLOCK||this.getType()===e.ASTNode.types.STACK?this.getLocation():this.getType()===e.ASTNode.types.WORKSPACE?null:this.getLocation().getSourceBlock()},e.ASTNode.prototype.next=function(){switch(this.type_){case e.ASTNode.types.STACK:return this.navigateBetweenStacks_(!0);case e.ASTNode.types.OUTPUT:var t=this.location_;return e.ASTNode.createBlockNode(t.getSourceBlock());case e.ASTNode.types.FIELD:return this.findNextForField_();case e.ASTNode.types.INPUT:return this.findNextForInput_();case e.ASTNode.types.BLOCK:return e.ASTNode.createConnectionNode(this.location_.nextConnection);case e.ASTNode.types.PREVIOUS:return e.ASTNode.createBlockNode((t=this.location_).getSourceBlock());case e.ASTNode.types.NEXT:return e.ASTNode.createConnectionNode((t=this.location_).targetConnection)}return null},e.ASTNode.prototype.in=function(){switch(this.type_){case e.ASTNode.types.WORKSPACE:var t=this.location_.getTopBlocks(!0);if(0<t.length)return e.ASTNode.createStackNode(t[0]);break;case e.ASTNode.types.STACK:return this.findTopASTNodeForBlock_(t=this.location_);case e.ASTNode.types.BLOCK:return this.findFirstFieldOrInput_(t=this.location_);case e.ASTNode.types.INPUT:return e.ASTNode.createConnectionNode(this.location_.targetConnection)}return null},e.ASTNode.prototype.prev=function(){switch(this.type_){case e.ASTNode.types.STACK:return this.navigateBetweenStacks_(!1);case e.ASTNode.types.FIELD:return this.findPrevForField_();case e.ASTNode.types.INPUT:return this.findPrevForInput_();case e.ASTNode.types.BLOCK:var t=this.location_;return e.ASTNode.createConnectionNode(t.previousConnection||t.outputConnection);case e.ASTNode.types.PREVIOUS:if((t=(t=this.location_).targetConnection)&&!t.getParentInput())return e.ASTNode.createConnectionNode(t);break;case e.ASTNode.types.NEXT:return e.ASTNode.createBlockNode((t=this.location_).getSourceBlock())}return null},e.ASTNode.prototype.out=function(){switch(this.type_){case e.ASTNode.types.STACK:var t=this.location_,n=t.getRelativeToSurfaceXY();return n=new e.utils.Coordinate(n.x,n.y+e.ASTNode.DEFAULT_OFFSET_Y),e.ASTNode.createWorkspaceNode(t.workspace,n);case e.ASTNode.types.OUTPUT:return(n=(t=this.location_).targetConnection)?e.ASTNode.createConnectionNode(n):e.ASTNode.createStackNode(t.getSourceBlock());case e.ASTNode.types.FIELD:return e.ASTNode.createBlockNode(this.location_.getSourceBlock());case e.ASTNode.types.INPUT:return e.ASTNode.createBlockNode((t=this.location_).getSourceBlock());case e.ASTNode.types.BLOCK:return this.getOutAstNodeForBlock_(t=this.location_);case e.ASTNode.types.PREVIOUS:case e.ASTNode.types.NEXT:return this.getOutAstNodeForBlock_((t=this.location_).getSourceBlock())}return null},e.Blocks=Object.create(null),e.Extensions={},e.Extensions.ALL_=Object.create(null),e.Extensions.register=function(t,n){if("string"!=typeof t||""==t.trim())throw Error('Error: Invalid extension name "'+t+'"');if(e.Extensions.ALL_[t])throw Error('Error: Extension "'+t+'" is already registered.');if("function"!=typeof n)throw Error('Error: Extension "'+t+'" must be a function');e.Extensions.ALL_[t]=n},e.Extensions.registerMixin=function(t,n){if(!n||"object"!=typeof n)throw Error('Error: Mixin "'+t+'" must be a object');e.Extensions.register(t,function(){this.mixin(n)})},e.Extensions.registerMutator=function(t,n,o,r){var a='Error when registering mutator "'+t+'": ';e.Extensions.checkHasFunction_(a,n.domToMutation,"domToMutation"),e.Extensions.checkHasFunction_(a,n.mutationToDom,"mutationToDom");var h=e.Extensions.checkMutatorDialog_(n,a);if(o&&"function"!=typeof o)throw Error('Extension "'+t+'" is not a function');e.Extensions.register(t,function(){if(h){if(!e.Mutator)throw Error(a+"Missing require for Blockly.Mutator");this.setMutator(new e.Mutator(r||[]))}this.mixin(n),o&&o.apply(this)})},e.Extensions.unregister=function(t){e.Extensions.ALL_[t]?delete e.Extensions.ALL_[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},e.Extensions.apply=function(t,n,o){var r=e.Extensions.ALL_[t];if("function"!=typeof r)throw Error('Error: Extension "'+t+'" not found.');if(o)e.Extensions.checkNoMutatorProperties_(t,n);else var a=e.Extensions.getMutatorProperties_(n);if(r.apply(n),o)e.Extensions.checkBlockHasMutatorProperties_('Error after applying mutator "'+t+'": ',n);else if(!e.Extensions.mutatorPropertiesMatch_(a,n))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},e.Extensions.checkHasFunction_=function(t,n,o){if(!n)throw Error(t+'missing required property "'+o+'"');if("function"!=typeof n)throw Error(t+'" required property "'+o+'" must be a function')},e.Extensions.checkNoMutatorProperties_=function(t,n){if(e.Extensions.getMutatorProperties_(n).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+n.id)},e.Extensions.checkMutatorDialog_=function(t,n){var o=void 0!==t.compose,r=void 0!==t.decompose;if(o&&r){if("function"!=typeof t.compose)throw Error(n+"compose must be a function.");if("function"!=typeof t.decompose)throw Error(n+"decompose must be a function.");return!0}if(!o&&!r)return!1;throw Error(n+'Must have both or neither of "compose" and "decompose"')},e.Extensions.checkBlockHasMutatorProperties_=function(t,n){if("function"!=typeof n.domToMutation)throw Error(t+'Applying a mutator didn\'t add "domToMutation"');if("function"!=typeof n.mutationToDom)throw Error(t+'Applying a mutator didn\'t add "mutationToDom"');e.Extensions.checkMutatorDialog_(n,t)},e.Extensions.getMutatorProperties_=function(t){var n=[];return void 0!==t.domToMutation&&n.push(t.domToMutation),void 0!==t.mutationToDom&&n.push(t.mutationToDom),void 0!==t.compose&&n.push(t.compose),void 0!==t.decompose&&n.push(t.decompose),n},e.Extensions.mutatorPropertiesMatch_=function(t,n){if((n=e.Extensions.getMutatorProperties_(n)).length!=t.length)return!1;for(var o=0;o<n.length;o++)if(t[o]!=n[o])return!1;return!0},e.Extensions.buildTooltipForDropdown=function(t,n){var o=[];return"object"==typeof document&&e.utils.runAfterPageLoad(function(){for(var r in n)e.utils.checkMessageReferences(n[r])}),function(){this.type&&-1==o.indexOf(this.type)&&(e.Extensions.checkDropdownOptionsInTable_(this,t,n),o.push(this.type)),this.setTooltip(function(){var r=String(this.getFieldValue(t)),a=n[r];return null==a?-1==o.indexOf(this.type)&&(r="No tooltip mapping for value "+r+" of field "+t,null!=this.type&&(r+=" of block type "+this.type),console.warn(r+".")):a=e.utils.replaceMessageReferences(a),a}.bind(this))}},e.Extensions.checkDropdownOptionsInTable_=function(t,n,o){var r=t.getField(n);if(!r.isOptionListDynamic()){r=r.getOptions();for(var a=0;a<r.length;++a){var h=r[a][1];null==o[h]&&console.warn("No tooltip mapping for value "+h+" of field "+n+" of block type "+t.type)}}},e.Extensions.buildTooltipWithFieldText=function(t,n){return"object"==typeof document&&e.utils.runAfterPageLoad(function(){e.utils.checkMessageReferences(t)}),function(){this.setTooltip(function(){var o=this.getField(n);return e.utils.replaceMessageReferences(t).replace("%1",o?o.getText():"")}.bind(this))}},e.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip,this.setTooltip(function(){var t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||this.tooltipWhenNotConnected_}.bind(this))},e.Extensions.register("parent_tooltip_when_inline",e.Extensions.extensionParentTooltip_),e.fieldRegistry={},e.fieldRegistry.register=function(t,n){e.registry.register(e.registry.Type.FIELD,t,n)},e.fieldRegistry.unregister=function(t){e.registry.unregister(e.registry.Type.FIELD,t)},e.fieldRegistry.fromJson=function(t){var n=e.registry.getObject(e.registry.Type.FIELD,t.type);return n?n.fromJson(t):(console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},e.IDeletable=function(){},e.blockAnimations={},e.blockAnimations.disconnectPid_=0,e.blockAnimations.disconnectGroup_=null,e.blockAnimations.disposeUiEffect=function(t){var n=t.workspace,o=t.getSvgRoot();n.getAudioManager().play("delete"),t=n.getSvgXY(o),(o=o.cloneNode(!0)).translateX_=t.x,o.translateY_=t.y,o.setAttribute("transform","translate("+t.x+","+t.y+")"),n.getParentSvg().appendChild(o),o.bBox_=o.getBBox(),e.blockAnimations.disposeUiStep_(o,n.RTL,new Date,n.scale)},e.blockAnimations.disposeUiStep_=function(t,n,o,r){var a=(new Date-o)/150;1<a?e.utils.dom.removeNode(t):(t.setAttribute("transform","translate("+(t.translateX_+(n?-1:1)*t.bBox_.width*r/2*a)+","+(t.translateY_+t.bBox_.height*r*a)+") scale("+(1-a)*r+")"),setTimeout(e.blockAnimations.disposeUiStep_,10,t,n,o,r))},e.blockAnimations.connectionUiEffect=function(t){var n=t.workspace,o=n.scale;if(n.getAudioManager().play("click"),!(1>o)){var r=n.getSvgXY(t.getSvgRoot());t.outputConnection?(r.x+=(t.RTL?3:-3)*o,r.y+=13*o):t.previousConnection&&(r.x+=(t.RTL?-23:23)*o,r.y+=3*o),t=e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{cx:r.x,cy:r.y,r:0,fill:"none",stroke:"#888","stroke-width":10},n.getParentSvg()),e.blockAnimations.connectionUiStep_(t,new Date,o)}},e.blockAnimations.connectionUiStep_=function(t,n,o){var r=(new Date-n)/150;1<r?e.utils.dom.removeNode(t):(t.setAttribute("r",25*r*o),t.style.opacity=1-r,e.blockAnimations.disconnectPid_=setTimeout(e.blockAnimations.connectionUiStep_,10,t,n,o))},e.blockAnimations.disconnectUiEffect=function(t){if(t.workspace.getAudioManager().play("disconnect"),!(1>t.workspace.scale)){var n=t.getHeightWidth().height;n=Math.atan(10/n)/Math.PI*180,t.RTL||(n*=-1),e.blockAnimations.disconnectUiStep_(t.getSvgRoot(),n,new Date)}},e.blockAnimations.disconnectUiStep_=function(t,n,o){var r=(new Date-o)/200;1<r?t.skew_="":(t.skew_="skewX("+Math.round(Math.sin(r*Math.PI*3)*(1-r)*n)+")",e.blockAnimations.disconnectGroup_=t,e.blockAnimations.disconnectPid_=setTimeout(e.blockAnimations.disconnectUiStep_,10,t,n,o)),t.setAttribute("transform",t.translate_+t.skew_)},e.blockAnimations.disconnectUiStop=function(){if(e.blockAnimations.disconnectGroup_){clearTimeout(e.blockAnimations.disconnectPid_);var t=e.blockAnimations.disconnectGroup_;t.skew_="",t.setAttribute("transform",t.translate_),e.blockAnimations.disconnectGroup_=null}},e.Events.BlockDrag=function(t,n,o){e.Events.BlockDrag.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.isStart=n,this.blocks=o},e.utils.object.inherits(e.Events.BlockDrag,e.Events.UiBase),e.Events.BlockDrag.prototype.type=e.Events.BLOCK_DRAG,e.Events.BlockDrag.prototype.toJson=function(){var t=e.Events.BlockDrag.superClass_.toJson.call(this);return t.isStart=this.isStart,t.blockId=this.blockId,t.blocks=this.blocks,t},e.Events.BlockDrag.prototype.fromJson=function(t){e.Events.BlockDrag.superClass_.fromJson.call(this,t),this.isStart=t.isStart,this.blockId=t.blockId,this.blocks=t.blocks},e.registry.register(e.registry.Type.EVENT,e.Events.BLOCK_DRAG,e.Events.BlockDrag),e.IBlockDragger=function(){},e.InsertionMarkerManager=function(t){this.topBlock_=e.selected=t,this.workspace_=t.workspace,this.lastMarker_=this.lastOnStack_=null,this.firstMarker_=this.createMarkerBlock_(this.topBlock_),this.localConnection_=this.closestConnection_=null,this.wouldDeleteBlock_=!1,this.fadedBlock_=this.highlightedBlock_=this.markerConnection_=null,this.availableConnections_=this.initAvailableConnections_()},e.InsertionMarkerManager.PREVIEW_TYPE={INSERTION_MARKER:0,INPUT_OUTLINE:1,REPLACEMENT_FADE:2},e.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",e.InsertionMarkerManager.prototype.dispose=function(){this.availableConnections_.length=0,e.Events.disable();try{this.firstMarker_&&this.firstMarker_.dispose(),this.lastMarker_&&this.lastMarker_.dispose()}finally{e.Events.enable()}},e.InsertionMarkerManager.prototype.updateAvailableConnections=function(){this.availableConnections_=this.initAvailableConnections_()},e.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},e.InsertionMarkerManager.prototype.wouldConnectBlock=function(){return!!this.closestConnection_},e.InsertionMarkerManager.prototype.applyConnections=function(){if(this.closestConnection_&&(e.Events.disable(),this.hidePreview_(),e.Events.enable(),this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered)){var t=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;e.blockAnimations.connectionUiEffect(t.getSourceBlock()),this.topBlock_.getRootBlock().bringToFront()}},e.InsertionMarkerManager.prototype.update=function(t,n){var o=this.getCandidate_(t);((this.wouldDeleteBlock_=this.shouldDelete_(o,n))||this.shouldUpdatePreviews_(o,t))&&(e.Events.disable(),this.maybeHidePreview_(o),this.maybeShowPreview_(o),e.Events.enable())},e.InsertionMarkerManager.prototype.createMarkerBlock_=function(t){var n=t.type;e.Events.disable();try{var o=this.workspace_.newBlock(n);if(o.setInsertionMarker(!0),t.mutationToDom){var r=t.mutationToDom();r&&o.domToMutation(r)}for(n=0;n<t.inputList.length;n++){var a=t.inputList[n];if(a.name!=e.constants.COLLAPSED_INPUT_NAME){var h=o.inputList[n];if(!h)throw Error(e.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","an input"));for(r=0;r<a.fieldRow.length;r++){var R=a.fieldRow[r],L=h.fieldRow[r];if(!L)throw Error(e.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","a field"));L.setValue(R.getValue())}}}o.setCollapsed(t.isCollapsed()),o.setInputsInline(t.getInputsInline()),o.initSvg(),o.getSvgRoot().setAttribute("visibility","hidden")}finally{e.Events.enable()}return o},e.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var t=this.topBlock_.getConnections_(!1),n=this.topBlock_.lastConnectionInStack(!0);if(n&&n!=this.topBlock_.nextConnection){if(t.push(n),this.lastOnStack_=n,this.lastMarker_){e.Events.disable();try{this.lastMarker_.dispose()}finally{e.Events.enable()}}this.lastMarker_=this.createMarkerBlock_(n.getSourceBlock())}return t},e.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(t,n){var o=t.local,r=t.closest;return t=t.radius,o&&r?this.localConnection_&&this.closestConnection_?!(this.closestConnection_==r&&this.localConnection_==o||(o=this.localConnection_.x+n.x-this.closestConnection_.x,n=this.localConnection_.y+n.y-this.closestConnection_.y,n=Math.sqrt(o*o+n*n),r&&t>n-e.CURRENT_CONNECTION_PREFERENCE)):!this.localConnection_&&!this.closestConnection_||(console.error("Only one of localConnection_ and closestConnection_ was set."),console.error("Returning true from shouldUpdatePreviews, but it's not clear why."),!0):!(!this.localConnection_||!this.closestConnection_)},e.InsertionMarkerManager.prototype.getCandidate_=function(t){for(var n=this.getStartRadius_(),o=null,r=null,a=0;a<this.availableConnections_.length;a++){var h=this.availableConnections_[a],R=h.closest(n,t);R.connection&&(o=R.connection,r=h,n=R.radius)}return{closest:o,local:r,radius:n}},e.InsertionMarkerManager.prototype.getStartRadius_=function(){return this.closestConnection_&&this.localConnection_?e.CONNECTING_SNAP_RADIUS:e.SNAP_RADIUS},e.InsertionMarkerManager.prototype.shouldDelete_=function(t,n){return!(!n||!this.workspace_.getComponentManager().hasCapability(n.id,e.ComponentManager.Capability.DELETE_AREA))&&n.wouldDelete(this.topBlock_,t&&!!t.closest)},e.InsertionMarkerManager.prototype.maybeShowPreview_=function(t){if(!this.wouldDeleteBlock_){var n=t.closest;t=t.local,n&&(n==this.closestConnection_||n.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.closestConnection_=n,this.localConnection_=t,this.showPreview_()))}},e.InsertionMarkerManager.prototype.showPreview_=function(){var t=this.closestConnection_,n=this.workspace_.getRenderer();switch(n.getConnectionPreviewMethod(t,this.localConnection_,this.topBlock_)){case e.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline_();break;case e.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker_();break;case e.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade_()}t&&n.shouldHighlightConnection(t)&&t.highlight()},e.InsertionMarkerManager.prototype.maybeHidePreview_=function(t){if(t.closest){var n=this.closestConnection_!=t.closest;t=this.localConnection_!=t.local,this.closestConnection_&&this.localConnection_&&(n||t||this.wouldDeleteBlock_)&&this.hidePreview_()}else this.hidePreview_();this.localConnection_=this.closestConnection_=this.markerConnection_=null},e.InsertionMarkerManager.prototype.hidePreview_=function(){this.closestConnection_&&this.closestConnection_.targetBlock()&&this.workspace_.getRenderer().shouldHighlightConnection(this.closestConnection_)&&this.closestConnection_.unhighlight(),this.fadedBlock_?this.hideReplacementFade_():this.highlightedBlock_?this.hideInsertionInputOutline_():this.markerConnection_&&this.hideInsertionMarker_()},e.InsertionMarkerManager.prototype.showInsertionMarker_=function(){var t=this.localConnection_,n=this.closestConnection_,o=this.lastOnStack_&&t==this.lastOnStack_?this.lastMarker_:this.firstMarker_;if((t=o.getMatchingConnection(t.getSourceBlock(),t))==this.markerConnection_)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");o.render(),o.rendered=!0,o.getSvgRoot().setAttribute("visibility","visible"),t&&n&&o.positionNearConnection(t,n),n&&t.connect(n),this.markerConnection_=t},e.InsertionMarkerManager.prototype.hideInsertionMarker_=function(){if(this.markerConnection_){var t=this.markerConnection_,n=t.getSourceBlock(),o=n.nextConnection,r=n.previousConnection,a=n.outputConnection;if(a=t.type==e.connectionTypes.INPUT_VALUE&&!(a&&a.targetConnection),!(t!=o||r&&r.targetConnection)||a?t.targetBlock().unplug(!1):t.type==e.connectionTypes.NEXT_STATEMENT&&t!=o?((o=t.targetConnection).getSourceBlock().unplug(!1),r=r?r.targetConnection:null,n.unplug(!0),r&&r.connect(o)):n.unplug(!0),t.targetConnection)throw Error("markerConnection_ still connected at the end of disconnectInsertionMarker");this.markerConnection_=null,(t=n.getSvgRoot())&&t.setAttribute("visibility","hidden")}else console.log("No insertion marker connection to disconnect")},e.InsertionMarkerManager.prototype.showInsertionInputOutline_=function(){var t=this.closestConnection_;this.highlightedBlock_=t.getSourceBlock(),this.highlightedBlock_.highlightShapeForInput(t,!0)},e.InsertionMarkerManager.prototype.hideInsertionInputOutline_=function(){this.highlightedBlock_.highlightShapeForInput(this.closestConnection_,!1),this.highlightedBlock_=null},e.InsertionMarkerManager.prototype.showReplacementFade_=function(){this.fadedBlock_=this.closestConnection_.targetBlock(),this.fadedBlock_.fadeForReplacement(!0)},e.InsertionMarkerManager.prototype.hideReplacementFade_=function(){this.fadedBlock_.fadeForReplacement(!1),this.fadedBlock_=null},e.InsertionMarkerManager.prototype.getInsertionMarkers=function(){var t=[];return this.firstMarker_&&t.push(this.firstMarker_),this.lastMarker_&&t.push(this.lastMarker_),t},e.BlockDragger=function(t,n){this.draggingBlock_=t,this.workspace_=n,this.draggedConnectionManager_=new e.InsertionMarkerManager(this.draggingBlock_),this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=e.BlockDragger.initIconData_(t)},e.BlockDragger.prototype.dispose=function(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()},e.BlockDragger.initIconData_=function(t){var n=[];t=t.getDescendants(!1);for(var r,o=0;r=t[o];o++){r=r.getIcons();for(var a=0;a<r.length;a++){var h={location:r[a].getIconLocation(),icon:r[a]};n.push(h)}}return n},e.BlockDragger.prototype.startDrag=function(t,n){e.Events.getGroup()||e.Events.setGroup(!0),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),e.utils.dom.startTextWidthCache(),this.workspace_.setResizesEnabled(!1),e.blockAnimations.disconnectUiStop(),this.shouldDisconnect_(n)&&this.disconnectBlock_(n,t),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface()},e.BlockDragger.prototype.shouldDisconnect_=function(t){return!!(this.draggingBlock_.getParent()||t&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())},e.BlockDragger.prototype.disconnectBlock_=function(t,n){this.draggingBlock_.unplug(t),t=this.pixelsToWorkspaceUnits_(n),t=e.utils.Coordinate.sum(this.startXY_,t),this.draggingBlock_.translate(t.x,t.y),e.blockAnimations.disconnectUiEffect(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()},e.BlockDragger.prototype.fireDragStartEvent_=function(){var t=new(e.Events.get(e.Events.BLOCK_DRAG))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));e.Events.fire(t)},e.BlockDragger.prototype.drag=function(t,n){n=this.pixelsToWorkspaceUnits_(n);var o=e.utils.Coordinate.sum(this.startXY_,n);this.draggingBlock_.moveDuringDrag(o),this.dragIcons_(n),o=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(t),this.draggedConnectionManager_.update(n,this.dragTarget_),t=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock(),t!=this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==o&&(o&&o.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)},e.BlockDragger.prototype.endDrag=function(t,n){if(this.drag(t,n),this.dragIconData_=[],this.fireDragEndEvent_(),e.utils.dom.stopTextWidthCache(),e.blockAnimations.disconnectUiStop(),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_))t=this.startXY_;else{var o=(t=this.getNewLocationAfterDrag_(n)).delta;t=t.newLocation}this.draggingBlock_.moveOffDragSurface(t),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(!1),o?this.updateBlockAfterMove_(o):e.bumpObjectIntoBounds_(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)),this.workspace_.setResizesEnabled(!0),e.Events.setGroup(!1)},e.BlockDragger.prototype.getNewLocationAfterDrag_=function(t){var n={};return n.delta=this.pixelsToWorkspaceUnits_(t),n.newLocation=e.utils.Coordinate.sum(this.startXY_,n.delta),n},e.BlockDragger.prototype.maybeDeleteBlock_=function(){return!!this.wouldDeleteBlock_&&(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),e.draggingConnections=[],!0)},e.BlockDragger.prototype.updateBlockAfterMove_=function(t){this.draggingBlock_.moveConnections(t.x,t.y),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()},e.BlockDragger.prototype.fireDragEndEvent_=function(){var t=new(e.Events.get(e.Events.BLOCK_DRAG))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));e.Events.fire(t)},e.BlockDragger.prototype.updateToolboxStyle_=function(t){var n=this.workspace_.getToolbox();if(n){var o=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";t&&"function"==typeof n.removeStyle?n.removeStyle(o):t||"function"!=typeof n.addStyle||n.addStyle(o)}},e.BlockDragger.prototype.fireMoveEvent_=function(){var t=new(e.Events.get(e.Events.BLOCK_MOVE))(this.draggingBlock_);t.oldCoordinate=this.startXY_,t.recordNew(),e.Events.fire(t)},e.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)},e.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new e.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},e.BlockDragger.prototype.dragIcons_=function(t){for(var n=0;n<this.dragIconData_.length;n++){var o=this.dragIconData_[n];o.icon.setIconLocation(e.utils.Coordinate.sum(o.location,t))}},e.BlockDragger.prototype.getInsertionMarkers=function(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]},e.registry.register(e.registry.Type.BLOCK_DRAGGER,e.registry.DEFAULT,e.BlockDragger),e.IContextMenu=function(){},e.IDraggable=function(){},e.IBubble=function(){},e.Bubble=function(t,n,o,r,a,h){this.workspace_=t,this.content_=n,this.shape_=o,this.onMouseDownResizeWrapper_=this.onMouseDownBubbleWrapper_=this.moveCallback_=this.resizeCallback_=null,this.disposed=!1,o=e.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(o=-o),this.arrow_radians_=e.utils.math.toRadians(o),t.getBubbleCanvas().appendChild(this.createDom_(n,!(!a||!h))),this.setAnchorLocation(r),a&&h||(a=(t=this.content_.getBBox()).width+2*e.Bubble.BORDER_WIDTH,h=t.height+2*e.Bubble.BORDER_WIDTH),this.setBubbleSize(a,h),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0},e.Bubble.BORDER_WIDTH=6,e.Bubble.ARROW_THICKNESS=5,e.Bubble.ARROW_ANGLE=20,e.Bubble.ARROW_BEND=4,e.Bubble.ANCHOR_RADIUS=8,e.Bubble.onMouseUpWrapper_=null,e.Bubble.onMouseMoveWrapper_=null,e.Bubble.unbindDragEvents_=function(){e.Bubble.onMouseUpWrapper_&&(e.browserEvents.unbind(e.Bubble.onMouseUpWrapper_),e.Bubble.onMouseUpWrapper_=null),e.Bubble.onMouseMoveWrapper_&&(e.browserEvents.unbind(e.Bubble.onMouseMoveWrapper_),e.Bubble.onMouseMoveWrapper_=null)},e.Bubble.bubbleMouseUp_=function(t){e.Touch.clearTouchIdentifier(),e.Bubble.unbindDragEvents_()},e.Bubble.prototype.rendered_=!1,e.Bubble.prototype.anchorXY_=null,e.Bubble.prototype.relativeLeft_=0,e.Bubble.prototype.relativeTop_=0,e.Bubble.prototype.width_=0,e.Bubble.prototype.height_=0,e.Bubble.prototype.autoLayout_=!0,e.Bubble.prototype.createDom_=function(t,n){this.bubbleGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null);var o={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return e.utils.userAgent.JAVA_FX&&(o={}),o=e.utils.dom.createSvgElement(e.utils.Svg.G,o,this.bubbleGroup_),this.bubbleArrow_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{},o),this.bubbleBack_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyDraggable",x:0,y:0,rx:e.Bubble.BORDER_WIDTH,ry:e.Bubble.BORDER_WIDTH},o),n?(this.resizeGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),e.utils.dom.createSvgElement(e.utils.Svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,(n=2*e.Bubble.BORDER_WIDTH).toString())},this.resizeGroup_),e.utils.dom.createSvgElement(e.utils.Svg.LINE,{class:"blocklyResizeLine",x1:n/3,y1:n-1,x2:n-1,y2:n/3},this.resizeGroup_),e.utils.dom.createSvgElement(e.utils.Svg.LINE,{class:"blocklyResizeLine",x1:2*n/3,y1:n-1,x2:n-1,y2:2*n/3},this.resizeGroup_)):this.resizeGroup_=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper_=e.browserEvents.conditionalBind(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&(this.onMouseDownResizeWrapper_=e.browserEvents.conditionalBind(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))),this.bubbleGroup_.appendChild(t),this.bubbleGroup_},e.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_},e.Bubble.prototype.setSvgId=function(t){this.bubbleGroup_.dataset&&(this.bubbleGroup_.dataset.blockId=t)},e.Bubble.prototype.bubbleMouseDown_=function(t){var n=this.workspace_.getGesture(t);n&&n.handleBubbleStart(t,this)},e.Bubble.prototype.showContextMenu=function(t){},e.Bubble.prototype.isDeletable=function(){return!1},e.Bubble.prototype.setDeleteStyle=function(t){},e.Bubble.prototype.resizeMouseDown_=function(t){this.promote(),e.Bubble.unbindDragEvents_(),e.utils.isRightButton(t)||(this.workspace_.startDrag(t,new e.utils.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),e.Bubble.onMouseUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",this,e.Bubble.bubbleMouseUp_),e.Bubble.onMouseMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",this,this.resizeMouseMove_),e.hideChaff()),t.stopPropagation()},e.Bubble.prototype.resizeMouseMove_=function(t){this.autoLayout_=!1,t=this.workspace_.moveDrag(t),this.setBubbleSize(this.workspace_.RTL?-t.x:t.x,t.y),this.workspace_.RTL&&this.positionBubble_()},e.Bubble.prototype.registerResizeEvent=function(t){this.resizeCallback_=t},e.Bubble.prototype.registerMoveEvent=function(t){this.moveCallback_=t},e.Bubble.prototype.promote=function(){var t=this.bubbleGroup_.parentNode;return t.lastChild!==this.bubbleGroup_&&(t.appendChild(this.bubbleGroup_),!0)},e.Bubble.prototype.setAnchorLocation=function(t){this.anchorXY_=t,this.rendered_&&this.positionBubble_()},e.Bubble.prototype.layoutBubble_=function(){var t=this.workspace_.getMetricsManager().getViewMetrics(!0),n=this.getOptimalRelativeLeft_(t),o=this.getOptimalRelativeTop_(t),r=this.shape_.getBBox(),a={x:n,y:-this.height_-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},h={x:-this.width_-30,y:o};o={x:r.width,y:o};var R={x:n,y:r.height};n=r.width<r.height?o:R,r=r.width<r.height?R:o,o=this.getOverlap_(a,t),R=this.getOverlap_(h,t);var L=this.getOverlap_(n,t);t=this.getOverlap_(r,t),o==(t=Math.max(o,R,L,t))?(this.relativeLeft_=a.x,this.relativeTop_=a.y):R==t?(this.relativeLeft_=h.x,this.relativeTop_=h.y):L==t?(this.relativeLeft_=n.x,this.relativeTop_=n.y):(this.relativeLeft_=r.x,this.relativeTop_=r.y)},e.Bubble.prototype.getOverlap_=function(t,n){var o=this.workspace_.RTL?this.anchorXY_.x-t.x-this.width_:t.x+this.anchorXY_.x;return t=t.y+this.anchorXY_.y,Math.max(0,Math.min(1,(Math.min(o+this.width_,n.left+n.width)-Math.max(o,n.left))*(Math.min(t+this.height_,n.top+n.height)-Math.max(t,n.top))/(this.width_*this.height_)))},e.Bubble.prototype.getOptimalRelativeLeft_=function(t){var n=-this.width_/4;if(this.width_>t.width)return n;if(this.workspace_.RTL)var o=this.anchorXY_.x-n,r=o-this.width_,a=t.left+t.width,h=t.left+e.Scrollbar.scrollbarThickness/this.workspace_.scale;else o=(r=n+this.anchorXY_.x)+this.width_,h=t.left,a=t.left+t.width-e.Scrollbar.scrollbarThickness/this.workspace_.scale;return this.workspace_.RTL?r<h?n=-(h-this.anchorXY_.x+this.width_):o>a&&(n=-(a-this.anchorXY_.x)):r<h?n=h-this.anchorXY_.x:o>a&&(n=a-this.anchorXY_.x-this.width_),n},e.Bubble.prototype.getOptimalRelativeTop_=function(t){var n=-this.height_/4;if(this.height_>t.height)return n;var o=this.anchorXY_.y+n,a=t.top;t=t.top+t.height-e.Scrollbar.scrollbarThickness/this.workspace_.scale;var h=this.anchorXY_.y;return o<a?n=a-h:o+this.height_>t&&(n=t-h-this.height_),n},e.Bubble.prototype.positionBubble_=function(){var t=this.anchorXY_.x;this.moveTo(t=this.workspace_.RTL?t-(this.relativeLeft_+this.width_):t+this.relativeLeft_,this.relativeTop_+this.anchorXY_.y)},e.Bubble.prototype.moveTo=function(t,n){this.bubbleGroup_.setAttribute("transform","translate("+t+","+n+")")},e.Bubble.prototype.setDragging=function(t){!t&&this.moveCallback_&&this.moveCallback_()},e.Bubble.prototype.getBubbleSize=function(){return new e.utils.Size(this.width_,this.height_)},e.Bubble.prototype.setBubbleSize=function(t,n){var o=2*e.Bubble.BORDER_WIDTH;t=Math.max(t,o+45),n=Math.max(n,o+20),this.width_=t,this.height_=n,this.bubbleBack_.setAttribute("width",t),this.bubbleBack_.setAttribute("height",n),this.resizeGroup_&&this.resizeGroup_.setAttribute("transform",this.workspace_.RTL?"translate("+2*e.Bubble.BORDER_WIDTH+","+(n-o)+") scale(-1 1)":"translate("+(t-o)+","+(n-o)+")"),this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_(),this.resizeCallback_&&this.resizeCallback_()},e.Bubble.prototype.renderArrow_=function(){var t=[],n=this.width_/2,o=this.height_/2,r=-this.relativeLeft_,a=-this.relativeTop_;if(n==r&&o==a)t.push("M "+n+","+o);else{a-=o,r-=n,this.workspace_.RTL&&(r*=-1);var h=Math.sqrt(a*a+r*r),R=Math.acos(r/h);0>a&&(R=2*Math.PI-R);var L=R+Math.PI/2;L>2*Math.PI&&(L-=2*Math.PI);var W=Math.sin(L),nt=Math.cos(L),et=this.getBubbleSize();L=(et.width+et.height)/e.Bubble.ARROW_THICKNESS,L=Math.min(L,et.width,et.height)/4,r=n+(et=1-e.Bubble.ANCHOR_RADIUS/h)*r,a=o+et*a,et=n+L*nt;var Et=o+L*W;n-=L*nt,o-=L*W,(W=R+this.arrow_radians_)>2*Math.PI&&(W-=2*Math.PI),R=Math.sin(W)*h/e.Bubble.ARROW_BEND,h=Math.cos(W)*h/e.Bubble.ARROW_BEND,t.push("M"+et+","+Et),t.push("C"+(et+h)+","+(Et+R)+" "+r+","+a+" "+r+","+a),t.push("C"+r+","+a+" "+(n+h)+","+(o+R)+" "+n+","+o)}t.push("z"),this.bubbleArrow_.setAttribute("d",t.join(" "))},e.Bubble.prototype.setColour=function(t){this.bubbleBack_.setAttribute("fill",t),this.bubbleArrow_.setAttribute("fill",t)},e.Bubble.prototype.dispose=function(){this.onMouseDownBubbleWrapper_&&e.browserEvents.unbind(this.onMouseDownBubbleWrapper_),this.onMouseDownResizeWrapper_&&e.browserEvents.unbind(this.onMouseDownResizeWrapper_),e.Bubble.unbindDragEvents_(),e.utils.dom.removeNode(this.bubbleGroup_),this.disposed=!0},e.Bubble.prototype.moveDuringDrag=function(t,n){t?t.translateSurface(n.x,n.y):this.moveTo(n.x,n.y),this.relativeLeft_=this.workspace_.RTL?this.anchorXY_.x-n.x-this.width_:n.x-this.anchorXY_.x,this.relativeTop_=n.y-this.anchorXY_.y,this.renderArrow_()},e.Bubble.prototype.getRelativeToSurfaceXY=function(){return new e.utils.Coordinate(this.workspace_.RTL?-this.relativeLeft_+this.anchorXY_.x-this.width_:this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)},e.Bubble.prototype.setAutoLayout=function(t){this.autoLayout_=t},e.Bubble.textToDom=function(t){var n=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:e.Bubble.BORDER_WIDTH},null);t=t.split("\n");for(var o=0;o<t.length;o++){var r=e.utils.dom.createSvgElement(e.utils.Svg.TSPAN,{dy:"1em",x:e.Bubble.BORDER_WIDTH},n),a=document.createTextNode(t[o]);r.appendChild(a)}return n},e.Bubble.createNonEditableBubble=function(t,n,o){if((o=new e.Bubble(n.workspace,t,n.pathObject.svgPath,o,null,null)).setSvgId(n.id),n.RTL){n=t.getBBox().width;for(var a,r=0;a=t.childNodes[r];r++)a.setAttribute("text-anchor","end"),a.setAttribute("x",n+e.Bubble.BORDER_WIDTH)}return o},e.Events.CommentBase=function(t){this.commentId=(this.isBlank=void 0===t)?"":t.id,this.workspaceId=this.isBlank?"":t.workspace.id,this.group=e.Events.getGroup(),this.recordUndo=e.Events.recordUndo},e.utils.object.inherits(e.Events.CommentBase,e.Events.Abstract),e.Events.CommentBase.prototype.toJson=function(){var t=e.Events.CommentBase.superClass_.toJson.call(this);return this.commentId&&(t.commentId=this.commentId),t},e.Events.CommentBase.prototype.fromJson=function(t){e.Events.CommentBase.superClass_.fromJson.call(this,t),this.commentId=t.commentId},e.Events.CommentChange=function(t,n,o){e.Events.CommentChange.superClass_.constructor.call(this,t),t&&(this.oldContents_=void 0===n?"":n,this.newContents_=void 0===o?"":o)},e.utils.object.inherits(e.Events.CommentChange,e.Events.CommentBase),e.Events.CommentChange.prototype.type=e.Events.COMMENT_CHANGE,e.Events.CommentChange.prototype.toJson=function(){var t=e.Events.CommentChange.superClass_.toJson.call(this);return t.oldContents=this.oldContents_,t.newContents=this.newContents_,t},e.Events.CommentChange.prototype.fromJson=function(t){e.Events.CommentChange.superClass_.fromJson.call(this,t),this.oldContents_=t.oldContents,this.newContents_=t.newContents},e.Events.CommentChange.prototype.isNull=function(){return this.oldContents_==this.newContents_},e.Events.CommentChange.prototype.run=function(t){var n=this.getEventWorkspace_().getCommentById(this.commentId);n?n.setContent(t?this.newContents_:this.oldContents_):console.warn("Can't change non-existent comment: "+this.commentId)},e.Events.CommentCreate=function(t){e.Events.CommentCreate.superClass_.constructor.call(this,t),t&&(this.xml=t.toXmlWithXY())},e.utils.object.inherits(e.Events.CommentCreate,e.Events.CommentBase),e.Events.CommentCreate.prototype.type=e.Events.COMMENT_CREATE,e.Events.CommentCreate.prototype.toJson=function(){var t=e.Events.CommentCreate.superClass_.toJson.call(this);return t.xml=e.Xml.domToText(this.xml),t},e.Events.CommentCreate.prototype.fromJson=function(t){e.Events.CommentCreate.superClass_.fromJson.call(this,t),this.xml=e.Xml.textToDom(t.xml)},e.Events.CommentCreate.prototype.run=function(t){e.Events.CommentCreateDeleteHelper(this,t)},e.Events.CommentCreateDeleteHelper=function(t,n){var o=t.getEventWorkspace_();n?((n=e.utils.xml.createElement("xml")).appendChild(t.xml),e.Xml.domToWorkspace(n,o)):(o=o.getCommentById(t.commentId))?o.dispose(!1,!1):console.warn("Can't uncreate non-existent comment: "+t.commentId)},e.Events.CommentDelete=function(t){e.Events.CommentDelete.superClass_.constructor.call(this,t),t&&(this.xml=t.toXmlWithXY())},e.utils.object.inherits(e.Events.CommentDelete,e.Events.CommentBase),e.Events.CommentDelete.prototype.type=e.Events.COMMENT_DELETE,e.Events.CommentDelete.prototype.toJson=function(){return e.Events.CommentDelete.superClass_.toJson.call(this)},e.Events.CommentDelete.prototype.fromJson=function(t){e.Events.CommentDelete.superClass_.fromJson.call(this,t)},e.Events.CommentDelete.prototype.run=function(t){e.Events.CommentCreateDeleteHelper(this,!t)},e.Events.CommentMove=function(t){e.Events.CommentMove.superClass_.constructor.call(this,t),t&&(this.comment_=t,this.oldCoordinate_=t.getXY(),this.newCoordinate_=null)},e.utils.object.inherits(e.Events.CommentMove,e.Events.CommentBase),e.Events.CommentMove.prototype.recordNew=function(){if(!this.comment_)throw Error("Tried to record the new position of a comment on the same event twice.");this.newCoordinate_=this.comment_.getXY(),this.comment_=null},e.Events.CommentMove.prototype.type=e.Events.COMMENT_MOVE,e.Events.CommentMove.prototype.setOldCoordinate=function(t){this.oldCoordinate_=t},e.Events.CommentMove.prototype.toJson=function(){var t=e.Events.CommentMove.superClass_.toJson.call(this);return this.oldCoordinate_&&(t.oldCoordinate=Math.round(this.oldCoordinate_.x)+","+Math.round(this.oldCoordinate_.y)),this.newCoordinate_&&(t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y)),t},e.Events.CommentMove.prototype.fromJson=function(t){if(e.Events.CommentMove.superClass_.fromJson.call(this,t),t.oldCoordinate){var n=t.oldCoordinate.split(",");this.oldCoordinate_=new e.utils.Coordinate(Number(n[0]),Number(n[1]))}t.newCoordinate&&(n=t.newCoordinate.split(","),this.newCoordinate_=new e.utils.Coordinate(Number(n[0]),Number(n[1])))},e.Events.CommentMove.prototype.isNull=function(){return e.utils.Coordinate.equals(this.oldCoordinate_,this.newCoordinate_)},e.Events.CommentMove.prototype.run=function(t){var n=this.getEventWorkspace_().getCommentById(this.commentId);if(n){t=t?this.newCoordinate_:this.oldCoordinate_;var o=n.getXY();n.moveBy(t.x-o.x,t.y-o.y)}else console.warn("Can't move non-existent comment: "+this.commentId)},e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_CREATE,e.Events.CommentCreate),e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_CHANGE,e.Events.CommentChange),e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_MOVE,e.Events.CommentMove),e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_DELETE,e.Events.CommentDelete),e.BubbleDragger=function(t,n){this.draggingBubble_=t,this.workspace_=n,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY(),this.dragSurface_=e.utils.is3dSupported()&&n.getBlockDragSurface()?n.getBlockDragSurface():null},e.BubbleDragger.prototype.dispose=function(){this.dragSurface_=this.workspace_=this.draggingBubble_=null},e.BubbleDragger.prototype.startBubbleDrag=function(){e.Events.getGroup()||e.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),this.draggingBubble_.setAutoLayout(!1),this.dragSurface_&&this.moveToDragSurface_(),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!0)},e.BubbleDragger.prototype.dragBubble=function(t,n){n=this.pixelsToWorkspaceUnits_(n),n=e.utils.Coordinate.sum(this.startXY_,n),this.draggingBubble_.moveDuringDrag(this.dragSurface_,n),n=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(t),t=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),t!=this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==n&&(n&&n.onDragExit(this.draggingBubble_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBubble_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBubble_)},e.BubbleDragger.prototype.shouldDelete_=function(t){return!(!t||!this.workspace_.getComponentManager().hasCapability(t.id,e.ComponentManager.Capability.DELETE_AREA))&&t.wouldDelete(this.draggingBubble_,!1)},e.BubbleDragger.prototype.updateCursorDuringBubbleDrag_=function(){this.draggingBubble_.setDeleteStyle(this.wouldDeleteBubble_)},e.BubbleDragger.prototype.endBubbleDrag=function(t,n){this.dragBubble(t,n),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBubble_)?t=this.startXY_:(t=this.pixelsToWorkspaceUnits_(n),t=e.utils.Coordinate.sum(this.startXY_,t)),this.draggingBubble_.moveTo(t.x,t.y),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBubble_),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.draggingBubble_.dispose(!1,!0)):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas()),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!1),this.fireMoveEvent_()),this.workspace_.setResizesEnabled(!0),e.Events.setGroup(!1)},e.BubbleDragger.prototype.fireMoveEvent_=function(){if(this.draggingBubble_.isComment){var t=new(e.Events.get(e.Events.COMMENT_MOVE))(this.draggingBubble_);t.setOldCoordinate(this.startXY_),t.recordNew(),e.Events.fire(t)}},e.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new e.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},e.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())},e.Events.Click=function(t,n,o){e.Events.Click.superClass_.constructor.call(this,t?t.workspace.id:n),this.blockId=t?t.id:null,this.targetType=o},e.utils.object.inherits(e.Events.Click,e.Events.UiBase),e.Events.Click.prototype.type=e.Events.CLICK,e.Events.Click.prototype.toJson=function(){var t=e.Events.Click.superClass_.toJson.call(this);return t.targetType=this.targetType,this.blockId&&(t.blockId=this.blockId),t},e.Events.Click.prototype.fromJson=function(t){e.Events.Click.superClass_.fromJson.call(this,t),this.targetType=t.targetType,this.blockId=t.blockId},e.registry.register(e.registry.Type.EVENT,e.Events.CLICK,e.Events.Click),e.WorkspaceDragger=function(t){this.workspace_=t,this.horizontalScrollEnabled_=this.workspace_.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace_.isMovableVertically(),this.startScrollXY_=new e.utils.Coordinate(t.scrollX,t.scrollY)},e.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},e.WorkspaceDragger.prototype.startDrag=function(){e.selected&&e.selected.unselect(),this.workspace_.setupDragSurface()},e.WorkspaceDragger.prototype.endDrag=function(t){this.drag(t),this.workspace_.resetDragSurface()},e.WorkspaceDragger.prototype.drag=function(t){if(t=e.utils.Coordinate.sum(this.startScrollXY_,t),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace_.scroll(t.x,t.y);else if(this.horizontalScrollEnabled_)this.workspace_.scroll(t.x,this.workspace_.scrollY);else{if(!this.verticalScrollEnabled_)throw new TypeError("Invalid state.");this.workspace_.scroll(this.workspace_.scrollX,t.y)}},e.Gesture=function(t,n){this.mouseDownXY_=null,this.currentDragDeltaXY_=new e.utils.Coordinate(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.creatorWorkspace_=n,this.isDraggingBubble_=this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=t,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1,this.healStack_=!e.DRAG_STACK},e.Gesture.prototype.dispose=function(){e.Touch.clearTouchIdentifier(),e.Tooltip.unblock(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&e.browserEvents.unbind(this.onMoveWrapper_),this.onUpWrapper_&&e.browserEvents.unbind(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.bubbleDragger_&&this.bubbleDragger_.dispose()},e.Gesture.prototype.updateFromEvent_=function(t){var n=new e.utils.Coordinate(t.clientX,t.clientY);this.updateDragDelta_(n)&&(this.updateIsDragging_(),e.longStop_()),this.mostRecentEvent_=t},e.Gesture.prototype.updateDragDelta_=function(t){return this.currentDragDeltaXY_=e.utils.Coordinate.difference(t,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=e.utils.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?e.FLYOUT_DRAG_RADIUS:e.DRAG_RADIUS))},e.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(!this.targetBlock_||!this.flyout_.isBlockCreatable_(this.targetBlock_)||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),e.Events.getGroup()||e.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),0))},e.Gesture.prototype.updateIsDraggingBubble_=function(){return!!this.startBubble_&&(this.isDraggingBubble_=!0,this.startDraggingBubble_(),!0)},e.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},e.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=new e.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},e.Gesture.prototype.updateIsDragging_=function(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},e.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new(e.registry.getClassFromOptions(e.registry.Type.BLOCK_DRAGGER,this.creatorWorkspace_.options,!0))(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_)},e.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new e.BubbleDragger(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)},e.Gesture.prototype.doStart=function(t){e.utils.isTargetInput(t)?this.cancel():(this.hasStarted_=!0,e.blockAnimations.disconnectUiStop(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),e.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=t,e.Tooltip.block(),this.targetBlock_&&this.targetBlock_.select(),e.utils.isRightButton(t)?this.handleRightClick(t):("touchstart"!=t.type.toLowerCase()&&"pointerdown"!=t.type.toLowerCase()||"mouse"==t.pointerType||e.longStart(t,this),this.mouseDownXY_=new e.utils.Coordinate(t.clientX,t.clientY),this.healStack_=t.altKey||t.ctrlKey||t.metaKey,this.bindMouseEvents(t)))},e.Gesture.prototype.bindMouseEvents=function(t){this.onMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",null,this.handleUp.bind(this)),t.preventDefault(),t.stopPropagation()},e.Gesture.prototype.handleMove=function(t){this.updateFromEvent_(t),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBubble_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),t.preventDefault(),t.stopPropagation()},e.Gesture.prototype.handleUp=function(t){this.updateFromEvent_(t),e.longStop_(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(t,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(t,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(t),t.preventDefault(),t.stopPropagation(),this.dispose())},e.Gesture.prototype.cancel=function(){this.isEnding_||(e.longStop_(),this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},e.Gesture.prototype.handleRightClick=function(t){this.targetBlock_?(this.bringBlockToFront_(),e.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(t)):this.startBubble_?this.startBubble_.showContextMenu(t):this.startWorkspace_&&!this.flyout_&&(e.hideChaff(),this.startWorkspace_.showContextMenu(t)),t.preventDefault(),t.stopPropagation(),this.dispose()},e.Gesture.prototype.handleWsStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(n),this.mostRecentEvent_=t,this.doStart(t)},e.Gesture.prototype.fireWorkspaceClick_=function(t){e.Events.fire(new(e.Events.get(e.Events.CLICK))(null,t.id,"workspace"))},e.Gesture.prototype.handleFlyoutStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(n),this.handleWsStart(t,n.getWorkspace())},e.Gesture.prototype.handleBlockStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(n),this.mostRecentEvent_=t},e.Gesture.prototype.handleBubbleStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(n),this.mostRecentEvent_=t},e.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.setFocus&&this.startBubble_.setFocus(),this.startBubble_.select&&this.startBubble_.select()},e.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()},e.Gesture.prototype.doBlockClick_=function(){if(this.flyout_&&this.flyout_.autoClose)this.targetBlock_.isEnabled()&&(e.Events.getGroup()||e.Events.setGroup(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump());else{var t=new(e.Events.get(e.Events.CLICK))(this.startBlock_,this.startWorkspace_.id,"block");e.Events.fire(t)}this.bringBlockToFront_(),e.Events.setGroup(!1)},e.Gesture.prototype.doWorkspaceClick_=function(t){t=this.creatorWorkspace_,e.selected&&e.selected.unselect(),this.fireWorkspaceClick_(this.startWorkspace_||t)},e.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},e.Gesture.prototype.setStartField=function(t){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=t)},e.Gesture.prototype.setStartBubble=function(t){this.startBubble_||(this.startBubble_=t)},e.Gesture.prototype.setStartBlock=function(t){this.startBlock_||this.startBubble_||(this.startBlock_=t,t.isInFlyout&&t!=t.getRootBlock()?this.setTargetBlock_(t.getRootBlock()):this.setTargetBlock_(t))},e.Gesture.prototype.setTargetBlock_=function(t){t.isShadow()?this.setTargetBlock_(t.getParent()):this.targetBlock_=t},e.Gesture.prototype.setStartWorkspace_=function(t){this.startWorkspace_||(this.startWorkspace_=t)},e.Gesture.prototype.setStartFlyout_=function(t){this.flyout_||(this.flyout_=t)},e.Gesture.prototype.isBubbleClick_=function(){return!!this.startBubble_&&!this.hasExceededDragRadius_},e.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},e.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isClickable()&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)},e.Gesture.prototype.isWorkspaceClick_=function(){return!(this.startBlock_||this.startBubble_||this.startField_||this.hasExceededDragRadius_)},e.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_},e.Gesture.prototype.hasStarted=function(){return this.hasStarted_},e.Gesture.prototype.getInsertionMarkers=function(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]},e.Gesture.prototype.getCurrentDragger=function(){return this.isDraggingBlock_?this.blockDragger_:this.isDraggingWorkspace_?this.workspaceDragger_:this.isDraggingBubble_?this.bubbleDragger_:null},e.Gesture.inProgress=function(){for(var o,t=e.Workspace.getAll(),n=0;o=t[n];n++)if(o.currentGesture_)return!0;return!1},e.IRegistrable=function(){},e.Marker=function(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"},e.Marker.prototype.setDrawer=function(t){this.drawer_=t},e.Marker.prototype.getDrawer=function(){return this.drawer_},e.Marker.prototype.getCurNode=function(){return this.curNode_},e.Marker.prototype.setCurNode=function(t){var n=this.curNode_;this.curNode_=t,this.drawer_&&this.drawer_.draw(n,this.curNode_)},e.Marker.prototype.draw=function(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)},e.Marker.prototype.hide=function(){this.drawer_&&this.drawer_.hide()},e.Marker.prototype.dispose=function(){this.getDrawer()&&this.getDrawer().dispose()},e.Cursor=function(){e.Cursor.superClass_.constructor.call(this),this.type="cursor"},e.utils.object.inherits(e.Cursor,e.Marker),e.Cursor.prototype.next=function(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()==e.ASTNode.types.NEXT||t.getType()==e.ASTNode.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t},e.Cursor.prototype.in=function(){var t=this.getCurNode();return t?((t.getType()==e.ASTNode.types.PREVIOUS||t.getType()==e.ASTNode.types.OUTPUT)&&(t=t.next()),(t=t.in())&&this.setCurNode(t),t):null},e.Cursor.prototype.prev=function(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()==e.ASTNode.types.NEXT||t.getType()==e.ASTNode.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t},e.Cursor.prototype.out=function(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()==e.ASTNode.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null},e.registry.register(e.registry.Type.CURSOR,e.registry.DEFAULT,e.Cursor),e.MarkerManager=function(t){this.cursorSvg_=this.cursor_=null,this.markers_=Object.create(null),this.workspace_=t},e.MarkerManager.LOCAL_MARKER="local_marker_1",e.MarkerManager.prototype.registerMarker=function(t,n){this.markers_[t]&&this.unregisterMarker(t),n.setDrawer(this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,n)),this.setMarkerSvg(n.getDrawer().createDom()),this.markers_[t]=n},e.MarkerManager.prototype.unregisterMarker=function(t){var n=this.markers_[t];if(!n)throw Error("Marker with ID "+t+" does not exist. Can only unregister markers that exist.");n.dispose(),delete this.markers_[t]},e.MarkerManager.prototype.getCursor=function(){return this.cursor_},e.MarkerManager.prototype.getMarker=function(t){return this.markers_[t]||null},e.MarkerManager.prototype.setCursor=function(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(t=this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,this.cursor_),this.cursor_.setDrawer(t),this.setCursorSvg(this.cursor_.getDrawer().createDom()))},e.MarkerManager.prototype.setCursorSvg=function(t){t?(this.workspace_.getBlockCanvas().appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},e.MarkerManager.prototype.setMarkerSvg=function(t){t?this.workspace_.getBlockCanvas()&&(this.cursorSvg_?this.workspace_.getBlockCanvas().insertBefore(t,this.cursorSvg_):this.workspace_.getBlockCanvas().appendChild(t)):this.markerSvg_=null},e.MarkerManager.prototype.updateMarkers=function(){this.workspace_.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace_.getCursor().draw()},e.MarkerManager.prototype.dispose=function(){for(var o,t=Object.keys(this.markers_),n=0;o=t[n];n++)this.unregisterMarker(o);this.markers_=null,this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)},e.WidgetDiv={},e.WidgetDiv.owner_=null,e.WidgetDiv.dispose_=null,e.WidgetDiv.rendererClassName_="",e.WidgetDiv.themeClassName_="",e.WidgetDiv.createDom=function(){e.WidgetDiv.DIV||(e.WidgetDiv.DIV=document.createElement("div"),e.WidgetDiv.DIV.className="blocklyWidgetDiv",(e.parentContainer||document.body).appendChild(e.WidgetDiv.DIV))},e.WidgetDiv.show=function(t,n,o){e.WidgetDiv.hide(),e.WidgetDiv.owner_=t,e.WidgetDiv.dispose_=o,(t=e.WidgetDiv.DIV).style.direction=n?"rtl":"ltr",t.style.display="block",n=e.getMainWorkspace(),e.WidgetDiv.rendererClassName_=n.getRenderer().getClassName(),e.WidgetDiv.themeClassName_=n.getTheme().getClassName(),e.utils.dom.addClass(t,e.WidgetDiv.rendererClassName_),e.utils.dom.addClass(t,e.WidgetDiv.themeClassName_)},e.WidgetDiv.hide=function(){if(e.WidgetDiv.isVisible()){e.WidgetDiv.owner_=null;var t=e.WidgetDiv.DIV;t.style.display="none",t.style.left="",t.style.top="",e.WidgetDiv.dispose_&&e.WidgetDiv.dispose_(),e.WidgetDiv.dispose_=null,t.textContent="",e.WidgetDiv.rendererClassName_&&(e.utils.dom.removeClass(t,e.WidgetDiv.rendererClassName_),e.WidgetDiv.rendererClassName_=""),e.WidgetDiv.themeClassName_&&(e.utils.dom.removeClass(t,e.WidgetDiv.themeClassName_),e.WidgetDiv.themeClassName_=""),e.getMainWorkspace().markFocused()}},e.WidgetDiv.isVisible=function(){return!!e.WidgetDiv.owner_},e.WidgetDiv.hideIfOwner=function(t){e.WidgetDiv.owner_==t&&e.WidgetDiv.hide()},e.WidgetDiv.positionInternal_=function(t,n,o){e.WidgetDiv.DIV.style.left=t+"px",e.WidgetDiv.DIV.style.top=n+"px",e.WidgetDiv.DIV.style.height=o+"px"},e.WidgetDiv.positionWithAnchor=function(t,n,o,r){var a=e.WidgetDiv.calculateY_(t,n,o);t=e.WidgetDiv.calculateX_(t,n,o,r),0>a?e.WidgetDiv.positionInternal_(t,0,o.height+a):e.WidgetDiv.positionInternal_(t,a,o.height)},e.WidgetDiv.calculateX_=function(t,n,o,r){return r?(n=Math.max(n.right-o.width,t.left),Math.min(n,t.right-o.width)):(n=Math.min(n.left,t.right-o.width),Math.max(n,t.left))},e.WidgetDiv.calculateY_=function(t,n,o){return n.bottom+o.height>=t.bottom?n.top-o.height:n.bottom},e.Field=function(t,n,o){this.value_=this.DEFAULT_VALUE,this.tooltip_=this.validator_=null,this.size_=new e.utils.Size(0,0),this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=null,o&&this.configure_(o),this.setValue(t),n&&this.setValidator(n)},e.Field.prototype.DEFAULT_VALUE=null,e.Field.prototype.name=void 0,e.Field.prototype.disposed=!1,e.Field.prototype.maxDisplayLength=50,e.Field.prototype.sourceBlock_=null,e.Field.prototype.isDirty_=!0,e.Field.prototype.visible_=!0,e.Field.prototype.clickTarget_=null,e.Field.NBSP="\xa0",e.Field.prototype.EDITABLE=!0,e.Field.prototype.SERIALIZABLE=!1,e.Field.prototype.configure_=function(t){var n=t.tooltip;"string"==typeof n&&(n=e.utils.replaceMessageReferences(t.tooltip)),n&&this.setTooltip(n)},e.Field.prototype.setSourceBlock=function(t){if(this.sourceBlock_)throw Error("Field already bound to a block.");this.sourceBlock_=t},e.Field.prototype.getConstants=function(){return!this.constants_&&this.sourceBlock_&&this.sourceBlock_.workspace&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_},e.Field.prototype.getSourceBlock=function(){return this.sourceBlock_},e.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())},e.Field.prototype.initView=function(){this.createBorderRect_(),this.createTextElement_()},e.Field.prototype.initModel=function(){},e.Field.prototype.createBorderRect_=function(){this.borderRect_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)},e.Field.prototype.createTextElement_=function(){this.textElement_=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)},e.Field.prototype.bindEvents_=function(){e.Tooltip.bindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_=e.browserEvents.conditionalBind(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)},e.Field.prototype.fromXml=function(t){this.setValue(t.textContent)},e.Field.prototype.toXml=function(t){return t.textContent=this.getValue(),t},e.Field.prototype.dispose=function(){e.DropDownDiv.hideIfOwner(this),e.WidgetDiv.hideIfOwner(this),e.Tooltip.unbindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_&&e.browserEvents.unbind(this.mouseDownWrapper_),e.utils.dom.removeNode(this.fieldGroup_),this.disposed=!0},e.Field.prototype.updateEditable=function(){var t=this.fieldGroup_;this.EDITABLE&&t&&(this.sourceBlock_.isEditable()?(e.utils.dom.addClass(t,"blocklyEditableText"),e.utils.dom.removeClass(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(e.utils.dom.addClass(t,"blocklyNonEditableText"),e.utils.dom.removeClass(t,"blocklyEditableText"),t.style.cursor=""))},e.Field.prototype.isClickable=function(){return!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&!!this.showEditor_&&"function"==typeof this.showEditor_},e.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},e.Field.prototype.isSerializable=function(){var t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t},e.Field.prototype.isVisible=function(){return this.visible_},e.Field.prototype.setVisible=function(t){if(this.visible_!=t){this.visible_=t;var n=this.getSvgRoot();n&&(n.style.display=t?"block":"none")}},e.Field.prototype.setValidator=function(t){this.validator_=t},e.Field.prototype.getValidator=function(){return this.validator_},e.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},e.Field.prototype.applyColour=function(){},e.Field.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()},e.Field.prototype.showEditor=function(t){this.isClickable()&&this.showEditor_(t)},e.Field.prototype.updateSize_=function(t){var n=this.getConstants(),o=2*(t=null!=t?t:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0),r=n.FIELD_TEXT_HEIGHT,a=0;this.textElement_&&(o+=a=e.utils.dom.getFastTextWidth(this.textElement_,n.FIELD_TEXT_FONTSIZE,n.FIELD_TEXT_FONTWEIGHT,n.FIELD_TEXT_FONTFAMILY)),this.borderRect_&&(r=Math.max(r,n.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=r,this.size_.width=o,this.positionTextElement_(t,a),this.positionBorderRect_()},e.Field.prototype.positionTextElement_=function(t,n){if(this.textElement_){var o=this.getConstants(),r=this.size_.height/2;this.textElement_.setAttribute("x",this.sourceBlock_.RTL?this.size_.width-n-t:t),this.textElement_.setAttribute("y",o.FIELD_TEXT_BASELINE_CENTER?r:r-o.FIELD_TEXT_HEIGHT/2+o.FIELD_TEXT_BASELINE)}},e.Field.prototype.positionBorderRect_=function(){this.borderRect_&&(this.borderRect_.setAttribute("width",this.size_.width),this.borderRect_.setAttribute("height",this.size_.height),this.borderRect_.setAttribute("rx",this.getConstants().FIELD_BORDER_RECT_RADIUS),this.borderRect_.setAttribute("ry",this.getConstants().FIELD_BORDER_RECT_RADIUS))},e.Field.prototype.getSize=function(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0==this.size_.width&&(console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead."),this.render_()),this.size_):new e.utils.Size(0,0)},e.Field.prototype.getScaledBBox=function(){if(this.borderRect_)t=this.borderRect_.getBoundingClientRect(),o=e.utils.style.getPageOffset(this.borderRect_),r=t.width,t=t.height;else{var t=this.sourceBlock_.getHeightWidth(),n=this.sourceBlock_.workspace.scale,o=this.getAbsoluteXY_(),r=t.width*n;t=t.height*n,e.utils.userAgent.GECKO?(o.x+=1.5*n,o.y+=1.5*n):e.utils.userAgent.EDGE||e.utils.userAgent.IE||(o.x-=.5*n,o.y-=.5*n),r+=1*n,t+=1*n}return new e.utils.Rect(o.y,o.y+t,o.x,o.x+r)},e.Field.prototype.getDisplayText_=function(){var t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+"\u2026"),t=t.replace(/\s/g,e.Field.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+="\u200f"),t):e.Field.NBSP},e.Field.prototype.getText=function(){if(this.getText_){var t=this.getText_.call(this);if(null!==t)return String(t)}return String(this.getValue())},e.Field.prototype.markDirty=function(){this.isDirty_=!0,this.constants_=null},e.Field.prototype.forceRerender=function(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())},e.Field.prototype.setValue=function(t){if(null!==t){var n=this.doClassValidation_(t);if(!((t=this.processValidation_(t,n))instanceof Error)){if((n=this.getValidator())&&(n=n.call(this,t),(t=this.processValidation_(t,n))instanceof Error))return;if(!(n=this.sourceBlock_)||!n.disposed){var o=this.getValue();o===t?this.doValueUpdate_(t):(n&&e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(n,"field",this.name||null,o,t)),this.doValueUpdate_(t),this.isDirty_&&this.forceRerender())}}}},e.Field.prototype.processValidation_=function(t,n){return null===n?(this.doValueInvalid_(t),this.isDirty_&&this.forceRerender(),Error()):(void 0!==n&&(t=n),t)},e.Field.prototype.getValue=function(){return this.value_},e.Field.prototype.doClassValidation_=function(t){return null==t?null:t},e.Field.prototype.doValueUpdate_=function(t){this.value_=t,this.isDirty_=!0},e.Field.prototype.doValueInvalid_=function(t){},e.Field.prototype.onMouseDown_=function(t){this.sourceBlock_&&this.sourceBlock_.workspace&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)},e.Field.prototype.setTooltip=function(t){t||""===t||(t=this.sourceBlock_);var n=this.getClickTarget_();n?n.tooltip=t:this.tooltip_=t},e.Field.prototype.getTooltip=function(){var t=this.getClickTarget_();return e.Tooltip.getTooltipOfObject(t||{tooltip:this.tooltip_})},e.Field.prototype.getClickTarget_=function(){return this.clickTarget_||this.getSvgRoot()},e.Field.prototype.getAbsoluteXY_=function(){return e.utils.style.getPageOffset(this.getClickTarget_())},e.Field.prototype.referencesVariables=function(){return!1},e.Field.prototype.getParentInput=function(){for(var t=null,n=this.sourceBlock_,o=n.inputList,r=0;r<n.inputList.length;r++)for(var a=o[r],h=a.fieldRow,R=0;R<h.length;R++)if(h[R]===this){t=a;break}return t},e.Field.prototype.getFlipRtl=function(){return!1},e.Field.prototype.isTabNavigable=function(){return!1},e.Field.prototype.onShortcut=function(t){return!1},e.Field.prototype.setCursorSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},e.Field.prototype.setMarkerSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.markerSvg_=t):this.markerSvg_=null},e.Field.prototype.updateMarkers_=function(){var t=this.sourceBlock_.workspace;t.keyboardAccessibilityMode&&this.cursorSvg_&&t.getCursor().draw(),t.keyboardAccessibilityMode&&this.markerSvg_&&t.getMarker(e.MarkerManager.LOCAL_MARKER).draw()},e.FieldLabel=function(t,n,o){this.class_=null,e.FieldLabel.superClass_.constructor.call(this,t,null,o),o||(this.class_=n||null)},e.utils.object.inherits(e.FieldLabel,e.Field),e.FieldLabel.prototype.DEFAULT_VALUE="",e.FieldLabel.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldLabel(n,void 0,t)},e.FieldLabel.prototype.EDITABLE=!1,e.FieldLabel.prototype.configure_=function(t){e.FieldLabel.superClass_.configure_.call(this,t),this.class_=t.class},e.FieldLabel.prototype.initView=function(){this.createTextElement_(),this.class_&&e.utils.dom.addClass(this.textElement_,this.class_)},e.FieldLabel.prototype.doClassValidation_=function(t){return null==t?null:String(t)},e.FieldLabel.prototype.setClass=function(t){this.textElement_&&(this.class_&&e.utils.dom.removeClass(this.textElement_,this.class_),t&&e.utils.dom.addClass(this.textElement_,t)),this.class_=t},e.fieldRegistry.register("field_label",e.FieldLabel),e.Input=function(t,n,o,r){if(t!=e.inputTypes.DUMMY&&!n)throw Error("Value inputs and statement inputs must have non-empty name.");this.type=t,this.name=n,this.sourceBlock_=o,this.connection=r,this.fieldRow=[]},e.Input.prototype.align=e.constants.ALIGN.LEFT,e.Input.prototype.visible_=!0,e.Input.prototype.getSourceBlock=function(){return this.sourceBlock_},e.Input.prototype.appendField=function(t,n){return this.insertFieldAt(this.fieldRow.length,t,n),this},e.Input.prototype.insertFieldAt=function(t,n,o){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return(n||""==n&&o)&&("string"==typeof n&&(n=e.fieldRegistry.fromJson({type:"field_label",text:n})),n.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&(n.init(),n.applyColour()),n.name=o,n.setVisible(this.isVisible()),n.prefixField&&(t=this.insertFieldAt(t,n.prefixField)),this.fieldRow.splice(t,0,n),++t,n.suffixField&&(t=this.insertFieldAt(t,n.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours())),t},e.Input.prototype.removeField=function(t,n){for(var r,o=0;r=this.fieldRow[o];o++)if(r.name===t)return r.dispose(),this.fieldRow.splice(o,1),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),!0;if(n)return!1;throw Error('Field "'+t+'" not found.')},e.Input.prototype.isVisible=function(){return this.visible_},e.Input.prototype.setVisible=function(t){var n=[];if(this.visible_==t)return n;this.visible_=t;for(var r,o=0;r=this.fieldRow[o];o++)r.setVisible(t);return this.connection&&(this.connection=this.connection,t?n=this.connection.startTrackingAll():this.connection.stopTrackingAll(),o=this.connection.targetBlock())&&(o.getSvgRoot().style.display=t?"block":"none"),n},e.Input.prototype.markDirty=function(){for(var n,t=0;n=this.fieldRow[t];t++)n.markDirty()},e.Input.prototype.setCheck=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this},e.Input.prototype.setAlign=function(t){return this.align=t,this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render()),this},e.Input.prototype.setShadowDom=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(t),this},e.Input.prototype.getShadowDom=function(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()},e.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var t=0;t<this.fieldRow.length;t++)this.fieldRow[t].init()},e.Input.prototype.dispose=function(){for(var n,t=0;n=this.fieldRow[t];t++)n.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null},e.Block=function(t,n,o){if(e.Generator&&void 0!==e.Generator.prototype[n])throw Error('Block prototypeName "'+n+'" conflicts with Blockly.Generator members.');if(this.id=o&&!t.getBlockById(o)?o:e.utils.genUid(),t.setBlockById(this.id,this),this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.comment=this.outputShape_=null,this.commentModel={text:null,pinned:!1,size:new e.utils.Size(160,80)},this.xy_=new e.utils.Coordinate(0,0),this.workspace=t,this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,this.isInsertionMarker_=!1,this.hat=void 0,this.rendered=null,this.statementInputCount=0,n){if(this.type=n,!(o=e.Blocks[n])||"object"!=typeof o)throw TypeError("Unknown block type: "+n);e.utils.object.mixin(this,o)}t.addTopBlock(this),t.addTypedBlock(this),(t=e.Events.getGroup())||e.Events.setGroup(!0),n=e.Events.recordUndo;try{"function"==typeof this.init&&(e.Events.recordUndo=!1,this.init(),e.Events.recordUndo=n),e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(this))}finally{t||e.Events.setGroup(!1),e.Events.recordUndo=n}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)},e.Block.COLLAPSED_INPUT_NAME=e.constants.COLLAPSED_INPUT_NAME,e.Block.COLLAPSED_FIELD_NAME=e.constants.COLLAPSED_FIELD_NAME,e.Block.prototype.data=null,e.Block.prototype.disposed=!1,e.Block.prototype.hue_=null,e.Block.prototype.colour_="#000000",e.Block.prototype.styleName_="",e.Block.prototype.dispose=function(t){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_DELETE))(this)),e.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.workspace=null),e.selected==this&&(e.selected=null);for(var n=this.childBlocks_.length-1;0<=n;n--)this.childBlocks_[n].dispose(!1);n=0;for(var o;o=this.inputList[n];n++)o.dispose();this.inputList.length=0;var a,r=this.getConnections_(!0);for(n=0;a=r[n];n++)a.dispose()}finally{e.Events.enable(),this.disposed=!0}}},e.Block.prototype.initModel=function(){for(var n,t=0;n=this.inputList[t];t++)for(var r,o=0;r=n.fieldRow[o];o++)r.initModel&&r.initModel()},e.Block.prototype.unplug=function(t){this.outputConnection?this.unplugFromRow_(t):this.previousConnection&&this.unplugFromStack_(t)},e.Block.prototype.unplugFromRow_=function(t){var n=null;this.outputConnection.isConnected()&&(n=this.outputConnection.targetConnection,this.outputConnection.disconnect()),n&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&((t=t.targetConnection).disconnect(),this.workspace.connectionChecker.canConnect(t,n,!1)?n.connect(t):t.onFailedConnect(n))},e.Block.prototype.getOnlyValueConnection_=function(){for(var t=null,n=0;n<this.inputList.length;n++){var o=this.inputList[n].connection;if(o&&o.type==e.connectionTypes.INPUT_VALUE&&o.targetConnection){if(t)return null;t=o}}return t},e.Block.prototype.unplugFromStack_=function(t){var n=null;this.previousConnection.isConnected()&&(n=this.previousConnection.targetConnection,this.previousConnection.disconnect());var o=this.getNextBlock();t&&o&&!o.isShadow()&&((t=this.nextConnection.targetConnection).disconnect(),n&&this.workspace.connectionChecker.canConnect(n,t,!1)&&n.connect(t))},e.Block.prototype.getConnections_=function(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(var o,n=0;o=this.inputList[n];n++)o.connection&&t.push(o.connection);return t},e.Block.prototype.lastConnectionInStack=function(t){for(var n=this.nextConnection;n;){var o=n.targetBlock();if(!o||t&&o.isShadow())return n;n=o.nextConnection}return null},e.Block.prototype.bumpNeighbours=function(){},e.Block.prototype.getParent=function(){return this.parentBlock_},e.Block.prototype.getInputWithBlock=function(t){for(var o,n=0;o=this.inputList[n];n++)if(o.connection&&o.connection.targetBlock()==t)return o;return null},e.Block.prototype.getSurroundParent=function(){var t=this;do{var n=t;if(!(t=t.getParent()))return null}while(t.getNextBlock()==n);return t},e.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},e.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()},e.Block.prototype.getFirstStatementConnection=function(){for(var n,t=0;n=this.inputList[t];t++)if(n.connection&&n.connection.type==e.connectionTypes.NEXT_STATEMENT)return n.connection;return null},e.Block.prototype.getRootBlock=function(){var t=this;do{var n=t;t=n.parentBlock_}while(t);return n},e.Block.prototype.getTopStackBlock=function(){var t=this;do{var n=t.getPreviousBlock()}while(n&&n.getNextBlock()==t&&(t=n));return t},e.Block.prototype.getChildren=function(t){if(!t)return this.childBlocks_;t=[];for(var o,n=0;o=this.inputList[n];n++)o.connection&&(o=o.connection.targetBlock())&&t.push(o);return(n=this.getNextBlock())&&t.push(n),t},e.Block.prototype.setParent=function(t){if(t!=this.parentBlock_){if(this.parentBlock_){if(e.utils.arrayRemove(this.parentBlock_.childBlocks_,this),this.previousConnection&&this.previousConnection.isConnected())throw Error("Still connected to previous block.");if(this.outputConnection&&this.outputConnection.isConnected())throw Error("Still connected to parent block.");this.parentBlock_=null}else this.workspace.removeTopBlock(this);(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}},e.Block.prototype.getDescendants=function(t){for(var r,n=[this],o=this.getChildren(t),a=0;r=o[a];a++)n.push.apply(n,r.getDescendants(t));return n},e.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},e.Block.prototype.setDeletable=function(t){this.deletable_=t},e.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},e.Block.prototype.setMovable=function(t){this.movable_=t},e.Block.prototype.isDuplicatable=function(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(e.utils.getBlockTypeCounts(this,!0))},e.Block.prototype.isShadow=function(){return this.isShadow_},e.Block.prototype.setShadow=function(t){this.isShadow_=t},e.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_},e.Block.prototype.setInsertionMarker=function(t){this.isInsertionMarker_=t},e.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},e.Block.prototype.setEditable=function(t){this.editable_=t,t=0;for(var n;n=this.inputList[t];t++)for(var r,o=0;r=n.fieldRow[o];o++)r.updateEditable()},e.Block.prototype.isDisposed=function(){return this.disposed},e.Block.prototype.getMatchingConnection=function(t,n){var o=this.getConnections_(!0);if(t=t.getConnections_(!0),o.length!=t.length)throw Error("Connection lists did not match in length.");for(var r=0;r<t.length;r++)if(t[r]==n)return o[r];return null},e.Block.prototype.setHelpUrl=function(t){this.helpUrl=t},e.Block.prototype.setTooltip=function(t){this.tooltip=t},e.Block.prototype.getTooltip=function(){return e.Tooltip.getTooltipOfObject(this)},e.Block.prototype.getColour=function(){return this.colour_},e.Block.prototype.getStyleName=function(){return this.styleName_},e.Block.prototype.getHue=function(){return this.hue_},e.Block.prototype.setColour=function(t){t=e.utils.parseBlockColour(t),this.hue_=t.hue,this.colour_=t.hex},e.Block.prototype.setStyle=function(t){this.styleName_=t},e.Block.prototype.setOnChange=function(t){if(t&&"function"!=typeof t)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=t)&&(this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},e.Block.prototype.getField=function(t){if("string"!=typeof t)throw TypeError("Blockly.Block.prototype.getField expects a string with the field name but received "+(void 0===t?"nothing":t+" of type "+typeof t)+" instead");for(var o,n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)if(a.name===t)return a;return null},e.Block.prototype.getVars=function(){for(var o,t=[],n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)a.referencesVariables()&&t.push(a.getValue());return t},e.Block.prototype.getVarModels=function(){for(var o,t=[],n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)a.referencesVariables()&&(a=this.workspace.getVariableById(a.getValue()))&&t.push(a);return t},e.Block.prototype.updateVarName=function(t){for(var o,n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)a.referencesVariables()&&t.getId()==a.getValue()&&a.refreshVariableName()},e.Block.prototype.renameVarById=function(t,n){for(var r,o=0;r=this.inputList[o];o++)for(var h,a=0;h=r.fieldRow[a];a++)h.referencesVariables()&&t==h.getValue()&&h.setValue(n)},e.Block.prototype.getFieldValue=function(t){return(t=this.getField(t))?t.getValue():null},e.Block.prototype.setFieldValue=function(t,n){var o=this.getField(n);if(!o)throw Error('Field "'+n+'" not found.');o.setValue(t)},e.Block.prototype.setPreviousStatement=function(t,n){if(t){if(void 0===n&&(n=null),!this.previousConnection){if(this.outputConnection)throw Error("Remove output connection prior to adding previous connection.");this.previousConnection=this.makeConnection_(e.connectionTypes.PREVIOUS_STATEMENT)}this.previousConnection.setCheck(n)}else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}},e.Block.prototype.setNextStatement=function(t,n){if(t)void 0===n&&(n=null),this.nextConnection||(this.nextConnection=this.makeConnection_(e.connectionTypes.NEXT_STATEMENT)),this.nextConnection.setCheck(n);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}},e.Block.prototype.setOutput=function(t,n){if(t){if(void 0===n&&(n=null),!this.outputConnection){if(this.previousConnection)throw Error("Remove previous connection prior to adding output connection.");this.outputConnection=this.makeConnection_(e.connectionTypes.OUTPUT_VALUE)}this.outputConnection.setCheck(n)}else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}},e.Block.prototype.setInputsInline=function(t){this.inputsInline!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)},e.Block.prototype.getInputsInline=function(){if(null!=this.inputsInline)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==e.inputTypes.DUMMY&&this.inputList[t].type==e.inputTypes.DUMMY)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==e.inputTypes.VALUE&&this.inputList[t].type==e.inputTypes.DUMMY)return!0;return!1},e.Block.prototype.setOutputShape=function(t){this.outputShape_=t},e.Block.prototype.getOutputShape=function(){return this.outputShape_},e.Block.prototype.isEnabled=function(){return!this.disabled},e.Block.prototype.setEnabled=function(t){this.isEnabled()!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"disabled",null,this.disabled,!t)),this.disabled=!t)},e.Block.prototype.getInheritedDisabled=function(){for(var t=this.getSurroundParent();t;){if(t.disabled)return!0;t=t.getSurroundParent()}return!1},e.Block.prototype.isCollapsed=function(){return this.collapsed_},e.Block.prototype.setCollapsed=function(t){this.collapsed_!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)},e.Block.prototype.toString=function(t,n){function o(nt){var et=nt.getCheck();return!et&&nt.targetConnection&&(et=nt.targetConnection.getCheck()),!!et&&(-1!=et.indexOf("Boolean")||-1!=et.indexOf("Number"))}function r(){R&&R.getType()==L.getType()&&R.getLocation()==L.getLocation()&&(R=null)}var a=[];n=n||"?";var h=e.ASTNode.NAVIGATE_ALL_FIELDS;e.ASTNode.NAVIGATE_ALL_FIELDS=!0;for(var R=e.ASTNode.createBlockNode(this),L=R;R;){switch(R.getType()){case e.ASTNode.types.INPUT:var W=R.getLocation();R.in()?o(W)&&a.push("("):a.push(n);break;case e.ASTNode.types.FIELD:(W=R.getLocation()).name!=e.constants.COLLAPSED_FIELD_NAME&&a.push(W.getText())}if(!(R=(W=R).in()||W.next())){for(R=W.out(),r();R&&!R.next();)R=R.out(),r(),R&&R.getType()==e.ASTNode.types.INPUT&&o(R.getLocation())&&a.push(")");R&&(R=R.next())}}for(e.ASTNode.NAVIGATE_ALL_FIELDS=h,n=2;n<a.length;n++)"("==a[n-2]&&")"==a[n]&&(a[n-2]=a[n-1],a.splice(n-1,2));return a=(a=a.reduce(function(nt,et){return nt+("("==nt.substr(-1)||")"==et?"":" ")+et},"")).trim()||"???",t&&a.length>t&&(a=a.substring(0,t-3)+"..."),a},e.Block.prototype.appendValueInput=function(t){return this.appendInput_(e.inputTypes.VALUE,t)},e.Block.prototype.appendStatementInput=function(t){return this.appendInput_(e.inputTypes.STATEMENT,t)},e.Block.prototype.appendDummyInput=function(t){return this.appendInput_(e.inputTypes.DUMMY,t||"")},e.Block.prototype.jsonInit=function(t){var n=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(n+"Must not have both an output and a previousStatement.");if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(n+"Must not have both a colour and a style.");t.style?this.jsonInitStyle_(t,n):this.jsonInitColour_(t,n);for(var o=0;void 0!==t["message"+o];)this.interpolate_(t["message"+o],t["args"+o]||[],t["lastDummyAlign"+o],n),o++;if(void 0!==t.inputsInline&&this.setInputsInline(t.inputsInline),void 0!==t.output&&this.setOutput(!0,t.output),void 0!==t.outputShape&&this.setOutputShape(t.outputShape),void 0!==t.previousStatement&&this.setPreviousStatement(!0,t.previousStatement),void 0!==t.nextStatement&&this.setNextStatement(!0,t.nextStatement),void 0!==t.tooltip&&(o=e.utils.replaceMessageReferences(o=t.tooltip),this.setTooltip(o)),void 0!==t.enableContextMenu&&(this.contextMenu=!!(o=t.enableContextMenu)),void 0!==t.helpUrl&&(o=e.utils.replaceMessageReferences(o=t.helpUrl),this.setHelpUrl(o)),"string"==typeof t.extensions&&(console.warn(n+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),void 0!==t.mutator&&e.Extensions.apply(t.mutator,this,!0),t=t.extensions,Array.isArray(t))for(n=0;n<t.length;++n)e.Extensions.apply(t[n],this,!1)},e.Block.prototype.jsonInitColour_=function(t,n){if("colour"in t)if(void 0===t.colour)console.warn(n+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch(o){console.warn(n+"Illegal colour value: ",t)}}},e.Block.prototype.jsonInitStyle_=function(t,n){t=t.style;try{this.setStyle(t)}catch(o){console.warn(n+"Style does not exist: ",t)}},e.Block.prototype.mixin=function(t,n){if(void 0!==n&&"boolean"!=typeof n)throw Error("opt_disableCheck must be a boolean if provided");if(!n){for(var o in n=[],t)void 0!==this[o]&&n.push(o);if(n.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(n))}e.utils.object.mixin(this,t)},e.Block.prototype.interpolate_=function(t,n,o,r){t=e.utils.tokenizeInterpolation(t),this.validateTokens_(t,n.length),n=this.interpolateArguments_(t,n,o),o=[],t=0;for(var a;a=n[t];t++)if(this.isInputKeyword_(a.type)){if(a=this.inputFromJson_(a,r)){for(var R,h=0;R=o[h];h++)a.appendField(R[0],R[1]);o.length=0}}else(h=this.fieldFromJson_(a))&&o.push([h,a.name])},e.Block.prototype.validateTokens_=function(t,n){for(var o=[],r=0,a=0;a<t.length;a++){var h=t[a];if("number"==typeof h){if(1>h||h>n)throw Error('Block "'+this.type+'": Message index %'+h+" out of range.");if(o[h])throw Error('Block "'+this.type+'": Message index %'+h+" duplicated.");o[h]=!0,r++}}if(r!=n)throw Error('Block "'+this.type+'": Message does not reference all '+n+" arg(s).")},e.Block.prototype.interpolateArguments_=function(t,n,o){for(var r=[],a=0;a<t.length;a++){var h=t[a];"number"==typeof h&&(h=n[h-1]),("string"!=typeof h||(h=this.stringToFieldJson_(h)))&&r.push(h)}return(t=r.length)&&!this.isInputKeyword_(r[t-1].type)&&(t={type:"input_dummy"},o&&(t.align=o),r.push(t)),r},e.Block.prototype.fieldFromJson_=function(t){var n=e.fieldRegistry.fromJson(t);return!n&&t.alt?"string"==typeof t.alt?(t=this.stringToFieldJson_(t.alt))?this.fieldFromJson_(t):null:this.fieldFromJson_(t.alt):n},e.Block.prototype.inputFromJson_=function(t,n){var o={LEFT:e.constants.ALIGN.LEFT,RIGHT:e.constants.ALIGN.RIGHT,CENTRE:e.constants.ALIGN.CENTRE,CENTER:e.constants.ALIGN.CENTRE},r=null;switch(t.type){case"input_value":r=this.appendValueInput(t.name);break;case"input_statement":r=this.appendStatementInput(t.name);break;case"input_dummy":r=this.appendDummyInput(t.name)}return r?(t.check&&r.setCheck(t.check),t.align&&(void 0===(o=o[t.align.toUpperCase()])?console.warn(n+"Illegal align value: ",t.align):r.setAlign(o)),r):null},e.Block.prototype.isInputKeyword_=function(t){return"input_value"==t||"input_statement"==t||"input_dummy"==t},e.Block.prototype.stringToFieldJson_=function(t){return(t=t.trim())?{type:"field_label",text:t}:null},e.Block.prototype.appendInput_=function(t,n){var o=null;return(t==e.inputTypes.VALUE||t==e.inputTypes.STATEMENT)&&(o=this.makeConnection_(t)),t==e.inputTypes.STATEMENT&&this.statementInputCount++,t=new e.Input(t,n,this,o),this.inputList.push(t),t},e.Block.prototype.moveInputBefore=function(t,n){if(t!=n){for(var h,o=-1,r=n?-1:this.inputList.length,a=0;h=this.inputList[a];a++)if(h.name==t){if(o=a,-1!=r)break}else if(n&&h.name==n&&(r=a,-1!=o))break;if(-1==o)throw Error('Named input "'+t+'" not found.');if(-1==r)throw Error('Reference input "'+n+'" not found.');this.moveNumberedInputBefore(o,r)}},e.Block.prototype.moveNumberedInputBefore=function(t,n){if(t==n)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(n>this.inputList.length)throw RangeError("Reference input "+n+" out of bounds.");var o=this.inputList[t];this.inputList.splice(t,1),t<n&&n--,this.inputList.splice(n,0,o)},e.Block.prototype.removeInput=function(t,n){for(var r,o=0;r=this.inputList[o];o++)if(r.name==t)return r.type==e.inputTypes.STATEMENT&&this.statementInputCount--,r.dispose(),this.inputList.splice(o,1),!0;if(n)return!1;throw Error("Input not found: "+t)},e.Block.prototype.getInput=function(t){for(var o,n=0;o=this.inputList[n];n++)if(o.name==t)return o;return null},e.Block.prototype.getInputTargetBlock=function(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()},e.Block.prototype.getCommentText=function(){return this.commentModel.text},e.Block.prototype.setCommentText=function(t){this.commentModel.text!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"comment",null,this.commentModel.text,t)),this.comment=this.commentModel.text=t)},e.Block.prototype.setWarningText=function(t,n){},e.Block.prototype.setMutator=function(t){},e.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},e.Block.prototype.moveBy=function(t,n){if(this.parentBlock_)throw Error("Block has parent.");var o=new(e.Events.get(e.Events.BLOCK_MOVE))(this);this.xy_.translate(t,n),o.recordNew(),e.Events.fire(o)},e.Block.prototype.makeConnection_=function(t){return new e.Connection(this,t)},e.Block.prototype.allInputsFilled=function(t){if(void 0===t&&(t=!0),!t&&this.isShadow())return!1;for(var o,n=0;o=this.inputList[n];n++)if(o.connection&&(!(o=o.connection.targetBlock())||!o.allInputsFilled(t)))return!1;return!(n=this.getNextBlock())||n.allInputsFilled(t)},e.Block.prototype.toDevString=function(){var t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t},e.blockRendering.IPathObject=function(t,n){},e.utils.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,FF_HASH:163,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},e.Menu=function(){this.menuItems_=[],this.roleName_=this.element_=this.onKeyDownHandler_=this.mouseLeaveHandler_=this.mouseEnterHandler_=this.clickHandler_=this.mouseOverHandler_=this.highlightedItem_=this.openingCoords=null},e.Menu.prototype.addChild=function(t){this.menuItems_.push(t)},e.Menu.prototype.render=function(t){var n=document.createElement("div");n.className="blocklyMenu goog-menu blocklyNonSelectable",n.tabIndex=0,this.roleName_&&e.utils.aria.setRole(n,this.roleName_),this.element_=n;for(var r,o=0;r=this.menuItems_[o];o++)n.appendChild(r.createDom());this.mouseOverHandler_=e.browserEvents.conditionalBind(n,"mouseover",this,this.handleMouseOver_,!0),this.clickHandler_=e.browserEvents.conditionalBind(n,"click",this,this.handleClick_,!0),this.mouseEnterHandler_=e.browserEvents.conditionalBind(n,"mouseenter",this,this.handleMouseEnter_,!0),this.mouseLeaveHandler_=e.browserEvents.conditionalBind(n,"mouseleave",this,this.handleMouseLeave_,!0),this.onKeyDownHandler_=e.browserEvents.conditionalBind(n,"keydown",this,this.handleKeyEvent_),t.appendChild(n)},e.Menu.prototype.getElement=function(){return this.element_},e.Menu.prototype.focus=function(){var t=this.getElement();t&&(t.focus({preventScroll:!0}),e.utils.dom.addClass(t,"blocklyFocused"))},e.Menu.prototype.blur_=function(){var t=this.getElement();t&&(t.blur(),e.utils.dom.removeClass(t,"blocklyFocused"))},e.Menu.prototype.setRole=function(t){this.roleName_=t},e.Menu.prototype.dispose=function(){this.mouseOverHandler_&&(e.browserEvents.unbind(this.mouseOverHandler_),this.mouseOverHandler_=null),this.clickHandler_&&(e.browserEvents.unbind(this.clickHandler_),this.clickHandler_=null),this.mouseEnterHandler_&&(e.browserEvents.unbind(this.mouseEnterHandler_),this.mouseEnterHandler_=null),this.mouseLeaveHandler_&&(e.browserEvents.unbind(this.mouseLeaveHandler_),this.mouseLeaveHandler_=null),this.onKeyDownHandler_&&(e.browserEvents.unbind(this.onKeyDownHandler_),this.onKeyDownHandler_=null);for(var n,t=0;n=this.menuItems_[t];t++)n.dispose();this.element_=null},e.Menu.prototype.getMenuItem_=function(t){for(var n=this.getElement();t&&t!=n;){if(e.utils.dom.hasClass(t,"blocklyMenuItem"))for(var r,o=0;r=this.menuItems_[o];o++)if(r.getElement()==t)return r;t=t.parentElement}return null},e.Menu.prototype.setHighlighted=function(t){var n=this.highlightedItem_;n&&(n.setHighlighted(!1),this.highlightedItem_=null),t&&(t.setHighlighted(!0),this.highlightedItem_=t,n=this.getElement(),e.utils.style.scrollIntoContainerView(t.getElement(),n),e.utils.aria.setState(n,e.utils.aria.State.ACTIVEDESCENDANT,t.getId()))},e.Menu.prototype.highlightNext=function(){var t=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(t,1)},e.Menu.prototype.highlightPrevious=function(){var t=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(0>t?this.menuItems_.length:t,-1)},e.Menu.prototype.highlightFirst_=function(){this.highlightHelper_(-1,1)},e.Menu.prototype.highlightLast_=function(){this.highlightHelper_(this.menuItems_.length,-1)},e.Menu.prototype.highlightHelper_=function(t,n){t+=n;for(var o;o=this.menuItems_[t];){if(o.isEnabled()){this.setHighlighted(o);break}t+=n}},e.Menu.prototype.handleMouseOver_=function(t){(t=this.getMenuItem_(t.target))&&(t.isEnabled()?this.highlightedItem_!=t&&this.setHighlighted(t):this.setHighlighted(null))},e.Menu.prototype.handleClick_=function(t){var n=this.openingCoords;if(this.openingCoords=null,n&&"number"==typeof t.clientX){var o=new e.utils.Coordinate(t.clientX,t.clientY);if(1>e.utils.Coordinate.distance(n,o))return}(t=this.getMenuItem_(t.target))&&t.performAction()},e.Menu.prototype.handleMouseEnter_=function(t){this.focus()},e.Menu.prototype.handleMouseLeave_=function(t){this.getElement()&&(this.blur_(),this.setHighlighted(null))},e.Menu.prototype.handleKeyEvent_=function(t){if(this.menuItems_.length&&!(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)){var n=this.highlightedItem_;switch(t.keyCode){case e.utils.KeyCodes.ENTER:case e.utils.KeyCodes.SPACE:n&&n.performAction();break;case e.utils.KeyCodes.UP:this.highlightPrevious();break;case e.utils.KeyCodes.DOWN:this.highlightNext();break;case e.utils.KeyCodes.PAGE_UP:case e.utils.KeyCodes.HOME:this.highlightFirst_();break;case e.utils.KeyCodes.PAGE_DOWN:case e.utils.KeyCodes.END:this.highlightLast_();break;default:return}t.preventDefault(),t.stopPropagation()}},e.Menu.prototype.getSize=function(){var t=this.getElement(),n=e.utils.style.getSize(t);return n.height=t.scrollHeight,n},e.MenuItem=function(t,n){this.content_=t,this.value_=n,this.enabled_=!0,this.element_=null,this.rightToLeft_=!1,this.roleName_=null,this.highlight_=this.checked_=this.checkable_=!1,this.actionHandler_=null},e.MenuItem.prototype.createDom=function(){var t=document.createElement("div");t.id=e.utils.IdGenerator.getNextUniqueId(),this.element_=t,t.className="blocklyMenuItem goog-menuitem "+(this.enabled_?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked_?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight_?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft_?"blocklyMenuItemRtl goog-menuitem-rtl ":"");var n=document.createElement("div");if(n.className="blocklyMenuItemContent goog-menuitem-content",this.checkable_){var o=document.createElement("div");o.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",n.appendChild(o)}return o=this.content_,"string"==typeof this.content_&&(o=document.createTextNode(this.content_)),n.appendChild(o),t.appendChild(n),this.roleName_&&e.utils.aria.setRole(t,this.roleName_),e.utils.aria.setState(t,e.utils.aria.State.SELECTED,this.checkable_&&this.checked_||!1),e.utils.aria.setState(t,e.utils.aria.State.DISABLED,!this.enabled_),t},e.MenuItem.prototype.dispose=function(){this.element_=null},e.MenuItem.prototype.getElement=function(){return this.element_},e.MenuItem.prototype.getId=function(){return this.element_.id},e.MenuItem.prototype.getValue=function(){return this.value_},e.MenuItem.prototype.setRightToLeft=function(t){this.rightToLeft_=t},e.MenuItem.prototype.setRole=function(t){this.roleName_=t},e.MenuItem.prototype.setCheckable=function(t){this.checkable_=t},e.MenuItem.prototype.setChecked=function(t){this.checked_=t},e.MenuItem.prototype.setHighlighted=function(t){this.highlight_=t;var n=this.getElement();n&&this.isEnabled()&&(t?(e.utils.dom.addClass(n,"blocklyMenuItemHighlight"),e.utils.dom.addClass(n,"goog-menuitem-highlight")):(e.utils.dom.removeClass(n,"blocklyMenuItemHighlight"),e.utils.dom.removeClass(n,"goog-menuitem-highlight")))},e.MenuItem.prototype.isEnabled=function(){return this.enabled_},e.MenuItem.prototype.setEnabled=function(t){this.enabled_=t},e.MenuItem.prototype.performAction=function(){this.isEnabled()&&this.actionHandler_&&this.actionHandler_(this)},e.MenuItem.prototype.onAction=function(t,n){this.actionHandler_=t.bind(n)},e.ContextMenu={},e.ContextMenu.currentBlock=null,e.ContextMenu.menu_=null,e.ContextMenu.show=function(t,n,o){if(e.WidgetDiv.show(e.ContextMenu,o,e.ContextMenu.dispose),n.length){var r=e.ContextMenu.populate_(n,o);e.ContextMenu.menu_=r,e.ContextMenu.position_(r,t,o),setTimeout(function(){r.focus()},1),e.ContextMenu.currentBlock=null}else e.ContextMenu.hide()},e.ContextMenu.populate_=function(t,n){var o=new e.Menu;o.setRole(e.utils.aria.Role.MENU);for(var a,r=0;a=t[r];r++){var h=new e.MenuItem(a.text);h.setRightToLeft(n),h.setRole(e.utils.aria.Role.MENUITEM),o.addChild(h),h.setEnabled(a.enabled),a.enabled&&h.onAction(function(R){e.ContextMenu.hide(),this.callback(this.scope)},a)}return o},e.ContextMenu.position_=function(t,n,o){var r=e.utils.getViewportBBox();n=new e.utils.Rect(n.clientY+r.top,n.clientY+r.top,n.clientX+r.left,n.clientX+r.left),e.ContextMenu.createWidget_(t);var a=t.getSize();o&&(n.left+=a.width,n.right+=a.width,r.left+=a.width,r.right+=a.width),e.WidgetDiv.positionWithAnchor(r,n,a,o),t.focus()},e.ContextMenu.createWidget_=function(t){t.render(e.WidgetDiv.DIV);var n=t.getElement();e.utils.dom.addClass(n,"blocklyContextMenu"),e.browserEvents.conditionalBind(n,"contextmenu",null,e.utils.noEvent),t.focus()},e.ContextMenu.hide=function(){e.WidgetDiv.hideIfOwner(e.ContextMenu),e.ContextMenu.currentBlock=null},e.ContextMenu.dispose=function(){e.ContextMenu.menu_&&(e.ContextMenu.menu_.dispose(),e.ContextMenu.menu_=null)},e.ContextMenu.callbackFactory=function(t,n){return function(){e.Events.disable();try{var o=e.Xml.domToBlock(n,t.workspace),r=t.getRelativeToSurfaceXY();r.x=t.RTL?r.x-e.SNAP_RADIUS:r.x+e.SNAP_RADIUS,r.y+=2*e.SNAP_RADIUS,o.moveBy(r.x,r.y)}finally{e.Events.enable()}e.Events.isEnabled()&&!o.isShadow()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(o)),o.select()}},e.ContextMenu.commentDeleteOption=function(t){return{text:e.Msg.REMOVE_COMMENT,enabled:!0,callback:function(){e.Events.setGroup(!0),t.dispose(!0,!0),e.Events.setGroup(!1)}}},e.ContextMenu.commentDuplicateOption=function(t){return{text:e.Msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){e.duplicate(t)}}},e.ContextMenu.workspaceCommentOption=function(t,n){if(!e.WorkspaceCommentSvg)throw Error("Missing require for Blockly.WorkspaceCommentSvg");var o={enabled:!e.utils.userAgent.IE};return o.text=e.Msg.ADD_COMMENT,o.callback=function(){var r=new e.WorkspaceCommentSvg(t,e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT,e.WorkspaceCommentSvg.DEFAULT_SIZE,e.WorkspaceCommentSvg.DEFAULT_SIZE),a=t.getInjectionDiv().getBoundingClientRect();a=new e.utils.Coordinate(n.clientX-a.left,n.clientY-a.top);var h=t.getOriginOffsetInPixels();(a=e.utils.Coordinate.difference(a,h)).scale(1/t.scale),r.moveBy(a.x,a.y),t.rendered&&(r.initSvg(),r.render(),r.select())},o},e.ContextMenuRegistry=function(){e.ContextMenuRegistry.registry=this,this.registry_=Object.create(null)},e.ContextMenuRegistry.ScopeType={BLOCK:"block",WORKSPACE:"workspace"},e.ContextMenuRegistry.registry=null,e.ContextMenuRegistry.prototype.register=function(t){if(this.registry_[t.id])throw Error('Menu item with ID "'+t.id+'" is already registered.');this.registry_[t.id]=t},e.ContextMenuRegistry.prototype.unregister=function(t){if(!this.registry_[t])throw Error('Menu item with ID "'+t+'" not found.');delete this.registry_[t]},e.ContextMenuRegistry.prototype.getItem=function(t){return this.registry_[t]||null},e.ContextMenuRegistry.prototype.getContextMenuOptions=function(t,n){var o=[],r=this.registry_;return Object.keys(r).forEach(function(a){if(t==(a=r[a]).scopeType){var h=a.preconditionFn(n);"hidden"!=h&&(a={text:"function"==typeof a.displayText?a.displayText(n):a.displayText,enabled:"enabled"==h,callback:a.callback,scope:n,weight:a.weight},o.push(a))}}),o.sort(function(a,h){return a.weight-h.weight}),o},new e.ContextMenuRegistry,e.Events.Selected=function(t,n,o){e.Events.Selected.superClass_.constructor.call(this,o),this.oldElementId=t,this.newElementId=n},e.utils.object.inherits(e.Events.Selected,e.Events.UiBase),e.Events.Selected.prototype.type=e.Events.SELECTED,e.Events.Selected.prototype.toJson=function(){var t=e.Events.Selected.superClass_.toJson.call(this);return t.oldElementId=this.oldElementId,t.newElementId=this.newElementId,t},e.Events.Selected.prototype.fromJson=function(t){e.Events.Selected.superClass_.fromJson.call(this,t),this.oldElementId=t.oldElementId,this.newElementId=t.newElementId},e.registry.register(e.registry.Type.EVENT,e.Events.SELECTED,e.Events.Selected),e.IBoundedElement=function(){},e.ICopyable=function(){},e.RenderedConnection=function(t,n){e.RenderedConnection.superClass_.constructor.call(this,t,n),this.db_=t.workspace.connectionDBList[n],this.dbOpposite_=t.workspace.connectionDBList[e.OPPOSITE_TYPE[n]],this.offsetInBlock_=new e.utils.Coordinate(0,0),this.trackedState_=e.RenderedConnection.TrackedState.WILL_TRACK,this.targetConnection=null},e.utils.object.inherits(e.RenderedConnection,e.Connection),e.RenderedConnection.TrackedState={WILL_TRACK:-1,UNTRACKED:0,TRACKED:1},e.RenderedConnection.prototype.dispose=function(){e.RenderedConnection.superClass_.dispose.call(this),this.trackedState_==e.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)},e.RenderedConnection.prototype.getSourceBlock=function(){return e.RenderedConnection.superClass_.getSourceBlock.call(this)},e.RenderedConnection.prototype.targetBlock=function(){return e.RenderedConnection.superClass_.targetBlock.call(this)},e.RenderedConnection.prototype.distanceFrom=function(t){var n=this.x-t.x;return t=this.y-t.y,Math.sqrt(n*n+t*t)},e.RenderedConnection.prototype.bumpAwayFrom=function(t){if(!this.sourceBlock_.workspace.isDragging()){var n=this.sourceBlock_.getRootBlock();if(!n.isInFlyout){var o=!1;if(!n.isMovable()){if(!(n=t.getSourceBlock().getRootBlock()).isMovable())return;t=this,o=!0}var r=e.selected==n;r||n.addSelect();var a=t.x+e.SNAP_RADIUS+Math.floor(Math.random()*e.BUMP_RANDOMNESS)-this.x,h=t.y+e.SNAP_RADIUS+Math.floor(Math.random()*e.BUMP_RANDOMNESS)-this.y;o&&(h=-h),n.RTL&&(a=t.x-e.SNAP_RADIUS-Math.floor(Math.random()*e.BUMP_RANDOMNESS)-this.x),n.moveBy(a,h),r||n.removeSelect()}}},e.RenderedConnection.prototype.moveTo=function(t,n){this.trackedState_==e.RenderedConnection.TrackedState.WILL_TRACK?(this.db_.addConnection(this,n),this.trackedState_=e.RenderedConnection.TrackedState.TRACKED):this.trackedState_==e.RenderedConnection.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,n)),this.x=t,this.y=n},e.RenderedConnection.prototype.moveBy=function(t,n){this.moveTo(this.x+t,this.y+n)},e.RenderedConnection.prototype.moveToOffset=function(t){this.moveTo(t.x+this.offsetInBlock_.x,t.y+this.offsetInBlock_.y)},e.RenderedConnection.prototype.setOffsetInBlock=function(t,n){this.offsetInBlock_.x=t,this.offsetInBlock_.y=n},e.RenderedConnection.prototype.getOffsetInBlock=function(){return this.offsetInBlock_},e.RenderedConnection.prototype.tighten=function(){var t=this.targetConnection.x-this.x,n=this.targetConnection.y-this.y;if(0!=t||0!=n){var o=this.targetBlock(),r=o.getSvgRoot();if(!r)throw Error("block is not rendered.");r=e.utils.getRelativeXY(r),o.getSvgRoot().setAttribute("transform","translate("+(r.x-t)+","+(r.y-n)+")"),o.moveConnections(-t,-n)}},e.RenderedConnection.prototype.closest=function(t,n){return this.dbOpposite_.searchForClosest(this,t,n)},e.RenderedConnection.prototype.highlight=function(){var t=this.sourceBlock_.workspace.getRenderer().getConstants(),n=t.shapeFor(this);n=this.type==e.connectionTypes.INPUT_VALUE||this.type==e.connectionTypes.OUTPUT_VALUE?e.utils.svgPaths.moveBy(0,-(t=t.TAB_OFFSET_FROM_TOP))+e.utils.svgPaths.lineOnAxis("v",t)+n.pathDown+e.utils.svgPaths.lineOnAxis("v",t):e.utils.svgPaths.moveBy(-(t=t.NOTCH_OFFSET_LEFT-t.CORNER_RADIUS),0)+e.utils.svgPaths.lineOnAxis("h",t)+n.pathLeft+e.utils.svgPaths.lineOnAxis("h",t),t=this.sourceBlock_.getRelativeToSurfaceXY(),e.Connection.highlightedPath_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyHighlightedConnectionPath",d:n,transform:"translate("+(this.x-t.x)+","+(this.y-t.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},e.RenderedConnection.prototype.unhighlight=function(){e.utils.dom.removeNode(e.Connection.highlightedPath_),delete e.Connection.highlightedPath_},e.RenderedConnection.prototype.setTracking=function(t){t&&this.trackedState_==e.RenderedConnection.TrackedState.TRACKED||!t&&this.trackedState_==e.RenderedConnection.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(t?(this.db_.addConnection(this,this.y),this.trackedState_=e.RenderedConnection.TrackedState.TRACKED):(this.trackedState_==e.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=e.RenderedConnection.TrackedState.UNTRACKED))},e.RenderedConnection.prototype.stopTrackingAll=function(){if(this.setTracking(!1),this.targetConnection)for(var t=this.targetBlock().getDescendants(!1),n=0;n<t.length;n++){for(var o=t[n],r=o.getConnections_(!0),a=0;a<r.length;a++)r[a].setTracking(!1);for(o=o.getIcons(),a=0;a<o.length;a++)o[a].setVisible(!1)}},e.RenderedConnection.prototype.startTrackingAll=function(){this.setTracking(!0);var t=[];if(this.type!=e.connectionTypes.INPUT_VALUE&&this.type!=e.connectionTypes.NEXT_STATEMENT)return t;var n=this.targetBlock();if(n){if(n.isCollapsed()){var o=[];n.outputConnection&&o.push(n.outputConnection),n.nextConnection&&o.push(n.nextConnection),n.previousConnection&&o.push(n.previousConnection)}else o=n.getConnections_(!0);for(var r=0;r<o.length;r++)t.push.apply(t,o[r].startTrackingAll());t.length||(t[0]=n)}return t},e.RenderedConnection.prototype.isConnectionAllowed=function(t,n){return e.utils.deprecation.warn("RenderedConnection.prototype.isConnectionAllowed","July 2020","July 2021","Blockly.Workspace.prototype.getConnectionChecker().canConnect"),!(this.distanceFrom(t)>n)&&e.RenderedConnection.superClass_.isConnectionAllowed.call(this,t)},e.RenderedConnection.prototype.onFailedConnect=function(t){var n=this.getSourceBlock();if(e.Events.recordUndo){var o=e.Events.getGroup();setTimeout(function(){n.isDisposed()||n.getParent()||(e.Events.setGroup(o),this.bumpAwayFrom(t),e.Events.setGroup(!1))}.bind(this),e.BUMP_DELAY)}},e.RenderedConnection.prototype.disconnectInternal_=function(t,n){e.RenderedConnection.superClass_.disconnectInternal_.call(this,t,n),t.rendered&&t.render(),n.rendered&&(n.updateDisabled(),n.render(),n.getSvgRoot().style.display="block")},e.RenderedConnection.prototype.respawnShadow_=function(){e.RenderedConnection.superClass_.respawnShadow_.call(this);var t=this.targetBlock();t&&(t.initSvg(),t.render(!1),(t=this.getSourceBlock()).rendered&&t.render())},e.RenderedConnection.prototype.neighbours=function(t){return this.dbOpposite_.getNeighbours(this,t)},e.RenderedConnection.prototype.connect_=function(t){e.RenderedConnection.superClass_.connect_.call(this,t);var n=this.getSourceBlock();t=t.getSourceBlock();var o=n.rendered,r=t.rendered;o&&n.updateDisabled(),r&&t.updateDisabled(),o&&r&&(this.type==e.connectionTypes.NEXT_STATEMENT||this.type==e.connectionTypes.PREVIOUS_STATEMENT?t.render():n.render()),(n=n.getInputWithBlock(t))&&(n=n.isVisible(),t.getSvgRoot().style.display=n?"block":"none")},e.RenderedConnection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())},e.BasicCursor=function(){e.BasicCursor.superClass_.constructor.call(this)},e.utils.object.inherits(e.BasicCursor,e.Cursor),e.BasicCursor.registrationName="basicCursor",e.BasicCursor.prototype.next=function(){var t=this.getCurNode();return t?((t=this.getNextNode_(t,this.validNode_))&&this.setCurNode(t),t):null},e.BasicCursor.prototype.in=function(){return this.next()},e.BasicCursor.prototype.prev=function(){var t=this.getCurNode();return t?((t=this.getPreviousNode_(t,this.validNode_))&&this.setCurNode(t),t):null},e.BasicCursor.prototype.out=function(){return this.prev()},e.BasicCursor.prototype.getNextNode_=function(t,n){if(!t)return null;var o=t.in()||t.next();return n(o)?o:o?this.getNextNode_(o,n):n(t=this.findSiblingOrParent_(t.out()))?t:t?this.getNextNode_(t,n):null},e.BasicCursor.prototype.getPreviousNode_=function(t,n){if(!t)return null;var o=t.prev();return n(o=o?this.getRightMostChild_(o):t.out())?o:o?this.getPreviousNode_(o,n):null},e.BasicCursor.prototype.validNode_=function(t){var n=!1;return((t=t&&t.getType())==e.ASTNode.types.OUTPUT||t==e.ASTNode.types.INPUT||t==e.ASTNode.types.FIELD||t==e.ASTNode.types.NEXT||t==e.ASTNode.types.PREVIOUS||t==e.ASTNode.types.WORKSPACE)&&(n=!0),n},e.BasicCursor.prototype.findSiblingOrParent_=function(t){return t?t.next()||this.findSiblingOrParent_(t.out()):null},e.BasicCursor.prototype.getRightMostChild_=function(t){if(!t.in())return t;for(t=t.in();t.next();)t=t.next();return this.getRightMostChild_(t)},e.registry.register(e.registry.Type.CURSOR,e.BasicCursor.registrationName,e.BasicCursor),e.TabNavigateCursor=function(){e.TabNavigateCursor.superClass_.constructor.call(this)},e.utils.object.inherits(e.TabNavigateCursor,e.BasicCursor),e.TabNavigateCursor.prototype.validNode_=function(t){var n=!1,o=t&&t.getType();return t&&(t=t.getLocation(),o==e.ASTNode.types.FIELD&&t&&t.isTabNavigable()&&t.isClickable()&&(n=!0)),n},e.BlockSvg=function(t,n,o){this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null),this.svgGroup_.translate_="",this.style=t.getRenderer().getConstants().getBlockStyle(null),this.pathObject=t.getRenderer().makePathObject(this.svgGroup_,this.style),this.renderIsInProgress_=this.rendered=!1,this.workspace=t,this.previousConnection=this.nextConnection=this.outputConnection=null,this.useDragSurface_=e.utils.is3dSupported()&&!!t.getBlockDragSurface();var r=this.pathObject.svgPath;r.tooltip=this,e.Tooltip.bindMouseEvents(r),e.BlockSvg.superClass_.constructor.call(this,t,n,o),this.svgGroup_.dataset?this.svgGroup_.dataset.id=this.id:e.utils.userAgent.IE&&this.svgGroup_.setAttribute("data-id",this.id)},e.utils.object.inherits(e.BlockSvg,e.Block),e.BlockSvg.prototype.height=0,e.BlockSvg.prototype.width=0,e.BlockSvg.prototype.warningTextDb_=null,e.BlockSvg.INLINE=-1,e.BlockSvg.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",e.BlockSvg.prototype.initSvg=function(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(var n,t=0;n=this.inputList[t];t++)n.init();for(n=this.getIcons(),t=0;t<n.length;t++)n[t].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),t=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!t||e.browserEvents.conditionalBind(t,"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,t.parentNode||this.workspace.getCanvas().appendChild(t)},e.BlockSvg.prototype.getColourSecondary=function(){return this.style.colourSecondary},e.BlockSvg.prototype.getColourTertiary=function(){return this.style.colourTertiary},e.BlockSvg.prototype.getColourShadow=function(){return e.utils.deprecation.warn("BlockSvg.prototype.getColourShadow","January 2020","January 2021","style.colourSecondary"),this.getColourSecondary()},e.BlockSvg.prototype.getColourBorder=function(){return e.utils.deprecation.warn("BlockSvg.prototype.getColourBorder","January 2020","January 2021","style.colourTertiary"),{colourBorder:this.getColourTertiary(),colourLight:null,colourDark:null}},e.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(e.selected!=this){var t=null;if(e.selected){t=e.selected.id,e.Events.disable();try{e.selected.unselect()}finally{e.Events.enable()}}t=new(e.Events.get(e.Events.SELECTED))(t,this.id,this.workspace.id),e.Events.fire(t),e.selected=this,this.addSelect()}},e.BlockSvg.prototype.unselect=function(){if(e.selected==this){var t=new(e.Events.get(e.Events.SELECTED))(this.id,null,this.workspace.id);t.workspaceId=this.workspace.id,e.Events.fire(t),e.selected=null,this.removeSelect()}},e.BlockSvg.prototype.mutator=null,e.BlockSvg.prototype.comment=null,e.BlockSvg.prototype.commentIcon_=null,e.BlockSvg.prototype.warning=null,e.BlockSvg.prototype.getIcons=function(){var t=[];return this.mutator&&t.push(this.mutator),this.commentIcon_&&t.push(this.commentIcon_),this.warning&&t.push(this.warning),t},e.BlockSvg.prototype.setParent=function(t){var n=this.parentBlock_;if(t!=n){e.utils.dom.startTextWidthCache(),e.BlockSvg.superClass_.setParent.call(this,t),e.utils.dom.stopTextWidthCache();var o=this.getSvgRoot();if(!this.workspace.isClearing&&o){var r=this.getRelativeToSurfaceXY();t?(t.getSvgRoot().appendChild(o),t=this.getRelativeToSurfaceXY(),this.moveConnections(t.x-r.x,t.y-r.y)):n&&(this.workspace.getCanvas().appendChild(o),this.translate(r.x,r.y)),this.applyColour()}}},e.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var t=0,n=0,o=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null,r=this.getSvgRoot();if(r)do{var a=e.utils.getRelativeXY(r);t+=a.x,n+=a.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()==r&&(t+=(a=this.workspace.getBlockDragSurface().getSurfaceTranslation()).x,n+=a.y),r=r.parentNode}while(r&&r!=this.workspace.getCanvas()&&r!=o);return new e.utils.Coordinate(t,n)},e.BlockSvg.prototype.moveBy=function(t,n){if(this.parentBlock_)throw Error("Block has parent.");var o=e.Events.isEnabled();if(o)var r=new(e.Events.get(e.Events.BLOCK_MOVE))(this);var a=this.getRelativeToSurfaceXY();this.translate(a.x+t,a.y+n),this.moveConnections(t,n),o&&(r.recordNew(),e.Events.fire(r)),this.workspace.resizeContents()},e.BlockSvg.prototype.translate=function(t,n){this.getSvgRoot().setAttribute("transform","translate("+t+","+n+")")},e.BlockSvg.prototype.moveToDragSurface=function(){if(this.useDragSurface_){var t=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(t.x,t.y),(t=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(t)}},e.BlockSvg.prototype.moveTo=function(t){var n=this.getRelativeToSurfaceXY();this.moveBy(t.x-n.x,t.y-n.y)},e.BlockSvg.prototype.moveOffDragSurface=function(t){this.useDragSurface_&&(this.translate(t.x,t.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))},e.BlockSvg.prototype.moveDuringDrag=function(t){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},e.BlockSvg.prototype.clearTransformAttributes_=function(){this.getSvgRoot().removeAttribute("transform")},e.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var t=this.workspace.getGrid();if(t&&t.shouldSnap()){var n=t.getSpacing(),o=n/2,r=this.getRelativeToSurfaceXY();t=Math.round((r.x-o)/n)*n+o-r.x,n=Math.round((r.y-o)/n)*n+o-r.y,t=Math.round(t),n=Math.round(n),0==t&&0==n||this.moveBy(t,n)}}},e.BlockSvg.prototype.getBoundingRectangle=function(){var t=this.getRelativeToSurfaceXY(),n=this.getHeightWidth();if(this.RTL)var o=t.x-n.width,r=t.x;else o=t.x,r=t.x+n.width;return new e.utils.Rect(t.y,t.y+n.height,o,r)},e.BlockSvg.prototype.markDirty=function(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(var n,t=0;n=this.inputList[t];t++)n.markDirty()},e.BlockSvg.prototype.setCollapsed=function(t){this.collapsed_!=t&&(e.BlockSvg.superClass_.setCollapsed.call(this,t),t?this.rendered&&this.render():this.updateCollapsed_())},e.BlockSvg.prototype.updateCollapsed_=function(){for(var a,t=this.isCollapsed(),n=e.constants.COLLAPSED_INPUT_NAME,o=e.constants.COLLAPSED_FIELD_NAME,r=0;a=this.inputList[r];r++)a.name!=n&&a.setVisible(!t);if(t){for(a=this.getIcons(),r=0;t=a[r];r++)t.setVisible(!1);r=this.toString(e.COLLAPSE_CHARS),(a=this.getField(o))?a.setValue(r):(a=this.getInput(n)||this.appendDummyInput(n)).appendField(new e.FieldLabel(r),o)}else this.updateDisabled(),this.removeInput(n)},e.BlockSvg.prototype.tab=function(t,n){var o=new e.TabNavigateCursor;o.setCurNode(e.ASTNode.createFieldNode(t)),t=o.getCurNode(),n?o.next():o.prev(),(n=o.getCurNode())&&n!==t&&(n.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(n))},e.BlockSvg.prototype.onMouseDown_=function(t){var n=this.workspace&&this.workspace.getGesture(t);n&&n.handleBlockStart(t,this)},e.BlockSvg.prototype.showHelp=function(){var t="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;t&&window.open(t)},e.BlockSvg.prototype.generateContextMenu=function(){if(this.workspace.options.readOnly||!this.contextMenu)return null;var t=e.ContextMenuRegistry.registry.getContextMenuOptions(e.ContextMenuRegistry.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(t),t},e.BlockSvg.prototype.showContextMenu=function(t){var n=this.generateContextMenu();n&&n.length&&(e.ContextMenu.show(t,n,this.RTL),e.ContextMenu.currentBlock=this)},e.BlockSvg.prototype.moveConnections=function(t,n){if(this.rendered){for(var o=this.getConnections_(!1),r=0;r<o.length;r++)o[r].moveBy(t,n);for(o=this.getIcons(),r=0;r<o.length;r++)o[r].computeIconLocation();for(r=0;r<this.childBlocks_.length;r++)this.childBlocks_[r].moveConnections(t,n)}},e.BlockSvg.prototype.setDragging=function(t){if(t){var n=this.getSvgRoot();n.translate_="",n.skew_="",e.draggingConnections=e.draggingConnections.concat(this.getConnections_(!0)),e.utils.dom.addClass(this.svgGroup_,"blocklyDragging")}else e.draggingConnections=[],e.utils.dom.removeClass(this.svgGroup_,"blocklyDragging");for(n=0;n<this.childBlocks_.length;n++)this.childBlocks_[n].setDragging(t)},e.BlockSvg.prototype.setMovable=function(t){e.BlockSvg.superClass_.setMovable.call(this,t),this.pathObject.updateMovable(t)},e.BlockSvg.prototype.setEditable=function(t){e.BlockSvg.superClass_.setEditable.call(this,t),t=this.getIcons();for(var n=0;n<t.length;n++)t[n].updateEditable()},e.BlockSvg.prototype.setShadow=function(t){e.BlockSvg.superClass_.setShadow.call(this,t),this.applyColour()},e.BlockSvg.prototype.setInsertionMarker=function(t){this.isInsertionMarker_!=t&&(this.isInsertionMarker_=t)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))},e.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},e.BlockSvg.prototype.dispose=function(t,n){if(this.workspace){e.Tooltip.dispose(),e.Tooltip.unbindMouseEvents(this.pathObject.svgPath),e.utils.dom.startTextWidthCache();var o=this.workspace;if(e.selected==this&&(this.unselect(),this.workspace.cancelCurrentGesture()),e.ContextMenu.currentBlock==this&&e.ContextMenu.hide(),n&&this.rendered&&(this.unplug(t),e.blockAnimations.disposeUiEffect(this)),this.rendered=!1,this.warningTextDb_){for(var r in this.warningTextDb_)clearTimeout(this.warningTextDb_[r]);this.warningTextDb_=null}for(n=this.getIcons(),r=0;r<n.length;r++)n[r].dispose();e.BlockSvg.superClass_.dispose.call(this,!!t),e.utils.dom.removeNode(this.svgGroup_),o.resizeContents(),this.svgGroup_=null,e.utils.dom.stopTextWidthCache()}},e.BlockSvg.prototype.toCopyData=function(){if(this.isInsertionMarker_)return null;var t=e.Xml.blockToDom(this,!0);e.Xml.deleteNext(t);var n=this.getRelativeToSurfaceXY();return t.setAttribute("x",this.RTL?-n.x:n.x),t.setAttribute("y",n.y),{xml:t,source:this.workspace,typeCounts:e.utils.getBlockTypeCounts(this,!0)}},e.BlockSvg.prototype.applyColour=function(){this.pathObject.applyColour(this);for(var t=this.getIcons(),n=0;n<t.length;n++)t[n].applyColour();for(t=0;n=this.inputList[t];t++)for(var r,o=0;r=n.fieldRow[o];o++)r.applyColour()},e.BlockSvg.prototype.updateDisabled=function(){var t=this.getChildren(!1);if(this.applyColour(),!this.isCollapsed())for(var o,n=0;o=t[n];n++)o.rendered&&o.updateDisabled()},e.BlockSvg.prototype.getCommentIcon=function(){return this.commentIcon_},e.BlockSvg.prototype.setCommentText=function(t){if(!e.Comment)throw Error("Missing require for Blockly.Comment");this.commentModel.text!=t&&(e.BlockSvg.superClass_.setCommentText.call(this,t),!!this.commentIcon_==(t=null!=t)?this.commentIcon_.updateText():(t?this.comment=this.commentIcon_=new e.Comment(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))},e.BlockSvg.prototype.setWarningText=function(t,n){if(!e.Warning)throw Error("Missing require for Blockly.Warning");this.warningTextDb_||(this.warningTextDb_=Object.create(null));var o=n||"";if(o)this.warningTextDb_[o]&&(clearTimeout(this.warningTextDb_[o]),delete this.warningTextDb_[o]);else for(var r in this.warningTextDb_)clearTimeout(this.warningTextDb_[r]),delete this.warningTextDb_[r];if(this.workspace.isDragging()){var a=this;this.warningTextDb_[o]=setTimeout(function(){a.workspace&&(delete a.warningTextDb_[o],a.setWarningText(t,o))},100)}else{if(this.isInFlyout&&(t=null),n=!1,"string"==typeof t){r=this.getSurroundParent();for(var h=null;r;)r.isCollapsed()&&(h=r),r=r.getSurroundParent();h&&h.setWarningText(e.Msg.COLLAPSED_WARNINGS_WARNING,e.BlockSvg.COLLAPSED_WARNING_ID),this.warning||(this.warning=new e.Warning(this),n=!0),this.warning.setText(t,o)}else this.warning&&!o?(this.warning.dispose(),n=!0):this.warning&&(n=this.warning.getText(),this.warning.setText("",o),(r=this.warning.getText())||this.warning.dispose(),n=n!=r);n&&this.rendered&&(this.render(),this.bumpNeighbours())}},e.BlockSvg.prototype.setMutator=function(t){this.mutator&&this.mutator!==t&&this.mutator.dispose(),t&&(t.setBlock(this),this.mutator=t,t.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setEnabled=function(t){this.isEnabled()!=t&&(e.BlockSvg.superClass_.setEnabled.call(this,t),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())},e.BlockSvg.prototype.setHighlighted=function(t){this.rendered&&this.pathObject.updateHighlighted(t)},e.BlockSvg.prototype.addSelect=function(){this.pathObject.updateSelected(!0)},e.BlockSvg.prototype.removeSelect=function(){this.pathObject.updateSelected(!1)},e.BlockSvg.prototype.setDeleteStyle=function(t){this.pathObject.updateDraggingDelete(t)},e.BlockSvg.prototype.getColour=function(){return this.style.colourPrimary},e.BlockSvg.prototype.setColour=function(t){e.BlockSvg.superClass_.setColour.call(this,t),t=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(t.style),this.style=t.style,this.styleName_=t.name,this.applyColour()},e.BlockSvg.prototype.setStyle=function(t){var n=this.workspace.getRenderer().getConstants().getBlockStyle(t);if(this.styleName_=t,!n)throw Error("Invalid style name: "+t);this.hat=n.hat,this.pathObject.setStyle(n),this.colour_=n.colourPrimary,this.style=n,this.applyColour()},e.BlockSvg.prototype.bringToFront=function(){var t=this;do{var n=t.getSvgRoot(),o=n.parentNode,r=o.childNodes;r[r.length-1]!==n&&o.appendChild(n),t=t.getParent()}while(t)},e.BlockSvg.prototype.setPreviousStatement=function(t,n){e.BlockSvg.superClass_.setPreviousStatement.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setNextStatement=function(t,n){e.BlockSvg.superClass_.setNextStatement.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setOutput=function(t,n){e.BlockSvg.superClass_.setOutput.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setInputsInline=function(t){e.BlockSvg.superClass_.setInputsInline.call(this,t),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.removeInput=function(t,n){return t=e.BlockSvg.superClass_.removeInput.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours()),t},e.BlockSvg.prototype.moveNumberedInputBefore=function(t,n){e.BlockSvg.superClass_.moveNumberedInputBefore.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.appendInput_=function(t,n){return t=e.BlockSvg.superClass_.appendInput_.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours()),t},e.BlockSvg.prototype.setConnectionTracking=function(t){if(this.previousConnection&&this.previousConnection.setTracking(t),this.outputConnection&&this.outputConnection.setTracking(t),this.nextConnection){this.nextConnection.setTracking(t);var n=this.nextConnection.targetBlock();n&&n.setConnectionTracking(t)}if(!this.collapsed_)for(n=0;n<this.inputList.length;n++){var o=this.inputList[n].connection;o&&(o.setTracking(t),(o=o.targetBlock())&&o.setConnectionTracking(t))}},e.BlockSvg.prototype.getConnections_=function(t){var n=[];if((t||this.rendered)&&(this.outputConnection&&n.push(this.outputConnection),this.previousConnection&&n.push(this.previousConnection),this.nextConnection&&n.push(this.nextConnection),t||!this.collapsed_)){t=0;for(var o;o=this.inputList[t];t++)o.connection&&n.push(o.connection)}return n},e.BlockSvg.prototype.lastConnectionInStack=function(t){return e.BlockSvg.superClass_.lastConnectionInStack.call(this,t)},e.BlockSvg.prototype.getMatchingConnection=function(t,n){return e.BlockSvg.superClass_.getMatchingConnection.call(this,t,n)},e.BlockSvg.prototype.makeConnection_=function(t){return new e.RenderedConnection(this,t)},e.BlockSvg.prototype.bumpNeighbours=function(){if(this.workspace&&!this.workspace.isDragging()){var t=this.getRootBlock();if(!t.isInFlyout)for(var r,n=this.getConnections_(!1),o=0;r=n[o];o++){r.isConnected()&&r.isSuperior()&&r.targetBlock().bumpNeighbours();for(var R,a=r.neighbours(e.SNAP_RADIUS),h=0;R=a[h];h++)r.isConnected()&&R.isConnected()||R.getSourceBlock().getRootBlock()!=t&&(r.isSuperior()?R.bumpAwayFrom(r):r.bumpAwayFrom(R))}}},e.BlockSvg.prototype.scheduleSnapAndBump=function(){var t=this,n=e.Events.getGroup();setTimeout(function(){e.Events.setGroup(n),t.snapToGrid(),e.Events.setGroup(!1)},e.BUMP_DELAY/2),setTimeout(function(){e.Events.setGroup(n),t.bumpNeighbours(),e.Events.setGroup(!1)},e.BUMP_DELAY)},e.BlockSvg.prototype.positionNearConnection=function(t,n){t.type!=e.connectionTypes.NEXT_STATEMENT&&t.type!=e.connectionTypes.INPUT_VALUE||this.moveBy(n.x-t.x,n.y-t.y)},e.BlockSvg.prototype.getParent=function(){return e.BlockSvg.superClass_.getParent.call(this)},e.BlockSvg.prototype.getRootBlock=function(){return e.BlockSvg.superClass_.getRootBlock.call(this)},e.BlockSvg.prototype.render=function(t){if(!this.renderIsInProgress_){this.renderIsInProgress_=!0;try{if(this.rendered=!0,e.utils.dom.startTextWidthCache(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),!1!==t){var n=this.getParent();n?n.render(!0):this.workspace.resizeContents()}e.utils.dom.stopTextWidthCache(),this.updateMarkers_()}finally{this.renderIsInProgress_=!1}}},e.BlockSvg.prototype.updateMarkers_=function(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(e.MarkerManager.LOCAL_MARKER).draw()},e.BlockSvg.prototype.updateConnectionLocations_=function(){var t=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(t),this.outputConnection&&this.outputConnection.moveToOffset(t);for(var n=0;n<this.inputList.length;n++){var o=this.inputList[n].connection;o&&(o.moveToOffset(t),o.isConnected()&&o.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(t),this.nextConnection.isConnected()&&this.nextConnection.tighten())},e.BlockSvg.prototype.setCursorSvg=function(t){this.pathObject.setCursorSvg(t)},e.BlockSvg.prototype.setMarkerSvg=function(t){this.pathObject.setMarkerSvg(t)},e.BlockSvg.prototype.getHeightWidth=function(){var t=this.height,n=this.width,o=this.getNextBlock();if(o){o=o.getHeightWidth();var r=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;t+=o.height-r,n=Math.max(n,o.width)}return{height:t,width:n}},e.BlockSvg.prototype.fadeForReplacement=function(t){this.pathObject.updateReplacementFade(t)},e.BlockSvg.prototype.highlightShapeForInput=function(t,n){this.pathObject.updateShapeForInputHighlight(t,n)},e.ConnectionDB=function(t){this.connections_=[],this.connectionChecker_=t},e.ConnectionDB.prototype.addConnection=function(t,n){n=this.calculateIndexForYPos_(n),this.connections_.splice(n,0,t)},e.ConnectionDB.prototype.findIndexOfConnection_=function(t,n){if(!this.connections_.length)return-1;var o=this.calculateIndexForYPos_(n);if(o>=this.connections_.length)return-1;n=t.y;for(var r=o;0<=r&&this.connections_[r].y==n;){if(this.connections_[r]==t)return r;r--}for(r=o;r<this.connections_.length&&this.connections_[r].y==n;){if(this.connections_[r]==t)return r;r++}return-1},e.ConnectionDB.prototype.calculateIndexForYPos_=function(t){if(!this.connections_.length)return 0;for(var n=0,o=this.connections_.length;n<o;){var r=Math.floor((n+o)/2);if(this.connections_[r].y<t)n=r+1;else{if(!(this.connections_[r].y>t)){n=r;break}o=r}}return n},e.ConnectionDB.prototype.removeConnection=function(t,n){if(-1==(t=this.findIndexOfConnection_(t,n)))throw Error("Unable to find connection in connectionDB.");this.connections_.splice(t,1)},e.ConnectionDB.prototype.getNeighbours=function(t,n){function o(nt){var et=a-r[nt].x,Et=h-r[nt].y;return Math.sqrt(et*et+Et*Et)<=n&&W.push(r[nt]),Et<n}var r=this.connections_,a=t.x,h=t.y;t=0;for(var R=r.length-2,L=R;t<L;)r[L].y<h?t=L:R=L,L=Math.floor((t+R)/2);var W=[];if(R=t=L,r.length){for(;0<=t&&o(t);)t--;do{R++}while(R<r.length&&o(R))}return W},e.ConnectionDB.prototype.isInYRange_=function(t,n,o){return Math.abs(this.connections_[t].y-n)<=o},e.ConnectionDB.prototype.searchForClosest=function(t,n,o){if(!this.connections_.length)return{connection:null,radius:n};var r=t.y,a=t.x;t.x=a+o.x,t.y=r+o.y;var h=this.calculateIndexForYPos_(t.y);o=null;for(var L,R=n,W=h-1;0<=W&&this.isInYRange_(W,t.y,n);)this.connectionChecker_.canConnect(t,L=this.connections_[W],!0,R)&&(o=L,R=L.distanceFrom(t)),W--;for(;h<this.connections_.length&&this.isInYRange_(h,t.y,n);)this.connectionChecker_.canConnect(t,L=this.connections_[h],!0,R)&&(o=L,R=L.distanceFrom(t)),h++;return t.x=a,t.y=r,{connection:o,radius:R}},e.ConnectionDB.init=function(t){var n=[];return n[e.connectionTypes.INPUT_VALUE]=new e.ConnectionDB(t),n[e.connectionTypes.OUTPUT_VALUE]=new e.ConnectionDB(t),n[e.connectionTypes.NEXT_STATEMENT]=new e.ConnectionDB(t),n[e.connectionTypes.PREVIOUS_STATEMENT]=new e.ConnectionDB(t),n},e.Events.ThemeChange=function(t,n){e.Events.ThemeChange.superClass_.constructor.call(this,n),this.themeName=t},e.utils.object.inherits(e.Events.ThemeChange,e.Events.UiBase),e.Events.ThemeChange.prototype.type=e.Events.THEME_CHANGE,e.Events.ThemeChange.prototype.toJson=function(){var t=e.Events.ThemeChange.superClass_.toJson.call(this);return t.themeName=this.themeName,t},e.Events.ThemeChange.prototype.fromJson=function(t){e.Events.ThemeChange.superClass_.fromJson.call(this,t),this.themeName=t.themeName},e.registry.register(e.registry.Type.EVENT,e.Events.THEME_CHANGE,e.Events.ThemeChange),e.Events.ViewportChange=function(t,n,o,r,a){e.Events.ViewportChange.superClass_.constructor.call(this,r),this.viewTop=t,this.viewLeft=n,this.scale=o,this.oldScale=a},e.utils.object.inherits(e.Events.ViewportChange,e.Events.UiBase),e.Events.ViewportChange.prototype.type=e.Events.VIEWPORT_CHANGE,e.Events.ViewportChange.prototype.toJson=function(){var t=e.Events.ViewportChange.superClass_.toJson.call(this);return t.viewTop=this.viewTop,t.viewLeft=this.viewLeft,t.scale=this.scale,t.oldScale=this.oldScale,t},e.Events.ViewportChange.prototype.fromJson=function(t){e.Events.ViewportChange.superClass_.fromJson.call(this,t),this.viewTop=t.viewTop,this.viewLeft=t.viewLeft,this.scale=t.scale,this.oldScale=t.oldScale},e.registry.register(e.registry.Type.EVENT,e.Events.VIEWPORT_CHANGE,e.Events.ViewportChange),e.IMetricsManager=function(){},e.MetricsManager=function(t){this.workspace_=t},e.MetricsManager.prototype.getDimensionsPx_=function(t){var n=0,o=0;return t&&(n=t.getWidth(),o=t.getHeight()),new e.utils.Size(n,o)},e.MetricsManager.prototype.getFlyoutMetrics=function(t){return{width:(t=this.getDimensionsPx_(this.workspace_.getFlyout(t))).width,height:t.height,position:this.workspace_.toolboxPosition}},e.MetricsManager.prototype.getToolboxMetrics=function(){var t=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}},e.MetricsManager.prototype.getSvgMetrics=function(){return this.workspace_.getCachedParentSvgSize()},e.MetricsManager.prototype.getAbsoluteMetrics=function(){var t=0,n=this.getToolboxMetrics(),o=this.getFlyoutMetrics(!0),r=!!this.workspace_.getToolbox(),a=!!this.workspace_.getFlyout(!0),h=r?n.position:o.position,R=h==e.utils.toolbox.Position.LEFT;return h=h==e.utils.toolbox.Position.TOP,r&&R?t=n.width:a&&R&&(t=o.width),R=0,r&&h?R=n.height:a&&h&&(R=o.height),{top:R,left:t}},e.MetricsManager.prototype.getViewMetrics=function(t){t=t?this.workspace_.scale:1;var n=this.getSvgMetrics(),o=this.getToolboxMetrics(),r=this.getFlyoutMetrics(!0),a=this.workspace_.getToolbox()?o.position:r.position;return this.workspace_.getToolbox()?a==e.utils.toolbox.Position.TOP||a==e.utils.toolbox.Position.BOTTOM?n.height-=o.height:(a==e.utils.toolbox.Position.LEFT||a==e.utils.toolbox.Position.RIGHT)&&(n.width-=o.width):this.workspace_.getFlyout(!0)&&(a==e.utils.toolbox.Position.TOP||a==e.utils.toolbox.Position.BOTTOM?n.height-=r.height:(a==e.utils.toolbox.Position.LEFT||a==e.utils.toolbox.Position.RIGHT)&&(n.width-=r.width)),{height:n.height/t,width:n.width/t,top:-this.workspace_.scrollY/t,left:-this.workspace_.scrollX/t}},e.MetricsManager.prototype.getContentMetrics=function(t){t=t?1:this.workspace_.scale;var n=this.workspace_.getBlocksBoundingBox();return{height:(n.bottom-n.top)*t,width:(n.right-n.left)*t,top:n.top*t,left:n.left*t}},e.MetricsManager.prototype.hasFixedEdges=function(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()},e.MetricsManager.prototype.getComputedFixedEdges_=function(t){if(!this.hasFixedEdges())return{};var n=this.workspace_.isMovableHorizontally(),o=this.workspace_.isMovableVertically();t=t||this.getViewMetrics(!1);var r={};return o||(r.top=t.top,r.bottom=t.top+t.height),n||(r.left=t.left,r.right=t.left+t.width),r},e.MetricsManager.prototype.getPaddedContent_=function(t,n){var o=n.top+n.height,r=n.left+n.width,a=t.width,h=a/2,R=(t=t.height)/2;return{top:Math.min(n.top-R,o-t),bottom:Math.max(o+R,n.top+t),left:Math.min(n.left-h,r-a),right:Math.max(r+h,n.left+a)}},e.MetricsManager.prototype.getScrollMetrics=function(t,n,o){t=t?this.workspace_.scale:1,n=n||this.getViewMetrics(!1);var r=o||this.getContentMetrics();o=this.getComputedFixedEdges_(n),n=this.getPaddedContent_(n,r);var a=void 0!==o.left?o.left:n.left;return{top:(r=void 0!==o.top?o.top:n.top)/t,left:a/t,width:((void 0!==o.right?o.right:n.right)-a)/t,height:((void 0!==o.bottom?o.bottom:n.bottom)-r)/t}},e.MetricsManager.prototype.getUiMetrics=function(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}},e.MetricsManager.prototype.getMetrics=function(){var t=this.getToolboxMetrics(),n=this.getFlyoutMetrics(!0),o=this.getSvgMetrics(),r=this.getAbsoluteMetrics(),a=this.getViewMetrics(),h=this.getContentMetrics(),R=this.getScrollMetrics(!1,a,h);return{contentHeight:h.height,contentWidth:h.width,contentTop:h.top,contentLeft:h.left,scrollHeight:R.height,scrollWidth:R.width,scrollTop:R.top,scrollLeft:R.left,viewHeight:a.height,viewWidth:a.width,viewTop:a.top,viewLeft:a.left,absoluteTop:r.top,absoluteLeft:r.left,svgHeight:o.height,svgWidth:o.width,toolboxWidth:t.width,toolboxHeight:t.height,toolboxPosition:t.position,flyoutWidth:n.width,flyoutHeight:n.height}},e.registry.register(e.registry.Type.METRICS_MANAGER,e.registry.DEFAULT,e.MetricsManager),e.FlyoutMetricsManager=function(t,n){this.flyout_=n,e.FlyoutMetricsManager.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.FlyoutMetricsManager,e.MetricsManager),e.FlyoutMetricsManager.prototype.getBoundingBox_=function(){try{var t=this.workspace_.getCanvas().getBBox()}catch(n){t={height:0,y:0,width:0,x:0}}return t},e.FlyoutMetricsManager.prototype.getContentMetrics=function(t){var n=this.getBoundingBox_();return{height:n.height*(t=t?1:this.workspace_.scale),width:n.width*t,top:n.y*t,left:n.x*t}},e.FlyoutMetricsManager.prototype.getScrollMetrics=function(t,n,o){return{height:((n=o||this.getContentMetrics()).height+2*(o=this.flyout_.MARGIN*this.workspace_.scale))/(t=t?this.workspace_.scale:1),width:(n.width+n.left+o)/t,top:0,left:0}},e.ThemeManager=function(t,n){this.workspace_=t,this.theme_=n,this.subscribedWorkspaces_=[],this.componentDB_=Object.create(null)},e.ThemeManager.prototype.getTheme=function(){return this.theme_},e.ThemeManager.prototype.setTheme=function(t){var o,n=this.theme_;for(this.theme_=t,(t=this.workspace_.getInjectionDiv())&&(n&&e.utils.dom.removeClass(t,n.getClassName()),e.utils.dom.addClass(t,this.theme_.getClassName())),n=0;t=this.subscribedWorkspaces_[n];n++)t.refreshTheme();for(n=0,t=Object.keys(this.componentDB_);o=t[n];n++)for(var a,r=0;a=this.componentDB_[o][r];r++){var h=a.element;a=a.propertyName;var R=this.theme_&&this.theme_.getComponentStyle(o);h.style[a]=R||""}e.hideChaff()},e.ThemeManager.prototype.subscribeWorkspace=function(t){this.subscribedWorkspaces_.push(t)},e.ThemeManager.prototype.unsubscribeWorkspace=function(t){if(0>(t=this.subscribedWorkspaces_.indexOf(t)))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.");this.subscribedWorkspaces_.splice(t,1)},e.ThemeManager.prototype.subscribe=function(t,n,o){this.componentDB_[n]||(this.componentDB_[n]=[]),this.componentDB_[n].push({element:t,propertyName:o}),n=this.theme_&&this.theme_.getComponentStyle(n),t.style[o]=n||""},e.ThemeManager.prototype.unsubscribe=function(t){if(t)for(var r,n=Object.keys(this.componentDB_),o=0;r=n[o];o++){for(var a=this.componentDB_[r],h=a.length-1;0<=h;h--)a[h].element===t&&a.splice(h,1);this.componentDB_[r].length||delete this.componentDB_[r]}},e.ThemeManager.prototype.dispose=function(){this.componentDB_=this.subscribedWorkspaces_=this.theme_=this.owner_=null},e.TouchGesture=function(t,n){e.TouchGesture.superClass_.constructor.call(this,t,n),this.isMultiTouch_=!1,this.cachedPoints_=Object.create(null),this.startDistance_=this.previousScale_=0,this.isPinchZoomEnabled_=this.onStartWrapper_=null},e.utils.object.inherits(e.TouchGesture,e.Gesture),e.TouchGesture.ZOOM_IN_MULTIPLIER=5,e.TouchGesture.ZOOM_OUT_MULTIPLIER=6,e.TouchGesture.prototype.doStart=function(t){this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,e.TouchGesture.superClass_.doStart.call(this,t),!this.isEnding_&&e.Touch.isTouchEvent(t)&&this.handleTouchStart(t)},e.TouchGesture.prototype.bindMouseEvents=function(t){this.onStartWrapper_=e.browserEvents.conditionalBind(document,"mousedown",null,this.handleStart.bind(this),!0),this.onMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",null,this.handleMove.bind(this),!0),this.onUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",null,this.handleUp.bind(this),!0),t.preventDefault(),t.stopPropagation()},e.TouchGesture.prototype.handleStart=function(t){!this.isDragging()&&e.Touch.isTouchEvent(t)&&(this.handleTouchStart(t),this.isMultiTouch()&&e.longStop_())},e.TouchGesture.prototype.handleMove=function(t){this.isDragging()?e.Touch.shouldHandleEvent(t)&&e.TouchGesture.superClass_.handleMove.call(this,t):this.isMultiTouch()?(e.Touch.isTouchEvent(t)&&this.handleTouchMove(t),e.longStop_()):e.TouchGesture.superClass_.handleMove.call(this,t)},e.TouchGesture.prototype.handleUp=function(t){e.Touch.isTouchEvent(t)&&!this.isDragging()&&this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()?e.Touch.shouldHandleEvent(t)&&e.TouchGesture.superClass_.handleUp.call(this,t):(t.preventDefault(),t.stopPropagation(),this.dispose())},e.TouchGesture.prototype.isMultiTouch=function(){return this.isMultiTouch_},e.TouchGesture.prototype.dispose=function(){e.TouchGesture.superClass_.dispose.call(this),this.onStartWrapper_&&e.browserEvents.unbind(this.onStartWrapper_)},e.TouchGesture.prototype.handleTouchStart=function(t){var n=e.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[n]=this.getTouchPoint(t),2==(n=Object.keys(this.cachedPoints_)).length&&(this.startDistance_=e.utils.Coordinate.distance(this.cachedPoints_[n[0]],this.cachedPoints_[n[1]]),this.isMultiTouch_=!0,t.preventDefault())},e.TouchGesture.prototype.handleTouchMove=function(t){var n=e.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[n]=this.getTouchPoint(t),n=Object.keys(this.cachedPoints_),this.isPinchZoomEnabled_&&2===n.length?this.handlePinch_(t):e.TouchGesture.superClass_.handleMove.call(this,t)},e.TouchGesture.prototype.handlePinch_=function(t){var n=Object.keys(this.cachedPoints_);if(n=e.utils.Coordinate.distance(this.cachedPoints_[n[0]],this.cachedPoints_[n[1]])/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){var o=n-this.previousScale_;o=0<o?o*e.TouchGesture.ZOOM_IN_MULTIPLIER:o*e.TouchGesture.ZOOM_OUT_MULTIPLIER;var r=this.startWorkspace_,a=e.utils.mouseToSvg(t,r.getParentSvg(),r.getInverseScreenCTM());r.zoom(a.x,a.y,o)}this.previousScale_=n,t.preventDefault()},e.TouchGesture.prototype.handleTouchEnd=function(t){t=e.Touch.getTouchIdentifierFromEvent(t),this.cachedPoints_[t]&&delete this.cachedPoints_[t],2>Object.keys(this.cachedPoints_).length&&(this.cachedPoints_=Object.create(null),this.previousScale_=0)},e.TouchGesture.prototype.getTouchPoint=function(t){return this.startWorkspace_?new e.utils.Coordinate(t.pageX?t.pageX:t.changedTouches[0].pageX,t.pageY?t.pageY:t.changedTouches[0].pageY):null},e.WorkspaceAudio=function(t){this.parentWorkspace_=t,this.SOUNDS_=Object.create(null)},e.WorkspaceAudio.prototype.lastSound_=null,e.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},e.WorkspaceAudio.prototype.load=function(t,n){if(t.length){try{var o=new e.utils.global.Audio}catch(L){return}for(var r,a=0;a<t.length;a++){var h=t[a],R=h.match(/\.(\w+)$/);if(R&&o.canPlayType("audio/"+R[1])){r=new e.utils.global.Audio(h);break}}r&&r.play&&(this.SOUNDS_[n]=r)}},e.WorkspaceAudio.prototype.preload=function(){for(var t in this.SOUNDS_){var n=this.SOUNDS_[t];n.volume=.01;var o=n.play();if(void 0!==o?o.then(n.pause).catch(function(){}):n.pause(),e.utils.userAgent.IPAD||e.utils.userAgent.IPHONE)break}},e.WorkspaceAudio.prototype.play=function(t,n){var o=this.SOUNDS_[t];o?(t=new Date,null!=this.lastSound_&&t-this.lastSound_<e.SOUND_LIMIT||(this.lastSound_=t,(o=e.utils.userAgent.IPAD||e.utils.userAgent.ANDROID?o:o.cloneNode()).volume=void 0===n?1:n,o.play())):this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(t,n)},e.WorkspaceSvg=function(t,n,o){e.WorkspaceSvg.superClass_.constructor.call(this,t),this.metricsManager_=new(e.registry.getClassFromOptions(e.registry.Type.METRICS_MANAGER,t,!0))(this),this.getMetrics=t.getMetrics||this.metricsManager_.getMetrics.bind(this.metricsManager_),this.setMetrics=t.setMetrics||e.WorkspaceSvg.setTopLevelWorkspaceMetrics_,this.componentManager_=new e.ComponentManager,this.connectionDBList=e.ConnectionDB.init(this.connectionChecker),n&&(this.blockDragSurface_=n),o&&(this.workspaceDragSurface_=o),this.useWorkspaceDragSurface_=!!this.workspaceDragSurface_&&e.utils.is3dSupported(),this.highlightedBlocks_=[],this.audioManager_=new e.WorkspaceAudio(t.parentWorkspace),this.grid_=this.options.gridPattern?new e.Grid(this.options.gridPattern,t.gridOptions):null,this.markerManager_=new e.MarkerManager(this),this.toolboxCategoryCallbacks_=Object.create(null),this.flyoutButtonCallbacks_=Object.create(null),e.Variables&&e.Variables.flyoutCategory&&this.registerToolboxCategoryCallback(e.VARIABLE_CATEGORY_NAME,e.Variables.flyoutCategory),e.VariablesDynamic&&e.VariablesDynamic.flyoutCategory&&this.registerToolboxCategoryCallback(e.VARIABLE_DYNAMIC_CATEGORY_NAME,e.VariablesDynamic.flyoutCategory),e.Procedures&&e.Procedures.flyoutCategory&&(this.registerToolboxCategoryCallback(e.PROCEDURE_CATEGORY_NAME,e.Procedures.flyoutCategory),this.addChangeListener(e.Procedures.mutatorOpenListener)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new e.ThemeManager(this,this.options.theme||e.Themes.Classic),this.themeManager_.subscribeWorkspace(this),this.renderer_=e.blockRendering.init(this.options.renderer||"geras",this.getTheme(),this.options.rendererOverrides),this.cachedParentSvg_=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements_=[],this.dragTargetAreas_=[],this.cachedParentSvgSize_=new e.utils.Size(0,0)},e.utils.object.inherits(e.WorkspaceSvg,e.Workspace),e.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,e.WorkspaceSvg.prototype.rendered=!0,e.WorkspaceSvg.prototype.isVisible_=!0,e.WorkspaceSvg.prototype.isFlyout=!1,e.WorkspaceSvg.prototype.isMutator=!1,e.WorkspaceSvg.prototype.resizesEnabled_=!0,e.WorkspaceSvg.prototype.scrollX=0,e.WorkspaceSvg.prototype.scrollY=0,e.WorkspaceSvg.prototype.startScrollX=0,e.WorkspaceSvg.prototype.startScrollY=0,e.WorkspaceSvg.prototype.dragDeltaXY_=null,e.WorkspaceSvg.prototype.scale=1,e.WorkspaceSvg.prototype.oldScale_=1,e.WorkspaceSvg.prototype.oldTop_=0,e.WorkspaceSvg.prototype.oldLeft_=0,e.WorkspaceSvg.prototype.trashcan=null,e.WorkspaceSvg.prototype.scrollbar=null,e.WorkspaceSvg.prototype.flyout_=null,e.WorkspaceSvg.prototype.toolbox_=null,e.WorkspaceSvg.prototype.currentGesture_=null,e.WorkspaceSvg.prototype.blockDragSurface_=null,e.WorkspaceSvg.prototype.workspaceDragSurface_=null,e.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,e.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,e.WorkspaceSvg.prototype.injectionDiv_=null,e.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,e.WorkspaceSvg.prototype.targetWorkspace=null,e.WorkspaceSvg.prototype.inverseScreenCTM_=null,e.WorkspaceSvg.prototype.inverseScreenCTMDirty_=!0,e.WorkspaceSvg.prototype.getMarkerManager=function(){return this.markerManager_},e.WorkspaceSvg.prototype.getMetricsManager=function(){return this.metricsManager_},e.WorkspaceSvg.prototype.setMetricsManager=function(t){this.metricsManager_=t,this.getMetrics=this.metricsManager_.getMetrics.bind(this.metricsManager_)},e.WorkspaceSvg.prototype.getComponentManager=function(){return this.componentManager_},e.WorkspaceSvg.prototype.setCursorSvg=function(t){this.markerManager_.setCursorSvg(t)},e.WorkspaceSvg.prototype.setMarkerSvg=function(t){this.markerManager_.setMarkerSvg(t)},e.WorkspaceSvg.prototype.getMarker=function(t){return this.markerManager_?this.markerManager_.getMarker(t):null},e.WorkspaceSvg.prototype.getCursor=function(){return this.markerManager_?this.markerManager_.getCursor():null},e.WorkspaceSvg.prototype.getRenderer=function(){return this.renderer_},e.WorkspaceSvg.prototype.getThemeManager=function(){return this.themeManager_},e.WorkspaceSvg.prototype.getTheme=function(){return this.themeManager_.getTheme()},e.WorkspaceSvg.prototype.setTheme=function(t){t||(t=e.Themes.Classic),this.themeManager_.setTheme(t)},e.WorkspaceSvg.prototype.refreshTheme=function(){this.svgGroup_&&this.renderer_.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(n){return!!n.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);var t=new(e.Events.get(e.Events.THEME_CHANGE))(this.getTheme().name,this.id);e.Events.fire(t)},e.WorkspaceSvg.prototype.updateBlockStyles_=function(t){for(var o,n=0;o=t[n];n++){var r=o.getStyleName();r&&(o.setStyle(r),o.mutator&&o.mutator.updateBlockStyle())}},e.WorkspaceSvg.prototype.getInverseScreenCTM=function(){if(this.inverseScreenCTMDirty_){var t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM_=t.inverse(),this.inverseScreenCTMDirty_=!1)}return this.inverseScreenCTM_},e.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){this.inverseScreenCTMDirty_=!0},e.WorkspaceSvg.prototype.isVisible=function(){return this.isVisible_},e.WorkspaceSvg.prototype.getSvgXY=function(t){var n=0,o=0,r=1;(e.utils.dom.containsNode(this.getCanvas(),t)||e.utils.dom.containsNode(this.getBubbleCanvas(),t))&&(r=this.scale);do{var a=e.utils.getRelativeXY(t);(t==this.getCanvas()||t==this.getBubbleCanvas())&&(r=1),n+=a.x*r,o+=a.y*r,t=t.parentNode}while(t&&t!=this.getParentSvg());return new e.utils.Coordinate(n,o)},e.WorkspaceSvg.prototype.getCachedParentSvgSize=function(){var t=this.cachedParentSvgSize_;return new e.utils.Size(t.width,t.height)},e.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return e.utils.getInjectionDivXY_(this.getCanvas())},e.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_)for(var t=this.svgGroup_;t;){if(-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv_=t;break}t=t.parentNode}return this.injectionDiv_},e.WorkspaceSvg.prototype.getBlockCanvas=function(){return this.svgBlockCanvas_},e.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(t){this.resizeHandlerWrapper_=t},e.WorkspaceSvg.prototype.createDom=function(t){return this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyWorkspace"},null),t&&(this.svgBackground_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{height:"100%",width:"100%",class:t},this.svgGroup_),"blocklyMainBackground"==t&&this.grid_?this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(e.browserEvents.conditionalBind(this.svgGroup_,"mousedown",this,this.onMouseDown_,!1,!0),e.browserEvents.conditionalBind(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(e.registry.getClassFromOptions(e.registry.Type.TOOLBOX,this.options,!0))(this)),this.grid_&&this.grid_.update(this.scale),this.recordDragTargets(),(t=e.registry.getClassFromOptions(e.registry.Type.CURSOR,this.options))&&this.markerManager_.setCursor(new t),this.renderer_.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_},e.WorkspaceSvg.prototype.dispose=function(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&(e.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.renderer_.dispose(),this.markerManager_&&(this.markerManager_.dispose(),this.markerManager_=null),e.WorkspaceSvg.superClass_.dispose.call(this),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||(this.themeManager_.dispose(),this.themeManager_=null)),this.flyoutButtonCallbacks_=this.toolboxCategoryCallbacks_=this.connectionDBList=null,!this.options.parentWorkspace){var t=this.getParentSvg();t&&t.parentNode&&e.utils.dom.removeNode(t.parentNode)}this.resizeHandlerWrapper_&&(e.browserEvents.unbind(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},e.WorkspaceSvg.prototype.newBlock=function(t,n){return new e.BlockSvg(this,t,n)},e.WorkspaceSvg.prototype.addTrashcan=function(){if(!e.Trashcan)throw Error("Missing require for Blockly.Trashcan");this.trashcan=new e.Trashcan(this);var t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.svgBlockCanvas_)},e.WorkspaceSvg.prototype.addZoomControls=function(){if(!e.ZoomControls)throw Error("Missing require for Blockly.ZoomControls");this.zoomControls_=new e.ZoomControls(this);var t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)},e.WorkspaceSvg.prototype.addFlyout=function(t){var n=new e.Options({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return n.toolboxPosition=this.options.toolboxPosition,this.flyout_=this.horizontalLayout?new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(n):new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(n),this.flyout_.autoClose=!1,this.flyout_.getWorkspace().setVisible(!0),this.flyout_.createDom(t)},e.WorkspaceSvg.prototype.getFlyout=function(t){return this.flyout_||t?this.flyout_:this.toolbox_?this.toolbox_.getFlyout():null},e.WorkspaceSvg.prototype.getToolbox=function(){return this.toolbox_},e.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDragTargets()},e.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())},e.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position();for(var a,t=this.componentManager_.getComponents(e.ComponentManager.Capability.POSITIONABLE,!0),n=this.getMetricsManager().getUiMetrics(),o=[],r=0;a=t[r];r++)a.position(n,o),(a=a.getBoundingRectangle())&&o.push(a);this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},e.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var t=e.utils.getDocumentScroll();e.utils.Coordinate.equals(this.lastRecordedPageScroll_,t)||(this.lastRecordedPageScroll_=t,this.updateScreenCalculations_())},e.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},e.WorkspaceSvg.prototype.setCachedParentSvgSize=function(t,n){var o=this.getParentSvg();t&&(this.cachedParentSvgSize_.width=t,o.cachedWidth_=t),n&&(this.cachedParentSvgSize_.height=n,o.cachedHeight_=n)},e.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},e.WorkspaceSvg.prototype.getParentSvg=function(){if(!this.cachedParentSvg_)for(var t=this.svgGroup_;t;){if("svg"==t.tagName){this.cachedParentSvg_=t;break}t=t.parentNode}return this.cachedParentSvg_},e.WorkspaceSvg.prototype.maybeFireViewportChangeEvent=function(){if(e.Events.isEnabled()){var t=this.scale,n=-this.scrollY,o=-this.scrollX;if(!(t==this.oldScale_&&1>Math.abs(n-this.oldTop_)&&1>Math.abs(o-this.oldLeft_))){var r=new(e.Events.get(e.Events.VIEWPORT_CHANGE))(n,o,t,this.id,this.oldScale_);this.oldScale_=t,this.oldTop_=n,this.oldLeft_=o,e.Events.fire(r)}}},e.WorkspaceSvg.prototype.translate=function(t,n){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(t,n);else{var o="translate("+t+","+n+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",o),this.svgBubbleCanvas_.setAttribute("transform",o)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(t,n,this.scale),this.grid_&&this.grid_.moveTo(t,n),this.maybeFireViewportChangeEvent()},e.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var t=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),this.svgBlockCanvas_.setAttribute("transform",t="translate("+t.x+","+t.y+") scale("+this.scale+")"),this.svgBubbleCanvas_.setAttribute("transform",t)}},e.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var t=this.svgBlockCanvas_.previousSibling,n=parseInt(this.getParentSvg().getAttribute("width"),10),o=parseInt(this.getParentSvg().getAttribute("height"),10),r=e.utils.getRelativeXY(this.getCanvas());this.workspaceDragSurface_.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),t,n,o,this.scale),this.workspaceDragSurface_.translateSurface(r.x,r.y)}},e.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_},e.WorkspaceSvg.prototype.getWidth=function(){var t=this.getMetrics();return t?t.viewWidth/this.scale:0},e.WorkspaceSvg.prototype.setVisible=function(t){if(this.isVisible_=t,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&this.toolbox_.setVisible(t),t){for(var n=(t=this.getAllBlocks(!1)).length-1;0<=n;n--)t[n].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else e.hideChaff(!0)},e.WorkspaceSvg.prototype.render=function(){for(var t=this.getAllBlocks(!1),n=t.length-1;0<=n;n--)t[n].render(!1);if(this.currentGesture_)for(t=this.currentGesture_.getInsertionMarkers(),n=0;n<t.length;n++)t[n].render(!1);this.markerManager_.updateMarkers()},e.WorkspaceSvg.prototype.highlightBlock=function(t,n){if(void 0===n){for(var r,o=0;r=this.highlightedBlocks_[o];o++)r.setHighlighted(!1);this.highlightedBlocks_.length=0}(r=t?this.getBlockById(t):null)&&((t=void 0===n||n)?-1==this.highlightedBlocks_.indexOf(r)&&this.highlightedBlocks_.push(r):e.utils.arrayRemove(this.highlightedBlocks_,r),r.setHighlighted(t))},e.WorkspaceSvg.prototype.paste=function(t){!this.rendered||!t.tagName||t.getElementsByTagName("block").length>=this.remainingCapacity()||(this.currentGesture_&&this.currentGesture_.cancel(),"comment"==t.tagName.toLowerCase()?this.pasteWorkspaceComment_(t):this.pasteBlock_(t))},e.WorkspaceSvg.prototype.pasteBlock_=function(t){e.Events.disable();try{var n=e.Xml.domToBlock(t,this),o=parseInt(t.getAttribute("x"),10),r=parseInt(t.getAttribute("y"),10);if(!isNaN(o)&&!isNaN(r)){this.RTL&&(o=-o);do{t=!1;for(var R,a=this.getAllBlocks(!1),h=0;R=a[h];h++){var L=R.getRelativeToSurfaceXY();if(1>=Math.abs(o-L.x)&&1>=Math.abs(r-L.y)){t=!0;break}}if(!t){var nt,W=n.getConnections_(!1);for(h=0;nt=W[h];h++)if(nt.closest(e.SNAP_RADIUS,new e.utils.Coordinate(o,r)).connection){t=!0;break}}t&&(o=this.RTL?o-e.SNAP_RADIUS:o+e.SNAP_RADIUS,r+=2*e.SNAP_RADIUS)}while(t);n.moveBy(o,r)}}finally{e.Events.enable()}e.Events.isEnabled()&&!n.isShadow()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(n)),n.select()},e.WorkspaceSvg.prototype.pasteWorkspaceComment_=function(t){e.Events.disable();try{var n=e.WorkspaceCommentSvg.fromXml(t,this),o=parseInt(t.getAttribute("x"),10),r=parseInt(t.getAttribute("y"),10);isNaN(o)||isNaN(r)||(this.RTL&&(o=-o),n.moveBy(o+50,r+50))}finally{e.Events.enable()}e.Events.isEnabled()&&e.WorkspaceComment.fireCreateEvent(n),n.select()},e.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.getFlyout()&&t.toolbox_.refreshSelection()},e.WorkspaceSvg.prototype.renameVariableById=function(t,n){e.WorkspaceSvg.superClass_.renameVariableById.call(this,t,n),this.refreshToolboxSelection()},e.WorkspaceSvg.prototype.deleteVariableById=function(t){e.WorkspaceSvg.superClass_.deleteVariableById.call(this,t),this.refreshToolboxSelection()},e.WorkspaceSvg.prototype.createVariable=function(t,n,o){return t=e.WorkspaceSvg.superClass_.createVariable.call(this,t,n,o),this.refreshToolboxSelection(),t},e.WorkspaceSvg.prototype.recordDeleteAreas=function(){e.utils.deprecation.warn("WorkspaceSvg.prototype.recordDeleteAreas","June 2021","June 2022","WorkspaceSvg.prototype.recordDragTargets"),this.recordDragTargets()},e.WorkspaceSvg.prototype.recordDragTargets=function(){var t=this.componentManager_.getComponents(e.ComponentManager.Capability.DRAG_TARGET,!0);this.dragTargetAreas_=[];for(var o,n=0;o=t[n];n++){var r=o.getClientRect();r&&this.dragTargetAreas_.push({component:o,clientRect:r})}},e.WorkspaceSvg.prototype.getDragTarget=function(t){for(var o,n=0;o=this.dragTargetAreas_[n];n++)if(o.clientRect.contains(t.clientX,t.clientY))return o.component;return null},e.WorkspaceSvg.prototype.onMouseDown_=function(t){var n=this.getGesture(t);n&&n.handleWsStart(t,this)},e.WorkspaceSvg.prototype.startDrag=function(t,n){(t=e.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,this.dragDeltaXY_=e.utils.Coordinate.difference(n,t)},e.WorkspaceSvg.prototype.moveDrag=function(t){return(t=e.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,e.utils.Coordinate.sum(this.dragDeltaXY_,t)},e.WorkspaceSvg.prototype.isDragging=function(){return null!=this.currentGesture_&&this.currentGesture_.isDragging()},e.WorkspaceSvg.prototype.isDraggable=function(){return this.options.moveOptions&&this.options.moveOptions.drag},e.WorkspaceSvg.prototype.isMovable=function(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch},e.WorkspaceSvg.prototype.isMovableHorizontally=function(){var t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollHorizontally())},e.WorkspaceSvg.prototype.isMovableVertically=function(){var t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollVertically())},e.WorkspaceSvg.prototype.onMouseWheel_=function(t){if(e.Gesture.inProgress())t.preventDefault(),t.stopPropagation();else{var n=this.options.zoomOptions&&this.options.zoomOptions.wheel,o=this.options.moveOptions&&this.options.moveOptions.wheel;if(n||o){var r=e.utils.getScrollDeltaPixels(t);!n||!t.ctrlKey&&o?(n=this.scrollX-r.x,o=this.scrollY-r.y,t.shiftKey&&!r.x&&(n=this.scrollX-r.y,o=this.scrollY),this.scroll(n,o)):(r=-r.y/50,n=e.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(n.x,n.y,r)),t.preventDefault()}}},e.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var t=this.getTopBoundedElements();if(!t.length)return new e.utils.Rect(0,0,0,0);for(var n=t[0].getBoundingRectangle(),o=1;o<t.length;o++){var r=t[o];r.isInsertionMarker&&r.isInsertionMarker()||((r=r.getBoundingRectangle()).top<n.top&&(n.top=r.top),r.bottom>n.bottom&&(n.bottom=r.bottom),r.left<n.left&&(n.left=r.left),r.right>n.right&&(n.right=r.right))}return n},e.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(!1),e.Events.setGroup(!0);for(var r,t=this.getTopBlocks(!0),n=0,o=0;r=t[o];o++)if(r.isMovable()){var a=r.getRelativeToSurfaceXY();r.moveBy(-a.x,n-a.y),r.snapToGrid(),n=r.getRelativeToSurfaceXY().y+r.getHeightWidth().height+this.renderer_.getConstants().MIN_BLOCK_HEIGHT}e.Events.setGroup(!1),this.setResizesEnabled(!0)},e.WorkspaceSvg.prototype.showContextMenu=function(t){if(!this.options.readOnly&&!this.isFlyout){var n=e.ContextMenuRegistry.registry.getContextMenuOptions(e.ContextMenuRegistry.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(n,t),e.ContextMenu.show(t,n,this.RTL)}},e.WorkspaceSvg.prototype.updateToolbox=function(t){if(t=e.utils.toolbox.convertToolboxDefToJson(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(e.utils.toolbox.hasCategories(t)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.render(t)}else{if(!this.flyout_)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout_.show(t)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")},e.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(e.mainWorkspace=this,this.setBrowserFocus())},e.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:!0})}catch(t){try{this.getParentSvg().parentNode.setActive()}catch(n){this.getParentSvg().parentNode.focus({preventScroll:!0})}}},e.WorkspaceSvg.prototype.zoom=function(t,n,o){o=Math.pow(this.options.zoomOptions.scaleSpeed,o);var r=this.scale*o;if(this.scale!=r){r>this.options.zoomOptions.maxScale?o=this.options.zoomOptions.maxScale/this.scale:r<this.options.zoomOptions.minScale&&(o=this.options.zoomOptions.minScale/this.scale);var a=this.getCanvas().getCTM(),h=this.getParentSvg().createSVGPoint();h.x=t,h.y=n,h=h.matrixTransform(a.inverse()),a=a.translate((t=h.x)*(1-o),(n=h.y)*(1-o)).scale(o),this.scrollX=a.e,this.scrollY=a.f,this.setScale(r)}},e.WorkspaceSvg.prototype.zoomCenter=function(t){var n=this.getMetrics();if(this.flyout_){var o=n.svgWidth?n.svgWidth/2:0;n=n.svgHeight?n.svgHeight/2:0}else o=n.viewWidth/2+n.absoluteLeft,n=n.viewHeight/2+n.absoluteTop;this.zoom(o,n,t)},e.WorkspaceSvg.prototype.zoomToFit=function(){if(this.isMovable()){var t=this.getMetrics(),n=t.viewWidth;t=t.viewHeight;var o=this.getBlocksBoundingBox(),r=o.right-o.left;if(o=o.bottom-o.top,r){this.flyout_&&(this.horizontalLayout?(t+=this.flyout_.getHeight(),o+=this.flyout_.getHeight()/this.scale):(n+=this.flyout_.getWidth(),r+=this.flyout_.getWidth()/this.scale)),n/=r,t/=o,e.Events.disable();try{this.setScale(Math.min(n,t)),this.scrollCenter()}finally{e.Events.enable()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},e.WorkspaceSvg.prototype.beginCanvasTransition=function(){e.utils.dom.addClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),e.utils.dom.addClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},e.WorkspaceSvg.prototype.endCanvasTransition=function(){e.utils.dom.removeClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),e.utils.dom.removeClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},e.WorkspaceSvg.prototype.scrollCenter=function(){if(this.isMovable()){var t=this.getMetrics(),n=(t.scrollWidth-t.viewWidth)/2,o=(t.scrollHeight-t.viewHeight)/2;this.scroll(n=-n-t.scrollLeft,o=-o-t.scrollTop)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},e.WorkspaceSvg.prototype.centerOnBlock=function(t){if(this.isMovable()){if(t=t?this.getBlockById(t):null){var n=t.getRelativeToSurfaceXY(),o=t.getHeightWidth(),r=this.scale;t=(n.x+(this.RTL?-1:1)*o.width/2)*r,n=(n.y+o.height/2)*r,o=this.getMetrics(),this.scroll(-(t-o.viewWidth/2),-(n-o.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},e.WorkspaceSvg.prototype.setScale=function(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,e.hideChaff(!1),this.flyout_&&(this.flyout_.reflow(),this.recordDragTargets()),this.grid_&&this.grid_.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout_?this.scrollbar.resizeView(t):this.scrollbar.resizeContent(t))},e.WorkspaceSvg.prototype.getScale=function(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale},e.WorkspaceSvg.prototype.scroll=function(t,n){e.hideChaff(!0);var o=this.getMetrics();t=Math.min(t,-o.scrollLeft),n=Math.min(n,-o.scrollTop);var r=o.scrollTop+Math.max(0,o.scrollHeight-o.viewHeight);t=Math.max(t,-(o.scrollLeft+Math.max(0,o.scrollWidth-o.viewWidth))),n=Math.max(n,-r),this.scrollX=t,this.scrollY=n,this.scrollbar&&this.scrollbar.set(-(t+o.scrollLeft),-(n+o.scrollTop),!1),this.translate(t+=o.absoluteLeft,n+=o.absoluteTop)},e.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(t){var n=this.getMetrics();"number"==typeof t.x&&(this.scrollX=-(n.scrollLeft+(n.scrollWidth-n.viewWidth)*t.x)),"number"==typeof t.y&&(this.scrollY=-(n.scrollTop+(n.scrollHeight-n.viewHeight)*t.y)),this.translate(this.scrollX+n.absoluteLeft,this.scrollY+n.absoluteTop)},e.WorkspaceSvg.prototype.getBlockById=function(t){return e.WorkspaceSvg.superClass_.getBlockById.call(this,t)},e.WorkspaceSvg.prototype.getTopBlocks=function(t){return e.WorkspaceSvg.superClass_.getTopBlocks.call(this,t)},e.WorkspaceSvg.prototype.addTopBlock=function(t){this.addTopBoundedElement(t),e.WorkspaceSvg.superClass_.addTopBlock.call(this,t)},e.WorkspaceSvg.prototype.removeTopBlock=function(t){this.removeTopBoundedElement(t),e.WorkspaceSvg.superClass_.removeTopBlock.call(this,t)},e.WorkspaceSvg.prototype.addTopComment=function(t){this.addTopBoundedElement(t),e.WorkspaceSvg.superClass_.addTopComment.call(this,t)},e.WorkspaceSvg.prototype.removeTopComment=function(t){this.removeTopBoundedElement(t),e.WorkspaceSvg.superClass_.removeTopComment.call(this,t)},e.WorkspaceSvg.prototype.addTopBoundedElement=function(t){this.topBoundedElements_.push(t)},e.WorkspaceSvg.prototype.removeTopBoundedElement=function(t){e.utils.arrayRemove(this.topBoundedElements_,t)},e.WorkspaceSvg.prototype.getTopBoundedElements=function(){return[].concat(this.topBoundedElements_)},e.WorkspaceSvg.prototype.setResizesEnabled=function(t){var n=!this.resizesEnabled_&&t;this.resizesEnabled_=t,n&&this.resizeContents()},e.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),e.WorkspaceSvg.superClass_.clear.call(this),this.topBoundedElements_=[],this.setResizesEnabled(!0)},e.WorkspaceSvg.prototype.registerButtonCallback=function(t,n){if("function"!=typeof n)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks_[t]=n},e.WorkspaceSvg.prototype.getButtonCallback=function(t){return(t=this.flyoutButtonCallbacks_[t])?t:null},e.WorkspaceSvg.prototype.removeButtonCallback=function(t){this.flyoutButtonCallbacks_[t]=null},e.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(t,n){if("function"!=typeof n)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[t]=n},e.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(t){return this.toolboxCategoryCallbacks_[t]||null},e.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(t){this.toolboxCategoryCallbacks_[t]=null},e.WorkspaceSvg.prototype.getGesture=function(t){var n="mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type,o=this.currentGesture_;return o?n&&o.hasStarted()?(console.warn("Tried to start the same gesture twice."),o.cancel(),null):o:n?this.currentGesture_=new e.TouchGesture(t,this):null},e.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},e.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},e.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},e.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},e.inject=function(t,n){if(e.checkBlockColourConstants(),"string"==typeof t&&(t=document.getElementById(t)||document.querySelector(t)),!t||!e.utils.dom.containsNode(document,t))throw Error("Error: container is not in current document.");n=new e.Options(n||{});var o=document.createElement("div");o.className="injectionDiv",o.tabIndex=0,e.utils.aria.setState(o,e.utils.aria.State.LABEL,e.Msg.WORKSPACE_ARIA_LABEL),t.appendChild(o),t=e.createDom_(o,n);var r=new e.BlockDragSurfaceSvg(o),a=new e.WorkspaceDragSurfaceSvg(o),h=e.createMainWorkspace_(t,n,r,a);return e.init_(h),e.mainWorkspace=h,e.svgResize(h),o.addEventListener("focusin",function(){e.mainWorkspace=h}),h},e.createDom_=function(t,n){t.setAttribute("dir","LTR"),e.Css.inject(n.hasCss,n.pathToMedia),t=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",class:"blocklySvg",tabindex:"0"},t);var o=e.utils.dom.createSvgElement(e.utils.Svg.DEFS,{},t),r=String(Math.random()).substring(2);return n.gridPattern=e.Grid.createDom(r,n.gridOptions,o),t},e.createMainWorkspace_=function(t,n,o,r){return n.parentWorkspace=null,(n=new e.WorkspaceSvg(n,o,r)).scale=(o=n.options).zoomOptions.startScale,t.appendChild(n.createDom("blocklyMainBackground")),e.utils.dom.addClass(n.getInjectionDiv(),n.getRenderer().getClassName()),e.utils.dom.addClass(n.getInjectionDiv(),n.getTheme().getClassName()),!o.hasCategories&&o.languageTree&&(r=n.addFlyout(e.utils.Svg.SVG),e.utils.dom.insertAfter(r,t)),o.hasTrashcan&&n.addTrashcan(),o.zoomOptions&&o.zoomOptions.controls&&n.addZoomControls(),n.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),n.translate(0,0),n.addChangeListener(e.bumpIntoBoundsHandler_(n)),e.svgResize(n),e.WidgetDiv.createDom(),e.DropDownDiv.createDom(),e.Tooltip.createDom(),n},e.extractObjectFromEvent_=function(t,n){var o=null;switch(n.type){case e.Events.BLOCK_CREATE:case e.Events.BLOCK_MOVE:(o=t.getBlockById(n.blockId))&&(o=o.getRootBlock());break;case e.Events.COMMENT_CREATE:case e.Events.COMMENT_MOVE:o=t.getCommentById(n.commentId)}return o},e.bumpTopObjectsIntoBounds_=function(t){var n=t.getMetricsManager();if(n.hasFixedEdges()&&!t.isDragging()){n=n.getScrollMetrics(!0);for(var a,o=t.getTopBoundedElements(),r=0;a=o[r];r++)e.bumpObjectIntoBounds_(t,n,a)}},e.bumpIntoBoundsHandler_=function(t){return function(n){var o=t.getMetricsManager();if(o.hasFixedEdges()&&!t.isDragging())if(-1!==e.Events.BUMP_EVENTS.indexOf(n.type)){o=o.getScrollMetrics(!0);var r=e.extractObjectFromEvent_(t,n);if(r){var a=e.Events.getGroup();e.Events.setGroup(n.group),e.bumpObjectIntoBounds_(t,o,r)&&!n.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),null!==a&&e.Events.setGroup(a)}}else n.type===e.Events.VIEWPORT_CHANGE&&n.scale>n.oldScale&&e.bumpTopObjectsIntoBounds_(t)}},e.bumpObjectIntoBounds_=function(t,n,o){var r=o.getBoundingRectangle(),a=r.right-r.left,h=e.utils.math.clamp(n.top,r.top,n.top+n.height-(r.bottom-r.top))-r.top,R=n.left;return n=n.left+n.width-a,t.RTL?R=Math.min(n,R):n=Math.max(R,n),!(!(t=e.utils.math.clamp(R,r.left,n)-r.left)&&!h||(o.moveBy(t,h),0))},e.init_=function(t){var n=t.options,o=t.getParentSvg();if(e.browserEvents.conditionalBind(o.parentNode,"contextmenu",null,function(a){e.utils.isTargetInput(a)||a.preventDefault()}),o=e.browserEvents.conditionalBind(window,"resize",null,function(){e.hideChaff(!0),e.svgResize(t),e.bumpTopObjectsIntoBounds_(t)}),t.setResizeHandlerWrapper(o),e.inject.bindDocumentEvents_(),n.languageTree){o=t.getToolbox();var r=t.getFlyout(!0);o?o.init():r&&(r.init(t),r.show(n.languageTree),"function"==typeof r.scrollToStart&&r.scrollToStart())}n.hasTrashcan&&t.trashcan.init(),n.zoomOptions&&n.zoomOptions.controls&&t.zoomControls_.init(),n.moveOptions&&n.moveOptions.scrollbars?(t.scrollbar=new e.ScrollbarPair(t,!0===n.moveOptions.scrollbars||!!n.moveOptions.scrollbars.horizontal,!0===n.moveOptions.scrollbars||!!n.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),n.hasSounds&&e.inject.loadSounds_(n.pathToMedia,t)},e.inject.bindDocumentEvents_=function(){e.documentEventsBound_||(e.browserEvents.conditionalBind(document,"scroll",null,function(){for(var o,t=e.Workspace.getAll(),n=0;o=t[n];n++)o.updateInverseScreenCTM&&o.updateInverseScreenCTM()}),e.browserEvents.conditionalBind(document,"keydown",null,e.onKeyDown),e.browserEvents.bind(document,"touchend",null,e.longStop_),e.browserEvents.bind(document,"touchcancel",null,e.longStop_),e.utils.userAgent.IPAD&&e.browserEvents.conditionalBind(window,"orientationchange",document,function(){e.svgResize(e.getMainWorkspace())})),e.documentEventsBound_=!0},e.inject.loadSounds_=function(t,n){var o=n.getAudioManager();o.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),o.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),o.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");var r=[];t=function(){for(;r.length;)e.browserEvents.unbind(r.pop());o.preload()},r.push(e.browserEvents.conditionalBind(document,"mousemove",null,t,!0)),r.push(e.browserEvents.conditionalBind(document,"touchstart",null,t,!0))},e.Names=function(t,n){if(this.variablePrefix_=n||"",this.reservedDict_=Object.create(null),t)for(t=t.split(","),n=0;n<t.length;n++)this.reservedDict_[t[n]]=!0;this.reset()},e.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE",e.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},e.Names.prototype.setVariableMap=function(t){this.variableMap_=t},e.Names.prototype.getNameForUserVariable_=function(t){return this.variableMap_?(t=this.variableMap_.getVariableById(t))?t.name:null:(console.warn("Deprecated call to Blockly.Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)},e.Names.prototype.populateVariables=function(t){t=e.Variables.allUsedVarModels(t);for(var n=0;n<t.length;n++)this.getName(t[n].getId(),e.VARIABLE_CATEGORY_NAME)},e.Names.prototype.populateProcedures=function(t){t=(t=e.Procedures.allProcedures(t))[0].concat(t[1]);for(var n=0;n<t.length;n++)this.getName(t[n][0],e.PROCEDURE_CATEGORY_NAME)},e.Names.prototype.getName=function(t,n){var o=t;n==e.VARIABLE_CATEGORY_NAME&&(t=this.getNameForUserVariable_(t))&&(o=t),t=o.toLowerCase();var r=n==e.VARIABLE_CATEGORY_NAME||n==e.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"";n in this.db_||(this.db_[n]=Object.create(null));var a=this.db_[n];return t in a?r+a[t]:(n=this.getDistinctName(o,n),a[t]=n.substr(r.length),n)},e.Names.prototype.getUserNames=function(t){return Object.keys(this.db_[t]||{})},e.Names.prototype.getDistinctName=function(t,n){t=this.safeName_(t);for(var o="";this.dbReverse_[t+o]||t+o in this.reservedDict_;)o=o?o+1:2;return this.dbReverse_[t+=o]=!0,(n==e.VARIABLE_CATEGORY_NAME||n==e.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"")+t},e.Names.prototype.safeName_=function(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(t[0])&&(t="my_"+t)):t=e.Msg.UNNAMED_KEY||"unnamed",t},e.Names.equals=function(t,n){return t.toLowerCase()==n.toLowerCase()},e.Procedures={},e.Procedures.NAME_TYPE=e.PROCEDURE_CATEGORY_NAME,e.Procedures.DEFAULT_ARG="x",e.Procedures.allProcedures=function(t){var n=t.getBlocksByType("procedures_defnoreturn",!1).map(function(o){return o.getProcedureDef()});return t=t.getBlocksByType("procedures_defreturn",!1).map(function(o){return o.getProcedureDef()}),n.sort(e.Procedures.procTupleComparator_),t.sort(e.Procedures.procTupleComparator_),[n,t]},e.Procedures.procTupleComparator_=function(t,n){return t[0].localeCompare(n[0],void 0,{sensitivity:"base"})},e.Procedures.findLegalName=function(t,n){if(n.isInFlyout)return t;for(t=t||e.Msg.UNNAMED_KEY||"unnamed";!e.Procedures.isLegalName_(t,n.workspace,n);){var o=t.match(/^(.*?)(\d+)$/);t=o?o[1]+(parseInt(o[2],10)+1):t+"2"}return t},e.Procedures.isLegalName_=function(t,n,o){return!e.Procedures.isNameUsed(t,n,o)},e.Procedures.isNameUsed=function(t,n,o){n=n.getAllBlocks(!1);for(var r=0;r<n.length;r++)if(n[r]!=o&&n[r].getProcedureDef){var a=n[r].getProcedureDef();if(e.Names.equals(a[0],t))return!0}return!1},e.Procedures.rename=function(t){t=t.trim();var n=e.Procedures.findLegalName(t,this.getSourceBlock()),o=this.getValue();if(o!=t&&o!=n){t=this.getSourceBlock().workspace.getAllBlocks(!1);for(var r=0;r<t.length;r++)t[r].renameProcedure&&t[r].renameProcedure(o,n)}return n},e.Procedures.flyoutCategory=function(t){function n(h,R){for(var L=0;L<h.length;L++){var W=h[L][0],nt=h[L][1],et=e.utils.xml.createElement("block");et.setAttribute("type",R),et.setAttribute("gap",16);var Et=e.utils.xml.createElement("mutation");for(Et.setAttribute("name",W),et.appendChild(Et),W=0;W<nt.length;W++){var It=e.utils.xml.createElement("arg");It.setAttribute("name",nt[W]),Et.appendChild(It)}o.push(et)}}var o=[];if(e.Blocks.procedures_defnoreturn){var r=e.utils.xml.createElement("block");r.setAttribute("type","procedures_defnoreturn"),r.setAttribute("gap",16);var a=e.utils.xml.createElement("field");a.setAttribute("name","NAME"),a.appendChild(e.utils.xml.createTextNode(e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE)),r.appendChild(a),o.push(r)}return e.Blocks.procedures_defreturn&&((r=e.utils.xml.createElement("block")).setAttribute("type","procedures_defreturn"),r.setAttribute("gap",16),(a=e.utils.xml.createElement("field")).setAttribute("name","NAME"),a.appendChild(e.utils.xml.createTextNode(e.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),r.appendChild(a),o.push(r)),e.Blocks.procedures_ifreturn&&((r=e.utils.xml.createElement("block")).setAttribute("type","procedures_ifreturn"),r.setAttribute("gap",16),o.push(r)),o.length&&o[o.length-1].setAttribute("gap",24),n((t=e.Procedures.allProcedures(t))[0],"procedures_callnoreturn"),n(t[1],"procedures_callreturn"),o},e.Procedures.updateMutatorFlyout_=function(t){for(var a,n=[],o=t.getBlocksByType("procedures_mutatorarg",!1),r=0;a=o[r];r++)n.push(a.getFieldValue("NAME"));o=e.utils.xml.createElement("xml"),(r=e.utils.xml.createElement("block")).setAttribute("type","procedures_mutatorarg"),(a=e.utils.xml.createElement("field")).setAttribute("name","NAME"),n=e.Variables.generateUniqueNameFromOptions(e.Procedures.DEFAULT_ARG,n),n=e.utils.xml.createTextNode(n),a.appendChild(n),r.appendChild(a),o.appendChild(r),t.updateToolbox(o)},e.Procedures.mutatorOpenListener=function(t){if(t.type==e.Events.BUBBLE_OPEN&&"mutator"===t.bubbleType&&t.isOpen){var n=(t=e.Workspace.getById(t.workspaceId).getBlockById(t.blockId)).type;("procedures_defnoreturn"==n||"procedures_defreturn"==n)&&(t=t.mutator.getWorkspace(),e.Procedures.updateMutatorFlyout_(t),t.addChangeListener(e.Procedures.mutatorChangeListener_))}},e.Procedures.mutatorChangeListener_=function(t){(t.type==e.Events.BLOCK_CREATE||t.type==e.Events.BLOCK_DELETE||t.type==e.Events.BLOCK_CHANGE)&&(t=e.Workspace.getById(t.workspaceId),e.Procedures.updateMutatorFlyout_(t))},e.Procedures.getCallers=function(t,n){var o=[];n=n.getAllBlocks(!1);for(var r=0;r<n.length;r++)if(n[r].getProcedureCall){var a=n[r].getProcedureCall();a&&e.Names.equals(a,t)&&o.push(n[r])}return o},e.Procedures.mutateCallers=function(t){var a,n=e.Events.recordUndo,o=t.getProcedureDef()[0],r=t.mutationToDom(!0);for(t=e.Procedures.getCallers(o,t.workspace),o=0;a=t[o];o++){var h=a.mutationToDom();h=h&&e.Xml.domToText(h),a.domToMutation(r);var R=a.mutationToDom();h!=(R=R&&e.Xml.domToText(R))&&(e.Events.recordUndo=!1,e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(a,"mutation",null,h,R)),e.Events.recordUndo=n)}},e.Procedures.getDefinition=function(t,n){n=n.getAllBlocks(!1);for(var o=0;o<n.length;o++)if(n[o].getProcedureDef){var r=n[o].getProcedureDef();if(r&&e.Names.equals(r[0],t))return n[o]}return null},e.ShortcutRegistry=function(){e.ShortcutRegistry.registry=this,this.registry_=Object.create(null),this.keyMap_=Object.create(null)},e.ShortcutRegistry.modifierKeys={Shift:e.utils.KeyCodes.SHIFT,Control:e.utils.KeyCodes.CTRL,Alt:e.utils.KeyCodes.ALT,Meta:e.utils.KeyCodes.META},e.ShortcutRegistry.prototype.register=function(t,n){if(this.registry_[t.name]&&!n)throw Error('Shortcut with name "'+t.name+'" already exists.');this.registry_[t.name]=t},e.ShortcutRegistry.prototype.unregister=function(t){return this.registry_[t]?(this.removeAllKeyMappings(t),delete this.registry_[t],!0):(console.warn('Keyboard shortcut with name "'+t+'" not found.'),!1)},e.ShortcutRegistry.prototype.addKeyMapping=function(t,n,o){t=String(t);var r=this.keyMap_[t];if(r&&!o)throw Error('Shortcut with name "'+n+'" collides with shortcuts '+r.toString());r&&o?r.unshift(n):this.keyMap_[t]=[n]},e.ShortcutRegistry.prototype.removeKeyMapping=function(t,n,o){var r=this.keyMap_[t];if(!r&&!o)return console.warn('No keyboard shortcut with name "'+n+'" registered with key code "'+t+'"'),!1;var a=r.indexOf(n);return-1<a?(r.splice(a,1),0==r.length&&delete this.keyMap_[t],!0):(o||console.warn('No keyboard shortcut with name "'+n+'" registered with key code "'+t+'"'),!1)},e.ShortcutRegistry.prototype.removeAllKeyMappings=function(t){for(var n in this.keyMap_)this.removeKeyMapping(n,t,!0)},e.ShortcutRegistry.prototype.setKeyMap=function(t){this.keyMap_=t},e.ShortcutRegistry.prototype.getKeyMap=function(){return e.utils.object.deepMerge(Object.create(null),this.keyMap_)},e.ShortcutRegistry.prototype.getRegistry=function(){return e.utils.object.deepMerge(Object.create(null),this.registry_)},e.ShortcutRegistry.prototype.onKeyDown=function(t,n){var o=this.serializeKeyEvent_(n);if(!(o=this.getShortcutNamesByKeyCode(o)))return!1;for(var a,r=0;a=o[r];r++)if((!(a=this.registry_[a]).preconditionFn||a.preconditionFn(t))&&a.callback&&a.callback(t,n,a))return!0;return!1},e.ShortcutRegistry.prototype.getShortcutNamesByKeyCode=function(t){return this.keyMap_[t]||[]},e.ShortcutRegistry.prototype.getKeyCodesByShortcutName=function(t){var o,n=[];for(o in this.keyMap_)-1<this.keyMap_[o].indexOf(t)&&n.push(o);return n},e.ShortcutRegistry.prototype.serializeKeyEvent_=function(t){var o,n="";for(o in e.ShortcutRegistry.modifierKeys)t.getModifierState(o)&&(""!=n&&(n+="+"),n+=o);return""!=n&&t.keyCode?n=n+"+"+t.keyCode:t.keyCode&&(n=t.keyCode.toString()),n},e.ShortcutRegistry.prototype.checkModifiers_=function(t){for(var r,n=e.utils.object.values(e.ShortcutRegistry.modifierKeys),o=0;r=t[o];o++)if(0>n.indexOf(r))throw Error(r+" is not a valid modifier key.")},e.ShortcutRegistry.prototype.createSerializedKey=function(t,n){var o="";if(n)for(var r in this.checkModifiers_(n),e.ShortcutRegistry.modifierKeys)-1<n.indexOf(e.ShortcutRegistry.modifierKeys[r])&&(""!=o&&(o+="+"),o+=r);return""!=o&&t?o=o+"+"+t:t&&(o=t.toString()),o},new e.ShortcutRegistry,e.VariableModel=function(t,n,o,r){this.workspace=t,this.name=n,this.type=o||"",this.id_=r||e.utils.genUid(),e.Events.fire(new(e.Events.get(e.Events.VAR_CREATE))(this))},e.VariableModel.prototype.getId=function(){return this.id_},e.VariableModel.compareByName=function(t,n){return t.name.localeCompare(n.name,void 0,{sensitivity:"base"})},e.Variables={},e.Variables.NAME_TYPE=e.VARIABLE_CATEGORY_NAME,e.Variables.allUsedVarModels=function(t){var n=t.getAllBlocks(!1);t=Object.create(null);for(var o=0;o<n.length;o++){var r=n[o].getVarModels();if(r)for(var a=0;a<r.length;a++){var h=r[a],R=h.getId();R&&(t[R]=h)}}for(R in n=[],t)n.push(t[R]);return n},e.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_={},e.Variables.allDeveloperVariables=function(t){t=t.getAllBlocks(!1);for(var r,n=Object.create(null),o=0;r=t[o];o++){var a=r.getDeveloperVariables;if(!a&&r.getDeveloperVars&&(a=r.getDeveloperVars,e.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[r.type]||(console.warn("Function getDeveloperVars() deprecated. Use getDeveloperVariables() (block type '"+r.type+"')"),e.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[r.type]=!0)),a)for(r=a(),a=0;a<r.length;a++)n[r[a]]=!0}return Object.keys(n)},e.Variables.flyoutCategory=function(t){var n=[],o=document.createElement("button");return o.setAttribute("text","%{BKY_NEW_VARIABLE}"),o.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",function(r){e.Variables.createVariableButtonHandler(r.getTargetWorkspace())}),n.push(o),t=e.Variables.flyoutCategoryBlocks(t),n.concat(t)},e.Variables.flyoutCategoryBlocks=function(t){var n=[];if(0<(t=t.getVariablesOfType("")).length){var o=t[t.length-1];if(e.Blocks.variables_set){var r=e.utils.xml.createElement("block");r.setAttribute("type","variables_set"),r.setAttribute("gap",e.Blocks.math_change?8:24),r.appendChild(e.Variables.generateVariableFieldDom(o)),n.push(r)}if(e.Blocks.math_change&&((r=e.utils.xml.createElement("block")).setAttribute("type","math_change"),r.setAttribute("gap",e.Blocks.variables_get?20:8),r.appendChild(e.Variables.generateVariableFieldDom(o)),o=e.Xml.textToDom('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),r.appendChild(o),n.push(r)),e.Blocks.variables_get){t.sort(e.VariableModel.compareByName),o=0;for(var a;a=t[o];o++)(r=e.utils.xml.createElement("block")).setAttribute("type","variables_get"),r.setAttribute("gap",8),r.appendChild(e.Variables.generateVariableFieldDom(a)),n.push(r)}}return n},e.Variables.VAR_LETTER_OPTIONS="ijkmnopqrstuvwxyzabcdefgh",e.Variables.generateUniqueName=function(t){return e.Variables.generateUniqueNameFromOptions(e.Variables.VAR_LETTER_OPTIONS.charAt(0),t.getAllVariableNames())},e.Variables.generateUniqueNameFromOptions=function(t,n){if(!n.length)return t;for(var o=e.Variables.VAR_LETTER_OPTIONS,r="",a=o.indexOf(t);;){for(var h=!1,R=0;R<n.length;R++)if(n[R].toLowerCase()==t){h=!0;break}if(!h)return t;++a==o.length&&(a=0,r=Number(r)+1),t=o.charAt(a)+r}},e.Variables.createVariableButtonHandler=function(t,n,o){var r=o||"",a=function(h){e.Variables.promptName(e.Msg.NEW_VARIABLE_TITLE,h,function(R){if(R){var L=e.Variables.nameUsedWithAnyType(R,t);if(L){if(L.type==r)var W=e.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",L.name);else W=(W=e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",L.name).replace("%2",L.type);e.alert(W,function(){a(R)})}else t.createVariable(R,r),n&&n(R)}else n&&n(null)})};a("")},e.Variables.createVariable=e.Variables.createVariableButtonHandler,e.Variables.renameVariable=function(t,n,o){var r=function(a){var h=e.Msg.RENAME_VARIABLE_TITLE.replace("%1",n.name);e.Variables.promptName(h,a,function(R){if(R){var L=e.Variables.nameUsedWithOtherType_(R,n.type,t);L?(L=e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",L.name).replace("%2",L.type),e.alert(L,function(){r(R)})):(t.renameVariableById(n.getId(),R),o&&o(R))}else o&&o(null)})};r("")},e.Variables.promptName=function(t,n,o){e.prompt(t,n,function(r){r&&((r=r.replace(/[\s\xa0]+/g," ").trim())==e.Msg.RENAME_VARIABLE||r==e.Msg.NEW_VARIABLE)&&(r=null),o(r)})},e.Variables.nameUsedWithOtherType_=function(t,n,o){o=o.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var a,r=0;a=o[r];r++)if(a.name.toLowerCase()==t&&a.type!=n)return a;return null},e.Variables.nameUsedWithAnyType=function(t,n){n=n.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var r,o=0;r=n[o];o++)if(r.name.toLowerCase()==t)return r;return null},e.Variables.generateVariableFieldDom=function(t){var n=e.utils.xml.createElement("field");return n.setAttribute("name","VAR"),n.setAttribute("id",t.getId()),n.setAttribute("variabletype",t.type),t=e.utils.xml.createTextNode(t.name),n.appendChild(t),n},e.Variables.getOrCreateVariablePackage=function(t,n,o,r){var a=e.Variables.getVariable(t,n,o,r);return a||(a=e.Variables.createVariable_(t,n,o,r)),a},e.Variables.getVariable=function(t,n,o,r){var a=t.getPotentialVariableMap(),h=null;if(n&&(!(h=t.getVariableById(n))&&a&&(h=a.getVariableById(n)),h))return h;if(o){if(null==r)throw Error("Tried to look up a variable by name without a type");!(h=t.getVariable(o,r))&&a&&(h=a.getVariable(o,r))}return h},e.Variables.createVariable_=function(t,n,o,r){var a=t.getPotentialVariableMap();return o||(o=e.Variables.generateUniqueName(t.isFlyout?t.targetWorkspace:t)),a?a.createVariable(o,r,n):t.createVariable(o,r,n)},e.Variables.getAddedVariables=function(t,n){t=t.getAllVariables();var o=[];if(n.length!=t.length)for(var r=0;r<t.length;r++){var a=t[r];-1==n.indexOf(a)&&o.push(a)}return o},e.VERSION="6.20210701.0",e.mainWorkspace=null,e.selected=null,e.draggingConnections=[],e.clipboardXml_=null,e.clipboardSource_=null,e.clipboardTypeCounts_=null,e.cache3dSupported_=null,e.parentContainer=null,e.svgSize=function(t){return e.utils.deprecation.warn("Blockly.svgSize","March 2021","March 2022","workspace.getCachedParentSvgSize"),new e.utils.Size(t.cachedWidth_,t.cachedHeight_)},e.resizeSvgContents=function(t){t.resizeContents()},e.svgResize=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;var n=t.getParentSvg(),o=t.getCachedParentSvgSize(),r=n.parentNode;if(r){var a=r.offsetWidth;r=r.offsetHeight,o.width!=a&&(n.setAttribute("width",a+"px"),t.setCachedParentSvgSize(a,null)),o.height!=r&&(n.setAttribute("height",r+"px"),t.setCachedParentSvgSize(null,r)),t.resize()}},e.onKeyDown=function(t){var n=e.mainWorkspace;n&&!(e.utils.isTargetInput(t)||n.rendered&&!n.isVisible())&&e.ShortcutRegistry.registry.onKeyDown(n,t)},e.deleteBlock=function(t){t.workspace.isFlyout||(e.Events.setGroup(!0),e.hideChaff(),t.dispose(!t.outputConnection,!0),e.Events.setGroup(!1))},e.copy=function(t){(t=t.toCopyData())&&(e.clipboardXml_=t.xml,e.clipboardSource_=t.source,e.clipboardTypeCounts_=t.typeCounts)},e.paste=function(){if(!e.clipboardXml_)return!1;var t=e.clipboardSource_;return t.isFlyout&&(t=t.targetWorkspace),!(!e.clipboardTypeCounts_||!t.isCapacityAvailable(e.clipboardTypeCounts_)||(e.Events.setGroup(!0),t.paste(e.clipboardXml_),e.Events.setGroup(!1),0))},e.duplicate=function(t){var n=e.clipboardXml_,o=e.clipboardSource_;e.copy(t),t.workspace.paste(e.clipboardXml_),e.clipboardXml_=n,e.clipboardSource_=o},e.onContextMenu_=function(t){e.utils.isTargetInput(t)||t.preventDefault()},e.hideChaff=function(t){e.Tooltip.hide(),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation();var n=!!t;e.getMainWorkspace().getComponentManager().getComponents(e.ComponentManager.Capability.AUTOHIDEABLE,!0).forEach(function(o){o.autoHide(n)})},e.getMainWorkspace=function(){return e.mainWorkspace},e.alert=function(t,n){alert(t),n&&n()},e.confirm=function(t,n){n(confirm(t))},e.prompt=function(t,n,o){o(prompt(t,n))},e.jsonInitFactory_=function(t){return function(){this.jsonInit(t)}},e.defineBlocksWithJsonArray=function(t){for(var n=0;n<t.length;n++){var o=t[n];if(o){var r=o.type;null==r||""===r?console.warn("Block definition #"+n+" in JSON array is missing a type attribute. Skipping."):(e.Blocks[r]&&console.warn("Block definition #"+n+' in JSON array overwrites prior definition of "'+r+'".'),e.Blocks[r]={init:e.jsonInitFactory_(o)})}else console.warn("Block definition #"+n+" in JSON array is "+o+". Skipping.")}},e.isNumber=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},e.hueToHex=function(t){return e.utils.colour.hsvToHex(t,e.HSV_SATURATION,255*e.HSV_VALUE)},e.checkBlockColourConstants=function(){e.checkBlockColourConstant_("LOGIC_HUE",["Blocks","logic","HUE"],void 0),e.checkBlockColourConstant_("LOGIC_HUE",["Constants","Logic","HUE"],210),e.checkBlockColourConstant_("LOOPS_HUE",["Blocks","loops","HUE"],void 0),e.checkBlockColourConstant_("LOOPS_HUE",["Constants","Loops","HUE"],120),e.checkBlockColourConstant_("MATH_HUE",["Blocks","math","HUE"],void 0),e.checkBlockColourConstant_("MATH_HUE",["Constants","Math","HUE"],230),e.checkBlockColourConstant_("TEXTS_HUE",["Blocks","texts","HUE"],void 0),e.checkBlockColourConstant_("TEXTS_HUE",["Constants","Text","HUE"],160),e.checkBlockColourConstant_("LISTS_HUE",["Blocks","lists","HUE"],void 0),e.checkBlockColourConstant_("LISTS_HUE",["Constants","Lists","HUE"],260),e.checkBlockColourConstant_("COLOUR_HUE",["Blocks","colour","HUE"],void 0),e.checkBlockColourConstant_("COLOUR_HUE",["Constants","Colour","HUE"],20),e.checkBlockColourConstant_("VARIABLES_HUE",["Blocks","variables","HUE"],void 0),e.checkBlockColourConstant_("VARIABLES_HUE",["Constants","Variables","HUE"],330),e.checkBlockColourConstant_("VARIABLES_DYNAMIC_HUE",["Constants","VariablesDynamic","HUE"],310),e.checkBlockColourConstant_("PROCEDURES_HUE",["Blocks","procedures","HUE"],void 0)},e.checkBlockColourConstant_=function(t,n,o){for(var r="Blockly",a=e,h=0;h<n.length;++h)r+="."+n[h],a&&(a=a[n[h]]);a&&a!==o&&(t=(void 0===o?'%1 has been removed. Use Blockly.Msg["%2"].':'%1 is deprecated and unused. Override Blockly.Msg["%2"].').replace("%1",r).replace("%2",t),console.warn(t))},e.setParentContainer=function(t){e.parentContainer=t},e.bindEvent_=e.browserEvents.bind,e.unbindEvent_=e.browserEvents.unbind,e.bindEventWithChecks_=e.browserEvents.conditionalBind,e.ALIGN_LEFT=e.constants.ALIGN.LEFT,e.ALIGN_CENTRE=e.constants.ALIGN.CENTRE,e.ALIGN_RIGHT=e.constants.ALIGN.RIGHT,e.INPUT_VALUE=e.connectionTypes.INPUT_VALUE,e.OUTPUT_VALUE=e.connectionTypes.OUTPUT_VALUE,e.NEXT_STATEMENT=e.connectionTypes.NEXT_STATEMENT,e.PREVIOUS_STATEMENT=e.connectionTypes.PREVIOUS_STATEMENT,e.DUMMY_INPUT=e.inputTypes.DUMMY,e.TOOLBOX_AT_TOP=e.utils.toolbox.Position.TOP,e.TOOLBOX_AT_BOTTOM=e.utils.toolbox.Position.BOTTOM,e.TOOLBOX_AT_LEFT=e.utils.toolbox.Position.LEFT,e.TOOLBOX_AT_RIGHT=e.utils.toolbox.Position.RIGHT,e.Events.BubbleOpen=function(t,n,o){e.Events.BubbleOpen.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.isOpen=n,this.bubbleType=o},e.utils.object.inherits(e.Events.BubbleOpen,e.Events.UiBase),e.Events.BubbleOpen.prototype.type=e.Events.BUBBLE_OPEN,e.Events.BubbleOpen.prototype.toJson=function(){var t=e.Events.BubbleOpen.superClass_.toJson.call(this);return t.isOpen=this.isOpen,t.bubbleType=this.bubbleType,t.blockId=this.blockId,t},e.Events.BubbleOpen.prototype.fromJson=function(t){e.Events.BubbleOpen.superClass_.fromJson.call(this,t),this.isOpen=t.isOpen,this.bubbleType=t.bubbleType,this.blockId=t.blockId},e.registry.register(e.registry.Type.EVENT,e.Events.BUBBLE_OPEN,e.Events.BubbleOpen),e.Icon=function(t){this.block_=t,this.iconGroup_=null},e.Icon.prototype.collapseHidden=!0,e.Icon.prototype.SIZE=17,e.Icon.prototype.bubble_=null,e.Icon.prototype.iconXY_=null,e.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&e.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),e.browserEvents.conditionalBind(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},e.Icon.prototype.dispose=function(){e.utils.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},e.Icon.prototype.updateEditable=function(){},e.Icon.prototype.isVisible=function(){return!!this.bubble_},e.Icon.prototype.iconClick_=function(t){this.block_.workspace.isDragging()||this.block_.isInFlyout||e.utils.isRightButton(t)||this.setVisible(!this.isVisible())},e.Icon.prototype.applyColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.style.colourPrimary)},e.Icon.prototype.setIconLocation=function(t){this.iconXY_=t,this.isVisible()&&this.bubble_.setAnchorLocation(t)},e.Icon.prototype.computeIconLocation=function(){var t=this.block_.getRelativeToSurfaceXY(),n=e.utils.getRelativeXY(this.iconGroup_);t=new e.utils.Coordinate(t.x+n.x+this.SIZE/2,t.y+n.y+this.SIZE/2),e.utils.Coordinate.equals(this.getIconLocation(),t)||this.setIconLocation(t)},e.Icon.prototype.getIconLocation=function(){return this.iconXY_},e.Icon.prototype.getCorrectedSize=function(){return new e.utils.Size(e.Icon.prototype.SIZE,e.Icon.prototype.SIZE-2)},e.Warning=function(t){e.Warning.superClass_.constructor.call(this,t),this.createIcon(),this.text_=Object.create(null)},e.utils.object.inherits(e.Warning,e.Icon),e.Warning.prototype.collapseHidden=!1,e.Warning.prototype.drawIcon_=function(t){e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},t),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},t),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},t)},e.Warning.prototype.setVisible=function(t){t!=this.isVisible()&&(e.Events.fire(new(e.Events.get(e.Events.BUBBLE_OPEN))(this.block_,t,"warning")),t?this.createBubble_():this.disposeBubble_())},e.Warning.prototype.createBubble_=function(){this.paragraphElement_=e.Bubble.textToDom(this.getText()),this.bubble_=e.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},e.Warning.prototype.disposeBubble_=function(){this.bubble_.dispose(),this.paragraphElement_=this.bubble_=null},e.Warning.prototype.setText=function(t,n){this.text_[n]!=t&&(t?this.text_[n]=t:delete this.text_[n],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},e.Warning.prototype.getText=function(){var n,t=[];for(n in this.text_)t.push(this.text_[n]);return t.join("\n")},e.Warning.prototype.dispose=function(){this.block_.warning=null,e.Icon.prototype.dispose.call(this)},e.Comment=function(t){e.Comment.superClass_.constructor.call(this,t),this.model_=t.commentModel,this.model_.text=this.model_.text||"",this.cachedText_="",this.onInputWrapper_=this.onChangeWrapper_=this.onWheelWrapper_=this.onMouseUpWrapper_=null,this.createIcon()},e.utils.object.inherits(e.Comment,e.Icon),e.Comment.prototype.drawIcon_=function(t){e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},t),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},t),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},t)},e.Comment.prototype.createEditor_=function(){this.foreignObject_=e.utils.dom.createSvgElement(e.utils.Svg.FOREIGNOBJECT,{x:e.Bubble.BORDER_WIDTH,y:e.Bubble.BORDER_WIDTH},null);var t=document.createElementNS(e.utils.dom.HTML_NS,"body");t.setAttribute("xmlns",e.utils.dom.HTML_NS),t.className="blocklyMinimalBody";var n=this.textarea_=document.createElementNS(e.utils.dom.HTML_NS,"textarea");return n.className="blocklyCommentTextarea",n.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),n.value=this.model_.text,this.resizeTextarea_(),t.appendChild(n),this.foreignObject_.appendChild(t),this.onMouseUpWrapper_=e.browserEvents.conditionalBind(n,"mouseup",this,this.startEdit_,!0,!0),this.onWheelWrapper_=e.browserEvents.conditionalBind(n,"wheel",this,function(o){o.stopPropagation()}),this.onChangeWrapper_=e.browserEvents.conditionalBind(n,"change",this,function(o){this.cachedText_!=this.model_.text&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this.block_,"comment",null,this.cachedText_,this.model_.text))}),this.onInputWrapper_=e.browserEvents.conditionalBind(n,"input",this,function(o){this.model_.text=n.value}),setTimeout(n.focus.bind(n),0),this.foreignObject_},e.Comment.prototype.updateEditable=function(){e.Comment.superClass_.updateEditable.call(this),this.isVisible()&&(this.disposeBubble_(),this.createBubble_())},e.Comment.prototype.onBubbleResize_=function(){this.isVisible()&&(this.model_.size=this.bubble_.getBubbleSize(),this.resizeTextarea_())},e.Comment.prototype.resizeTextarea_=function(){var t=this.model_.size,n=2*e.Bubble.BORDER_WIDTH,o=t.width-n;t=t.height-n,this.foreignObject_.setAttribute("width",o),this.foreignObject_.setAttribute("height",t),this.textarea_.style.width=o-4+"px",this.textarea_.style.height=t-4+"px"},e.Comment.prototype.setVisible=function(t){t!=this.isVisible()&&(e.Events.fire(new(e.Events.get(e.Events.BUBBLE_OPEN))(this.block_,t,"comment")),(this.model_.pinned=t)?this.createBubble_():this.disposeBubble_())},e.Comment.prototype.createBubble_=function(){!this.block_.isEditable()||e.utils.userAgent.IE?this.createNonEditableBubble_():this.createEditableBubble_()},e.Comment.prototype.createEditableBubble_=function(){this.bubble_=new e.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,this.model_.size.width,this.model_.size.height),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerResizeEvent(this.onBubbleResize_.bind(this)),this.applyColour()},e.Comment.prototype.createNonEditableBubble_=function(){this.paragraphElement_=e.Bubble.textToDom(this.block_.getCommentText()),this.bubble_=e.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},e.Comment.prototype.disposeBubble_=function(){this.onMouseUpWrapper_&&(e.browserEvents.unbind(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onWheelWrapper_&&(e.browserEvents.unbind(this.onWheelWrapper_),this.onWheelWrapper_=null),this.onChangeWrapper_&&(e.browserEvents.unbind(this.onChangeWrapper_),this.onChangeWrapper_=null),this.onInputWrapper_&&(e.browserEvents.unbind(this.onInputWrapper_),this.onInputWrapper_=null),this.bubble_.dispose(),this.paragraphElement_=this.foreignObject_=this.textarea_=this.bubble_=null},e.Comment.prototype.startEdit_=function(t){this.bubble_.promote()&&this.textarea_.focus(),this.cachedText_=this.model_.text},e.Comment.prototype.getBubbleSize=function(){return this.model_.size},e.Comment.prototype.setBubbleSize=function(t,n){this.bubble_?this.bubble_.setBubbleSize(t,n):(this.model_.size.width=t,this.model_.size.height=n)},e.Comment.prototype.updateText=function(){this.textarea_?this.textarea_.value=this.model_.text:this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model_.text)},e.Comment.prototype.dispose=function(){this.block_.comment=null,e.Icon.prototype.dispose.call(this)},e.Css.register(".blocklyCommentTextarea {,background-color: #fef49c;,border: 0;,outline: 0;,margin: 0;,padding: 3px;,resize: none;,display: block;,text-overflow: hidden;,}".split(",")),e.IComponent=function(){},e.IDragTarget=function(){},e.DragTarget=function(){},e.DragTarget.prototype.onDragEnter=function(t){},e.DragTarget.prototype.onDragOver=function(t){},e.DragTarget.prototype.onDragExit=function(t){},e.DragTarget.prototype.onDrop=function(t){},e.DragTarget.prototype.shouldPreventMove=function(t){return!1},e.IDeleteArea=function(){},e.DeleteArea=function(){e.DeleteArea.superClass_.constructor.call(this),this.wouldDelete_=!1},e.utils.object.inherits(e.DeleteArea,e.DragTarget),e.DeleteArea.prototype.wouldDelete=function(t,n){return t instanceof e.BlockSvg?(t=!t.getParent()&&t.isDeletable(),this.updateWouldDelete_(t&&!n)):this.updateWouldDelete_(t.isDeletable()),this.wouldDelete_},e.DeleteArea.prototype.updateWouldDelete_=function(t){this.wouldDelete_=t},e.IFlyout=function(){},e.Flyout=function(t){e.Flyout.superClass_.constructor.call(this),t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new e.WorkspaceSvg(t),this.workspace_.setMetricsManager(new e.FlyoutMetricsManager(this.workspace_,this)),this.workspace_.isFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=e.utils.genUid(),this.RTL=!!t.RTL,this.horizontalLayout=!1,this.toolboxPosition_=t.toolboxPosition,this.eventWrappers_=[],this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.targetWorkspace=null},e.utils.object.inherits(e.Flyout,e.DeleteArea),e.Flyout.prototype.autoClose=!0,e.Flyout.prototype.isVisible_=!1,e.Flyout.prototype.containerVisible_=!0,e.Flyout.prototype.CORNER_RADIUS=8,e.Flyout.prototype.MARGIN=e.Flyout.prototype.CORNER_RADIUS,e.Flyout.prototype.GAP_X=3*e.Flyout.prototype.MARGIN,e.Flyout.prototype.GAP_Y=3*e.Flyout.prototype.MARGIN,e.Flyout.prototype.SCROLLBAR_MARGIN=2.5,e.Flyout.prototype.width_=0,e.Flyout.prototype.height_=0,e.Flyout.prototype.dragAngleRange_=70,e.Flyout.prototype.createDom=function(t){return this.svgGroup_=e.utils.dom.createSvgElement(t,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_},e.Flyout.prototype.init=function(t){this.targetWorkspace=t,this.workspace_.targetWorkspace=t,this.workspace_.scrollbar=new e.ScrollbarPair(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),Array.prototype.push.apply(this.eventWrappers_,e.browserEvents.conditionalBind(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,e.browserEvents.conditionalBind(this.svgBackground_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),t.getComponentManager().addComponent({component:this,weight:1,capabilities:[e.ComponentManager.Capability.DELETE_AREA,e.ComponentManager.Capability.DRAG_TARGET]})},e.Flyout.prototype.dispose=function(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id),e.browserEvents.unbind(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&(e.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace=this.svgBackground_=null},e.Flyout.prototype.getWidth=function(){return this.width_},e.Flyout.prototype.getHeight=function(){return this.height_},e.Flyout.prototype.getFlyoutScale=function(){return this.targetWorkspace.scale},e.Flyout.prototype.getWorkspace=function(){return this.workspace_},e.Flyout.prototype.isVisible=function(){return this.isVisible_},e.Flyout.prototype.setVisible=function(t){var n=t!=this.isVisible();this.isVisible_=t,n&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_())},e.Flyout.prototype.setContainerVisible=function(t){var n=t!=this.containerVisible_;this.containerVisible_=t,n&&this.updateDisplay_()},e.Flyout.prototype.updateDisplay_=function(){var t=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=t?"block":"none",this.workspace_.scrollbar.setContainerVisible(t)},e.Flyout.prototype.positionAt_=function(t,n,o,r){this.svgGroup_.setAttribute("width",t),this.svgGroup_.setAttribute("height",n),this.workspace_.setCachedParentSvgSize(t,n),"svg"==this.svgGroup_.tagName?e.utils.dom.setCssTransform(this.svgGroup_,"translate("+o+"px,"+r+"px)"):this.svgGroup_.setAttribute("transform","translate("+o+","+r+")"),(t=this.workspace_.scrollbar)&&(t.setOrigin(o,r),t.resize(),t.hScroll&&t.hScroll.setPosition(t.hScroll.position.x,t.hScroll.position.y),t.vScroll&&t.vScroll.setPosition(t.vScroll.position.x,t.vScroll.position.y))},e.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var n,t=0;n=this.listeners_[t];t++)e.browserEvents.unbind(n);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},e.Flyout.prototype.show=function(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof t&&(t=this.getDynamicCategoryContents_(t)),this.setVisible(!0),t=e.utils.toolbox.convertFlyoutDefToJsonArray(t),t=this.createFlyoutInfo_(t),this.layout_(t.contents,t.gaps),this.listeners_.push(e.browserEvents.conditionalBind(this.svgBackground_,"mouseover",this,function(){for(var r,n=this.workspace_.getTopBlocks(!1),o=0;r=n[o];o++)r.removeSelect()})),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_)},e.Flyout.prototype.createFlyoutInfo_=function(t){var n=[],o=[];this.permanentlyDisabled_.length=0;for(var h,r=this.horizontalLayout?this.GAP_X:this.GAP_Y,a=0;h=t[a];a++)switch(h.custom&&(h=this.getDynamicCategoryContents_(h.custom),h=e.utils.toolbox.convertFlyoutDefToJsonArray(h),t.splice.apply(t,[a,1].concat(h)),h=t[a]),h.kind.toUpperCase()){case"BLOCK":var R=h,L=this.getBlockXml_(R);h=this.createBlock_(L),R=parseInt(R.gap||L.getAttribute("gap"),10),o.push(isNaN(R)?r:R),n.push({type:"block",block:h});break;case"SEP":this.addSeparatorGap_(h,o,r);break;case"LABEL":h=this.createButton_(h,!0),n.push({type:"button",button:h}),o.push(r);break;case"BUTTON":h=this.createButton_(h,!1),n.push({type:"button",button:h}),o.push(r)}return{contents:n,gaps:o}},e.Flyout.prototype.getDynamicCategoryContents_=function(t){if("function"!=typeof(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");if(t=t(this.workspace_.targetWorkspace),!Array.isArray(t))throw new TypeError("Result of toolbox category callback must be an array.");return t},e.Flyout.prototype.createButton_=function(t,n){if(!e.FlyoutButton)throw Error("Missing require for Blockly.FlyoutButton");return new e.FlyoutButton(this.workspace_,this.targetWorkspace,t,n)},e.Flyout.prototype.createBlock_=function(t){return(t=e.Xml.domToBlock(t,this.workspace_)).isEnabled()||this.permanentlyDisabled_.push(t),t},e.Flyout.prototype.getBlockXml_=function(t){var n=null,o=t.blockxml;if(o&&"string"!=typeof o?n=o:o&&"string"==typeof o?(n=e.Xml.textToDom(o),t.blockxml=n):t.type&&((n=e.utils.xml.createElement("xml")).setAttribute("type",t.type),n.setAttribute("disabled",t.disabled),t.blockxml=n),!n)throw Error("Error: Invalid block definition. Block definition must have blockxml or type.");return n},e.Flyout.prototype.addSeparatorGap_=function(t,n,o){t=parseInt(t.gap,10),!isNaN(t)&&0<n.length?n[n.length-1]=t:n.push(o)},e.Flyout.prototype.clearOldBlocks_=function(){for(var o,t=this.workspace_.getTopBlocks(!1),n=0;o=t[n];n++)o.workspace==this.workspace_&&o.dispose(!1,!1);for(n=0;n<this.mats_.length;n++)(t=this.mats_[n])&&(e.Tooltip.unbindMouseEvents(t),e.utils.dom.removeNode(t));for(n=this.mats_.length=0;t=this.buttons_[n];n++)t.dispose();this.buttons_.length=0,this.workspace_.getPotentialVariableMap().clear()},e.Flyout.prototype.addBlockListeners_=function(t,n,o){this.listeners_.push(e.browserEvents.conditionalBind(t,"mousedown",null,this.blockMouseDown_(n))),this.listeners_.push(e.browserEvents.conditionalBind(o,"mousedown",null,this.blockMouseDown_(n))),this.listeners_.push(e.browserEvents.bind(t,"mouseenter",n,n.addSelect)),this.listeners_.push(e.browserEvents.bind(t,"mouseleave",n,n.removeSelect)),this.listeners_.push(e.browserEvents.bind(o,"mouseenter",n,n.addSelect)),this.listeners_.push(e.browserEvents.bind(o,"mouseleave",n,n.removeSelect))},e.Flyout.prototype.blockMouseDown_=function(t){var n=this;return function(o){var r=n.targetWorkspace.getGesture(o);r&&(r.setStartBlock(t),r.handleFlyoutStart(o,n))}},e.Flyout.prototype.onMouseDown_=function(t){var n=this.targetWorkspace.getGesture(t);n&&n.handleFlyoutStart(t,this)},e.Flyout.prototype.isBlockCreatable_=function(t){return t.isEnabled()},e.Flyout.prototype.createBlock=function(t){var n=null;e.Events.disable();var o=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{n=this.placeNewBlock_(t)}finally{e.Events.enable()}if(e.hideChaff(),t=e.Variables.getAddedVariables(this.targetWorkspace,o),e.Events.isEnabled()){for(e.Events.setGroup(!0),o=0;o<t.length;o++){var r=t[o];e.Events.fire(new(e.Events.get(e.Events.VAR_CREATE))(r))}e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(n))}return this.autoClose?this.hide():this.filterForCapacity_(),n},e.Flyout.prototype.initFlyoutButton_=function(t,n,o){var r=t.createDom();t.moveTo(n,o),t.show(),this.listeners_.push(e.browserEvents.conditionalBind(r,"mousedown",this,this.onMouseDown_)),this.buttons_.push(t)},e.Flyout.prototype.createRect_=function(t,n,o,r,a){return(n=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{"fill-opacity":0,x:n,y:o,height:r.height,width:r.width},null)).tooltip=t,e.Tooltip.bindMouseEvents(n),this.workspace_.getCanvas().insertBefore(n,t.getSvgRoot()),t.flyoutRect_=n,this.mats_[a]=n},e.Flyout.prototype.moveRectToBlock_=function(t,n){var o=n.getHeightWidth();t.setAttribute("width",o.width),t.setAttribute("height",o.height),n=n.getRelativeToSurfaceXY(),t.setAttribute("y",n.y),t.setAttribute("x",this.RTL?n.x-o.width:n.x)},e.Flyout.prototype.filterForCapacity_=function(){for(var o,t=this.workspace_.getTopBlocks(!1),n=0;o=t[n];n++)if(-1==this.permanentlyDisabled_.indexOf(o))for(var r=this.targetWorkspace.isCapacityAvailable(e.utils.getBlockTypeCounts(o));o;)o.setEnabled(r),o=o.getNextBlock()},e.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},e.Flyout.prototype.isScrollable=function(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()},e.Flyout.prototype.placeNewBlock_=function(t){var n=this.targetWorkspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered.");var o=e.Xml.blockToDom(t,!0);if(n.setResizesEnabled(!1),!(o=e.Xml.domToBlock(o,n)).getSvgRoot())throw Error("block is not rendered.");var r=n.getOriginOffsetInPixels(),a=this.workspace_.getOriginOffsetInPixels();return(t=t.getRelativeToSurfaceXY()).scale(this.workspace_.scale),t=e.utils.Coordinate.sum(a,t),(r=e.utils.Coordinate.difference(t,r)).scale(1/n.scale),o.moveBy(r.x,r.y),o},e.HorizontalFlyout=function(t){e.HorizontalFlyout.superClass_.constructor.call(this,t),this.horizontalLayout=!0},e.utils.object.inherits(e.HorizontalFlyout,e.Flyout),e.HorizontalFlyout.prototype.setMetrics_=function(t){if(this.isVisible()){var n=this.workspace_.getMetricsManager(),o=n.getScrollMetrics(),r=n.getViewMetrics();n=n.getAbsoluteMetrics(),"number"==typeof t.x&&(this.workspace_.scrollX=-(o.left+(o.width-r.width)*t.x)),this.workspace_.translate(this.workspace_.scrollX+n.left,this.workspace_.scrollY+n.top)}},e.HorizontalFlyout.prototype.getX=function(){return 0},e.HorizontalFlyout.prototype.getY=function(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager(),n=t.getAbsoluteMetrics(),o=t.getViewMetrics();t=t.getToolboxMetrics();var r=this.toolboxPosition_==e.utils.toolbox.Position.TOP;return this.targetWorkspace.toolboxPosition==this.toolboxPosition_?this.targetWorkspace.getToolbox()?r?t.height:o.height-this.height_:r?0:o.height:r?0:o.height+n.top-this.height_},e.HorizontalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=t.width,this.setBackgroundPath_(t.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),t=this.getX();var n=this.getY();this.positionAt_(this.width_,this.height_,t,n)}},e.HorizontalFlyout.prototype.setBackgroundPath_=function(t,n){var o=this.toolboxPosition_==e.utils.toolbox.Position.TOP,r=["M 0,"+(o?0:this.CORNER_RADIUS)];o?(r.push("h",t+2*this.CORNER_RADIUS),r.push("v",n),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("h",-t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),r.push("h",t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("v",n),r.push("h",-t-2*this.CORNER_RADIUS)),r.push("z"),this.svgBackground_.setAttribute("d",r.join(" "))},e.HorizontalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setX(this.RTL?1/0:0)},e.HorizontalFlyout.prototype.wheel_=function(t){var n=e.utils.getScrollDeltaPixels(t);if(n=n.x||n.y){var o=this.workspace_.getMetricsManager(),r=o.getScrollMetrics();n=o.getViewMetrics().left-r.left+n,this.workspace_.scrollbar.setX(n),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()}t.preventDefault(),t.stopPropagation()},e.HorizontalFlyout.prototype.layout_=function(t,n){this.workspace_.scale=this.targetWorkspace.scale;var o=this.MARGIN,r=o+this.tabWidth_;this.RTL&&(t=t.reverse());for(var h,a=0;h=t[a];a++)if("block"==h.type){for(var W,R=(h=h.block).getDescendants(!1),L=0;W=R[L];L++)W.isInFlyout=!0;h.render(),R=h.getSvgRoot(),L=h.getHeightWidth(),W=h.outputConnection?this.tabWidth_:0,h.moveBy(W=this.RTL?r+L.width:r-W,o),W=this.createRect_(h,W,o,L,a),r+=L.width+n[a],this.addBlockListeners_(R,h,W)}else"button"==h.type&&(this.initFlyoutButton_(h.button,r,o),r+=h.button.width+n[a])},e.HorizontalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var n=this.dragAngleRange_;return t<90+n&&t>90-n||t>-90-n&&t<-90+n},e.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var t=this.svgGroup_.getBoundingClientRect(),n=t.top;return this.toolboxPosition_==e.utils.toolbox.Position.TOP?new e.utils.Rect(-1e9,n+t.height,-1e9,1e9):new e.utils.Rect(n,1e9,-1e9,1e9)},e.HorizontalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var r,t=0,n=this.workspace_.getTopBlocks(!1),o=0;r=n[o];o++)t=Math.max(t,r.getHeightWidth().height);if(t+=1.5*this.MARGIN,t*=this.workspace_.scale,this.height_!=(t+=e.Scrollbar.scrollbarThickness)){for(o=0;r=n[o];o++)r.flyoutRect_&&this.moveRectToBlock_(r.flyoutRect_,r);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=e.utils.toolbox.Position.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+t),this.height_=t,this.position(),this.targetWorkspace.recordDragTargets()}},e.registry.register(e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,e.registry.DEFAULT,e.HorizontalFlyout),e.VerticalFlyout=function(t){e.VerticalFlyout.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.VerticalFlyout,e.Flyout),e.VerticalFlyout.registryName="verticalFlyout",e.VerticalFlyout.prototype.setMetrics_=function(t){if(this.isVisible()){var n=this.workspace_.getMetricsManager(),o=n.getScrollMetrics(),r=n.getViewMetrics();n=n.getAbsoluteMetrics(),"number"==typeof t.y&&(this.workspace_.scrollY=-(o.top+(o.height-r.height)*t.y)),this.workspace_.translate(this.workspace_.scrollX+n.left,this.workspace_.scrollY+n.top)}},e.VerticalFlyout.prototype.getX=function(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager(),n=t.getAbsoluteMetrics(),o=t.getViewMetrics();return t=t.getToolboxMetrics(),this.targetWorkspace.toolboxPosition==this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_==e.utils.toolbox.Position.LEFT?t.width:o.width-this.width_:this.toolboxPosition_==e.utils.toolbox.Position.LEFT?0:o.width:this.toolboxPosition_==e.utils.toolbox.Position.LEFT?0:o.width+n.left-this.width_},e.VerticalFlyout.prototype.getY=function(){return 0},e.VerticalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=t.height,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,t.height-2*this.CORNER_RADIUS),t=this.getX();var n=this.getY();this.positionAt_(this.width_,this.height_,t,n)}},e.VerticalFlyout.prototype.setBackgroundPath_=function(t,n){var o=this.toolboxPosition_==e.utils.toolbox.Position.RIGHT,r=t+this.CORNER_RADIUS;(r=["M "+(o?r:0)+",0"]).push("h",o?-t:t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("v",Math.max(0,n)),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("h",o?t:-t),r.push("z"),this.svgBackground_.setAttribute("d",r.join(" "))},e.VerticalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setY(0)},e.VerticalFlyout.prototype.wheel_=function(t){var n=e.utils.getScrollDeltaPixels(t);if(n.y){var o=this.workspace_.getMetricsManager(),r=o.getScrollMetrics();n=o.getViewMetrics().top-r.top+n.y,this.workspace_.scrollbar.setY(n),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()}t.preventDefault(),t.stopPropagation()},e.VerticalFlyout.prototype.layout_=function(t,n){this.workspace_.scale=this.targetWorkspace.scale;for(var h,o=this.MARGIN,r=this.RTL?o:o+this.tabWidth_,a=0;h=t[a];a++)if("block"==h.type){for(var W,R=(h=h.block).getDescendants(!1),L=0;W=R[L];L++)W.isInFlyout=!0;h.render(),R=h.getSvgRoot(),L=h.getHeightWidth(),h.moveBy(W=h.outputConnection?r-this.tabWidth_:r,o),W=this.createRect_(h,this.RTL?W-L.width:W,o,L,a),this.addBlockListeners_(R,h,W),o+=L.height+n[a]}else"button"==h.type&&(this.initFlyoutButton_(h.button,r,o),o+=h.button.height+n[a])},e.VerticalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var n=this.dragAngleRange_;return t<n&&t>-n||t<-180+n||t>180-n},e.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var t=this.svgGroup_.getBoundingClientRect(),n=t.left;return this.toolboxPosition_==e.utils.toolbox.Position.LEFT?new e.utils.Rect(-1e9,1e9,-1e9,n+t.width):new e.utils.Rect(-1e9,1e9,n,1e9)},e.VerticalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var r,t=0,n=this.workspace_.getTopBlocks(!1),o=0;r=n[o];o++){var a=r.getHeightWidth().width;r.outputConnection&&(a-=this.tabWidth_),t=Math.max(t,a)}for(o=0;r=this.buttons_[o];o++)t=Math.max(t,r.width);if(t+=1.5*this.MARGIN+this.tabWidth_,t*=this.workspace_.scale,this.width_!=(t+=e.Scrollbar.scrollbarThickness)){for(o=0;r=n[o];o++){if(this.RTL){a=r.getRelativeToSurfaceXY().x;var h=t/this.workspace_.scale-this.MARGIN;r.outputConnection||(h-=this.tabWidth_),r.moveBy(h-a,0)}r.flyoutRect_&&this.moveRectToBlock_(r.flyoutRect_,r)}if(this.RTL)for(o=0;r=this.buttons_[o];o++)n=r.getPosition().y,r.moveTo(t/this.workspace_.scale-r.width-this.MARGIN-this.tabWidth_,n);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=e.utils.toolbox.Position.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+t,this.targetWorkspace.scrollY),this.width_=t,this.position(),this.targetWorkspace.recordDragTargets()}},e.registry.register(e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,e.registry.DEFAULT,e.VerticalFlyout),e.FlyoutButton=function(t,n,o,r){this.workspace_=t,this.targetWorkspace_=n,this.text_=o.text,this.position_=new e.utils.Coordinate(0,0),this.isLabel_=r,this.callbackKey_=o.callbackKey||o.callbackkey,this.cssClass_=o["web-class"]||null,this.onMouseUpWrapper_=null,this.info=o},e.FlyoutButton.MARGIN_X=5,e.FlyoutButton.MARGIN_Y=2,e.FlyoutButton.prototype.width=0,e.FlyoutButton.prototype.height=0,e.FlyoutButton.prototype.createDom=function(){var t=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";if(this.cssClass_&&(t+=" "+this.cssClass_),this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:t},this.workspace_.getCanvas()),!this.isLabel_)var n=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_);t=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var o=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_),r=e.utils.replaceMessageReferences(this.text_);this.workspace_.RTL&&(r+="\u200f"),o.textContent=r,this.isLabel_&&(this.svgText_=o,this.workspace_.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));var a=e.utils.style.getComputedStyle(o,"fontSize"),h=e.utils.style.getComputedStyle(o,"fontWeight"),R=e.utils.style.getComputedStyle(o,"fontFamily");return this.width=e.utils.dom.getFastTextWidthWithSizeString(o,a,h,R),r=e.utils.dom.measureFontMetrics(r,a,h,R),this.height=r.height,this.isLabel_||(this.width+=2*e.FlyoutButton.MARGIN_X,this.height+=2*e.FlyoutButton.MARGIN_Y,n.setAttribute("width",this.width),n.setAttribute("height",this.height)),t.setAttribute("width",this.width),t.setAttribute("height",this.height),o.setAttribute("x",this.width/2),o.setAttribute("y",this.height/2-r.height/2+r.baseline),this.updateTransform_(),this.onMouseUpWrapper_=e.browserEvents.conditionalBind(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},e.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},e.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},e.FlyoutButton.prototype.moveTo=function(t,n){this.position_.x=t,this.position_.y=n,this.updateTransform_()},e.FlyoutButton.prototype.isLabel=function(){return this.isLabel_},e.FlyoutButton.prototype.getPosition=function(){return this.position_},e.FlyoutButton.prototype.getButtonText=function(){return this.text_},e.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},e.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&e.browserEvents.unbind(this.onMouseUpWrapper_),this.svgGroup_&&e.utils.dom.removeNode(this.svgGroup_),this.svgText_&&this.workspace_.getThemeManager().unsubscribe(this.svgText_)},e.FlyoutButton.prototype.onMouseUp_=function(t){(t=this.targetWorkspace_.getGesture(t))&&t.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace_.getButtonCallback(this.callbackKey_)?this.isLabel_||this.targetWorkspace_.getButtonCallback(this.callbackKey_)(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)},e.Css.register(".blocklyFlyoutButton {,fill: #888;,cursor: default;,},.blocklyFlyoutButtonShadow {,fill: #666;,},.blocklyFlyoutButton:hover {,fill: #aaa;,},.blocklyFlyoutLabel {,cursor: default;,},.blocklyFlyoutLabelBackground {,opacity: 0;,}".split(",")),e.Generator=function(t){this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")},e.Generator.prototype.INFINITE_LOOP_TRAP=null,e.Generator.prototype.STATEMENT_PREFIX=null,e.Generator.prototype.STATEMENT_SUFFIX=null,e.Generator.prototype.INDENT="  ",e.Generator.prototype.COMMENT_WRAP=60,e.Generator.prototype.ORDER_OVERRIDES=[],e.Generator.prototype.isInitialized=null,e.Generator.prototype.workspaceToCode=function(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=e.getMainWorkspace());var n=[];this.init(t),t=t.getTopBlocks(!0);for(var r,o=0;r=t[o];o++){var a=this.blockToCode(r);Array.isArray(a)&&(a=a[0]),a&&(r.outputConnection&&(a=this.scrubNakedValue(a),this.STATEMENT_PREFIX&&!r.suppressPrefixSuffix&&(a=this.injectId(this.STATEMENT_PREFIX,r)+a),this.STATEMENT_SUFFIX&&!r.suppressPrefixSuffix&&(a+=this.injectId(this.STATEMENT_SUFFIX,r))),n.push(a))}return n=n.join("\n"),(n=(n=(n=this.finish(n)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")},e.Generator.prototype.prefixLines=function(t,n){return n+t.replace(/(?!\n$)\n/g,"\n"+n)},e.Generator.prototype.allNestedComments=function(t){var n=[];t=t.getDescendants(!0);for(var o=0;o<t.length;o++){var r=t[o].getCommentText();r&&n.push(r)}return n.length&&n.push(""),n.join("\n")},e.Generator.prototype.blockToCode=function(t,n){if(!1===this.isInitialized&&console.warn("Generator init was not called before blockToCode was called."),!t)return"";if(!t.isEnabled())return n?"":this.blockToCode(t.getNextBlock());if(t.isInsertionMarker())return n?"":this.blockToCode(t.getChildren(!1)[0]);var o=this[t.type];if("function"!=typeof o)throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+t.type+'".');if(o=o.call(t,t),Array.isArray(o)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,o[0],n),o[1]]}if("string"==typeof o)return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(o=this.injectId(this.STATEMENT_PREFIX,t)+o),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(o+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,o,n);if(null===o)return"";throw SyntaxError("Invalid code generated: "+o)},e.Generator.prototype.valueToCode=function(t,n,o){if(isNaN(o))throw TypeError("Expecting valid order from block: "+t.type);var r=t.getInputTargetBlock(n);if(!r||""===(n=this.blockToCode(r)))return"";if(!Array.isArray(n))throw TypeError("Expecting tuple from value block: "+r.type);if(t=n[0],n=n[1],isNaN(n))throw TypeError("Expecting valid order from value block: "+r.type);if(!t)return"";r=!1;var a=Math.floor(o),h=Math.floor(n);if(a<=h&&(a!=h||0!=a&&99!=a))for(r=!0,a=0;a<this.ORDER_OVERRIDES.length;a++)if(this.ORDER_OVERRIDES[a][0]==o&&this.ORDER_OVERRIDES[a][1]==n){r=!1;break}return r&&(t="("+t+")"),t},e.Generator.prototype.statementToCode=function(t,n){if(t=t.getInputTargetBlock(n),"string"!=typeof(n=this.blockToCode(t)))throw TypeError("Expecting code from statement block: "+(t&&t.type));return n&&(n=this.prefixLines(n,this.INDENT)),n},e.Generator.prototype.addLoopTrap=function(t,n){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,n),this.INDENT)+t),this.STATEMENT_SUFFIX&&!n.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,n),this.INDENT)+t),this.STATEMENT_PREFIX&&!n.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,n),this.INDENT)),t},e.Generator.prototype.injectId=function(t,n){return n=n.id.replace(/\$/g,"$$$$"),t.replace(/%1/g,"'"+n+"'")},e.Generator.prototype.RESERVED_WORDS_="",e.Generator.prototype.addReservedWords=function(t){this.RESERVED_WORDS_+=t+","},e.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",Object.defineProperty(e.Generator.prototype,"variableDB_",{get:function(){return e.utils.deprecation.warn("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_},set:function(t){e.utils.deprecation.warn("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_=t}}),e.Generator.prototype.provideFunction_=function(t,n){if(!this.definitions_[t]){var r,o=this.nameDB_.getDistinctName(t,e.PROCEDURE_CATEGORY_NAME);for(this.functionNames_[t]=o,n=n.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,o);r!=n;)r=n,n=n.replace(/^(( {2})*) {2}/gm,"$1\0");n=n.replace(/\0/g,this.INDENT),this.definitions_[t]=n}return this.functionNames_[t]},e.Generator.prototype.init=function(t){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)},e.Generator.prototype.scrub_=function(t,n,o){return n},e.Generator.prototype.finish=function(t){return delete this.definitions_,delete this.functionNames_,t},e.Generator.prototype.scrubNakedValue=function(t){return t},e.IToolboxItem=function(){},e.ISelectableToolboxItem=function(){},e.ICollapsibleToolboxItem=function(){},e.ToolboxItem=function(t,n,o){this.id_=t.toolboxitemid||e.utils.IdGenerator.getNextUniqueId(),this.level_=(this.parent_=o||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=t,this.parentToolbox_=n,this.workspace_=this.parentToolbox_.getWorkspace()},e.ToolboxItem.prototype.init=function(){},e.ToolboxItem.prototype.getDiv=function(){return null},e.ToolboxItem.prototype.getId=function(){return this.id_},e.ToolboxItem.prototype.getParent=function(){return null},e.ToolboxItem.prototype.getLevel=function(){return this.level_},e.ToolboxItem.prototype.isSelectable=function(){return!1},e.ToolboxItem.prototype.isCollapsible=function(){return!1},e.ToolboxItem.prototype.dispose=function(){},e.ToolboxCategory=function(t,n,o){e.ToolboxCategory.superClass_.constructor.call(this,t,n,o),this.name_=e.utils.replaceMessageReferences(t.name),this.colour_=this.getColour_(t),this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.cssConfig_=this.makeDefaultCssConfig_(),e.utils.object.mixin(this.cssConfig_,t.cssconfig||t.cssConfig),this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.parseContents_(t)},e.utils.object.inherits(e.ToolboxCategory,e.ToolboxItem),e.ToolboxCategory.registrationName="category",e.ToolboxCategory.nestedPadding=19,e.ToolboxCategory.borderWidth=8,e.ToolboxCategory.defaultBackgroundColour="#57e",e.ToolboxCategory.prototype.makeDefaultCssConfig_=function(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}},e.ToolboxCategory.prototype.parseContents_=function(t){var n=t.contents;if(t.custom)this.flyoutItems_=t.custom;else if(n){t=0;for(var o;o=n[t];t++)this.flyoutItems_.push(o)}},e.ToolboxCategory.prototype.init=function(){this.createDom_(),"true"==this.toolboxItemDef_.hidden&&this.hide()},e.ToolboxCategory.prototype.createDom_=function(){return this.htmlDiv_=this.createContainer_(),e.utils.aria.setRole(this.htmlDiv_,e.utils.aria.Role.TREEITEM),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.SELECTED,!1),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),e.utils.aria.setRole(this.iconDom_,e.utils.aria.Role.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.LABELLEDBY,this.labelDom_.getAttribute("id")),this.addColourBorder_(this.colour_),this.htmlDiv_},e.ToolboxCategory.prototype.createContainer_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,this.cssConfig_.container),t},e.ToolboxCategory.prototype.createRowContainer_=function(){var t=document.createElement("div");e.utils.dom.addClass(t,this.cssConfig_.row);var n=e.ToolboxCategory.nestedPadding*this.getLevel();return n=n.toString()+"px",this.workspace_.RTL?t.style.paddingRight=n:t.style.paddingLeft=n,t},e.ToolboxCategory.prototype.createRowContentsContainer_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,this.cssConfig_.rowcontentcontainer),t},e.ToolboxCategory.prototype.createIconDom_=function(){var t=document.createElement("span");return this.parentToolbox_.isHorizontal()||e.utils.dom.addClass(t,this.cssConfig_.icon),t.style.display="inline-block",t},e.ToolboxCategory.prototype.createLabelDom_=function(t){var n=document.createElement("span");return n.setAttribute("id",this.getId()+".label"),n.textContent=t,e.utils.dom.addClass(n,this.cssConfig_.label),n},e.ToolboxCategory.prototype.refreshTheme=function(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)},e.ToolboxCategory.prototype.addColourBorder_=function(t){t&&(t=e.ToolboxCategory.borderWidth+"px solid "+(t||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=t:this.rowDiv_.style.borderLeft=t)},e.ToolboxCategory.prototype.getColour_=function(t){var n=t.categorystyle||t.categoryStyle;return(t=t.colour)&&n?(console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour'),""):n?this.getColourfromStyle_(n):this.parseColour_(t)},e.ToolboxCategory.prototype.getColourfromStyle_=function(t){var n=this.workspace_.getTheme();if(t&&n){if((n=n.categoryStyles[t])&&n.colour)return this.parseColour_(n.colour);console.warn('Style "'+t+'" must exist and contain a colour value')}return""},e.ToolboxCategory.prototype.getClickTarget=function(){return this.rowDiv_},e.ToolboxCategory.prototype.parseColour_=function(t){if(null==(t=e.utils.replaceMessageReferences(t))||""===t)return"";var n=Number(t);return isNaN(n)?(n=e.utils.colour.parse(t))?n:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+t),""):e.hueToHex(n)},e.ToolboxCategory.prototype.openIcon_=function(t){t&&(e.utils.dom.removeClasses(t,this.cssConfig_.closedicon),e.utils.dom.addClass(t,this.cssConfig_.openicon))},e.ToolboxCategory.prototype.closeIcon_=function(t){t&&(e.utils.dom.removeClasses(t,this.cssConfig_.openicon),e.utils.dom.addClass(t,this.cssConfig_.closedicon))},e.ToolboxCategory.prototype.setVisible_=function(t){this.htmlDiv_.style.display=t?"block":"none",this.isHidden_=!t,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},e.ToolboxCategory.prototype.hide=function(){this.setVisible_(!1)},e.ToolboxCategory.prototype.show=function(){this.setVisible_(!0)},e.ToolboxCategory.prototype.isVisible=function(){return!this.isHidden_&&this.allAncestorsExpanded_()},e.ToolboxCategory.prototype.allAncestorsExpanded_=function(){for(var t=this;t.getParent();)if(!(t=t.getParent()).isExpanded())return!1;return!0},e.ToolboxCategory.prototype.isSelectable=function(){return this.isVisible()&&!this.isDisabled_},e.ToolboxCategory.prototype.onClick=function(t){},e.ToolboxCategory.prototype.setSelected=function(t){if(t){var n=this.parseColour_(e.ToolboxCategory.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||n,e.utils.dom.addClass(this.rowDiv_,this.cssConfig_.selected)}else this.rowDiv_.style.backgroundColor="",e.utils.dom.removeClass(this.rowDiv_,this.cssConfig_.selected);e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.SELECTED,t)},e.ToolboxCategory.prototype.setDisabled=function(t){this.isDisabled_=t,this.getDiv().setAttribute("disabled",t),t?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")},e.ToolboxCategory.prototype.getName=function(){return this.name_},e.ToolboxCategory.prototype.getParent=function(){return this.parent_},e.ToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},e.ToolboxCategory.prototype.getContents=function(){return this.flyoutItems_},e.ToolboxCategory.prototype.updateFlyoutContents=function(t){this.flyoutItems_=[],"string"==typeof t?this.toolboxItemDef_.custom=t:(delete this.toolboxItemDef_.custom,this.toolboxItemDef_.contents=e.utils.toolbox.convertFlyoutDefToJsonArray(t)),this.parseContents_(this.toolboxItemDef_)},e.ToolboxCategory.prototype.dispose=function(){e.utils.dom.removeNode(this.htmlDiv_)},e.Css.register([".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: rgba(255, 255, 255, 0.2);","}",'.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {',"margin: 1px 5px 1px 0;","}",'.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {',"margin: 1px 0 1px 5px;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","padding-right: 0px","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","visibility: hidden;","width: 16px;","}",".blocklyTreeIconClosed {","background-position: -32px -1px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {',"background-position: 0 -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosed {","background-position: -32px -17px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {',"background-position: 0 -17px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeLabel {","cursor: default;","font: 16px sans-serif;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}"]),e.registry.register(e.registry.Type.TOOLBOX_ITEM,e.ToolboxCategory.registrationName,e.ToolboxCategory),e.ToolboxSeparator=function(t,n){e.ToolboxSeparator.superClass_.constructor.call(this,t,n),this.cssConfig_={container:"blocklyTreeSeparator"},e.utils.object.mixin(this.cssConfig_,t.cssconfig||t.cssConfig)},e.utils.object.inherits(e.ToolboxSeparator,e.ToolboxItem),e.ToolboxSeparator.registrationName="sep",e.ToolboxSeparator.prototype.init=function(){this.createDom_()},e.ToolboxSeparator.prototype.createDom_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,this.cssConfig_.container),this.htmlDiv_=t},e.ToolboxSeparator.prototype.getDiv=function(){return this.htmlDiv_},e.ToolboxSeparator.prototype.dispose=function(){e.utils.dom.removeNode(this.htmlDiv_)},e.Css.register('.blocklyTreeSeparator {,border-bottom: solid #e5e5e5 1px;,height: 0;,margin: 5px 0;,},.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {,border-right: solid #e5e5e5 1px;,border-bottom: none;,height: auto;,margin: 0 5px 0 5px;,padding: 5px 0;,width: 0;,}'.split(",")),e.registry.register(e.registry.Type.TOOLBOX_ITEM,e.ToolboxSeparator.registrationName,e.ToolboxSeparator),e.CollapsibleToolboxCategory=function(t,n,o){this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[],e.CollapsibleToolboxCategory.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.CollapsibleToolboxCategory,e.ToolboxCategory),e.CollapsibleToolboxCategory.registrationName="collapsibleCategory",e.CollapsibleToolboxCategory.prototype.makeDefaultCssConfig_=function(){var t=e.CollapsibleToolboxCategory.superClass_.makeDefaultCssConfig_.call(this);return t.contents="blocklyToolboxContents",t},e.CollapsibleToolboxCategory.prototype.parseContents_=function(t){var n=t.contents,o=!0;if(t.custom)this.flyoutItems_=t.custom;else if(n){t=0;for(var r;r=n[t];t++)!e.registry.hasItem(e.registry.Type.TOOLBOX_ITEM,r.kind)||r.kind.toLowerCase()==e.ToolboxSeparator.registrationName&&o?(this.flyoutItems_.push(r),o=!0):(this.createToolboxItem_(r),o=!1)}},e.CollapsibleToolboxCategory.prototype.createToolboxItem_=function(t){var n=t.kind;"CATEGORY"==n.toUpperCase()&&e.utils.toolbox.isCategoryCollapsible(t)&&(n=e.CollapsibleToolboxCategory.registrationName),t=new(e.registry.getClass(e.registry.Type.TOOLBOX_ITEM,n))(t,this.parentToolbox_,this),this.toolboxItems_.push(t)},e.CollapsibleToolboxCategory.prototype.init=function(){e.CollapsibleToolboxCategory.superClass_.init.call(this),this.setExpanded("true"==this.toolboxItemDef_.expanded||this.toolboxItemDef_.expanded)},e.CollapsibleToolboxCategory.prototype.createDom_=function(){e.CollapsibleToolboxCategory.superClass_.createDom_.call(this);var t=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(t),e.utils.aria.setRole(this.subcategoriesDiv_,e.utils.aria.Role.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_},e.CollapsibleToolboxCategory.prototype.createIconDom_=function(){var t=document.createElement("span");return this.parentToolbox_.isHorizontal()||(e.utils.dom.addClass(t,this.cssConfig_.icon),t.style.visibility="visible"),t.style.display="inline-block",t},e.CollapsibleToolboxCategory.prototype.createSubCategoriesDom_=function(t){var n=document.createElement("div");e.utils.dom.addClass(n,this.cssConfig_.contents);for(var o=0;o<t.length;o++){var r=t[o];r.init();var a=r.getDiv();n.appendChild(a),r.getClickTarget&&r.getClickTarget().setAttribute("id",r.getId())}return n},e.CollapsibleToolboxCategory.prototype.setExpanded=function(t){this.expanded_!=t&&((this.expanded_=t)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.EXPANDED,t),this.parentToolbox_.handleToolboxItemResize())},e.CollapsibleToolboxCategory.prototype.setVisible_=function(t){this.htmlDiv_.style.display=t?"block":"none";for(var o,n=0;o=this.getChildToolboxItems()[n];n++)o.setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},e.CollapsibleToolboxCategory.prototype.isExpanded=function(){return this.expanded_},e.CollapsibleToolboxCategory.prototype.isCollapsible=function(){return!0},e.CollapsibleToolboxCategory.prototype.onClick=function(t){this.toggleExpanded()},e.CollapsibleToolboxCategory.prototype.toggleExpanded=function(){this.setExpanded(!this.expanded_)},e.CollapsibleToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},e.CollapsibleToolboxCategory.prototype.getChildToolboxItems=function(){return this.toolboxItems_},e.registry.register(e.registry.Type.TOOLBOX_ITEM,e.CollapsibleToolboxCategory.registrationName,e.CollapsibleToolboxCategory),e.Events.ToolboxItemSelect=function(t,n,o){e.Events.ToolboxItemSelect.superClass_.constructor.call(this,o),this.oldItem=t,this.newItem=n},e.utils.object.inherits(e.Events.ToolboxItemSelect,e.Events.UiBase),e.Events.ToolboxItemSelect.prototype.type=e.Events.TOOLBOX_ITEM_SELECT,e.Events.ToolboxItemSelect.prototype.toJson=function(){var t=e.Events.ToolboxItemSelect.superClass_.toJson.call(this);return t.oldItem=this.oldItem,t.newItem=this.newItem,t},e.Events.ToolboxItemSelect.prototype.fromJson=function(t){e.Events.ToolboxItemSelect.superClass_.fromJson.call(this,t),this.oldItem=t.oldItem,this.newItem=t.newItem},e.registry.register(e.registry.Type.EVENT,e.Events.TOOLBOX_ITEM_SELECT,e.Events.ToolboxItemSelect),e.IAutoHideable=function(){},e.IStyleable=function(){},e.IToolbox=function(){},e.Toolbox=function(t){e.Toolbox.superClass_.constructor.call(this),this.workspace_=t,this.id="toolbox",this.toolboxDef_=t.options.languageTree||{contents:[]},this.horizontalLayout_=t.options.horizontalLayout,this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.RTL=t.options.RTL,this.flyout_=null,this.contentMap_=Object.create(null),this.toolboxPosition=t.options.toolboxPosition,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[]},e.utils.object.inherits(e.Toolbox,e.DeleteArea),e.Toolbox.prototype.onShortcut=function(t){return!1},e.Toolbox.prototype.init=function(){var t=this.workspace_,n=t.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),e.utils.dom.insertAfter(this.flyout_.createDom("svg"),n),this.setVisible(!0),this.flyout_.init(t),this.render(this.toolboxDef_),(t=t.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),t.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[e.ComponentManager.Capability.AUTOHIDEABLE,e.ComponentManager.Capability.DELETE_AREA,e.ComponentManager.Capability.DRAG_TARGET]})},e.Toolbox.prototype.createDom_=function(t){t=t.getParentSvg();var n=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,e.utils.aria.setRole(this.contentsDiv_,e.utils.aria.Role.TREE),n.appendChild(this.contentsDiv_),t.parentNode.insertBefore(n,t),this.attachEvents_(n,this.contentsDiv_),n},e.Toolbox.prototype.createContainer_=function(){var t=document.createElement("div");return t.setAttribute("layout",this.isHorizontal()?"h":"v"),e.utils.dom.addClass(t,"blocklyToolboxDiv"),e.utils.dom.addClass(t,"blocklyNonSelectable"),t.setAttribute("dir",this.RTL?"RTL":"LTR"),t},e.Toolbox.prototype.createContentsContainer_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,"blocklyToolboxContents"),this.isHorizontal()&&(t.style.flexDirection="row"),t},e.Toolbox.prototype.attachEvents_=function(t,n){t=e.browserEvents.conditionalBind(t,"click",this,this.onClick_,!1,!0),this.boundEvents_.push(t),n=e.browserEvents.conditionalBind(n,"keydown",this,this.onKeyDown_,!1,!0),this.boundEvents_.push(n)},e.Toolbox.prototype.onClick_=function(t){if(e.utils.isRightButton(t)||t.target==this.HtmlDiv)e.hideChaff(!1);else{var n=t.target.getAttribute("id");n&&(n=this.getToolboxItemById(n)).isSelectable()&&(this.setSelectedItem(n),n.onClick(t)),e.hideChaff(!0)}e.Touch.clearTouchIdentifier()},e.Toolbox.prototype.onKeyDown_=function(t){var n=!1;switch(t.keyCode){case e.utils.KeyCodes.DOWN:n=this.selectNext_();break;case e.utils.KeyCodes.UP:n=this.selectPrevious_();break;case e.utils.KeyCodes.LEFT:n=this.selectParent_();break;case e.utils.KeyCodes.RIGHT:n=this.selectChild_();break;case e.utils.KeyCodes.ENTER:case e.utils.KeyCodes.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),n=!0);break;default:n=!1}!n&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(n=this.selectedItem_.onKeyDown(t)),n&&t.preventDefault()},e.Toolbox.prototype.createFlyout_=function(){var t=this.workspace_,n=new e.Options({parentWorkspace:t,rtl:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,renderer:t.options.renderer,rendererOverrides:t.options.rendererOverrides,move:{scrollbars:!0}});return n.toolboxPosition=t.options.toolboxPosition,new(e.registry.getClassFromOptions(t.horizontalLayout?e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX:e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,t.options,!0))(n)},e.Toolbox.prototype.render=function(t){this.toolboxDef_=t;for(var n=0;n<this.contents_.length;n++){var o=this.contents_[n];o&&o.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(t.contents),this.position(),this.handleToolboxItemResize()},e.Toolbox.prototype.renderContents_=function(t){for(var r,n=document.createDocumentFragment(),o=0;r=t[o];o++)this.createToolboxItem_(r,n);this.contentsDiv_.appendChild(n)},e.Toolbox.prototype.createToolboxItem_=function(t,n){var o=t.kind;"CATEGORY"==o.toUpperCase()&&e.utils.toolbox.isCategoryCollapsible(t)&&(o=e.CollapsibleToolboxCategory.registrationName),(o=e.registry.getClass(e.registry.Type.TOOLBOX_ITEM,o.toLowerCase()))&&(t=new o(t,this),this.addToolboxItem_(t),t.init(),(o=t.getDiv())&&n.appendChild(o),t.getClickTarget&&t.getClickTarget().setAttribute("id",t.getId()))},e.Toolbox.prototype.addToolboxItem_=function(t){if(this.contents_.push(t),this.contentMap_[t.getId()]=t,t.isCollapsible())for(var o,n=0;o=t.getChildToolboxItems()[n];n++)this.addToolboxItem_(o)},e.Toolbox.prototype.getToolboxItems=function(){return this.contents_},e.Toolbox.prototype.addStyle=function(t){e.utils.dom.addClass(this.HtmlDiv,t)},e.Toolbox.prototype.removeStyle=function(t){e.utils.dom.removeClass(this.HtmlDiv,t)},e.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv||!this.isVisible_)return null;var t=this.HtmlDiv.getBoundingClientRect(),n=t.top,o=n+t.height,r=t.left;return t=r+t.width,this.toolboxPosition==e.utils.toolbox.Position.TOP?new e.utils.Rect(-1e7,o,-1e7,1e7):this.toolboxPosition==e.utils.toolbox.Position.BOTTOM?new e.utils.Rect(n,1e7,-1e7,1e7):this.toolboxPosition==e.utils.toolbox.Position.LEFT?new e.utils.Rect(-1e7,1e7,-1e7,t):new e.utils.Rect(-1e7,1e7,r,1e7)},e.Toolbox.prototype.wouldDelete=function(t,n){return this.updateWouldDelete_(t instanceof e.BlockSvg?!t.getParent()&&t.isDeletable():t.isDeletable()),this.wouldDelete_},e.Toolbox.prototype.onDragEnter=function(t){this.updateCursorDeleteStyle_(!0)},e.Toolbox.prototype.onDragExit=function(t){this.updateCursorDeleteStyle_(!1)},e.Toolbox.prototype.onDrop=function(t){this.updateCursorDeleteStyle_(!1)},e.Toolbox.prototype.updateWouldDelete_=function(t){t!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=t,this.updateCursorDeleteStyle_(!0))},e.Toolbox.prototype.updateCursorDeleteStyle_=function(t){var n=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";t?this.addStyle(n):this.removeStyle(n)},e.Toolbox.prototype.getToolboxItemById=function(t){return this.contentMap_[t]||null},e.Toolbox.prototype.getWidth=function(){return this.width_},e.Toolbox.prototype.getHeight=function(){return this.height_},e.Toolbox.prototype.getFlyout=function(){return this.flyout_},e.Toolbox.prototype.getWorkspace=function(){return this.workspace_},e.Toolbox.prototype.getSelectedItem=function(){return this.selectedItem_},e.Toolbox.prototype.getPreviouslySelectedItem=function(){return this.previouslySelectedItem_},e.Toolbox.prototype.isHorizontal=function(){return this.horizontalLayout_},e.Toolbox.prototype.position=function(){var t=this.workspace_.getMetrics(),n=this.HtmlDiv;n&&(this.horizontalLayout_?(n.style.left="0",n.style.height="auto",n.style.width="100%",this.height_=n.offsetHeight,this.width_=t.viewWidth,this.toolboxPosition==e.utils.toolbox.Position.TOP?n.style.top="0":n.style.bottom="0"):(this.toolboxPosition==e.utils.toolbox.Position.RIGHT?n.style.right="0":n.style.left="0",n.style.height="100%",this.width_=n.offsetWidth,this.height_=t.viewHeight),this.flyout_.position())},e.Toolbox.prototype.handleToolboxItemResize=function(){var t=this.workspace_,n=this.HtmlDiv.getBoundingClientRect();t.translate(this.toolboxPosition==e.utils.toolbox.Position.LEFT?t.scrollX+n.width:t.scrollX,this.toolboxPosition==e.utils.toolbox.Position.TOP?t.scrollY+n.height:t.scrollY),e.svgResize(t)},e.Toolbox.prototype.clearSelection=function(){this.setSelectedItem(null)},e.Toolbox.prototype.refreshTheme=function(){for(var t=0;t<this.contents_.length;t++){var n=this.contents_[t];n.refreshTheme&&n.refreshTheme()}},e.Toolbox.prototype.refreshSelection=function(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())},e.Toolbox.prototype.setVisible=function(t){this.isVisible_!==t&&(this.HtmlDiv.style.display=t?"block":"none",this.isVisible_=t,this.workspace_.recordDragTargets())},e.Toolbox.prototype.autoHide=function(t){!t&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()},e.Toolbox.prototype.setSelectedItem=function(t){var n=this.selectedItem_;!t&&!n||t&&!t.isSelectable()||(this.shouldDeselectItem_(n,t)&&null!=n&&this.deselectItem_(n),this.shouldSelectItem_(n,t)&&null!=t&&this.selectItem_(n,t),this.updateFlyout_(n,t),this.fireSelectEvent_(n,t))},e.Toolbox.prototype.shouldDeselectItem_=function(t,n){return null!=t&&(!t.isCollapsible()||t!=n)},e.Toolbox.prototype.shouldSelectItem_=function(t,n){return null!=n&&n!=t},e.Toolbox.prototype.deselectItem_=function(t){this.selectedItem_=null,this.previouslySelectedItem_=t,t.setSelected(!1),e.utils.aria.setState(this.contentsDiv_,e.utils.aria.State.ACTIVEDESCENDANT,"")},e.Toolbox.prototype.selectItem_=function(t,n){this.selectedItem_=n,this.previouslySelectedItem_=t,n.setSelected(!0),e.utils.aria.setState(this.contentsDiv_,e.utils.aria.State.ACTIVEDESCENDANT,n.getId())},e.Toolbox.prototype.selectItemByPosition=function(t){-1<t&&t<this.contents_.length&&(t=this.contents_[t]).isSelectable()&&this.setSelectedItem(t)},e.Toolbox.prototype.updateFlyout_=function(t,n){(t!=n||n.isCollapsible())&&n&&n.getContents().length?(this.flyout_.show(n.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()},e.Toolbox.prototype.fireSelectEvent_=function(t,n){var o=t&&t.getName(),r=n&&n.getName();t==n&&(r=null),t=new(e.Events.get(e.Events.TOOLBOX_ITEM_SELECT))(o,r,this.workspace_.id),e.Events.fire(t)},e.Toolbox.prototype.selectParent_=function(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.setExpanded(!1),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))},e.Toolbox.prototype.selectChild_=function(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;var t=this.selectedItem_;return t.isExpanded()?this.selectNext_():t.setExpanded(!0),!0},e.Toolbox.prototype.selectNext_=function(){if(!this.selectedItem_)return!1;var t=this.contents_.indexOf(this.selectedItem_)+1;if(-1<t&&t<this.contents_.length){for(var n=this.contents_[t];n&&!n.isSelectable();)n=this.contents_[++t];if(n&&n.isSelectable())return this.setSelectedItem(n),!0}return!1},e.Toolbox.prototype.selectPrevious_=function(){if(!this.selectedItem_)return!1;var t=this.contents_.indexOf(this.selectedItem_)-1;if(-1<t&&t<this.contents_.length){for(var n=this.contents_[t];n&&!n.isSelectable();)n=this.contents_[--t];if(n&&n.isSelectable())return this.setSelectedItem(n),!0}return!1},e.Toolbox.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var t=0;t<this.contents_.length;t++)this.contents_[t].dispose();for(t=0;t<this.boundEvents_.length;t++)e.browserEvents.unbind(this.boundEvents_[t]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),e.utils.dom.removeNode(this.HtmlDiv)},e.Css.register([".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyToolboxDiv {","background-color: #ddd;","overflow-x: visible;","overflow-y: auto;","padding: 4px 0 4px 0;","position: absolute;","z-index: 70;","-webkit-tap-highlight-color: transparent;","}",".blocklyToolboxContents {","display: flex;","flex-wrap: wrap;","flex-direction: column;","}",".blocklyToolboxContents:focus {","outline: none;","}"]),e.registry.register(e.registry.Type.TOOLBOX,e.registry.DEFAULT,e.Toolbox),e.Events.TrashcanOpen=function(t,n){e.Events.TrashcanOpen.superClass_.constructor.call(this,n),this.isOpen=t},e.utils.object.inherits(e.Events.TrashcanOpen,e.Events.UiBase),e.Events.TrashcanOpen.prototype.type=e.Events.TRASHCAN_OPEN,e.Events.TrashcanOpen.prototype.toJson=function(){var t=e.Events.TrashcanOpen.superClass_.toJson.call(this);return t.isOpen=this.isOpen,t},e.Events.TrashcanOpen.prototype.fromJson=function(t){e.Events.TrashcanOpen.superClass_.fromJson.call(this,t),this.isOpen=t.isOpen},e.registry.register(e.registry.Type.EVENT,e.Events.TRASHCAN_OPEN,e.Events.TrashcanOpen),e.IPositionable=function(){},e.uiPosition={},e.uiPosition.verticalPosition={TOP:0,BOTTOM:1},e.uiPosition.horizontalPosition={LEFT:0,RIGHT:1},e.uiPosition.bumpDirection={UP:0,DOWN:1},e.uiPosition.getStartPositionRect=function(t,n,o,r,a,h){var R=h.scrollbar&&h.scrollbar.canScrollVertically();return t.horizontal===e.uiPosition.horizontalPosition.LEFT?(o=a.absoluteMetrics.left+o,R&&h.RTL&&(o+=e.Scrollbar.scrollbarThickness)):(o=a.absoluteMetrics.left+a.viewMetrics.width-n.width-o,R&&!h.RTL&&(o-=e.Scrollbar.scrollbarThickness)),t.vertical===e.uiPosition.verticalPosition.TOP?t=a.absoluteMetrics.top+r:(t=a.absoluteMetrics.top+a.viewMetrics.height-n.height-r,h.scrollbar&&h.scrollbar.canScrollHorizontally()&&(t-=e.Scrollbar.scrollbarThickness)),new e.utils.Rect(t,t+n.height,o,o+n.width)},e.uiPosition.getCornerOppositeToolbox=function(t,n){return{horizontal:n.toolboxMetrics.position===e.utils.toolbox.Position.LEFT||t.horizontalLayout&&!t.RTL?e.uiPosition.horizontalPosition.RIGHT:e.uiPosition.horizontalPosition.LEFT,vertical:n.toolboxMetrics.position===e.utils.toolbox.Position.BOTTOM?e.uiPosition.verticalPosition.TOP:e.uiPosition.verticalPosition.BOTTOM}},e.uiPosition.bumpPositionRect=function(t,n,o,r){for(var W,a=t.left,h=t.right-t.left,R=t.bottom-t.top,L=0;W=r[L];L++)t.intersects(W)&&(t=new e.utils.Rect(t=o===e.uiPosition.bumpDirection.UP?W.top-R-n:W.bottom+n,t+R,a,a+h),L=-1);return t},e.Trashcan=function(t){e.Trashcan.superClass_.constructor.call(this),this.workspace_=t,this.id="trashcan",this.contents_=[],this.flyout=null,0>=this.workspace_.options.maxTrashcanContents||(t=new e.Options({scrollbars:!0,parentWorkspace:this.workspace_,rtl:this.workspace_.RTL,oneBasedIndex:this.workspace_.options.oneBasedIndex,renderer:this.workspace_.options.renderer,rendererOverrides:this.workspace_.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace_.horizontalLayout?(t.toolboxPosition=this.workspace_.toolboxPosition==e.utils.toolbox.Position.TOP?e.utils.toolbox.Position.BOTTOM:e.utils.toolbox.Position.TOP,this.flyout=new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace_.options,!0))(t)):(t.toolboxPosition=this.workspace_.toolboxPosition==e.utils.toolbox.Position.RIGHT?e.utils.toolbox.Position.LEFT:e.utils.toolbox.Position.RIGHT,this.flyout=new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.workspace_.options,!0))(t)),this.workspace_.addChangeListener(this.onDelete_.bind(this)))},e.utils.object.inherits(e.Trashcan,e.DeleteArea),e.Trashcan.prototype.WIDTH_=47,e.Trashcan.prototype.BODY_HEIGHT_=44,e.Trashcan.prototype.LID_HEIGHT_=16,e.Trashcan.prototype.MARGIN_VERTICAL_=20,e.Trashcan.prototype.MARGIN_HORIZONTAL_=20,e.Trashcan.prototype.MARGIN_HOTSPOT_=10,e.Trashcan.prototype.SPRITE_LEFT_=0,e.Trashcan.prototype.SPRITE_TOP_=32,e.Trashcan.prototype.HAS_BLOCKS_LID_ANGLE_=.1,e.Trashcan.ANIMATION_LENGTH_=80,e.Trashcan.ANIMATION_FRAMES_=4,e.Trashcan.OPACITY_MIN_=.4,e.Trashcan.OPACITY_MAX_=.8,e.Trashcan.MAX_LID_ANGLE_=45,e.Trashcan.prototype.isLidOpen=!1,e.Trashcan.prototype.minOpenness_=0,e.Trashcan.prototype.svgGroup_=null,e.Trashcan.prototype.svgLid_=null,e.Trashcan.prototype.lidTask_=0,e.Trashcan.prototype.lidOpen_=0,e.Trashcan.prototype.left_=0,e.Trashcan.prototype.top_=0,e.Trashcan.prototype.initialized_=!1,e.Trashcan.prototype.createDom=function(){this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyTrash"},null);var t=String(Math.random()).substring(2),n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},n);var o=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,x:-this.SPRITE_LEFT_,height:e.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup_);return o.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup_),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:this.WIDTH_,height:this.LID_HEIGHT_},n),this.svgLid_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,x:-this.SPRITE_LEFT_,height:e.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup_),this.svgLid_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),e.browserEvents.bind(this.svgGroup_,"mousedown",this,this.blockMouseDownWhenOpenable_),e.browserEvents.bind(this.svgGroup_,"mouseup",this,this.click),e.browserEvents.bind(o,"mouseover",this,this.mouseOver_),e.browserEvents.bind(o,"mouseout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_},e.Trashcan.prototype.init=function(){0<this.workspace_.options.maxTrashcanContents&&(e.utils.dom.insertAfter(this.flyout.createDom(e.utils.Svg.SVG),this.workspace_.getParentSvg()),this.flyout.init(this.workspace_)),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[e.ComponentManager.Capability.AUTOHIDEABLE,e.ComponentManager.Capability.DELETE_AREA,e.ComponentManager.Capability.DRAG_TARGET,e.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0,this.setLidOpen(!1)},e.Trashcan.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("trashcan"),this.svgGroup_&&(e.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,clearTimeout(this.lidTask_)},e.Trashcan.prototype.hasContents_=function(){return!!this.contents_.length},e.Trashcan.prototype.contentsIsOpen=function(){return this.flyout.isVisible()},e.Trashcan.prototype.openFlyout=function(){if(!this.contentsIsOpen()){var t=this.contents_.map(e.Xml.textToDom);this.flyout.show(t),this.fireUiEvent_(!0)}},e.Trashcan.prototype.closeFlyout=function(){this.contentsIsOpen()&&(this.flyout.hide(),this.fireUiEvent_(!1))},e.Trashcan.prototype.autoHide=function(t){!t&&this.flyout&&this.closeFlyout()},e.Trashcan.prototype.emptyContents=function(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())},e.Trashcan.prototype.position=function(t,n){if(this.initialized_){var o=e.uiPosition.getCornerOppositeToolbox(this.workspace_,t);t=e.uiPosition.getStartPositionRect(o,new e.utils.Size(this.WIDTH_,this.BODY_HEIGHT_+this.LID_HEIGHT_),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,t,this.workspace_),n=e.uiPosition.bumpPositionRect(t,this.MARGIN_VERTICAL_,o.vertical===e.uiPosition.verticalPosition.TOP?e.uiPosition.bumpDirection.DOWN:e.uiPosition.bumpDirection.UP,n),this.top_=n.top,this.left_=n.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},e.Trashcan.prototype.getBoundingRectangle=function(){return new e.utils.Rect(this.top_,this.top_+this.BODY_HEIGHT_+this.LID_HEIGHT_,this.left_,this.left_+this.WIDTH_)},e.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),n=t.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_;return new e.utils.Rect(n,n+this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_,t=t.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,t+this.WIDTH_+2*this.MARGIN_HOTSPOT_)},e.Trashcan.prototype.onDragOver=function(t){this.setLidOpen(this.wouldDelete_)},e.Trashcan.prototype.onDragExit=function(t){this.setLidOpen(!1)},e.Trashcan.prototype.onDrop=function(t){setTimeout(this.setLidOpen.bind(this,!1),100)},e.Trashcan.prototype.setLidOpen=function(t){this.isLidOpen!=t&&(clearTimeout(this.lidTask_),this.isLidOpen=t,this.animateLid_())},e.Trashcan.prototype.animateLid_=function(){var t=e.Trashcan.ANIMATION_FRAMES_,n=1/(t+1);this.lidOpen_+=this.isLidOpen?n:-n,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*e.Trashcan.MAX_LID_ANGLE_),this.svgGroup_.style.opacity=(n=e.Trashcan.OPACITY_MIN_)+this.lidOpen_*(e.Trashcan.OPACITY_MAX_-n),this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),e.Trashcan.ANIMATION_LENGTH_/t))},e.Trashcan.prototype.setLidAngle_=function(t){var n=this.workspace_.toolboxPosition==e.utils.toolbox.Position.RIGHT||this.workspace_.horizontalLayout&&this.workspace_.RTL;this.svgLid_.setAttribute("transform","rotate("+(n?-t:t)+","+(n?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")")},e.Trashcan.prototype.setMinOpenness_=function(t){this.minOpenness_=t,this.isLidOpen||this.setLidAngle_(t*e.Trashcan.MAX_LID_ANGLE_)},e.Trashcan.prototype.closeLid=function(){this.setLidOpen(!1)},e.Trashcan.prototype.click=function(){this.hasContents_()&&this.openFlyout()},e.Trashcan.prototype.fireUiEvent_=function(t){t=new(e.Events.get(e.Events.TRASHCAN_OPEN))(t,this.workspace_.id),e.Events.fire(t)},e.Trashcan.prototype.blockMouseDownWhenOpenable_=function(t){!this.contentsIsOpen()&&this.hasContents_()&&t.stopPropagation()},e.Trashcan.prototype.mouseOver_=function(){this.hasContents_()&&this.setLidOpen(!0)},e.Trashcan.prototype.mouseOut_=function(){this.setLidOpen(!1)},e.Trashcan.prototype.onDelete_=function(t){if(!(0>=this.workspace_.options.maxTrashcanContents)&&t.type==e.Events.BLOCK_DELETE&&t.oldXml.tagName&&"shadow"!=t.oldXml.tagName.toLowerCase()&&(t=this.cleanBlockXML_(t.oldXml),-1==this.contents_.indexOf(t))){for(this.contents_.unshift(t);this.contents_.length>this.workspace_.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(this.HAS_BLOCKS_LID_ANGLE_)}},e.Trashcan.prototype.cleanBlockXML_=function(t){for(var n=t=t.cloneNode(!0);n;){n.removeAttribute&&(n.removeAttribute("x"),n.removeAttribute("y"),n.removeAttribute("id"),n.removeAttribute("disabled"),"comment"==n.nodeName&&(n.removeAttribute("h"),n.removeAttribute("w"),n.removeAttribute("pinned")));var o=n.firstChild||n.nextSibling;if(!o)for(o=n.parentNode;o;){if(o.nextSibling){o=o.nextSibling;break}o=o.parentNode}n=o}return e.Xml.domToText(t)},e.VariablesDynamic={},e.VariablesDynamic.onCreateVariableButtonClick_String=function(t){e.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"String")},e.VariablesDynamic.onCreateVariableButtonClick_Number=function(t){e.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"Number")},e.VariablesDynamic.onCreateVariableButtonClick_Colour=function(t){e.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"Colour")},e.VariablesDynamic.flyoutCategory=function(t){var n=[],o=document.createElement("button");return o.setAttribute("text",e.Msg.NEW_STRING_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),n.push(o),(o=document.createElement("button")).setAttribute("text",e.Msg.NEW_NUMBER_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),n.push(o),(o=document.createElement("button")).setAttribute("text",e.Msg.NEW_COLOUR_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),n.push(o),t.registerButtonCallback("CREATE_VARIABLE_STRING",e.VariablesDynamic.onCreateVariableButtonClick_String),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",e.VariablesDynamic.onCreateVariableButtonClick_Number),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",e.VariablesDynamic.onCreateVariableButtonClick_Colour),t=e.VariablesDynamic.flyoutCategoryBlocks(t),n.concat(t)},e.VariablesDynamic.flyoutCategoryBlocks=function(t){var n=[];if(0<(t=t.getAllVariables()).length){if(e.Blocks.variables_set_dynamic){var o=t[t.length-1],r=e.utils.xml.createElement("block");r.setAttribute("type","variables_set_dynamic"),r.setAttribute("gap",24),r.appendChild(e.Variables.generateVariableFieldDom(o)),n.push(r)}if(e.Blocks.variables_get_dynamic){t.sort(e.VariableModel.compareByName),o=0;for(var a;a=t[o];o++)(r=e.utils.xml.createElement("block")).setAttribute("type","variables_get_dynamic"),r.setAttribute("gap",8),r.appendChild(e.Variables.generateVariableFieldDom(a)),n.push(r)}}return n},e.ZoomControls=function(t){this.workspace_=t,this.id="zoomControls",this.zoomResetGroup_=this.zoomOutGroup_=this.zoomInGroup_=this.onZoomOutWrapper_=this.onZoomInWrapper_=this.onZoomResetWrapper_=null},e.ZoomControls.prototype.WIDTH_=32,e.ZoomControls.prototype.HEIGHT_=32,e.ZoomControls.prototype.SMALL_SPACING_=2,e.ZoomControls.prototype.LARGE_SPACING_=11,e.ZoomControls.prototype.MARGIN_VERTICAL_=20,e.ZoomControls.prototype.MARGIN_HORIZONTAL_=20,e.ZoomControls.prototype.svgGroup_=null,e.ZoomControls.prototype.left_=0,e.ZoomControls.prototype.top_=0,e.ZoomControls.prototype.initialized_=!1,e.ZoomControls.prototype.createDom=function(){this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null);var t=String(Math.random()).substring(2);return this.createZoomOutSvg_(t),this.createZoomInSvg_(t),this.workspace_.isMovable()&&this.createZoomResetSvg_(t),this.svgGroup_},e.ZoomControls.prototype.init=function(){this.workspace_.getComponentManager().addComponent({component:this,weight:2,capabilities:[e.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0},e.ZoomControls.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("zoomControls"),this.svgGroup_&&e.utils.dom.removeNode(this.svgGroup_),this.onZoomResetWrapper_&&e.browserEvents.unbind(this.onZoomResetWrapper_),this.onZoomInWrapper_&&e.browserEvents.unbind(this.onZoomInWrapper_),this.onZoomOutWrapper_&&e.browserEvents.unbind(this.onZoomOutWrapper_)},e.ZoomControls.prototype.getBoundingRectangle=function(){var t=this.SMALL_SPACING_+2*this.HEIGHT_;return this.zoomResetGroup_&&(t+=this.LARGE_SPACING_+this.HEIGHT_),new e.utils.Rect(this.top_,this.top_+t,this.left_,this.left_+this.WIDTH_)},e.ZoomControls.prototype.position=function(t,n){if(this.initialized_){var o=e.uiPosition.getCornerOppositeToolbox(this.workspace_,t),r=this.SMALL_SPACING_+2*this.HEIGHT_;this.zoomResetGroup_&&(r+=this.LARGE_SPACING_+this.HEIGHT_),t=e.uiPosition.getStartPositionRect(o,new e.utils.Size(this.WIDTH_,r),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,t,this.workspace_),n=e.uiPosition.bumpPositionRect(t,this.MARGIN_VERTICAL_,(o=o.vertical)===e.uiPosition.verticalPosition.TOP?e.uiPosition.bumpDirection.DOWN:e.uiPosition.bumpDirection.UP,n),o===e.uiPosition.verticalPosition.TOP?(this.zoomInGroup_.setAttribute("transform","translate(0, "+(o=this.SMALL_SPACING_+this.HEIGHT_)+")"),this.zoomResetGroup_&&this.zoomResetGroup_.setAttribute("transform","translate(0, "+(o+this.LARGE_SPACING_+this.HEIGHT_)+")")):(this.zoomInGroup_.setAttribute("transform","translate(0, "+(o=this.zoomResetGroup_?this.LARGE_SPACING_+this.HEIGHT_:0)+")"),this.zoomOutGroup_.setAttribute("transform","translate(0, "+(o+this.SMALL_SPACING_+this.HEIGHT_)+")")),this.top_=n.top,this.left_=n.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},e.ZoomControls.prototype.createZoomOutSvg_=function(t){this.zoomOutGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:32,height:32},n),e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,height:e.SPRITE.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup_).setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),this.onZoomOutWrapper_=e.browserEvents.conditionalBind(this.zoomOutGroup_,"mousedown",null,this.zoom_.bind(this,-1))},e.ZoomControls.prototype.createZoomInSvg_=function(t){this.zoomInGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyZoominClipPath"+t},this.zoomInGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:32,height:32},n),e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,height:e.SPRITE.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup_).setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),this.onZoomInWrapper_=e.browserEvents.conditionalBind(this.zoomInGroup_,"mousedown",null,this.zoom_.bind(this,1))},e.ZoomControls.prototype.zoom_=function(t,n){this.workspace_.markFocused(),this.workspace_.zoomCenter(t),this.fireZoomEvent_(),e.Touch.clearTouchIdentifier(),n.stopPropagation(),n.preventDefault()},e.ZoomControls.prototype.createZoomResetSvg_=function(t){this.zoomResetGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:32,height:32},n),e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,height:e.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup_).setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),this.onZoomResetWrapper_=e.browserEvents.conditionalBind(this.zoomResetGroup_,"mousedown",null,this.resetZoom_.bind(this))},e.ZoomControls.prototype.resetZoom_=function(t){this.workspace_.markFocused();var n=Math.log(this.workspace_.options.zoomOptions.startScale/this.workspace_.scale)/Math.log(this.workspace_.options.zoomOptions.scaleSpeed);this.workspace_.beginCanvasTransition(),this.workspace_.zoomCenter(n),this.workspace_.scrollCenter(),setTimeout(this.workspace_.endCanvasTransition.bind(this.workspace_),500),this.fireZoomEvent_(),e.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()},e.ZoomControls.prototype.fireZoomEvent_=function(){var t=new(e.Events.get(e.Events.CLICK))(null,this.workspace_.id,"zoom_controls");e.Events.fire(t)},e.Css.register([".blocklyZoom>image, .blocklyZoom>svg>image {","opacity: .4;","}",".blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {","opacity: .6;","}",".blocklyZoom>image:active, .blocklyZoom>svg>image:active {","opacity: .8;","}"]),e.ShortcutItems={},e.ShortcutItems.names={ESCAPE:"escape",DELETE:"delete",COPY:"copy",CUT:"cut",PASTE:"paste",UNDO:"undo",REDO:"redo"},e.ShortcutItems.registerEscape=function(){var t={name:e.ShortcutItems.names.ESCAPE,preconditionFn:function(n){return!n.options.readOnly},callback:function(){return e.hideChaff(),!0}};e.ShortcutRegistry.registry.register(t),e.ShortcutRegistry.registry.addKeyMapping(e.utils.KeyCodes.ESC,t.name)},e.ShortcutItems.registerDelete=function(){var t={name:e.ShortcutItems.names.DELETE,preconditionFn:function(n){return!n.options.readOnly&&e.selected&&e.selected.isDeletable()},callback:function(n,o){return o.preventDefault(),!e.Gesture.inProgress()&&(e.deleteBlock(e.selected),!0)}};e.ShortcutRegistry.registry.register(t),e.ShortcutRegistry.registry.addKeyMapping(e.utils.KeyCodes.DELETE,t.name),e.ShortcutRegistry.registry.addKeyMapping(e.utils.KeyCodes.BACKSPACE,t.name)},e.ShortcutItems.registerCopy=function(){var t={name:e.ShortcutItems.names.COPY,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()&&e.selected&&e.selected.isDeletable()&&e.selected.isMovable()},callback:function(o,r){return r.preventDefault(),e.hideChaff(),e.copy(e.selected),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerCut=function(){var t={name:e.ShortcutItems.names.CUT,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()&&e.selected&&e.selected.isDeletable()&&e.selected.isMovable()&&!e.selected.workspace.isFlyout},callback:function(){return e.copy(e.selected),e.deleteBlock(e.selected),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerPaste=function(){var t={name:e.ShortcutItems.names.PASTE,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()},callback:function(){return e.paste()}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerUndo=function(){var t={name:e.ShortcutItems.names.UNDO,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()},callback:function(o){return e.hideChaff(),o.undo(!1),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerRedo=function(){var t={name:e.ShortcutItems.names.REDO,preconditionFn:function(o){return!e.Gesture.inProgress()&&!o.options.readOnly},callback:function(o){return e.hideChaff(),o.undo(!0),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.SHIFT,e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.SHIFT,e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.SHIFT,e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Y,[e.utils.KeyCodes.CTRL]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerDefaultShortcuts=function(){e.ShortcutItems.registerEscape(),e.ShortcutItems.registerDelete(),e.ShortcutItems.registerCopy(),e.ShortcutItems.registerCut(),e.ShortcutItems.registerPaste(),e.ShortcutItems.registerUndo(),e.ShortcutItems.registerRedo()},e.ShortcutItems.registerDefaultShortcuts(),e.ContextMenuItems={},e.ContextMenuItems.registerUndo=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.UNDO},preconditionFn:function(t){return 0<t.workspace.getUndoStack().length?"enabled":"disabled"},callback:function(t){t.workspace.undo(!1)},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},e.ContextMenuItems.registerRedo=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.REDO},preconditionFn:function(t){return 0<t.workspace.getRedoStack().length?"enabled":"disabled"},callback:function(t){t.workspace.undo(!0)},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},e.ContextMenuItems.registerCleanup=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.CLEAN_UP},preconditionFn:function(t){return t.workspace.isMovable()?1<t.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback:function(t){t.workspace.cleanUp()},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},e.ContextMenuItems.toggleOption_=function(t,n){for(var o=0,r=0;r<n.length;r++)for(var a=n[r];a;)setTimeout(a.setCollapsed.bind(a,t),o),a=a.getNextBlock(),o+=10},e.ContextMenuItems.registerCollapse=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.COLLAPSE_ALL},preconditionFn:function(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(var n=0;n<t.length;n++)for(var o=t[n];o;){if(!o.isCollapsed())return"enabled";o=o.getNextBlock()}return"disabled"}return"hidden"},callback:function(t){e.ContextMenuItems.toggleOption_(!0,t.workspace.getTopBlocks(!0))},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},e.ContextMenuItems.registerExpand=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.EXPAND_ALL},preconditionFn:function(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(var n=0;n<t.length;n++)for(var o=t[n];o;){if(o.isCollapsed())return"enabled";o=o.getNextBlock()}return"disabled"}return"hidden"},callback:function(t){e.ContextMenuItems.toggleOption_(!1,t.workspace.getTopBlocks(!0))},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},e.ContextMenuItems.addDeletableBlocks_=function(t,n){if(t.isDeletable())Array.prototype.push.apply(n,t.getDescendants(!1));else{t=t.getChildren(!1);for(var o=0;o<t.length;o++)e.ContextMenuItems.addDeletableBlocks_(t[o],n)}},e.ContextMenuItems.getDeletableBlocks_=function(t){var n=[];t=t.getTopBlocks(!0);for(var o=0;o<t.length;o++)e.ContextMenuItems.addDeletableBlocks_(t[o],n);return n},e.ContextMenuItems.deleteNext_=function(t,n){e.Events.setGroup(n);var o=t.shift();o&&(o.workspace?(o.dispose(!1,!0),setTimeout(e.ContextMenuItems.deleteNext_,10,t,n)):e.ContextMenuItems.deleteNext_(t,n)),e.Events.setGroup(!1)},e.ContextMenuItems.registerDeleteAll=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){if(t.workspace)return 1==(t=e.ContextMenuItems.getDeletableBlocks_(t.workspace).length)?e.Msg.DELETE_BLOCK:e.Msg.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn:function(t){if(t.workspace)return 0<e.ContextMenuItems.getDeletableBlocks_(t.workspace).length?"enabled":"disabled"},callback:function(t){if(t.workspace){t.workspace.cancelCurrentGesture();var n=e.ContextMenuItems.getDeletableBlocks_(t.workspace),o=e.utils.genUid();2>n.length?e.ContextMenuItems.deleteNext_(n,o):e.confirm(e.Msg.DELETE_ALL_BLOCKS.replace("%1",n.length),function(r){r&&e.ContextMenuItems.deleteNext_(n,o)})}},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},e.ContextMenuItems.registerWorkspaceOptions_=function(){e.ContextMenuItems.registerUndo(),e.ContextMenuItems.registerRedo(),e.ContextMenuItems.registerCleanup(),e.ContextMenuItems.registerCollapse(),e.ContextMenuItems.registerExpand(),e.ContextMenuItems.registerDeleteAll()},e.ContextMenuItems.registerDuplicate=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.DUPLICATE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden"},callback:function(t){t.block&&e.duplicate(t.block)},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},e.ContextMenuItems.registerComment=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.getCommentIcon()?e.Msg.REMOVE_COMMENT:e.Msg.ADD_COMMENT},preconditionFn:function(t){return t=t.block,e.utils.userAgent.IE||t.isInFlyout||!t.workspace.options.comments||t.isCollapsed()||!t.isEditable()?"hidden":"enabled"},callback:function(t){(t=t.block).getCommentIcon()?t.setCommentText(null):t.setCommentText("")},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockComment",weight:2})},e.ContextMenuItems.registerInline=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.getInputsInline()?e.Msg.EXTERNAL_INPUTS:e.Msg.INLINE_INPUTS},preconditionFn:function(t){if(!(t=t.block).isInFlyout&&t.isMovable()&&!t.isCollapsed())for(var n=1;n<t.inputList.length;n++)if(t.inputList[n-1].type!=e.inputTypes.STATEMENT&&t.inputList[n].type!=e.inputTypes.STATEMENT)return"enabled";return"hidden"},callback:function(t){t.block.setInputsInline(!t.block.getInputsInline())},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockInline",weight:3})},e.ContextMenuItems.registerCollapseExpandBlock=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.isCollapsed()?e.Msg.EXPAND_BLOCK:e.Msg.COLLAPSE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback:function(t){t.block.setCollapsed(!t.block.isCollapsed())},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},e.ContextMenuItems.registerDisable=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.isEnabled()?e.Msg.DISABLE_BLOCK:e.Msg.ENABLE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.workspace.options.disable&&t.isEditable()?t.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback:function(t){t=t.block;var n=e.Events.getGroup();n||e.Events.setGroup(!0),t.setEnabled(!t.isEnabled()),n||e.Events.setGroup(!1)},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDisable",weight:5})},e.ContextMenuItems.registerDelete=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){var n=t.block;return t=n.getDescendants(!1).length,(n=n.getNextBlock())&&(t-=n.getDescendants(!1).length),1==t?e.Msg.DELETE_BLOCK:e.Msg.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn:function(t){return!t.block.isInFlyout&&t.block.isDeletable()?"enabled":"hidden"},callback:function(t){e.Events.setGroup(!0),t.block&&e.deleteBlock(t.block),e.Events.setGroup(!1)},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDelete",weight:6})},e.ContextMenuItems.registerHelp=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.HELP},preconditionFn:function(t){return("function"==typeof(t=t.block).helpUrl?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback:function(t){t.block.showHelp()},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockHelp",weight:7})},e.ContextMenuItems.registerBlockOptions_=function(){e.ContextMenuItems.registerDuplicate(),e.ContextMenuItems.registerComment(),e.ContextMenuItems.registerInline(),e.ContextMenuItems.registerCollapseExpandBlock(),e.ContextMenuItems.registerDisable(),e.ContextMenuItems.registerDelete(),e.ContextMenuItems.registerHelp()},e.ContextMenuItems.registerDefaultOptions=function(){e.ContextMenuItems.registerWorkspaceOptions_(),e.ContextMenuItems.registerBlockOptions_()},e.ContextMenuItems.registerDefaultOptions(),e.Mutator=function(t){e.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=t},e.utils.object.inherits(e.Mutator,e.Icon),e.Mutator.prototype.workspace_=null,e.Mutator.prototype.workspaceWidth_=0,e.Mutator.prototype.workspaceHeight_=0,e.Mutator.prototype.setBlock=function(t){this.block_=t},e.Mutator.prototype.getWorkspace=function(){return this.workspace_},e.Mutator.prototype.drawIcon_=function(t){e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},t),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},t),e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},t)},e.Mutator.prototype.iconClick_=function(t){this.block_.isEditable()&&e.Icon.prototype.iconClick_.call(this,t)},e.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{x:e.Bubble.BORDER_WIDTH,y:e.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var o,t=e.utils.xml.createElement("xml"),n=0;o=this.quarkNames_[n];n++){var r=e.utils.xml.createElement("block");r.setAttribute("type",o),t.appendChild(r)}else t=null;return(n=new e.Options({disable:!1,parentWorkspace:this.block_.workspace,media:this.block_.workspace.options.pathToMedia,rtl:this.block_.RTL,horizontalLayout:!1,renderer:this.block_.workspace.options.renderer,rendererOverrides:this.block_.workspace.options.rendererOverrides})).toolboxPosition=this.block_.RTL?e.utils.toolbox.Position.RIGHT:e.utils.toolbox.Position.LEFT,(o=!!t)&&(n.languageTree=e.utils.toolbox.convertToolboxDefToJson(t)),this.workspace_=new e.WorkspaceSvg(n),this.workspace_.isMutator=!0,this.workspace_.addChangeListener(e.Events.disableOrphans),t=o?this.workspace_.addFlyout(e.utils.Svg.G):null,n=this.workspace_.createDom("blocklyMutatorBackground"),t&&n.insertBefore(t,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(n),this.svgDialog_},e.Mutator.prototype.updateEditable=function(){e.Mutator.superClass_.updateEditable.call(this),this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&e.utils.dom.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&e.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly")))},e.Mutator.prototype.resizeBubble_=function(){var t=2*e.Bubble.BORDER_WIDTH,n=this.workspace_.getCanvas().getBBox(),o=n.width+n.x,r=n.height+3*t,a=this.workspace_.getFlyout();if(a){var h=a.getWorkspace().getMetricsManager().getScrollMetrics();r=Math.max(r,h.height+20),o+=a.getWidth()}this.block_.RTL&&(o=-n.x),o+=3*t,(Math.abs(this.workspaceWidth_-o)>t||Math.abs(this.workspaceHeight_-r)>t)&&(this.workspaceWidth_=o,this.workspaceHeight_=r,this.bubble_.setBubbleSize(o+t,r+t),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_),this.workspace_.setCachedParentSvgSize(this.workspaceWidth_,this.workspaceHeight_)),this.block_.RTL&&(t="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",t)),this.workspace_.resize()},e.Mutator.prototype.onBubbleMove_=function(){this.workspace_&&this.workspace_.recordDragTargets()},e.Mutator.prototype.setVisible=function(t){if(t!=this.isVisible())if(e.Events.fire(new(e.Events.get(e.Events.BUBBLE_OPEN))(this.block_,t,"mutator")),t){this.bubble_=new e.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerMoveEvent(this.onBubbleMove_.bind(this));var n=this.workspace_.options.languageTree;t=this.workspace_.getFlyout(),n&&(t.init(this.workspace_),t.show(n)),this.rootBlock_=this.block_.decompose(this.workspace_),n=this.rootBlock_.getDescendants(!1);for(var r,o=0;r=n[o];o++)r.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),t?(n=2*t.CORNER_RADIUS,t=this.rootBlock_.RTL?t.getWidth()+n:n):t=n=16,this.block_.RTL&&(t=-t),this.rootBlock_.moveBy(t,n),this.block_.saveConnections){var a=this,h=this.block_;h.saveConnections(this.rootBlock_),this.sourceListener_=function(){h.saveConnections(a.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.applyColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},e.Mutator.prototype.workspaceChanged_=function(t){if(!(t.isUiEvent||t.type==e.Events.CHANGE&&"disabled"==t.element)){if(!this.workspace_.isDragging()){t=this.workspace_.getTopBlocks(!1);for(var o,n=0;o=t[n];n++){var r=o.getRelativeToSurfaceXY();if(20>r.y&&o.moveBy(0,20-r.y),o.RTL){var a=-20,h=this.workspace_.getFlyout();h&&(a-=h.getWidth()),r.x>a&&o.moveBy(a-r.x,0)}else 20>r.x&&o.moveBy(20-r.x,0)}}if(this.rootBlock_.workspace==this.workspace_){if(e.Events.setGroup(!0),t=(t=(o=this.block_).mutationToDom())&&e.Xml.domToText(t),n=o.rendered,o.rendered=!1,o.compose(this.rootBlock_),o.rendered=n,o.initSvg(),o.rendered&&o.render(),t!=(n=(n=o.mutationToDom())&&e.Xml.domToText(n))){e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(o,"mutation",null,t,n));var R=e.Events.getGroup();setTimeout(function(){e.Events.setGroup(R),o.bumpNeighbours(),e.Events.setGroup(!1)},e.BUMP_DELAY)}this.workspace_.isDragging()||this.resizeBubble_(),e.Events.setGroup(!1)}}},e.Mutator.prototype.dispose=function(){this.block_.mutator=null,e.Icon.prototype.dispose.call(this)},e.Mutator.prototype.updateBlockStyle=function(){var t=this.workspace_;if(t&&t.getAllBlocks(!1)){for(var r,n=t.getAllBlocks(!1),o=0;r=n[o];o++)r.setStyle(r.getStyleName());if(o=t.getFlyout())for(t=o.workspace_.getAllBlocks(!1),o=0;r=t[o];o++)r.setStyle(r.getStyleName())}},e.Mutator.reconnect=function(t,n,o){if(!t||!t.getSourceBlock().workspace)return!1;o=n.getInput(o).connection;var r=t.targetBlock();return!(r&&r!=n||o.targetConnection==t||(o.isConnected()&&o.disconnect(),o.connect(t),0))},e.Mutator.findParentWs=function(t){var n=null;if(t&&t.options){var o=t.options.parentWorkspace;t.isFlyout?o&&o.options&&(n=o.options.parentWorkspace):o&&(n=o)}return n},e.FieldTextInput=function(t,n,o){this.spellcheck_=!0,e.FieldTextInput.superClass_.constructor.call(this,t,n,o),this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.htmlInput_=null,this.fullBlockClickTarget_=!1,this.workspace_=null},e.utils.object.inherits(e.FieldTextInput,e.Field),e.FieldTextInput.prototype.DEFAULT_VALUE="",e.FieldTextInput.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldTextInput(n,void 0,t)},e.FieldTextInput.prototype.SERIALIZABLE=!0,e.FieldTextInput.BORDERRADIUS=4,e.FieldTextInput.prototype.CURSOR="text",e.FieldTextInput.prototype.configure_=function(t){e.FieldTextInput.superClass_.configure_.call(this,t),"boolean"==typeof t.spellcheck&&(this.spellcheck_=t.spellcheck)},e.FieldTextInput.prototype.initView=function(){if(this.getConstants().FULL_BLOCK_FIELDS){for(var r,t=0,n=0,o=0;r=this.sourceBlock_.inputList[o];o++){for(var a=0;r.fieldRow[a];a++)t++;r.connection&&n++}this.fullBlockClickTarget_=1>=t&&this.sourceBlock_.outputConnection&&!n}else this.fullBlockClickTarget_=!1;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()},e.FieldTextInput.prototype.doClassValidation_=function(t){return null==t?null:String(t)},e.FieldTextInput.prototype.doValueInvalid_=function(t){this.isBeingEdited_&&(this.isTextValid_=!1,t=this.value_,this.value_=this.htmlInput_.untypedDefaultValue_,this.sourceBlock_&&e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,t,this.value_)))},e.FieldTextInput.prototype.doValueUpdate_=function(t){this.isTextValid_=!0,this.value_=t,this.isBeingEdited_||(this.isDirty_=!0)},e.FieldTextInput.prototype.applyColour=function(){this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS&&(this.borderRect_?this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR))},e.FieldTextInput.prototype.render_=function(){if(e.FieldTextInput.superClass_.render_.call(this),this.isBeingEdited_){this.resizeEditor_();var t=this.htmlInput_;this.isTextValid_?(e.utils.dom.removeClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!1)):(e.utils.dom.addClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!0))}},e.FieldTextInput.prototype.setSpellcheck=function(t){t!=this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))},e.FieldTextInput.prototype.showEditor_=function(t,n){this.workspace_=this.sourceBlock_.workspace,!(t=n||!1)&&(e.utils.userAgent.MOBILE||e.utils.userAgent.ANDROID||e.utils.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(t)},e.FieldTextInput.prototype.showPromptEditor_=function(){e.prompt(e.Msg.CHANGE_VALUE_TITLE,this.getText(),function(t){this.setValue(this.getValueFromEditorText_(t))}.bind(this))},e.FieldTextInput.prototype.showInlineEditor_=function(t){e.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,t||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())},e.FieldTextInput.prototype.widgetCreate_=function(){var t=e.WidgetDiv.DIV;e.utils.dom.addClass(this.getClickTarget_(),"editing");var n=document.createElement("input");n.className="blocklyHtmlInput",n.setAttribute("spellcheck",this.spellcheck_);var o=this.workspace_.getScale(),r=this.getConstants().FIELD_TEXT_FONTSIZE*o+"pt";if(t.style.fontSize=r,n.style.fontSize=r,r=e.FieldTextInput.BORDERRADIUS*o+"px",this.fullBlockClickTarget_){r=((r=this.getScaledBBox()).bottom-r.top)/2+"px";var a=this.sourceBlock_.getParent()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;n.style.border=1*o+"px solid "+a,t.style.borderRadius=r,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0px 0px 0px "+4*o+"px")}return n.style.borderRadius=r,t.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.untypedDefaultValue_=this.value_,n.oldValue_=null,this.resizeEditor_(),this.bindInputEvents_(n),n},e.FieldTextInput.prototype.widgetDispose_=function(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_&&this.onFinishEditing_(this.value_),this.unbindInputEvents_();var t=e.WidgetDiv.DIV.style;t.width="auto",t.height="auto",t.fontSize="",t.transition="",t.boxShadow="",this.htmlInput_=null,e.utils.dom.removeClass(this.getClickTarget_(),"editing")},e.FieldTextInput.prototype.bindInputEvents_=function(t){this.onKeyDownWrapper_=e.browserEvents.conditionalBind(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=e.browserEvents.conditionalBind(t,"input",this,this.onHtmlInputChange_)},e.FieldTextInput.prototype.unbindInputEvents_=function(){this.onKeyDownWrapper_&&(e.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(e.browserEvents.unbind(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)},e.FieldTextInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode==e.utils.KeyCodes.ENTER?(e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()):t.keyCode==e.utils.KeyCodes.ESC?(this.setValue(this.htmlInput_.untypedDefaultValue_),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()):t.keyCode==e.utils.KeyCodes.TAB&&(e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())},e.FieldTextInput.prototype.onHtmlInputChange_=function(t){(t=this.htmlInput_.value)!==this.htmlInput_.oldValue_&&(this.htmlInput_.oldValue_=t,e.Events.setGroup(!0),t=this.getValueFromEditorText_(t),this.setValue(t),this.forceRerender(),this.resizeEditor_(),e.Events.setGroup(!1))},e.FieldTextInput.prototype.setEditorValue_=function(t){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t)},e.FieldTextInput.prototype.resizeEditor_=function(){var t=e.WidgetDiv.DIV,n=this.getScaledBBox();t.style.width=n.right-n.left+"px",t.style.height=n.bottom-n.top+"px",n=new e.utils.Coordinate(this.sourceBlock_.RTL?n.right-t.offsetWidth:n.left,n.top),t.style.left=n.x+"px",t.style.top=n.y+"px"},e.FieldTextInput.prototype.isTabNavigable=function(){return!0},e.FieldTextInput.prototype.getText_=function(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null},e.FieldTextInput.prototype.getEditorText_=function(t){return String(t)},e.FieldTextInput.prototype.getValueFromEditorText_=function(t){return t},e.fieldRegistry.register("field_input",e.FieldTextInput),e.FieldAngle=function(t,n,o){this.clockwise_=e.FieldAngle.CLOCKWISE,this.offset_=e.FieldAngle.OFFSET,this.wrap_=e.FieldAngle.WRAP,this.round_=e.FieldAngle.ROUND,e.FieldAngle.superClass_.constructor.call(this,t,n,o),this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.line_=this.gauge_=this.editor_=null},e.utils.object.inherits(e.FieldAngle,e.FieldTextInput),e.FieldAngle.prototype.DEFAULT_VALUE=0,e.FieldAngle.fromJson=function(t){return new e.FieldAngle(t.angle,void 0,t)},e.FieldAngle.prototype.SERIALIZABLE=!0,e.FieldAngle.ROUND=15,e.FieldAngle.HALF=50,e.FieldAngle.CLOCKWISE=!1,e.FieldAngle.OFFSET=0,e.FieldAngle.WRAP=360,e.FieldAngle.RADIUS=e.FieldAngle.HALF-1,e.FieldAngle.prototype.configure_=function(t){switch(e.FieldAngle.superClass_.configure_.call(this,t),t.mode){case"compass":this.clockwise_=!0,this.offset_=90;break;case"protractor":this.clockwise_=!1,this.offset_=0}var n=t.clockwise;"boolean"==typeof n&&(this.clockwise_=n),null!=(n=t.offset)&&(n=Number(n),isNaN(n)||(this.offset_=n)),null!=(n=t.wrap)&&(n=Number(n),isNaN(n)||(this.wrap_=n)),null!=(t=t.round)&&(t=Number(t),isNaN(t)||(this.round_=t))},e.FieldAngle.prototype.initView=function(){e.FieldAngle.superClass_.initView.call(this),this.symbol_=e.utils.dom.createSvgElement(e.utils.Svg.TSPAN,{},null),this.symbol_.appendChild(document.createTextNode("\xb0")),this.textElement_.appendChild(this.symbol_)},e.FieldAngle.prototype.render_=function(){e.FieldAngle.superClass_.render_.call(this),this.updateGraph_()},e.FieldAngle.prototype.showEditor_=function(t){e.FieldAngle.superClass_.showEditor_.call(this,t,e.utils.userAgent.MOBILE||e.utils.userAgent.ANDROID||e.utils.userAgent.IPAD),this.dropdownCreate_(),e.DropDownDiv.getContentDiv().appendChild(this.editor_),e.DropDownDiv.setColour(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),e.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.updateGraph_()},e.FieldAngle.prototype.dropdownCreate_=function(){var t=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",height:2*e.FieldAngle.HALF+"px",width:2*e.FieldAngle.HALF+"px",style:"touch-action: none"},null),n=e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{cx:e.FieldAngle.HALF,cy:e.FieldAngle.HALF,r:e.FieldAngle.RADIUS,class:"blocklyAngleCircle"},t);this.gauge_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyAngleGauge"},t),this.line_=e.utils.dom.createSvgElement(e.utils.Svg.LINE,{x1:e.FieldAngle.HALF,y1:e.FieldAngle.HALF,class:"blocklyAngleLine"},t);for(var o=0;360>o;o+=15)e.utils.dom.createSvgElement(e.utils.Svg.LINE,{x1:e.FieldAngle.HALF+e.FieldAngle.RADIUS,y1:e.FieldAngle.HALF,x2:e.FieldAngle.HALF+e.FieldAngle.RADIUS-(o%45==0?10:5),y2:e.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+o+","+e.FieldAngle.HALF+","+e.FieldAngle.HALF+")"},t);this.clickWrapper_=e.browserEvents.conditionalBind(t,"click",this,this.hide_),this.clickSurfaceWrapper_=e.browserEvents.conditionalBind(n,"click",this,this.onMouseMove_,!0,!0),this.moveSurfaceWrapper_=e.browserEvents.conditionalBind(n,"mousemove",this,this.onMouseMove_,!0,!0),this.editor_=t},e.FieldAngle.prototype.dropdownDispose_=function(){this.clickWrapper_&&(e.browserEvents.unbind(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(e.browserEvents.unbind(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(e.browserEvents.unbind(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null},e.FieldAngle.prototype.hide_=function(){e.DropDownDiv.hideIfOwner(this),e.WidgetDiv.hide()},e.FieldAngle.prototype.onMouseMove_=function(t){var n=this.gauge_.ownerSVGElement.getBoundingClientRect(),o=t.clientX-n.left-e.FieldAngle.HALF;t=t.clientY-n.top-e.FieldAngle.HALF,n=Math.atan(-t/o),isNaN(n)||(n=e.utils.math.toDegrees(n),0>o?n+=180:0<t&&(n+=360),this.displayMouseOrKeyboardValue_(n=this.clockwise_?this.offset_+360-n:360-(this.offset_-n)))},e.FieldAngle.prototype.displayMouseOrKeyboardValue_=function(t){this.round_&&(t=Math.round(t/this.round_)*this.round_),(t=this.wrapValue_(t))!=this.value_&&this.setEditorValue_(t)},e.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var t=Number(this.getText())+this.offset_,n=e.utils.math.toRadians(t%360);t=["M ",e.FieldAngle.HALF,",",e.FieldAngle.HALF];var o=e.FieldAngle.HALF,r=e.FieldAngle.HALF;if(!isNaN(n)){var a=Number(this.clockwise_),h=e.utils.math.toRadians(this.offset_),R=Math.cos(h)*e.FieldAngle.RADIUS,L=Math.sin(h)*-e.FieldAngle.RADIUS;a&&(n=2*h-n),o+=Math.cos(n)*e.FieldAngle.RADIUS,r-=Math.sin(n)*e.FieldAngle.RADIUS,n=Math.abs(Math.floor((n-h)/Math.PI)%2),a&&(n=1-n),t.push(" l ",R,",",L," A ",e.FieldAngle.RADIUS,",",e.FieldAngle.RADIUS," 0 ",n," ",a," ",o,",",r," z")}this.gauge_.setAttribute("d",t.join("")),this.line_.setAttribute("x2",o),this.line_.setAttribute("y2",r)}},e.FieldAngle.prototype.onHtmlInputKeyDown_=function(t){var n;if(e.FieldAngle.superClass_.onHtmlInputKeyDown_.call(this,t),t.keyCode===e.utils.KeyCodes.LEFT?n=this.sourceBlock_.RTL?1:-1:t.keyCode===e.utils.KeyCodes.RIGHT?n=this.sourceBlock_.RTL?-1:1:t.keyCode===e.utils.KeyCodes.DOWN?n=-1:t.keyCode===e.utils.KeyCodes.UP&&(n=1),n){var o=this.getValue();this.displayMouseOrKeyboardValue_(o+n*this.round_),t.preventDefault(),t.stopPropagation()}},e.FieldAngle.prototype.doClassValidation_=function(t){return t=Number(t),isNaN(t)||!isFinite(t)?null:this.wrapValue_(t)},e.FieldAngle.prototype.wrapValue_=function(t){return 0>(t%=360)&&(t+=360),t>this.wrap_&&(t-=360),t},e.Css.register(".blocklyAngleCircle {,stroke: #444;,stroke-width: 1;,fill: #ddd;,fill-opacity: .8;,},.blocklyAngleMarks {,stroke: #444;,stroke-width: 1;,},.blocklyAngleGauge {,fill: #f88;,fill-opacity: .8;,pointer-events: none;,},.blocklyAngleLine {,stroke: #f00;,stroke-width: 2;,stroke-linecap: round;,pointer-events: none;,}".split(",")),e.fieldRegistry.register("field_angle",e.FieldAngle),e.FieldCheckbox=function(t,n,o){this.checkChar_=null,e.FieldCheckbox.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.FieldCheckbox,e.Field),e.FieldCheckbox.prototype.DEFAULT_VALUE=!1,e.FieldCheckbox.fromJson=function(t){return new e.FieldCheckbox(t.checked,void 0,t)},e.FieldCheckbox.CHECK_CHAR="\u2713",e.FieldCheckbox.prototype.SERIALIZABLE=!0,e.FieldCheckbox.prototype.CURSOR="default",e.FieldCheckbox.prototype.configure_=function(t){e.FieldCheckbox.superClass_.configure_.call(this,t),t.checkCharacter&&(this.checkChar_=t.checkCharacter)},e.FieldCheckbox.prototype.initView=function(){e.FieldCheckbox.superClass_.initView.call(this),e.utils.dom.addClass(this.textElement_,"blocklyCheckbox"),this.textElement_.style.display=this.value_?"block":"none"},e.FieldCheckbox.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)},e.FieldCheckbox.prototype.getDisplayText_=function(){return this.checkChar_||e.FieldCheckbox.CHECK_CHAR},e.FieldCheckbox.prototype.setCheckCharacter=function(t){this.checkChar_=t,this.forceRerender()},e.FieldCheckbox.prototype.showEditor_=function(){this.setValue(!this.value_)},e.FieldCheckbox.prototype.doClassValidation_=function(t){return!0===t||"TRUE"===t?"TRUE":!1===t||"FALSE"===t?"FALSE":null},e.FieldCheckbox.prototype.doValueUpdate_=function(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")},e.FieldCheckbox.prototype.getValue=function(){return this.value_?"TRUE":"FALSE"},e.FieldCheckbox.prototype.getValueBoolean=function(){return this.value_},e.FieldCheckbox.prototype.getText=function(){return String(this.convertValueToBool_(this.value_))},e.FieldCheckbox.prototype.convertValueToBool_=function(t){return"string"==typeof t?"TRUE"==t:!!t},e.fieldRegistry.register("field_checkbox",e.FieldCheckbox),e.FieldColour=function(t,n,o){e.FieldColour.superClass_.constructor.call(this,t,n,o),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null},e.utils.object.inherits(e.FieldColour,e.Field),e.FieldColour.fromJson=function(t){return new e.FieldColour(t.colour,void 0,t)},e.FieldColour.prototype.SERIALIZABLE=!0,e.FieldColour.prototype.CURSOR="default",e.FieldColour.prototype.isDirty_=!1,e.FieldColour.prototype.colours_=null,e.FieldColour.prototype.titles_=null,e.FieldColour.prototype.columns_=0,e.FieldColour.prototype.configure_=function(t){e.FieldColour.superClass_.configure_.call(this,t),t.colourOptions&&(this.colours_=t.colourOptions,this.titles_=t.colourTitles),t.columns&&(this.columns_=t.columns)},e.FieldColour.prototype.initView=function(){this.size_=new e.utils.Size(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.clickTarget_=this.sourceBlock_.getSvgRoot():(this.createBorderRect_(),this.borderRect_.style.fillOpacity="1")},e.FieldColour.prototype.applyColour=function(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())},e.FieldColour.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:e.utils.colour.parse(t)},e.FieldColour.prototype.doValueUpdate_=function(t){this.value_=t,this.borderRect_?this.borderRect_.style.fill=t:this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",t),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))},e.FieldColour.prototype.getText=function(){var t=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(t)&&(t="#"+t[1]+t[3]+t[5]),t},e.FieldColour.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),e.FieldColour.prototype.DEFAULT_VALUE=e.FieldColour.COLOURS[0],e.FieldColour.TITLES=[],e.FieldColour.COLUMNS=7,e.FieldColour.prototype.setColours=function(t,n){return this.colours_=t,n&&(this.titles_=n),this},e.FieldColour.prototype.setColumns=function(t){return this.columns_=t,this},e.FieldColour.prototype.showEditor_=function(){this.dropdownCreate_(),e.DropDownDiv.getContentDiv().appendChild(this.picker_),e.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:!0})},e.FieldColour.prototype.onClick_=function(t){null!==(t=(t=t.target)&&t.label)&&(this.setValue(t),e.DropDownDiv.hideIfOwner(this))},e.FieldColour.prototype.onKeyDown_=function(t){var n=!1;t.keyCode===e.utils.KeyCodes.UP?(this.moveHighlightBy_(0,-1),n=!0):t.keyCode===e.utils.KeyCodes.DOWN?(this.moveHighlightBy_(0,1),n=!0):t.keyCode===e.utils.KeyCodes.LEFT?(this.moveHighlightBy_(-1,0),n=!0):t.keyCode===e.utils.KeyCodes.RIGHT?(this.moveHighlightBy_(1,0),n=!0):t.keyCode===e.utils.KeyCodes.ENTER&&((n=this.getHighlighted_())&&null!==(n=n&&n.label)&&this.setValue(n),e.DropDownDiv.hideWithoutAnimation(),n=!0),n&&t.stopPropagation()},e.FieldColour.prototype.moveHighlightBy_=function(t,n){var o=this.colours_||e.FieldColour.COLOURS,r=this.columns_||e.FieldColour.COLUMNS,a=this.highlightedIndex_%r,h=Math.floor(this.highlightedIndex_/r);a+=t,h+=n,0>t?0>a&&0<h?(a=r-1,h--):0>a&&(a=0):0<t?a>r-1&&h<Math.floor(o.length/r)-1?(a=0,h++):a>r-1&&a--:0>n?0>h&&(h=0):0<n&&h>Math.floor(o.length/r)-1&&(h=Math.floor(o.length/r)-1),this.setHighlightedCell_(this.picker_.childNodes[h].childNodes[a],h*r+a)},e.FieldColour.prototype.onMouseMove_=function(t){var n=(t=t.target)&&Number(t.getAttribute("data-index"));null!==n&&n!==this.highlightedIndex_&&this.setHighlightedCell_(t,n)},e.FieldColour.prototype.onMouseEnter_=function(){this.picker_.focus({preventScroll:!0})},e.FieldColour.prototype.onMouseLeave_=function(){this.picker_.blur();var t=this.getHighlighted_();t&&e.utils.dom.removeClass(t,"blocklyColourHighlighted")},e.FieldColour.prototype.getHighlighted_=function(){var t=this.columns_||e.FieldColour.COLUMNS,n=this.picker_.childNodes[Math.floor(this.highlightedIndex_/t)];return n?n.childNodes[this.highlightedIndex_%t]:null},e.FieldColour.prototype.setHighlightedCell_=function(t,n){var o=this.getHighlighted_();o&&e.utils.dom.removeClass(o,"blocklyColourHighlighted"),e.utils.dom.addClass(t,"blocklyColourHighlighted"),this.highlightedIndex_=n,e.utils.aria.setState(this.picker_,e.utils.aria.State.ACTIVEDESCENDANT,t.getAttribute("id"))},e.FieldColour.prototype.dropdownCreate_=function(){var t=this.columns_||e.FieldColour.COLUMNS,n=this.colours_||e.FieldColour.COLOURS,o=this.titles_||e.FieldColour.TITLES,r=this.getValue(),a=document.createElement("table");a.className="blocklyColourTable",a.tabIndex=0,a.dir="ltr",e.utils.aria.setRole(a,e.utils.aria.Role.GRID),e.utils.aria.setState(a,e.utils.aria.State.EXPANDED,!0),e.utils.aria.setState(a,e.utils.aria.State.ROWCOUNT,Math.floor(n.length/t)),e.utils.aria.setState(a,e.utils.aria.State.COLCOUNT,t);for(var h,R=0;R<n.length;R++){R%t==0&&(h=document.createElement("tr"),e.utils.aria.setRole(h,e.utils.aria.Role.ROW),a.appendChild(h));var L=document.createElement("td");h.appendChild(L),L.label=n[R],L.title=o[R]||n[R],L.id=e.utils.IdGenerator.getNextUniqueId(),L.setAttribute("data-index",R),e.utils.aria.setRole(L,e.utils.aria.Role.GRIDCELL),e.utils.aria.setState(L,e.utils.aria.State.LABEL,n[R]),e.utils.aria.setState(L,e.utils.aria.State.SELECTED,n[R]==r),L.style.backgroundColor=n[R],n[R]==r&&(L.className="blocklyColourSelected",this.highlightedIndex_=R)}this.onClickWrapper_=e.browserEvents.conditionalBind(a,"click",this,this.onClick_,!0),this.onMouseMoveWrapper_=e.browserEvents.conditionalBind(a,"mousemove",this,this.onMouseMove_,!0),this.onMouseEnterWrapper_=e.browserEvents.conditionalBind(a,"mouseenter",this,this.onMouseEnter_,!0),this.onMouseLeaveWrapper_=e.browserEvents.conditionalBind(a,"mouseleave",this,this.onMouseLeave_,!0),this.onKeyDownWrapper_=e.browserEvents.conditionalBind(a,"keydown",this,this.onKeyDown_),this.picker_=a},e.FieldColour.prototype.dropdownDispose_=function(){this.onClickWrapper_&&(e.browserEvents.unbind(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(e.browserEvents.unbind(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(e.browserEvents.unbind(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(e.browserEvents.unbind(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(e.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null},e.Css.register([".blocklyColourTable {","border-collapse: collapse;","display: block;","outline: none;","padding: 1px;","}",".blocklyColourTable>tr>td {","border: .5px solid #888;","box-sizing: border-box;","cursor: pointer;","display: inline-block;","height: 20px;","padding: 0;","width: 20px;","}",".blocklyColourTable>tr>td.blocklyColourHighlighted {","border-color: #eee;","box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);","position: relative;","}",".blocklyColourSelected, .blocklyColourSelected:hover {","border-color: #eee !important;","outline: 1px solid #333;","position: relative;","}"]),e.fieldRegistry.register("field_colour",e.FieldColour),e.FieldDropdown=function(t,n,o){"function"!=typeof t&&e.FieldDropdown.validateOptions_(t),this.menuGenerator_=t,this.suffixField=this.prefixField=this.generatedOptions_=null,this.trimOptions_(),this.selectedOption_=this.getOptions(!1)[0],e.FieldDropdown.superClass_.constructor.call(this,this.selectedOption_[1],n,o),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null},e.utils.object.inherits(e.FieldDropdown,e.Field),e.FieldDropdown.fromJson=function(t){return new e.FieldDropdown(t.options,void 0,t)},e.FieldDropdown.prototype.fromXml=function(t){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t.textContent)},e.FieldDropdown.prototype.SERIALIZABLE=!0,e.FieldDropdown.CHECKMARK_OVERHANG=25,e.FieldDropdown.MAX_MENU_HEIGHT_VH=.45,e.FieldDropdown.IMAGE_Y_OFFSET=5,e.FieldDropdown.IMAGE_Y_PADDING=2*e.FieldDropdown.IMAGE_Y_OFFSET,e.FieldDropdown.ARROW_CHAR=e.utils.userAgent.ANDROID?"\u25bc":"\u25be",e.FieldDropdown.prototype.CURSOR="default",e.FieldDropdown.prototype.initView=function(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&e.utils.dom.addClass(this.borderRect_,"blocklyDropdownRect")},e.FieldDropdown.prototype.shouldAddBorderRect_=function(){return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!this.sourceBlock_.isShadow()},e.FieldDropdown.prototype.createTextArrow_=function(){this.arrow_=e.utils.dom.createSvgElement(e.utils.Svg.TSPAN,{},this.textElement_),this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?e.FieldDropdown.ARROW_CHAR+" ":" "+e.FieldDropdown.ARROW_CHAR)),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textContent_):this.textElement_.appendChild(this.arrow_)},e.FieldDropdown.prototype.createSVGArrow_=function(){this.svgArrow_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)},e.FieldDropdown.prototype.showEditor_=function(t){if(this.dropdownCreate_(),this.menu_.openingCoords=t&&"number"==typeof t.clientX?new e.utils.Coordinate(t.clientX,t.clientY):null,this.menu_.render(e.DropDownDiv.getContentDiv()),t=this.menu_.getElement(),e.utils.dom.addClass(t,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV){t=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().getColour():this.sourceBlock_.getColour();var n=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;e.DropDownDiv.setColour(t,n)}e.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()},e.FieldDropdown.prototype.dropdownCreate_=function(){var t=new e.Menu;t.setRole(e.utils.aria.Role.LISTBOX),this.menu_=t;var n=this.getOptions(!1);this.selectedMenuItem_=null;for(var o=0;o<n.length;o++){var r=n[o][0],a=n[o][1];if("object"==typeof r){var h=new Image(r.width,r.height);h.src=r.src,h.alt=r.alt||"",r=h}(r=new e.MenuItem(r,a)).setRole(e.utils.aria.Role.OPTION),r.setRightToLeft(this.sourceBlock_.RTL),r.setCheckable(!0),t.addChild(r),r.setChecked(a==this.value_),a==this.value_&&(this.selectedMenuItem_=r),r.onAction(this.handleMenuActionEvent_,this)}},e.FieldDropdown.prototype.dropdownDispose_=function(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()},e.FieldDropdown.prototype.handleMenuActionEvent_=function(t){e.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,t)},e.FieldDropdown.prototype.onItemSelected_=function(t,n){this.setValue(n.getValue())},e.FieldDropdown.prototype.trimOptions_=function(){var t=this.menuGenerator_;if(Array.isArray(t)){for(var n=!1,o=0;o<t.length;o++){var r=t[o][0];"string"==typeof r?t[o][0]=e.utils.replaceMessageReferences(r):(null!=r.alt&&(t[o][0].alt=e.utils.replaceMessageReferences(r.alt)),n=!0)}if(!(n||2>t.length)){for(n=[],o=0;o<t.length;o++)n.push(t[o][0]);o=e.utils.string.shortestStringLength(n),r=e.utils.string.commonWordPrefix(n,o);var a=e.utils.string.commonWordSuffix(n,o);!r&&!a||o<=r+a||(r&&(this.prefixField=n[0].substring(0,r-1)),a&&(this.suffixField=n[0].substr(1-a)),this.menuGenerator_=e.FieldDropdown.applyTrim_(t,r,a))}}},e.FieldDropdown.applyTrim_=function(t,n,o){for(var r=[],a=0;a<t.length;a++){var h=t[a][0],R=t[a][1];h=h.substring(n,h.length-o),r[a]=[h,R]}return r},e.FieldDropdown.prototype.isOptionListDynamic=function(){return"function"==typeof this.menuGenerator_},e.FieldDropdown.prototype.getOptions=function(t){return this.isOptionListDynamic()?(this.generatedOptions_&&t||(this.generatedOptions_=this.menuGenerator_.call(this),e.FieldDropdown.validateOptions_(this.generatedOptions_)),this.generatedOptions_):this.menuGenerator_},e.FieldDropdown.prototype.doClassValidation_=function(t){for(var a,n=!1,o=this.getOptions(!0),r=0;a=o[r];r++)if(a[1]==t){n=!0;break}return n?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)},e.FieldDropdown.prototype.doValueUpdate_=function(t){e.FieldDropdown.superClass_.doValueUpdate_.call(this,t),t=this.getOptions(!0);for(var o,n=0;o=t[n];n++)o[1]==this.value_&&(this.selectedOption_=o)},e.FieldDropdown.prototype.applyColour=function(){this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary),this.borderRect_.setAttribute("fill",this.menu_?this.sourceBlock_.style.colourTertiary:"transparent")),this.sourceBlock_&&this.arrow_&&(this.arrow_.style.fill=this.sourceBlock_.isShadow()?this.sourceBlock_.style.colourSecondary:this.sourceBlock_.style.colourPrimary)},e.FieldDropdown.prototype.render_=function(){this.textContent_.nodeValue="",this.imageElement_.style.display="none";var t=this.selectedOption_&&this.selectedOption_[0];t&&"object"==typeof t?this.renderSelectedImage_(t):this.renderSelectedText_(),this.positionBorderRect_()},e.FieldDropdown.prototype.renderSelectedImage_=function(t){this.imageElement_.style.display="",this.imageElement_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",t.src),this.imageElement_.setAttribute("height",t.height),this.imageElement_.setAttribute("width",t.width);var n=Number(t.height);t=Number(t.width);var o=!!this.borderRect_,r=Math.max(o?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,n+e.FieldDropdown.IMAGE_Y_PADDING);o=o?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var a=this.svgArrow_?this.positionSVGArrow_(t+o,r/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):e.utils.dom.getFastTextWidth(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);this.size_.width=t+a+2*o,this.size_.height=r;var h=0;this.sourceBlock_.RTL?this.imageElement_.setAttribute("x",o+a):(h=t+a,this.textElement_.setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",o)),this.imageElement_.setAttribute("y",r/2-n/2),this.positionTextElement_(h+o,t+a)},e.FieldDropdown.prototype.renderSelectedText_=function(){this.textContent_.nodeValue=this.getDisplayText_(),e.utils.dom.addClass(this.textElement_,"blocklyDropdownText"),this.textElement_.setAttribute("text-anchor","start");var t=!!this.borderRect_,n=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT),o=e.utils.dom.getFastTextWidth(this.textElement_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var r=0;this.svgArrow_&&(r=this.positionSVGArrow_(o+t,n/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=o+r+2*t,this.size_.height=n,this.positionTextElement_(t,o)},e.FieldDropdown.prototype.positionSVGArrow_=function(t,n){if(!this.svgArrow_)return 0;var o=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,r=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,a=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(this.sourceBlock_.RTL?o:t+r)+","+n+")"),a+r},e.FieldDropdown.prototype.getText_=function(){if(!this.selectedOption_)return null;var t=this.selectedOption_[0];return"object"==typeof t?t.alt:t},e.FieldDropdown.validateOptions_=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");for(var n=!1,o=0;o<t.length;++o){var r=t[o];Array.isArray(r)?"string"!=typeof r[1]?(n=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option id must be a string. Found "+r[1]+" in: ",r)):r[0]&&"string"!=typeof r[0]&&"string"!=typeof r[0].src&&(n=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option must have a string label or image description. Found"+r[0]+" in: ",r)):(n=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option must be an array. Found: ",r))}if(n)throw TypeError("Found invalid FieldDropdown options.")},e.fieldRegistry.register("field_dropdown",e.FieldDropdown),e.FieldLabelSerializable=function(t,n,o){e.FieldLabelSerializable.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.FieldLabelSerializable,e.FieldLabel),e.FieldLabelSerializable.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldLabelSerializable(n,void 0,t)},e.FieldLabelSerializable.prototype.EDITABLE=!1,e.FieldLabelSerializable.prototype.SERIALIZABLE=!0,e.fieldRegistry.register("field_label_serializable",e.FieldLabelSerializable),e.FieldImage=function(t,n,o,r,a,h,R){if(!t)throw Error("Src value of an image field is required");if(t=e.utils.replaceMessageReferences(t),o=Number(e.utils.replaceMessageReferences(o)),n=Number(e.utils.replaceMessageReferences(n)),isNaN(o)||isNaN(n))throw Error("Height and width values of an image field must cast to numbers.");if(0>=o||0>=n)throw Error("Height and width values of an image field must be greater than 0.");this.flipRtl_=!1,this.altText_="",e.FieldImage.superClass_.constructor.call(this,t,null,R),R||(this.flipRtl_=!!h,this.altText_=e.utils.replaceMessageReferences(r)||""),this.size_=new e.utils.Size(n,o+e.FieldImage.Y_PADDING),this.imageHeight_=o,this.clickHandler_=null,"function"==typeof a&&(this.clickHandler_=a),this.imageElement_=null},e.utils.object.inherits(e.FieldImage,e.Field),e.FieldImage.prototype.DEFAULT_VALUE="",e.FieldImage.fromJson=function(t){return new e.FieldImage(t.src,t.width,t.height,void 0,void 0,void 0,t)},e.FieldImage.Y_PADDING=1,e.FieldImage.prototype.EDITABLE=!1,e.FieldImage.prototype.isDirty_=!1,e.FieldImage.prototype.configure_=function(t){e.FieldImage.superClass_.configure_.call(this,t),this.flipRtl_=!!t.flipRtl,this.altText_=e.utils.replaceMessageReferences(t.alt)||""},e.FieldImage.prototype.initView=function(){this.imageElement_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")},e.FieldImage.prototype.updateSize_=function(){},e.FieldImage.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:t},e.FieldImage.prototype.doValueUpdate_=function(t){this.value_=t,this.imageElement_&&this.imageElement_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",String(this.value_))},e.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},e.FieldImage.prototype.setAlt=function(t){t!=this.altText_&&(this.altText_=t||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))},e.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},e.FieldImage.prototype.setOnClickHandler=function(t){this.clickHandler_=t},e.FieldImage.prototype.getText_=function(){return this.altText_},e.fieldRegistry.register("field_image",e.FieldImage),e.FieldMultilineInput=function(t,n,o){e.FieldMultilineInput.superClass_.constructor.call(this,t,n,o),this.textGroup_=null,this.maxLines_=1/0,this.isOverflowedY_=!1},e.utils.object.inherits(e.FieldMultilineInput,e.FieldTextInput),e.FieldMultilineInput.prototype.configure_=function(t){e.FieldMultilineInput.superClass_.configure_.call(this,t),t.maxLines&&this.setMaxLines(t.maxLines)},e.FieldMultilineInput.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldMultilineInput(n,void 0,t)},e.FieldMultilineInput.prototype.toXml=function(t){return t.textContent=this.getValue().replace(/\n/g,"&#10;"),t},e.FieldMultilineInput.prototype.fromXml=function(t){this.setValue(t.textContent.replace(/&#10;/g,"\n"))},e.FieldMultilineInput.prototype.initView=function(){this.createBorderRect_(),this.textGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyEditableText"},this.fieldGroup_)},e.FieldMultilineInput.prototype.getDisplayText_=function(){var t=this.getText();if(!t)return e.Field.NBSP;var n=t.split("\n");t="";for(var o=this.isOverflowedY_?this.maxLines_:n.length,r=0;r<o;r++){var a=n[r];a.length>this.maxDisplayLength?a=a.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&r===o-1&&(a=a.substring(0,a.length-3)+"..."),t+=a=a.replace(/\s/g,e.Field.NBSP),r!==o-1&&(t+="\n")}return this.sourceBlock_.RTL&&(t+="\u200f"),t},e.FieldMultilineInput.prototype.doValueUpdate_=function(t){e.FieldMultilineInput.superClass_.doValueUpdate_.call(this,t),this.isOverflowedY_=this.value_.split("\n").length>this.maxLines_},e.FieldMultilineInput.prototype.render_=function(){for(var t;t=this.textGroup_.firstChild;)this.textGroup_.removeChild(t);t=this.getDisplayText_().split("\n");for(var n=0,o=0;o<t.length;o++){var r=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:n+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(t[o])),n+=r}this.isBeingEdited_&&(t=this.htmlInput_,this.isOverflowedY_?e.utils.dom.addClass(t,"blocklyHtmlTextAreaInputOverflowedY"):e.utils.dom.removeClass(t,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(this.sourceBlock_.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),t=this.htmlInput_,this.isTextValid_?(e.utils.dom.removeClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!1)):(e.utils.dom.addClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!0)))},e.FieldMultilineInput.prototype.updateSize_=function(){for(var t=this.textGroup_.childNodes,n=0,o=0,r=0;r<t.length;r++){var a=e.utils.dom.getTextWidth(t[r]);a>n&&(n=a),o+=this.getConstants().FIELD_TEXT_HEIGHT+(0<r?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){t=this.value_.split("\n"),a=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText"});var h=this.getConstants().FIELD_TEXT_FONTSIZE,R=this.getConstants().FIELD_TEXT_FONTWEIGHT,L=this.getConstants().FIELD_TEXT_FONTFAMILY;for(r=0;r<t.length;r++){t[r].length>this.maxDisplayLength&&(t[r]=t[r].substring(0,this.maxDisplayLength)),a.textContent=t[r];var W=e.utils.dom.getFastTextWidth(a,h,R,L);W>n&&(n=W)}n+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(o+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,n+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",n),this.borderRect_.setAttribute("height",o)),this.size_.width=n,this.size_.height=o,this.positionBorderRect_()},e.FieldMultilineInput.prototype.showEditor_=function(t,n){e.FieldMultilineInput.superClass_.showEditor_.call(this,t,n),this.forceRerender()},e.FieldMultilineInput.prototype.widgetCreate_=function(){var t=e.WidgetDiv.DIV,n=this.workspace_.getScale(),o=document.createElement("textarea");o.className="blocklyHtmlInput blocklyHtmlTextAreaInput",o.setAttribute("spellcheck",this.spellcheck_);var r=this.getConstants().FIELD_TEXT_FONTSIZE*n+"pt";t.style.fontSize=r,o.style.fontSize=r,o.style.borderRadius=e.FieldTextInput.BORDERRADIUS*n+"px",r=this.getConstants().FIELD_BORDER_RECT_X_PADDING*n;var a=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*n/2;return o.style.padding=a+"px "+r+"px "+a+"px "+r+"px",r=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,o.style.lineHeight=r*n+"px",t.appendChild(o),o.value=o.defaultValue=this.getEditorText_(this.value_),o.untypedDefaultValue_=this.value_,o.oldValue_=null,e.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(o),o},e.FieldMultilineInput.prototype.setMaxLines=function(t){"number"==typeof t&&0<t&&t!==this.maxLines_&&(this.maxLines_=t,this.forceRerender())},e.FieldMultilineInput.prototype.getMaxLines=function(){return this.maxLines_},e.FieldMultilineInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode!==e.utils.KeyCodes.ENTER&&e.FieldMultilineInput.superClass_.onHtmlInputKeyDown_.call(this,t)},e.Css.register(".blocklyHtmlTextAreaInput {,font-family: monospace;,resize: none;,overflow: hidden;,height: 100%;,text-align: left;,},.blocklyHtmlTextAreaInputOverflowedY {,overflow-y: scroll;,}".split(",")),e.fieldRegistry.register("field_multilinetext",e.FieldMultilineInput),e.FieldNumber=function(t,n,o,r,a,h){this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,e.FieldNumber.superClass_.constructor.call(this,t,a,h),h||this.setConstraints(n,o,r)},e.utils.object.inherits(e.FieldNumber,e.FieldTextInput),e.FieldNumber.prototype.DEFAULT_VALUE=0,e.FieldNumber.fromJson=function(t){return new e.FieldNumber(t.value,void 0,void 0,void 0,void 0,t)},e.FieldNumber.prototype.SERIALIZABLE=!0,e.FieldNumber.prototype.configure_=function(t){e.FieldNumber.superClass_.configure_.call(this,t),this.setMinInternal_(t.min),this.setMaxInternal_(t.max),this.setPrecisionInternal_(t.precision)},e.FieldNumber.prototype.setConstraints=function(t,n,o){this.setMinInternal_(t),this.setMaxInternal_(n),this.setPrecisionInternal_(o),this.setValue(this.getValue())},e.FieldNumber.prototype.setMin=function(t){this.setMinInternal_(t),this.setValue(this.getValue())},e.FieldNumber.prototype.setMinInternal_=function(t){null==t?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))},e.FieldNumber.prototype.getMin=function(){return this.min_},e.FieldNumber.prototype.setMax=function(t){this.setMaxInternal_(t),this.setValue(this.getValue())},e.FieldNumber.prototype.setMaxInternal_=function(t){null==t?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))},e.FieldNumber.prototype.getMax=function(){return this.max_},e.FieldNumber.prototype.setPrecision=function(t){this.setPrecisionInternal_(t),this.setValue(this.getValue())},e.FieldNumber.prototype.setPrecisionInternal_=function(t){this.precision_=Number(t)||0;var n=String(this.precision_);-1!=n.indexOf("e")&&(n=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));var o=n.indexOf(".");this.decimalPlaces_=-1==o?t?0:null:n.length-o-1},e.FieldNumber.prototype.getPrecision=function(){return this.precision_},e.FieldNumber.prototype.doClassValidation_=function(t){return null===t||(t=(t=(t=(t=String(t)).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),t=Number(t||0),isNaN(t))?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),null!=this.decimalPlaces_&&(t=Number(t.toFixed(this.decimalPlaces_))),t)},e.FieldNumber.prototype.widgetCreate_=function(){var t=e.FieldNumber.superClass_.widgetCreate_.call(this);return-1/0<this.min_&&e.utils.aria.setState(t,e.utils.aria.State.VALUEMIN,this.min_),1/0>this.max_&&e.utils.aria.setState(t,e.utils.aria.State.VALUEMAX,this.max_),t},e.fieldRegistry.register("field_number",e.FieldNumber),e.FieldVariable=function(t,n,o,r,a){this.menuGenerator_=e.FieldVariable.dropdownCreate,this.defaultVariableName="string"==typeof t?t:"",this.size_=new e.utils.Size(0,0),a&&this.configure_(a),n&&this.setValidator(n),a||this.setTypes_(o,r)},e.utils.object.inherits(e.FieldVariable,e.FieldDropdown),e.FieldVariable.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.variable);return new e.FieldVariable(n,void 0,void 0,void 0,t)},e.FieldVariable.prototype.SERIALIZABLE=!0,e.FieldVariable.prototype.configure_=function(t){e.FieldVariable.superClass_.configure_.call(this,t),this.setTypes_(t.variableTypes,t.defaultType)},e.FieldVariable.prototype.initModel=function(){if(!this.variable_){var t=e.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,null,this.defaultVariableName,this.defaultType_);this.doValueUpdate_(t.getId())}},e.FieldVariable.prototype.shouldAddBorderRect_=function(){return e.FieldVariable.superClass_.shouldAddBorderRect_.call(this)&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!=this.sourceBlock_.type)},e.FieldVariable.prototype.fromXml=function(t){var n=t.getAttribute("id"),o=t.textContent,r=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(n=e.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,n,o,r),null!=r&&r!==n.type)throw Error("Serialized variable type with id '"+n.getId()+"' had type "+n.type+", and does not match variable field that references it: "+e.Xml.domToText(t)+".");this.setValue(n.getId())},e.FieldVariable.prototype.toXml=function(t){return this.initModel(),t.id=this.variable_.getId(),t.textContent=this.variable_.name,this.variable_.type&&t.setAttribute("variabletype",this.variable_.type),t},e.FieldVariable.prototype.setSourceBlock=function(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");e.FieldVariable.superClass_.setSourceBlock.call(this,t)},e.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null},e.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""},e.FieldVariable.prototype.getVariable=function(){return this.variable_},e.FieldVariable.prototype.getValidator=function(){return this.variable_?this.validator_:null},e.FieldVariable.prototype.doClassValidation_=function(t){if(null===t)return null;var n=e.Variables.getVariable(this.sourceBlock_.workspace,t);return n?this.typeIsAllowed_(n=n.type)?t:(console.warn("Variable type doesn't match this field!  Type was "+n),null):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)},e.FieldVariable.prototype.doValueUpdate_=function(t){this.variable_=e.Variables.getVariable(this.sourceBlock_.workspace,t),e.FieldVariable.superClass_.doValueUpdate_.call(this,t)},e.FieldVariable.prototype.typeIsAllowed_=function(t){var n=this.getVariableTypes_();if(!n)return!0;for(var o=0;o<n.length;o++)if(t==n[o])return!0;return!1},e.FieldVariable.prototype.getVariableTypes_=function(){var t=this.variableTypes;if(null===t&&this.sourceBlock_&&this.sourceBlock_.workspace)return this.sourceBlock_.workspace.getVariableTypes();if(0==(t=t||[""]).length)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t},e.FieldVariable.prototype.setTypes_=function(t,n){if(n=n||"",null==t||null==t)t=null;else{if(!Array.isArray(t))throw Error("'variableTypes' was not an array in the definition of a FieldVariable");for(var o=!1,r=0;r<t.length;r++)t[r]==n&&(o=!0);if(!o)throw Error("Invalid default type '"+n+"' in the definition of a FieldVariable")}this.defaultType_=n,this.variableTypes=t},e.FieldVariable.prototype.refreshVariableName=function(){this.forceRerender()},e.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var t=this.getText(),n=[];if(this.sourceBlock_&&this.sourceBlock_.workspace)for(var o=this.getVariableTypes_(),r=0;r<o.length;r++){var a=this.sourceBlock_.workspace.getVariablesOfType(o[r]);n=n.concat(a)}for(n.sort(e.VariableModel.compareByName),o=[],r=0;r<n.length;r++)o[r]=[n[r].name,n[r].getId()];return o.push([e.Msg.RENAME_VARIABLE,e.RENAME_VARIABLE_ID]),e.Msg.DELETE_VARIABLE&&o.push([e.Msg.DELETE_VARIABLE.replace("%1",t),e.DELETE_VARIABLE_ID]),o},e.FieldVariable.prototype.onItemSelected_=function(t,n){if(t=n.getValue(),this.sourceBlock_&&this.sourceBlock_.workspace){if(t==e.RENAME_VARIABLE_ID)return void e.Variables.renameVariable(this.sourceBlock_.workspace,this.variable_);if(t==e.DELETE_VARIABLE_ID)return void this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId())}this.setValue(t)},e.FieldVariable.prototype.referencesVariables=function(){return!0},e.fieldRegistry.register("field_variable",e.FieldVariable),e.utils.svgPaths={},e.utils.svgPaths.point=function(t,n){return" "+t+","+n+" "},e.utils.svgPaths.curve=function(t,n){return" "+t+n.join("")},e.utils.svgPaths.moveTo=function(t,n){return" M "+t+","+n+" "},e.utils.svgPaths.moveBy=function(t,n){return" m "+t+","+n+" "},e.utils.svgPaths.lineTo=function(t,n){return" l "+t+","+n+" "},e.utils.svgPaths.line=function(t){return" l"+t.join("")},e.utils.svgPaths.lineOnAxis=function(t,n){return" "+t+" "+n+" "},e.utils.svgPaths.arc=function(t,n,o,r){return t+" "+o+" "+o+" "+n+r},e.blockRendering.ConstantProvider=function(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.CORNER_RADIUS=8,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=e.utils.svgPaths.moveBy(0,0),this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_TEXT_BASELINE_CENTER=!e.utils.userAgent.IE&&!e.utils.userAgent.EDGE,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2),this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2}},e.blockRendering.ConstantProvider.prototype.init=function(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()},e.blockRendering.ConstantProvider.prototype.setTheme=function(t){this.blockStyles=Object.create(null);var o,n=t.blockStyles;for(o in n)this.blockStyles[o]=this.validatedBlockStyle_(n[o]);this.setDynamicProperties_(t)},e.blockRendering.ConstantProvider.prototype.setDynamicProperties_=function(t){this.setFontConstants_(t),this.setComponentConstants_(t),this.ADD_START_HATS=null!=t.startHats?t.startHats:this.ADD_START_HATS},e.blockRendering.ConstantProvider.prototype.setFontConstants_=function(t){this.FIELD_TEXT_FONTFAMILY=t.fontStyle&&null!=t.fontStyle.family?t.fontStyle.family:this.FIELD_TEXT_FONTFAMILY,this.FIELD_TEXT_FONTWEIGHT=t.fontStyle&&null!=t.fontStyle.weight?t.fontStyle.weight:this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTSIZE=t.fontStyle&&null!=t.fontStyle.size?t.fontStyle.size:this.FIELD_TEXT_FONTSIZE,t=e.utils.dom.measureFontMetrics("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=t.height,this.FIELD_TEXT_BASELINE=t.baseline},e.blockRendering.ConstantProvider.prototype.setComponentConstants_=function(t){this.CURSOR_COLOUR=t.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=t.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=t.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(t.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY},e.blockRendering.ConstantProvider.prototype.getBlockStyleForColour=function(t){var n="auto_"+t;return this.blockStyles[n]||(this.blockStyles[n]=this.createBlockStyle_(t)),{style:this.blockStyles[n],name:n}},e.blockRendering.ConstantProvider.prototype.getBlockStyle=function(t){return this.blockStyles[t||""]||(t&&0==t.indexOf("auto_")?this.getBlockStyleForColour(t.substring(5)).style:this.createBlockStyle_("#000000"))},e.blockRendering.ConstantProvider.prototype.createBlockStyle_=function(t){return this.validatedBlockStyle_({colourPrimary:t})},e.blockRendering.ConstantProvider.prototype.validatedBlockStyle_=function(t){var n={};return t&&e.utils.object.mixin(n,t),t=e.utils.parseBlockColour(n.colourPrimary||"#000"),n.colourPrimary=t.hex,n.colourSecondary=n.colourSecondary?e.utils.parseBlockColour(n.colourSecondary).hex:this.generateSecondaryColour_(n.colourPrimary),n.colourTertiary=n.colourTertiary?e.utils.parseBlockColour(n.colourTertiary).hex:this.generateTertiaryColour_(n.colourPrimary),n.hat=n.hat||"",n},e.blockRendering.ConstantProvider.prototype.generateSecondaryColour_=function(t){return e.utils.colour.blend("#fff",t,.6)||t},e.blockRendering.ConstantProvider.prototype.generateTertiaryColour_=function(t){return e.utils.colour.blend("#fff",t,.3)||t},e.blockRendering.ConstantProvider.prototype.dispose=function(){this.embossFilter_&&e.utils.dom.removeNode(this.embossFilter_),this.disabledPattern_&&e.utils.dom.removeNode(this.disabledPattern_),this.debugFilter_&&e.utils.dom.removeNode(this.debugFilter_),this.cssNode_=null},e.blockRendering.ConstantProvider.prototype.makeJaggedTeeth=function(){var t=this.JAGGED_TEETH_HEIGHT,n=this.JAGGED_TEETH_WIDTH;return{height:t,width:n,path:e.utils.svgPaths.line([e.utils.svgPaths.point(n,t/4),e.utils.svgPaths.point(2*-n,t/2),e.utils.svgPaths.point(n,t/4)])}},e.blockRendering.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,n=this.START_HAT_WIDTH;return{height:t,width:n,path:e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(30,-t),e.utils.svgPaths.point(70,-t),e.utils.svgPaths.point(n,0)])}},e.blockRendering.ConstantProvider.prototype.makePuzzleTab=function(){function t(h){var R=-(h=h?-1:1),L=o/2,W=L+2.5,nt=L+.5,et=e.utils.svgPaths.point(-n,h*L);return L=e.utils.svgPaths.point(n,h*L),e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(0,h*W),e.utils.svgPaths.point(-n,R*nt),et])+e.utils.svgPaths.curve("s",[e.utils.svgPaths.point(n,2.5*R),L])}var n=this.TAB_WIDTH,o=this.TAB_HEIGHT,r=t(!0),a=t(!1);return{type:this.SHAPES.PUZZLE,width:n,height:o,pathDown:a,pathUp:r}},e.blockRendering.ConstantProvider.prototype.makeNotch=function(){function t(R){return e.utils.svgPaths.line([e.utils.svgPaths.point(R*r,o),e.utils.svgPaths.point(3*R,0),e.utils.svgPaths.point(R*r,-o)])}var n=this.NOTCH_WIDTH,o=this.NOTCH_HEIGHT,r=(n-3)/2,a=t(1),h=t(-1);return{type:this.SHAPES.NOTCH,width:n,height:o,pathLeft:a,pathRight:h}},e.blockRendering.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS;return{width:t,height:t,pathTop:e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(-t,t)),pathBottom:e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(t,t))}},e.blockRendering.ConstantProvider.prototype.makeOutsideCorners=function(){var t=this.CORNER_RADIUS,n=e.utils.svgPaths.moveBy(0,t)+e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(t,-t)),o=e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(t,t)),r=e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(-t,-t));return{topLeft:n,topRight:o,bottomRight:e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(-t,t)),bottomLeft:r,rightHeight:t}},e.blockRendering.ConstantProvider.prototype.shapeFor=function(t){switch(t.type){case e.connectionTypes.INPUT_VALUE:case e.connectionTypes.OUTPUT_VALUE:return this.PUZZLE_TAB;case e.connectionTypes.PREVIOUS_STATEMENT:case e.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}},e.blockRendering.ConstantProvider.prototype.createDom=function(t,n,o){this.injectCSS_(n,o),t=e.utils.dom.createSvgElement(e.utils.Svg.DEFS,{},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},t),e.utils.dom.createSvgElement(e.utils.Svg.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},n),o=e.utils.dom.createSvgElement(e.utils.Svg.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},o),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},n),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},n),this.embossFilterId=n.id,this.embossFilter_=n,n=e.utils.dom.createSvgElement(e.utils.Svg.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},t),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:10,height:10,fill:"#aaa"},n),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},n),this.disabledPatternId=n.id,this.disabledPattern_=n,e.blockRendering.Debug&&(t=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},t),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.debugFilterId=t.id,this.debugFilter_=t)},e.blockRendering.ConstantProvider.prototype.injectCSS_=function(t,n){n=this.getCSS_(n),t="blockly-renderer-style-"+t,this.cssNode_=document.getElementById(t);var o=n.join("\n");this.cssNode_?this.cssNode_.firstChild.textContent=o:((n=document.createElement("style")).id=t,t=document.createTextNode(o),n.appendChild(t),document.head.insertBefore(n,document.head.firstChild),this.cssNode_=n)},e.blockRendering.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText, ",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect,",t+" .blocklyEditableText>rect {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","fill-opacity: .6;","stroke: none;","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text {","fill: #000;","}",t+" .blocklyFlyoutLabelText {","fill: #000;","}",t+" .blocklyText.blocklyBubbleText {","fill: #000;","}",t+" .blocklyEditableText:not(.editing):hover>rect {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","}",t+" .blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",t+" .blocklyHighlightedConnectionPath {","stroke: #fc3;","}",t+" .blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",t+" .blocklyReplaceable .blocklyPathLight,",t+" .blocklyReplaceable .blocklyPathDark {","display: none;","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},e.blockRendering.Types={NONE:0,FIELD:1,HAT:2,ICON:4,SPACER:8,BETWEEN_ROW_SPACER:16,IN_ROW_SPACER:32,EXTERNAL_VALUE_INPUT:64,INPUT:128,INLINE_INPUT:256,STATEMENT_INPUT:512,CONNECTION:1024,PREVIOUS_CONNECTION:2048,NEXT_CONNECTION:4096,OUTPUT_CONNECTION:8192,CORNER:16384,LEFT_SQUARE_CORNER:32768,LEFT_ROUND_CORNER:65536,RIGHT_SQUARE_CORNER:131072,RIGHT_ROUND_CORNER:262144,JAGGED_EDGE:524288,ROW:1048576,TOP_ROW:2097152,BOTTOM_ROW:4194304,INPUT_ROW:8388608},e.blockRendering.Types.LEFT_CORNER=e.blockRendering.Types.LEFT_SQUARE_CORNER|e.blockRendering.Types.LEFT_ROUND_CORNER,e.blockRendering.Types.RIGHT_CORNER=e.blockRendering.Types.RIGHT_SQUARE_CORNER|e.blockRendering.Types.RIGHT_ROUND_CORNER,e.blockRendering.Types.nextTypeValue_=16777216,e.blockRendering.Types.getType=function(t){return Object.prototype.hasOwnProperty.call(e.blockRendering.Types,t)||(e.blockRendering.Types[t]=e.blockRendering.Types.nextTypeValue_,e.blockRendering.Types.nextTypeValue_<<=1),e.blockRendering.Types[t]},e.blockRendering.Types.isField=function(t){return t.type&e.blockRendering.Types.FIELD},e.blockRendering.Types.isHat=function(t){return t.type&e.blockRendering.Types.HAT},e.blockRendering.Types.isIcon=function(t){return t.type&e.blockRendering.Types.ICON},e.blockRendering.Types.isSpacer=function(t){return t.type&e.blockRendering.Types.SPACER},e.blockRendering.Types.isInRowSpacer=function(t){return t.type&e.blockRendering.Types.IN_ROW_SPACER},e.blockRendering.Types.isInput=function(t){return t.type&e.blockRendering.Types.INPUT},e.blockRendering.Types.isExternalInput=function(t){return t.type&e.blockRendering.Types.EXTERNAL_VALUE_INPUT},e.blockRendering.Types.isInlineInput=function(t){return t.type&e.blockRendering.Types.INLINE_INPUT},e.blockRendering.Types.isStatementInput=function(t){return t.type&e.blockRendering.Types.STATEMENT_INPUT},e.blockRendering.Types.isPreviousConnection=function(t){return t.type&e.blockRendering.Types.PREVIOUS_CONNECTION},e.blockRendering.Types.isNextConnection=function(t){return t.type&e.blockRendering.Types.NEXT_CONNECTION},e.blockRendering.Types.isPreviousOrNextConnection=function(t){return t.type&(e.blockRendering.Types.PREVIOUS_CONNECTION|e.blockRendering.Types.NEXT_CONNECTION)},e.blockRendering.Types.isLeftRoundedCorner=function(t){return t.type&e.blockRendering.Types.LEFT_ROUND_CORNER},e.blockRendering.Types.isRightRoundedCorner=function(t){return t.type&e.blockRendering.Types.RIGHT_ROUND_CORNER},e.blockRendering.Types.isLeftSquareCorner=function(t){return t.type&e.blockRendering.Types.LEFT_SQUARE_CORNER},e.blockRendering.Types.isRightSquareCorner=function(t){return t.type&e.blockRendering.Types.RIGHT_SQUARE_CORNER},e.blockRendering.Types.isCorner=function(t){return t.type&e.blockRendering.Types.CORNER},e.blockRendering.Types.isJaggedEdge=function(t){return t.type&e.blockRendering.Types.JAGGED_EDGE},e.blockRendering.Types.isRow=function(t){return t.type&e.blockRendering.Types.ROW},e.blockRendering.Types.isBetweenRowSpacer=function(t){return t.type&e.blockRendering.Types.BETWEEN_ROW_SPACER},e.blockRendering.Types.isTopRow=function(t){return t.type&e.blockRendering.Types.TOP_ROW},e.blockRendering.Types.isBottomRow=function(t){return t.type&e.blockRendering.Types.BOTTOM_ROW},e.blockRendering.Types.isTopOrBottomRow=function(t){return t.type&(e.blockRendering.Types.TOP_ROW|e.blockRendering.Types.BOTTOM_ROW)},e.blockRendering.Types.isInputRow=function(t){return t.type&e.blockRendering.Types.INPUT_ROW},e.blockRendering.Measurable=function(t){this.height=this.width=0,this.type=e.blockRendering.Types.NONE,this.centerline=this.xPos=0,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT},e.blockRendering.Connection=function(t,n){e.blockRendering.Connection.superClass_.constructor.call(this,t),this.connectionModel=n,this.shape=this.constants_.shapeFor(n),this.isDynamicShape=!!this.shape.isDynamic,this.type|=e.blockRendering.Types.CONNECTION},e.utils.object.inherits(e.blockRendering.Connection,e.blockRendering.Measurable),e.blockRendering.OutputConnection=function(t,n){e.blockRendering.OutputConnection.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=0},e.utils.object.inherits(e.blockRendering.OutputConnection,e.blockRendering.Connection),e.blockRendering.PreviousConnection=function(t,n){e.blockRendering.PreviousConnection.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},e.utils.object.inherits(e.blockRendering.PreviousConnection,e.blockRendering.Connection),e.blockRendering.NextConnection=function(t,n){e.blockRendering.NextConnection.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},e.utils.object.inherits(e.blockRendering.NextConnection,e.blockRendering.Connection),e.blockRendering.InputConnection=function(t,n){e.blockRendering.InputConnection.superClass_.constructor.call(this,t,n.connection),this.type|=e.blockRendering.Types.INPUT,this.input=n,this.align=n.align,(this.connectedBlock=n.connection&&n.connection.targetBlock()?n.connection.targetBlock():null)?(t=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=t.width,this.connectedBlockHeight=t.height):this.connectedBlockHeight=this.connectedBlockWidth=0,this.connectionOffsetY=this.connectionOffsetX=0},e.utils.object.inherits(e.blockRendering.InputConnection,e.blockRendering.Connection),e.blockRendering.InlineInput=function(t,n){e.blockRendering.InlineInput.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY=this.isDynamicShape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=this.isDynamicShape?this.shape.connectionOffsetX(this.connectionWidth):0},e.utils.object.inherits(e.blockRendering.InlineInput,e.blockRendering.InputConnection),e.blockRendering.StatementInput=function(t,n){e.blockRendering.StatementInput.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width},e.utils.object.inherits(e.blockRendering.StatementInput,e.blockRendering.InputConnection),e.blockRendering.ExternalValueInput=function(t,n){e.blockRendering.ExternalValueInput.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width},e.utils.object.inherits(e.blockRendering.ExternalValueInput,e.blockRendering.InputConnection),e.blockRendering.Icon=function(t,n){e.blockRendering.Icon.superClass_.constructor.call(this,t),this.icon=n,this.isVisible=n.isVisible(),this.type|=e.blockRendering.Types.ICON,t=n.getCorrectedSize(),this.height=t.height,this.width=t.width},e.utils.object.inherits(e.blockRendering.Icon,e.blockRendering.Measurable),e.blockRendering.JaggedEdge=function(t){e.blockRendering.JaggedEdge.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width},e.utils.object.inherits(e.blockRendering.JaggedEdge,e.blockRendering.Measurable),e.blockRendering.Field=function(t,n,o){e.blockRendering.Field.superClass_.constructor.call(this,t),this.field=n,this.isEditable=n.EDITABLE,this.flipRtl=n.getFlipRtl(),this.type|=e.blockRendering.Types.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width,this.parentInput=o},e.utils.object.inherits(e.blockRendering.Field,e.blockRendering.Measurable),e.blockRendering.Hat=function(t){e.blockRendering.Hat.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height},e.utils.object.inherits(e.blockRendering.Hat,e.blockRendering.Measurable),e.blockRendering.SquareCorner=function(t,n){e.blockRendering.SquareCorner.superClass_.constructor.call(this,t),this.type=(n&&"left"!=n?e.blockRendering.Types.RIGHT_SQUARE_CORNER:e.blockRendering.Types.LEFT_SQUARE_CORNER)|e.blockRendering.Types.CORNER,this.width=this.height=this.constants_.NO_PADDING},e.utils.object.inherits(e.blockRendering.SquareCorner,e.blockRendering.Measurable),e.blockRendering.RoundCorner=function(t,n){e.blockRendering.RoundCorner.superClass_.constructor.call(this,t),this.type=(n&&"left"!=n?e.blockRendering.Types.RIGHT_ROUND_CORNER:e.blockRendering.Types.LEFT_ROUND_CORNER)|e.blockRendering.Types.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2},e.utils.object.inherits(e.blockRendering.RoundCorner,e.blockRendering.Measurable),e.blockRendering.InRowSpacer=function(t,n){e.blockRendering.InRowSpacer.superClass_.constructor.call(this,t),this.type=this.type|e.blockRendering.Types.SPACER|e.blockRendering.Types.IN_ROW_SPACER,this.width=n,this.height=this.constants_.SPACER_DEFAULT_HEIGHT},e.utils.object.inherits(e.blockRendering.InRowSpacer,e.blockRendering.Measurable),e.blockRendering.Row=function(t){this.type=e.blockRendering.Types.ROW,this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=this.hasStatement=this.hasExternalInput=!1,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT,this.align=null},e.blockRendering.Row.prototype.measure=function(){throw Error("Unexpected attempt to measure a base Row.")},e.blockRendering.Row.prototype.getLastInput=function(){for(var n,t=this.elements.length-1;n=this.elements[t];t--)if(e.blockRendering.Types.isInput(n))return n;return null},e.blockRendering.Row.prototype.startsWithElemSpacer=function(){return!0},e.blockRendering.Row.prototype.endsWithElemSpacer=function(){return!0},e.blockRendering.Row.prototype.getFirstSpacer=function(){for(var n,t=0;n=this.elements[t];t++)if(e.blockRendering.Types.isSpacer(n))return n;return null},e.blockRendering.Row.prototype.getLastSpacer=function(){for(var n,t=this.elements.length-1;n=this.elements[t];t--)if(e.blockRendering.Types.isSpacer(n))return n;return null},e.blockRendering.TopRow=function(t){e.blockRendering.TopRow.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.TOP_ROW,this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null},e.utils.object.inherits(e.blockRendering.TopRow,e.blockRendering.Row),e.blockRendering.TopRow.prototype.hasLeftSquareCorner=function(t){var n=(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection,o=t.getPreviousBlock();return!!t.outputConnection||n||!!o&&o.getNextBlock()==t},e.blockRendering.TopRow.prototype.hasRightSquareCorner=function(t){return!0},e.blockRendering.TopRow.prototype.measure=function(){for(var a,t=0,n=0,o=0,r=0;a=this.elements[r];r++)n+=a.width,e.blockRendering.Types.isSpacer(a)||(e.blockRendering.Types.isHat(a)?o=Math.max(o,a.ascenderHeight):t=Math.max(t,a.height));this.width=Math.max(this.minWidth,n),this.height=Math.max(this.minHeight,t)+o,this.capline=this.ascenderHeight=o,this.widthWithConnectedBlocks=this.width},e.blockRendering.TopRow.prototype.startsWithElemSpacer=function(){return!1},e.blockRendering.TopRow.prototype.endsWithElemSpacer=function(){return!1},e.blockRendering.BottomRow=function(t){e.blockRendering.BottomRow.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.BOTTOM_ROW,this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0},e.utils.object.inherits(e.blockRendering.BottomRow,e.blockRendering.Row),e.blockRendering.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection||!!t.getNextBlock()},e.blockRendering.BottomRow.prototype.hasRightSquareCorner=function(t){return!0},e.blockRendering.BottomRow.prototype.measure=function(){for(var a,t=0,n=0,o=0,r=0;a=this.elements[r];r++)n+=a.width,e.blockRendering.Types.isSpacer(a)||(e.blockRendering.Types.isNextConnection(a)?o=Math.max(o,a.height):t=Math.max(t,a.height));this.width=Math.max(this.minWidth,n),this.height=Math.max(this.minHeight,t)+o,this.descenderHeight=o,this.widthWithConnectedBlocks=this.width},e.blockRendering.BottomRow.prototype.startsWithElemSpacer=function(){return!1},e.blockRendering.BottomRow.prototype.endsWithElemSpacer=function(){return!1},e.blockRendering.SpacerRow=function(t,n,o){e.blockRendering.SpacerRow.superClass_.constructor.call(this,t),this.type=this.type|e.blockRendering.Types.SPACER|e.blockRendering.Types.BETWEEN_ROW_SPACER,this.width=o,this.height=n,this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.elements=[new e.blockRendering.InRowSpacer(this.constants_,o)]},e.utils.object.inherits(e.blockRendering.SpacerRow,e.blockRendering.Row),e.blockRendering.SpacerRow.prototype.measure=function(){},e.blockRendering.InputRow=function(t){e.blockRendering.InputRow.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.INPUT_ROW,this.connectedBlockWidths=0},e.utils.object.inherits(e.blockRendering.InputRow,e.blockRendering.Row),e.blockRendering.InputRow.prototype.measure=function(){this.width=this.minWidth,this.height=this.minHeight;for(var o,t=0,n=0;o=this.elements[n];n++)this.width+=o.width,e.blockRendering.Types.isInput(o)&&(e.blockRendering.Types.isStatementInput(o)?t+=o.connectedBlockWidth:e.blockRendering.Types.isExternalInput(o)&&0!=o.connectedBlockWidth&&(t+=o.connectedBlockWidth-o.connectionWidth)),e.blockRendering.Types.isSpacer(o)||(this.height=Math.max(this.height,o.height));this.connectedBlockWidths=t,this.widthWithConnectedBlocks=this.width+t},e.blockRendering.InputRow.prototype.endsWithElemSpacer=function(){return!this.hasExternalInput&&!this.hasStatement},e.blockRendering.RenderInfo=function(t,n){this.block_=n,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=n.outputConnection?new e.blockRendering.OutputConnection(this.constants_,n.outputConnection):null,this.isInline=n.getInputsInline()&&!n.isCollapsed(),this.isCollapsed=n.isCollapsed(),this.isInsertionMarker=n.isInsertionMarker(),this.RTL=n.RTL,this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.topRow=new e.blockRendering.TopRow(this.constants_),this.bottomRow=new e.blockRendering.BottomRow(this.constants_),this.startY=this.startX=0},e.blockRendering.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.blockRendering.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},e.blockRendering.RenderInfo.prototype.createRows_=function(){this.populateTopRow_(),this.rows.push(this.topRow);var t=new e.blockRendering.InputRow(this.constants_);this.inputRows.push(t);for(var r,n=this.block_.getIcons(),o=0;r=n[o];o++){var a=new e.blockRendering.Icon(this.constants_,r);this.isCollapsed&&r.collapseHidden?this.hiddenIcons.push(a):t.elements.push(a)}for(r=null,o=0;n=this.block_.inputList[o];o++)if(n.isVisible()){for(this.shouldStartNewRow_(n,r)&&(this.rows.push(t),t=new e.blockRendering.InputRow(this.constants_),this.inputRows.push(t)),r=0;a=n.fieldRow[r];r++)t.elements.push(new e.blockRendering.Field(this.constants_,a,n));this.addInput_(n,t),r=n}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new e.blockRendering.JaggedEdge(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)},e.blockRendering.RenderInfo.prototype.populateTopRow_=function(){var t=!!this.block_.previousConnection,n=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!t,o=this.topRow.hasLeftSquareCorner(this.block_)?e.blockRendering.SquareCorner:e.blockRendering.RoundCorner;this.topRow.elements.push(new o(this.constants_)),n?(t=new e.blockRendering.Hat(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new e.blockRendering.PreviousConnection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.topRow.minHeight=this.block_.inputList.length&&this.block_.inputList[0].type==e.inputTypes.STATEMENT&&!this.block_.isCollapsed()?this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.constants_.TOP_ROW_MIN_HEIGHT,o=this.topRow.hasRightSquareCorner(this.block_)?e.blockRendering.SquareCorner:e.blockRendering.RoundCorner,this.topRow.elements.push(new o(this.constants_,"right"))},e.blockRendering.RenderInfo.prototype.populateBottomRow_=function(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==e.inputTypes.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new e.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new e.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new e.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new e.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new e.blockRendering.RoundCorner(this.constants_,"right"))},e.blockRendering.RenderInfo.prototype.addInput_=function(t,n){this.isInline&&t.type==e.inputTypes.VALUE?(n.elements.push(new e.blockRendering.InlineInput(this.constants_,t)),n.hasInlineInput=!0):t.type==e.inputTypes.STATEMENT?(n.elements.push(new e.blockRendering.StatementInput(this.constants_,t)),n.hasStatement=!0):t.type==e.inputTypes.VALUE?(n.elements.push(new e.blockRendering.ExternalValueInput(this.constants_,t)),n.hasExternalInput=!0):t.type==e.inputTypes.DUMMY&&(n.minHeight=Math.max(n.minHeight,t.getSourceBlock()&&t.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),n.hasDummyInput=!0),null==n.align&&(n.align=t.align)},e.blockRendering.RenderInfo.prototype.shouldStartNewRow_=function(t,n){return!(!n||t.type!=e.inputTypes.STATEMENT&&n.type!=e.inputTypes.STATEMENT&&(t.type!=e.inputTypes.VALUE&&t.type!=e.inputTypes.DUMMY||this.isInline))},e.blockRendering.RenderInfo.prototype.addElemSpacing_=function(){for(var n,t=0;n=this.rows[t];t++){var o=n.elements;if(n.elements=[],n.startsWithElemSpacer()&&n.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,o[0]))),o.length){for(var r=0;r<o.length-1;r++){n.elements.push(o[r]);var a=this.getInRowSpacing_(o[r],o[r+1]);n.elements.push(new e.blockRendering.InRowSpacer(this.constants_,a))}n.elements.push(o[o.length-1]),n.endsWithElemSpacer()&&n.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(o[o.length-1],null)))}}},e.blockRendering.RenderInfo.prototype.getInRowSpacing_=function(t,n){if(!t&&n&&e.blockRendering.Types.isStatementInput(n))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(t&&e.blockRendering.Types.isInput(t)&&!n){if(e.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}return t&&e.blockRendering.Types.isLeftSquareCorner(t)&&n&&(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))?n.notchOffset:t&&e.blockRendering.Types.isLeftRoundedCorner(t)&&n&&(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))?n.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},e.blockRendering.RenderInfo.prototype.computeBounds_=function(){for(var a,t=0,n=0,o=0,r=0;a=this.rows[r];r++){if(a.measure(),n=Math.max(n,a.width),a.hasStatement){var h=a.getLastInput();t=Math.max(t,a.width-h.width)}o=Math.max(o,a.widthWithConnectedBlocks)}for(this.statementEdge=t,this.width=n,r=0;a=this.rows[r];r++)a.hasStatement&&(a.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(n,o),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)},e.blockRendering.RenderInfo.prototype.alignRowElements_=function(){for(var n,t=0;n=this.rows[t];t++)if(n.hasStatement)this.alignStatementRow_(n);else{var o=n.width;0<(o=this.getDesiredRowWidth_(n)-o)&&this.addAlignmentPadding_(n,o),e.blockRendering.Types.isTopOrBottomRow(n)&&(n.widthWithConnectedBlocks=n.width)}},e.blockRendering.RenderInfo.prototype.getDesiredRowWidth_=function(t){return this.width-this.startX},e.blockRendering.RenderInfo.prototype.addAlignmentPadding_=function(t,n){var o=t.getFirstSpacer(),r=t.getLastSpacer();(t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=n),t.align==e.constants.ALIGN.LEFT?r.width+=n:t.align==e.constants.ALIGN.CENTRE?(o.width+=n/2,r.width+=n/2):t.align==e.constants.ALIGN.RIGHT?o.width+=n:r.width+=n,t.width+=n},e.blockRendering.RenderInfo.prototype.alignStatementRow_=function(t){var n=t.getLastInput(),o=t.width-n.width,r=this.statementEdge;0<(o=r-o)&&this.addAlignmentPadding_(t,o),o=t.width,r=this.getDesiredRowWidth_(t),n.width+=r-o,n.height=Math.max(n.height,t.height),t.width+=r-o,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)},e.blockRendering.RenderInfo.prototype.addRowSpacing_=function(){var t=this.rows;this.rows=[];for(var n=0;n<t.length;n++)this.rows.push(t[n]),n!=t.length-1&&this.rows.push(this.makeSpacerRow_(t[n],t[n+1]))},e.blockRendering.RenderInfo.prototype.makeSpacerRow_=function(t,n){var o=this.getSpacerRowHeight_(t,n),r=this.getSpacerRowWidth_(t,n);return o=new e.blockRendering.SpacerRow(this.constants_,o,r),t.hasStatement&&(o.followsStatement=!0),n.hasStatement&&(o.precedesStatement=!0),o},e.blockRendering.RenderInfo.prototype.getSpacerRowWidth_=function(t,n){return this.width-this.startX},e.blockRendering.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){return this.constants_.MEDIUM_PADDING},e.blockRendering.RenderInfo.prototype.getElemCenterline_=function(t,n){return e.blockRendering.Types.isSpacer(n)?t.yPos+n.height/2:e.blockRendering.Types.isBottomRow(t)?(t=t.yPos+t.height-t.descenderHeight,e.blockRendering.Types.isNextConnection(n)?t+n.height/2:t-n.height/2):e.blockRendering.Types.isTopRow(t)?e.blockRendering.Types.isHat(n)?t.capline-n.height/2:t.capline+n.height/2:t.yPos+t.height/2},e.blockRendering.RenderInfo.prototype.recordElemPositions_=function(t){for(var r,n=t.xPos,o=0;r=t.elements[o];o++)e.blockRendering.Types.isSpacer(r)&&(r.height=t.height),r.xPos=n,r.centerline=this.getElemCenterline_(t,r),n+=r.width},e.blockRendering.RenderInfo.prototype.finalize_=function(){for(var r,t=0,n=0,o=0;r=this.rows[o];o++)r.yPos=n,r.xPos=this.startX,n+=r.height,t=Math.max(t,r.widthWithConnectedBlocks),this.recordElemPositions_(r);this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(t=Math.max(t,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.widthWithChildren=t+this.startX,this.height=n,this.startY=this.topRow.capline,this.bottomRow.baseline=n-this.bottomRow.descenderHeight},e.blockRendering.Debug=function(t){this.debugElements_=[],this.svgRoot_=null,this.constants_=t},e.blockRendering.Debug.config={rowSpacers:!0,elemSpacers:!0,rows:!0,elems:!0,connections:!0,blockBounds:!0,connectedBlockBounds:!0,render:!0},e.blockRendering.Debug.prototype.clearElems=function(){for(var n,t=0;n=this.debugElements_[t];t++)e.utils.dom.removeNode(n);this.debugElements_=[]},e.blockRendering.Debug.prototype.drawSpacerRow=function(t,n,o){if(e.blockRendering.Debug.config.rowSpacers){var r=Math.abs(t.height),a=0>t.height;a&&(n-=r),this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"rowSpacerRect blockRenderDebug",x:o?-(t.xPos+t.width):t.xPos,y:n,width:t.width,height:r,stroke:a?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawSpacerElem=function(t,n,o){if(e.blockRendering.Debug.config.elemSpacers){n=Math.abs(t.width);var r=0>t.width,a=r?t.xPos-n:t.xPos;o&&(a=-(a+n)),this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"elemSpacerRect blockRenderDebug",x:a,y:t.centerline-t.height/2,width:n,height:t.height,stroke:"pink",fill:r?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawRenderedElem=function(t,n){if(e.blockRendering.Debug.config.elems){var o=t.xPos;n&&(o=-(o+t.width)),this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:o,y:n=t.centerline-t.height/2,width:t.width,height:t.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_)),e.blockRendering.Types.isField(t)&&t.field instanceof e.FieldLabel&&this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:o,y:n+this.constants_.FIELD_TEXT_BASELINE,width:t.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_))}e.blockRendering.Types.isInput(t)&&e.blockRendering.Debug.config.connections&&this.drawConnection(t.connectionModel)},e.blockRendering.Debug.prototype.drawConnection=function(t){if(e.blockRendering.Debug.config.connections){if(t.type==e.connectionTypes.INPUT_VALUE)var n=4,o="magenta",r="none";else t.type==e.connectionTypes.OUTPUT_VALUE?(n=2,r=o="magenta"):t.type==e.connectionTypes.NEXT_STATEMENT?(n=4,o="goldenrod",r="none"):t.type==e.connectionTypes.PREVIOUS_STATEMENT&&(n=2,r=o="goldenrod");this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{class:"blockRenderDebug",cx:t.offsetInBlock_.x,cy:t.offsetInBlock_.y,r:n,fill:r,stroke:o},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawRenderedRow=function(t,n,o){e.blockRendering.Debug.config.rows&&(this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"elemRenderingRect blockRenderDebug",x:o?-(t.xPos+t.width):t.xPos,y:t.yPos,width:t.width,height:t.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),e.blockRendering.Types.isTopOrBottomRow(t)||e.blockRendering.Debug.config.connectedBlockBounds&&this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"connectedBlockWidth blockRenderDebug",x:o?-(t.xPos+t.widthWithConnectedBlocks):t.xPos,y:t.yPos,width:t.widthWithConnectedBlocks,height:t.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))},e.blockRendering.Debug.prototype.drawRowWithElements=function(t,n,o){for(var r=0,a=t.elements.length;r<a;r++){var h=t.elements[r];h?e.blockRendering.Types.isSpacer(h)?this.drawSpacerElem(h,t.height,o):this.drawRenderedElem(h,o):console.warn("A row has an undefined or null element.",t,h)}this.drawRenderedRow(t,n,o)},e.blockRendering.Debug.prototype.drawBoundingBox=function(t){if(e.blockRendering.Debug.config.blockBounds){var n=t.RTL?-t.width:0;this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blockBoundingBox blockRenderDebug",x:n,y:0,width:t.width,height:t.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_)),e.blockRendering.Debug.config.connectedBlockBounds&&this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blockRenderDebug",x:n=t.RTL?-t.widthWithChildren:0,y:0,width:t.widthWithChildren,height:t.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawDebug=function(t,n){this.clearElems(),this.svgRoot_=t.getSvgRoot(),this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);for(var a,o=0,r=0;a=n.rows[r];r++)e.blockRendering.Types.isBetweenRowSpacer(a)?this.drawSpacerRow(a,o,n.RTL):this.drawRowWithElements(a,o,n.RTL),o+=a.height;t.previousConnection&&this.drawConnection(t.previousConnection),t.nextConnection&&this.drawConnection(t.nextConnection),t.outputConnection&&this.drawConnection(t.outputConnection),n.rightSide&&this.drawRenderedElem(n.rightSide,n.RTL),this.drawBoundingBox(n),this.drawRender(t.pathObject.svgPath)},e.blockRendering.Debug.prototype.drawRender=function(t){e.blockRendering.Debug.config.render&&(t.setAttribute("filter","url(#"+this.constants_.debugFilterId+")"),setTimeout(function(){t.setAttribute("filter","")},100))},e.blockRendering.Drawer=function(t,n){this.block_=t,this.info_=n,this.topLeft_=t.getRelativeToSurfaceXY(),this.inlinePath_=this.outlinePath_="",this.constants_=n.getRenderer().getConstants()},e.blockRendering.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),e.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},e.blockRendering.Drawer.prototype.recordSizeOnBlock_=function(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren},e.blockRendering.Drawer.prototype.hideHiddenIcons_=function(){for(var n,t=0;n=this.info_.hiddenIcons[t];t++)n.icon.iconGroup_.setAttribute("display","none")},e.blockRendering.Drawer.prototype.drawOutline_=function(){this.drawTop_();for(var t=1;t<this.info_.rows.length-1;t++){var n=this.info_.rows[t];n.hasJaggedEdge?this.drawJaggedEdge_(n):n.hasStatement?this.drawStatementInput_(n):n.hasExternalInput?this.drawValueInput_(n):this.drawRightSideRow_(n)}this.drawBottom_(),this.drawLeft_()},e.blockRendering.Drawer.prototype.drawTop_=function(){var t=this.info_.topRow,n=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=e.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var r,o=0;r=n[o];o++)e.blockRendering.Types.isLeftRoundedCorner(r)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:e.blockRendering.Types.isRightRoundedCorner(r)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:e.blockRendering.Types.isPreviousConnection(r)?this.outlinePath_+=r.shape.pathLeft:e.blockRendering.Types.isHat(r)?this.outlinePath_+=this.constants_.START_HAT.path:e.blockRendering.Types.isSpacer(r)&&(this.outlinePath_+=e.utils.svgPaths.lineOnAxis("h",r.width));this.outlinePath_+=e.utils.svgPaths.lineOnAxis("v",t.height)},e.blockRendering.Drawer.prototype.drawJaggedEdge_=function(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+e.utils.svgPaths.lineOnAxis("v",t.height-this.constants_.JAGGED_TEETH.height)},e.blockRendering.Drawer.prototype.drawValueInput_=function(t){var n=t.getLastInput();this.positionExternalValueConnection_(t);var o="function"==typeof n.shape.pathDown?n.shape.pathDown(n.height):n.shape.pathDown;this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",n.xPos+n.width)+o+e.utils.svgPaths.lineOnAxis("v",t.height-n.connectionHeight)},e.blockRendering.Drawer.prototype.drawStatementInput_=function(t){var n=t.getLastInput(),o=n.xPos+n.notchOffset+n.shape.width;n=n.shape.pathRight+e.utils.svgPaths.lineOnAxis("h",-(n.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var r=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",o)+n+e.utils.svgPaths.lineOnAxis("v",r)+this.constants_.INSIDE_CORNERS.pathBottom+e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},e.blockRendering.Drawer.prototype.drawRightSideRow_=function(t){this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},e.blockRendering.Drawer.prototype.drawBottom_=function(){var t=this.info_.bottomRow,n=t.elements;this.positionNextConnection_();for(var h,o=0,r="",a=n.length-1;h=n[a];a--)e.blockRendering.Types.isNextConnection(h)?r+=h.shape.pathRight:e.blockRendering.Types.isLeftSquareCorner(h)?r+=e.utils.svgPaths.lineOnAxis("H",t.xPos):e.blockRendering.Types.isLeftRoundedCorner(h)?r+=this.constants_.OUTSIDE_CORNERS.bottomLeft:e.blockRendering.Types.isRightRoundedCorner(h)?(r+=this.constants_.OUTSIDE_CORNERS.bottomRight,o=this.constants_.OUTSIDE_CORNERS.rightHeight):e.blockRendering.Types.isSpacer(h)&&(r+=e.utils.svgPaths.lineOnAxis("h",-1*h.width));this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.baseline-o),this.outlinePath_+=r},e.blockRendering.Drawer.prototype.drawLeft_=function(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){var n=t.connectionOffsetY+t.height;t="function"==typeof t.shape.pathUp?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",n)+t}this.outlinePath_+="z"},e.blockRendering.Drawer.prototype.drawInternals_=function(){for(var n,t=0;n=this.info_.rows[t];t++)for(var r,o=0;r=n.elements[o];o++)e.blockRendering.Types.isInlineInput(r)?this.drawInlineInput_(r):(e.blockRendering.Types.isIcon(r)||e.blockRendering.Types.isField(r))&&this.layoutField_(r)},e.blockRendering.Drawer.prototype.layoutField_=function(t){if(e.blockRendering.Types.isField(t))var n=t.field.getSvgRoot();else e.blockRendering.Types.isIcon(t)&&(n=t.icon.iconGroup_);var o=t.centerline-t.height/2,r=t.xPos,a="";this.info_.RTL&&(r=-(r+t.width),t.flipRtl&&(r+=t.width,a="scale(-1 1)")),e.blockRendering.Types.isIcon(t)?(n.setAttribute("display","block"),n.setAttribute("transform","translate("+r+","+o+")"),t.icon.computeIconLocation()):n.setAttribute("transform","translate("+r+","+o+")"+a),this.info_.isInsertionMarker&&n.setAttribute("display","none")},e.blockRendering.Drawer.prototype.drawInlineInput_=function(t){var n=t.width,o=t.height,r=t.connectionOffsetY,a=t.connectionHeight+r;this.inlinePath_+=e.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-o/2)+e.utils.svgPaths.lineOnAxis("v",r)+t.shape.pathDown+e.utils.svgPaths.lineOnAxis("v",o-a)+e.utils.svgPaths.lineOnAxis("h",n-t.connectionWidth)+e.utils.svgPaths.lineOnAxis("v",-o)+"z",this.positionInlineInputConnection_(t)},e.blockRendering.Drawer.prototype.positionInlineInputConnection_=function(t){if(t.connectionModel){var o=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(o*=-1),t.connectionModel.setOffsetInBlock(o,t.centerline-t.height/2+t.connectionOffsetY)}},e.blockRendering.Drawer.prototype.positionStatementInputConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.statementEdge+n.notchOffset;this.info_.RTL&&(o*=-1),n.connectionModel.setOffsetInBlock(o,t.yPos)}},e.blockRendering.Drawer.prototype.positionExternalValueConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.width;this.info_.RTL&&(o*=-1),n.connectionModel.setOffsetInBlock(o,t.yPos)}},e.blockRendering.Drawer.prototype.positionPreviousConnection_=function(){var t=this.info_.topRow;if(t.connection){var n=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-n:n,0)}},e.blockRendering.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var n=t.connection,o=n.xPos;n.connectionModel.setOffsetInBlock(this.info_.RTL?-o:o,t.baseline)}},e.blockRendering.Drawer.prototype.positionOutputConnection_=function(){if(this.info_.outputConnection){var t=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}},e.Events.MarkerMove=function(t,n,o,r){var a=t?t.workspace.id:void 0;r&&r.getType()==e.ASTNode.types.WORKSPACE&&(a=r.getLocation().id),e.Events.MarkerMove.superClass_.constructor.call(this,a),this.blockId=t?t.id:null,this.oldNode=o,this.newNode=r,this.isCursor=n},e.utils.object.inherits(e.Events.MarkerMove,e.Events.UiBase),e.Events.MarkerMove.prototype.type=e.Events.MARKER_MOVE,e.Events.MarkerMove.prototype.toJson=function(){var t=e.Events.MarkerMove.superClass_.toJson.call(this);return t.isCursor=this.isCursor,t.blockId=this.blockId,t.oldNode=this.oldNode,t.newNode=this.newNode,t},e.Events.MarkerMove.prototype.fromJson=function(t){e.Events.MarkerMove.superClass_.fromJson.call(this,t),this.isCursor=t.isCursor,this.blockId=t.blockId,this.oldNode=t.oldNode,this.newNode=t.newNode},e.registry.register(e.registry.Type.EVENT,e.Events.MARKER_MOVE,e.Events.MarkerMove),e.blockRendering.MarkerSvg=function(t,n,o){this.workspace_=t,this.marker_=o,this.parent_=null,this.constants_=n,this.currentMarkerSvg=null,t=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=o.colour||t},e.blockRendering.MarkerSvg.CURSOR_CLASS="blocklyCursor",e.blockRendering.MarkerSvg.MARKER_CLASS="blocklyMarker",e.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER=.75,e.blockRendering.MarkerSvg.prototype.getSvgRoot=function(){return this.svgGroup_},e.blockRendering.MarkerSvg.prototype.getMarker=function(){return this.marker_},e.blockRendering.MarkerSvg.prototype.isCursor=function(){return"cursor"==this.marker_.type},e.blockRendering.MarkerSvg.prototype.createDom=function(){var t=this.isCursor()?e.blockRendering.MarkerSvg.CURSOR_CLASS:e.blockRendering.MarkerSvg.MARKER_CLASS;return this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:t},null),this.createDomInternal_(),this.svgGroup_},e.blockRendering.MarkerSvg.prototype.setParent_=function(t){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())),this.parent_=t},e.blockRendering.MarkerSvg.prototype.draw=function(t,n){if(n){this.constants_=this.workspace_.getRenderer().getConstants();var o=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker_.colour||o,this.applyColour_(n),this.showAtLocation_(n),this.fireMarkerEvent_(t,n),void 0!==(t=this.currentMarkerSvg.childNodes[0])&&t.beginElement&&t.beginElement()}else this.hide()},e.blockRendering.MarkerSvg.prototype.showAtLocation_=function(t){var n=t.getLocation().type;t.getType()==e.ASTNode.types.BLOCK?this.showWithBlock_(t):t.getType()==e.ASTNode.types.OUTPUT?this.showWithOutput_(t):n==e.connectionTypes.INPUT_VALUE?this.showWithInput_(t):n==e.connectionTypes.NEXT_STATEMENT?this.showWithNext_(t):t.getType()==e.ASTNode.types.PREVIOUS?this.showWithPrevious_(t):t.getType()==e.ASTNode.types.FIELD?this.showWithField_(t):t.getType()==e.ASTNode.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()==e.ASTNode.types.STACK&&this.showWithStack_(t)},e.blockRendering.MarkerSvg.prototype.showWithBlockPrevOutput_=function(t){var n=(t=t.getSourceBlock()).width,o=t.height,r=o*e.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER,a=this.constants_.CURSOR_BLOCK_PADDING;if(t.previousConnection){var h=this.constants_.shapeFor(t.previousConnection);this.positionPrevious_(n,a,r,h)}else t.outputConnection?(h=this.constants_.shapeFor(t.outputConnection),this.positionOutput_(n,o,h)):this.positionBlock_(n,a,r);this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithBlock_=function(t){this.showWithBlockPrevOutput_(t)},e.blockRendering.MarkerSvg.prototype.showWithPrevious_=function(t){this.showWithBlockPrevOutput_(t)},e.blockRendering.MarkerSvg.prototype.showWithOutput_=function(t){this.showWithBlockPrevOutput_(t)},e.blockRendering.MarkerSvg.prototype.showWithCoordinates_=function(t){var n=t.getWsCoordinate();t=n.x,this.workspace_.RTL&&(t-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(t,n=n.y,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace_),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithField_=function(t){var n=(t=t.getLocation()).getSize().width,o=t.getSize().height;this.positionRect_(0,0,n,o),this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithInput_=function(t){var n=(t=t.getLocation()).getSourceBlock();this.positionInput_(t),this.setParent_(n),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithNext_=function(t){var n=t.getLocation();t=n.getSourceBlock();var o=0;n=n.getOffsetInBlock().y;var r=t.getHeightWidth().width;this.workspace_.RTL&&(o=-r),this.positionLine_(o,n,r),this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithStack_=function(t){var n=(t=t.getLocation()).getHeightWidth(),o=n.width+this.constants_.CURSOR_STACK_PADDING,r=-this.constants_.CURSOR_STACK_PADDING/2,h=r;this.workspace_.RTL&&(h=-(o+r)),this.positionRect_(h,-this.constants_.CURSOR_STACK_PADDING/2,o,n=n.height+this.constants_.CURSOR_STACK_PADDING),this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showCurrent_=function(){this.hide(),this.currentMarkerSvg.style.display=""},e.blockRendering.MarkerSvg.prototype.positionBlock_=function(t,n,o){t=e.utils.svgPaths.moveBy(-n,o)+e.utils.svgPaths.lineOnAxis("V",-n)+e.utils.svgPaths.lineOnAxis("H",t+2*n)+e.utils.svgPaths.lineOnAxis("V",o),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},e.blockRendering.MarkerSvg.prototype.positionInput_=function(t){var n=t.getOffsetInBlock().x,o=t.getOffsetInBlock().y;t=e.utils.svgPaths.moveTo(0,0)+this.constants_.shapeFor(t).pathDown,this.markerInput_.setAttribute("d",t),this.markerInput_.setAttribute("transform","translate("+n+","+o+")"+(this.workspace_.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_},e.blockRendering.MarkerSvg.prototype.positionLine_=function(t,n,o){this.markerSvgLine_.setAttribute("x",t),this.markerSvgLine_.setAttribute("y",n),this.markerSvgLine_.setAttribute("width",o),this.currentMarkerSvg=this.markerSvgLine_},e.blockRendering.MarkerSvg.prototype.positionOutput_=function(t,n,o){t=e.utils.svgPaths.moveBy(t,0)+e.utils.svgPaths.lineOnAxis("h",-(t-o.width))+e.utils.svgPaths.lineOnAxis("v",this.constants_.TAB_OFFSET_FROM_TOP)+o.pathDown+e.utils.svgPaths.lineOnAxis("V",n)+e.utils.svgPaths.lineOnAxis("H",t),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},e.blockRendering.MarkerSvg.prototype.positionPrevious_=function(t,n,o,r){t=e.utils.svgPaths.moveBy(-n,o)+e.utils.svgPaths.lineOnAxis("V",-n)+e.utils.svgPaths.lineOnAxis("H",this.constants_.NOTCH_OFFSET_LEFT)+r.pathLeft+e.utils.svgPaths.lineOnAxis("H",t+2*n)+e.utils.svgPaths.lineOnAxis("V",o),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},e.blockRendering.MarkerSvg.prototype.positionRect_=function(t,n,o,r){this.markerSvgRect_.setAttribute("x",t),this.markerSvgRect_.setAttribute("y",n),this.markerSvgRect_.setAttribute("width",o),this.markerSvgRect_.setAttribute("height",r),this.currentMarkerSvg=this.markerSvgRect_},e.blockRendering.MarkerSvg.prototype.flipRtl_=function(t){t.setAttribute("transform","scale(-1 1)")},e.blockRendering.MarkerSvg.prototype.hide=function(){this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"},e.blockRendering.MarkerSvg.prototype.fireMarkerEvent_=function(t,n){var o=n.getSourceBlock();t=new(e.Events.get(e.Events.MARKER_MOVE))(o,this.isCursor(),t,n),e.Events.fire(t)},e.blockRendering.MarkerSvg.prototype.getBlinkProperties_=function(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}},e.blockRendering.MarkerSvg.prototype.createDomInternal_=function(){if(this.markerSvg_=e.utils.dom.createSvgElement(e.utils.Svg.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var t=this.getBlinkProperties_();e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerSvgLine_),e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerInput_),t.attributeName="stroke",e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerBlock_)}return this.markerSvg_},e.blockRendering.MarkerSvg.prototype.applyColour_=function(t){this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(this.markerSvgLine_.firstChild.setAttribute("values",t=this.colour_+";transparent;transparent;"),this.markerInput_.firstChild.setAttribute("values",t),this.markerBlock_.firstChild.setAttribute("values",t))},e.blockRendering.MarkerSvg.prototype.dispose=function(){this.svgGroup_&&e.utils.dom.removeNode(this.svgGroup_)},e.blockRendering.PathObject=function(t,n,o){this.constants=o,this.svgRoot=t,this.svgPath=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.style=n,this.markerSvg=this.cursorSvg=null},e.blockRendering.PathObject.prototype.setPath=function(t){this.svgPath.setAttribute("d",t)},e.blockRendering.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)")},e.blockRendering.PathObject.prototype.setCursorSvg=function(t){t?(this.svgRoot.appendChild(t),this.cursorSvg=t):this.cursorSvg=null},e.blockRendering.PathObject.prototype.setMarkerSvg=function(t){t?(this.cursorSvg?this.svgRoot.insertBefore(t,this.cursorSvg):this.svgRoot.appendChild(t),this.markerSvg=t):this.markerSvg=null},e.blockRendering.PathObject.prototype.applyColour=function(t){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(t.isShadow()),this.updateDisabled_(!t.isEnabled()||t.getInheritedDisabled())},e.blockRendering.PathObject.prototype.setStyle=function(t){this.style=t},e.blockRendering.PathObject.prototype.setClass_=function(t,n){n?e.utils.dom.addClass(this.svgRoot,t):e.utils.dom.removeClass(this.svgRoot,t)},e.blockRendering.PathObject.prototype.updateHighlighted=function(t){this.svgPath.setAttribute("filter",t?"url(#"+this.constants.embossFilterId+")":"none")},e.blockRendering.PathObject.prototype.updateShadow_=function(t){t&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},e.blockRendering.PathObject.prototype.updateDisabled_=function(t){this.setClass_("blocklyDisabled",t),t&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")},e.blockRendering.PathObject.prototype.updateSelected=function(t){this.setClass_("blocklySelected",t)},e.blockRendering.PathObject.prototype.updateDraggingDelete=function(t){this.setClass_("blocklyDraggingDelete",t)},e.blockRendering.PathObject.prototype.updateInsertionMarker=function(t){this.setClass_("blocklyInsertionMarker",t)},e.blockRendering.PathObject.prototype.updateMovable=function(t){this.setClass_("blocklyDraggable",t)},e.blockRendering.PathObject.prototype.updateReplacementFade=function(t){this.setClass_("blocklyReplaceable",t)},e.blockRendering.PathObject.prototype.updateShapeForInputHighlight=function(t,n){},e.blockRendering.Renderer=function(t){this.name=t,this.overrides=this.constants_=null},e.blockRendering.Renderer.prototype.getClassName=function(){return this.name+"-renderer"},e.blockRendering.Renderer.prototype.init=function(t,n){this.constants_=this.makeConstants_(),n&&(this.overrides=n,e.utils.object.mixin(this.constants_,n)),this.constants_.setTheme(t),this.constants_.init()},e.blockRendering.Renderer.prototype.createDom=function(t,n){this.constants_.createDom(t,this.name+"-"+n.name,"."+this.getClassName()+"."+n.getClassName())},e.blockRendering.Renderer.prototype.refreshDom=function(t,n){var o=this.getConstants();o.dispose(),this.constants_=this.makeConstants_(),this.overrides&&e.utils.object.mixin(this.constants_,this.overrides),this.constants_.randomIdentifier=o.randomIdentifier,this.constants_.setTheme(n),this.constants_.init(),this.createDom(t,n)},e.blockRendering.Renderer.prototype.dispose=function(){this.constants_&&this.constants_.dispose()},e.blockRendering.Renderer.prototype.makeConstants_=function(){return new e.blockRendering.ConstantProvider},e.blockRendering.Renderer.prototype.makeRenderInfo_=function(t){return new e.blockRendering.RenderInfo(this,t)},e.blockRendering.Renderer.prototype.makeDrawer_=function(t,n){return new e.blockRendering.Drawer(t,n)},e.blockRendering.Renderer.prototype.makeDebugger_=function(){if(!e.blockRendering.Debug)throw Error("Missing require for Blockly.blockRendering.Debug");return new e.blockRendering.Debug(this.getConstants())},e.blockRendering.Renderer.prototype.makeMarkerDrawer=function(t,n){return new e.blockRendering.MarkerSvg(t,this.getConstants(),n)},e.blockRendering.Renderer.prototype.makePathObject=function(t,n){return new e.blockRendering.PathObject(t,n,this.constants_)},e.blockRendering.Renderer.prototype.getConstants=function(){return this.constants_},e.blockRendering.Renderer.prototype.shouldHighlightConnection=function(t){return!0},e.blockRendering.Renderer.prototype.orphanCanConnectAtEnd=function(t,n,o){return!!e.Connection.getConnectionForOrphanedConnection(t,o===e.connectionTypes.OUTPUT_VALUE?n.outputConnection:n.previousConnection)},e.blockRendering.Renderer.prototype.getConnectionPreviewMethod=function(t,n,o){return n.type==e.connectionTypes.OUTPUT_VALUE||n.type==e.connectionTypes.PREVIOUS_STATEMENT?!t.isConnected()||this.orphanCanConnectAtEnd(o,t.targetBlock(),n.type)?e.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:e.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:e.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER},e.blockRendering.Renderer.prototype.render=function(t){e.blockRendering.useDebugger&&!t.renderingDebugger&&(t.renderingDebugger=this.makeDebugger_());var n=this.makeRenderInfo_(t);n.measure(),this.makeDrawer_(t,n).draw()},e.geras={},e.geras.ConstantProvider=function(){e.geras.ConstantProvider.superClass_.constructor.call(this),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2},e.utils.object.inherits(e.geras.ConstantProvider,e.blockRendering.ConstantProvider),e.geras.ConstantProvider.prototype.getCSS_=function(t){return e.geras.ConstantProvider.superClass_.getCSS_.call(this,t).concat([t+" .blocklyInsertionMarker>.blocklyPathLight,",t+" .blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"])},e.geras.Highlighter=function(t){this.info_=t,this.inlineSteps_=this.steps_="",this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH},e.geras.Highlighter.prototype.getPath=function(){return this.steps_+"\n"+this.inlineSteps_},e.geras.Highlighter.prototype.drawTopCorner=function(t){this.steps_+=e.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var o,n=0;o=t.elements[n];n++)e.blockRendering.Types.isLeftSquareCorner(o)?this.steps_+=this.highlightConstants_.START_POINT:e.blockRendering.Types.isLeftRoundedCorner(o)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):e.blockRendering.Types.isPreviousConnection(o)?this.steps_+=this.notchPaths_.pathLeft:e.blockRendering.Types.isHat(o)?this.steps_+=this.startPaths_.path(this.RTL_):e.blockRendering.Types.isSpacer(o)&&0!=o.width&&(this.steps_+=e.utils.svgPaths.lineOnAxis("H",o.xPos+o.width-this.highlightOffset_));this.steps_+=e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width-this.highlightOffset_)},e.geras.Highlighter.prototype.drawJaggedEdge_=function(t){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+e.utils.svgPaths.lineOnAxis("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset_))},e.geras.Highlighter.prototype.drawValueInput=function(t){var n=t.getLastInput();if(this.RTL_){var o=t.height-n.connectionHeight;this.steps_+=e.utils.svgPaths.moveTo(n.xPos+n.width-this.highlightOffset_,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+e.utils.svgPaths.lineOnAxis("v",o)}else this.steps_+=e.utils.svgPaths.moveTo(n.xPos+n.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)},e.geras.Highlighter.prototype.drawStatementInput=function(t){var n=t.getLastInput();if(this.RTL_){var o=t.height-2*this.insideCornerPaths_.height;this.steps_+=e.utils.svgPaths.moveTo(n.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+e.utils.svgPaths.lineOnAxis("v",o)+this.insideCornerPaths_.pathBottom(this.RTL_)+e.utils.svgPaths.lineTo(t.width-n.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=e.utils.svgPaths.moveTo(n.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+e.utils.svgPaths.lineTo(t.width-n.xPos-this.insideCornerPaths_.width,0)},e.geras.Highlighter.prototype.drawRightSideRow=function(t){var n=t.xPos+t.width-this.highlightOffset_;t.followsStatement&&(this.steps_+=e.utils.svgPaths.lineOnAxis("H",n)),this.RTL_&&(this.steps_+=e.utils.svgPaths.lineOnAxis("H",n),t.height>this.highlightOffset_&&(this.steps_+=e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height-this.highlightOffset_)))},e.geras.Highlighter.prototype.drawBottomRow=function(t){if(this.RTL_)this.steps_+=e.utils.svgPaths.lineOnAxis("V",t.baseline-this.highlightOffset_);else{var n=this.info_.bottomRow.elements[0];e.blockRendering.Types.isLeftSquareCorner(n)?this.steps_+=e.utils.svgPaths.moveTo(t.xPos+this.highlightOffset_,t.baseline-this.highlightOffset_):e.blockRendering.Types.isLeftRoundedCorner(n)&&(this.steps_+=e.utils.svgPaths.moveTo(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}},e.geras.Highlighter.prototype.drawLeft=function(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=e.utils.svgPaths.moveTo(this.info_.startX,t):(this.steps_+=e.utils.svgPaths.moveTo(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=e.utils.svgPaths.lineOnAxis("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e.blockRendering.Types.isLeftRoundedCorner((t=this.info_.topRow).elements[0])?this.steps_+=e.utils.svgPaths.lineOnAxis("V",this.outsideCornerPaths_.height):this.steps_+=e.utils.svgPaths.lineOnAxis("V",t.capline+this.highlightOffset_))},e.geras.Highlighter.prototype.drawInlineInput=function(t){var n=this.highlightOffset_,o=t.xPos+t.connectionWidth,r=t.centerline-t.height/2,a=t.width-t.connectionWidth,h=r+n;this.RTL_?(r=t.connectionOffsetY-n,t=t.height-(t.connectionOffsetY+t.connectionHeight)+n,this.inlineSteps_+=e.utils.svgPaths.moveTo(o-n,h)+e.utils.svgPaths.lineOnAxis("v",r)+this.puzzleTabPaths_.pathDown(this.RTL_)+e.utils.svgPaths.lineOnAxis("v",t)+e.utils.svgPaths.lineOnAxis("h",a)):this.inlineSteps_+=e.utils.svgPaths.moveTo(t.xPos+t.width+n,h)+e.utils.svgPaths.lineOnAxis("v",t.height)+e.utils.svgPaths.lineOnAxis("h",-a)+e.utils.svgPaths.moveTo(o,r+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)},e.geras.InlineInput=function(t,n){e.geras.InlineInput.superClass_.constructor.call(this,t,n),this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)},e.utils.object.inherits(e.geras.InlineInput,e.blockRendering.InlineInput),e.geras.StatementInput=function(t,n){e.geras.StatementInput.superClass_.constructor.call(this,t,n),this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)},e.utils.object.inherits(e.geras.StatementInput,e.blockRendering.StatementInput),e.geras.RenderInfo=function(t,n){e.geras.RenderInfo.superClass_.constructor.call(this,t,n)},e.utils.object.inherits(e.geras.RenderInfo,e.blockRendering.RenderInfo),e.geras.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.geras.RenderInfo.prototype.populateBottomRow_=function(){e.geras.RenderInfo.superClass_.populateBottomRow_.call(this),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==e.inputTypes.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)},e.geras.RenderInfo.prototype.addInput_=function(t,n){this.isInline&&t.type==e.inputTypes.VALUE?(n.elements.push(new e.geras.InlineInput(this.constants_,t)),n.hasInlineInput=!0):t.type==e.inputTypes.STATEMENT?(n.elements.push(new e.geras.StatementInput(this.constants_,t)),n.hasStatement=!0):t.type==e.inputTypes.VALUE?(n.elements.push(new e.blockRendering.ExternalValueInput(this.constants_,t)),n.hasExternalInput=!0):t.type==e.inputTypes.DUMMY&&(n.minHeight=Math.max(n.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),n.hasDummyInput=!0),this.isInline||null!=n.align||(n.align=t.align)},e.geras.RenderInfo.prototype.addElemSpacing_=function(){for(var o,t=!1,n=0;o=this.rows[n];n++)o.hasExternalInput&&(t=!0);for(n=0;o=this.rows[n];n++){var r=o.elements;if(o.elements=[],o.startsWithElemSpacer()&&o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(var a=0;a<r.length-1;a++){o.elements.push(r[a]);var h=this.getInRowSpacing_(r[a],r[a+1]);o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h))}o.elements.push(r[r.length-1]),o.endsWithElemSpacer()&&(h=this.getInRowSpacing_(r[r.length-1],null),t&&o.hasDummyInput&&(h+=this.constants_.TAB_WIDTH),o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h)))}}},e.geras.RenderInfo.prototype.getInRowSpacing_=function(t,n){if(!t)return n&&e.blockRendering.Types.isField(n)&&n.isEditable?this.constants_.MEDIUM_PADDING:n&&e.blockRendering.Types.isInlineInput(n)?this.constants_.MEDIUM_LARGE_PADDING:n&&e.blockRendering.Types.isStatementInput(n)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!e.blockRendering.Types.isInput(t)&&(!n||e.blockRendering.Types.isStatementInput(n)))return e.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:e.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:e.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:e.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:e.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:e.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInput(t)&&!n){if(e.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!e.blockRendering.Types.isInput(t)&&n&&e.blockRendering.Types.isInput(n)){if(e.blockRendering.Types.isField(t)&&t.isEditable){if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.SMALL_PADDING}else{if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.MEDIUM_LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(n))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(e.blockRendering.Types.isIcon(t)&&n&&!e.blockRendering.Types.isInput(n))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInlineInput(t)&&n&&e.blockRendering.Types.isField(n))return n.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isLeftSquareCorner(t)&&n){if(e.blockRendering.Types.isHat(n))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isPreviousConnection(n))return n.notchOffset;if(e.blockRendering.Types.isNextConnection(n))return n.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(e.blockRendering.Types.isLeftRoundedCorner(t)&&n){if(e.blockRendering.Types.isPreviousConnection(n))return n.notchOffset-this.constants_.CORNER_RADIUS;if(e.blockRendering.Types.isNextConnection(n))return n.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return e.blockRendering.Types.isField(t)&&n&&e.blockRendering.Types.isField(n)&&t.isEditable==n.isEditable||n&&e.blockRendering.Types.isJaggedEdge(n)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.geras.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){return e.blockRendering.Types.isTopRow(t)&&e.blockRendering.Types.isBottomRow(n)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:e.blockRendering.Types.isTopRow(t)||e.blockRendering.Types.isBottomRow(n)?this.constants_.NO_PADDING:t.hasExternalInput&&n.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&n.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&n.hasStatement||!t.hasStatement&&n.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.geras.RenderInfo.prototype.getElemCenterline_=function(t,n){if(e.blockRendering.Types.isSpacer(n))return t.yPos+n.height/2;if(e.blockRendering.Types.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,e.blockRendering.Types.isNextConnection(n)?t+n.height/2:t-n.height/2;if(e.blockRendering.Types.isTopRow(t))return e.blockRendering.Types.isHat(n)?t.capline-n.height/2:t.capline+n.height/2;var o=t.yPos;return e.blockRendering.Types.isField(n)||e.blockRendering.Types.isIcon(n)?(o+=n.height/2,(t.hasInlineInput||t.hasStatement)&&n.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(o+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):o=e.blockRendering.Types.isInlineInput(n)?o+n.height/2:o+t.height/2,o},e.geras.RenderInfo.prototype.alignRowElements_=function(){if(this.isInline){for(var r,t=0,n=null,o=this.rows.length-1;r=this.rows[o];o--)r.nextRightEdge=t,e.blockRendering.Types.isInputRow(r)&&(r.hasStatement&&this.alignStatementRow_(r),n&&n.hasStatement&&r.width<n.width?r.nextRightEdge=n.width:t=r.width,n=r);for(o=t=0;r=this.rows[o];o++)r.hasStatement?t=this.getDesiredRowWidth_(r):e.blockRendering.Types.isSpacer(r)?r.width=Math.max(t,r.nextRightEdge):(0<(t=Math.max(t,r.nextRightEdge)-r.width)&&this.addAlignmentPadding_(r,t),t=r.width)}else e.geras.RenderInfo.superClass_.alignRowElements_.call(this)},e.geras.RenderInfo.prototype.getDesiredRowWidth_=function(t){return this.isInline&&t.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:e.geras.RenderInfo.superClass_.getDesiredRowWidth_.call(this,t)},e.geras.RenderInfo.prototype.finalize_=function(){for(var r,t=0,n=0,o=0;r=this.rows[o];o++){r.yPos=n,r.xPos=this.startX,n+=r.height,t=Math.max(t,r.widthWithConnectedBlocks);var a=n-this.topRow.ascenderHeight;r==this.bottomRow&&a<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=a=this.constants_.MIN_BLOCK_HEIGHT-a,n+=a),this.recordElemPositions_(r)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(t=Math.max(t,this.block_.nextConnection.targetBlock().getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=n-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=n+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline},e.geras.Drawer=function(t,n){e.geras.Drawer.superClass_.constructor.call(this,t,n),this.highlighter_=new e.geras.Highlighter(n)},e.utils.object.inherits(e.geras.Drawer,e.blockRendering.Drawer),e.geras.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();var t=this.block_.pathObject;t.setPath(this.outlinePath_+"\n"+this.inlinePath_),t.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&t.flipRTL(),e.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},e.geras.Drawer.prototype.drawTop_=function(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),e.geras.Drawer.superClass_.drawTop_.call(this)},e.geras.Drawer.prototype.drawJaggedEdge_=function(t){this.highlighter_.drawJaggedEdge_(t),e.geras.Drawer.superClass_.drawJaggedEdge_.call(this,t)},e.geras.Drawer.prototype.drawValueInput_=function(t){this.highlighter_.drawValueInput(t),e.geras.Drawer.superClass_.drawValueInput_.call(this,t)},e.geras.Drawer.prototype.drawStatementInput_=function(t){this.highlighter_.drawStatementInput(t),e.geras.Drawer.superClass_.drawStatementInput_.call(this,t)},e.geras.Drawer.prototype.drawRightSideRow_=function(t){this.highlighter_.drawRightSideRow(t),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width)+e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},e.geras.Drawer.prototype.drawBottom_=function(){this.highlighter_.drawBottomRow(this.info_.bottomRow),e.geras.Drawer.superClass_.drawBottom_.call(this)},e.geras.Drawer.prototype.drawLeft_=function(){this.highlighter_.drawLeft(),e.geras.Drawer.superClass_.drawLeft_.call(this)},e.geras.Drawer.prototype.drawInlineInput_=function(t){this.highlighter_.drawInlineInput(t),e.geras.Drawer.superClass_.drawInlineInput_.call(this,t)},e.geras.Drawer.prototype.positionInlineInputConnection_=function(t){if(t.connectionModel){var o=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(o*=-1),t.connectionModel.setOffsetInBlock(o,t.centerline-t.height/2+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}},e.geras.Drawer.prototype.positionStatementInputConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.statementEdge+n.notchOffset;n.connectionModel.setOffsetInBlock(o=this.info_.RTL?-1*o:o+this.constants_.DARK_PATH_OFFSET,t.yPos+this.constants_.DARK_PATH_OFFSET)}},e.geras.Drawer.prototype.positionExternalValueConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(o*=-1),n.connectionModel.setOffsetInBlock(o,t.yPos)}},e.geras.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var n=t.connection,o=n.xPos;n.connectionModel.setOffsetInBlock((this.info_.RTL?-o:o)+this.constants_.DARK_PATH_OFFSET/2,t.baseline+this.constants_.DARK_PATH_OFFSET)}},e.geras.HighlightConstantProvider=function(t){this.constantProvider=t,this.OFFSET=.5,this.START_POINT=e.utils.svgPaths.moveBy(this.OFFSET,this.OFFSET)},e.geras.HighlightConstantProvider.prototype.init=function(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()},e.geras.HighlightConstantProvider.prototype.makeInsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,n=this.OFFSET,o=(1-Math.SQRT1_2)*(t+n)-n,r=e.utils.svgPaths.moveBy(o,o)+e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(-o-n,t-o)),a=e.utils.svgPaths.arc("a","0 0,0",t+n,e.utils.svgPaths.point(t+n,t+n)),h=e.utils.svgPaths.moveBy(o,-o)+e.utils.svgPaths.arc("a","0 0,0",t+n,e.utils.svgPaths.point(t-o,o+n));return{width:t+n,height:t,pathTop:function(R){return R?r:""},pathBottom:function(R){return R?a:h}}},e.geras.HighlightConstantProvider.prototype.makeOutsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,n=this.OFFSET,o=(1-Math.SQRT1_2)*(t-n)+n,r=e.utils.svgPaths.moveBy(o,o)+e.utils.svgPaths.arc("a","0 0,1",t-n,e.utils.svgPaths.point(t-o,-o+n)),a=e.utils.svgPaths.moveBy(n,t)+e.utils.svgPaths.arc("a","0 0,1",t-n,e.utils.svgPaths.point(t,-t+n)),h=-o,R=e.utils.svgPaths.moveBy(o,h)+e.utils.svgPaths.arc("a","0 0,1",t-n,e.utils.svgPaths.point(-o+n,-h-t));return{height:t,topLeft:function(L){return L?r:a},bottomLeft:function(){return R}}},e.geras.HighlightConstantProvider.prototype.makePuzzleTab=function(){var t=this.constantProvider.TAB_WIDTH,n=this.constantProvider.TAB_HEIGHT,o=e.utils.svgPaths.moveBy(-2,3.4-n)+e.utils.svgPaths.lineTo(-.45*t,-2.1),r=e.utils.svgPaths.lineOnAxis("v",2.5)+e.utils.svgPaths.moveBy(.97*-t,2.5)+e.utils.svgPaths.curve("q",[e.utils.svgPaths.point(.05*-t,10),e.utils.svgPaths.point(.3*t,9.5)])+e.utils.svgPaths.moveBy(.67*t,-1.9)+e.utils.svgPaths.lineOnAxis("v",2.5),a=e.utils.svgPaths.lineOnAxis("v",-1.5)+e.utils.svgPaths.moveBy(-.92*t,-.5)+e.utils.svgPaths.curve("q",[e.utils.svgPaths.point(-.19*t,-5.5),e.utils.svgPaths.point(0,-11)])+e.utils.svgPaths.moveBy(.92*t,1),h=e.utils.svgPaths.moveBy(-5,n-.7)+e.utils.svgPaths.lineTo(.46*t,-2.1);return{width:t,height:n,pathUp:function(R){return R?o:a},pathDown:function(R){return R?r:h}}},e.geras.HighlightConstantProvider.prototype.makeNotch=function(){return{pathLeft:e.utils.svgPaths.lineOnAxis("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}},e.geras.HighlightConstantProvider.prototype.makeJaggedTeeth=function(){return{pathLeft:e.utils.svgPaths.lineTo(5.1,2.6)+e.utils.svgPaths.moveBy(-10.2,6.8)+e.utils.svgPaths.lineTo(5.1,2.6),height:12,width:10.2}},e.geras.HighlightConstantProvider.prototype.makeStartHat=function(){var t=this.constantProvider.START_HAT.height,n=e.utils.svgPaths.moveBy(25,-8.7)+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(29.7,-6.2),e.utils.svgPaths.point(57.2,-.5),e.utils.svgPaths.point(75,8.7)]),o=e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(17.8,-9.2),e.utils.svgPaths.point(45.3,-14.9),e.utils.svgPaths.point(75,-8.7)])+e.utils.svgPaths.moveTo(100.5,t+.5);return{path:function(r){return r?n:o}}},e.geras.PathObject=function(t,n,o){this.constants=o,this.svgRoot=t,this.svgPathDark=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgRoot),this.svgPath=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.svgPathLight=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPathLight"},this.svgRoot),this.colourDark="#000000",this.style=n},e.utils.object.inherits(e.geras.PathObject,e.blockRendering.PathObject),e.geras.PathObject.prototype.setPath=function(t){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t)},e.geras.PathObject.prototype.setHighlightPath=function(t){this.svgPathLight.setAttribute("d",t)},e.geras.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")},e.geras.PathObject.prototype.applyColour=function(t){this.svgPathLight.style.display="",this.svgPathDark.style.display="",this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),e.geras.PathObject.superClass_.applyColour.call(this,t),this.svgPath.setAttribute("stroke","none")},e.geras.PathObject.prototype.setStyle=function(t){this.style=t,this.colourDark=e.utils.colour.blend("#000",this.style.colourPrimary,.2)||this.colourDark},e.geras.PathObject.prototype.updateHighlighted=function(t){t?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")},e.geras.PathObject.prototype.updateShadow_=function(t){t&&(this.svgPathLight.style.display="none",this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},e.geras.PathObject.prototype.updateDisabled_=function(t){e.geras.PathObject.superClass_.updateDisabled_.call(this,t),t&&this.svgPath.setAttribute("stroke","none")},e.geras.Renderer=function(t){e.geras.Renderer.superClass_.constructor.call(this,t),this.highlightConstants_=null},e.utils.object.inherits(e.geras.Renderer,e.blockRendering.Renderer),e.geras.Renderer.prototype.init=function(t,n){e.geras.Renderer.superClass_.init.call(this,t,n),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()},e.geras.Renderer.prototype.refreshDom=function(t,n){e.geras.Renderer.superClass_.refreshDom.call(this,t,n),this.getHighlightConstants().init()},e.geras.Renderer.prototype.makeConstants_=function(){return new e.geras.ConstantProvider},e.geras.Renderer.prototype.makeRenderInfo_=function(t){return new e.geras.RenderInfo(this,t)},e.geras.Renderer.prototype.makeDrawer_=function(t,n){return new e.geras.Drawer(t,n)},e.geras.Renderer.prototype.makePathObject=function(t,n){return new e.geras.PathObject(t,n,this.getConstants())},e.geras.Renderer.prototype.makeHighlightConstants_=function(){return new e.geras.HighlightConstantProvider(this.getConstants())},e.geras.Renderer.prototype.getHighlightConstants=function(){return this.highlightConstants_},e.blockRendering.register("geras",e.geras.Renderer),e.thrasos={},e.thrasos.RenderInfo=function(t,n){e.thrasos.RenderInfo.superClass_.constructor.call(this,t,n)},e.utils.object.inherits(e.thrasos.RenderInfo,e.blockRendering.RenderInfo),e.thrasos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.thrasos.RenderInfo.prototype.addElemSpacing_=function(){for(var o,t=!1,n=0;o=this.rows[n];n++)o.hasExternalInput&&(t=!0);for(n=0;o=this.rows[n];n++){var r=o.elements;o.elements=[],o.startsWithElemSpacer()&&o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,r[0])));for(var a=0;a<r.length-1;a++){o.elements.push(r[a]);var h=this.getInRowSpacing_(r[a],r[a+1]);o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h))}o.elements.push(r[r.length-1]),o.endsWithElemSpacer()&&(h=this.getInRowSpacing_(r[r.length-1],null),t&&o.hasDummyInput&&(h+=this.constants_.TAB_WIDTH),o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h)))}},e.thrasos.RenderInfo.prototype.getInRowSpacing_=function(t,n){if(!t)return n&&e.blockRendering.Types.isField(n)&&n.isEditable?this.constants_.MEDIUM_PADDING:n&&e.blockRendering.Types.isInlineInput(n)?this.constants_.MEDIUM_LARGE_PADDING:n&&e.blockRendering.Types.isStatementInput(n)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!e.blockRendering.Types.isInput(t)&&!n)return e.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:e.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:e.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:e.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:e.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:e.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInput(t)&&!n){if(e.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!e.blockRendering.Types.isInput(t)&&n&&e.blockRendering.Types.isInput(n)){if(e.blockRendering.Types.isField(t)&&t.isEditable){if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.SMALL_PADDING}else{if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.MEDIUM_LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(n))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(e.blockRendering.Types.isIcon(t)&&n&&!e.blockRendering.Types.isInput(n))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInlineInput(t)&&n&&e.blockRendering.Types.isField(n))return n.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isLeftSquareCorner(t)&&n){if(e.blockRendering.Types.isHat(n))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))return n.notchOffset}return e.blockRendering.Types.isLeftRoundedCorner(t)&&n?n.notchOffset-this.constants_.CORNER_RADIUS:e.blockRendering.Types.isField(t)&&n&&e.blockRendering.Types.isField(n)&&t.isEditable==n.isEditable||n&&e.blockRendering.Types.isJaggedEdge(n)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.thrasos.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){return e.blockRendering.Types.isTopRow(t)&&e.blockRendering.Types.isBottomRow(n)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:e.blockRendering.Types.isTopRow(t)||e.blockRendering.Types.isBottomRow(n)?this.constants_.NO_PADDING:t.hasExternalInput&&n.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&n.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&n.hasStatement||t.hasDummyInput||n.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.thrasos.RenderInfo.prototype.getElemCenterline_=function(t,n){if(e.blockRendering.Types.isSpacer(n))return t.yPos+n.height/2;if(e.blockRendering.Types.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,e.blockRendering.Types.isNextConnection(n)?t+n.height/2:t-n.height/2;if(e.blockRendering.Types.isTopRow(t))return e.blockRendering.Types.isHat(n)?t.capline-n.height/2:t.capline+n.height/2;var o=t.yPos;return e.blockRendering.Types.isField(n)&&t.hasStatement?o+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+n.height/2):o+t.height/2},e.thrasos.RenderInfo.prototype.finalize_=function(){for(var r,t=0,n=0,o=0;r=this.rows[o];o++){r.yPos=n,r.xPos=this.startX,n+=r.height,t=Math.max(t,r.widthWithConnectedBlocks);var a=n-this.topRow.ascenderHeight;r==this.bottomRow&&a<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=a=this.constants_.MIN_BLOCK_HEIGHT-a,n+=a),this.recordElemPositions_(r)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(t=Math.max(t,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.bottomRow.baseline=n-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX,this.height=n,this.startY=this.topRow.capline},e.thrasos.Renderer=function(t){e.thrasos.Renderer.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.thrasos.Renderer,e.blockRendering.Renderer),e.thrasos.Renderer.prototype.makeRenderInfo_=function(t){return new e.thrasos.RenderInfo(this,t)},e.blockRendering.register("thrasos",e.thrasos.Renderer),e.zelos={},e.zelos.ConstantProvider=function(){e.zelos.ConstantProvider.superClass_.constructor.call(this),this.SMALL_PADDING=this.GRID_UNIT=4,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TAB_OFFSET_FROM_TOP=0,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!0,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.replacementGlowFilter_=null},e.utils.object.inherits(e.zelos.ConstantProvider,e.blockRendering.ConstantProvider),e.zelos.ConstantProvider.prototype.setFontConstants_=function(t){e.zelos.ConstantProvider.superClass_.setFontConstants_.call(this,t),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING},e.zelos.ConstantProvider.prototype.init=function(){e.zelos.ConstantProvider.superClass_.init.call(this),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth},e.zelos.ConstantProvider.prototype.setDynamicProperties_=function(t){e.zelos.ConstantProvider.superClass_.setDynamicProperties_.call(this,t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var n=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=n&&!isNaN(n)?n:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(t=Number(t.getComponentStyle("replacementGlowSize")))&&!isNaN(t)?t:this.REPLACEMENT_GLOW_SIZE},e.zelos.ConstantProvider.prototype.dispose=function(){e.zelos.ConstantProvider.superClass_.dispose.call(this),this.selectedGlowFilter_&&e.utils.dom.removeNode(this.selectedGlowFilter_),this.replacementGlowFilter_&&e.utils.dom.removeNode(this.replacementGlowFilter_)},e.zelos.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,n=this.START_HAT_WIDTH;return{height:t,width:n,path:e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(25,-t),e.utils.svgPaths.point(71,-t),e.utils.svgPaths.point(n,0)])}},e.zelos.ConstantProvider.prototype.makeHexagonal=function(){function t(o,r,a){var h=o/2;return e.utils.svgPaths.lineTo(-(a=a?-1:1)*(h=h>n?n:h),o=(r?-1:1)*o/2)+e.utils.svgPaths.lineTo(a*h,o)}var n=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:function(o){return(o/=2)>n?n:o},height:function(o){return o},connectionOffsetY:function(o){return o/2},connectionOffsetX:function(o){return-o},pathDown:function(o){return t(o,!1,!1)},pathUp:function(o){return t(o,!0,!1)},pathRightDown:function(o){return t(o,!1,!0)},pathRightUp:function(o){return t(o,!1,!0)}}},e.zelos.ConstantProvider.prototype.makeRounded=function(){function t(r,a,h){var R=r>o?r-o:0;return e.utils.svgPaths.arc("a","0 0,1",r=(r>o?o:r)/2,e.utils.svgPaths.point((a?-1:1)*r,(a?-1:1)*r))+e.utils.svgPaths.lineOnAxis("v",(h?1:-1)*R)+e.utils.svgPaths.arc("a","0 0,1",r,e.utils.svgPaths.point((a?1:-1)*r,(a?-1:1)*r))}var n=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,o=2*n;return{type:this.SHAPES.ROUND,isDynamic:!0,width:function(r){return(r/=2)>n?n:r},height:function(r){return r},connectionOffsetY:function(r){return r/2},connectionOffsetX:function(r){return-r},pathDown:function(r){return t(r,!1,!1)},pathUp:function(r){return t(r,!0,!1)},pathRightDown:function(r){return t(r,!1,!0)},pathRightUp:function(r){return t(r,!1,!0)}}},e.zelos.ConstantProvider.prototype.makeSquared=function(){function t(o,r,a){return o-=2*n,e.utils.svgPaths.arc("a","0 0,1",n,e.utils.svgPaths.point((r?-1:1)*n,(r?-1:1)*n))+e.utils.svgPaths.lineOnAxis("v",(a?1:-1)*o)+e.utils.svgPaths.arc("a","0 0,1",n,e.utils.svgPaths.point((r?1:-1)*n,(r?-1:1)*n))}var n=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:function(o){return n},height:function(o){return o},connectionOffsetY:function(o){return o/2},connectionOffsetX:function(o){return-o},pathDown:function(o){return t(o,!1,!1)},pathUp:function(o){return t(o,!0,!1)},pathRightDown:function(o){return t(o,!1,!0)},pathRightUp:function(o){return t(o,!1,!0)}}},e.zelos.ConstantProvider.prototype.shapeFor=function(t){var n=t.getCheck();switch(!n&&t.targetConnection&&(n=t.targetConnection.getCheck()),t.type){case e.connectionTypes.INPUT_VALUE:case e.connectionTypes.OUTPUT_VALUE:if(null!=(t=t.getSourceBlock().getOutputShape()))switch(t){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return n&&-1!=n.indexOf("Boolean")?this.HEXAGONAL:(n&&-1!=n.indexOf("Number")||n&&n.indexOf("String"),this.ROUNDED);case e.connectionTypes.PREVIOUS_STATEMENT:case e.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}},e.zelos.ConstantProvider.prototype.makeNotch=function(){function t(nt){return e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/2,0),e.utils.svgPaths.point(nt*a*3/4,R/2),e.utils.svgPaths.point(nt*a,R)])+e.utils.svgPaths.line([e.utils.svgPaths.point(nt*a,h)])+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/4,R/2),e.utils.svgPaths.point(nt*a/2,R),e.utils.svgPaths.point(nt*a,R)])+e.utils.svgPaths.lineOnAxis("h",nt*r)+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/2,0),e.utils.svgPaths.point(nt*a*3/4,-R/2),e.utils.svgPaths.point(nt*a,-R)])+e.utils.svgPaths.line([e.utils.svgPaths.point(nt*a,-h)])+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/4,-R/2),e.utils.svgPaths.point(nt*a/2,-R),e.utils.svgPaths.point(nt*a,-R)])}var n=this.NOTCH_WIDTH,o=this.NOTCH_HEIGHT,r=n/3,a=r/3,h=o/2,R=h/2,L=t(1),W=t(-1);return{type:this.SHAPES.NOTCH,width:n,height:o,pathLeft:L,pathRight:W}},e.zelos.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS,n=e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(-t,t)),o=e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(-t,t));return{width:t,height:t,pathTop:n,pathBottom:e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(t,t)),rightWidth:t,rightHeight:t,pathTopRight:o,pathBottomRight:e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(t,t))}},e.zelos.ConstantProvider.prototype.generateSecondaryColour_=function(t){return e.utils.colour.blend("#000",t,.15)||t},e.zelos.ConstantProvider.prototype.generateTertiaryColour_=function(t){return e.utils.colour.blend("#000",t,.25)||t},e.zelos.ConstantProvider.prototype.createDom=function(t,n,o){e.zelos.ConstantProvider.superClass_.createDom.call(this,t,n,o),t=e.utils.dom.createSvgElement(e.utils.Svg.DEFS,{},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},n),o=e.utils.dom.createSvgElement(e.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},o),e.utils.dom.createSvgElement(e.utils.Svg.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},n),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},n),this.selectedGlowFilterId=n.id,this.selectedGlowFilter_=n,t=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},t),this.replacementGlowFilterId=t.id,this.replacementGlowFilter_=t},e.zelos.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText,",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect:not(.blocklyDropdownRect),",t+" .blocklyEditableText>rect:not(.blocklyDropdownRect) {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text,",t+" .blocklyNonEditableText>g>text,",t+" .blocklyEditableText>g>text {","fill: #575E75;","}",t+" .blocklyFlyoutLabelText {","fill: #575E75;","}",t+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>rect,",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","color: #575E75;","}",t+" .blocklyDropdownText {","fill: #fff !important;","}",t+".blocklyWidgetDiv .goog-menuitem,",t+".blocklyDropDownDiv .goog-menuitem {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","}",t+".blocklyDropDownDiv .goog-menuitem-content {","color: #fff;","}",t+" .blocklyHighlightedConnectionPath {","stroke: "+this.SELECTED_GLOW_COLOUR+";","}",t+" .blocklyDisabled > .blocklyOutlinePath {","fill: url(#blocklyDisabledPattern"+this.randomIdentifier+")","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},e.zelos.TopRow=function(t){e.zelos.TopRow.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.zelos.TopRow,e.blockRendering.TopRow),e.zelos.TopRow.prototype.endsWithElemSpacer=function(){return!1},e.zelos.TopRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection||(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection},e.zelos.TopRow.prototype.hasRightSquareCorner=function(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection},e.zelos.BottomRow=function(t){e.zelos.BottomRow.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.zelos.BottomRow,e.blockRendering.BottomRow),e.zelos.BottomRow.prototype.endsWithElemSpacer=function(){return!1},e.zelos.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection},e.zelos.BottomRow.prototype.hasRightSquareCorner=function(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection},e.zelos.RightConnectionShape=function(t){e.zelos.RightConnectionShape.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.getType("RIGHT_CONNECTION"),this.width=this.height=0},e.utils.object.inherits(e.zelos.RightConnectionShape,e.blockRendering.Measurable),e.zelos.RenderInfo=function(t,n){e.zelos.RenderInfo.superClass_.constructor.call(this,t,n),this.topRow=new e.zelos.TopRow(this.constants_),this.bottomRow=new e.zelos.BottomRow(this.constants_),this.isInline=!0,this.isMultiRow=!n.getInputsInline()||n.isCollapsed(),this.hasStatementInput=0<n.statementInputCount,this.rightSide=this.outputConnection?new e.zelos.RightConnectionShape(this.constants_):null},e.utils.object.inherits(e.zelos.RenderInfo,e.blockRendering.RenderInfo),e.zelos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.zelos.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},e.zelos.RenderInfo.prototype.shouldStartNewRow_=function(t,n){return!!n&&(t.type==e.inputTypes.STATEMENT||n.type==e.inputTypes.STATEMENT||(t.type==e.inputTypes.VALUE||t.type==e.inputTypes.DUMMY)&&(!this.isInline||this.isMultiRow))},e.zelos.RenderInfo.prototype.getDesiredRowWidth_=function(t){return t.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):e.zelos.RenderInfo.superClass_.getDesiredRowWidth_.call(this,t)},e.zelos.RenderInfo.prototype.getInRowSpacing_=function(t,n){return t&&n||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!t&&n&&e.blockRendering.Types.isStatementInput(n)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:t&&e.blockRendering.Types.isLeftRoundedCorner(t)&&n&&(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))?n.notchOffset-this.constants_.CORNER_RADIUS:t&&e.blockRendering.Types.isLeftSquareCorner(t)&&n&&e.blockRendering.Types.isHat(n)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING},e.zelos.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){if(e.blockRendering.Types.isTopRow(t)&&e.blockRendering.Types.isBottomRow(n))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;var o=e.blockRendering.Types.isInputRow(t)&&t.hasStatement,r=e.blockRendering.Types.isInputRow(n)&&n.hasStatement;return r||o?(t=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),r&&o?Math.max(t,this.constants_.DUMMY_INPUT_MIN_HEIGHT):t):e.blockRendering.Types.isTopRow(t)?t.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):e.blockRendering.Types.isBottomRow(n)?this.outputConnection?!n.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},e.zelos.RenderInfo.prototype.getSpacerRowWidth_=function(t,n){var o=this.width-this.startX;return e.blockRendering.Types.isInputRow(t)&&t.hasStatement||e.blockRendering.Types.isInputRow(n)&&n.hasStatement?Math.max(o,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):o},e.zelos.RenderInfo.prototype.getElemCenterline_=function(t,n){if(t.hasStatement&&!e.blockRendering.Types.isSpacer(n)&&!e.blockRendering.Types.isStatementInput(n))return t.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(e.blockRendering.Types.isInlineInput(n)){var o=n.connectedBlock;if(o&&o.outputConnection&&o.nextConnection)return t.yPos+o.height/2}return e.zelos.RenderInfo.superClass_.getElemCenterline_.call(this,t,n)},e.zelos.RenderInfo.prototype.addInput_=function(t,n){t.type==e.inputTypes.DUMMY&&n.hasDummyInput&&n.align==e.constants.ALIGN.LEFT&&t.align==e.constants.ALIGN.RIGHT&&(n.rightAlignedDummyInput=t),e.zelos.RenderInfo.superClass_.addInput_.call(this,t,n)},e.zelos.RenderInfo.prototype.addAlignmentPadding_=function(t,n){if(t.rightAlignedDummyInput){for(var o,a,r=0;(a=t.elements[r])&&(e.blockRendering.Types.isSpacer(a)&&(o=a),!e.blockRendering.Types.isField(a)||a.parentInput!=t.rightAlignedDummyInput);r++);if(o)return o.width+=n,void(t.width+=n)}e.zelos.RenderInfo.superClass_.addAlignmentPadding_.call(this,t,n)},e.zelos.RenderInfo.prototype.adjustXPosition_=function(){for(var t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH,n=t,o=2;o<this.rows.length-1;o+=2){var r=this.rows[o-1],a=this.rows[o],h=this.rows[o+1];if(r=2==o?!!this.topRow.hasPreviousConnection:!!r.followsStatement,h=o+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!h.precedesStatement,e.blockRendering.Types.isInputRow(a)&&a.hasStatement)a.measure(),n=a.width-a.getLastInput().width+t;else if(r&&(2==o||h)&&e.blockRendering.Types.isInputRow(a)&&!a.hasStatement){h=a.xPos,r=null;for(var L,R=0;L=a.elements[R];R++)e.blockRendering.Types.isSpacer(L)&&(r=L),!(r&&(e.blockRendering.Types.isField(L)||e.blockRendering.Types.isInput(L))&&h<n)||e.blockRendering.Types.isField(L)&&(L.field instanceof e.FieldLabel||L.field instanceof e.FieldImage)||(r.width+=n-h),h+=L.width}}},e.zelos.RenderInfo.prototype.finalizeOutputConnection_=function(){if(this.outputConnection&&this.outputConnection.isDynamicShape){for(var o,t=0,n=0;o=this.rows[n];n++)o.yPos=t,t+=o.height;this.height=t,t=this.outputConnection.shape.height(n=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height),n=this.outputConnection.shape.width(n),this.outputConnection.height=t,this.outputConnection.width=n,this.outputConnection.startX=n,this.outputConnection.connectionOffsetY=this.outputConnection.shape.connectionOffsetY(t),this.outputConnection.connectionOffsetX=this.outputConnection.shape.connectionOffsetX(n),o=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(o=n,this.rightSide.height=t,this.rightSide.width=o,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+o),this.startX=n,this.width+=n+o,this.widthWithChildren+=n+o}},e.zelos.RenderInfo.prototype.finalizeHorizontalAlignment_=function(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var o,t=0,n=0;o=this.rows[n];n++)if(e.blockRendering.Types.isInputRow(o)){t=o.elements[o.elements.length-2];var r=this.getNegativeSpacing_(o.elements[1]),a=this.getNegativeSpacing_(t),h=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-(t=r+a)<h&&(r=(t=this.width-h)/2,a=t/2),o.elements.unshift(new e.blockRendering.InRowSpacer(this.constants_,-r)),o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,-a))}if(t)for(this.width-=t,this.widthWithChildren-=t,this.rightSide.xPos-=t,n=0;o=this.rows[n];n++)e.blockRendering.Types.isTopOrBottomRow(o)&&(o.elements[1].width-=t,o.elements[1].widthWithConnectedBlocks-=t),o.width-=t,o.widthWithConnectedBlocks-=t}},e.zelos.RenderInfo.prototype.getNegativeSpacing_=function(t){if(!t)return 0;var n=this.outputConnection.width,o=this.outputConnection.shape.type,r=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)return o===r.SHAPES.ROUND?n-(o=this.height/2>(o=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH)?o:this.height/2)*(1-Math.sin(Math.acos((o-this.constants_.SMALL_PADDING)/o))):0;if(e.blockRendering.Types.isInlineInput(t)){var a=t.connectedBlock;return t=a?a.pathObject.outputShapeType:t.shape.type,a&&a.outputConnection&&(a.statementInputCount||a.nextConnection)||o==r.SHAPES.HEXAGONAL&&o!=t?0:n-this.constants_.SHAPE_IN_SHAPE_PADDING[o][t]}return e.blockRendering.Types.isField(t)?o==r.SHAPES.ROUND&&t.field instanceof e.FieldTextInput?n-2.75*r.GRID_UNIT:n-this.constants_.SHAPE_IN_SHAPE_PADDING[o][0]:e.blockRendering.Types.isIcon(t)?this.constants_.SMALL_PADDING:0},e.zelos.RenderInfo.prototype.finalizeVerticalAlignment_=function(){if(!this.outputConnection)for(var t=2;t<this.rows.length-1;t+=2){var n=this.rows[t-1],o=this.rows[t],r=this.rows[t+1],a=2==t,h=t+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!r.precedesStatement;if(a?this.topRow.hasPreviousConnection:n.followsStatement){var R=3==o.elements.length&&(o.elements[1].field instanceof e.FieldLabel||o.elements[1].field instanceof e.FieldImage);if(!a&&R)n.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.MEDIUM_PADDING;else if(a||h){if(h){for(a=!1,h=0;R=o.elements[h];h++)if(e.blockRendering.Types.isInlineInput(R)&&R.connectedBlock&&!R.connectedBlock.isShadow()&&40<=R.connectedBlock.getHeightWidth().height){a=!0;break}a&&(n.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.SMALL_PADDING)}}else n.height+=this.constants_.SMALL_PADDING}}},e.zelos.RenderInfo.prototype.finalize_=function(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),e.zelos.RenderInfo.superClass_.finalize_.call(this),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)},e.zelos.Drawer=function(t,n){e.zelos.Drawer.superClass_.constructor.call(this,t,n)},e.utils.object.inherits(e.zelos.Drawer,e.blockRendering.Drawer),e.zelos.Drawer.prototype.draw=function(){var t=this.block_.pathObject;t.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),t.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&t.flipRTL(),e.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_(),this.info_.outputConnection&&(t.outputShapeType=this.info_.outputConnection.shape.type),t.endDrawing()},e.zelos.Drawer.prototype.drawOutline_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):e.zelos.Drawer.superClass_.drawOutline_.call(this)},e.zelos.Drawer.prototype.drawLeft_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():e.zelos.Drawer.superClass_.drawLeft_.call(this)},e.zelos.Drawer.prototype.drawRightSideRow_=function(t){if(!(0>=t.height))if(t.precedesStatement||t.followsStatement){var n=this.constants_.INSIDE_CORNERS.rightHeight;this.outlinePath_+=(t.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<(n=t.height-(t.precedesStatement?n:0))?e.utils.svgPaths.lineOnAxis("V",t.yPos+n):"")+(t.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},e.zelos.Drawer.prototype.drawRightDynamicConnection_=function(){this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)},e.zelos.Drawer.prototype.drawLeftDynamicConnection_=function(){this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"},e.zelos.Drawer.prototype.drawFlatTop_=function(){var t=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=e.utils.svgPaths.moveBy(t.xPos,this.info_.startY),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("h",t.width)},e.zelos.Drawer.prototype.drawFlatBottom_=function(){var t=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.baseline),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("h",-t.width)},e.zelos.Drawer.prototype.drawInlineInput_=function(t){this.positionInlineInputConnection_(t);var n=t.input.name;if(!t.connectedBlock&&!this.info_.isInsertionMarker){var o=t.width-2*t.connectionWidth;t=e.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-t.height/2)+e.utils.svgPaths.lineOnAxis("h",o)+t.shape.pathRightDown(t.height)+e.utils.svgPaths.lineOnAxis("h",-o)+t.shape.pathUp(t.height)+"z",this.block_.pathObject.setOutlinePath(n,t)}},e.zelos.Drawer.prototype.drawStatementInput_=function(t){var n=t.getLastInput(),o=n.xPos+n.notchOffset+n.shape.width,r=n.shape.pathRight+e.utils.svgPaths.lineOnAxis("h",-(n.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,a=t.height-2*this.constants_.INSIDE_CORNERS.height;n=this.constants_.INSIDE_CORNERS.pathBottom+e.utils.svgPaths.lineOnAxis("h",n.notchOffset-this.constants_.INSIDE_CORNERS.width)+(n.connectedBottomNextConnection?"":n.shape.pathLeft),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",o)+r+e.utils.svgPaths.lineOnAxis("v",a)+n+e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},e.zelos.MarkerSvg=function(t,n,o){e.zelos.MarkerSvg.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.zelos.MarkerSvg,e.blockRendering.MarkerSvg),e.zelos.MarkerSvg.prototype.showWithInputOutput_=function(t){var n=t.getSourceBlock();t=t.getLocation().getOffsetInBlock(),this.positionCircle_(t.x,t.y),this.setParent_(n),this.showCurrent_()},e.zelos.MarkerSvg.prototype.showWithOutput_=function(t){this.showWithInputOutput_(t)},e.zelos.MarkerSvg.prototype.showWithInput_=function(t){this.showWithInputOutput_(t)},e.zelos.MarkerSvg.prototype.showWithBlock_=function(t){var n=(t=t.getLocation()).getHeightWidth();this.positionRect_(0,0,n.width,n.height),this.setParent_(t),this.showCurrent_()},e.zelos.MarkerSvg.prototype.positionCircle_=function(t,n){this.markerCircle_.setAttribute("cx",t),this.markerCircle_.setAttribute("cy",n),this.currentMarkerSvg=this.markerCircle_},e.zelos.MarkerSvg.prototype.hide=function(){e.zelos.MarkerSvg.superClass_.hide.call(this),this.markerCircle_.style.display="none"},e.zelos.MarkerSvg.prototype.createDomInternal_=function(){if(e.zelos.MarkerSvg.superClass_.createDomInternal_.call(this),this.markerCircle_=e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var t=this.getBlinkProperties_();e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerCircle_)}return this.markerSvg_},e.zelos.MarkerSvg.prototype.applyColour_=function(t){e.zelos.MarkerSvg.superClass_.applyColour_.call(this,t),this.markerCircle_.setAttribute("fill",this.colour_),this.markerCircle_.setAttribute("stroke",this.colour_),this.isCursor()&&this.markerCircle_.firstChild.setAttribute("values",this.colour_+";transparent;transparent;")},e.zelos.PathObject=function(t,n,o){e.zelos.PathObject.superClass_.constructor.call(this,t,n,o),this.constants=o,this.svgPathSelected_=null,this.outlines_=Object.create(null),this.outputShapeType=this.remainingOutlines_=null},e.utils.object.inherits(e.zelos.PathObject,e.blockRendering.PathObject),e.zelos.PathObject.prototype.setPath=function(t){e.zelos.PathObject.superClass_.setPath.call(this,t),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",t)},e.zelos.PathObject.prototype.applyColour=function(t){for(var n in e.zelos.PathObject.superClass_.applyColour.call(this,t),t.isShadow()&&t.getParent()&&this.svgPath.setAttribute("stroke",t.getParent().style.colourTertiary),this.outlines_)this.outlines_[n].setAttribute("fill",this.style.colourTertiary)},e.zelos.PathObject.prototype.flipRTL=function(){for(var t in e.zelos.PathObject.superClass_.flipRTL.call(this),this.outlines_)this.outlines_[t].setAttribute("transform","scale(-1 1)")},e.zelos.PathObject.prototype.updateSelected=function(t){this.setClass_("blocklySelected",t),t?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(!0),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)},e.zelos.PathObject.prototype.updateReplacementFade=function(t){this.setClass_("blocklyReplaceable",t),t?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")},e.zelos.PathObject.prototype.updateShapeForInputHighlight=function(t,n){t=t.getParentInput().name,(t=this.getOutlinePath_(t))&&(n?t.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):t.removeAttribute("filter"))},e.zelos.PathObject.prototype.beginDrawing=function(){for(var t in this.remainingOutlines_=Object.create(null),this.outlines_)this.remainingOutlines_[t]=1},e.zelos.PathObject.prototype.endDrawing=function(){if(this.remainingOutlines_)for(var t in this.remainingOutlines_)this.removeOutlinePath_(t);this.remainingOutlines_=null},e.zelos.PathObject.prototype.setOutlinePath=function(t,n){(t=this.getOutlinePath_(t)).setAttribute("d",n),t.setAttribute("fill",this.style.colourTertiary)},e.zelos.PathObject.prototype.getOutlinePath_=function(t){return this.outlines_[t]||(this.outlines_[t]=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines_&&delete this.remainingOutlines_[t],this.outlines_[t]},e.zelos.PathObject.prototype.removeOutlinePath_=function(t){this.outlines_[t].parentNode.removeChild(this.outlines_[t]),delete this.outlines_[t]},e.zelos.Renderer=function(t){e.zelos.Renderer.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.zelos.Renderer,e.blockRendering.Renderer),e.zelos.Renderer.prototype.makeConstants_=function(){return new e.zelos.ConstantProvider},e.zelos.Renderer.prototype.makeRenderInfo_=function(t){return new e.zelos.RenderInfo(this,t)},e.zelos.Renderer.prototype.makeDrawer_=function(t,n){return new e.zelos.Drawer(t,n)},e.zelos.Renderer.prototype.makeMarkerDrawer=function(t,n){return new e.zelos.MarkerSvg(t,this.getConstants(),n)},e.zelos.Renderer.prototype.makePathObject=function(t,n){return new e.zelos.PathObject(t,n,this.getConstants())},e.zelos.Renderer.prototype.shouldHighlightConnection=function(t){return t.type!=e.connectionTypes.INPUT_VALUE&&t.type!==e.connectionTypes.OUTPUT_VALUE},e.zelos.Renderer.prototype.getConnectionPreviewMethod=function(t,n,o){return n.type==e.connectionTypes.OUTPUT_VALUE?t.isConnected()?e.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:e.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:e.zelos.Renderer.superClass_.getConnectionPreviewMethod(t,n,o)},e.blockRendering.register("zelos",e.zelos.Renderer),e.Themes.Dark=e.Theme.defineTheme("dark",{base:e.Themes.Classic,componentStyles:{workspaceBackgroundColour:"#1e1e1e",toolboxBackgroundColour:"blackBackground",toolboxForegroundColour:"#fff",flyoutBackgroundColour:"#252526",flyoutForegroundColour:"#ccc",flyoutOpacity:1,scrollbarColour:"#797979",insertionMarkerColour:"#fff",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#d0d0d0",blackBackground:"#333"}}),e.Themes.Deuteranopia={},e.Themes.Deuteranopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#f2a72c",colourSecondary:"#f1c172",colourTertiary:"#da921c"},list_blocks:{colourPrimary:"#7d65ab",colourSecondary:"#a88be0",colourTertiary:"#66518e"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#795a07",colourSecondary:"#ac8726",colourTertiary:"#c4a03f"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"},variable_dynamic_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"}},e.Themes.Deuteranopia.categoryStyles={colour_category:{colour:"#f2a72c"},list_category:{colour:"#7d65ab"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#795a07"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#47025a"},variable_dynamic_category:{colour:"#47025a"}},e.Themes.Deuteranopia=new e.Theme("deuteranopia",e.Themes.Deuteranopia.defaultBlockStyles,e.Themes.Deuteranopia.categoryStyles),e.Themes.HighContrast={},e.Themes.HighContrast.defaultBlockStyles={colour_blocks:{colourPrimary:"#a52714",colourSecondary:"#FB9B8C",colourTertiary:"#FBE1DD"},list_blocks:{colourPrimary:"#4a148c",colourSecondary:"#AD7BE9",colourTertiary:"#CDB6E9"},logic_blocks:{colourPrimary:"#01579b",colourSecondary:"#64C7FF",colourTertiary:"#C5EAFF"},loop_blocks:{colourPrimary:"#33691e",colourSecondary:"#9AFF78",colourTertiary:"#E1FFD7"},math_blocks:{colourPrimary:"#1a237e",colourSecondary:"#8A9EFF",colourTertiary:"#DCE2FF"},procedure_blocks:{colourPrimary:"#006064",colourSecondary:"#77E6EE",colourTertiary:"#CFECEE"},text_blocks:{colourPrimary:"#004d40",colourSecondary:"#5ae27c",colourTertiary:"#D2FFDD"},variable_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},variable_dynamic_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},hat_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB",hat:"cap"}},e.Themes.HighContrast.categoryStyles={colour_category:{colour:"#a52714"},list_category:{colour:"#4a148c"},logic_category:{colour:"#01579b"},loop_category:{colour:"#33691e"},math_category:{colour:"#1a237e"},procedure_category:{colour:"#006064"},text_category:{colour:"#004d40"},variable_category:{colour:"#880e4f"},variable_dynamic_category:{colour:"#880e4f"}},e.Themes.HighContrast=new e.Theme("highcontrast",e.Themes.HighContrast.defaultBlockStyles,e.Themes.HighContrast.categoryStyles),e.Themes.HighContrast.setComponentStyle("selectedGlowColour","#000000"),e.Themes.HighContrast.setComponentStyle("selectedGlowSize",1),e.Themes.HighContrast.setComponentStyle("replacementGlowColour","#000000"),e.Themes.HighContrast.setFontStyle({family:null,weight:null,size:16}),e.Themes.Tritanopia={},e.Themes.Tritanopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#05427f",colourSecondary:"#2974c0",colourTertiary:"#2d74bb"},list_blocks:{colourPrimary:"#b69ce8",colourSecondary:"#ccbaef",colourTertiary:"#9176c5"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#aa1846",colourSecondary:"#d36185",colourTertiary:"#7c1636"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"},variable_dynamic_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"}},e.Themes.Tritanopia.categoryStyles={colour_category:{colour:"#05427f"},list_category:{colour:"#b69ce8"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#aa1846"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#4b2d84"},variable_dynamic_category:{colour:"#4b2d84"}},e.Themes.Tritanopia=new e.Theme("tritanopia",e.Themes.Tritanopia.defaultBlockStyles,e.Themes.Tritanopia.categoryStyles),e.requires={},e}.apply(X,[]))&&(B.exports=m)},89519:function(B,X,_){var m,e;m=[_(71738)],void 0!==(e=function(t){"use strict";return t.Blocks={},t.Blocks}.apply(X,m))&&(B.exports=e)},71738:function(B,X,_){var m,e;m=[_(34316)],void 0!==(e=function(t){"use strict";return t.Blocks.colour={},t.Constants={},t.Constants.Colour={},t.Constants.Colour.HUE=20,t.defineBlocksWithJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),t.Constants.Lists={},t.Constants.Lists.HUE=260,t.defineBlocksWithJsonArray([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),t.Blocks.lists_create_with={init:function(){this.setHelpUrl(t.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new t.Mutator(["lists_create_with_item"])),this.setTooltip(t.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("items",this.itemCount_),n},domToMutation:function(n){this.itemCount_=parseInt(n.getAttribute("items"),10),this.updateShape_()},decompose:function(n){var o=n.newBlock("lists_create_with_container");o.initSvg();for(var r=o.getInput("STACK").connection,a=0;a<this.itemCount_;a++){var h=n.newBlock("lists_create_with_item");h.initSvg(),r.connect(h.previousConnection),r=h.nextConnection}return o},compose:function(n){var o=n.getInputTargetBlock("STACK");for(n=[];o&&!o.isInsertionMarker();)n.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();for(o=0;o<this.itemCount_;o++){var r=this.getInput("ADD"+o).connection.targetConnection;r&&-1==n.indexOf(r)&&r.disconnect()}for(this.itemCount_=n.length,this.updateShape_(),o=0;o<this.itemCount_;o++)t.Mutator.reconnect(n[o],this,"ADD"+o)},saveConnections:function(n){n=n.getInputTargetBlock("STACK");for(var o=0;n;){var r=this.getInput("ADD"+o);n.valueConnection_=r&&r.connection.targetConnection,o++,n=n.nextConnection&&n.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(t.Msg.LISTS_CREATE_EMPTY_TITLE);for(var n=0;n<this.itemCount_;n++)if(!this.getInput("ADD"+n)){var o=this.appendValueInput("ADD"+n).setAlign(t.ALIGN_RIGHT);0==n&&o.appendField(t.Msg.LISTS_CREATE_WITH_INPUT_WITH)}for(;this.getInput("ADD"+n);)this.removeInput("ADD"+n),n++}},t.Blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(t.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},t.Blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},t.Blocks.lists_indexOf={init:function(){var n=[[t.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[t.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(t.Msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new t.FieldDropdown(n),"END"),this.setInputsInline(!0);var o=this;this.setTooltip(function(){return t.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",o.workspace.options.oneBasedIndex?"0":"-1")})}},t.Blocks.lists_getIndex={init:function(){var n=[[t.Msg.LISTS_GET_INDEX_GET,"GET"],[t.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[t.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[t.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),n=new t.FieldDropdown(n,function(r){r="REMOVE"==r,this.getSourceBlock().updateStatement_(r)}),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(n,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),t.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);var o=this;this.setTooltip(function(){var r=o.getFieldValue("MODE"),a=o.getFieldValue("WHERE"),h="";switch(r+" "+a){case"GET FROM_START":case"GET FROM_END":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"==a||"FROM_END"==a)&&(h+="  "+("FROM_START"==a?t.Msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",o.workspace.options.oneBasedIndex?"#1":"#0")),h})},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");n.setAttribute("statement",!this.outputConnection);var o=this.getInput("AT").type==t.INPUT_VALUE;return n.setAttribute("at",o),n},domToMutation:function(n){var o="true"==n.getAttribute("statement");this.updateStatement_(o),n="false"!=n.getAttribute("at"),this.updateAt_(n)},updateStatement_:function(n){n!=!this.outputConnection&&(this.unplug(!0,!0),n?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(n){this.removeInput("AT"),this.removeInput("ORDINAL",!0),n?(this.appendValueInput("AT").setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var o=new t.FieldDropdown(this.WHERE_OPTIONS,function(r){var a="FROM_START"==r||"FROM_END"==r;if(a!=n){var h=this.getSourceBlock();return h.updateAt_(a),h.setFieldValue(r,"WHERE"),null}});this.getInput("AT").appendField(o,"WHERE"),t.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},t.Blocks.lists_setIndex={init:function(){var n=[[t.Msg.LISTS_SET_INDEX_SET,"SET"],[t.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[t.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new t.FieldDropdown(n),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(t.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);var o=this;this.setTooltip(function(){var r=o.getFieldValue("MODE"),a=o.getFieldValue("WHERE"),h="";switch(r+" "+a){case"SET FROM_START":case"SET FROM_END":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"==a||"FROM_END"==a)&&(h+="  "+t.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",o.workspace.options.oneBasedIndex?"#1":"#0")),h})},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o=this.getInput("AT").type==t.INPUT_VALUE;return n.setAttribute("at",o),n},domToMutation:function(n){n="false"!=n.getAttribute("at"),this.updateAt_(n)},updateAt_:function(n){this.removeInput("AT"),this.removeInput("ORDINAL",!0),n?(this.appendValueInput("AT").setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var o=new t.FieldDropdown(this.WHERE_OPTIONS,function(r){var a="FROM_START"==r||"FROM_END"==r;if(a!=n){var h=this.getSourceBlock();return h.updateAt_(a),h.setFieldValue(r,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(o,"WHERE")}},t.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[t.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(t.Msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o=this.getInput("AT1").type==t.INPUT_VALUE;return n.setAttribute("at1",o),o=this.getInput("AT2").type==t.INPUT_VALUE,n.setAttribute("at2",o),n},domToMutation:function(n){var o="true"==n.getAttribute("at1");n="true"==n.getAttribute("at2"),this.updateAt_(1,o),this.updateAt_(2,n)},updateAt_:function(n,o){this.removeInput("AT"+n),this.removeInput("ORDINAL"+n,!0),o?(this.appendValueInput("AT"+n).setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+n).appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+n);var r=new t.FieldDropdown(this["WHERE_OPTIONS_"+n],function(a){var h="FROM_START"==a||"FROM_END"==a;if(h!=o){var R=this.getSourceBlock();return R.updateAt_(n,h),R.setFieldValue(a,"WHERE"+n),null}});this.getInput("AT"+n).appendField(r,"WHERE"+n),1==n&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),t.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},t.Blocks.lists_sort={init:function(){this.jsonInit({message0:t.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[t.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[t.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[t.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[t.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[t.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:t.Msg.LISTS_SORT_TOOLTIP,helpUrl:t.Msg.LISTS_SORT_HELPURL})}},t.Blocks.lists_split={init:function(){var n=this,o=new t.FieldDropdown([[t.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[t.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(r){n.updateType_(r)});this.setHelpUrl(t.Msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(o,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(t.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(function(){var r=n.getFieldValue("MODE");if("SPLIT"==r)return t.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"==r)return t.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+r)})},updateType_:function(n){if(this.getFieldValue("MODE")!=n){var o=this.getInput("INPUT").connection;o.setShadowDom(null);var r=o.targetBlock();r&&(o.disconnect(),r.isShadow()?r.dispose():this.bumpNeighbours())}"SPLIT"==n?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("mode",this.getFieldValue("MODE")),n},domToMutation:function(n){this.updateType_(n.getAttribute("mode"))}},t.Blocks.logic={},t.Constants.Logic={},t.Constants.Logic.HUE=210,t.defineBlocksWithJsonArray([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200f<","LT"],["\u200f\u2264","LTE"],["\u200f>","GT"],["\u200f\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]}]),t.defineBlocksWithJsonArray([{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),t.Constants.Logic.TOOLTIPS_BY_OP={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"},t.Extensions.register("logic_op_tooltip",t.Extensions.buildTooltipForDropdown("OP",t.Constants.Logic.TOOLTIPS_BY_OP)),t.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN={elseifCount_:0,elseCount_:0,suppressPrefixSuffix:!0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var n=t.utils.xml.createElement("mutation");return this.elseifCount_&&n.setAttribute("elseif",this.elseifCount_),this.elseCount_&&n.setAttribute("else",1),n},domToMutation:function(n){this.elseifCount_=parseInt(n.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(n.getAttribute("else"),10)||0,this.rebuildShape_()},decompose:function(n){var o=n.newBlock("controls_if_if");o.initSvg();for(var r=o.nextConnection,a=1;a<=this.elseifCount_;a++){var h=n.newBlock("controls_if_elseif");h.initSvg(),r.connect(h.previousConnection),r=h.nextConnection}return this.elseCount_&&((n=n.newBlock("controls_if_else")).initSvg(),r.connect(n.previousConnection)),o},compose:function(n){n=n.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;for(var o=[null],r=[null],a=null;n&&!n.isInsertionMarker();){switch(n.type){case"controls_if_elseif":this.elseifCount_++,o.push(n.valueConnection_),r.push(n.statementConnection_);break;case"controls_if_else":this.elseCount_++,a=n.statementConnection_;break;default:throw TypeError("Unknown block type: "+n.type)}n=n.nextConnection&&n.nextConnection.targetBlock()}this.updateShape_(),this.reconnectChildBlocks_(o,r,a)},saveConnections:function(n){n=n.nextConnection.targetBlock();for(var o=1;n;){switch(n.type){case"controls_if_elseif":var r=this.getInput("IF"+o),a=this.getInput("DO"+o);n.valueConnection_=r&&r.connection.targetConnection,n.statementConnection_=a&&a.connection.targetConnection,o++;break;case"controls_if_else":a=this.getInput("ELSE"),n.statementConnection_=a&&a.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+n.type)}n=n.nextConnection&&n.nextConnection.targetBlock()}},rebuildShape_:function(){var n=[null],o=[null],r=null;this.getInput("ELSE")&&(r=this.getInput("ELSE").connection.targetConnection);for(var a=1;this.getInput("IF"+a);){var h=this.getInput("IF"+a),R=this.getInput("DO"+a);n.push(h.connection.targetConnection),o.push(R.connection.targetConnection),a++}this.updateShape_(),this.reconnectChildBlocks_(n,o,r)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var n=1;this.getInput("IF"+n);)this.removeInput("IF"+n),this.removeInput("DO"+n),n++;for(n=1;n<=this.elseifCount_;n++)this.appendValueInput("IF"+n).setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+n).appendField(t.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(t.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(n,o,r){for(var a=1;a<=this.elseifCount_;a++)t.Mutator.reconnect(n[a],this,"IF"+a),t.Mutator.reconnect(o[a],this,"DO"+a);t.Mutator.reconnect(r,this,"ELSE")}},t.Extensions.registerMutator("controls_if_mutator",t.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN,null,["controls_if_elseif","controls_if_else"]),t.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?t.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?t.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?t.Msg.CONTROLS_IF_TOOLTIP_4:"":t.Msg.CONTROLS_IF_TOOLTIP_1}.bind(this))},t.Extensions.register("controls_if_tooltip",t.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION),t.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN={onchange:function(n){this.prevBlocks_||(this.prevBlocks_=[null,null]);var o=this.getInputTargetBlock("A"),r=this.getInputTargetBlock("B");o&&r&&!this.workspace.connectionChecker.doTypeChecks(o.outputConnection,r.outputConnection)&&(t.Events.setGroup(n.group),(n=this.prevBlocks_[0])!==o&&(o.unplug(),!n||n.isDisposed()||n.isShadow()||this.getInput("A").connection.connect(n.outputConnection)),(o=this.prevBlocks_[1])!==r&&(r.unplug(),!o||o.isDisposed()||o.isShadow()||this.getInput("B").connection.connect(o.outputConnection)),this.bumpNeighbours(),t.Events.setGroup(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},t.Constants.Logic.LOGIC_COMPARE_EXTENSION=function(){this.mixin(t.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN)},t.Extensions.register("logic_compare",t.Constants.Logic.LOGIC_COMPARE_EXTENSION),t.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN={prevParentConnection_:null,onchange:function(n){var o=this.getInputTargetBlock("THEN"),r=this.getInputTargetBlock("ELSE"),a=this.outputConnection.targetConnection;if((o||r)&&a)for(var h=0;2>h;h++){var R=1==h?o:r;R&&!R.workspace.connectionChecker.doTypeChecks(R.outputConnection,a)&&(t.Events.setGroup(n.group),a===this.prevParentConnection_?(this.unplug(),a.getSourceBlock().bumpNeighbours()):(R.unplug(),R.bumpNeighbours()),t.Events.setGroup(!1))}this.prevParentConnection_=a}},t.Extensions.registerMixin("logic_ternary",t.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN),t.Blocks.loops={},t.Constants.Loops={},t.Constants.Loops.HUE=120,t.defineBlocksWithJsonArray([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),t.Constants.Loops.WHILE_UNTIL_TOOLTIPS={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"},t.Extensions.register("controls_whileUntil_tooltip",t.Extensions.buildTooltipForDropdown("MODE",t.Constants.Loops.WHILE_UNTIL_TOOLTIPS)),t.Constants.Loops.BREAK_CONTINUE_TOOLTIPS={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"},t.Extensions.register("controls_flow_tooltip",t.Extensions.buildTooltipForDropdown("FLOW",t.Constants.Loops.BREAK_CONTINUE_TOOLTIPS)),t.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN={customContextMenu:function(n){if(!this.isInFlyout){var o=this.getField("VAR").getVariable(),r=o.name;if(!this.isCollapsed()&&null!=r){var a={enabled:!0};a.text=t.Msg.VARIABLES_SET_CREATE_GET.replace("%1",r),o=t.Variables.generateVariableFieldDom(o),(r=t.utils.xml.createElement("block")).setAttribute("type","variables_get"),r.appendChild(o),a.callback=t.ContextMenu.callbackFactory(this,r),n.push(a)}}}},t.Extensions.registerMixin("contextMenu_newGetVariableBlock",t.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN),t.Extensions.register("controls_for_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),t.Extensions.register("controls_forEach_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN={LOOP_TYPES:["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"],suppressPrefixSuffix:!0,getSurroundLoop:function(n){do{if(-1!=t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.LOOP_TYPES.indexOf(n.type))return n;n=n.getSurroundParent()}while(n);return null},onchange:function(n){if(this.workspace.isDragging&&!this.workspace.isDragging()&&n.type==t.Events.BLOCK_MOVE){var o=t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(this);if(this.setWarningText(o?null:t.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){var r=t.Events.getGroup();t.Events.setGroup(n.group),this.setEnabled(o),t.Events.setGroup(r)}}}},t.Extensions.registerMixin("controls_flow_in_loop_check",t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN),t.Blocks.math={},t.Constants.Math={},t.Constants.Math.HUE=230,t.defineBlocksWithJsonArray([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xbd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),t.Constants.Math.TOOLTIPS_BY_OP={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"},t.Extensions.register("math_op_tooltip",t.Extensions.buildTooltipForDropdown("OP",t.Constants.Math.TOOLTIPS_BY_OP)),t.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN={mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o="DIVISIBLE_BY"==this.getFieldValue("PROPERTY");return n.setAttribute("divisor_input",o),n},domToMutation:function(n){n="true"==n.getAttribute("divisor_input"),this.updateShape_(n)},updateShape_:function(n){var o=this.getInput("DIVISOR");n?o||this.appendValueInput("DIVISOR").setCheck("Number"):o&&this.removeInput("DIVISOR")}},t.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION=function(){this.getField("PROPERTY").setValidator(function(n){n="DIVISIBLE_BY"==n,this.getSourceBlock().updateShape_(n)})},t.Extensions.registerMutator("math_is_divisibleby_mutator",t.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN,t.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION),t.Extensions.register("math_change_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),t.Constants.Math.LIST_MODES_MUTATOR_MIXIN={updateType_:function(n){this.outputConnection.setCheck("MODE"==n?"Array":"Number")},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("op",this.getFieldValue("OP")),n},domToMutation:function(n){this.updateType_(n.getAttribute("op"))}},t.Constants.Math.LIST_MODES_MUTATOR_EXTENSION=function(){this.getField("OP").setValidator(function(n){this.updateType_(n)}.bind(this))},t.Extensions.registerMutator("math_modes_of_list_mutator",t.Constants.Math.LIST_MODES_MUTATOR_MIXIN,t.Constants.Math.LIST_MODES_MUTATOR_EXTENSION),t.Blocks.procedures={},t.Blocks.procedures_defnoreturn={init:function(){var n=t.Procedures.findLegalName("",this);(n=new t.FieldTextInput(n,t.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(n,"NAME").appendField("","PARAMS"),this.setMutator(new t.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(t.Msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(t.Msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:function(n){this.hasStatements_!==n&&(n?(this.appendStatementInput("STACK").appendField(t.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=n)},updateParams_:function(){var n="";this.arguments_.length&&(n=t.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),t.Events.disable();try{this.setFieldValue(n,"PARAMS")}finally{t.Events.enable()}},mutationToDom:function(n){var o=t.utils.xml.createElement("mutation");n&&o.setAttribute("name",this.getFieldValue("NAME"));for(var r=0;r<this.argumentVarModels_.length;r++){var a=t.utils.xml.createElement("arg"),h=this.argumentVarModels_[r];a.setAttribute("name",h.name),a.setAttribute("varid",h.getId()),n&&this.paramIds_&&a.setAttribute("paramId",this.paramIds_[r]),o.appendChild(a)}return this.hasStatements_||o.setAttribute("statements","false"),o},domToMutation:function(n){this.arguments_=[],this.argumentVarModels_=[];for(var r,o=0;r=n.childNodes[o];o++)if("arg"==r.nodeName.toLowerCase()){var a=r.getAttribute("name");r=r.getAttribute("varid")||r.getAttribute("varId"),this.arguments_.push(a),null!=(r=t.Variables.getOrCreateVariablePackage(this.workspace,r,a,""))?this.argumentVarModels_.push(r):console.log("Failed to create a variable with name "+a+", ignoring.")}this.updateParams_(),t.Procedures.mutateCallers(this),this.setStatements_("false"!==n.getAttribute("statements"))},decompose:function(n){var o=t.utils.xml.createElement("block");o.setAttribute("type","procedures_mutatorcontainer");var r=t.utils.xml.createElement("statement");r.setAttribute("name","STACK"),o.appendChild(r);for(var a=0;a<this.arguments_.length;a++){var h=t.utils.xml.createElement("block");h.setAttribute("type","procedures_mutatorarg");var R=t.utils.xml.createElement("field");R.setAttribute("name","NAME");var L=t.utils.xml.createTextNode(this.arguments_[a]);R.appendChild(L),h.appendChild(R),R=t.utils.xml.createElement("next"),h.appendChild(R),r.appendChild(h),r=R}return n=t.Xml.domToBlock(o,n),"procedures_defreturn"==this.type?n.setFieldValue(this.hasStatements_,"STATEMENTS"):n.removeInput("STATEMENT_INPUT"),t.Procedures.mutateCallers(this),n},compose:function(n){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];for(var o=n.getInputTargetBlock("STACK");o&&!o.isInsertionMarker();){var r=o.getFieldValue("NAME");this.arguments_.push(r),r=this.workspace.getVariable(r,""),this.argumentVarModels_.push(r),this.paramIds_.push(o.id),o=o.nextConnection&&o.nextConnection.targetBlock()}this.updateParams_(),t.Procedures.mutateCallers(this),null!==(n=n.getFieldValue("STATEMENTS"))&&this.hasStatements_!=(n="TRUE"==n)&&(n?(this.setStatements_(!0),t.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(n=this.getInput("STACK").connection,(this.statementConnection_=n.targetConnection)&&((n=n.targetBlock()).unplug(),n.bumpNeighbours()),this.setStatements_(!1)))},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(n,o){var r=this.workspace.getVariableById(n);if(""==r.type){r=r.name,o=this.workspace.getVariableById(o);for(var a=!1,h=0;h<this.argumentVarModels_.length;h++)this.argumentVarModels_[h].getId()==n&&(this.arguments_[h]=o.name,this.argumentVarModels_[h]=o,a=!0);a&&(this.displayRenamedVar_(r,o.name),t.Procedures.mutateCallers(this))}},updateVarName:function(n){for(var o=n.name,r=!1,a=0;a<this.argumentVarModels_.length;a++)if(this.argumentVarModels_[a].getId()==n.getId()){var h=this.arguments_[a];this.arguments_[a]=o,r=!0}r&&(this.displayRenamedVar_(h,o),t.Procedures.mutateCallers(this))},displayRenamedVar_:function(n,o){if(this.updateParams_(),this.mutator&&this.mutator.isVisible())for(var h,r=this.mutator.workspace_.getAllBlocks(!1),a=0;h=r[a];a++)"procedures_mutatorarg"==h.type&&t.Names.equals(n,h.getFieldValue("NAME"))&&h.setFieldValue(o,"NAME")},customContextMenu:function(n){if(!this.isInFlyout){var o={enabled:!0},r=this.getFieldValue("NAME");o.text=t.Msg.PROCEDURES_CREATE_DO.replace("%1",r);var a=t.utils.xml.createElement("mutation");for(a.setAttribute("name",r),r=0;r<this.arguments_.length;r++){var h=t.utils.xml.createElement("arg");h.setAttribute("name",this.arguments_[r]),a.appendChild(h)}if((r=t.utils.xml.createElement("block")).setAttribute("type",this.callType_),r.appendChild(a),o.callback=t.ContextMenu.callbackFactory(this,r),n.push(o),!this.isCollapsed())for(r=0;r<this.argumentVarModels_.length;r++)(o={enabled:!0}).text=t.Msg.VARIABLES_SET_CREATE_GET.replace("%1",(a=this.argumentVarModels_[r]).name),a=t.Variables.generateVariableFieldDom(a),(h=t.utils.xml.createElement("block")).setAttribute("type","variables_get"),h.appendChild(a),o.callback=t.ContextMenu.callbackFactory(this,h),n.push(o)}},callType_:"procedures_callnoreturn"},t.Blocks.procedures_defreturn={init:function(){var n=t.Procedures.findLegalName("",this);(n=new t.FieldTextInput(n,t.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(n,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(t.ALIGN_RIGHT).appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new t.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(t.Msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(t.Msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:t.Blocks.procedures_defnoreturn.setStatements_,updateParams_:t.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:t.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:t.Blocks.procedures_defnoreturn.domToMutation,decompose:t.Blocks.procedures_defnoreturn.decompose,compose:t.Blocks.procedures_defnoreturn.compose,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:t.Blocks.procedures_defnoreturn.getVars,getVarModels:t.Blocks.procedures_defnoreturn.getVarModels,renameVarById:t.Blocks.procedures_defnoreturn.renameVarById,updateVarName:t.Blocks.procedures_defnoreturn.updateVarName,displayRenamedVar_:t.Blocks.procedures_defnoreturn.displayRenamedVar_,customContextMenu:t.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"},t.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(t.Msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(t.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new t.FieldCheckbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}},t.Blocks.procedures_mutatorarg={init:function(){var n=new t.FieldTextInput(t.Procedures.DEFAULT_ARG,this.validator_);n.oldShowEditorFn_=n.showEditor_,n.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(t.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(n,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,n.onFinishEditing_=this.deleteIntermediateVars_,n.createdVariables_=[],n.onFinishEditing_("x")},validator_:function(n){var o=this.getSourceBlock(),r=t.Mutator.findParentWs(o.workspace);if(!(n=n.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;for(var a=(o.workspace.targetWorkspace||o.workspace).getAllBlocks(!1),h=n.toLowerCase(),R=0;R<a.length;R++)if(a[R].id!=this.getSourceBlock().id){var L=a[R].getFieldValue("NAME");if(L&&L.toLowerCase()==h)return null}return o.isInFlyout||((o=r.getVariable(n,""))&&o.name!=n&&r.renameVariableById(o.getId(),n),o||(o=r.createVariable(n,""))&&this.createdVariables_&&this.createdVariables_.push(o)),n},deleteIntermediateVars_:function(n){var o=t.Mutator.findParentWs(this.getSourceBlock().workspace);if(o)for(var r=0;r<this.createdVariables_.length;r++){var a=this.createdVariables_[r];a.name!=n&&o.deleteVariableById(a.getId())}}},t.Blocks.procedures_callnoreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(n,o){t.Names.equals(n,this.getProcedureCall())&&(this.setFieldValue(o,"NAME"),this.setTooltip((this.outputConnection?t.Msg.PROCEDURES_CALLRETURN_TOOLTIP:t.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",o)))},setProcedureParameters_:function(n,o){var r=t.Procedures.getDefinition(this.getProcedureCall(),this.workspace),a=r&&r.mutator&&r.mutator.isVisible();if(a||(this.quarkConnections_={},this.quarkIds_=null),o)if(n.join("\n")==this.arguments_.join("\n"))this.quarkIds_=o;else{if(o.length!=n.length)throw RangeError("paramNames and paramIds must be the same length.");this.setCollapsed(!1),this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),r=this.rendered,this.rendered=!1;for(var h=0;h<this.arguments_.length;h++){var R=this.getInput("ARG"+h);R&&(this.quarkConnections_[this.quarkIds_[h]]=R=R.connection.targetConnection,a&&R&&-1==o.indexOf(this.quarkIds_[h])&&(R.disconnect(),R.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(n),this.argumentVarModels_=[],h=0;h<this.arguments_.length;h++)n=t.Variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[h],""),this.argumentVarModels_.push(n);if(this.updateShape_(),this.quarkIds_=o)for(h=0;h<this.arguments_.length;h++)(o=this.quarkIds_[h])in this.quarkConnections_&&(t.Mutator.reconnect(R=this.quarkConnections_[o],this,"ARG"+h)||delete this.quarkConnections_[o]);(this.rendered=r)&&this.render()}},updateShape_:function(){for(var n=0;n<this.arguments_.length;n++){var o=this.getField("ARGNAME"+n);if(o){t.Events.disable();try{o.setValue(this.arguments_[n])}finally{t.Events.enable()}}else o=new t.FieldLabel(this.arguments_[n]),this.appendValueInput("ARG"+n).setAlign(t.ALIGN_RIGHT).appendField(o,"ARGNAME"+n).init()}for(;this.getInput("ARG"+n);)this.removeInput("ARG"+n),n++;(n=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(n.appendField(t.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),n.init()):this.getField("WITH")&&n.removeField("WITH"))},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");n.setAttribute("name",this.getProcedureCall());for(var o=0;o<this.arguments_.length;o++){var r=t.utils.xml.createElement("arg");r.setAttribute("name",this.arguments_[o]),n.appendChild(r)}return n},domToMutation:function(n){var o=n.getAttribute("name");this.renameProcedure(this.getProcedureCall(),o),o=[];for(var h,r=[],a=0;h=n.childNodes[a];a++)"arg"==h.nodeName.toLowerCase()&&(o.push(h.getAttribute("name")),r.push(h.getAttribute("paramId")));this.setProcedureParameters_(o,r)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(n){if(this.workspace&&!this.workspace.isFlyout&&n.recordUndo)if(n.type==t.Events.BLOCK_CREATE&&-1!=n.ids.indexOf(this.id)){var o=this.getProcedureCall();if(!(o=t.Procedures.getDefinition(o,this.workspace))||o.type==this.defType_&&JSON.stringify(o.getVars())==JSON.stringify(this.arguments_)||(o=null),!o){t.Events.setGroup(n.group),n=t.utils.xml.createElement("xml"),(o=t.utils.xml.createElement("block")).setAttribute("type",this.defType_);var r=this.getRelativeToSurfaceXY(),a=r.y+2*t.SNAP_RADIUS;o.setAttribute("x",r.x+t.SNAP_RADIUS*(this.RTL?-1:1)),o.setAttribute("y",a),r=this.mutationToDom(),o.appendChild(r),(r=t.utils.xml.createElement("field")).setAttribute("name","NAME"),(a=this.getProcedureCall())||(a=t.Procedures.findLegalName("",this),this.renameProcedure("",a)),r.appendChild(t.utils.xml.createTextNode(a)),o.appendChild(r),n.appendChild(o),t.Xml.domToWorkspace(n,this.workspace),t.Events.setGroup(!1)}}else n.type==t.Events.BLOCK_DELETE?(o=this.getProcedureCall(),(o=t.Procedures.getDefinition(o,this.workspace))||(t.Events.setGroup(n.group),this.dispose(!0),t.Events.setGroup(!1))):n.type==t.Events.CHANGE&&"disabled"==n.element&&(o=this.getProcedureCall(),(o=t.Procedures.getDefinition(o,this.workspace))&&o.id==n.blockId&&((o=t.Events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),t.Events.setGroup(n.group),n.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),t.Events.setGroup(o)))},customContextMenu:function(n){if(this.workspace.isMovable()){var o={enabled:!0};o.text=t.Msg.PROCEDURES_HIGHLIGHT_DEF;var r=this.getProcedureCall(),a=this.workspace;o.callback=function(){var h=t.Procedures.getDefinition(r,a);h&&(a.centerOnBlock(h.id),h.select())},n.push(o)}},defType_:"procedures_defnoreturn"},t.Blocks.procedures_callreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:t.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:t.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:t.Blocks.procedures_callnoreturn.setProcedureParameters_,updateShape_:t.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:t.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:t.Blocks.procedures_callnoreturn.domToMutation,getVars:t.Blocks.procedures_callnoreturn.getVars,getVarModels:t.Blocks.procedures_callnoreturn.getVarModels,onchange:t.Blocks.procedures_callnoreturn.onchange,customContextMenu:t.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defreturn"},t.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(t.Msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("value",Number(this.hasReturnValue_)),n},domToMutation:function(n){this.hasReturnValue_=1==n.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(n){if(this.workspace.isDragging&&!this.workspace.isDragging()){n=!1;var o=this;do{if(-1!=this.FUNCTION_TYPES.indexOf(o.type)){n=!0;break}o=o.getSurroundParent()}while(o);n?("procedures_defnoreturn"==o.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!=o.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setEnabled(!0)):(this.setWarningText(t.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setEnabled(!1))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},t.Blocks.texts={},t.Constants.Text={},t.Constants.Text.HUE=160,t.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"\xb6"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),t.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[t.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[t.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[t.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[t.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[t.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(t.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(t.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o=this.getInput("AT1").type==t.INPUT_VALUE;return n.setAttribute("at1",o),o=this.getInput("AT2").type==t.INPUT_VALUE,n.setAttribute("at2",o),n},domToMutation:function(n){var o="true"==n.getAttribute("at1");n="true"==n.getAttribute("at2"),this.updateAt_(1,o),this.updateAt_(2,n)},updateAt_:function(n,o){this.removeInput("AT"+n),this.removeInput("ORDINAL"+n,!0),o?(this.appendValueInput("AT"+n).setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+n).appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+n),2==n&&t.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg.TEXT_GET_SUBSTRING_TAIL));var r=new t.FieldDropdown(this["WHERE_OPTIONS_"+n],function(a){var h="FROM_START"==a||"FROM_END"==a;if(h!=o){var R=this.getSourceBlock();return R.updateAt_(n,h),R.setFieldValue(a,"WHERE"+n),null}});this.getInput("AT"+n).appendField(r,"WHERE"+n),1==n&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},t.Blocks.text_changeCase={init:function(){var n=[[t.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[t.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[t.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(t.Msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new t.FieldDropdown(n),"CASE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg.TEXT_CHANGECASE_TOOLTIP)}},t.Blocks.text_trim={init:function(){var n=[[t.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[t.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[t.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(t.Msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new t.FieldDropdown(n),"MODE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg.TEXT_TRIM_TOOLTIP)}},t.Blocks.text_print={init:function(){this.jsonInit({message0:t.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:t.Msg.TEXT_PRINT_TOOLTIP,helpUrl:t.Msg.TEXT_PRINT_HELPURL})}},t.Blocks.text_prompt_ext={init:function(){var n=[[t.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");var o=this;n=new t.FieldDropdown(n,function(r){o.updateType_(r)}),this.appendValueInput("TEXT").appendField(n,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==o.getFieldValue("TYPE")?t.Msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:function(n){this.outputConnection.setCheck("NUMBER"==n?"Number":"String")},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("type",this.getFieldValue("TYPE")),n},domToMutation:function(n){this.updateType_(n.getAttribute("type"))}},t.Blocks.text_prompt={init:function(){this.mixin(t.Constants.Text.QUOTE_IMAGE_MIXIN);var n=[[t.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],o=this;this.setHelpUrl(t.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),n=new t.FieldDropdown(n,function(r){o.updateType_(r)}),this.appendDummyInput().appendField(n,"TYPE").appendField(this.newQuote_(!0)).appendField(new t.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==o.getFieldValue("TYPE")?t.Msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:t.Blocks.text_prompt_ext.updateType_,mutationToDom:t.Blocks.text_prompt_ext.mutationToDom,domToMutation:t.Blocks.text_prompt_ext.domToMutation},t.Blocks.text_count={init:function(){this.jsonInit({message0:t.Msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:t.Msg.TEXT_COUNT_TOOLTIP,helpUrl:t.Msg.TEXT_COUNT_HELPURL})}},t.Blocks.text_replace={init:function(){this.jsonInit({message0:t.Msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg.TEXT_REPLACE_TOOLTIP,helpUrl:t.Msg.TEXT_REPLACE_HELPURL})}},t.Blocks.text_reverse={init:function(){this.jsonInit({message0:t.Msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg.TEXT_REVERSE_TOOLTIP,helpUrl:t.Msg.TEXT_REVERSE_HELPURL})}},t.Constants.Text.QUOTE_IMAGE_MIXIN={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(n){for(var r,o=0;r=this.inputList[o];o++)for(var h,a=0;h=r.fieldRow[a];a++)if(n==h.name)return r.insertFieldAt(a,this.newQuote_(!0)),void r.insertFieldAt(a+2,this.newQuote_(!1));console.warn('field named "'+n+'" not found in '+this.toDevString())},newQuote_:function(n){return new t.FieldImage((n=this.RTL?!n:n)?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,n?"\u201c":"\u201d")}},t.Constants.Text.TEXT_QUOTES_EXTENSION=function(){this.mixin(t.Constants.Text.QUOTE_IMAGE_MIXIN),this.quoteField_("TEXT")},t.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN={mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("items",this.itemCount_),n},domToMutation:function(n){this.itemCount_=parseInt(n.getAttribute("items"),10),this.updateShape_()},decompose:function(n){var o=n.newBlock("text_create_join_container");o.initSvg();for(var r=o.getInput("STACK").connection,a=0;a<this.itemCount_;a++){var h=n.newBlock("text_create_join_item");h.initSvg(),r.connect(h.previousConnection),r=h.nextConnection}return o},compose:function(n){var o=n.getInputTargetBlock("STACK");for(n=[];o&&!o.isInsertionMarker();)n.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();for(o=0;o<this.itemCount_;o++){var r=this.getInput("ADD"+o).connection.targetConnection;r&&-1==n.indexOf(r)&&r.disconnect()}for(this.itemCount_=n.length,this.updateShape_(),o=0;o<this.itemCount_;o++)t.Mutator.reconnect(n[o],this,"ADD"+o)},saveConnections:function(n){n=n.getInputTargetBlock("STACK");for(var o=0;n;){var r=this.getInput("ADD"+o);n.valueConnection_=r&&r.connection.targetConnection,o++,n=n.nextConnection&&n.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var n=0;n<this.itemCount_;n++)if(!this.getInput("ADD"+n)){var o=this.appendValueInput("ADD"+n).setAlign(t.ALIGN_RIGHT);0==n&&o.appendField(t.Msg.TEXT_JOIN_TITLE_CREATEWITH)}for(;this.getInput("ADD"+n);)this.removeInput("ADD"+n),n++}},t.Constants.Text.TEXT_JOIN_EXTENSION=function(){this.mixin(t.Constants.Text.QUOTE_IMAGE_MIXIN),this.itemCount_=2,this.updateShape_(),this.setMutator(new t.Mutator(["text_create_join_item"]))},t.Extensions.register("text_append_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),t.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION=function(){var n=this;this.setTooltip(function(){return t.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",n.workspace.options.oneBasedIndex?"0":"-1")})},t.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN={mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("at",!!this.isAt_),n},domToMutation:function(n){n="false"!=n.getAttribute("at"),this.updateAt_(n)},updateAt_:function(n){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),n&&(this.appendValueInput("AT").setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)),t.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg.TEXT_CHARAT_TAIL)),this.isAt_=n}},t.Constants.Text.TEXT_CHARAT_EXTENSION=function(){this.getField("WHERE").setValidator(function(o){(o="FROM_START"==o||"FROM_END"==o)!=this.isAt_&&this.getSourceBlock().updateAt_(o)}),this.updateAt_(!0);var n=this;this.setTooltip(function(){var o=n.getFieldValue("WHERE"),r=t.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"==o||"FROM_END"==o)&&(o="FROM_START"==o?t.Msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(r+="  "+o.replace("%1",n.workspace.options.oneBasedIndex?"#1":"#0")),r})},t.Extensions.register("text_indexOf_tooltip",t.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION),t.Extensions.register("text_quotes",t.Constants.Text.TEXT_QUOTES_EXTENSION),t.Extensions.registerMutator("text_join_mutator",t.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN,t.Constants.Text.TEXT_JOIN_EXTENSION),t.Extensions.registerMutator("text_charAt_mutator",t.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN,t.Constants.Text.TEXT_CHARAT_EXTENSION),t.Blocks.variables={},t.Constants.Variables={},t.Constants.Variables.HUE=330,t.defineBlocksWithJsonArray([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),t.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(n){if(this.isInFlyout)("variables_get"==this.type||"variables_get_reporter"==this.type)&&(o={text:t.Msg.RENAME_VARIABLE,enabled:!0,callback:t.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},h=this.getField("VAR").getText(),a={text:t.Msg.DELETE_VARIABLE.replace("%1",h),enabled:!0,callback:t.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},n.unshift(o),n.unshift(a));else{if("variables_get"==this.type)var o="variables_set",r=t.Msg.VARIABLES_GET_CREATE_SET;else o="variables_get",r=t.Msg.VARIABLES_SET_CREATE_GET;var a={enabled:0<this.workspace.remainingCapacity()},h=this.getField("VAR").getText();a.text=r.replace("%1",h),(r=t.utils.xml.createElement("field")).setAttribute("name","VAR"),r.appendChild(t.utils.xml.createTextNode(h)),(h=t.utils.xml.createElement("block")).setAttribute("type",o),h.appendChild(r),a.callback=t.ContextMenu.callbackFactory(this,h),n.push(a)}}},t.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();t.Variables.renameVariable(o,r)}},t.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();o.deleteVariableById(r.getId()),o.refreshToolboxSelection()}},t.Extensions.registerMixin("contextMenu_variableSetterGetter",t.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),t.Constants.VariablesDynamic={},t.Constants.VariablesDynamic.HUE=310,t.defineBlocksWithJsonArray([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),t.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(n){if(this.isInFlyout)("variables_get_dynamic"==this.type||"variables_get_reporter_dynamic"==this.type)&&(o={text:t.Msg.RENAME_VARIABLE,enabled:!0,callback:t.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},R=this.getField("VAR").getText(),h={text:t.Msg.DELETE_VARIABLE.replace("%1",R),enabled:!0,callback:t.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},n.unshift(o),n.unshift(h));else{var o=this.getFieldValue("VAR"),r=this.workspace.getVariableById(o).type;if("variables_get_dynamic"==this.type){o="variables_set_dynamic";var a=t.Msg.VARIABLES_GET_CREATE_SET}else o="variables_get_dynamic",a=t.Msg.VARIABLES_SET_CREATE_GET;var h={enabled:0<this.workspace.remainingCapacity()},R=this.getField("VAR").getText();h.text=a.replace("%1",R),(a=t.utils.xml.createElement("field")).setAttribute("name","VAR"),a.setAttribute("variabletype",r),a.appendChild(t.utils.xml.createTextNode(R)),(R=t.utils.xml.createElement("block")).setAttribute("type",o),R.appendChild(a),h.callback=t.ContextMenu.callbackFactory(this,R),n.push(h)}},onchange:function(n){n=this.getFieldValue("VAR"),n=t.Variables.getVariable(this.workspace,n),"variables_get_dynamic"==this.type?this.outputConnection.setCheck(n.type):this.getInput("VALUE").connection.setCheck(n.type)}},t.Constants.VariablesDynamic.RENAME_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();t.Variables.renameVariable(o,r)}},t.Constants.VariablesDynamic.DELETE_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();o.deleteVariableById(r.getId()),o.refreshToolboxSelection()}},t.Extensions.registerMixin("contextMenu_variableDynamicSetterGetter",t.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),t.Blocks}.apply(X,m))&&(B.exports=e)},36013:function(B,X,_){var m,e;m=[_(43542),_(74715),_(89519),_(87850)],void 0!==(e=function(t,n,o,r){"use strict";return t.setLocale(n),t.Blocks=t.Blocks||{},Object.keys(o).forEach(function(a){t.Blocks[a]=o[a]}),t.JavaScript=r,t}.apply(X,m))&&(B.exports=e)},43542:function(B,X,_){var m,e;m=[_(35235)],void 0!==(e=function(t){"use strict";return t.setLocale=function(n){t.Msg=t.Msg||{},Object.keys(n).forEach(function(o){t.Msg[o]=n[o]})},t}.apply(X,m))&&(B.exports=e)},67640:function(B,X,_){var m,e;m=[_(36013)],void 0!==(e=function(t){"use strict";return t}.apply(X,m))&&(B.exports=e)},87850:function(B,X,_){var m,e;m=[_(43542),_(37353)],void 0!==(e=function(t,n){"use strict";return t.JavaScript=n,n}.apply(X,m))&&(B.exports=e)},37353:function(B,X,_){var m,e;m=[_(34316)],void 0!==(e=function(t){"use strict";return t.JavaScript=new t.Generator("JavaScript"),t.JavaScript.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(t.utils.global).join(",")),t.JavaScript.ORDER_ATOMIC=0,t.JavaScript.ORDER_NEW=1.1,t.JavaScript.ORDER_MEMBER=1.2,t.JavaScript.ORDER_FUNCTION_CALL=2,t.JavaScript.ORDER_INCREMENT=3,t.JavaScript.ORDER_DECREMENT=3,t.JavaScript.ORDER_BITWISE_NOT=4.1,t.JavaScript.ORDER_UNARY_PLUS=4.2,t.JavaScript.ORDER_UNARY_NEGATION=4.3,t.JavaScript.ORDER_LOGICAL_NOT=4.4,t.JavaScript.ORDER_TYPEOF=4.5,t.JavaScript.ORDER_VOID=4.6,t.JavaScript.ORDER_DELETE=4.7,t.JavaScript.ORDER_AWAIT=4.8,t.JavaScript.ORDER_EXPONENTIATION=5,t.JavaScript.ORDER_MULTIPLICATION=5.1,t.JavaScript.ORDER_DIVISION=5.2,t.JavaScript.ORDER_MODULUS=5.3,t.JavaScript.ORDER_SUBTRACTION=6.1,t.JavaScript.ORDER_ADDITION=6.2,t.JavaScript.ORDER_BITWISE_SHIFT=7,t.JavaScript.ORDER_RELATIONAL=8,t.JavaScript.ORDER_IN=8,t.JavaScript.ORDER_INSTANCEOF=8,t.JavaScript.ORDER_EQUALITY=9,t.JavaScript.ORDER_BITWISE_AND=10,t.JavaScript.ORDER_BITWISE_XOR=11,t.JavaScript.ORDER_BITWISE_OR=12,t.JavaScript.ORDER_LOGICAL_AND=13,t.JavaScript.ORDER_LOGICAL_OR=14,t.JavaScript.ORDER_CONDITIONAL=15,t.JavaScript.ORDER_ASSIGNMENT=16,t.JavaScript.ORDER_YIELD=17,t.JavaScript.ORDER_COMMA=18,t.JavaScript.ORDER_NONE=99,t.JavaScript.ORDER_OVERRIDES=[[t.JavaScript.ORDER_FUNCTION_CALL,t.JavaScript.ORDER_MEMBER],[t.JavaScript.ORDER_FUNCTION_CALL,t.JavaScript.ORDER_FUNCTION_CALL],[t.JavaScript.ORDER_MEMBER,t.JavaScript.ORDER_MEMBER],[t.JavaScript.ORDER_MEMBER,t.JavaScript.ORDER_FUNCTION_CALL],[t.JavaScript.ORDER_LOGICAL_NOT,t.JavaScript.ORDER_LOGICAL_NOT],[t.JavaScript.ORDER_MULTIPLICATION,t.JavaScript.ORDER_MULTIPLICATION],[t.JavaScript.ORDER_ADDITION,t.JavaScript.ORDER_ADDITION],[t.JavaScript.ORDER_LOGICAL_AND,t.JavaScript.ORDER_LOGICAL_AND],[t.JavaScript.ORDER_LOGICAL_OR,t.JavaScript.ORDER_LOGICAL_OR]],t.JavaScript.isInitialized=!1,t.JavaScript.init=function(n){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new t.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(n.getVariableMap()),this.nameDB_.populateVariables(n),this.nameDB_.populateProcedures(n);for(var o=[],r=t.Variables.allDeveloperVariables(n),a=0;a<r.length;a++)o.push(this.nameDB_.getName(r[a],t.Names.DEVELOPER_VARIABLE_TYPE));for(n=t.Variables.allUsedVarModels(n),a=0;a<n.length;a++)o.push(this.nameDB_.getName(n[a].getId(),t.VARIABLE_CATEGORY_NAME));o.length&&(this.definitions_.variables="var "+o.join(", ")+";"),this.isInitialized=!0},t.JavaScript.finish=function(n){var o=t.utils.object.values(this.definitions_);return n=Object.getPrototypeOf(this).finish.call(this,n),this.isInitialized=!1,this.nameDB_.reset(),o.join("\n\n")+"\n\n\n"+n},t.JavaScript.scrubNakedValue=function(n){return n+";\n"},t.JavaScript.quote_=function(n){return"'"+(n=n.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},t.JavaScript.multiline_quote_=function(n){return n.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")},t.JavaScript.scrub_=function(n,o,r){var a="";if(!n.outputConnection||!n.outputConnection.targetConnection){var h=n.getCommentText();h&&(h=t.utils.string.wrap(h,this.COMMENT_WRAP-3),a+=this.prefixLines(h+"\n","// "));for(var R=0;R<n.inputList.length;R++)n.inputList[R].type==t.inputTypes.VALUE&&(h=n.inputList[R].connection.targetBlock())&&(h=this.allNestedComments(h))&&(a+=this.prefixLines(h,"// "))}return n=n.nextConnection&&n.nextConnection.targetBlock(),a+o+(r?"":this.blockToCode(n))},t.JavaScript.getAdjusted=function(n,o,r,a,h){r=r||0,h=h||this.ORDER_NONE,n.workspace.options.oneBasedIndex&&r--;var R=n.workspace.options.oneBasedIndex?"1":"0";if(n=0<r?this.valueToCode(n,o,this.ORDER_ADDITION)||R:0>r?this.valueToCode(n,o,this.ORDER_SUBTRACTION)||R:a?this.valueToCode(n,o,this.ORDER_UNARY_NEGATION)||R:this.valueToCode(n,o,h)||R,t.isNumber(n))n=Number(n)+r,a&&(n=-n);else{if(0<r){n=n+" + "+r;var L=this.ORDER_ADDITION}else 0>r&&(n=n+" - "+-r,L=this.ORDER_SUBTRACTION);a&&(n=r?"-("+n+")":"-"+n,L=this.ORDER_UNARY_NEGATION),L=Math.floor(L),h=Math.floor(h),L&&h>=L&&(n="("+n+")")}return n},t.JavaScript.colour={},t.JavaScript.colour_picker=function(n){return[t.JavaScript.quote_(n.getFieldValue("COLOUR")),t.JavaScript.ORDER_ATOMIC]},t.JavaScript.colour_random=function(n){return[t.JavaScript.provideFunction_("colourRandom",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.colour_rgb=function(n){var o=t.JavaScript.valueToCode(n,"RED",t.JavaScript.ORDER_NONE)||0,r=t.JavaScript.valueToCode(n,"GREEN",t.JavaScript.ORDER_NONE)||0;return n=t.JavaScript.valueToCode(n,"BLUE",t.JavaScript.ORDER_NONE)||0,[t.JavaScript.provideFunction_("colourRgb",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+o+", "+r+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.colour_blend=function(n){var o=t.JavaScript.valueToCode(n,"COLOUR1",t.JavaScript.ORDER_NONE)||"'#000000'",r=t.JavaScript.valueToCode(n,"COLOUR2",t.JavaScript.ORDER_NONE)||"'#000000'";return n=t.JavaScript.valueToCode(n,"RATIO",t.JavaScript.ORDER_NONE)||.5,[t.JavaScript.provideFunction_("colourBlend",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+o+", "+r+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists={},t.JavaScript.lists_create_empty=function(n){return["[]",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.lists_create_with=function(n){for(var o=Array(n.itemCount_),r=0;r<n.itemCount_;r++)o[r]=t.JavaScript.valueToCode(n,"ADD"+r,t.JavaScript.ORDER_NONE)||"null";return["["+o.join(", ")+"]",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.lists_repeat=function(n){return[t.JavaScript.provideFunction_("listsRepeat",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"])+"("+(t.JavaScript.valueToCode(n,"ITEM",t.JavaScript.ORDER_NONE)||"null")+", "+(n=t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_NONE)||"0")+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_length=function(n){return[(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"[]")+".length",t.JavaScript.ORDER_MEMBER]},t.JavaScript.lists_isEmpty=function(n){return["!"+(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"[]")+".length",t.JavaScript.ORDER_LOGICAL_NOT]},t.JavaScript.lists_indexOf=function(n){var o="FIRST"==n.getFieldValue("END")?"indexOf":"lastIndexOf",r=t.JavaScript.valueToCode(n,"FIND",t.JavaScript.ORDER_NONE)||"''";return o=(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"[]")+"."+o+"("+r+")",n.workspace.options.oneBasedIndex?[o+" + 1",t.JavaScript.ORDER_ADDITION]:[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_getIndex=function(n){var o=n.getFieldValue("MODE")||"GET",r=n.getFieldValue("WHERE")||"FROM_START",a=t.JavaScript.valueToCode(n,"VALUE","RANDOM"==r?t.JavaScript.ORDER_NONE:t.JavaScript.ORDER_MEMBER)||"[]";switch(r){case"FIRST":if("GET"==o)return[a+"[0]",t.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[a+".shift()",t.JavaScript.ORDER_MEMBER];if("REMOVE"==o)return a+".shift();\n";break;case"LAST":if("GET"==o)return[a+".slice(-1)[0]",t.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[a+".pop()",t.JavaScript.ORDER_MEMBER];if("REMOVE"==o)return a+".pop();\n";break;case"FROM_START":if(n=t.JavaScript.getAdjusted(n,"AT"),"GET"==o)return[a+"["+n+"]",t.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[a+".splice("+n+", 1)[0]",t.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return a+".splice("+n+", 1);\n";break;case"FROM_END":if(n=t.JavaScript.getAdjusted(n,"AT",1,!0),"GET"==o)return[a+".slice("+n+")[0]",t.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"==o)return[a+".splice("+n+", 1)[0]",t.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return a+".splice("+n+", 1);";break;case"RANDOM":if(a=t.JavaScript.provideFunction_("listsGetRandomItem",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+a+", "+("GET"!=o)+")","GET"==o||"GET_REMOVE"==o)return[a,t.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return a+";\n"}throw Error("Unhandled combination (lists_getIndex).")},t.JavaScript.lists_setIndex=function(n){function o(){if(r.match(/^\w+$/))return"";var L=t.JavaScript.nameDB_.getDistinctName("tmpList",t.VARIABLE_CATEGORY_NAME),W="var "+L+" = "+r+";\n";return r=L,W}var r=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_MEMBER)||"[]",a=n.getFieldValue("MODE")||"GET",h=n.getFieldValue("WHERE")||"FROM_START",R=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_ASSIGNMENT)||"null";switch(h){case"FIRST":if("SET"==a)return r+"[0] = "+R+";\n";if("INSERT"==a)return r+".unshift("+R+");\n";break;case"LAST":if("SET"==a)return(n=o())+(r+"[")+r+".length - 1] = "+R+";\n";if("INSERT"==a)return r+".push("+R+");\n";break;case"FROM_START":if(h=t.JavaScript.getAdjusted(n,"AT"),"SET"==a)return r+"["+h+"] = "+R+";\n";if("INSERT"==a)return r+".splice("+h+", 0, "+R+");\n";break;case"FROM_END":if(h=t.JavaScript.getAdjusted(n,"AT",1,!1,t.JavaScript.ORDER_SUBTRACTION),n=o(),"SET"==a)return n+(r+"[")+r+".length - "+h+"] = "+R+";\n";if("INSERT"==a)return n+(r+".splice(")+r+".length - "+h+", 0, "+R+");\n";break;case"RANDOM":if(n=o(),n+="var "+(h=t.JavaScript.nameDB_.getDistinctName("tmpX",t.VARIABLE_CATEGORY_NAME))+" = Math.floor(Math.random() * "+r+".length);\n","SET"==a)return n+(r+"[")+h+"] = "+R+";\n";if("INSERT"==a)return n+(r+".splice(")+h+", 0, "+R+");\n"}throw Error("Unhandled combination (lists_setIndex).")},t.JavaScript.lists.getIndex_=function(n,o,r){return"FIRST"==o?"0":"FROM_END"==o?n+".length - 1 - "+r:"LAST"==o?n+".length - 1":r},t.JavaScript.lists_getSublist=function(n){var o=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_MEMBER)||"[]",r=n.getFieldValue("WHERE1"),a=n.getFieldValue("WHERE2");if("FIRST"==r&&"LAST"==a)o+=".slice(0)";else if(o.match(/^\w+$/)||"FROM_END"!=r&&"FROM_START"==a){switch(r){case"FROM_START":var h=t.JavaScript.getAdjusted(n,"AT1");break;case"FROM_END":h=o+".length - "+(h=t.JavaScript.getAdjusted(n,"AT1",1,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":h="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(a){case"FROM_START":n=t.JavaScript.getAdjusted(n,"AT2",1);break;case"FROM_END":n=o+".length - "+(n=t.JavaScript.getAdjusted(n,"AT2",0,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"LAST":n=o+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}o=o+".slice("+h+", "+n+")"}else{h=t.JavaScript.getAdjusted(n,"AT1"),n=t.JavaScript.getAdjusted(n,"AT2");var R=t.JavaScript.lists.getIndex_,L={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};o=t.JavaScript.provideFunction_("subsequence"+L[r]+L[a],["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==r||"FROM_START"==r?", at1":"")+("FROM_END"==a||"FROM_START"==a?", at2":"")+") {","  var start = "+R("sequence",r,"at1")+";","  var end = "+R("sequence",a,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+o+("FROM_END"==r||"FROM_START"==r?", "+h:"")+("FROM_END"==a||"FROM_START"==a?", "+n:"")+")"}return[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_sort=function(n){var o=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_FUNCTION_CALL)||"[]",r="1"===n.getFieldValue("DIRECTION")?1:-1;return n=n.getFieldValue("TYPE"),[o+".slice().sort("+t.JavaScript.provideFunction_("listsGetSortCompare",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+n+'", '+r+"))",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_split=function(n){var o=t.JavaScript.valueToCode(n,"INPUT",t.JavaScript.ORDER_MEMBER),r=t.JavaScript.valueToCode(n,"DELIM",t.JavaScript.ORDER_NONE)||"''";if("SPLIT"==(n=n.getFieldValue("MODE")))o||(o="''"),n="split";else{if("JOIN"!=n)throw Error("Unknown mode: "+n);o||(o="[]"),n="join"}return[o+"."+n+"("+r+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_reverse=function(n){return[(t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.logic={},t.JavaScript.controls_if=function(n){var o=0,r="";t.JavaScript.STATEMENT_PREFIX&&(r+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,n));do{var a=t.JavaScript.valueToCode(n,"IF"+o,t.JavaScript.ORDER_NONE)||"false",h=t.JavaScript.statementToCode(n,"DO"+o);t.JavaScript.STATEMENT_SUFFIX&&(h=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n),t.JavaScript.INDENT)+h),r+=(0<o?" else ":"")+"if ("+a+") {\n"+h+"}",++o}while(n.getInput("IF"+o));return(n.getInput("ELSE")||t.JavaScript.STATEMENT_SUFFIX)&&(h=t.JavaScript.statementToCode(n,"ELSE"),t.JavaScript.STATEMENT_SUFFIX&&(h=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n),t.JavaScript.INDENT)+h),r+=" else {\n"+h+"}"),r+"\n"},t.JavaScript.controls_ifelse=t.JavaScript.controls_if,t.JavaScript.logic_compare=function(n){var o={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[n.getFieldValue("OP")],r="=="==o||"!="==o?t.JavaScript.ORDER_EQUALITY:t.JavaScript.ORDER_RELATIONAL;return[(t.JavaScript.valueToCode(n,"A",r)||"0")+" "+o+" "+(n=t.JavaScript.valueToCode(n,"B",r)||"0"),r]},t.JavaScript.logic_operation=function(n){var o="AND"==n.getFieldValue("OP")?"&&":"||",r="&&"==o?t.JavaScript.ORDER_LOGICAL_AND:t.JavaScript.ORDER_LOGICAL_OR,a=t.JavaScript.valueToCode(n,"A",r);if(n=t.JavaScript.valueToCode(n,"B",r),a||n){var h="&&"==o?"true":"false";a||(a=h),n||(n=h)}else n=a="false";return[a+" "+o+" "+n,r]},t.JavaScript.logic_negate=function(n){var o=t.JavaScript.ORDER_LOGICAL_NOT;return["!"+(t.JavaScript.valueToCode(n,"BOOL",o)||"true"),o]},t.JavaScript.logic_boolean=function(n){return["TRUE"==n.getFieldValue("BOOL")?"true":"false",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.logic_null=function(n){return["null",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.logic_ternary=function(n){return[(t.JavaScript.valueToCode(n,"IF",t.JavaScript.ORDER_CONDITIONAL)||"false")+" ? "+(t.JavaScript.valueToCode(n,"THEN",t.JavaScript.ORDER_CONDITIONAL)||"null")+" : "+(n=t.JavaScript.valueToCode(n,"ELSE",t.JavaScript.ORDER_CONDITIONAL)||"null"),t.JavaScript.ORDER_CONDITIONAL]},t.JavaScript.loops={},t.JavaScript.controls_repeat_ext=function(n){var o=n.getField("TIMES")?String(Number(n.getFieldValue("TIMES"))):t.JavaScript.valueToCode(n,"TIMES",t.JavaScript.ORDER_ASSIGNMENT)||"0",r=t.JavaScript.statementToCode(n,"DO");r=t.JavaScript.addLoopTrap(r,n),n="";var a=t.JavaScript.nameDB_.getDistinctName("count",t.VARIABLE_CATEGORY_NAME),h=o;return o.match(/^\w+$/)||t.isNumber(o)||(n+="var "+(h=t.JavaScript.nameDB_.getDistinctName("repeat_end",t.VARIABLE_CATEGORY_NAME))+" = "+o+";\n"),n+"for (var "+a+" = 0; "+a+" < "+h+"; "+a+"++) {\n"+r+"}\n"},t.JavaScript.controls_repeat=t.JavaScript.controls_repeat_ext,t.JavaScript.controls_whileUntil=function(n){var o="UNTIL"==n.getFieldValue("MODE"),r=t.JavaScript.valueToCode(n,"BOOL",o?t.JavaScript.ORDER_LOGICAL_NOT:t.JavaScript.ORDER_NONE)||"false",a=t.JavaScript.statementToCode(n,"DO");return o&&(r="!"+r),"while ("+r+") {\n"+(a=t.JavaScript.addLoopTrap(a,n))+"}\n"},t.JavaScript.controls_for=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME),r=t.JavaScript.valueToCode(n,"FROM",t.JavaScript.ORDER_ASSIGNMENT)||"0",a=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_ASSIGNMENT)||"0",h=t.JavaScript.valueToCode(n,"BY",t.JavaScript.ORDER_ASSIGNMENT)||"1",R=t.JavaScript.statementToCode(n,"DO");if(R=t.JavaScript.addLoopTrap(R,n),t.isNumber(r)&&t.isNumber(a)&&t.isNumber(h)){var L=Number(r)<=Number(a);n="for ("+o+" = "+r+"; "+o+(L?" <= ":" >= ")+a+"; "+o,n=(1==(o=Math.abs(Number(h)))?n+(L?"++":"--"):n+(L?" += ":" -= ")+o)+") {\n"+R+"}\n"}else n="",L=r,r.match(/^\w+$/)||t.isNumber(r)||(n+="var "+(L=t.JavaScript.nameDB_.getDistinctName(o+"_start",t.VARIABLE_CATEGORY_NAME))+" = "+r+";\n"),r=a,a.match(/^\w+$/)||t.isNumber(a)||(n+="var "+(r=t.JavaScript.nameDB_.getDistinctName(o+"_end",t.VARIABLE_CATEGORY_NAME))+" = "+a+";\n"),n+="var "+(a=t.JavaScript.nameDB_.getDistinctName(o+"_inc",t.VARIABLE_CATEGORY_NAME))+" = ",n=(n=t.isNumber(h)?n+(Math.abs(h)+";\n"):n+"Math.abs("+h+");\n")+"if ("+L+" > "+r+") {\n"+(t.JavaScript.INDENT+a)+" = -"+a+";\n",n+="}\n",n+="for ("+o+" = "+L+"; "+a+" >= 0 ? "+o+" <= "+r+" : "+o+" >= "+r+"; "+o+" += "+a+") {\n"+R+"}\n";return n},t.JavaScript.controls_forEach=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME),r=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_ASSIGNMENT)||"[]",a=t.JavaScript.statementToCode(n,"DO");a=t.JavaScript.addLoopTrap(a,n),n="";var h=r;return r.match(/^\w+$/)||(n+="var "+(h=t.JavaScript.nameDB_.getDistinctName(o+"_list",t.VARIABLE_CATEGORY_NAME))+" = "+r+";\n"),n+"for (var "+(r=t.JavaScript.nameDB_.getDistinctName(o+"_index",t.VARIABLE_CATEGORY_NAME))+" in "+h+") {\n"+(a=t.JavaScript.INDENT+o+" = "+h+"["+r+"];\n"+a)+"}\n"},t.JavaScript.controls_flow_statements=function(n){var o="";if(t.JavaScript.STATEMENT_PREFIX&&(o+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,n)),t.JavaScript.STATEMENT_SUFFIX&&(o+=t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n)),t.JavaScript.STATEMENT_PREFIX){var r=t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(n);r&&!r.suppressPrefixSuffix&&(o+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,r))}switch(n.getFieldValue("FLOW")){case"BREAK":return o+"break;\n";case"CONTINUE":return o+"continue;\n"}throw Error("Unknown flow statement.")},t.JavaScript.math={},t.JavaScript.math_number=function(n){return[n=Number(n.getFieldValue("NUM")),0<=n?t.JavaScript.ORDER_ATOMIC:t.JavaScript.ORDER_UNARY_NEGATION]},t.JavaScript.math_arithmetic=function(n){var o={ADD:[" + ",t.JavaScript.ORDER_ADDITION],MINUS:[" - ",t.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",t.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",t.JavaScript.ORDER_DIVISION],POWER:[null,t.JavaScript.ORDER_NONE]}[n.getFieldValue("OP")],r=o[0],a=t.JavaScript.valueToCode(n,"A",o=o[1])||"0";return n=t.JavaScript.valueToCode(n,"B",o)||"0",r?[a+r+n,o]:["Math.pow("+a+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_single=function(n){var o=n.getFieldValue("OP");if("NEG"==o)return"-"==(n=t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(n=" "+n),["-"+n,t.JavaScript.ORDER_UNARY_NEGATION];switch(n="SIN"==o||"COS"==o||"TAN"==o?t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_DIVISION)||"0":t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_NONE)||"0",o){case"ABS":var r="Math.abs("+n+")";break;case"ROOT":r="Math.sqrt("+n+")";break;case"LN":r="Math.log("+n+")";break;case"EXP":r="Math.exp("+n+")";break;case"POW10":r="Math.pow(10,"+n+")";break;case"ROUND":r="Math.round("+n+")";break;case"ROUNDUP":r="Math.ceil("+n+")";break;case"ROUNDDOWN":r="Math.floor("+n+")";break;case"SIN":r="Math.sin("+n+" / 180 * Math.PI)";break;case"COS":r="Math.cos("+n+" / 180 * Math.PI)";break;case"TAN":r="Math.tan("+n+" / 180 * Math.PI)"}if(r)return[r,t.JavaScript.ORDER_FUNCTION_CALL];switch(o){case"LOG10":r="Math.log("+n+") / Math.log(10)";break;case"ASIN":r="Math.asin("+n+") / Math.PI * 180";break;case"ACOS":r="Math.acos("+n+") / Math.PI * 180";break;case"ATAN":r="Math.atan("+n+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+o)}return[r,t.JavaScript.ORDER_DIVISION]},t.JavaScript.math_constant=function(n){return{PI:["Math.PI",t.JavaScript.ORDER_MEMBER],E:["Math.E",t.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",t.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",t.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",t.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",t.JavaScript.ORDER_ATOMIC]}[n.getFieldValue("CONSTANT")]},t.JavaScript.math_number_property=function(n){var o=t.JavaScript.valueToCode(n,"NUMBER_TO_CHECK",t.JavaScript.ORDER_MODULUS)||"0",r=n.getFieldValue("PROPERTY");if("PRIME"==r)return[t.JavaScript.provideFunction_("mathIsPrime",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+o+")",t.JavaScript.ORDER_FUNCTION_CALL];switch(r){case"EVEN":var a=o+" % 2 == 0";break;case"ODD":a=o+" % 2 == 1";break;case"WHOLE":a=o+" % 1 == 0";break;case"POSITIVE":a=o+" > 0";break;case"NEGATIVE":a=o+" < 0";break;case"DIVISIBLE_BY":a=o+" % "+(n=t.JavaScript.valueToCode(n,"DIVISOR",t.JavaScript.ORDER_MODULUS)||"0")+" == 0"}return[a,t.JavaScript.ORDER_EQUALITY]},t.JavaScript.math_change=function(n){var o=t.JavaScript.valueToCode(n,"DELTA",t.JavaScript.ORDER_ADDITION)||"0";return(n=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME))+" = (typeof "+n+" == 'number' ? "+n+" : 0) + "+o+";\n"},t.JavaScript.math_round=t.JavaScript.math_single,t.JavaScript.math_trig=t.JavaScript.math_single,t.JavaScript.math_on_list=function(n){var o=n.getFieldValue("OP");switch(o){case"SUM":n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_MEMBER)||"[]",n+=".reduce(function(x, y) {return x + y;})";break;case"MIN":n="Math.min.apply(null, "+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"MAX":n="Math.max.apply(null, "+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"AVERAGE":n=(o=t.JavaScript.provideFunction_("mathMean",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"MEDIAN":n=(o=t.JavaScript.provideFunction_("mathMedian",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"MODE":n=(o=t.JavaScript.provideFunction_("mathModes",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"STD_DEV":n=(o=t.JavaScript.provideFunction_("mathStandardDeviation",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"RANDOM":n=(o=t.JavaScript.provideFunction_("mathRandomList",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+o)}return[n,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_modulo=function(n){return[(t.JavaScript.valueToCode(n,"DIVIDEND",t.JavaScript.ORDER_MODULUS)||"0")+" % "+(n=t.JavaScript.valueToCode(n,"DIVISOR",t.JavaScript.ORDER_MODULUS)||"0"),t.JavaScript.ORDER_MODULUS]},t.JavaScript.math_constrain=function(n){return["Math.min(Math.max("+(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_NONE)||"0")+", "+(t.JavaScript.valueToCode(n,"LOW",t.JavaScript.ORDER_NONE)||"0")+"), "+(n=t.JavaScript.valueToCode(n,"HIGH",t.JavaScript.ORDER_NONE)||"Infinity")+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_random_int=function(n){var o=t.JavaScript.valueToCode(n,"FROM",t.JavaScript.ORDER_NONE)||"0";return n=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_NONE)||"0",[t.JavaScript.provideFunction_("mathRandomInt",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+o+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_random_float=function(n){return["Math.random()",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_atan2=function(n){var o=t.JavaScript.valueToCode(n,"X",t.JavaScript.ORDER_NONE)||"0";return["Math.atan2("+(t.JavaScript.valueToCode(n,"Y",t.JavaScript.ORDER_NONE)||"0")+", "+o+") / Math.PI * 180",t.JavaScript.ORDER_DIVISION]},t.JavaScript.procedures={},t.JavaScript.procedures_defreturn=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("NAME"),t.PROCEDURE_CATEGORY_NAME),r="";t.JavaScript.STATEMENT_PREFIX&&(r+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,n)),t.JavaScript.STATEMENT_SUFFIX&&(r+=t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n)),r&&(r=t.JavaScript.prefixLines(r,t.JavaScript.INDENT));var a="";t.JavaScript.INFINITE_LOOP_TRAP&&(a=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.INFINITE_LOOP_TRAP,n),t.JavaScript.INDENT));var h=t.JavaScript.statementToCode(n,"STACK"),R=t.JavaScript.valueToCode(n,"RETURN",t.JavaScript.ORDER_NONE)||"",L="";h&&R&&(L=r),R&&(R=t.JavaScript.INDENT+"return "+R+";\n");for(var W=[],nt=n.getVars(),et=0;et<nt.length;et++)W[et]=t.JavaScript.nameDB_.getName(nt[et],t.VARIABLE_CATEGORY_NAME);return r="function "+o+"("+W.join(", ")+") {\n"+r+a+h+L+R+"}",r=t.JavaScript.scrub_(n,r),t.JavaScript.definitions_["%"+o]=r,null},t.JavaScript.procedures_defnoreturn=t.JavaScript.procedures_defreturn,t.JavaScript.procedures_callreturn=function(n){for(var o=t.JavaScript.nameDB_.getName(n.getFieldValue("NAME"),t.PROCEDURE_CATEGORY_NAME),r=[],a=n.getVars(),h=0;h<a.length;h++)r[h]=t.JavaScript.valueToCode(n,"ARG"+h,t.JavaScript.ORDER_NONE)||"null";return[o+"("+r.join(", ")+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.procedures_callnoreturn=function(n){return t.JavaScript.procedures_callreturn(n)[0]+";\n"},t.JavaScript.procedures_ifreturn=function(n){var o="if ("+(t.JavaScript.valueToCode(n,"CONDITION",t.JavaScript.ORDER_NONE)||"false")+") {\n";return t.JavaScript.STATEMENT_SUFFIX&&(o+=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n),t.JavaScript.INDENT)),n.hasReturnValue_?(n=t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_NONE)||"null",o+=t.JavaScript.INDENT+"return "+n+";\n"):o+=t.JavaScript.INDENT+"return;\n",o+"}\n"},t.JavaScript.texts={},t.JavaScript.text=function(n){return[t.JavaScript.quote_(n.getFieldValue("TEXT")),t.JavaScript.ORDER_ATOMIC]},t.JavaScript.text_multiline=function(n){var o=-1!=(n=t.JavaScript.multiline_quote_(n.getFieldValue("TEXT"))).indexOf("+")?t.JavaScript.ORDER_ADDITION:t.JavaScript.ORDER_ATOMIC;return[n,o]},t.JavaScript.text.forceString_=function(n){return t.JavaScript.text.forceString_.strRegExp.test(n)?[n,t.JavaScript.ORDER_ATOMIC]:["String("+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/,t.JavaScript.text_join=function(n){switch(n.itemCount_){case 0:return["''",t.JavaScript.ORDER_ATOMIC];case 1:return n=t.JavaScript.valueToCode(n,"ADD0",t.JavaScript.ORDER_NONE)||"''",t.JavaScript.text.forceString_(n);case 2:var o=t.JavaScript.valueToCode(n,"ADD0",t.JavaScript.ORDER_NONE)||"''";return n=t.JavaScript.valueToCode(n,"ADD1",t.JavaScript.ORDER_NONE)||"''",[n=t.JavaScript.text.forceString_(o)[0]+" + "+t.JavaScript.text.forceString_(n)[0],t.JavaScript.ORDER_ADDITION];default:o=Array(n.itemCount_);for(var r=0;r<n.itemCount_;r++)o[r]=t.JavaScript.valueToCode(n,"ADD"+r,t.JavaScript.ORDER_NONE)||"''";return[n="["+o.join(",")+"].join('')",t.JavaScript.ORDER_FUNCTION_CALL]}},t.JavaScript.text_append=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME);return n=t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''",o+" += "+t.JavaScript.text.forceString_(n)[0]+";\n"},t.JavaScript.text_length=function(n){return[(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"''")+".length",t.JavaScript.ORDER_MEMBER]},t.JavaScript.text_isEmpty=function(n){return["!"+(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"''")+".length",t.JavaScript.ORDER_LOGICAL_NOT]},t.JavaScript.text_indexOf=function(n){var o="FIRST"==n.getFieldValue("END")?"indexOf":"lastIndexOf",r=t.JavaScript.valueToCode(n,"FIND",t.JavaScript.ORDER_NONE)||"''";return o=(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"''")+"."+o+"("+r+")",n.workspace.options.oneBasedIndex?[o+" + 1",t.JavaScript.ORDER_ADDITION]:[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_charAt=function(n){var o=n.getFieldValue("WHERE")||"FROM_START",r=t.JavaScript.valueToCode(n,"VALUE","RANDOM"==o?t.JavaScript.ORDER_NONE:t.JavaScript.ORDER_MEMBER)||"''";switch(o){case"FIRST":return[r+".charAt(0)",t.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[r+".slice(-1)",t.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[r+".charAt("+(n=t.JavaScript.getAdjusted(n,"AT"))+")",t.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[r+".slice("+(n=t.JavaScript.getAdjusted(n,"AT",1,!0))+").charAt(0)",t.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[t.JavaScript.provideFunction_("textRandomLetter",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+r+")",t.JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},t.JavaScript.text.getIndex_=function(n,o,r){return"FIRST"==o?"0":"FROM_END"==o?n+".length - 1 - "+r:"LAST"==o?n+".length - 1":r},t.JavaScript.text_getSubstring=function(n){var o=n.getFieldValue("WHERE1"),r=n.getFieldValue("WHERE2"),a="FROM_END"!=o&&"LAST"!=o&&"FROM_END"!=r&&"LAST"!=r,h=t.JavaScript.valueToCode(n,"STRING",a?t.JavaScript.ORDER_MEMBER:t.JavaScript.ORDER_NONE)||"''";if("FIRST"==o&&"LAST"==r)return[h,t.JavaScript.ORDER_NONE];if(h.match(/^'?\w+'?$/)||a){switch(o){case"FROM_START":a=t.JavaScript.getAdjusted(n,"AT1");break;case"FROM_END":a=h+".length - "+(a=t.JavaScript.getAdjusted(n,"AT1",1,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":a="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(r){case"FROM_START":n=t.JavaScript.getAdjusted(n,"AT2",1);break;case"FROM_END":n=h+".length - "+(n=t.JavaScript.getAdjusted(n,"AT2",0,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"LAST":n=h+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}o=h+".slice("+a+", "+n+")"}else{a=t.JavaScript.getAdjusted(n,"AT1"),n=t.JavaScript.getAdjusted(n,"AT2");var R=t.JavaScript.text.getIndex_,L={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};o=t.JavaScript.provideFunction_("subsequence"+L[o]+L[r],["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==o||"FROM_START"==o?", at1":"")+("FROM_END"==r||"FROM_START"==r?", at2":"")+") {","  var start = "+R("sequence",o,"at1")+";","  var end = "+R("sequence",r,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+h+("FROM_END"==o||"FROM_START"==o?", "+a:"")+("FROM_END"==r||"FROM_START"==r?", "+n:"")+")"}return[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_changeCase=function(n){var o={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[n.getFieldValue("CASE")];return n=t.JavaScript.valueToCode(n,"TEXT",o?t.JavaScript.ORDER_MEMBER:t.JavaScript.ORDER_NONE)||"''",[o?n+o:t.JavaScript.provideFunction_("textToTitleCase",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+"("+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_trim=function(n){var o={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[n.getFieldValue("MODE")];return[(t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_MEMBER)||"''")+o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_print=function(n){return"window.alert("+(t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''")+");\n"},t.JavaScript.text_prompt_ext=function(n){var o="window.prompt("+(n.getField("TEXT")?t.JavaScript.quote_(n.getFieldValue("TEXT")):t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''")+")";return"NUMBER"==n.getFieldValue("TYPE")&&(o="Number("+o+")"),[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_prompt=t.JavaScript.text_prompt_ext,t.JavaScript.text_count=function(n){var o=t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''";return n=t.JavaScript.valueToCode(n,"SUB",t.JavaScript.ORDER_NONE)||"''",[t.JavaScript.provideFunction_("textCount",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+o+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_replace=function(n){var o=t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''",r=t.JavaScript.valueToCode(n,"FROM",t.JavaScript.ORDER_NONE)||"''";return n=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_NONE)||"''",[t.JavaScript.provideFunction_("textReplace",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+o+", "+r+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_reverse=function(n){return[(t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_MEMBER)||"''")+".split('').reverse().join('')",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.variables={},t.JavaScript.variables_get=function(n){return[t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME),t.JavaScript.ORDER_ATOMIC]},t.JavaScript.variables_set=function(n){var o=t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_ASSIGNMENT)||"0";return t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME)+" = "+o+";\n"},t.JavaScript.variablesDynamic={},t.JavaScript.variables_get_dynamic=t.JavaScript.variables_get,t.JavaScript.variables_set_dynamic=t.JavaScript.variables_set,t.JavaScript}.apply(X,m))&&(B.exports=e)},74715:function(B,X,_){var m,e;m=[_(43542)],void 0!==(e=function(n){return(n={Msg:{}}).Msg.ADD_COMMENT="Add Comment",n.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",n.Msg.CHANGE_VALUE_TITLE="Change value:",n.Msg.CLEAN_UP="Clean up Blocks",n.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",n.Msg.COLLAPSE_ALL="Collapse Blocks",n.Msg.COLLAPSE_BLOCK="Collapse Block",n.Msg.COLOUR_BLEND_COLOUR1="colour 1",n.Msg.COLOUR_BLEND_COLOUR2="colour 2",n.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",n.Msg.COLOUR_BLEND_RATIO="ratio",n.Msg.COLOUR_BLEND_TITLE="blend",n.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",n.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",n.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",n.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",n.Msg.COLOUR_RANDOM_TITLE="random colour",n.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",n.Msg.COLOUR_RGB_BLUE="blue",n.Msg.COLOUR_RGB_GREEN="green",n.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",n.Msg.COLOUR_RGB_RED="red",n.Msg.COLOUR_RGB_TITLE="colour with",n.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",n.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",n.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",n.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",n.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",n.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",n.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",n.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",n.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",n.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",n.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",n.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",n.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",n.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",n.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",n.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",n.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",n.Msg.CONTROLS_IF_MSG_ELSE="else",n.Msg.CONTROLS_IF_MSG_ELSEIF="else if",n.Msg.CONTROLS_IF_MSG_IF="if",n.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",n.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",n.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",n.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",n.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",n.Msg.CONTROLS_REPEAT_INPUT_DO="do",n.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",n.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",n.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",n.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",n.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",n.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",n.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",n.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",n.Msg.DELETE_BLOCK="Delete Block",n.Msg.DELETE_VARIABLE="Delete the '%1' variable",n.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",n.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",n.Msg.DISABLE_BLOCK="Disable Block",n.Msg.DUPLICATE_BLOCK="Duplicate",n.Msg.DUPLICATE_COMMENT="Duplicate Comment",n.Msg.ENABLE_BLOCK="Enable Block",n.Msg.EXPAND_ALL="Expand Blocks",n.Msg.EXPAND_BLOCK="Expand Block",n.Msg.EXTERNAL_INPUTS="External Inputs",n.Msg.HELP="Help",n.Msg.INLINE_INPUTS="Inline Inputs",n.Msg.IOS_CANCEL="Cancel",n.Msg.IOS_ERROR="Error",n.Msg.IOS_OK="OK",n.Msg.IOS_PROCEDURES_ADD_INPUT="+ Add Input",n.Msg.IOS_PROCEDURES_ALLOW_STATEMENTS="Allow statements",n.Msg.IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR="This function has duplicate inputs.",n.Msg.IOS_PROCEDURES_INPUTS="INPUTS",n.Msg.IOS_VARIABLES_ADD_BUTTON="Add",n.Msg.IOS_VARIABLES_ADD_VARIABLE="+ Add Variable",n.Msg.IOS_VARIABLES_DELETE_BUTTON="Delete",n.Msg.IOS_VARIABLES_EMPTY_NAME_ERROR="You can't use an empty variable name.",n.Msg.IOS_VARIABLES_RENAME_BUTTON="Rename",n.Msg.IOS_VARIABLES_VARIABLE_NAME="Variable name",n.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",n.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",n.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",n.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",n.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",n.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",n.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",n.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",n.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",n.Msg.LISTS_GET_INDEX_FIRST="first",n.Msg.LISTS_GET_INDEX_FROM_END="# from end",n.Msg.LISTS_GET_INDEX_FROM_START="#",n.Msg.LISTS_GET_INDEX_GET="get",n.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",n.Msg.LISTS_GET_INDEX_LAST="last",n.Msg.LISTS_GET_INDEX_RANDOM="random",n.Msg.LISTS_GET_INDEX_REMOVE="remove",n.Msg.LISTS_GET_INDEX_TAIL="",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",n.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",n.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",n.Msg.LISTS_GET_SUBLIST_END_LAST="to last",n.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",n.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",n.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",n.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",n.Msg.LISTS_GET_SUBLIST_TAIL="",n.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",n.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",n.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",n.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",n.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",n.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",n.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",n.Msg.LISTS_INLIST="in list",n.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",n.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",n.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",n.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",n.Msg.LISTS_LENGTH_TITLE="length of %1",n.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",n.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",n.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",n.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",n.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",n.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",n.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",n.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",n.Msg.LISTS_SET_INDEX_INPUT_TO="as",n.Msg.LISTS_SET_INDEX_INSERT="insert at",n.Msg.LISTS_SET_INDEX_SET="set",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",n.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",n.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",n.Msg.LISTS_SORT_ORDER_DESCENDING="descending",n.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",n.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",n.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",n.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",n.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",n.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",n.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",n.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",n.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",n.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",n.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",n.Msg.LOGIC_BOOLEAN_FALSE="false",n.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",n.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",n.Msg.LOGIC_BOOLEAN_TRUE="true",n.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",n.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",n.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",n.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",n.Msg.LOGIC_NEGATE_TITLE="not %1",n.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",n.Msg.LOGIC_NULL="null",n.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",n.Msg.LOGIC_NULL_TOOLTIP="Returns null.",n.Msg.LOGIC_OPERATION_AND="and",n.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",n.Msg.LOGIC_OPERATION_OR="or",n.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",n.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",n.Msg.LOGIC_TERNARY_CONDITION="test",n.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",n.Msg.LOGIC_TERNARY_IF_FALSE="if false",n.Msg.LOGIC_TERNARY_IF_TRUE="if true",n.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",n.Msg.MATH_ADDITION_SYMBOL="+",n.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",n.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",n.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",n.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",n.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",n.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",n.Msg.MATH_CHANGE_TITLE="change %1 by %2",n.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",n.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",n.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03c0 (3.141\u2026), e (2.718\u2026), \u03c6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xbd) (0.707\u2026), or \u221e (infinity).",n.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",n.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",n.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",n.Msg.MATH_DIVISION_SYMBOL="\xf7",n.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",n.Msg.MATH_IS_EVEN="is even",n.Msg.MATH_IS_NEGATIVE="is negative",n.Msg.MATH_IS_ODD="is odd",n.Msg.MATH_IS_POSITIVE="is positive",n.Msg.MATH_IS_PRIME="is prime",n.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",n.Msg.MATH_IS_WHOLE="is whole",n.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",n.Msg.MATH_MODULO_TITLE="remainder of %1 \xf7 %2",n.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",n.Msg.MATH_MULTIPLICATION_SYMBOL="\xd7",n.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",n.Msg.MATH_NUMBER_TOOLTIP="A number.",n.Msg.MATH_ONLIST_HELPURL="",n.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",n.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",n.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",n.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",n.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",n.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",n.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",n.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",n.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",n.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",n.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",n.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",n.Msg.MATH_POWER_SYMBOL="^",n.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",n.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",n.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",n.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",n.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",n.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",n.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",n.Msg.MATH_ROUND_OPERATOR_ROUND="round",n.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",n.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",n.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",n.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",n.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",n.Msg.MATH_SINGLE_OP_ROOT="square root",n.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",n.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",n.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",n.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",n.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",n.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",n.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",n.Msg.MATH_SUBTRACTION_SYMBOL="-",n.Msg.MATH_TRIG_ACOS="acos",n.Msg.MATH_TRIG_ASIN="asin",n.Msg.MATH_TRIG_ATAN="atan",n.Msg.MATH_TRIG_COS="cos",n.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",n.Msg.MATH_TRIG_SIN="sin",n.Msg.MATH_TRIG_TAN="tan",n.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",n.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",n.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",n.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",n.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",n.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",n.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",n.Msg.NEW_NUMBER_VARIABLE="Create number variable...",n.Msg.NEW_STRING_VARIABLE="Create string variable...",n.Msg.NEW_VARIABLE="Create variable...",n.Msg.NEW_VARIABLE_TITLE="New variable name:",n.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",n.Msg.ORDINAL_NUMBER_SUFFIX="",n.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",n.Msg.PROCEDURES_BEFORE_PARAMS="with:",n.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",n.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",n.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",n.Msg.PROCEDURES_CREATE_DO="Create '%1'",n.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",n.Msg.PROCEDURES_DEFNORETURN_DO="",n.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",n.Msg.PROCEDURES_DEFNORETURN_TITLE="to",n.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",n.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_DEFRETURN_RETURN="return",n.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",n.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",n.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",n.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",n.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",n.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",n.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",n.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",n.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",n.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",n.Msg.REDO="Redo",n.Msg.REMOVE_COMMENT="Remove Comment",n.Msg.RENAME_VARIABLE="Rename variable...",n.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",n.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",n.Msg.TEXT_APPEND_TITLE="to %1 append text %2",n.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",n.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",n.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",n.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",n.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",n.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",n.Msg.TEXT_CHARAT_FIRST="get first letter",n.Msg.TEXT_CHARAT_FROM_END="get letter # from end",n.Msg.TEXT_CHARAT_FROM_START="get letter #",n.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",n.Msg.TEXT_CHARAT_LAST="get last letter",n.Msg.TEXT_CHARAT_RANDOM="get random letter",n.Msg.TEXT_CHARAT_TAIL="",n.Msg.TEXT_CHARAT_TITLE="in text %1 %2",n.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",n.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",n.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",n.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",n.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",n.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",n.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",n.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",n.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",n.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",n.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",n.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",n.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",n.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",n.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",n.Msg.TEXT_GET_SUBSTRING_TAIL="",n.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",n.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",n.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",n.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",n.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",n.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",n.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",n.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",n.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",n.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",n.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",n.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",n.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",n.Msg.TEXT_LENGTH_TITLE="length of %1",n.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",n.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",n.Msg.TEXT_PRINT_TITLE="print %1",n.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",n.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",n.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",n.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",n.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",n.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",n.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",n.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",n.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",n.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",n.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",n.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",n.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",n.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",n.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",n.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",n.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",n.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",n.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",n.Msg.TODAY="Today",n.Msg.UNDO="Undo",n.Msg.UNNAMED_KEY="unnamed",n.Msg.VARIABLES_DEFAULT_NAME="item",n.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",n.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",n.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",n.Msg.VARIABLES_SET="set %1 to %2",n.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",n.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",n.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",n.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",n.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",n.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",n.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",n.Msg.CONTROLS_FOREACH_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_FOR_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=n.Msg.CONTROLS_IF_MSG_ELSEIF,n.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=n.Msg.CONTROLS_IF_MSG_ELSE,n.Msg.CONTROLS_IF_IF_TITLE_IF=n.Msg.CONTROLS_IF_MSG_IF,n.Msg.CONTROLS_IF_MSG_THEN=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.LISTS_CREATE_WITH_ITEM_TITLE=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.LISTS_GET_INDEX_HELPURL=n.Msg.LISTS_INDEX_OF_HELPURL,n.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.MATH_CHANGE_TITLE_ITEM=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.PROCEDURES_DEFRETURN_COMMENT=n.Msg.PROCEDURES_DEFNORETURN_COMMENT,n.Msg.PROCEDURES_DEFRETURN_DO=n.Msg.PROCEDURES_DEFNORETURN_DO,n.Msg.PROCEDURES_DEFRETURN_PROCEDURE=n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,n.Msg.PROCEDURES_DEFRETURN_TITLE=n.Msg.PROCEDURES_DEFNORETURN_TITLE,n.Msg.TEXT_APPEND_VARIABLE=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.MATH_HUE="230",n.Msg.LOOPS_HUE="120",n.Msg.LISTS_HUE="260",n.Msg.LOGIC_HUE="210",n.Msg.VARIABLES_HUE="330",n.Msg.TEXTS_HUE="160",n.Msg.PROCEDURES_HUE="290",n.Msg.COLOUR_HUE="20",n.Msg.VARIABLES_DYNAMIC_HUE="310",n.Msg}.apply(X,m))&&(B.exports=e)},54364:function(B,X,_){var m,e;m=[_(46251)],void 0!==(e=function(t){"use strict";return t}.apply(X,m))&&(B.exports=e)},46251:function(B,X){var m;void 0!==(m=function(){"use strict";var e={connectionTypes:{INPUT_VALUE:1,OUTPUT_VALUE:2,NEXT_STATEMENT:3,PREVIOUS_STATEMENT:4},constants:{},LINE_MODE_MULTIPLIER:40,PAGE_MODE_MULTIPLIER:125,DRAG_RADIUS:5,FLYOUT_DRAG_RADIUS:10,SNAP_RADIUS:28};return e.CONNECTING_SNAP_RADIUS=e.SNAP_RADIUS,e.CURRENT_CONNECTION_PREFERENCE=8,e.BUMP_DELAY=250,e.BUMP_RANDOMNESS=10,e.COLLAPSE_CHARS=30,e.LONGPRESS=750,e.SOUND_LIMIT=100,e.DRAG_STACK=!0,e.HSV_SATURATION=.45,e.HSV_VALUE=.65,e.SPRITE={width:96,height:124,url:"sprites.png"},e.constants.ALIGN={LEFT:-1,CENTRE:0,RIGHT:1},e.DRAG_NONE=0,e.DRAG_STICKY=1,e.DRAG_BEGIN=1,e.DRAG_FREE=2,e.OPPOSITE_TYPE=[],e.OPPOSITE_TYPE[e.connectionTypes.INPUT_VALUE]=e.connectionTypes.OUTPUT_VALUE,e.OPPOSITE_TYPE[e.connectionTypes.OUTPUT_VALUE]=e.connectionTypes.INPUT_VALUE,e.OPPOSITE_TYPE[e.connectionTypes.NEXT_STATEMENT]=e.connectionTypes.PREVIOUS_STATEMENT,e.OPPOSITE_TYPE[e.connectionTypes.PREVIOUS_STATEMENT]=e.connectionTypes.NEXT_STATEMENT,e.VARIABLE_CATEGORY_NAME="VARIABLE",e.VARIABLE_DYNAMIC_CATEGORY_NAME="VARIABLE_DYNAMIC",e.PROCEDURE_CATEGORY_NAME="PROCEDURE",e.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",e.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",e.constants.COLLAPSED_INPUT_NAME="_TEMP_COLLAPSED_INPUT",e.constants.COLLAPSED_FIELD_NAME="_TEMP_COLLAPSED_FIELD",e.utils={},e.utils.global=function(){return"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:this}(),e.Msg={},e.utils.global.Blockly||(e.utils.global.Blockly={}),e.utils.global.Blockly.Msg||(e.utils.global.Blockly.Msg=e.Msg),e.utils.colour={},e.utils.colour.parse=function(t){t=String(t).toLowerCase().trim();var n=e.utils.colour.names[t];if(n||(n="0x"==t.substring(0,2)?"#"+t.substring(2):t,/^#[0-9a-f]{6}$/.test(n="#"==n[0]?n:"#"+n)))return n;if(/^#[0-9a-f]{3}$/.test(n))return["#",n[1],n[1],n[2],n[2],n[3],n[3]].join("");var o=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return o&&(t=Number(o[1]),n=Number(o[2]),o=Number(o[3]),0<=t&&256>t&&0<=n&&256>n&&0<=o&&256>o)?e.utils.colour.rgbToHex(t,n,o):null},e.utils.colour.rgbToHex=function(t,n,o){return n=t<<16|n<<8|o,16>t?"#"+(16777216|n).toString(16).substr(1):"#"+n.toString(16)},e.utils.colour.hexToRgb=function(t){return(t=e.utils.colour.parse(t))?[(t=parseInt(t.substr(1),16))>>16,t>>8&255,255&t]:[0,0,0]},e.utils.colour.hsvToHex=function(t,n,o){var r=0,a=0,h=0;if(0==n)h=a=r=o;else{var R=Math.floor(t/60),L=t/60-R;t=o*(1-n);var W=o*(1-n*L);switch(n=o*(1-n*(1-L)),R){case 1:r=W,a=o,h=t;break;case 2:r=t,a=o,h=n;break;case 3:r=t,a=W,h=o;break;case 4:r=n,a=t,h=o;break;case 5:r=o,a=t,h=W;break;case 6:case 0:r=o,a=n,h=t}}return e.utils.colour.rgbToHex(Math.floor(r),Math.floor(a),Math.floor(h))},e.utils.colour.blend=function(t,n,o){return(t=e.utils.colour.parse(t))&&(n=e.utils.colour.parse(n))?(t=e.utils.colour.hexToRgb(t),n=e.utils.colour.hexToRgb(n),e.utils.colour.rgbToHex(Math.round(n[0]+o*(t[0]-n[0])),Math.round(n[1]+o*(t[1]-n[1])),Math.round(n[2]+o*(t[2]-n[2])))):null},e.utils.colour.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},e.utils.Coordinate=function(t,n){this.x=t,this.y=n},e.utils.Coordinate.equals=function(t,n){return t==n||!(!t||!n)&&t.x==n.x&&t.y==n.y},e.utils.Coordinate.distance=function(t,n){var o=t.x-n.x;return t=t.y-n.y,Math.sqrt(o*o+t*t)},e.utils.Coordinate.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},e.utils.Coordinate.difference=function(t,n){return new e.utils.Coordinate(t.x-n.x,t.y-n.y)},e.utils.Coordinate.sum=function(t,n){return new e.utils.Coordinate(t.x+n.x,t.y+n.y)},e.utils.Coordinate.prototype.clone=function(){return new e.utils.Coordinate(this.x,this.y)},e.utils.Coordinate.prototype.scale=function(t){return this.x*=t,this.y*=t,this},e.utils.Coordinate.prototype.translate=function(t,n){return this.x+=t,this.y+=n,this},e.utils.Rect=function(t,n,o,r){this.top=t,this.bottom=n,this.left=o,this.right=r},e.utils.Rect.prototype.contains=function(t,n){return t>=this.left&&t<=this.right&&n>=this.top&&n<=this.bottom},e.utils.Rect.prototype.intersects=function(t){return!(this.left>t.right||this.right<t.left||this.top>t.bottom||this.bottom<t.top)},e.utils.string={},e.utils.string.startsWith=function(t,n){return 0==t.lastIndexOf(n,0)},e.utils.string.shortestStringLength=function(t){return t.length?t.reduce(function(n,o){return n.length<o.length?n:o}).length:0},e.utils.string.commonWordPrefix=function(t,n){if(!t.length)return 0;if(1==t.length)return t[0].length;var o=0;n=n||e.utils.string.shortestStringLength(t);for(var r=0;r<n;r++){for(var a=t[0][r],h=1;h<t.length;h++)if(a!=t[h][r])return o;" "==a&&(o=r+1)}for(h=1;h<t.length;h++)if((a=t[h][r])&&" "!=a)return o;return n},e.utils.string.commonWordSuffix=function(t,n){if(!t.length)return 0;if(1==t.length)return t[0].length;var o=0;n=n||e.utils.string.shortestStringLength(t);for(var r=0;r<n;r++){for(var a=t[0].substr(-r-1,1),h=1;h<t.length;h++)if(a!=t[h].substr(-r-1,1))return o;" "==a&&(o=r+1)}for(h=1;h<t.length;h++)if((a=t[h].charAt(t[h].length-r-1))&&" "!=a)return o;return n},e.utils.string.wrap=function(t,n){t=t.split("\n");for(var o=0;o<t.length;o++)t[o]=e.utils.string.wrapLine_(t[o],n);return t.join("\n")},e.utils.string.wrapLine_=function(t,n){if(t.length<=n)return t;for(var o=t.trim().split(/\s+/),r=0;r<o.length;r++)o[r].length>n&&(n=o[r].length);r=-1/0;var a=1;do{var h=r,R=t;t=[];var L=o.length/a,W=1;for(r=0;r<o.length-1;r++)W<(r+1.5)/L?(W++,t[r]=!0):t[r]=!1;t=e.utils.string.wrapMutate_(o,t,n),r=e.utils.string.wrapScore_(o,t,n),t=e.utils.string.wrapToText_(o,t),a++}while(r>h);return R},e.utils.string.wrapScore_=function(t,n,o){for(var r=[0],a=[],h=0;h<t.length;h++)r[r.length-1]+=t[h].length,!0===n[h]?(r.push(0),a.push(t[h].charAt(t[h].length-1))):!1===n[h]&&r[r.length-1]++;for(t=Math.max.apply(Math,r),h=n=0;h<r.length;h++)n-=2*Math.pow(Math.abs(o-r[h]),1.5),n-=Math.pow(t-r[h],1.5),-1!=".?!".indexOf(a[h])?n+=o/3:-1!=",;)]}".indexOf(a[h])&&(n+=o/4);return 1<r.length&&r[r.length-1]<=r[r.length-2]&&(n+=.5),n},e.utils.string.wrapMutate_=function(t,n,o){for(var a,r=e.utils.string.wrapScore_(t,n,o),h=0;h<n.length-1;h++)if(n[h]!=n[h+1]){var R=[].concat(n);R[h]=!R[h],R[h+1]=!R[h+1];var L=e.utils.string.wrapScore_(t,R,o);L>r&&(r=L,a=R)}return a?e.utils.string.wrapMutate_(t,a,o):n},e.utils.string.wrapToText_=function(t,n){for(var o=[],r=0;r<t.length;r++)o.push(t[r]),void 0!==n[r]&&o.push(n[r]?"\n":" ");return o.join("")},e.utils.Size=function(t,n){this.width=t,this.height=n},e.utils.Size.equals=function(t,n){return t==n||!(!t||!n)&&t.width==n.width&&t.height==n.height},e.utils.style={},e.utils.style.getSize=function(t){if("none"!=e.utils.style.getStyle_(t,"display"))return e.utils.style.getSizeWithDisplay_(t);var n=t.style,o=n.display,r=n.visibility,a=n.position;n.visibility="hidden",n.position="absolute",n.display="inline";var h=t.offsetWidth;return t=t.offsetHeight,n.display=o,n.position=a,n.visibility=r,new e.utils.Size(h,t)},e.utils.style.getSizeWithDisplay_=function(t){return new e.utils.Size(t.offsetWidth,t.offsetHeight)},e.utils.style.getStyle_=function(t,n){return e.utils.style.getComputedStyle(t,n)||e.utils.style.getCascadedStyle(t,n)||t.style&&t.style[n]},e.utils.style.getComputedStyle=function(t,n){return document.defaultView&&document.defaultView.getComputedStyle&&(t=document.defaultView.getComputedStyle(t,null))&&(t[n]||t.getPropertyValue(n))||""},e.utils.style.getCascadedStyle=function(t,n){return t.currentStyle?t.currentStyle[n]:null},e.utils.style.getPageOffset=function(t){var n=new e.utils.Coordinate(0,0);t=t.getBoundingClientRect();var o=document.documentElement;return o=new e.utils.Coordinate(window.pageXOffset||o.scrollLeft,window.pageYOffset||o.scrollTop),n.x=t.left+o.x,n.y=t.top+o.y,n},e.utils.style.getViewportPageOffset=function(){var t=document.body,n=document.documentElement;return new e.utils.Coordinate(t.scrollLeft||n.scrollLeft,t.scrollTop||n.scrollTop)},e.utils.style.setElementShown=function(t,n){t.style.display=n?"":"none"},e.utils.style.isRightToLeft=function(t){return"rtl"==e.utils.style.getStyle_(t,"direction")},e.utils.style.getBorderBox=function(t){var n=e.utils.style.getComputedStyle(t,"borderLeftWidth"),o=e.utils.style.getComputedStyle(t,"borderRightWidth"),r=e.utils.style.getComputedStyle(t,"borderTopWidth");return t=e.utils.style.getComputedStyle(t,"borderBottomWidth"),{top:parseFloat(r),right:parseFloat(o),bottom:parseFloat(t),left:parseFloat(n)}},e.utils.style.scrollIntoContainerView=function(t,n,o){t=e.utils.style.getContainerOffsetToScrollInto(t,n,o),n.scrollLeft=t.x,n.scrollTop=t.y},e.utils.style.getContainerOffsetToScrollInto=function(t,n,o){var r=e.utils.style.getPageOffset(t),a=e.utils.style.getPageOffset(n),h=e.utils.style.getBorderBox(n),R=r.x-a.x-h.left;return r=r.y-a.y-h.top,a=e.utils.style.getSizeWithDisplay_(t),t=n.clientWidth-a.width,a=n.clientHeight-a.height,h=n.scrollLeft,n=n.scrollTop,o?(h+=R-t/2,n+=r-a/2):(h+=Math.min(R,Math.max(R-t,0)),n+=Math.min(r,Math.max(r-a,0))),new e.utils.Coordinate(h,n)},e.utils.userAgent={},function(t){function n(r){return-1!=o.indexOf(r.toUpperCase())}e.utils.userAgent.raw=t;var o=e.utils.userAgent.raw.toUpperCase();e.utils.userAgent.IE=n("Trident")||n("MSIE"),e.utils.userAgent.EDGE=n("Edge"),e.utils.userAgent.JAVA_FX=n("JavaFX"),e.utils.userAgent.CHROME=(n("Chrome")||n("CriOS"))&&!e.utils.userAgent.EDGE,e.utils.userAgent.WEBKIT=n("WebKit")&&!e.utils.userAgent.EDGE,e.utils.userAgent.GECKO=n("Gecko")&&!e.utils.userAgent.WEBKIT&&!e.utils.userAgent.IE&&!e.utils.userAgent.EDGE,e.utils.userAgent.ANDROID=n("Android"),t=e.utils.global.navigator&&e.utils.global.navigator.maxTouchPoints,e.utils.userAgent.IPAD=n("iPad")||n("Macintosh")&&0<t,e.utils.userAgent.IPOD=n("iPod"),e.utils.userAgent.IPHONE=n("iPhone")&&!e.utils.userAgent.IPAD&&!e.utils.userAgent.IPOD,e.utils.userAgent.MAC=n("Macintosh"),e.utils.userAgent.TABLET=e.utils.userAgent.IPAD||e.utils.userAgent.ANDROID&&!n("Mobile")||n("Silk"),e.utils.userAgent.MOBILE=!e.utils.userAgent.TABLET&&(e.utils.userAgent.IPOD||e.utils.userAgent.IPHONE||e.utils.userAgent.ANDROID||n("IEMobile"))}(e.utils.global.navigator&&e.utils.global.navigator.userAgent||""),e.utils.noEvent=function(t){t.preventDefault(),t.stopPropagation()},e.utils.isTargetInput=function(t){return"textarea"==t.target.type||"text"==t.target.type||"number"==t.target.type||"email"==t.target.type||"password"==t.target.type||"search"==t.target.type||"tel"==t.target.type||"url"==t.target.type||t.target.isContentEditable||t.target.dataset&&"true"==t.target.dataset.isTextInput},e.utils.getRelativeXY=function(t){var n=new e.utils.Coordinate(0,0),o=t.getAttribute("x");return o&&(n.x=parseInt(o,10)),(o=t.getAttribute("y"))&&(n.y=parseInt(o,10)),(o=(o=t.getAttribute("transform"))&&o.match(e.utils.getRelativeXY.XY_REGEX_))&&(n.x+=Number(o[1]),o[3]&&(n.y+=Number(o[3]))),(t=t.getAttribute("style"))&&-1<t.indexOf("translate")&&(t=t.match(e.utils.getRelativeXY.XY_STYLE_REGEX_))&&(n.x+=Number(t[1]),t[3]&&(n.y+=Number(t[3]))),n},e.utils.getInjectionDivXY_=function(t){for(var n=0,o=0;t;){var r=e.utils.getRelativeXY(t);if(n+=r.x,o+=r.y,-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;t=t.parentNode}return new e.utils.Coordinate(n,o)},e.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,e.utils.getRelativeXY.XY_STYLE_REGEX_=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,e.utils.isRightButton=function(t){return!(!t.ctrlKey||!e.utils.userAgent.MAC)||2==t.button},e.utils.mouseToSvg=function(t,n,o){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,o||(o=n.getScreenCTM().inverse()),r.matrixTransform(o)},e.utils.getScrollDeltaPixels=function(t){switch(t.deltaMode){default:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*e.LINE_MODE_MULTIPLIER,y:t.deltaY*e.LINE_MODE_MULTIPLIER};case 2:return{x:t.deltaX*e.PAGE_MODE_MULTIPLIER,y:t.deltaY*e.PAGE_MODE_MULTIPLIER}}},e.utils.tokenizeInterpolation=function(t){return e.utils.tokenizeInterpolation_(t,!0)},e.utils.replaceMessageReferences=function(t){return"string"!=typeof t?t:(t=e.utils.tokenizeInterpolation_(t,!1)).length?String(t[0]):""},e.utils.checkMessageReferences=function(t){for(var n=!0,o=e.Msg,r=t.match(/%{BKY_[A-Z]\w*}/gi),a=0;a<r.length;a++)null==o[r[a].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+r[a]+" in "+t),n=!1);return n},e.utils.tokenizeInterpolation_=function(t,n){var o=[],r=t.split("");r.push("");var a=0;t=[];for(var h=null,R=0;R<r.length;R++){var L=r[R];0==a?"%"==L?((L=t.join(""))&&o.push(L),t.length=0,a=1):t.push(L):1==a?"%"==L?(t.push(L),a=0):n&&"0"<=L&&"9">=L?(a=2,h=L,(L=t.join(""))&&o.push(L),t.length=0):"{"==L?a=3:(t.push("%",L),a=0):2==a?"0"<=L&&"9">=L?h+=L:(o.push(parseInt(h,10)),R--,a=0):3==a&&(""==L?(t.splice(0,0,"%{"),R--,a=0):"}"!=L?t.push(L):(a=t.join(""),/[A-Z]\w*/i.test(a)?(L=a.toUpperCase(),(L=e.utils.string.startsWith(L,"BKY_")?L.substring(4):null)&&L in e.Msg?"string"==typeof(a=e.Msg[L])?Array.prototype.push.apply(o,e.utils.tokenizeInterpolation_(a,n)):o.push(n?String(a):a):o.push("%{"+a+"}")):o.push("%{"+a+"}"),a=t.length=0))}for((L=t.join(""))&&o.push(L),n=[],R=t.length=0;R<o.length;++R)"string"==typeof o[R]?t.push(o[R]):((L=t.join(""))&&n.push(L),t.length=0,n.push(o[R]));return(L=t.join(""))&&n.push(L),t.length=0,n},e.utils.genUid=function(){for(var t=e.utils.genUid.soup_.length,n=[],o=0;20>o;o++)n[o]=e.utils.genUid.soup_.charAt(Math.random()*t);return n.join("")},e.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e.utils.is3dSupported=function(){if(void 0!==e.utils.is3dSupported.cached_)return e.utils.is3dSupported.cached_;if(!e.utils.global.getComputedStyle)return!1;var t=document.createElement("p"),n="none",o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var r in document.body.insertBefore(t,null),o)if(void 0!==t.style[r]){if(t.style[r]="translate3d(1px,1px,1px)",!(n=e.utils.global.getComputedStyle(t)))return document.body.removeChild(t),!1;n=n.getPropertyValue(o[r])}return document.body.removeChild(t),e.utils.is3dSupported.cached_="none"!==n,e.utils.is3dSupported.cached_},e.utils.runAfterPageLoad=function(t){if("object"!=typeof document)throw Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"==document.readyState)t();else var n=setInterval(function(){"complete"==document.readyState&&(clearInterval(n),t())},10)},e.utils.getViewportBBox=function(){var t=e.utils.style.getViewportPageOffset();return new e.utils.Rect(t.y,document.documentElement.clientHeight+t.y,t.x,document.documentElement.clientWidth+t.x)},e.utils.arrayRemove=function(t,n){return-1!=(n=t.indexOf(n))&&(t.splice(n,1),!0)},e.utils.getDocumentScroll=function(){var t=document.documentElement,n=window;return e.utils.userAgent.IE&&n.pageYOffset!=t.scrollTop?new e.utils.Coordinate(t.scrollLeft,t.scrollTop):new e.utils.Coordinate(n.pageXOffset||t.scrollLeft,n.pageYOffset||t.scrollTop)},e.utils.getBlockTypeCounts=function(t,n){var o=Object.create(null),r=t.getDescendants(!0);for(n&&(t=t.getNextBlock())&&(t=r.indexOf(t),r.splice(t,r.length-t)),t=0;n=r[t];t++)o[n.type]?o[n.type]++:o[n.type]=1;return o},e.utils.screenToWsCoordinates=function(t,n){var o=n.x;n=n.y;var r=t.getInjectionDiv().getBoundingClientRect();return o=new e.utils.Coordinate(o-r.left,n-r.top),n=t.getOriginOffsetInPixels(),e.utils.Coordinate.difference(o,n).scale(1/t.scale)},e.utils.parseBlockColour=function(t){var n="string"==typeof t?e.utils.replaceMessageReferences(t):t,o=Number(n);if(!isNaN(o)&&0<=o&&360>=o)return{hue:o,hex:e.utils.colour.hsvToHex(o,e.HSV_SATURATION,255*e.HSV_VALUE)};if(o=e.utils.colour.parse(n))return{hue:null,hex:o};throw o='Invalid colour: "'+n+'"',t!=n&&(o+=' (from "'+t+'")'),Error(o)},e.Touch={},e.Touch.TOUCH_ENABLED="ontouchstart"in e.utils.global||!!(e.utils.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!e.utils.global.navigator||!e.utils.global.navigator.maxTouchPoints&&!e.utils.global.navigator.msMaxTouchPoints),e.Touch.touchIdentifier_=null,e.Touch.TOUCH_MAP={},e.utils.global.PointerEvent?e.Touch.TOUCH_MAP={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]}:e.Touch.TOUCH_ENABLED&&(e.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]}),e.longPid_=0,e.longStart=function(t,n){e.longStop_(),t.changedTouches&&1!=t.changedTouches.length||(e.longPid_=setTimeout(function(){t.changedTouches&&(t.button=2,t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY),n&&n.handleRightClick(t)},e.LONGPRESS))},e.longStop_=function(){e.longPid_&&(clearTimeout(e.longPid_),e.longPid_=0)},e.Touch.clearTouchIdentifier=function(){e.Touch.touchIdentifier_=null},e.Touch.shouldHandleEvent=function(t){return!e.Touch.isMouseOrTouchEvent(t)||e.Touch.checkTouchIdentifier(t)},e.Touch.getTouchIdentifierFromEvent=function(t){return null!=t.pointerId?t.pointerId:t.changedTouches&&t.changedTouches[0]&&null!=t.changedTouches[0].identifier?t.changedTouches[0].identifier:"mouse"},e.Touch.checkTouchIdentifier=function(t){var n=e.Touch.getTouchIdentifierFromEvent(t);return null!=e.Touch.touchIdentifier_?e.Touch.touchIdentifier_==n:("mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type)&&(e.Touch.touchIdentifier_=n,!0)},e.Touch.setClientFromTouch=function(t){if(e.utils.string.startsWith(t.type,"touch")){var n=t.changedTouches[0];t.clientX=n.clientX,t.clientY=n.clientY}},e.Touch.isMouseOrTouchEvent=function(t){return e.utils.string.startsWith(t.type,"touch")||e.utils.string.startsWith(t.type,"mouse")||e.utils.string.startsWith(t.type,"pointer")},e.Touch.isTouchEvent=function(t){return e.utils.string.startsWith(t.type,"touch")||e.utils.string.startsWith(t.type,"pointer")},e.Touch.splitEventByTouches=function(t){var n=[];if(t.changedTouches)for(var o=0;o<t.changedTouches.length;o++)n[o]={type:t.type,changedTouches:[t.changedTouches[o]],target:t.target,stopPropagation:function(){t.stopPropagation()},preventDefault:function(){t.preventDefault()}};else n.push(t);return n},e.browserEvents={},e.browserEvents.conditionalBind=function(t,n,o,r,a,h){var R=!1,L=function(It){var gt=!a;It=e.Touch.splitEventByTouches(It);for(var Ut,wt=0;Ut=It[wt];wt++)(!gt||e.Touch.shouldHandleEvent(Ut))&&(e.Touch.setClientFromTouch(Ut),o?r.call(o,Ut):r(Ut),R=!0)},W=[];if(e.utils.global.PointerEvent&&n in e.Touch.TOUCH_MAP)for(var et,nt=0;et=e.Touch.TOUCH_MAP[n][nt];nt++)t.addEventListener(et,L,!1),W.push([t,et,L]);else if(t.addEventListener(n,L,!1),W.push([t,n,L]),n in e.Touch.TOUCH_MAP){var Et=function(It){L(It),R&&!h&&It.preventDefault()};for(nt=0;et=e.Touch.TOUCH_MAP[n][nt];nt++)t.addEventListener(et,Et,!1),W.push([t,et,Et])}return W},e.browserEvents.bind=function(t,n,o,r){var a=function(nt){o?r.call(o,nt):r(nt)},h=[];if(e.utils.global.PointerEvent&&n in e.Touch.TOUCH_MAP)for(var L,R=0;L=e.Touch.TOUCH_MAP[n][R];R++)t.addEventListener(L,a,!1),h.push([t,L,a]);else if(t.addEventListener(n,a,!1),h.push([t,n,a]),n in e.Touch.TOUCH_MAP){var W=function(nt){if(nt.changedTouches&&1==nt.changedTouches.length){var et=nt.changedTouches[0];nt.clientX=et.clientX,nt.clientY=et.clientY}a(nt),nt.preventDefault()};for(R=0;L=e.Touch.TOUCH_MAP[n][R];R++)t.addEventListener(L,W,!1),h.push([t,L,W])}return h},e.browserEvents.unbind=function(t){for(;t.length;){var n=t.pop(),o=n[2];n[0].removeEventListener(n[1],o,!1)}return o},e.ComponentManager=function(){this.componentData_=Object.create(null),this.capabilityToComponentIds_=Object.create(null)},e.ComponentManager.prototype.addComponent=function(t,n){var o=t.component.id;if(!n&&this.componentData_[o])throw Error('Plugin "'+o+'" with capabilities "'+this.componentData_[o].capabilities+'" already added.');this.componentData_[o]=t,n=[];for(var r=0;r<t.capabilities.length;r++){var a=String(t.capabilities[r]).toLowerCase();n.push(a),void 0===this.capabilityToComponentIds_[a]?this.capabilityToComponentIds_[a]=[o]:this.capabilityToComponentIds_[a].push(o)}this.componentData_[o].capabilities=n},e.ComponentManager.prototype.removeComponent=function(t){var n=this.componentData_[t];if(n){for(var o=0;o<n.capabilities.length;o++){var r=String(n.capabilities[o]).toLowerCase();this.capabilityToComponentIds_[r].splice(this.capabilityToComponentIds_[r].indexOf(t),1)}delete this.componentData_[t]}},e.ComponentManager.prototype.addCapability=function(t,n){if(!this.getComponent(t))throw Error('Cannot add capability, "'+n+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,n)?console.warn('Plugin "'+t+'already has capability "'+n+'"'):(n=String(n).toLowerCase(),this.componentData_[t].capabilities.push(n),this.capabilityToComponentIds_[n].push(t))},e.ComponentManager.prototype.removeCapability=function(t,n){if(!this.getComponent(t))throw Error('Cannot remove capability, "'+n+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,n)?(n=String(n).toLowerCase(),this.componentData_[t].capabilities.splice(this.componentData_[t].capabilities.indexOf(n),1),this.capabilityToComponentIds_[n].splice(this.capabilityToComponentIds_[n].indexOf(t),1)):console.warn('Plugin "'+t+"doesn't have capability \""+n+'" to remove')},e.ComponentManager.prototype.hasCapability=function(t,n){return n=String(n).toLowerCase(),-1!==this.componentData_[t].capabilities.indexOf(n)},e.ComponentManager.prototype.getComponent=function(t){return this.componentData_[t]&&this.componentData_[t].component},e.ComponentManager.prototype.getComponents=function(t,n){if(t=String(t).toLowerCase(),!(t=this.capabilityToComponentIds_[t]))return[];var o=[];if(n){var r=[],a=this.componentData_;t.forEach(function(h){r.push(a[h])}),r.sort(function(h,R){return h.weight-R.weight}),r.forEach(function(h){o.push(h.component)})}else a=this.componentData_,t.forEach(function(h){o.push(a[h].component)});return o},e.ComponentManager.Capability=function(t){this.name_=t},e.ComponentManager.Capability.prototype.toString=function(){return this.name_},e.ComponentManager.Capability.POSITIONABLE=new e.ComponentManager.Capability("positionable"),e.ComponentManager.Capability.DRAG_TARGET=new e.ComponentManager.Capability("drag_target"),e.ComponentManager.Capability.DELETE_AREA=new e.ComponentManager.Capability("delete_area"),e.ComponentManager.Capability.AUTOHIDEABLE=new e.ComponentManager.Capability("autohideable"),e.utils.Svg=function(t){this.tagName_=t},e.utils.Svg.prototype.toString=function(){return this.tagName_},e.utils.Svg.ANIMATE=new e.utils.Svg("animate"),e.utils.Svg.CIRCLE=new e.utils.Svg("circle"),e.utils.Svg.CLIPPATH=new e.utils.Svg("clipPath"),e.utils.Svg.DEFS=new e.utils.Svg("defs"),e.utils.Svg.FECOMPOSITE=new e.utils.Svg("feComposite"),e.utils.Svg.FECOMPONENTTRANSFER=new e.utils.Svg("feComponentTransfer"),e.utils.Svg.FEFLOOD=new e.utils.Svg("feFlood"),e.utils.Svg.FEFUNCA=new e.utils.Svg("feFuncA"),e.utils.Svg.FEGAUSSIANBLUR=new e.utils.Svg("feGaussianBlur"),e.utils.Svg.FEPOINTLIGHT=new e.utils.Svg("fePointLight"),e.utils.Svg.FESPECULARLIGHTING=new e.utils.Svg("feSpecularLighting"),e.utils.Svg.FILTER=new e.utils.Svg("filter"),e.utils.Svg.FOREIGNOBJECT=new e.utils.Svg("foreignObject"),e.utils.Svg.G=new e.utils.Svg("g"),e.utils.Svg.IMAGE=new e.utils.Svg("image"),e.utils.Svg.LINE=new e.utils.Svg("line"),e.utils.Svg.PATH=new e.utils.Svg("path"),e.utils.Svg.PATTERN=new e.utils.Svg("pattern"),e.utils.Svg.POLYGON=new e.utils.Svg("polygon"),e.utils.Svg.RECT=new e.utils.Svg("rect"),e.utils.Svg.SVG=new e.utils.Svg("svg"),e.utils.Svg.TEXT=new e.utils.Svg("text"),e.utils.Svg.TSPAN=new e.utils.Svg("tspan"),e.utils.dom={},e.utils.dom.SVG_NS="http://www.w3.org/2000/svg",e.utils.dom.HTML_NS="http://www.w3.org/1999/xhtml",e.utils.dom.XLINK_NS="http://www.w3.org/1999/xlink",e.utils.dom.NodeType={ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8,DOCUMENT_POSITION_CONTAINED_BY:16},e.utils.dom.cacheWidths_=null,e.utils.dom.cacheReference_=0,e.utils.dom.canvasContext_=null,e.utils.dom.createSvgElement=function(t,n,o){for(var r in t=document.createElementNS(e.utils.dom.SVG_NS,String(t)),n)t.setAttribute(r,n[r]);return document.body.runtimeStyle&&(t.runtimeStyle=t.currentStyle=t.style),o&&o.appendChild(t),t},e.utils.dom.addClass=function(t,n){var o=t.getAttribute("class")||"";return-1==(" "+o+" ").indexOf(" "+n+" ")&&(o&&(o+=" "),t.setAttribute("class",o+n),!0)},e.utils.dom.removeClasses=function(t,n){n=n.split(" ");for(var o=0;o<n.length;o++)e.utils.dom.removeClass(t,n[o])},e.utils.dom.removeClass=function(t,n){var o=t.getAttribute("class");if(-1==(" "+o+" ").indexOf(" "+n+" "))return!1;o=o.split(/\s+/);for(var r=0;r<o.length;r++)o[r]&&o[r]!=n||(o.splice(r,1),r--);return o.length?t.setAttribute("class",o.join(" ")):t.removeAttribute("class"),!0},e.utils.dom.hasClass=function(t,n){return-1!=(" "+t.getAttribute("class")+" ").indexOf(" "+n+" ")},e.utils.dom.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},e.utils.dom.insertAfter=function(t,n){var o=n.nextSibling;if(!(n=n.parentNode))throw Error("Reference node has no parent.");o?n.insertBefore(t,o):n.appendChild(t)},e.utils.dom.containsNode=function(t,n){return!!(t.compareDocumentPosition(n)&e.utils.dom.NodeType.DOCUMENT_POSITION_CONTAINED_BY)},e.utils.dom.setCssTransform=function(t,n){t.style.transform=n,t.style["-webkit-transform"]=n},e.utils.dom.startTextWidthCache=function(){e.utils.dom.cacheReference_++,e.utils.dom.cacheWidths_||(e.utils.dom.cacheWidths_=Object.create(null))},e.utils.dom.stopTextWidthCache=function(){e.utils.dom.cacheReference_--,e.utils.dom.cacheReference_||(e.utils.dom.cacheWidths_=null)},e.utils.dom.getTextWidth=function(t){var o,n=t.textContent+"\n"+t.className.baseVal;if(e.utils.dom.cacheWidths_&&(o=e.utils.dom.cacheWidths_[n]))return o;try{o=e.utils.userAgent.IE||e.utils.userAgent.EDGE?t.getBBox().width:t.getComputedTextLength()}catch(r){return 8*t.textContent.length}return e.utils.dom.cacheWidths_&&(e.utils.dom.cacheWidths_[n]=o),o},e.utils.dom.getFastTextWidth=function(t,n,o,r){return e.utils.dom.getFastTextWidthWithSizeString(t,n+"pt",o,r)},e.utils.dom.getFastTextWidthWithSizeString=function(t,n,o,r){var h,a=t.textContent;return t=a+"\n"+t.className.baseVal,e.utils.dom.cacheWidths_&&(h=e.utils.dom.cacheWidths_[t])||(e.utils.dom.canvasContext_||((h=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(h),e.utils.dom.canvasContext_=h.getContext("2d")),e.utils.dom.canvasContext_.font=o+" "+n+" "+r,h=e.utils.dom.canvasContext_.measureText(a).width,e.utils.dom.cacheWidths_&&(e.utils.dom.cacheWidths_[t]=h)),h},e.utils.dom.measureFontMetrics=function(t,n,o,r){var a=document.createElement("span");a.style.font=o+" "+n+" "+r,a.textContent=t,(t=document.createElement("div")).style.width="1px",t.style.height="0px",(n=document.createElement("div")).setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),n.appendChild(a),n.appendChild(t),document.body.appendChild(n);try{o={},n.style.alignItems="baseline",o.baseline=t.offsetTop-a.offsetTop,n.style.alignItems="flex-end",o.height=t.offsetTop-a.offsetTop}finally{document.body.removeChild(n)}return o},e.utils.math={},e.utils.math.toRadians=function(t){return t*Math.PI/180},e.utils.math.toDegrees=function(t){return 180*t/Math.PI},e.utils.math.clamp=function(t,n,o){if(o<t){var r=o;o=t,t=r}return Math.max(t,Math.min(n,o))},e.DropDownDiv=function(){},e.DropDownDiv.boundsElement_=null,e.DropDownDiv.owner_=null,e.DropDownDiv.positionToField_=null,e.DropDownDiv.ARROW_SIZE=16,e.DropDownDiv.BORDER_SIZE=1,e.DropDownDiv.ARROW_HORIZONTAL_PADDING=12,e.DropDownDiv.PADDING_Y=16,e.DropDownDiv.ANIMATION_TIME=.25,e.DropDownDiv.animateOutTimer_=null,e.DropDownDiv.onHide_=null,e.DropDownDiv.rendererClassName_="",e.DropDownDiv.themeClassName_="",e.DropDownDiv.createDom=function(){if(!e.DropDownDiv.DIV_){var t=document.createElement("div");t.className="blocklyDropDownDiv",(e.parentContainer||document.body).appendChild(t),e.DropDownDiv.DIV_=t;var n=document.createElement("div");n.className="blocklyDropDownContent",t.appendChild(n),e.DropDownDiv.content_=n,(n=document.createElement("div")).className="blocklyDropDownArrow",t.appendChild(n),e.DropDownDiv.arrow_=n,e.DropDownDiv.DIV_.style.opacity=0,e.DropDownDiv.DIV_.style.transition="transform "+e.DropDownDiv.ANIMATION_TIME+"s, opacity "+e.DropDownDiv.ANIMATION_TIME+"s",t.addEventListener("focusin",function(){e.utils.dom.addClass(t,"blocklyFocused")}),t.addEventListener("focusout",function(){e.utils.dom.removeClass(t,"blocklyFocused")})}},e.DropDownDiv.setBoundsElement=function(t){e.DropDownDiv.boundsElement_=t},e.DropDownDiv.getContentDiv=function(){return e.DropDownDiv.content_},e.DropDownDiv.clearContent=function(){e.DropDownDiv.content_.textContent="",e.DropDownDiv.content_.style.width=""},e.DropDownDiv.setColour=function(t,n){e.DropDownDiv.DIV_.style.backgroundColor=t,e.DropDownDiv.DIV_.style.borderColor=n},e.DropDownDiv.showPositionedByBlock=function(t,n,o,r){return e.DropDownDiv.showPositionedByRect_(e.DropDownDiv.getScaledBboxOfBlock_(n),t,o,r)},e.DropDownDiv.showPositionedByField=function(t,n,o){return e.DropDownDiv.positionToField_=!0,e.DropDownDiv.showPositionedByRect_(e.DropDownDiv.getScaledBboxOfField_(t),t,n,o)},e.DropDownDiv.getScaledBboxOfBlock_=function(t){var n=t.getSvgRoot(),o=n.getBBox(),r=t.workspace.scale;return t=o.height*r,o=o.width*r,n=e.utils.style.getPageOffset(n),new e.utils.Rect(n.y,n.y+t,n.x,n.x+o)},e.DropDownDiv.getScaledBboxOfField_=function(t){return t=t.getScaledBBox(),new e.utils.Rect(t.top,t.bottom,t.left,t.right)},e.DropDownDiv.showPositionedByRect_=function(t,n,o,r){var a=t.left+(t.right-t.left)/2,h=t.bottom;t=t.top,r&&(t+=r);for(var R=(r=n.getSourceBlock()).workspace;R.options.parentWorkspace;)R=R.options.parentWorkspace;return e.DropDownDiv.setBoundsElement(R.getParentSvg().parentNode),e.DropDownDiv.show(n,r.RTL,a,h,a,t,o)},e.DropDownDiv.show=function(t,n,o,r,a,h,R){return e.DropDownDiv.owner_=t,e.DropDownDiv.onHide_=R||null,(t=e.DropDownDiv.DIV_).style.direction=n?"rtl":"ltr",n=e.getMainWorkspace(),e.DropDownDiv.rendererClassName_=n.getRenderer().getClassName(),e.DropDownDiv.themeClassName_=n.getTheme().getClassName(),e.utils.dom.addClass(t,e.DropDownDiv.rendererClassName_),e.utils.dom.addClass(t,e.DropDownDiv.themeClassName_),e.DropDownDiv.positionInternal_(o,r,a,h)},e.DropDownDiv.getBoundsInfo_=function(){var t=e.utils.style.getPageOffset(e.DropDownDiv.boundsElement_),n=e.utils.style.getSize(e.DropDownDiv.boundsElement_);return{left:t.x,right:t.x+n.width,top:t.y,bottom:t.y+n.height,width:n.width,height:n.height}},e.DropDownDiv.getPositionMetrics_=function(t,n,o,r){var a=e.DropDownDiv.getBoundsInfo_(),h=e.utils.style.getSize(e.DropDownDiv.DIV_);return n+h.height<a.bottom?e.DropDownDiv.getPositionBelowMetrics_(t,n,a,h):r-h.height>a.top?e.DropDownDiv.getPositionAboveMetrics_(o,r,a,h):n+h.height<document.documentElement.clientHeight?e.DropDownDiv.getPositionBelowMetrics_(t,n,a,h):r-h.height>document.documentElement.clientTop?e.DropDownDiv.getPositionAboveMetrics_(o,r,a,h):e.DropDownDiv.getPositionTopOfPageMetrics_(t,a,h)},e.DropDownDiv.getPositionBelowMetrics_=function(t,n,o,r){return{initialX:(t=e.DropDownDiv.getPositionX(t,o.left,o.right,r.width)).divX,initialY:n,finalX:t.divX,finalY:n+e.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:-(e.DropDownDiv.ARROW_SIZE/2+e.DropDownDiv.BORDER_SIZE),arrowAtTop:!0,arrowVisible:!0}},e.DropDownDiv.getPositionAboveMetrics_=function(t,n,o,r){return{initialX:(t=e.DropDownDiv.getPositionX(t,o.left,o.right,r.width)).divX,initialY:n-r.height,finalX:t.divX,finalY:n-r.height-e.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:r.height-2*e.DropDownDiv.BORDER_SIZE-e.DropDownDiv.ARROW_SIZE/2,arrowAtTop:!1,arrowVisible:!0}},e.DropDownDiv.getPositionTopOfPageMetrics_=function(t,n,o){return{initialX:(t=e.DropDownDiv.getPositionX(t,n.left,n.right,o.width)).divX,initialY:0,finalX:t.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},e.DropDownDiv.getPositionX=function(t,n,o,r){var a=t;return t=e.utils.math.clamp(n,t-r/2,o-r),{arrowX:r=e.utils.math.clamp(n=e.DropDownDiv.ARROW_HORIZONTAL_PADDING,(a-=e.DropDownDiv.ARROW_SIZE/2)-t,r-n-e.DropDownDiv.ARROW_SIZE),divX:t}},e.DropDownDiv.isVisible=function(){return!!e.DropDownDiv.owner_},e.DropDownDiv.hideIfOwner=function(t,n){return e.DropDownDiv.owner_===t&&(n?e.DropDownDiv.hideWithoutAnimation():e.DropDownDiv.hide(),!0)},e.DropDownDiv.hide=function(){var t=e.DropDownDiv.DIV_;t.style.transform="translate(0, 0)",t.style.opacity=0,e.DropDownDiv.animateOutTimer_=setTimeout(function(){e.DropDownDiv.hideWithoutAnimation()},1e3*e.DropDownDiv.ANIMATION_TIME),e.DropDownDiv.onHide_&&(e.DropDownDiv.onHide_(),e.DropDownDiv.onHide_=null)},e.DropDownDiv.hideWithoutAnimation=function(){if(e.DropDownDiv.isVisible()){e.DropDownDiv.animateOutTimer_&&clearTimeout(e.DropDownDiv.animateOutTimer_);var t=e.DropDownDiv.DIV_;t.style.transform="",t.style.left="",t.style.top="",t.style.opacity=0,t.style.display="none",t.style.backgroundColor="",t.style.borderColor="",e.DropDownDiv.onHide_&&(e.DropDownDiv.onHide_(),e.DropDownDiv.onHide_=null),e.DropDownDiv.clearContent(),e.DropDownDiv.owner_=null,e.DropDownDiv.rendererClassName_&&(e.utils.dom.removeClass(t,e.DropDownDiv.rendererClassName_),e.DropDownDiv.rendererClassName_=""),e.DropDownDiv.themeClassName_&&(e.utils.dom.removeClass(t,e.DropDownDiv.themeClassName_),e.DropDownDiv.themeClassName_=""),e.getMainWorkspace().markFocused()}},e.DropDownDiv.positionInternal_=function(t,n,o,r){(t=e.DropDownDiv.getPositionMetrics_(t,n,o,r)).arrowVisible?(e.DropDownDiv.arrow_.style.display="",e.DropDownDiv.arrow_.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",e.DropDownDiv.arrow_.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):e.DropDownDiv.arrow_.style.display="none",n=Math.floor(t.initialX),o=Math.floor(t.initialY),r=Math.floor(t.finalX);var a=Math.floor(t.finalY),h=e.DropDownDiv.DIV_;return h.style.left=n+"px",h.style.top=o+"px",h.style.display="block",h.style.opacity=1,h.style.transform="translate("+(r-n)+"px,"+(a-o)+"px)",!!t.arrowAtTop},e.DropDownDiv.repositionForWindowResize=function(){if(e.DropDownDiv.owner_){var t=e.DropDownDiv.owner_,n=t.getSourceBlock();t=e.DropDownDiv.positionToField_?e.DropDownDiv.getScaledBboxOfField_(t):e.DropDownDiv.getScaledBboxOfBlock_(n),e.DropDownDiv.positionInternal_(n=t.left+(t.right-t.left)/2,t.bottom,n,t.top)}else e.DropDownDiv.hide()},e.registry={},e.registry.typeMap_=Object.create(null),e.registry.DEFAULT="default",e.registry.Type=function(t){this.name_=t},e.registry.Type.prototype.toString=function(){return this.name_},e.registry.Type.CONNECTION_CHECKER=new e.registry.Type("connectionChecker"),e.registry.Type.CURSOR=new e.registry.Type("cursor"),e.registry.Type.EVENT=new e.registry.Type("event"),e.registry.Type.FIELD=new e.registry.Type("field"),e.registry.Type.RENDERER=new e.registry.Type("renderer"),e.registry.Type.TOOLBOX=new e.registry.Type("toolbox"),e.registry.Type.THEME=new e.registry.Type("theme"),e.registry.Type.TOOLBOX_ITEM=new e.registry.Type("toolboxItem"),e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX=new e.registry.Type("flyoutsVerticalToolbox"),e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX=new e.registry.Type("flyoutsHorizontalToolbox"),e.registry.Type.METRICS_MANAGER=new e.registry.Type("metricsManager"),e.registry.Type.BLOCK_DRAGGER=new e.registry.Type("blockDragger"),e.registry.register=function(t,n,o,r){if(!(t instanceof e.registry.Type)&&"string"!=typeof t||""==String(t).trim())throw Error('Invalid type "'+t+'". The type must be a non-empty string or a Blockly.registry.Type.');if(t=String(t).toLowerCase(),"string"!=typeof n||""==n.trim())throw Error('Invalid name "'+n+'". The name must be a non-empty string.');if(n=n.toLowerCase(),!o)throw Error("Can not register a null value");var a=e.registry.typeMap_[t];if(a||(a=e.registry.typeMap_[t]=Object.create(null)),e.registry.validate_(t,o),!r&&a[n])throw Error('Name "'+n+'" with type "'+t+'" already registered.');a[n]=o},e.registry.validate_=function(t,n){if(t===String(e.registry.Type.FIELD)&&"function"!=typeof n.fromJson)throw Error('Type "'+t+'" must have a fromJson function')},e.registry.unregister=function(t,n){t=String(t).toLowerCase(),n=n.toLowerCase();var o=e.registry.typeMap_[t];o&&o[n]?delete e.registry.typeMap_[t][n]:console.warn("Unable to unregister ["+n+"]["+t+"] from the registry.")},e.registry.getItem_=function(t,n,o){t=String(t).toLowerCase(),n=n.toLowerCase();var r=e.registry.typeMap_[t];if(!r||!r[n]){if(n="Unable to find ["+n+"]["+t+"] in the registry.",o)throw Error(n+" You must require or register a "+t+" plugin.");return console.warn(n),null}return r[n]},e.registry.hasItem=function(t,n){return t=String(t).toLowerCase(),n=n.toLowerCase(),!!(t=e.registry.typeMap_[t])&&!!t[n]},e.registry.getClass=function(t,n,o){return e.registry.getItem_(t,n,o)},e.registry.getObject=function(t,n,o){return e.registry.getItem_(t,n,o)},e.registry.getClassFromOptions=function(t,n,o){return"function"==typeof(n=n.plugins[t.toString()]||e.registry.DEFAULT)?n:e.registry.getClass(t,n,o)},e.Events={},e.Events.group_="",e.Events.recordUndo=!0,e.Events.disabled_=0,e.Events.CREATE="create",e.Events.BLOCK_CREATE=e.Events.CREATE,e.Events.DELETE="delete",e.Events.BLOCK_DELETE=e.Events.DELETE,e.Events.CHANGE="change",e.Events.BLOCK_CHANGE=e.Events.CHANGE,e.Events.MOVE="move",e.Events.BLOCK_MOVE=e.Events.MOVE,e.Events.VAR_CREATE="var_create",e.Events.VAR_DELETE="var_delete",e.Events.VAR_RENAME="var_rename",e.Events.UI="ui",e.Events.BLOCK_DRAG="drag",e.Events.SELECTED="selected",e.Events.CLICK="click",e.Events.MARKER_MOVE="marker_move",e.Events.BUBBLE_OPEN="bubble_open",e.Events.TRASHCAN_OPEN="trashcan_open",e.Events.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.Events.THEME_CHANGE="theme_change",e.Events.VIEWPORT_CHANGE="viewport_change",e.Events.COMMENT_CREATE="comment_create",e.Events.COMMENT_DELETE="comment_delete",e.Events.COMMENT_CHANGE="comment_change",e.Events.COMMENT_MOVE="comment_move",e.Events.FINISHED_LOADING="finished_loading",e.Events.BUMP_EVENTS=[e.Events.BLOCK_CREATE,e.Events.BLOCK_MOVE,e.Events.COMMENT_CREATE,e.Events.COMMENT_MOVE],e.Events.FIRE_QUEUE_=[],e.Events.fire=function(t){e.Events.isEnabled()&&(e.Events.FIRE_QUEUE_.length||setTimeout(e.Events.fireNow_,0),e.Events.FIRE_QUEUE_.push(t))},e.Events.fireNow_=function(){for(var o,t=e.Events.filter(e.Events.FIRE_QUEUE_,!0),n=e.Events.FIRE_QUEUE_.length=0;o=t[n];n++)if(o.workspaceId){var r=e.Workspace.getById(o.workspaceId);r&&r.fireChangeListener(o)}},e.Events.filter=function(t,n){t=t.slice(),n||t.reverse();for(var h,o=[],r=Object.create(null),a=0;h=t[a];a++)if(!h.isNull()){var R=[h.isUiEvent?e.Events.UI:h.type,h.blockId,h.workspaceId].join(" "),L=r[R],W=L?L.event:null;L?h.type==e.Events.MOVE&&L.index==a-1?(W.newParentId=h.newParentId,W.newInputName=h.newInputName,W.newCoordinate=h.newCoordinate,L.index=a):h.type==e.Events.CHANGE&&h.element==W.element&&h.name==W.name?W.newValue=h.newValue:h.type==e.Events.VIEWPORT_CHANGE?(W.viewTop=h.viewTop,W.viewLeft=h.viewLeft,W.scale=h.scale,W.oldScale=h.oldScale):(h.type!=e.Events.CLICK||W.type!=e.Events.BUBBLE_OPEN)&&(r[R]={event:h,index:a},o.push(h)):(r[R]={event:h,index:a},o.push(h))}for(t=o.filter(function(nt){return!nt.isNull()}),n||t.reverse(),a=1;h=t[a];a++)h.type==e.Events.CHANGE&&"mutation"==h.element&&t.unshift(t.splice(a,1)[0]);return t},e.Events.clearPendingUndo=function(){for(var n,t=0;n=e.Events.FIRE_QUEUE_[t];t++)n.recordUndo=!1},e.Events.disable=function(){e.Events.disabled_++},e.Events.enable=function(){e.Events.disabled_--},e.Events.isEnabled=function(){return 0==e.Events.disabled_},e.Events.getGroup=function(){return e.Events.group_},e.Events.setGroup=function(t){e.Events.group_="boolean"==typeof t?t?e.utils.genUid():"":t},e.Events.getDescendantIds=function(t){var n=[];t=t.getDescendants(!1);for(var r,o=0;r=t[o];o++)n[o]=r.id;return n},e.Events.fromJson=function(t,n){var o=e.Events.get(t.type);if(!o)throw Error("Unknown event type.");return(o=new o).fromJson(t),o.workspaceId=n.id,o},e.Events.get=function(t){return e.registry.getClass(e.registry.Type.EVENT,t)},e.Events.disableOrphans=function(t){if((t.type==e.Events.MOVE||t.type==e.Events.CREATE)&&t.workspaceId){var n=e.Workspace.getById(t.workspaceId),o=n.getBlockById(t.blockId);if(o){t=e.Events.recordUndo;try{e.Events.recordUndo=!1;var r=o.getParent();if(r&&r.isEnabled()){var h,a=o.getDescendants(!1);for(n=0;h=a[n];n++)h.setEnabled(!0)}else if((o.outputConnection||o.previousConnection)&&!n.isDragging())do{o.setEnabled(!1),o=o.getNextBlock()}while(o)}finally{e.Events.recordUndo=t}}}},e.Events.Abstract=function(){this.isBlank=null,this.workspaceId=void 0,this.group=e.Events.getGroup(),this.recordUndo=e.Events.recordUndo},e.Events.Abstract.prototype.isUiEvent=!1,e.Events.Abstract.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),t},e.Events.Abstract.prototype.fromJson=function(t){this.isBlank=!1,this.group=t.group},e.Events.Abstract.prototype.isNull=function(){return!1},e.Events.Abstract.prototype.run=function(t){},e.Events.Abstract.prototype.getEventWorkspace_=function(){if(this.workspaceId)var t=e.Workspace.getById(this.workspaceId);if(!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t},e.utils.object={},e.utils.object.inherits=function(t,n){t.superClass_=n.prototype,t.prototype=Object.create(n.prototype),t.prototype.constructor=t},e.utils.object.mixin=function(t,n){for(var o in n)t[o]=n[o]},e.utils.object.deepMerge=function(t,n){for(var o in n)t[o]=null!=n[o]&&"object"==typeof n[o]?e.utils.object.deepMerge(t[o]||Object.create(null),n[o]):n[o];return t},e.utils.object.values=function(t){return Object.values?Object.values(t):Object.keys(t).map(function(n){return t[n]})},e.utils.xml={},e.utils.xml.NAME_SPACE="https://developers.google.com/blockly/xml",e.utils.xml.document=function(){return document},e.utils.xml.createElement=function(t){return e.utils.xml.document().createElementNS(e.utils.xml.NAME_SPACE,t)},e.utils.xml.createTextNode=function(t){return e.utils.xml.document().createTextNode(t)},e.utils.xml.textToDomDocument=function(t){return(new DOMParser).parseFromString(t,"text/xml")},e.utils.xml.domToText=function(t){return(new XMLSerializer).serializeToString(t)},e.inputTypes={VALUE:e.connectionTypes.INPUT_VALUE,STATEMENT:e.connectionTypes.NEXT_STATEMENT,DUMMY:5},e.Xml={},e.Xml.workspaceToDom=function(t,n){var o=e.utils.xml.createElement("xml"),r=e.Xml.variablesToDom(e.Variables.allUsedVarModels(t));r.hasChildNodes()&&o.appendChild(r);var h,a=t.getTopComments(!0);for(r=0;h=a[r];r++)o.appendChild(h.toXmlWithXY(n));for(t=t.getTopBlocks(!0),r=0;a=t[r];r++)o.appendChild(e.Xml.blockToDomWithXY(a,n));return o},e.Xml.variablesToDom=function(t){for(var r,n=e.utils.xml.createElement("variables"),o=0;r=t[o];o++){var a=e.utils.xml.createElement("variable");a.appendChild(e.utils.xml.createTextNode(r.name)),r.type&&a.setAttribute("type",r.type),a.id=r.getId(),n.appendChild(a)}return n},e.Xml.blockToDomWithXY=function(t,n){if(t.isInsertionMarker()&&!(t=t.getChildren(!1)[0]))return new DocumentFragment;var o;t.workspace.RTL&&(o=t.workspace.getWidth()),n=e.Xml.blockToDom(t,n);var r=t.getRelativeToSurfaceXY();return n.setAttribute("x",Math.round(t.workspace.RTL?o-r.x:r.x)),n.setAttribute("y",Math.round(r.y)),n},e.Xml.fieldToDom_=function(t){if(t.isSerializable()){var n=e.utils.xml.createElement("field");return n.setAttribute("name",t.name||""),t.toXml(n)}return null},e.Xml.allFieldsToDom_=function(t,n){for(var r,o=0;r=t.inputList[o];o++)for(var h,a=0;h=r.fieldRow[a];a++)(h=e.Xml.fieldToDom_(h))&&n.appendChild(h)},e.Xml.blockToDom=function(t,n){if(t.isInsertionMarker())return(t=t.getChildren(!1)[0])?e.Xml.blockToDom(t):new DocumentFragment;var o=e.utils.xml.createElement(t.isShadow()?"shadow":"block");if(o.setAttribute("type",t.type),n||o.setAttribute("id",t.id),t.mutationToDom){var r=t.mutationToDom();r&&(r.hasChildNodes()||r.hasAttributes())&&o.appendChild(r)}if(e.Xml.allFieldsToDom_(t,o),r=t.getCommentText()){var a=t.commentModel.size,h=t.commentModel.pinned,R=e.utils.xml.createElement("comment");R.appendChild(e.utils.xml.createTextNode(r)),R.setAttribute("pinned",h),R.setAttribute("h",a.height),R.setAttribute("w",a.width),o.appendChild(R)}for(t.data&&((r=e.utils.xml.createElement("data")).appendChild(e.utils.xml.createTextNode(t.data)),o.appendChild(r)),r=0;a=t.inputList[r];r++){var L;if(h=!0,a.type!=e.inputTypes.DUMMY){var W=a.connection.targetBlock();a.type==e.inputTypes.VALUE?L=e.utils.xml.createElement("value"):a.type==e.inputTypes.STATEMENT&&(L=e.utils.xml.createElement("statement")),!(R=a.connection.getShadowDom())||W&&W.isShadow()||L.appendChild(e.Xml.cloneShadow_(R,n)),W&&(R=e.Xml.blockToDom(W,n)).nodeType==e.utils.dom.NodeType.ELEMENT_NODE&&(L.appendChild(R),h=!1),L.setAttribute("name",a.name),h||o.appendChild(L)}}return null!=t.inputsInline&&t.inputsInline!=t.inputsInlineDefault&&o.setAttribute("inline",t.inputsInline),t.isCollapsed()&&o.setAttribute("collapsed",!0),t.isEnabled()||o.setAttribute("disabled",!0),t.isDeletable()||t.isShadow()||o.setAttribute("deletable",!1),t.isMovable()||t.isShadow()||o.setAttribute("movable",!1),t.isEditable()||o.setAttribute("editable",!1),(r=t.getNextBlock())&&(R=e.Xml.blockToDom(r,n)).nodeType==e.utils.dom.NodeType.ELEMENT_NODE&&((L=e.utils.xml.createElement("next")).appendChild(R),o.appendChild(L)),!(R=t.nextConnection&&t.nextConnection.getShadowDom())||r&&r.isShadow()||L.appendChild(e.Xml.cloneShadow_(R,n)),o},e.Xml.cloneShadow_=function(t,n){for(var r,o=t=t.cloneNode(!0);o;)if(n&&"shadow"==o.nodeName&&o.removeAttribute("id"),o.firstChild)o=o.firstChild;else{for(;o&&!o.nextSibling;)r=o,o=o.parentNode,r.nodeType==e.utils.dom.NodeType.TEXT_NODE&&""==r.data.trim()&&o.firstChild!=r&&e.utils.dom.removeNode(r);o&&(r=o,o=o.nextSibling,r.nodeType==e.utils.dom.NodeType.TEXT_NODE&&""==r.data.trim()&&e.utils.dom.removeNode(r))}return t},e.Xml.domToText=function(t){return e.utils.xml.domToText(t).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},e.Xml.domToPrettyText=function(t){t=e.Xml.domToText(t).split("<");for(var n="",o=1;o<t.length;o++){var r=t[o];"/"==r[0]&&(n=n.substring(2)),t[o]=n+"<"+r,"/"!=r[0]&&"/>"!=r.slice(-2)&&(n+="  ")}return(t=(t=t.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},e.Xml.textToDom=function(t){var n=e.utils.xml.textToDomDocument(t);if(!n||!n.documentElement||n.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+t);return n.documentElement},e.Xml.clearWorkspaceAndLoadFromXml=function(t,n){return n.setResizesEnabled(!1),n.clear(),t=e.Xml.domToWorkspace(t,n),n.setResizesEnabled(!0),t},e.Xml.domToWorkspace=function(t,n){if(t instanceof e.Workspace){var o=t;t=n,n=o,console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var r;n.RTL&&(r=n.getWidth()),o=[],e.utils.dom.startTextWidthCache();var a=e.Events.getGroup();a||e.Events.setGroup(!0),n.setResizesEnabled&&n.setResizesEnabled(!1);var h=!0;try{for(var L,R=0;L=t.childNodes[R];R++){var W=L.nodeName.toLowerCase(),nt=L;if("block"==W||"shadow"==W&&!e.Events.recordUndo){var et=e.Xml.domToBlock(nt,n);o.push(et.id);var Et=nt.hasAttribute("x")?parseInt(nt.getAttribute("x"),10):10,It=nt.hasAttribute("y")?parseInt(nt.getAttribute("y"),10):10;isNaN(Et)||isNaN(It)||et.moveBy(n.RTL?r-Et:Et,It),h=!1}else{if("shadow"==W)throw TypeError("Shadow block cannot be a top-level block.");if("comment"==W)n.rendered?e.WorkspaceCommentSvg?e.WorkspaceCommentSvg.fromXml(nt,n,r):console.warn("Missing require for Blockly.WorkspaceCommentSvg, ignoring workspace comment."):e.WorkspaceComment?e.WorkspaceComment.fromXml(nt,n):console.warn("Missing require for Blockly.WorkspaceComment, ignoring workspace comment.");else if("variables"==W){if(!h)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");e.Xml.domToVariables(nt,n),h=!1}}}}finally{a||e.Events.setGroup(!1),e.utils.dom.stopTextWidthCache()}return n.setResizesEnabled&&n.setResizesEnabled(!0),e.Events.fire(new(e.Events.get(e.Events.FINISHED_LOADING))(n)),o},e.Xml.appendDomToWorkspace=function(t,n){var o;if(Object.prototype.hasOwnProperty.call(n,"scale")&&(o=n.getBlocksBoundingBox()),t=e.Xml.domToWorkspace(t,n),o&&o.top!=o.bottom){var r=o.bottom,a=n.RTL?o.right:o.left,h=1/0,R=-1/0,L=1/0;for(o=0;o<t.length;o++){var W=n.getBlockById(t[o]).getRelativeToSurfaceXY();W.y<L&&(L=W.y),W.x<h&&(h=W.x),W.x>R&&(R=W.x)}for(r=r-L+10,a=n.RTL?a-R:a-h,o=0;o<t.length;o++)n.getBlockById(t[o]).moveBy(a,r)}return t},e.Xml.domToBlock=function(t,n){if(t instanceof e.Workspace){var o=t;t=n,n=o,console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}e.Events.disable(),o=n.getAllVariables();try{var r=e.Xml.domToBlockHeadless_(t,n),a=r.getDescendants(!1);if(n.rendered){r.setConnectionTracking(!1);for(var h=a.length-1;0<=h;h--)a[h].initSvg();for(h=a.length-1;0<=h;h--)a[h].render(!1);setTimeout(function(){r.disposed||r.setConnectionTracking(!0)},1),r.updateDisabled(),n.resizeContents()}else for(h=a.length-1;0<=h;h--)a[h].initModel()}finally{e.Events.enable()}if(e.Events.isEnabled()){for(t=e.Variables.getAddedVariables(n,o),h=0;h<t.length;h++)n=t[h],e.Events.fire(new(e.Events.get(e.Events.VAR_CREATE))(n));e.Events.fire(new(e.Events.get(e.Events.CREATE))(r))}return r},e.Xml.domToVariables=function(t,n){for(var r,o=0;r=t.childNodes[o];o++)if(r.nodeType==e.utils.dom.NodeType.ELEMENT_NODE){var a=r.getAttribute("type"),h=r.getAttribute("id");n.createVariable(r.textContent,a,h)}},e.Xml.mapSupportedXmlTags_=function(t){for(var r,n={mutation:[],comment:[],data:[],field:[],input:[],next:[]},o=0;r=t.childNodes[o];o++)if(r.nodeType!=e.utils.dom.NodeType.TEXT_NODE)switch(r.nodeName.toLowerCase()){case"mutation":n.mutation.push(r);break;case"comment":if(!e.Comment){console.warn("Missing require for Blockly.Comment, ignoring block comment.");break}n.comment.push(r);break;case"data":n.data.push(r);break;case"title":case"field":n.field.push(r);break;case"value":case"statement":n.input.push(r);break;case"next":n.next.push(r);break;default:console.warn("Ignoring unknown tag: "+r.nodeName)}return n},e.Xml.applyMutationTagNodes_=function(t,n){for(var a,o=!1,r=0;a=t[r];r++)n.domToMutation&&(n.domToMutation(a),n.initSvg&&(o=!0));return o},e.Xml.applyCommentTagNodes_=function(t,n){for(var r,o=0;r=t[o];o++){var a=r.textContent,h="true"==r.getAttribute("pinned"),R=parseInt(r.getAttribute("w"),10);r=parseInt(r.getAttribute("h"),10),n.setCommentText(a),n.commentModel.pinned=h,isNaN(R)||isNaN(r)||(n.commentModel.size=new e.utils.Size(R,r)),h&&n.getCommentIcon&&!n.isInFlyout&&setTimeout(function(){n.getCommentIcon().setVisible(!0)},1)}},e.Xml.applyDataTagNodes_=function(t,n){for(var r,o=0;r=t[o];o++)n.data=r.textContent},e.Xml.applyFieldTagNodes_=function(t,n){for(var r,o=0;r=t[o];o++){var a=r.getAttribute("name");e.Xml.domToField_(n,a,r)}},e.Xml.findChildBlocks_=function(t){for(var r,n={childBlockElement:null,childShadowElement:null},o=0;r=t.childNodes[o];o++)r.nodeType==e.utils.dom.NodeType.ELEMENT_NODE&&("block"==r.nodeName.toLowerCase()?n.childBlockElement=r:"shadow"==r.nodeName.toLowerCase()&&(n.childShadowElement=r));return n},e.Xml.applyInputTagNodes_=function(t,n,o,r){for(var h,a=0;h=t[a];a++){var R=h.getAttribute("name"),L=o.getInput(R);if(!L){console.warn("Ignoring non-existent input "+R+" in block "+r);break}if((h=e.Xml.findChildBlocks_(h)).childBlockElement){if(!L.connection)throw TypeError("Input connection does not exist.");e.Xml.domToBlockHeadless_(h.childBlockElement,n,L.connection,!1)}h.childShadowElement&&L.connection.setShadowDom(h.childShadowElement)}},e.Xml.applyNextTagNodes_=function(t,n,o){for(var a,r=0;a=t[r];r++){if((a=e.Xml.findChildBlocks_(a)).childBlockElement){if(!o.nextConnection)throw TypeError("Next statement does not exist.");if(o.nextConnection.isConnected())throw TypeError("Next statement is already connected.");e.Xml.domToBlockHeadless_(a.childBlockElement,n,o.nextConnection,!0)}a.childShadowElement&&o.nextConnection&&o.nextConnection.setShadowDom(a.childShadowElement)}},e.Xml.domToBlockHeadless_=function(t,n,o,r){var a=t.getAttribute("type");if(!a)throw TypeError("Block type unspecified: "+t.outerHTML);var h=t.getAttribute("id");h=n.newBlock(a,h);var R=e.Xml.mapSupportedXmlTags_(t),L=e.Xml.applyMutationTagNodes_(R.mutation,h);if(e.Xml.applyCommentTagNodes_(R.comment,h),e.Xml.applyDataTagNodes_(R.data,h),o)if(r){if(!h.previousConnection)throw TypeError("Next block does not have previous statement.");o.connect(h.previousConnection)}else if(h.outputConnection)o.connect(h.outputConnection);else{if(!h.previousConnection)throw TypeError("Child block does not have output or previous statement.");o.connect(h.previousConnection)}if(e.Xml.applyFieldTagNodes_(R.field,h),e.Xml.applyInputTagNodes_(R.input,n,h,a),e.Xml.applyNextTagNodes_(R.next,n,h),L&&h.initSvg(),(n=t.getAttribute("inline"))&&h.setInputsInline("true"==n),(n=t.getAttribute("disabled"))&&h.setEnabled("true"!=n&&"disabled"!=n),(n=t.getAttribute("deletable"))&&h.setDeletable("true"==n),(n=t.getAttribute("movable"))&&h.setMovable("true"==n),(n=t.getAttribute("editable"))&&h.setEditable("true"==n),(n=t.getAttribute("collapsed"))&&h.setCollapsed("true"==n),"shadow"==t.nodeName.toLowerCase()){for(t=h.getChildren(!1),n=0;o=t[n];n++)if(!o.isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(h.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");h.setShadow(!0)}return h},e.Xml.domToField_=function(t,n,o){var r=t.getField(n);r?r.fromXml(o):console.warn("Ignoring non-existent field "+n+" in block "+t.type)},e.Xml.deleteNext=function(t){for(var o,n=0;o=t.childNodes[n];n++)if("next"==o.nodeName.toLowerCase()){t.removeChild(o);break}},e.Events.BlockBase=function(t){e.Events.BlockBase.superClass_.constructor.call(this),this.blockId=(this.isBlank=void 0===t)?"":t.id,this.workspaceId=this.isBlank?"":t.workspace.id},e.utils.object.inherits(e.Events.BlockBase,e.Events.Abstract),e.Events.BlockBase.prototype.toJson=function(){var t=e.Events.BlockBase.superClass_.toJson.call(this);return t.blockId=this.blockId,t},e.Events.BlockBase.prototype.fromJson=function(t){e.Events.BlockBase.superClass_.fromJson.call(this,t),this.blockId=t.blockId},e.Events.BlockChange=function(t,n,o,r,a){e.Events.Change.superClass_.constructor.call(this,t),t&&(this.element=void 0===n?"":n,this.name=void 0===o?"":o,this.oldValue=void 0===r?"":r,this.newValue=void 0===a?"":a)},e.utils.object.inherits(e.Events.BlockChange,e.Events.BlockBase),e.Events.Change=e.Events.BlockChange,e.Events.BlockChange.prototype.type=e.Events.CHANGE,e.Events.BlockChange.prototype.toJson=function(){var t=e.Events.BlockChange.superClass_.toJson.call(this);return t.element=this.element,this.name&&(t.name=this.name),t.oldValue=this.oldValue,t.newValue=this.newValue,t},e.Events.BlockChange.prototype.fromJson=function(t){e.Events.BlockChange.superClass_.fromJson.call(this,t),this.element=t.element,this.name=t.name,this.oldValue=t.oldValue,this.newValue=t.newValue},e.Events.BlockChange.prototype.isNull=function(){return this.oldValue==this.newValue},e.Events.BlockChange.prototype.run=function(t){var n=this.getEventWorkspace_().getBlockById(this.blockId);if(n)switch(n.mutator&&n.mutator.setVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(n=n.getField(this.name))?n.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":n.setCommentText(t||null);break;case"collapsed":n.setCollapsed(!!t);break;case"disabled":n.setEnabled(!t);break;case"inline":n.setInputsInline(!!t);break;case"mutation":var o="";if(n.mutationToDom&&(o=(o=n.mutationToDom())&&e.Xml.domToText(o)),n.domToMutation){var r=e.Xml.textToDom(t||"<mutation/>");n.domToMutation(r)}e.Events.fire(new e.Events.BlockChange(n,"mutation",null,o,t));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existent block: "+this.blockId)},e.Events.Create=function(t){e.Events.Create.superClass_.constructor.call(this,t),t&&(t.isShadow()&&(this.recordUndo=!1),this.xml=t.workspace.rendered?e.Xml.blockToDomWithXY(t):e.Xml.blockToDom(t),this.ids=e.Events.getDescendantIds(t))},e.utils.object.inherits(e.Events.Create,e.Events.BlockBase),e.Events.BlockCreate=e.Events.Create,e.Events.Create.prototype.type=e.Events.CREATE,e.Events.Create.prototype.toJson=function(){var t=e.Events.Create.superClass_.toJson.call(this);return t.xml=e.Xml.domToText(this.xml),t.ids=this.ids,this.recordUndo||(t.recordUndo=this.recordUndo),t},e.Events.Create.prototype.fromJson=function(t){e.Events.Create.superClass_.fromJson.call(this,t),this.xml=e.Xml.textToDom(t.xml),this.ids=t.ids,void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},e.Events.Create.prototype.run=function(t){var n=this.getEventWorkspace_();if(t)(t=e.utils.xml.createElement("xml")).appendChild(this.xml),e.Xml.domToWorkspace(t,n);else{t=0;for(var o;o=this.ids[t];t++){var r=n.getBlockById(o);r?r.dispose(!1):o==this.blockId&&console.warn("Can't uncreate non-existent block: "+o)}}},e.Events.Delete=function(t){if(e.Events.Delete.superClass_.constructor.call(this,t),t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");t.isShadow()&&(this.recordUndo=!1),this.oldXml=t.workspace.rendered?e.Xml.blockToDomWithXY(t):e.Xml.blockToDom(t),this.ids=e.Events.getDescendantIds(t)}},e.utils.object.inherits(e.Events.Delete,e.Events.BlockBase),e.Events.BlockDelete=e.Events.Delete,e.Events.Delete.prototype.type=e.Events.DELETE,e.Events.Delete.prototype.toJson=function(){var t=e.Events.Delete.superClass_.toJson.call(this);return t.oldXml=e.Xml.domToText(this.oldXml),t.ids=this.ids,this.recordUndo||(t.recordUndo=this.recordUndo),t},e.Events.Delete.prototype.fromJson=function(t){e.Events.Delete.superClass_.fromJson.call(this,t),this.oldXml=e.Xml.textToDom(t.oldXml),this.ids=t.ids,void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},e.Events.Delete.prototype.run=function(t){var n=this.getEventWorkspace_();if(t){t=0;for(var o;o=this.ids[t];t++){var r=n.getBlockById(o);r?r.dispose(!1):o==this.blockId&&console.warn("Can't delete non-existent block: "+o)}}else(t=e.utils.xml.createElement("xml")).appendChild(this.oldXml),e.Xml.domToWorkspace(t,n)},e.Events.Move=function(t){e.Events.Move.superClass_.constructor.call(this,t),t&&(t.isShadow()&&(this.recordUndo=!1),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)},e.utils.object.inherits(e.Events.Move,e.Events.BlockBase),e.Events.BlockMove=e.Events.Move,e.Events.Move.prototype.type=e.Events.MOVE,e.Events.Move.prototype.toJson=function(){var t=e.Events.Move.superClass_.toJson.call(this);return this.newParentId&&(t.newParentId=this.newParentId),this.newInputName&&(t.newInputName=this.newInputName),this.newCoordinate&&(t.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),this.recordUndo||(t.recordUndo=this.recordUndo),t},e.Events.Move.prototype.fromJson=function(t){if(e.Events.Move.superClass_.fromJson.call(this,t),this.newParentId=t.newParentId,this.newInputName=t.newInputName,t.newCoordinate){var n=t.newCoordinate.split(",");this.newCoordinate=new e.utils.Coordinate(Number(n[0]),Number(n[1]))}void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},e.Events.Move.prototype.recordNew=function(){var t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate},e.Events.Move.prototype.currentLocation_=function(){var t=this.getEventWorkspace_().getBlockById(this.blockId),n={},o=t.getParent();return o?(n.parentId=o.id,(t=o.getInputWithBlock(t))&&(n.inputName=t.name)):n.coordinate=t.getRelativeToSurfaceXY(),n},e.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&e.utils.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},e.Events.Move.prototype.run=function(t){var n=this.getEventWorkspace_(),o=n.getBlockById(this.blockId);if(o){var r=t?this.newParentId:this.oldParentId,a=t?this.newInputName:this.oldInputName,h=t?this.newCoordinate:this.oldCoordinate;if(t=null,r&&!(t=n.getBlockById(r)))return void console.warn("Can't connect to non-existent block: "+r);if(o.getParent()&&o.unplug(),h)a=o.getRelativeToSurfaceXY(),o.moveBy(h.x-a.x,h.y-a.y);else{if(n=(o=o.outputConnection||o.previousConnection).type,a){if(t=t.getInput(a))var R=t.connection}else n==e.connectionTypes.PREVIOUS_STATEMENT&&(R=t.nextConnection);R?o.connect(R):console.warn("Can't connect to non-existent input: "+a)}}else console.warn("Can't move non-existent block: "+this.blockId)},e.registry.register(e.registry.Type.EVENT,e.Events.CREATE,e.Events.Create),e.registry.register(e.registry.Type.EVENT,e.Events.DELETE,e.Events.Delete),e.registry.register(e.registry.Type.EVENT,e.Events.CHANGE,e.Events.BlockChange),e.registry.register(e.registry.Type.EVENT,e.Events.MOVE,e.Events.Move),e.Events.FinishedLoading=function(t){this.isBlank=void 0===t,this.workspaceId=t?t.id:"",this.group=e.Events.getGroup(),this.recordUndo=!1},e.utils.object.inherits(e.Events.FinishedLoading,e.Events.Abstract),e.Events.FinishedLoading.prototype.type=e.Events.FINISHED_LOADING,e.Events.FinishedLoading.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),this.workspaceId&&(t.workspaceId=this.workspaceId),t},e.Events.FinishedLoading.prototype.fromJson=function(t){this.isBlank=!1,this.workspaceId=t.workspaceId,this.group=t.group},e.registry.register(e.registry.Type.EVENT,e.Events.FINISHED_LOADING,e.Events.FinishedLoading),e.Events.UiBase=function(t){e.Events.UiBase.superClass_.constructor.call(this),this.isBlank=void 0===t,this.workspaceId=t||"",this.recordUndo=!1},e.utils.object.inherits(e.Events.UiBase,e.Events.Abstract),e.Events.UiBase.prototype.isUiEvent=!0,e.Events.Ui=function(t,n,o,r){e.Events.Ui.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.element=void 0===n?"":n,this.oldValue=void 0===o?"":o,this.newValue=void 0===r?"":r},e.utils.object.inherits(e.Events.Ui,e.Events.UiBase),e.Events.Ui.prototype.type=e.Events.UI,e.Events.Ui.prototype.toJson=function(){var t=e.Events.Ui.superClass_.toJson.call(this);return t.element=this.element,void 0!==this.newValue&&(t.newValue=this.newValue),this.blockId&&(t.blockId=this.blockId),t},e.Events.Ui.prototype.fromJson=function(t){e.Events.Ui.superClass_.fromJson.call(this,t),this.element=t.element,this.newValue=t.newValue,this.blockId=t.blockId},e.registry.register(e.registry.Type.EVENT,e.Events.UI,e.Events.Ui),e.Events.VarBase=function(t){e.Events.VarBase.superClass_.constructor.call(this),this.varId=(this.isBlank=void 0===t)?"":t.getId(),this.workspaceId=this.isBlank?"":t.workspace.id},e.utils.object.inherits(e.Events.VarBase,e.Events.Abstract),e.Events.VarBase.prototype.toJson=function(){var t=e.Events.VarBase.superClass_.toJson.call(this);return t.varId=this.varId,t},e.Events.VarBase.prototype.fromJson=function(t){e.Events.VarBase.superClass_.toJson.call(this),this.varId=t.varId},e.Events.VarCreate=function(t){e.Events.VarCreate.superClass_.constructor.call(this,t),t&&(this.varType=t.type,this.varName=t.name)},e.utils.object.inherits(e.Events.VarCreate,e.Events.VarBase),e.Events.VarCreate.prototype.type=e.Events.VAR_CREATE,e.Events.VarCreate.prototype.toJson=function(){var t=e.Events.VarCreate.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},e.Events.VarCreate.prototype.fromJson=function(t){e.Events.VarCreate.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},e.Events.VarCreate.prototype.run=function(t){var n=this.getEventWorkspace_();t?n.createVariable(this.varName,this.varType,this.varId):n.deleteVariableById(this.varId)},e.Events.VarDelete=function(t){e.Events.VarDelete.superClass_.constructor.call(this,t),t&&(this.varType=t.type,this.varName=t.name)},e.utils.object.inherits(e.Events.VarDelete,e.Events.VarBase),e.Events.VarDelete.prototype.type=e.Events.VAR_DELETE,e.Events.VarDelete.prototype.toJson=function(){var t=e.Events.VarDelete.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},e.Events.VarDelete.prototype.fromJson=function(t){e.Events.VarDelete.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},e.Events.VarDelete.prototype.run=function(t){var n=this.getEventWorkspace_();t?n.deleteVariableById(this.varId):n.createVariable(this.varName,this.varType,this.varId)},e.Events.VarRename=function(t,n){e.Events.VarRename.superClass_.constructor.call(this,t),t&&(this.oldName=t.name,this.newName=void 0===n?"":n)},e.utils.object.inherits(e.Events.VarRename,e.Events.VarBase),e.Events.VarRename.prototype.type=e.Events.VAR_RENAME,e.Events.VarRename.prototype.toJson=function(){var t=e.Events.VarRename.superClass_.toJson.call(this);return t.oldName=this.oldName,t.newName=this.newName,t},e.Events.VarRename.prototype.fromJson=function(t){e.Events.VarRename.superClass_.fromJson.call(this,t),this.oldName=t.oldName,this.newName=t.newName},e.Events.VarRename.prototype.run=function(t){this.getEventWorkspace_().renameVariableById(this.varId,t?this.newName:this.oldName)},e.registry.register(e.registry.Type.EVENT,e.Events.VAR_CREATE,e.Events.VarCreate),e.registry.register(e.registry.Type.EVENT,e.Events.VAR_DELETE,e.Events.VarDelete),e.registry.register(e.registry.Type.EVENT,e.Events.VAR_RENAME,e.Events.VarRename),e.BlockDragSurfaceSvg=function(t){this.container_=t,this.createDom()},e.BlockDragSurfaceSvg.prototype.SVG_=null,e.BlockDragSurfaceSvg.prototype.dragGroup_=null,e.BlockDragSurfaceSvg.prototype.container_=null,e.BlockDragSurfaceSvg.prototype.scale_=1,e.BlockDragSurfaceSvg.prototype.surfaceXY_=null,e.BlockDragSurfaceSvg.prototype.childSurfaceXY_=new e.utils.Coordinate(0,0),e.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},this.SVG_))},e.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(t){if(this.dragGroup_.childNodes.length)throw Error("Already dragging a block.");this.dragGroup_.appendChild(t),this.SVG_.style.display="block",this.surfaceXY_=new e.utils.Coordinate(0,0)},e.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(t,n,o){this.scale_=o,t=t.toFixed(0),n=n.toFixed(0),this.childSurfaceXY_.x=parseInt(t,10),this.childSurfaceXY_.y=parseInt(n,10),this.dragGroup_.setAttribute("transform","translate("+t+","+n+") scale("+o+")")},e.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var t=this.surfaceXY_.x,n=this.surfaceXY_.y;t=t.toFixed(0),n=n.toFixed(0),this.SVG_.style.display="block",e.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+n+"px, 0px)")},e.BlockDragSurfaceSvg.prototype.translateBy=function(t,n){this.surfaceXY_=new e.utils.Coordinate(this.surfaceXY_.x+t,this.surfaceXY_.y+n),this.translateSurfaceInternal_()},e.BlockDragSurfaceSvg.prototype.translateSurface=function(t,n){this.surfaceXY_=new e.utils.Coordinate(t*this.scale_,n*this.scale_),this.translateSurfaceInternal_()},e.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var t=e.utils.getRelativeXY(this.SVG_);return new e.utils.Coordinate(t.x/this.scale_,t.y/this.scale_)},e.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},e.BlockDragSurfaceSvg.prototype.getSvgRoot=function(){return this.SVG_},e.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},e.BlockDragSurfaceSvg.prototype.getWsTranslation=function(){return this.childSurfaceXY_.clone()},e.BlockDragSurfaceSvg.prototype.clearAndHide=function(t){if(t?t.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",this.dragGroup_.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY_=null},e.Css={},e.Css.injected_=!1,e.Css.register=function(t){if(e.Css.injected_)throw Error("CSS already injected");Array.prototype.push.apply(e.Css.CONTENT,t),t.length=0},e.Css.inject=function(t,n){if(!e.Css.injected_){e.Css.injected_=!0;var o=e.Css.CONTENT.join("\n");e.Css.CONTENT.length=0,t&&(t=n.replace(/[\\/]$/,""),o=o.replace(/<<<PATH>>>/g,t),(t=document.createElement("style")).id="blockly-common-style",o=document.createTextNode(o),t.appendChild(o),document.head.insertBefore(t,document.head.firstChild))}},e.Css.CONTENT=[".blocklySvg {","background-color: #fff;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none;","}",".blocklyNonSelectable {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyBlockCanvas.blocklyCanvasTransitioning,",".blocklyBubbleCanvas.blocklyCanvasTransitioning {","transition: transform .5s;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;","font: 9pt sans-serif;","opacity: .9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: absolute;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-color: #dadce0;","background-color: #fff;","border-radius: 2px;","padding: 4px;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","overflow-x: hidden;","position: relative;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyArrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".blocklyArrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #515A5A;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPathLight {","fill: none;","stroke-linecap: round;","stroke-width: 1;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: .8;","stroke-opacity: .8;","}",".blocklyDragging>.blocklyPathDark {","display: none;","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyDisabled>.blocklyPathLight,",".blocklyDisabled>.blocklyPathDark {","display: none;","}",".blocklyInsertionMarker>.blocklyPath,",".blocklyInsertionMarker>.blocklyPathLight,",".blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: .2;","stroke: none;","}",".blocklyMultilineText {","font-family: monospace;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyText text {","cursor: default;","}",".blocklySvg text,",".blocklyBlockDragSurface text {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyHtmlInput {","border: none;","border-radius: 4px;","height: 100%;","margin: 0;","outline: none;","padding: 0;","width: 100%;","text-align: center;","display: block;","box-sizing: border-box;","}",".blocklyHtmlInput::-ms-clear {","display: none;","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: #ddd;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal,",".blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: #ccc;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyVerticalMarker {","stroke-width: 3px;","fill: rgba(255,255,255,.5);","pointer-events: none;","}",".blocklyComputeCanvas {","position: absolute;","width: 0;","height: 0;","}",".blocklyNoPointerEvents {","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","border-radius: 2px;","padding: 0 !important;","}",".blocklyDropdownMenu .blocklyMenuItem {","padding-left: 28px;","}",".blocklyDropdownMenu .blocklyMenuItemRtl {","padding-left: 5px;","padding-right: 28px;","}",".blocklyWidgetDiv .blocklyMenu {","background: #fff;","border: 1px solid transparent;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","font: normal 13px Arial, sans-serif;","margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","max-height: 100%;","z-index: 20000;","}",".blocklyWidgetDiv .blocklyMenu.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv .blocklyMenu {","background: inherit;","border: inherit;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","position: relative;","z-index: 20000;","}",".blocklyMenuItem {","border: none;","color: #000;","cursor: pointer;","list-style: none;","margin: 0;","min-width: 7em;","padding: 6px 15px;","white-space: nowrap;","}",".blocklyMenuItemDisabled {","color: #ccc;","cursor: inherit;","}",".blocklyMenuItemHighlight {","background-color: rgba(0,0,0,.1);","}",".blocklyMenuItemCheckbox {","height: 16px;","position: absolute;","width: 16px;","}",".blocklyMenuItemSelected .blocklyMenuItemCheckbox {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;","float: left;","margin-left: -24px;","position: static;","}",".blocklyMenuItemRtl .blocklyMenuItemCheckbox {","float: right;","margin-right: -24px;","}"],e.Grid=function(t,n){this.gridPattern_=t,this.spacing_=n.spacing,this.length_=n.length,this.line2_=(this.line1_=t.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=n.snap},e.Grid.prototype.scale_=1,e.Grid.prototype.dispose=function(){this.gridPattern_=null},e.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},e.Grid.prototype.getSpacing=function(){return this.spacing_},e.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},e.Grid.prototype.update=function(t){this.scale_=t;var n=this.spacing_*t||100;this.gridPattern_.setAttribute("width",n),this.gridPattern_.setAttribute("height",n);var o=(n=Math.floor(this.spacing_/2)+.5)-this.length_/2,r=n+this.length_/2;this.setLineAttributes_(this.line1_,t,o*=t,r*=t,n*=t,n),this.setLineAttributes_(this.line2_,t,n,n,o,r)},e.Grid.prototype.setLineAttributes_=function(t,n,o,r,a,h){t&&(t.setAttribute("stroke-width",n),t.setAttribute("x1",o),t.setAttribute("y1",a),t.setAttribute("x2",r),t.setAttribute("y2",h))},e.Grid.prototype.moveTo=function(t,n){this.gridPattern_.setAttribute("x",t),this.gridPattern_.setAttribute("y",n),(e.utils.userAgent.IE||e.utils.userAgent.EDGE)&&this.update(this.scale_)},e.Grid.createDom=function(t,n,o){return t=e.utils.dom.createSvgElement(e.utils.Svg.PATTERN,{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},o),0<n.length&&0<n.spacing?(e.utils.dom.createSvgElement(e.utils.Svg.LINE,{stroke:n.colour},t),1<n.length&&e.utils.dom.createSvgElement(e.utils.Svg.LINE,{stroke:n.colour},t)):e.utils.dom.createSvgElement(e.utils.Svg.LINE,{},t),t},e.Theme=function(t,n,o,r){this.name=t,this.blockStyles=n||Object.create(null),this.categoryStyles=o||Object.create(null),this.componentStyles=r||Object.create(null),this.fontStyle=Object.create(null),this.startHats=null,e.registry.register(e.registry.Type.THEME,t,this)},e.Theme.prototype.getClassName=function(){return this.name+"-theme"},e.Theme.prototype.setBlockStyle=function(t,n){this.blockStyles[t]=n},e.Theme.prototype.setCategoryStyle=function(t,n){this.categoryStyles[t]=n},e.Theme.prototype.getComponentStyle=function(t){return(t=this.componentStyles[t])&&"string"==typeof t&&this.getComponentStyle(t)?this.getComponentStyle(t):t?String(t):null},e.Theme.prototype.setComponentStyle=function(t,n){this.componentStyles[t]=n},e.Theme.prototype.setFontStyle=function(t){this.fontStyle=t},e.Theme.prototype.setStartHats=function(t){this.startHats=t},e.Theme.defineTheme=function(t,n){var o=new e.Theme(t),r=n.base;return r&&("string"==typeof r&&(r=e.registry.getObject(e.registry.Type.THEME,r)),r instanceof e.Theme&&(e.utils.object.deepMerge(o,r),o.name=t)),e.utils.object.deepMerge(o.blockStyles,n.blockStyles),e.utils.object.deepMerge(o.categoryStyles,n.categoryStyles),e.utils.object.deepMerge(o.componentStyles,n.componentStyles),e.utils.object.deepMerge(o.fontStyle,n.fontStyle),null!=n.startHats&&(o.startHats=n.startHats),o},e.Themes={},e.Themes.Classic={},e.Themes.Classic.defaultBlockStyles={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},e.Themes.Classic.categoryStyles={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},e.Themes.Classic=new e.Theme("classic",e.Themes.Classic.defaultBlockStyles,e.Themes.Classic.categoryStyles),e.utils.IdGenerator={},e.utils.IdGenerator.nextId_=0,e.utils.IdGenerator.getNextUniqueId=function(){return"blockly-"+(e.utils.IdGenerator.nextId_++).toString(36)},e.utils.Metrics=function(){},e.utils.toolbox={},e.utils.toolbox.CATEGORY_TOOLBOX_KIND="categoryToolbox",e.utils.toolbox.FLYOUT_TOOLBOX_KIND="flyoutToolbox",e.utils.toolbox.Position={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3},e.utils.toolbox.convertToolboxDefToJson=function(t){return t?((t instanceof Element||"string"==typeof t)&&(t=e.utils.toolbox.parseToolboxTree(t),t=e.utils.toolbox.convertToToolboxJson_(t)),e.utils.toolbox.validateToolbox_(t),t):null},e.utils.toolbox.validateToolbox_=function(t){var n=t.kind;if(t=t.contents,n&&n!=e.utils.toolbox.FLYOUT_TOOLBOX_KIND&&n!=e.utils.toolbox.CATEGORY_TOOLBOX_KIND)throw Error("Invalid toolbox kind "+n+". Please supply either "+e.utils.toolbox.FLYOUT_TOOLBOX_KIND+" or "+e.utils.toolbox.CATEGORY_TOOLBOX_KIND);if(!t)throw Error("Toolbox must have a contents attribute.")},e.utils.toolbox.convertFlyoutDefToJsonArray=function(t){return t?t.contents?t.contents:Array.isArray(t)&&0<t.length&&!t[0].nodeType?t:e.utils.toolbox.xmlToJsonArray_(t):[]},e.utils.toolbox.hasCategories=function(t){if(!t)return!1;var n=t.kind;return n?n==e.utils.toolbox.CATEGORY_TOOLBOX_KIND:!!t.contents.filter(function(o){return"CATEGORY"==o.kind.toUpperCase()}).length},e.utils.toolbox.isCategoryCollapsible=function(t){return!(!t||!t.contents||!t.contents.filter(function(n){return"CATEGORY"==n.kind.toUpperCase()}).length)},e.utils.toolbox.convertToToolboxJson_=function(t){var n={contents:e.utils.toolbox.xmlToJsonArray_(t)};return t instanceof Node&&e.utils.toolbox.addAttributes_(t,n),n},e.utils.toolbox.xmlToJsonArray_=function(t){var r,n=[],o=t.childNodes;for(o||(o=t),t=0;r=o[t];t++)if(r.tagName){var a={},h=r.tagName.toUpperCase();a.kind=h,"BLOCK"==h?a.blockxml=r:r.childNodes&&0<r.childNodes.length&&(a.contents=e.utils.toolbox.xmlToJsonArray_(r)),e.utils.toolbox.addAttributes_(r,a),n.push(a)}return n},e.utils.toolbox.addAttributes_=function(t,n){for(var o=0;o<t.attributes.length;o++){var r=t.attributes[o];-1<r.nodeName.indexOf("css-")?(n.cssconfig=n.cssconfig||{},n.cssconfig[r.nodeName.replace("css-","")]=r.value):n[r.nodeName]=r.value}},e.utils.toolbox.parseToolboxTree=function(t){if(t){if("string"!=typeof t&&(e.utils.userAgent.IE&&t.outerHTML?t=t.outerHTML:t instanceof Element||(t=null)),"string"==typeof t&&"xml"!=(t=e.Xml.textToDom(t)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else t=null;return t},e.Options=function(t){var n=!!t.readOnly;if(n)var o=null,r=!1,a=!1,h=!1,R=!1,L=!1,W=!1;else{o=e.utils.toolbox.convertToolboxDefToJson(t.toolbox),r=e.utils.toolbox.hasCategories(o),void 0===(a=t.trashcan)&&(a=r);var nt=t.maxTrashcanContents;a?void 0===nt&&(nt=32):nt=0,void 0===(h=t.collapse)&&(h=r),void 0===(R=t.comments)&&(R=r),void 0===(L=t.disable)&&(L=r),void 0===(W=t.sounds)&&(W=!0)}var et=!!t.rtl,Et=t.horizontalLayout;void 0===Et&&(Et=!1);var It=t.toolboxPosition;It="end"!==It,It=Et?It?e.utils.toolbox.Position.TOP:e.utils.toolbox.Position.BOTTOM:It==et?e.utils.toolbox.Position.RIGHT:e.utils.toolbox.Position.LEFT;var gt=t.css;void 0===gt&&(gt=!0);var wt="https://blockly-demo.appspot.com/static/media/";t.media?wt=t.media:t.path&&(wt=t.path+"media/");var Ut=void 0===t.oneBasedIndex||!!t.oneBasedIndex,Jt=t.renderer||"geras",Ct=t.plugins||{};this.RTL=et,this.oneBasedIndex=Ut,this.collapse=h,this.comments=R,this.disable=L,this.readOnly=n,this.maxBlocks=t.maxBlocks||1/0,this.maxInstances=t.maxInstances,this.pathToMedia=wt,this.hasCategories=r,this.moveOptions=e.Options.parseMoveOptions_(t,r),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=a,this.maxTrashcanContents=nt,this.hasSounds=W,this.hasCss=gt,this.horizontalLayout=Et,this.languageTree=o,this.gridOptions=e.Options.parseGridOptions_(t),this.zoomOptions=e.Options.parseZoomOptions_(t),this.toolboxPosition=It,this.theme=e.Options.parseThemeOptions_(t),this.renderer=Jt,this.rendererOverrides=t.rendererOverrides,this.gridPattern=null,this.parentWorkspace=t.parentWorkspace,this.plugins=Ct},e.BlocklyOptions=function(){},e.Options.parseMoveOptions_=function(t,n){var o=t.move||{},r={};return void 0===o.scrollbars&&void 0===t.scrollbars?r.scrollbars=n:"object"==typeof o.scrollbars?(r.scrollbars={},r.scrollbars.horizontal=!!o.scrollbars.horizontal,r.scrollbars.vertical=!!o.scrollbars.vertical,r.scrollbars.horizontal&&r.scrollbars.vertical?r.scrollbars=!0:r.scrollbars.horizontal||r.scrollbars.vertical||(r.scrollbars=!1)):r.scrollbars=!!o.scrollbars||!!t.scrollbars,r.wheel=r.scrollbars&&void 0!==o.wheel?!!o.wheel:"object"==typeof r.scrollbars,r.drag=!(!r.scrollbars||void 0!==o.drag&&!o.drag),r},e.Options.parseZoomOptions_=function(t){var n={};return n.controls=void 0!==(t=t.zoom||{}).controls&&!!t.controls,n.wheel=void 0!==t.wheel&&!!t.wheel,n.startScale=void 0===t.startScale?1:Number(t.startScale),n.maxScale=void 0===t.maxScale?3:Number(t.maxScale),n.minScale=void 0===t.minScale?.3:Number(t.minScale),n.scaleSpeed=void 0===t.scaleSpeed?1.2:Number(t.scaleSpeed),n.pinch=void 0===t.pinch?n.wheel||n.controls:!!t.pinch,n},e.Options.parseGridOptions_=function(t){t=t.grid||{};var n={};return n.spacing=Number(t.spacing)||0,n.colour=t.colour||"#888",n.length=void 0===t.length?1:Number(t.length),n.snap=0<n.spacing&&!!t.snap,n},e.Options.parseThemeOptions_=function(t){return"string"==typeof(t=t.theme||e.Themes.Classic)?e.registry.getObject(e.registry.Type.THEME,t):t instanceof e.Theme?t:e.Theme.defineTheme(t.name||"builtin"+e.utils.IdGenerator.getNextUniqueId(),t)},e.Options.parseToolboxTree=function(t){return e.utils.deprecation.warn("Blockly.Options.parseToolboxTree","September 2020","September 2021","Blockly.utils.toolbox.parseToolboxTree"),e.utils.toolbox.parseToolboxTree(t)},e.ScrollbarPair=function(t,n,o,r,a){this.workspace_=t,o=void 0===o||o;var h=(n=void 0===n||n)&&o;n&&(this.hScroll=new e.Scrollbar(t,!0,h,r,a)),o&&(this.vScroll=new e.Scrollbar(t,!1,h,r,a)),h&&(this.corner_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{height:e.Scrollbar.scrollbarThickness,width:e.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),e.utils.dom.insertAfter(this.corner_,t.getBubbleCanvas())),this.oldHostMetrics_=null},e.ScrollbarPair.prototype.dispose=function(){e.utils.dom.removeNode(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)},e.ScrollbarPair.prototype.resize=function(){var t=this.workspace_.getMetrics();if(t){var n=!1,o=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth==t.scrollWidth&&this.oldHostMetrics_.viewLeft==t.viewLeft&&this.oldHostMetrics_.scrollLeft==t.scrollLeft||(n=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight==t.scrollHeight&&this.oldHostMetrics_.viewTop==t.viewTop&&this.oldHostMetrics_.scrollTop==t.scrollTop||(o=!0)):o=n=!0,n||o){try{e.Events.disable(),this.hScroll&&n&&this.hScroll.resize(t),this.vScroll&&o&&this.vScroll.resize(t)}finally{e.Events.enable()}this.workspace_.maybeFireViewportChangeEvent()}this.hScroll&&this.vScroll&&(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position.y)),this.oldHostMetrics_=t}},e.ScrollbarPair.prototype.canScrollHorizontally=function(){return!!this.hScroll},e.ScrollbarPair.prototype.canScrollVertically=function(){return!!this.vScroll},e.ScrollbarPair.prototype.setOrigin=function(t,n){this.hScroll&&this.hScroll.setOrigin(t,n),this.vScroll&&this.vScroll.setOrigin(t,n)},e.ScrollbarPair.prototype.set=function(t,n,o){this.hScroll&&this.hScroll.set(t,!1),this.vScroll&&this.vScroll.set(n,!1),(o||void 0===o)&&(t={},this.hScroll&&(t.x=this.hScroll.getRatio_()),this.vScroll&&(t.y=this.vScroll.getRatio_()),this.workspace_.setMetrics(t))},e.ScrollbarPair.prototype.setX=function(t){this.hScroll&&this.hScroll.set(t,!0)},e.ScrollbarPair.prototype.setY=function(t){this.vScroll&&this.vScroll.set(t,!0)},e.ScrollbarPair.prototype.setContainerVisible=function(t){this.hScroll&&this.hScroll.setContainerVisible(t),this.vScroll&&this.vScroll.setContainerVisible(t)},e.ScrollbarPair.prototype.isVisible=function(){var t=!1;return this.hScroll&&(t=this.hScroll.isVisible()),this.vScroll&&(t=t||this.vScroll.isVisible()),t},e.ScrollbarPair.prototype.resizeContent=function(t){this.hScroll&&this.hScroll.resizeContentHorizontal(t),this.vScroll&&this.vScroll.resizeContentVertical(t)},e.ScrollbarPair.prototype.resizeView=function(t){this.hScroll&&this.hScroll.resizeViewHorizontal(t),this.vScroll&&this.vScroll.resizeViewVertical(t)},e.Scrollbar=function(t,n,o,r,a){this.workspace_=t,this.pair_=o||!1,this.horizontal_=n,this.margin_=void 0!==a?a:e.Scrollbar.DEFAULT_SCROLLBAR_MARGIN,this.ratio=this.oldHostMetrics_=null,this.createDom_(r),this.position=new e.utils.Coordinate(0,0),t=e.Scrollbar.scrollbarThickness,n?(this.svgBackground_.setAttribute("height",t),this.outerSvg_.setAttribute("height",t),this.svgHandle_.setAttribute("height",t-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",t),this.outerSvg_.setAttribute("width",t),this.svgHandle_.setAttribute("width",t-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=e.browserEvents.conditionalBind(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=e.browserEvents.conditionalBind(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)},e.Scrollbar.prototype.origin_=new e.utils.Coordinate(0,0),e.Scrollbar.prototype.startDragMouse_=0,e.Scrollbar.prototype.scrollbarLength_=0,e.Scrollbar.prototype.handleLength_=0,e.Scrollbar.prototype.handlePosition_=0,e.Scrollbar.prototype.isVisible_=!0,e.Scrollbar.prototype.containerVisible_=!0,e.Scrollbar.scrollbarThickness=15,e.Touch.TOUCH_ENABLED&&(e.Scrollbar.scrollbarThickness=25),e.Scrollbar.DEFAULT_SCROLLBAR_MARGIN=.5,e.Scrollbar.metricsAreEquivalent_=function(t,n){return t.viewWidth==n.viewWidth&&t.viewHeight==n.viewHeight&&t.viewLeft==n.viewLeft&&t.viewTop==n.viewTop&&t.absoluteTop==n.absoluteTop&&t.absoluteLeft==n.absoluteLeft&&t.scrollWidth==n.scrollWidth&&t.scrollHeight==n.scrollHeight&&t.scrollLeft==n.scrollLeft&&t.scrollTop==n.scrollTop},e.Scrollbar.prototype.dispose=function(){this.cleanUp_(),e.browserEvents.unbind(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,e.browserEvents.unbind(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,e.utils.dom.removeNode(this.outerSvg_),this.svgBackground_=this.svgGroup_=this.outerSvg_=null,this.svgHandle_&&(this.workspace_.getThemeManager().unsubscribe(this.svgHandle_),this.svgHandle_=null),this.workspace_=null},e.Scrollbar.prototype.constrainHandleLength_=function(t){return 0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength_)},e.Scrollbar.prototype.setHandleLength_=function(t){this.handleLength_=t,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},e.Scrollbar.prototype.constrainHandlePosition_=function(t){return 0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength_-this.handleLength_)},e.Scrollbar.prototype.setHandlePosition=function(t){this.handlePosition_=t,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},e.Scrollbar.prototype.setScrollbarLength_=function(t){this.scrollbarLength_=t,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollbarLength_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollbarLength_)},e.Scrollbar.prototype.setPosition=function(t,n){this.position.x=t,this.position.y=n,e.utils.dom.setCssTransform(this.outerSvg_,"translate("+(this.position.x+this.origin_.x)+"px,"+(this.position.y+this.origin_.y)+"px)")},e.Scrollbar.prototype.resize=function(t){!t&&!(t=this.workspace_.getMetrics())||this.oldHostMetrics_&&e.Scrollbar.metricsAreEquivalent_(t,this.oldHostMetrics_)||(this.horizontal_?this.resizeHorizontal_(t):this.resizeVertical_(t),this.oldHostMetrics_=t,this.updateMetrics_())},e.Scrollbar.prototype.requiresViewResize_=function(t){return!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==t.viewWidth||this.oldHostMetrics_.viewHeight!==t.viewHeight||this.oldHostMetrics_.absoluteLeft!==t.absoluteLeft||this.oldHostMetrics_.absoluteTop!==t.absoluteTop},e.Scrollbar.prototype.resizeHorizontal_=function(t){this.requiresViewResize_(t)?this.resizeViewHorizontal(t):this.resizeContentHorizontal(t)},e.Scrollbar.prototype.resizeViewHorizontal=function(t){var n=t.viewWidth-2*this.margin_;this.pair_&&(n-=e.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,n)),n=t.absoluteLeft+this.margin_,this.pair_&&this.workspace_.RTL&&(n+=e.Scrollbar.scrollbarThickness),this.setPosition(n,t.absoluteTop+t.viewHeight-e.Scrollbar.scrollbarThickness-this.margin_),this.resizeContentHorizontal(t)},e.Scrollbar.prototype.resizeContentHorizontal=function(t){if(t.viewWidth>=t.scrollWidth)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var n=this.scrollbarLength_*t.viewWidth/t.scrollWidth;n=this.constrainHandleLength_(n),this.setHandleLength_(n);var o=this.scrollbarLength_-this.handleLength_;t=this.constrainHandlePosition_(t=(t.viewLeft-t.scrollLeft)/(n=t.scrollWidth-t.viewWidth)*o),this.setHandlePosition(t),this.ratio=o/n}},e.Scrollbar.prototype.resizeVertical_=function(t){this.requiresViewResize_(t)?this.resizeViewVertical(t):this.resizeContentVertical(t)},e.Scrollbar.prototype.resizeViewVertical=function(t){var n=t.viewHeight-2*this.margin_;this.pair_&&(n-=e.Scrollbar.scrollbarThickness),this.setScrollbarLength_(Math.max(0,n)),this.setPosition(this.workspace_.RTL?t.absoluteLeft+this.margin_:t.absoluteLeft+t.viewWidth-e.Scrollbar.scrollbarThickness-this.margin_,t.absoluteTop+this.margin_),this.resizeContentVertical(t)},e.Scrollbar.prototype.resizeContentVertical=function(t){if(t.viewHeight>=t.scrollHeight)this.setHandleLength_(this.scrollbarLength_),this.setHandlePosition(0),this.pair_||this.setVisible(!1);else{this.pair_||this.setVisible(!0);var n=this.scrollbarLength_*t.viewHeight/t.scrollHeight;n=this.constrainHandleLength_(n),this.setHandleLength_(n);var o=this.scrollbarLength_-this.handleLength_;t=this.constrainHandlePosition_(t=(t.viewTop-t.scrollTop)/(n=t.scrollHeight-t.viewHeight)*o),this.setHandlePosition(t),this.ratio=o/n}},e.Scrollbar.prototype.createDom_=function(t){var n="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");t&&(n+=" "+t),this.outerSvg_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{class:n},null),this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},this.outerSvg_),this.svgBackground_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyScrollbarBackground"},this.svgGroup_),t=Math.floor((e.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyScrollbarHandle",rx:t,ry:t},this.svgGroup_),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarOpacity","fill-opacity"),e.utils.dom.insertAfter(this.outerSvg_,this.workspace_.getParentSvg())},e.Scrollbar.prototype.isVisible=function(){return this.isVisible_},e.Scrollbar.prototype.setContainerVisible=function(t){var n=t!=this.containerVisible_;this.containerVisible_=t,n&&this.updateDisplay_()},e.Scrollbar.prototype.setVisible=function(t){var n=t!=this.isVisible();if(this.pair_)throw Error("Unable to toggle visibility of paired scrollbars.");this.isVisible_=t,n&&this.updateDisplay_()},e.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},e.Scrollbar.prototype.onMouseDownBar_=function(t){if(this.workspace_.markFocused(),e.Touch.clearTouchIdentifier(),this.cleanUp_(),e.utils.isRightButton(t))t.stopPropagation();else{var n=e.utils.mouseToSvg(t,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());n=this.horizontal_?n.x:n.y;var o=e.utils.getInjectionDivXY_(this.svgHandle_),r=this.handlePosition_,a=.95*this.handleLength_;n<=(o=this.horizontal_?o.x:o.y)?r-=a:n>=o+this.handleLength_&&(r+=a),this.setHandlePosition(this.constrainHandlePosition_(r)),this.updateMetrics_(),t.stopPropagation(),t.preventDefault()}},e.Scrollbar.prototype.onMouseDownHandle_=function(t){this.workspace_.markFocused(),this.cleanUp_(),e.utils.isRightButton(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse_=this.horizontal_?t.clientX:t.clientY,e.Scrollbar.onMouseUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",this,this.onMouseUpHandle_),e.Scrollbar.onMouseMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",this,this.onMouseMoveHandle_),t.stopPropagation(),t.preventDefault())},e.Scrollbar.prototype.onMouseMoveHandle_=function(t){this.setHandlePosition(this.constrainHandlePosition_(this.startDragHandle+((this.horizontal_?t.clientX:t.clientY)-this.startDragMouse_))),this.updateMetrics_()},e.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),e.Touch.clearTouchIdentifier(),this.cleanUp_()},e.Scrollbar.prototype.cleanUp_=function(){e.hideChaff(!0),e.Scrollbar.onMouseUpWrapper_&&(e.browserEvents.unbind(e.Scrollbar.onMouseUpWrapper_),e.Scrollbar.onMouseUpWrapper_=null),e.Scrollbar.onMouseMoveWrapper_&&(e.browserEvents.unbind(e.Scrollbar.onMouseMoveWrapper_),e.Scrollbar.onMouseMoveWrapper_=null)},e.Scrollbar.prototype.getRatio_=function(){var t=this.handlePosition_/(this.scrollbarLength_-this.handleLength_);return isNaN(t)&&(t=0),t},e.Scrollbar.prototype.updateMetrics_=function(){var t=this.getRatio_(),n={};this.horizontal_?n.x=t:n.y=t,this.workspace_.setMetrics(n)},e.Scrollbar.prototype.set=function(t,n){this.setHandlePosition(this.constrainHandlePosition_(t*this.ratio)),(n||void 0===n)&&this.updateMetrics_()},e.Scrollbar.prototype.setOrigin=function(t,n){this.origin_=new e.utils.Coordinate(t,n)},e.Tooltip={},e.Tooltip.visible=!1,e.Tooltip.blocked_=!1,e.Tooltip.LIMIT=50,e.Tooltip.mouseOutPid_=0,e.Tooltip.showPid_=0,e.Tooltip.lastX_=0,e.Tooltip.lastY_=0,e.Tooltip.element_=null,e.Tooltip.poisonedElement_=null,e.Tooltip.OFFSET_X=0,e.Tooltip.OFFSET_Y=10,e.Tooltip.RADIUS_OK=10,e.Tooltip.HOVER_MS=750,e.Tooltip.MARGINS=5,e.Tooltip.DIV=null,e.Tooltip.getTooltipOfObject=function(t){if(t=e.Tooltip.getTargetObject_(t)){for(t=t.tooltip;"function"==typeof t;)t=t();if("string"!=typeof t)throw Error("Tooltip function must return a string.");return t}return""},e.Tooltip.getTargetObject_=function(t){for(;t&&t.tooltip;){if("string"==typeof t.tooltip||"function"==typeof t.tooltip)return t;t=t.tooltip}return null},e.Tooltip.createDom=function(){e.Tooltip.DIV||(e.Tooltip.DIV=document.createElement("div"),e.Tooltip.DIV.className="blocklyTooltipDiv",(e.parentContainer||document.body).appendChild(e.Tooltip.DIV))},e.Tooltip.bindMouseEvents=function(t){t.mouseOverWrapper_=e.browserEvents.bind(t,"mouseover",null,e.Tooltip.onMouseOver_),t.mouseOutWrapper_=e.browserEvents.bind(t,"mouseout",null,e.Tooltip.onMouseOut_),t.addEventListener("mousemove",e.Tooltip.onMouseMove_,!1)},e.Tooltip.unbindMouseEvents=function(t){t&&(e.browserEvents.unbind(t.mouseOverWrapper_),e.browserEvents.unbind(t.mouseOutWrapper_),t.removeEventListener("mousemove",e.Tooltip.onMouseMove_))},e.Tooltip.onMouseOver_=function(t){e.Tooltip.blocked_||(t=e.Tooltip.getTargetObject_(t.currentTarget),e.Tooltip.element_!=t&&(e.Tooltip.hide(),e.Tooltip.poisonedElement_=null,e.Tooltip.element_=t),clearTimeout(e.Tooltip.mouseOutPid_))},e.Tooltip.onMouseOut_=function(t){e.Tooltip.blocked_||(e.Tooltip.mouseOutPid_=setTimeout(function(){e.Tooltip.element_=null,e.Tooltip.poisonedElement_=null,e.Tooltip.hide()},1),clearTimeout(e.Tooltip.showPid_))},e.Tooltip.onMouseMove_=function(t){if(e.Tooltip.element_&&e.Tooltip.element_.tooltip&&!e.Tooltip.blocked_)if(e.Tooltip.visible){var n=e.Tooltip.lastX_-t.pageX;t=e.Tooltip.lastY_-t.pageY,Math.sqrt(n*n+t*t)>e.Tooltip.RADIUS_OK&&e.Tooltip.hide()}else e.Tooltip.poisonedElement_!=e.Tooltip.element_&&(clearTimeout(e.Tooltip.showPid_),e.Tooltip.lastX_=t.pageX,e.Tooltip.lastY_=t.pageY,e.Tooltip.showPid_=setTimeout(e.Tooltip.show_,e.Tooltip.HOVER_MS))},e.Tooltip.dispose=function(){e.Tooltip.element_=null,e.Tooltip.poisonedElement_=null,e.Tooltip.hide()},e.Tooltip.hide=function(){e.Tooltip.visible&&(e.Tooltip.visible=!1,e.Tooltip.DIV&&(e.Tooltip.DIV.style.display="none")),e.Tooltip.showPid_&&clearTimeout(e.Tooltip.showPid_)},e.Tooltip.block=function(){e.Tooltip.hide(),e.Tooltip.blocked_=!0},e.Tooltip.unblock=function(){e.Tooltip.blocked_=!1},e.Tooltip.show_=function(){if(!e.Tooltip.blocked_&&(e.Tooltip.poisonedElement_=e.Tooltip.element_,e.Tooltip.DIV)){e.Tooltip.DIV.textContent="";var t=e.Tooltip.getTooltipOfObject(e.Tooltip.element_);t=(t=e.utils.string.wrap(t,e.Tooltip.LIMIT)).split("\n");for(var n=0;n<t.length;n++){var o=document.createElement("div");o.appendChild(document.createTextNode(t[n])),e.Tooltip.DIV.appendChild(o)}t=e.Tooltip.element_.RTL,n=document.documentElement.clientWidth,o=document.documentElement.clientHeight,e.Tooltip.DIV.style.direction=t?"rtl":"ltr",e.Tooltip.DIV.style.display="block",e.Tooltip.visible=!0;var r=e.Tooltip.lastX_;r=t?r-(e.Tooltip.OFFSET_X+e.Tooltip.DIV.offsetWidth):r+e.Tooltip.OFFSET_X;var a=e.Tooltip.lastY_+e.Tooltip.OFFSET_Y;a+e.Tooltip.DIV.offsetHeight>o+window.scrollY&&(a-=e.Tooltip.DIV.offsetHeight+2*e.Tooltip.OFFSET_Y),t?r=Math.max(e.Tooltip.MARGINS-window.scrollX,r):r+e.Tooltip.DIV.offsetWidth>n+window.scrollX-2*e.Tooltip.MARGINS&&(r=n-e.Tooltip.DIV.offsetWidth-2*e.Tooltip.MARGINS),e.Tooltip.DIV.style.top=a+"px",e.Tooltip.DIV.style.left=r+"px"}},e.utils.aria={},e.utils.aria.ARIA_PREFIX_="aria-",e.utils.aria.ROLE_ATTRIBUTE_="role",e.utils.aria.Role={GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",LISTBOX:"listbox",MENU:"menu",MENUITEM:"menuitem",MENUITEMCHECKBOX:"menuitemcheckbox",OPTION:"option",PRESENTATION:"presentation",ROW:"row",TREE:"tree",TREEITEM:"treeitem"},e.utils.aria.State={ACTIVEDESCENDANT:"activedescendant",COLCOUNT:"colcount",DISABLED:"disabled",EXPANDED:"expanded",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",ORIENTATION:"orientation",POSINSET:"posinset",ROWCOUNT:"rowcount",SELECTED:"selected",SETSIZE:"setsize",VALUEMAX:"valuemax",VALUEMIN:"valuemin"},e.utils.aria.setRole=function(t,n){t.setAttribute(e.utils.aria.ROLE_ATTRIBUTE_,n)},e.utils.aria.setState=function(t,n,o){Array.isArray(o)&&(o=o.join(" ")),t.setAttribute(e.utils.aria.ARIA_PREFIX_+n,o)},e.IASTNodeLocation=function(){},e.IASTNodeLocationSvg=function(){},e.IASTNodeLocationWithBlock=function(){},e.IKeyboardAccessible=function(){},e.utils.deprecation={},e.utils.deprecation.warn=function(t,n,o,r){t=t+" was deprecated on "+n+" and will be deleted on "+o+".",r&&(t+="\nUse "+r+" instead."),console.warn(t)},e.Connection=function(t,n){this.sourceBlock_=t,this.type=n},e.Connection.CAN_CONNECT=0,e.Connection.REASON_SELF_CONNECTION=1,e.Connection.REASON_WRONG_TYPE=2,e.Connection.REASON_TARGET_NULL=3,e.Connection.REASON_CHECKS_FAILED=4,e.Connection.REASON_DIFFERENT_WORKSPACES=5,e.Connection.REASON_SHADOW_PARENT=6,e.Connection.REASON_DRAG_CHECKS_FAILED=7,e.Connection.prototype.targetConnection=null,e.Connection.prototype.disposed=!1,e.Connection.prototype.check_=null,e.Connection.prototype.shadowDom_=null,e.Connection.prototype.x=0,e.Connection.prototype.y=0,e.Connection.prototype.connect_=function(t){var L,n=e.connectionTypes.INPUT_VALUE,o=this.getSourceBlock(),r=t.getSourceBlock();if(t.isConnected()&&t.disconnect(),this.isConnected()){var a=this.getShadowDom(!0);this.shadowDom_=null;var h=this.targetBlock();if(h.isShadow())h.dispose(!1);else{this.disconnect();var R=h}this.shadowDom_=a}e.Events.isEnabled()&&(L=new(e.Events.get(e.Events.BLOCK_MOVE))(r)),e.Connection.connectReciprocally_(this,t),r.setParent(o),L&&(L.recordNew(),e.Events.fire(L)),R&&((r=e.Connection.getConnectionForOrphanedConnection(r,t=this.type===n?R.outputConnection:R.previousConnection))?t.connect(r):t.onFailedConnect(this))},e.Connection.prototype.dispose=function(){if(this.isConnected()){this.setShadowDom(null);var t=this.targetBlock();t&&t.unplug()}this.disposed=!0},e.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},e.Connection.prototype.isSuperior=function(){return this.type==e.connectionTypes.INPUT_VALUE||this.type==e.connectionTypes.NEXT_STATEMENT},e.Connection.prototype.isConnected=function(){return!!this.targetConnection},e.Connection.prototype.canConnectWithReason=function(t){return e.utils.deprecation.warn("Connection.prototype.canConnectWithReason","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnectWithReason(this,t,!1)},e.Connection.prototype.checkConnection=function(t){e.utils.deprecation.warn("Connection.prototype.checkConnection","July 2020","July 2021","the workspace's connection checker");var n=this.getConnectionChecker(),o=n.canConnectWithReason(this,t,!1);if(o!=e.Connection.CAN_CONNECT)throw Error(n.getErrorMessage(o,this,t))},e.Connection.prototype.getConnectionChecker=function(){return this.sourceBlock_.workspace.connectionChecker},e.Connection.prototype.isConnectionAllowed=function(t){return e.utils.deprecation.warn("Connection.prototype.isConnectionAllowed","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,t,!0)},e.Connection.prototype.onFailedConnect=function(t){},e.Connection.prototype.connect=function(t){if(this.targetConnection!=t&&this.getConnectionChecker().canConnect(this,t,!1)){var n=e.Events.getGroup();n||e.Events.setGroup(!0),this.isSuperior()?this.connect_(t):t.connect_(this),n||e.Events.setGroup(!1)}},e.Connection.connectReciprocally_=function(t,n){if(!t||!n)throw Error("Cannot connect null connections.");t.targetConnection=n,n.targetConnection=t},e.Connection.getSingleConnection_=function(t,n){for(var h,o=null,r=(n=n.outputConnection).getConnectionChecker(),a=0;h=t.inputList[a];a++)if((h=h.connection)&&r.canConnect(n,h,!1)){if(o)return null;o=h}return o},e.Connection.getConnectionForOrphanedOutput_=function(t,n){for(var o;o=e.Connection.getSingleConnection_(t,n);)if(!(t=o.targetBlock())||t.isShadow())return o;return null},e.Connection.getConnectionForOrphanedConnection=function(t,n){if(n.type===e.connectionTypes.OUTPUT_VALUE)return e.Connection.getConnectionForOrphanedOutput_(t,n.getSourceBlock());t=t.lastConnectionInStack(!0);var o=n.getConnectionChecker();return t&&o.canConnect(n,t,!1)?t:null},e.Connection.prototype.disconnect=function(){var t=this.targetConnection;if(!t)throw Error("Source connection not connected.");if(t.targetConnection!=this)throw Error("Target connection not connected to source connection.");if(this.isSuperior()){var n=this.sourceBlock_,o=t.getSourceBlock();t=this}else n=t.getSourceBlock(),o=this.sourceBlock_;var r=e.Events.getGroup();r||e.Events.setGroup(!0),this.disconnectInternal_(n,o),o.isShadow()||t.respawnShadow_(),r||e.Events.setGroup(!1)},e.Connection.prototype.disconnectInternal_=function(t,n){var o;e.Events.isEnabled()&&(o=new(e.Events.get(e.Events.BLOCK_MOVE))(n)),this.targetConnection=this.targetConnection.targetConnection=null,n.setParent(null),o&&(o.recordNew(),e.Events.fire(o))},e.Connection.prototype.respawnShadow_=function(){var t=this.getSourceBlock(),n=this.getShadowDom();if(t.workspace&&n)if((t=e.Xml.domToBlock(n,t.workspace)).outputConnection)this.connect(t.outputConnection);else{if(!t.previousConnection)throw Error("Child block does not have output or previous statement.");this.connect(t.previousConnection)}},e.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},e.Connection.prototype.checkType=function(t){return e.utils.deprecation.warn("Connection.prototype.checkType","October 2019","January 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,t,!1)},e.Connection.prototype.checkType_=function(t){return e.utils.deprecation.warn("Connection.prototype.checkType_","October 2019","January 2021","the workspace's connection checker"),this.checkType(t)},e.Connection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},e.Connection.prototype.setCheck=function(t){return t?(Array.isArray(t)||(t=[t]),this.check_=t,this.onCheckChanged_()):this.check_=null,this},e.Connection.prototype.getCheck=function(){return this.check_},e.Connection.prototype.setShadowDom=function(t){this.shadowDom_=t,(t=this.targetBlock())?t.isShadow()&&(t.dispose(!1),this.respawnShadow_()):this.respawnShadow_()},e.Connection.prototype.getShadowDom=function(t){return t&&this.targetBlock().isShadow()?e.Xml.blockToDom(this.targetBlock()):this.shadowDom_},e.Connection.prototype.neighbours=function(t){return[]},e.Connection.prototype.getParentInput=function(){for(var t=null,n=this.sourceBlock_.inputList,o=0;o<n.length;o++)if(n[o].connection===this){t=n[o];break}return t},e.Connection.prototype.toString=function(){var t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection==this)var n="Output Connection of ";else if(t.previousConnection==this)n="Previous Connection of ";else if(t.nextConnection==this)n="Next Connection of ";else{n=null;for(var r,o=0;r=t.inputList[o];o++)if(r.connection==this){n=r;break}if(!n)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";n='Input "'+n.name+'" connection on '}return n+t.toDevString()},e.IConnectionChecker=function(){},e.ConnectionChecker=function(){},e.ConnectionChecker.prototype.canConnect=function(t,n,o,r){return this.canConnectWithReason(t,n,o,r)==e.Connection.CAN_CONNECT},e.ConnectionChecker.prototype.canConnectWithReason=function(t,n,o,r){var a=this.doSafetyChecks(t,n);return a!=e.Connection.CAN_CONNECT?a:this.doTypeChecks(t,n)?o&&!this.doDragChecks(t,n,r||0)?e.Connection.REASON_DRAG_CHECKS_FAILED:e.Connection.CAN_CONNECT:e.Connection.REASON_CHECKS_FAILED},e.ConnectionChecker.prototype.getErrorMessage=function(t,n,o){switch(t){case e.Connection.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case e.Connection.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case e.Connection.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case e.Connection.REASON_TARGET_NULL:return"Target connection is null.";case e.Connection.REASON_CHECKS_FAILED:return"Connection checks failed. "+n+" expected "+n.getCheck()+", found "+o.getCheck();case e.Connection.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case e.Connection.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";default:return"Unknown connection failure: this should never happen!"}},e.ConnectionChecker.prototype.doSafetyChecks=function(t,n){if(!t||!n)return e.Connection.REASON_TARGET_NULL;if(t.isSuperior())var o=t.getSourceBlock(),r=n.getSourceBlock();else r=t.getSourceBlock(),o=n.getSourceBlock();return o==r?e.Connection.REASON_SELF_CONNECTION:n.type!=e.OPPOSITE_TYPE[t.type]?e.Connection.REASON_WRONG_TYPE:o.workspace!==r.workspace?e.Connection.REASON_DIFFERENT_WORKSPACES:o.isShadow()&&!r.isShadow()?e.Connection.REASON_SHADOW_PARENT:e.Connection.CAN_CONNECT},e.ConnectionChecker.prototype.doTypeChecks=function(t,n){if(t=t.getCheck(),n=n.getCheck(),!t||!n)return!0;for(var o=0;o<t.length;o++)if(-1!=n.indexOf(t[o]))return!0;return!1},e.ConnectionChecker.prototype.doDragChecks=function(t,n,o){if(t.distanceFrom(n)>o||n.getSourceBlock().isInsertionMarker())return!1;switch(n.type){case e.connectionTypes.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t,n);case e.connectionTypes.OUTPUT_VALUE:if(n.isConnected()&&!n.targetBlock().isInsertionMarker()||t.isConnected())return!1;break;case e.connectionTypes.INPUT_VALUE:if(n.isConnected()&&!n.targetBlock().isMovable()&&!n.targetBlock().isShadow())return!1;break;case e.connectionTypes.NEXT_STATEMENT:if(n.isConnected()&&!t.getSourceBlock().nextConnection&&!n.targetBlock().isShadow()&&n.targetBlock().nextConnection)return!1;break;default:return!1}return-1==e.draggingConnections.indexOf(n)},e.ConnectionChecker.prototype.canConnectToPrevious_=function(t,n){return!(t.targetConnection||-1!=e.draggingConnections.indexOf(n)||n.targetConnection&&(!(t=n.targetBlock()).isInsertionMarker()||t.getPreviousBlock()))},e.registry.register(e.registry.Type.CONNECTION_CHECKER,e.registry.DEFAULT,e.ConnectionChecker),e.VariableMap=function(t){this.variableMap_=Object.create(null),this.workspace=t},e.VariableMap.prototype.clear=function(){this.variableMap_=Object.create(null)},e.VariableMap.prototype.renameVariable=function(t,n){var o=this.getVariable(n,t.type),r=this.workspace.getAllBlocks(!1);e.Events.setGroup(!0);try{o&&o.getId()!=t.getId()?this.renameVariableWithConflict_(t,n,o,r):this.renameVariableAndUses_(t,n,r)}finally{e.Events.setGroup(!1)}},e.VariableMap.prototype.renameVariableById=function(t,n){var o=this.getVariableById(t);if(!o)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(o,n)},e.VariableMap.prototype.renameVariableAndUses_=function(t,n,o){for(e.Events.fire(new(e.Events.get(e.Events.VAR_RENAME))(t,n)),t.name=n,n=0;n<o.length;n++)o[n].updateVarName(t)},e.VariableMap.prototype.renameVariableWithConflict_=function(t,n,o,r){var a=t.type;for(n!=o.name&&this.renameVariableAndUses_(o,n,r),n=0;n<r.length;n++)r[n].renameVarById(t.getId(),o.getId());e.Events.fire(new(e.Events.get(e.Events.VAR_DELETE))(t)),t=this.getVariablesOfType(a).indexOf(t),this.variableMap_[a].splice(t,1)},e.VariableMap.prototype.createVariable=function(t,n,o){var r=this.getVariable(t,n);if(r){if(o&&r.getId()!=o)throw Error('Variable "'+t+'" is already in use and its id is "'+r.getId()+'" which conflicts with the passed in id, "'+o+'".');return r}if(o&&this.getVariableById(o))throw Error('Variable id, "'+o+'", is already in use.');return r=o||e.utils.genUid(),r=new e.VariableModel(this.workspace,t,n=n||"",r),(t=this.variableMap_[n]||[]).push(r),delete this.variableMap_[n],this.variableMap_[n]=t,r},e.VariableMap.prototype.deleteVariable=function(t){for(var r,n=this.variableMap_[t.type],o=0;r=n[o];o++)if(r.getId()==t.getId()){n.splice(o,1),e.Events.fire(new(e.Events.get(e.Events.VAR_DELETE))(t));break}},e.VariableMap.prototype.deleteVariableById=function(t){var n=this.getVariableById(t);if(n){var a,o=n.name,r=this.getVariableUsesById(t);for(t=0;a=r[t];t++)if("procedures_defnoreturn"==a.type||"procedures_defreturn"==a.type)return t=a.getFieldValue("NAME"),o=e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",o).replace("%2",t),void e.alert(o);var h=this;1<r.length?(o=e.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(r.length)).replace("%2",o),e.confirm(o,function(R){R&&n&&h.deleteVariableInternal(n,r)})):h.deleteVariableInternal(n,r)}else console.warn("Can't delete non-existent variable: "+t)},e.VariableMap.prototype.deleteVariableInternal=function(t,n){var o=e.Events.getGroup();o||e.Events.setGroup(!0);try{for(var r=0;r<n.length;r++)n[r].dispose(!0);this.deleteVariable(t)}finally{o||e.Events.setGroup(!1)}},e.VariableMap.prototype.getVariable=function(t,n){if(n=this.variableMap_[n||""])for(var r,o=0;r=n[o];o++)if(e.Names.equals(r.name,t))return r;return null},e.VariableMap.prototype.getVariableById=function(t){for(var n=Object.keys(this.variableMap_),o=0;o<n.length;o++)for(var h,r=n[o],a=0;h=this.variableMap_[r][a];a++)if(h.getId()==t)return h;return null},e.VariableMap.prototype.getVariablesOfType=function(t){return(t=this.variableMap_[t||""])?t.slice():[]},e.VariableMap.prototype.getVariableTypes=function(t){var n={};e.utils.object.mixin(n,this.variableMap_),t&&t.getPotentialVariableMap()&&e.utils.object.mixin(n,t.getPotentialVariableMap().variableMap_),t=Object.keys(n),n=!1;for(var o=0;o<t.length;o++)""==t[o]&&(n=!0);return n||t.push(""),t},e.VariableMap.prototype.getAllVariables=function(){var n,t=[];for(n in this.variableMap_)t=t.concat(this.variableMap_[n]);return t},e.VariableMap.prototype.getAllVariableNames=function(){var n,t=[];for(n in this.variableMap_)for(var a,o=this.variableMap_[n],r=0;a=o[r];r++)t.push(a.name);return t},e.VariableMap.prototype.getVariableUsesById=function(t){for(var n=[],o=this.workspace.getAllBlocks(!1),r=0;r<o.length;r++){var a=o[r].getVarModels();if(a)for(var h=0;h<a.length;h++)a[h].getId()==t&&n.push(o[r])}return n},e.Workspace=function(t){this.id=e.utils.genUid(),e.Workspace.WorkspaceDB_[this.id]=this,this.options=t||new e.Options({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(e.registry.getClassFromOptions(e.registry.Type.CONNECTION_CHECKER,this.options,!0))(this),this.topBlocks_=[],this.topComments_=[],this.commentDB_=Object.create(null),this.listeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.typedBlocksDB_=Object.create(null),this.variableMap_=new e.VariableMap(this),this.potentialVariableMap_=null},e.Workspace.prototype.rendered=!1,e.Workspace.prototype.isClearing=!1,e.Workspace.prototype.MAX_UNDO=1024,e.Workspace.prototype.connectionDBList=null,e.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete e.Workspace.WorkspaceDB_[this.id]},e.Workspace.SCAN_ANGLE=3,e.Workspace.prototype.sortObjects_=function(t,n){return t=t.getRelativeToSurfaceXY(),n=n.getRelativeToSurfaceXY(),t.y+e.Workspace.prototype.sortObjects_.offset*t.x-(n.y+e.Workspace.prototype.sortObjects_.offset*n.x)},e.Workspace.prototype.addTopBlock=function(t){this.topBlocks_.push(t)},e.Workspace.prototype.removeTopBlock=function(t){if(!e.utils.arrayRemove(this.topBlocks_,t))throw Error("Block not present in workspace's list of top-most blocks.")},e.Workspace.prototype.getTopBlocks=function(t){var n=[].concat(this.topBlocks_);return t&&1<n.length&&(this.sortObjects_.offset=Math.sin(e.utils.math.toRadians(e.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),n.sort(this.sortObjects_)),n},e.Workspace.prototype.addTypedBlock=function(t){this.typedBlocksDB_[t.type]||(this.typedBlocksDB_[t.type]=[]),this.typedBlocksDB_[t.type].push(t)},e.Workspace.prototype.removeTypedBlock=function(t){this.typedBlocksDB_[t.type].splice(this.typedBlocksDB_[t.type].indexOf(t),1),this.typedBlocksDB_[t.type].length||delete this.typedBlocksDB_[t.type]},e.Workspace.prototype.getBlocksByType=function(t,n){return this.typedBlocksDB_[t]?(t=this.typedBlocksDB_[t].slice(0),n&&1<t.length&&(this.sortObjects_.offset=Math.sin(e.utils.math.toRadians(e.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t):[]},e.Workspace.prototype.addTopComment=function(t){this.topComments_.push(t),this.commentDB_[t.id]&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB_[t.id]=t},e.Workspace.prototype.removeTopComment=function(t){if(!e.utils.arrayRemove(this.topComments_,t))throw Error("Comment not present in workspace's list of top-most comments.");delete this.commentDB_[t.id]},e.Workspace.prototype.getTopComments=function(t){var n=[].concat(this.topComments_);return t&&1<n.length&&(this.sortObjects_.offset=Math.sin(e.utils.math.toRadians(e.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),n.sort(this.sortObjects_)),n},e.Workspace.prototype.getAllBlocks=function(t){if(t){t=this.getTopBlocks(!0);for(var n=[],o=0;o<t.length;o++)n.push.apply(n,t[o].getDescendants(!0))}else for(n=this.getTopBlocks(!1),o=0;o<n.length;o++)n.push.apply(n,n[o].getChildren(!1));return n.filter(function(r){return!r.isInsertionMarker()})},e.Workspace.prototype.clear=function(){this.isClearing=!0;try{var t=e.Events.getGroup();for(t||e.Events.setGroup(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose(!1);for(;this.topComments_.length;)this.topComments_[this.topComments_.length-1].dispose(!1);t||e.Events.setGroup(!1),this.variableMap_.clear(),this.potentialVariableMap_&&this.potentialVariableMap_.clear()}finally{this.isClearing=!1}},e.Workspace.prototype.renameVariableById=function(t,n){this.variableMap_.renameVariableById(t,n)},e.Workspace.prototype.createVariable=function(t,n,o){return this.variableMap_.createVariable(t,n,o)},e.Workspace.prototype.getVariableUsesById=function(t){return this.variableMap_.getVariableUsesById(t)},e.Workspace.prototype.deleteVariableById=function(t){this.variableMap_.deleteVariableById(t)},e.Workspace.prototype.getVariable=function(t,n){return this.variableMap_.getVariable(t,n)},e.Workspace.prototype.getVariableById=function(t){return this.variableMap_.getVariableById(t)},e.Workspace.prototype.getVariablesOfType=function(t){return this.variableMap_.getVariablesOfType(t)},e.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes(this)},e.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},e.Workspace.prototype.getAllVariableNames=function(){return this.variableMap_.getAllVariableNames()},e.Workspace.prototype.getWidth=function(){return 0},e.Workspace.prototype.newBlock=function(t,n){return new e.Block(this,t,n)},e.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length},e.Workspace.prototype.remainingCapacityOfType=function(t){return this.options.maxInstances?(void 0!==this.options.maxInstances[t]?this.options.maxInstances[t]:1/0)-this.getBlocksByType(t,!1).length:1/0},e.Workspace.prototype.isCapacityAvailable=function(t){if(!this.hasBlockLimits())return!0;var o,n=0;for(o in t){if(t[o]>this.remainingCapacityOfType(o))return!1;n+=t[o]}return!(n>this.remainingCapacity())},e.Workspace.prototype.hasBlockLimits=function(){return this.options.maxBlocks!=1/0||!!this.options.maxInstances},e.Workspace.prototype.getUndoStack=function(){return this.undoStack_},e.Workspace.prototype.getRedoStack=function(){return this.redoStack_},e.Workspace.prototype.undo=function(t){var n=t?this.redoStack_:this.undoStack_,o=t?this.undoStack_:this.redoStack_,r=n.pop();if(r){for(var a=[r];n.length&&r.group&&r.group==n[n.length-1].group;)a.push(n.pop());for(n=0;r=a[n];n++)o.push(r);a=e.Events.filter(a,t),e.Events.recordUndo=!1;try{for(n=0;r=a[n];n++)r.run(t)}finally{e.Events.recordUndo=!0}}},e.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,e.Events.clearPendingUndo()},e.Workspace.prototype.addChangeListener=function(t){return this.listeners_.push(t),t},e.Workspace.prototype.removeChangeListener=function(t){e.utils.arrayRemove(this.listeners_,t)},e.Workspace.prototype.fireChangeListener=function(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(var o,n=0;o=this.listeners_[n];n++)o(t)},e.Workspace.prototype.getBlockById=function(t){return this.blockDB_[t]||null},e.Workspace.prototype.setBlockById=function(t,n){this.blockDB_[t]=n},e.Workspace.prototype.removeBlockById=function(t){delete this.blockDB_[t]},e.Workspace.prototype.getCommentById=function(t){return this.commentDB_[t]||null},e.Workspace.prototype.allInputsFilled=function(t){for(var r,n=this.getTopBlocks(!1),o=0;r=n[o];o++)if(!r.allInputsFilled(t))return!1;return!0},e.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_},e.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new e.VariableMap(this)},e.Workspace.prototype.getVariableMap=function(){return this.variableMap_},e.Workspace.prototype.setVariableMap=function(t){this.variableMap_=t},e.Workspace.WorkspaceDB_=Object.create(null),e.Workspace.getById=function(t){return e.Workspace.WorkspaceDB_[t]||null},e.Workspace.getAll=function(){var n,t=[];for(n in e.Workspace.WorkspaceDB_)t.push(e.Workspace.WorkspaceDB_[n]);return t},e.WorkspaceDragSurfaceSvg=function(t){this.container_=t,this.createDom()},e.WorkspaceDragSurfaceSvg.prototype.SVG_=null,e.WorkspaceDragSurfaceSvg.prototype.container_=null,e.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null),this.container_.appendChild(this.SVG_))},e.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(t,n){t=t.toFixed(0),n=n.toFixed(0),this.SVG_.style.display="block",e.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+n+"px, 0px)")},e.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return e.utils.getRelativeXY(this.SVG_)},e.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(t){if(!t)throw Error("Couldn't clear and hide the drag surface: missing new surface.");var n=this.SVG_.childNodes[0],o=this.SVG_.childNodes[1];if(!(n&&o&&e.utils.dom.hasClass(n,"blocklyBlockCanvas")&&e.utils.dom.hasClass(o,"blocklyBubbleCanvas")))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(null!=this.previousSibling_?e.utils.dom.insertAfter(n,this.previousSibling_):t.insertBefore(n,t.firstChild),e.utils.dom.insertAfter(o,n),this.SVG_.style.display="none",this.SVG_.childNodes.length)throw Error("Drag surface was not cleared.");e.utils.dom.setCssTransform(this.SVG_,""),this.previousSibling_=null},e.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(t,n,o,r,a,h){if(this.SVG_.childNodes.length)throw Error("Already dragging a block.");this.previousSibling_=o,t.setAttribute("transform","translate(0, 0) scale("+h+")"),n.setAttribute("transform","translate(0, 0) scale("+h+")"),this.SVG_.setAttribute("width",r),this.SVG_.setAttribute("height",a),this.SVG_.appendChild(t),this.SVG_.appendChild(n),this.SVG_.style.display="block"},e.blockRendering={},e.blockRendering.useDebugger=!1,e.blockRendering.register=function(t,n){e.registry.register(e.registry.Type.RENDERER,t,n)},e.blockRendering.unregister=function(t){e.registry.unregister(e.registry.Type.RENDERER,t)},e.blockRendering.startDebugger=function(){e.blockRendering.useDebugger=!0},e.blockRendering.stopDebugger=function(){e.blockRendering.useDebugger=!1},e.blockRendering.init=function(t,n,o){return(t=new(e.registry.getClass(e.registry.Type.RENDERER,t))(t)).init(n,o),t},e.ASTNode=function(t,n,o){if(!n)throw Error("Cannot create a node without a location.");this.type_=t,this.isConnection_=e.ASTNode.isConnectionType_(t),this.location_=n,this.wsCoordinate_=null,this.processParams_(o||null)},e.ASTNode.types={FIELD:"field",BLOCK:"block",INPUT:"input",OUTPUT:"output",NEXT:"next",PREVIOUS:"previous",STACK:"stack",WORKSPACE:"workspace"},e.ASTNode.NAVIGATE_ALL_FIELDS=!1,e.ASTNode.DEFAULT_OFFSET_Y=-20,e.ASTNode.isConnectionType_=function(t){switch(t){case e.ASTNode.types.PREVIOUS:case e.ASTNode.types.NEXT:case e.ASTNode.types.INPUT:case e.ASTNode.types.OUTPUT:return!0}return!1},e.ASTNode.createFieldNode=function(t){return t?new e.ASTNode(e.ASTNode.types.FIELD,t):null},e.ASTNode.createConnectionNode=function(t){if(!t)return null;var n=t.type;return n==e.connectionTypes.INPUT_VALUE||n==e.connectionTypes.NEXT_STATEMENT&&t.getParentInput()?e.ASTNode.createInputNode(t.getParentInput()):n==e.connectionTypes.NEXT_STATEMENT?new e.ASTNode(e.ASTNode.types.NEXT,t):n==e.connectionTypes.OUTPUT_VALUE?new e.ASTNode(e.ASTNode.types.OUTPUT,t):n==e.connectionTypes.PREVIOUS_STATEMENT?new e.ASTNode(e.ASTNode.types.PREVIOUS,t):null},e.ASTNode.createInputNode=function(t){return t&&t.connection?new e.ASTNode(e.ASTNode.types.INPUT,t.connection):null},e.ASTNode.createBlockNode=function(t){return t?new e.ASTNode(e.ASTNode.types.BLOCK,t):null},e.ASTNode.createStackNode=function(t){return t?new e.ASTNode(e.ASTNode.types.STACK,t):null},e.ASTNode.createWorkspaceNode=function(t,n){return n&&t?new e.ASTNode(e.ASTNode.types.WORKSPACE,t,{wsCoordinate:n}):null},e.ASTNode.createTopNode=function(t){var n=t.previousConnection||t.outputConnection;return n?e.ASTNode.createConnectionNode(n):e.ASTNode.createBlockNode(t)},e.ASTNode.prototype.processParams_=function(t){t&&t.wsCoordinate&&(this.wsCoordinate_=t.wsCoordinate)},e.ASTNode.prototype.getLocation=function(){return this.location_},e.ASTNode.prototype.getType=function(){return this.type_},e.ASTNode.prototype.getWsCoordinate=function(){return this.wsCoordinate_},e.ASTNode.prototype.isConnection=function(){return this.isConnection_},e.ASTNode.prototype.findNextForInput_=function(){var o,t=this.location_.getParentInput(),n=t.getSourceBlock();for(t=n.inputList.indexOf(t)+1;o=n.inputList[t];t++){for(var h,r=o.fieldRow,a=0;h=r[a];a++)if(h.isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(h);if(o.connection)return e.ASTNode.createInputNode(o)}return null},e.ASTNode.prototype.findNextForField_=function(){var t=this.location_,n=t.getParentInput(),o=t.getSourceBlock(),r=o.inputList.indexOf(n);for(t=n.fieldRow.indexOf(t)+1;n=o.inputList[r];r++){for(var a=n.fieldRow;t<a.length;){if(a[t].isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(a[t]);t++}if(t=0,n.connection)return e.ASTNode.createInputNode(n)}return null},e.ASTNode.prototype.findPrevForInput_=function(){for(var r,t=this.location_.getParentInput(),n=t.getSourceBlock(),o=n.inputList.indexOf(t);r=n.inputList[o];o--){if(r.connection&&r!==t)return e.ASTNode.createInputNode(r);for(var h,a=(r=r.fieldRow).length-1;h=r[a];a--)if(h.isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(h)}return null},e.ASTNode.prototype.findPrevForField_=function(){var a,t=this.location_,n=t.getParentInput(),o=t.getSourceBlock(),r=o.inputList.indexOf(n);for(t=n.fieldRow.indexOf(t)-1;a=o.inputList[r];r--){if(a.connection&&a!==n)return e.ASTNode.createInputNode(a);for(a=a.fieldRow;-1<t;){if(a[t].isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(a[t]);t--}0<=r-1&&(t=o.inputList[r-1].fieldRow.length-1)}return null},e.ASTNode.prototype.navigateBetweenStacks_=function(t){var n=this.getLocation();if(n instanceof e.Block||(n=n.getSourceBlock()),!n||!n.workspace)return null;var o=n.getRootBlock();n=o.workspace.getTopBlocks(!0);for(var a,r=0;a=n[r];r++)if(o.id==a.id)return-1==(t=r+(t?1:-1))||t==n.length?null:e.ASTNode.createStackNode(n[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")},e.ASTNode.prototype.findTopASTNodeForBlock_=function(t){var n=t.previousConnection||t.outputConnection;return n?e.ASTNode.createConnectionNode(n):e.ASTNode.createBlockNode(t)},e.ASTNode.prototype.getOutAstNodeForBlock_=function(t){if(!t)return null;var n=(t=t.getTopStackBlock()).previousConnection||t.outputConnection;return n&&n.targetConnection&&n.targetConnection.getParentInput()?e.ASTNode.createInputNode(n.targetConnection.getParentInput()):e.ASTNode.createStackNode(t)},e.ASTNode.prototype.findFirstFieldOrInput_=function(t){t=t.inputList;for(var o,n=0;o=t[n];n++){for(var h,r=o.fieldRow,a=0;h=r[a];a++)if(h.isClickable()||e.ASTNode.NAVIGATE_ALL_FIELDS)return e.ASTNode.createFieldNode(h);if(o.connection)return e.ASTNode.createInputNode(o)}return null},e.ASTNode.prototype.getSourceBlock=function(){return this.getType()===e.ASTNode.types.BLOCK||this.getType()===e.ASTNode.types.STACK?this.getLocation():this.getType()===e.ASTNode.types.WORKSPACE?null:this.getLocation().getSourceBlock()},e.ASTNode.prototype.next=function(){switch(this.type_){case e.ASTNode.types.STACK:return this.navigateBetweenStacks_(!0);case e.ASTNode.types.OUTPUT:var t=this.location_;return e.ASTNode.createBlockNode(t.getSourceBlock());case e.ASTNode.types.FIELD:return this.findNextForField_();case e.ASTNode.types.INPUT:return this.findNextForInput_();case e.ASTNode.types.BLOCK:return e.ASTNode.createConnectionNode(this.location_.nextConnection);case e.ASTNode.types.PREVIOUS:return e.ASTNode.createBlockNode((t=this.location_).getSourceBlock());case e.ASTNode.types.NEXT:return e.ASTNode.createConnectionNode((t=this.location_).targetConnection)}return null},e.ASTNode.prototype.in=function(){switch(this.type_){case e.ASTNode.types.WORKSPACE:var t=this.location_.getTopBlocks(!0);if(0<t.length)return e.ASTNode.createStackNode(t[0]);break;case e.ASTNode.types.STACK:return this.findTopASTNodeForBlock_(t=this.location_);case e.ASTNode.types.BLOCK:return this.findFirstFieldOrInput_(t=this.location_);case e.ASTNode.types.INPUT:return e.ASTNode.createConnectionNode(this.location_.targetConnection)}return null},e.ASTNode.prototype.prev=function(){switch(this.type_){case e.ASTNode.types.STACK:return this.navigateBetweenStacks_(!1);case e.ASTNode.types.FIELD:return this.findPrevForField_();case e.ASTNode.types.INPUT:return this.findPrevForInput_();case e.ASTNode.types.BLOCK:var t=this.location_;return e.ASTNode.createConnectionNode(t.previousConnection||t.outputConnection);case e.ASTNode.types.PREVIOUS:if((t=(t=this.location_).targetConnection)&&!t.getParentInput())return e.ASTNode.createConnectionNode(t);break;case e.ASTNode.types.NEXT:return e.ASTNode.createBlockNode((t=this.location_).getSourceBlock())}return null},e.ASTNode.prototype.out=function(){switch(this.type_){case e.ASTNode.types.STACK:var t=this.location_,n=t.getRelativeToSurfaceXY();return n=new e.utils.Coordinate(n.x,n.y+e.ASTNode.DEFAULT_OFFSET_Y),e.ASTNode.createWorkspaceNode(t.workspace,n);case e.ASTNode.types.OUTPUT:return(n=(t=this.location_).targetConnection)?e.ASTNode.createConnectionNode(n):e.ASTNode.createStackNode(t.getSourceBlock());case e.ASTNode.types.FIELD:return e.ASTNode.createBlockNode(this.location_.getSourceBlock());case e.ASTNode.types.INPUT:return e.ASTNode.createBlockNode((t=this.location_).getSourceBlock());case e.ASTNode.types.BLOCK:return this.getOutAstNodeForBlock_(t=this.location_);case e.ASTNode.types.PREVIOUS:case e.ASTNode.types.NEXT:return this.getOutAstNodeForBlock_((t=this.location_).getSourceBlock())}return null},e.Blocks=Object.create(null),e.Extensions={},e.Extensions.ALL_=Object.create(null),e.Extensions.register=function(t,n){if("string"!=typeof t||""==t.trim())throw Error('Error: Invalid extension name "'+t+'"');if(e.Extensions.ALL_[t])throw Error('Error: Extension "'+t+'" is already registered.');if("function"!=typeof n)throw Error('Error: Extension "'+t+'" must be a function');e.Extensions.ALL_[t]=n},e.Extensions.registerMixin=function(t,n){if(!n||"object"!=typeof n)throw Error('Error: Mixin "'+t+'" must be a object');e.Extensions.register(t,function(){this.mixin(n)})},e.Extensions.registerMutator=function(t,n,o,r){var a='Error when registering mutator "'+t+'": ';e.Extensions.checkHasFunction_(a,n.domToMutation,"domToMutation"),e.Extensions.checkHasFunction_(a,n.mutationToDom,"mutationToDom");var h=e.Extensions.checkMutatorDialog_(n,a);if(o&&"function"!=typeof o)throw Error('Extension "'+t+'" is not a function');e.Extensions.register(t,function(){if(h){if(!e.Mutator)throw Error(a+"Missing require for Blockly.Mutator");this.setMutator(new e.Mutator(r||[]))}this.mixin(n),o&&o.apply(this)})},e.Extensions.unregister=function(t){e.Extensions.ALL_[t]?delete e.Extensions.ALL_[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},e.Extensions.apply=function(t,n,o){var r=e.Extensions.ALL_[t];if("function"!=typeof r)throw Error('Error: Extension "'+t+'" not found.');if(o)e.Extensions.checkNoMutatorProperties_(t,n);else var a=e.Extensions.getMutatorProperties_(n);if(r.apply(n),o)e.Extensions.checkBlockHasMutatorProperties_('Error after applying mutator "'+t+'": ',n);else if(!e.Extensions.mutatorPropertiesMatch_(a,n))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},e.Extensions.checkHasFunction_=function(t,n,o){if(!n)throw Error(t+'missing required property "'+o+'"');if("function"!=typeof n)throw Error(t+'" required property "'+o+'" must be a function')},e.Extensions.checkNoMutatorProperties_=function(t,n){if(e.Extensions.getMutatorProperties_(n).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+n.id)},e.Extensions.checkMutatorDialog_=function(t,n){var o=void 0!==t.compose,r=void 0!==t.decompose;if(o&&r){if("function"!=typeof t.compose)throw Error(n+"compose must be a function.");if("function"!=typeof t.decompose)throw Error(n+"decompose must be a function.");return!0}if(!o&&!r)return!1;throw Error(n+'Must have both or neither of "compose" and "decompose"')},e.Extensions.checkBlockHasMutatorProperties_=function(t,n){if("function"!=typeof n.domToMutation)throw Error(t+'Applying a mutator didn\'t add "domToMutation"');if("function"!=typeof n.mutationToDom)throw Error(t+'Applying a mutator didn\'t add "mutationToDom"');e.Extensions.checkMutatorDialog_(n,t)},e.Extensions.getMutatorProperties_=function(t){var n=[];return void 0!==t.domToMutation&&n.push(t.domToMutation),void 0!==t.mutationToDom&&n.push(t.mutationToDom),void 0!==t.compose&&n.push(t.compose),void 0!==t.decompose&&n.push(t.decompose),n},e.Extensions.mutatorPropertiesMatch_=function(t,n){if((n=e.Extensions.getMutatorProperties_(n)).length!=t.length)return!1;for(var o=0;o<n.length;o++)if(t[o]!=n[o])return!1;return!0},e.Extensions.buildTooltipForDropdown=function(t,n){var o=[];return"object"==typeof document&&e.utils.runAfterPageLoad(function(){for(var r in n)e.utils.checkMessageReferences(n[r])}),function(){this.type&&-1==o.indexOf(this.type)&&(e.Extensions.checkDropdownOptionsInTable_(this,t,n),o.push(this.type)),this.setTooltip(function(){var r=String(this.getFieldValue(t)),a=n[r];return null==a?-1==o.indexOf(this.type)&&(r="No tooltip mapping for value "+r+" of field "+t,null!=this.type&&(r+=" of block type "+this.type),console.warn(r+".")):a=e.utils.replaceMessageReferences(a),a}.bind(this))}},e.Extensions.checkDropdownOptionsInTable_=function(t,n,o){var r=t.getField(n);if(!r.isOptionListDynamic()){r=r.getOptions();for(var a=0;a<r.length;++a){var h=r[a][1];null==o[h]&&console.warn("No tooltip mapping for value "+h+" of field "+n+" of block type "+t.type)}}},e.Extensions.buildTooltipWithFieldText=function(t,n){return"object"==typeof document&&e.utils.runAfterPageLoad(function(){e.utils.checkMessageReferences(t)}),function(){this.setTooltip(function(){var o=this.getField(n);return e.utils.replaceMessageReferences(t).replace("%1",o?o.getText():"")}.bind(this))}},e.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip,this.setTooltip(function(){var t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||this.tooltipWhenNotConnected_}.bind(this))},e.Extensions.register("parent_tooltip_when_inline",e.Extensions.extensionParentTooltip_),e.fieldRegistry={},e.fieldRegistry.register=function(t,n){e.registry.register(e.registry.Type.FIELD,t,n)},e.fieldRegistry.unregister=function(t){e.registry.unregister(e.registry.Type.FIELD,t)},e.fieldRegistry.fromJson=function(t){var n=e.registry.getObject(e.registry.Type.FIELD,t.type);return n?n.fromJson(t):(console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},e.IDeletable=function(){},e.blockAnimations={},e.blockAnimations.disconnectPid_=0,e.blockAnimations.disconnectGroup_=null,e.blockAnimations.disposeUiEffect=function(t){var n=t.workspace,o=t.getSvgRoot();n.getAudioManager().play("delete"),t=n.getSvgXY(o),(o=o.cloneNode(!0)).translateX_=t.x,o.translateY_=t.y,o.setAttribute("transform","translate("+t.x+","+t.y+")"),n.getParentSvg().appendChild(o),o.bBox_=o.getBBox(),e.blockAnimations.disposeUiStep_(o,n.RTL,new Date,n.scale)},e.blockAnimations.disposeUiStep_=function(t,n,o,r){var a=(new Date-o)/150;1<a?e.utils.dom.removeNode(t):(t.setAttribute("transform","translate("+(t.translateX_+(n?-1:1)*t.bBox_.width*r/2*a)+","+(t.translateY_+t.bBox_.height*r*a)+") scale("+(1-a)*r+")"),setTimeout(e.blockAnimations.disposeUiStep_,10,t,n,o,r))},e.blockAnimations.connectionUiEffect=function(t){var n=t.workspace,o=n.scale;if(n.getAudioManager().play("click"),!(1>o)){var r=n.getSvgXY(t.getSvgRoot());t.outputConnection?(r.x+=(t.RTL?3:-3)*o,r.y+=13*o):t.previousConnection&&(r.x+=(t.RTL?-23:23)*o,r.y+=3*o),t=e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{cx:r.x,cy:r.y,r:0,fill:"none",stroke:"#888","stroke-width":10},n.getParentSvg()),e.blockAnimations.connectionUiStep_(t,new Date,o)}},e.blockAnimations.connectionUiStep_=function(t,n,o){var r=(new Date-n)/150;1<r?e.utils.dom.removeNode(t):(t.setAttribute("r",25*r*o),t.style.opacity=1-r,e.blockAnimations.disconnectPid_=setTimeout(e.blockAnimations.connectionUiStep_,10,t,n,o))},e.blockAnimations.disconnectUiEffect=function(t){if(t.workspace.getAudioManager().play("disconnect"),!(1>t.workspace.scale)){var n=t.getHeightWidth().height;n=Math.atan(10/n)/Math.PI*180,t.RTL||(n*=-1),e.blockAnimations.disconnectUiStep_(t.getSvgRoot(),n,new Date)}},e.blockAnimations.disconnectUiStep_=function(t,n,o){var r=(new Date-o)/200;1<r?t.skew_="":(t.skew_="skewX("+Math.round(Math.sin(r*Math.PI*3)*(1-r)*n)+")",e.blockAnimations.disconnectGroup_=t,e.blockAnimations.disconnectPid_=setTimeout(e.blockAnimations.disconnectUiStep_,10,t,n,o)),t.setAttribute("transform",t.translate_+t.skew_)},e.blockAnimations.disconnectUiStop=function(){if(e.blockAnimations.disconnectGroup_){clearTimeout(e.blockAnimations.disconnectPid_);var t=e.blockAnimations.disconnectGroup_;t.skew_="",t.setAttribute("transform",t.translate_),e.blockAnimations.disconnectGroup_=null}},e.Events.BlockDrag=function(t,n,o){e.Events.BlockDrag.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.isStart=n,this.blocks=o},e.utils.object.inherits(e.Events.BlockDrag,e.Events.UiBase),e.Events.BlockDrag.prototype.type=e.Events.BLOCK_DRAG,e.Events.BlockDrag.prototype.toJson=function(){var t=e.Events.BlockDrag.superClass_.toJson.call(this);return t.isStart=this.isStart,t.blockId=this.blockId,t.blocks=this.blocks,t},e.Events.BlockDrag.prototype.fromJson=function(t){e.Events.BlockDrag.superClass_.fromJson.call(this,t),this.isStart=t.isStart,this.blockId=t.blockId,this.blocks=t.blocks},e.registry.register(e.registry.Type.EVENT,e.Events.BLOCK_DRAG,e.Events.BlockDrag),e.IBlockDragger=function(){},e.InsertionMarkerManager=function(t){this.topBlock_=e.selected=t,this.workspace_=t.workspace,this.lastMarker_=this.lastOnStack_=null,this.firstMarker_=this.createMarkerBlock_(this.topBlock_),this.localConnection_=this.closestConnection_=null,this.wouldDeleteBlock_=!1,this.fadedBlock_=this.highlightedBlock_=this.markerConnection_=null,this.availableConnections_=this.initAvailableConnections_()},e.InsertionMarkerManager.PREVIEW_TYPE={INSERTION_MARKER:0,INPUT_OUTLINE:1,REPLACEMENT_FADE:2},e.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",e.InsertionMarkerManager.prototype.dispose=function(){this.availableConnections_.length=0,e.Events.disable();try{this.firstMarker_&&this.firstMarker_.dispose(),this.lastMarker_&&this.lastMarker_.dispose()}finally{e.Events.enable()}},e.InsertionMarkerManager.prototype.updateAvailableConnections=function(){this.availableConnections_=this.initAvailableConnections_()},e.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},e.InsertionMarkerManager.prototype.wouldConnectBlock=function(){return!!this.closestConnection_},e.InsertionMarkerManager.prototype.applyConnections=function(){if(this.closestConnection_&&(e.Events.disable(),this.hidePreview_(),e.Events.enable(),this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered)){var t=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;e.blockAnimations.connectionUiEffect(t.getSourceBlock()),this.topBlock_.getRootBlock().bringToFront()}},e.InsertionMarkerManager.prototype.update=function(t,n){var o=this.getCandidate_(t);((this.wouldDeleteBlock_=this.shouldDelete_(o,n))||this.shouldUpdatePreviews_(o,t))&&(e.Events.disable(),this.maybeHidePreview_(o),this.maybeShowPreview_(o),e.Events.enable())},e.InsertionMarkerManager.prototype.createMarkerBlock_=function(t){var n=t.type;e.Events.disable();try{var o=this.workspace_.newBlock(n);if(o.setInsertionMarker(!0),t.mutationToDom){var r=t.mutationToDom();r&&o.domToMutation(r)}for(n=0;n<t.inputList.length;n++){var a=t.inputList[n];if(a.name!=e.constants.COLLAPSED_INPUT_NAME){var h=o.inputList[n];if(!h)throw Error(e.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","an input"));for(r=0;r<a.fieldRow.length;r++){var R=a.fieldRow[r],L=h.fieldRow[r];if(!L)throw Error(e.InsertionMarkerManager.DUPLICATE_BLOCK_ERROR.replace("%1","a field"));L.setValue(R.getValue())}}}o.setCollapsed(t.isCollapsed()),o.setInputsInline(t.getInputsInline()),o.initSvg(),o.getSvgRoot().setAttribute("visibility","hidden")}finally{e.Events.enable()}return o},e.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var t=this.topBlock_.getConnections_(!1),n=this.topBlock_.lastConnectionInStack(!0);if(n&&n!=this.topBlock_.nextConnection){if(t.push(n),this.lastOnStack_=n,this.lastMarker_){e.Events.disable();try{this.lastMarker_.dispose()}finally{e.Events.enable()}}this.lastMarker_=this.createMarkerBlock_(n.getSourceBlock())}return t},e.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(t,n){var o=t.local,r=t.closest;return t=t.radius,o&&r?this.localConnection_&&this.closestConnection_?!(this.closestConnection_==r&&this.localConnection_==o||(o=this.localConnection_.x+n.x-this.closestConnection_.x,n=this.localConnection_.y+n.y-this.closestConnection_.y,n=Math.sqrt(o*o+n*n),r&&t>n-e.CURRENT_CONNECTION_PREFERENCE)):!this.localConnection_&&!this.closestConnection_||(console.error("Only one of localConnection_ and closestConnection_ was set."),console.error("Returning true from shouldUpdatePreviews, but it's not clear why."),!0):!(!this.localConnection_||!this.closestConnection_)},e.InsertionMarkerManager.prototype.getCandidate_=function(t){for(var n=this.getStartRadius_(),o=null,r=null,a=0;a<this.availableConnections_.length;a++){var h=this.availableConnections_[a],R=h.closest(n,t);R.connection&&(o=R.connection,r=h,n=R.radius)}return{closest:o,local:r,radius:n}},e.InsertionMarkerManager.prototype.getStartRadius_=function(){return this.closestConnection_&&this.localConnection_?e.CONNECTING_SNAP_RADIUS:e.SNAP_RADIUS},e.InsertionMarkerManager.prototype.shouldDelete_=function(t,n){return!(!n||!this.workspace_.getComponentManager().hasCapability(n.id,e.ComponentManager.Capability.DELETE_AREA))&&n.wouldDelete(this.topBlock_,t&&!!t.closest)},e.InsertionMarkerManager.prototype.maybeShowPreview_=function(t){if(!this.wouldDeleteBlock_){var n=t.closest;t=t.local,n&&(n==this.closestConnection_||n.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.closestConnection_=n,this.localConnection_=t,this.showPreview_()))}},e.InsertionMarkerManager.prototype.showPreview_=function(){var t=this.closestConnection_,n=this.workspace_.getRenderer();switch(n.getConnectionPreviewMethod(t,this.localConnection_,this.topBlock_)){case e.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline_();break;case e.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker_();break;case e.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade_()}t&&n.shouldHighlightConnection(t)&&t.highlight()},e.InsertionMarkerManager.prototype.maybeHidePreview_=function(t){if(t.closest){var n=this.closestConnection_!=t.closest;t=this.localConnection_!=t.local,this.closestConnection_&&this.localConnection_&&(n||t||this.wouldDeleteBlock_)&&this.hidePreview_()}else this.hidePreview_();this.localConnection_=this.closestConnection_=this.markerConnection_=null},e.InsertionMarkerManager.prototype.hidePreview_=function(){this.closestConnection_&&this.closestConnection_.targetBlock()&&this.workspace_.getRenderer().shouldHighlightConnection(this.closestConnection_)&&this.closestConnection_.unhighlight(),this.fadedBlock_?this.hideReplacementFade_():this.highlightedBlock_?this.hideInsertionInputOutline_():this.markerConnection_&&this.hideInsertionMarker_()},e.InsertionMarkerManager.prototype.showInsertionMarker_=function(){var t=this.localConnection_,n=this.closestConnection_,o=this.lastOnStack_&&t==this.lastOnStack_?this.lastMarker_:this.firstMarker_;if((t=o.getMatchingConnection(t.getSourceBlock(),t))==this.markerConnection_)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");o.render(),o.rendered=!0,o.getSvgRoot().setAttribute("visibility","visible"),t&&n&&o.positionNearConnection(t,n),n&&t.connect(n),this.markerConnection_=t},e.InsertionMarkerManager.prototype.hideInsertionMarker_=function(){if(this.markerConnection_){var t=this.markerConnection_,n=t.getSourceBlock(),o=n.nextConnection,r=n.previousConnection,a=n.outputConnection;if(a=t.type==e.connectionTypes.INPUT_VALUE&&!(a&&a.targetConnection),!(t!=o||r&&r.targetConnection)||a?t.targetBlock().unplug(!1):t.type==e.connectionTypes.NEXT_STATEMENT&&t!=o?((o=t.targetConnection).getSourceBlock().unplug(!1),r=r?r.targetConnection:null,n.unplug(!0),r&&r.connect(o)):n.unplug(!0),t.targetConnection)throw Error("markerConnection_ still connected at the end of disconnectInsertionMarker");this.markerConnection_=null,(t=n.getSvgRoot())&&t.setAttribute("visibility","hidden")}else console.log("No insertion marker connection to disconnect")},e.InsertionMarkerManager.prototype.showInsertionInputOutline_=function(){var t=this.closestConnection_;this.highlightedBlock_=t.getSourceBlock(),this.highlightedBlock_.highlightShapeForInput(t,!0)},e.InsertionMarkerManager.prototype.hideInsertionInputOutline_=function(){this.highlightedBlock_.highlightShapeForInput(this.closestConnection_,!1),this.highlightedBlock_=null},e.InsertionMarkerManager.prototype.showReplacementFade_=function(){this.fadedBlock_=this.closestConnection_.targetBlock(),this.fadedBlock_.fadeForReplacement(!0)},e.InsertionMarkerManager.prototype.hideReplacementFade_=function(){this.fadedBlock_.fadeForReplacement(!1),this.fadedBlock_=null},e.InsertionMarkerManager.prototype.getInsertionMarkers=function(){var t=[];return this.firstMarker_&&t.push(this.firstMarker_),this.lastMarker_&&t.push(this.lastMarker_),t},e.BlockDragger=function(t,n){this.draggingBlock_=t,this.workspace_=n,this.draggedConnectionManager_=new e.InsertionMarkerManager(this.draggingBlock_),this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=e.BlockDragger.initIconData_(t)},e.BlockDragger.prototype.dispose=function(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()},e.BlockDragger.initIconData_=function(t){var n=[];t=t.getDescendants(!1);for(var r,o=0;r=t[o];o++){r=r.getIcons();for(var a=0;a<r.length;a++){var h={location:r[a].getIconLocation(),icon:r[a]};n.push(h)}}return n},e.BlockDragger.prototype.startDrag=function(t,n){e.Events.getGroup()||e.Events.setGroup(!0),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),e.utils.dom.startTextWidthCache(),this.workspace_.setResizesEnabled(!1),e.blockAnimations.disconnectUiStop(),this.shouldDisconnect_(n)&&this.disconnectBlock_(n,t),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface()},e.BlockDragger.prototype.shouldDisconnect_=function(t){return!!(this.draggingBlock_.getParent()||t&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())},e.BlockDragger.prototype.disconnectBlock_=function(t,n){this.draggingBlock_.unplug(t),t=this.pixelsToWorkspaceUnits_(n),t=e.utils.Coordinate.sum(this.startXY_,t),this.draggingBlock_.translate(t.x,t.y),e.blockAnimations.disconnectUiEffect(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()},e.BlockDragger.prototype.fireDragStartEvent_=function(){var t=new(e.Events.get(e.Events.BLOCK_DRAG))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));e.Events.fire(t)},e.BlockDragger.prototype.drag=function(t,n){n=this.pixelsToWorkspaceUnits_(n);var o=e.utils.Coordinate.sum(this.startXY_,n);this.draggingBlock_.moveDuringDrag(o),this.dragIcons_(n),o=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(t),this.draggedConnectionManager_.update(n,this.dragTarget_),t=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock(),t!=this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==o&&(o&&o.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)},e.BlockDragger.prototype.endDrag=function(t,n){if(this.drag(t,n),this.dragIconData_=[],this.fireDragEndEvent_(),e.utils.dom.stopTextWidthCache(),e.blockAnimations.disconnectUiStop(),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_))t=this.startXY_;else{var o=(t=this.getNewLocationAfterDrag_(n)).delta;t=t.newLocation}this.draggingBlock_.moveOffDragSurface(t),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(!1),o?this.updateBlockAfterMove_(o):e.bumpObjectIntoBounds_(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)),this.workspace_.setResizesEnabled(!0),e.Events.setGroup(!1)},e.BlockDragger.prototype.getNewLocationAfterDrag_=function(t){var n={};return n.delta=this.pixelsToWorkspaceUnits_(t),n.newLocation=e.utils.Coordinate.sum(this.startXY_,n.delta),n},e.BlockDragger.prototype.maybeDeleteBlock_=function(){return!!this.wouldDeleteBlock_&&(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),e.draggingConnections=[],!0)},e.BlockDragger.prototype.updateBlockAfterMove_=function(t){this.draggingBlock_.moveConnections(t.x,t.y),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()},e.BlockDragger.prototype.fireDragEndEvent_=function(){var t=new(e.Events.get(e.Events.BLOCK_DRAG))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));e.Events.fire(t)},e.BlockDragger.prototype.updateToolboxStyle_=function(t){var n=this.workspace_.getToolbox();if(n){var o=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";t&&"function"==typeof n.removeStyle?n.removeStyle(o):t||"function"!=typeof n.addStyle||n.addStyle(o)}},e.BlockDragger.prototype.fireMoveEvent_=function(){var t=new(e.Events.get(e.Events.BLOCK_MOVE))(this.draggingBlock_);t.oldCoordinate=this.startXY_,t.recordNew(),e.Events.fire(t)},e.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)},e.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new e.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},e.BlockDragger.prototype.dragIcons_=function(t){for(var n=0;n<this.dragIconData_.length;n++){var o=this.dragIconData_[n];o.icon.setIconLocation(e.utils.Coordinate.sum(o.location,t))}},e.BlockDragger.prototype.getInsertionMarkers=function(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]},e.registry.register(e.registry.Type.BLOCK_DRAGGER,e.registry.DEFAULT,e.BlockDragger),e.IContextMenu=function(){},e.IDraggable=function(){},e.IBubble=function(){},e.Bubble=function(t,n,o,r,a,h){this.workspace_=t,this.content_=n,this.shape_=o,this.onMouseDownResizeWrapper_=this.onMouseDownBubbleWrapper_=this.moveCallback_=this.resizeCallback_=null,this.disposed=!1,o=e.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(o=-o),this.arrow_radians_=e.utils.math.toRadians(o),t.getBubbleCanvas().appendChild(this.createDom_(n,!(!a||!h))),this.setAnchorLocation(r),a&&h||(a=(t=this.content_.getBBox()).width+2*e.Bubble.BORDER_WIDTH,h=t.height+2*e.Bubble.BORDER_WIDTH),this.setBubbleSize(a,h),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0},e.Bubble.BORDER_WIDTH=6,e.Bubble.ARROW_THICKNESS=5,e.Bubble.ARROW_ANGLE=20,e.Bubble.ARROW_BEND=4,e.Bubble.ANCHOR_RADIUS=8,e.Bubble.onMouseUpWrapper_=null,e.Bubble.onMouseMoveWrapper_=null,e.Bubble.unbindDragEvents_=function(){e.Bubble.onMouseUpWrapper_&&(e.browserEvents.unbind(e.Bubble.onMouseUpWrapper_),e.Bubble.onMouseUpWrapper_=null),e.Bubble.onMouseMoveWrapper_&&(e.browserEvents.unbind(e.Bubble.onMouseMoveWrapper_),e.Bubble.onMouseMoveWrapper_=null)},e.Bubble.bubbleMouseUp_=function(t){e.Touch.clearTouchIdentifier(),e.Bubble.unbindDragEvents_()},e.Bubble.prototype.rendered_=!1,e.Bubble.prototype.anchorXY_=null,e.Bubble.prototype.relativeLeft_=0,e.Bubble.prototype.relativeTop_=0,e.Bubble.prototype.width_=0,e.Bubble.prototype.height_=0,e.Bubble.prototype.autoLayout_=!0,e.Bubble.prototype.createDom_=function(t,n){this.bubbleGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null);var o={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return e.utils.userAgent.JAVA_FX&&(o={}),o=e.utils.dom.createSvgElement(e.utils.Svg.G,o,this.bubbleGroup_),this.bubbleArrow_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{},o),this.bubbleBack_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyDraggable",x:0,y:0,rx:e.Bubble.BORDER_WIDTH,ry:e.Bubble.BORDER_WIDTH},o),n?(this.resizeGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),e.utils.dom.createSvgElement(e.utils.Svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,(n=2*e.Bubble.BORDER_WIDTH).toString())},this.resizeGroup_),e.utils.dom.createSvgElement(e.utils.Svg.LINE,{class:"blocklyResizeLine",x1:n/3,y1:n-1,x2:n-1,y2:n/3},this.resizeGroup_),e.utils.dom.createSvgElement(e.utils.Svg.LINE,{class:"blocklyResizeLine",x1:2*n/3,y1:n-1,x2:n-1,y2:2*n/3},this.resizeGroup_)):this.resizeGroup_=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper_=e.browserEvents.conditionalBind(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&(this.onMouseDownResizeWrapper_=e.browserEvents.conditionalBind(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))),this.bubbleGroup_.appendChild(t),this.bubbleGroup_},e.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_},e.Bubble.prototype.setSvgId=function(t){this.bubbleGroup_.dataset&&(this.bubbleGroup_.dataset.blockId=t)},e.Bubble.prototype.bubbleMouseDown_=function(t){var n=this.workspace_.getGesture(t);n&&n.handleBubbleStart(t,this)},e.Bubble.prototype.showContextMenu=function(t){},e.Bubble.prototype.isDeletable=function(){return!1},e.Bubble.prototype.setDeleteStyle=function(t){},e.Bubble.prototype.resizeMouseDown_=function(t){this.promote(),e.Bubble.unbindDragEvents_(),e.utils.isRightButton(t)||(this.workspace_.startDrag(t,new e.utils.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),e.Bubble.onMouseUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",this,e.Bubble.bubbleMouseUp_),e.Bubble.onMouseMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",this,this.resizeMouseMove_),e.hideChaff()),t.stopPropagation()},e.Bubble.prototype.resizeMouseMove_=function(t){this.autoLayout_=!1,t=this.workspace_.moveDrag(t),this.setBubbleSize(this.workspace_.RTL?-t.x:t.x,t.y),this.workspace_.RTL&&this.positionBubble_()},e.Bubble.prototype.registerResizeEvent=function(t){this.resizeCallback_=t},e.Bubble.prototype.registerMoveEvent=function(t){this.moveCallback_=t},e.Bubble.prototype.promote=function(){var t=this.bubbleGroup_.parentNode;return t.lastChild!==this.bubbleGroup_&&(t.appendChild(this.bubbleGroup_),!0)},e.Bubble.prototype.setAnchorLocation=function(t){this.anchorXY_=t,this.rendered_&&this.positionBubble_()},e.Bubble.prototype.layoutBubble_=function(){var t=this.workspace_.getMetricsManager().getViewMetrics(!0),n=this.getOptimalRelativeLeft_(t),o=this.getOptimalRelativeTop_(t),r=this.shape_.getBBox(),a={x:n,y:-this.height_-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},h={x:-this.width_-30,y:o};o={x:r.width,y:o};var R={x:n,y:r.height};n=r.width<r.height?o:R,r=r.width<r.height?R:o,o=this.getOverlap_(a,t),R=this.getOverlap_(h,t);var L=this.getOverlap_(n,t);t=this.getOverlap_(r,t),o==(t=Math.max(o,R,L,t))?(this.relativeLeft_=a.x,this.relativeTop_=a.y):R==t?(this.relativeLeft_=h.x,this.relativeTop_=h.y):L==t?(this.relativeLeft_=n.x,this.relativeTop_=n.y):(this.relativeLeft_=r.x,this.relativeTop_=r.y)},e.Bubble.prototype.getOverlap_=function(t,n){var o=this.workspace_.RTL?this.anchorXY_.x-t.x-this.width_:t.x+this.anchorXY_.x;return t=t.y+this.anchorXY_.y,Math.max(0,Math.min(1,(Math.min(o+this.width_,n.left+n.width)-Math.max(o,n.left))*(Math.min(t+this.height_,n.top+n.height)-Math.max(t,n.top))/(this.width_*this.height_)))},e.Bubble.prototype.getOptimalRelativeLeft_=function(t){var n=-this.width_/4;if(this.width_>t.width)return n;if(this.workspace_.RTL)var o=this.anchorXY_.x-n,r=o-this.width_,a=t.left+t.width,h=t.left+e.Scrollbar.scrollbarThickness/this.workspace_.scale;else o=(r=n+this.anchorXY_.x)+this.width_,h=t.left,a=t.left+t.width-e.Scrollbar.scrollbarThickness/this.workspace_.scale;return this.workspace_.RTL?r<h?n=-(h-this.anchorXY_.x+this.width_):o>a&&(n=-(a-this.anchorXY_.x)):r<h?n=h-this.anchorXY_.x:o>a&&(n=a-this.anchorXY_.x-this.width_),n},e.Bubble.prototype.getOptimalRelativeTop_=function(t){var n=-this.height_/4;if(this.height_>t.height)return n;var o=this.anchorXY_.y+n,a=t.top;t=t.top+t.height-e.Scrollbar.scrollbarThickness/this.workspace_.scale;var h=this.anchorXY_.y;return o<a?n=a-h:o+this.height_>t&&(n=t-h-this.height_),n},e.Bubble.prototype.positionBubble_=function(){var t=this.anchorXY_.x;this.moveTo(t=this.workspace_.RTL?t-(this.relativeLeft_+this.width_):t+this.relativeLeft_,this.relativeTop_+this.anchorXY_.y)},e.Bubble.prototype.moveTo=function(t,n){this.bubbleGroup_.setAttribute("transform","translate("+t+","+n+")")},e.Bubble.prototype.setDragging=function(t){!t&&this.moveCallback_&&this.moveCallback_()},e.Bubble.prototype.getBubbleSize=function(){return new e.utils.Size(this.width_,this.height_)},e.Bubble.prototype.setBubbleSize=function(t,n){var o=2*e.Bubble.BORDER_WIDTH;t=Math.max(t,o+45),n=Math.max(n,o+20),this.width_=t,this.height_=n,this.bubbleBack_.setAttribute("width",t),this.bubbleBack_.setAttribute("height",n),this.resizeGroup_&&this.resizeGroup_.setAttribute("transform",this.workspace_.RTL?"translate("+2*e.Bubble.BORDER_WIDTH+","+(n-o)+") scale(-1 1)":"translate("+(t-o)+","+(n-o)+")"),this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_(),this.resizeCallback_&&this.resizeCallback_()},e.Bubble.prototype.renderArrow_=function(){var t=[],n=this.width_/2,o=this.height_/2,r=-this.relativeLeft_,a=-this.relativeTop_;if(n==r&&o==a)t.push("M "+n+","+o);else{a-=o,r-=n,this.workspace_.RTL&&(r*=-1);var h=Math.sqrt(a*a+r*r),R=Math.acos(r/h);0>a&&(R=2*Math.PI-R);var L=R+Math.PI/2;L>2*Math.PI&&(L-=2*Math.PI);var W=Math.sin(L),nt=Math.cos(L),et=this.getBubbleSize();L=(et.width+et.height)/e.Bubble.ARROW_THICKNESS,L=Math.min(L,et.width,et.height)/4,r=n+(et=1-e.Bubble.ANCHOR_RADIUS/h)*r,a=o+et*a,et=n+L*nt;var Et=o+L*W;n-=L*nt,o-=L*W,(W=R+this.arrow_radians_)>2*Math.PI&&(W-=2*Math.PI),R=Math.sin(W)*h/e.Bubble.ARROW_BEND,h=Math.cos(W)*h/e.Bubble.ARROW_BEND,t.push("M"+et+","+Et),t.push("C"+(et+h)+","+(Et+R)+" "+r+","+a+" "+r+","+a),t.push("C"+r+","+a+" "+(n+h)+","+(o+R)+" "+n+","+o)}t.push("z"),this.bubbleArrow_.setAttribute("d",t.join(" "))},e.Bubble.prototype.setColour=function(t){this.bubbleBack_.setAttribute("fill",t),this.bubbleArrow_.setAttribute("fill",t)},e.Bubble.prototype.dispose=function(){this.onMouseDownBubbleWrapper_&&e.browserEvents.unbind(this.onMouseDownBubbleWrapper_),this.onMouseDownResizeWrapper_&&e.browserEvents.unbind(this.onMouseDownResizeWrapper_),e.Bubble.unbindDragEvents_(),e.utils.dom.removeNode(this.bubbleGroup_),this.disposed=!0},e.Bubble.prototype.moveDuringDrag=function(t,n){t?t.translateSurface(n.x,n.y):this.moveTo(n.x,n.y),this.relativeLeft_=this.workspace_.RTL?this.anchorXY_.x-n.x-this.width_:n.x-this.anchorXY_.x,this.relativeTop_=n.y-this.anchorXY_.y,this.renderArrow_()},e.Bubble.prototype.getRelativeToSurfaceXY=function(){return new e.utils.Coordinate(this.workspace_.RTL?-this.relativeLeft_+this.anchorXY_.x-this.width_:this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)},e.Bubble.prototype.setAutoLayout=function(t){this.autoLayout_=t},e.Bubble.textToDom=function(t){var n=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:e.Bubble.BORDER_WIDTH},null);t=t.split("\n");for(var o=0;o<t.length;o++){var r=e.utils.dom.createSvgElement(e.utils.Svg.TSPAN,{dy:"1em",x:e.Bubble.BORDER_WIDTH},n),a=document.createTextNode(t[o]);r.appendChild(a)}return n},e.Bubble.createNonEditableBubble=function(t,n,o){if((o=new e.Bubble(n.workspace,t,n.pathObject.svgPath,o,null,null)).setSvgId(n.id),n.RTL){n=t.getBBox().width;for(var a,r=0;a=t.childNodes[r];r++)a.setAttribute("text-anchor","end"),a.setAttribute("x",n+e.Bubble.BORDER_WIDTH)}return o},e.Events.CommentBase=function(t){this.commentId=(this.isBlank=void 0===t)?"":t.id,this.workspaceId=this.isBlank?"":t.workspace.id,this.group=e.Events.getGroup(),this.recordUndo=e.Events.recordUndo},e.utils.object.inherits(e.Events.CommentBase,e.Events.Abstract),e.Events.CommentBase.prototype.toJson=function(){var t=e.Events.CommentBase.superClass_.toJson.call(this);return this.commentId&&(t.commentId=this.commentId),t},e.Events.CommentBase.prototype.fromJson=function(t){e.Events.CommentBase.superClass_.fromJson.call(this,t),this.commentId=t.commentId},e.Events.CommentChange=function(t,n,o){e.Events.CommentChange.superClass_.constructor.call(this,t),t&&(this.oldContents_=void 0===n?"":n,this.newContents_=void 0===o?"":o)},e.utils.object.inherits(e.Events.CommentChange,e.Events.CommentBase),e.Events.CommentChange.prototype.type=e.Events.COMMENT_CHANGE,e.Events.CommentChange.prototype.toJson=function(){var t=e.Events.CommentChange.superClass_.toJson.call(this);return t.oldContents=this.oldContents_,t.newContents=this.newContents_,t},e.Events.CommentChange.prototype.fromJson=function(t){e.Events.CommentChange.superClass_.fromJson.call(this,t),this.oldContents_=t.oldContents,this.newContents_=t.newContents},e.Events.CommentChange.prototype.isNull=function(){return this.oldContents_==this.newContents_},e.Events.CommentChange.prototype.run=function(t){var n=this.getEventWorkspace_().getCommentById(this.commentId);n?n.setContent(t?this.newContents_:this.oldContents_):console.warn("Can't change non-existent comment: "+this.commentId)},e.Events.CommentCreate=function(t){e.Events.CommentCreate.superClass_.constructor.call(this,t),t&&(this.xml=t.toXmlWithXY())},e.utils.object.inherits(e.Events.CommentCreate,e.Events.CommentBase),e.Events.CommentCreate.prototype.type=e.Events.COMMENT_CREATE,e.Events.CommentCreate.prototype.toJson=function(){var t=e.Events.CommentCreate.superClass_.toJson.call(this);return t.xml=e.Xml.domToText(this.xml),t},e.Events.CommentCreate.prototype.fromJson=function(t){e.Events.CommentCreate.superClass_.fromJson.call(this,t),this.xml=e.Xml.textToDom(t.xml)},e.Events.CommentCreate.prototype.run=function(t){e.Events.CommentCreateDeleteHelper(this,t)},e.Events.CommentCreateDeleteHelper=function(t,n){var o=t.getEventWorkspace_();n?((n=e.utils.xml.createElement("xml")).appendChild(t.xml),e.Xml.domToWorkspace(n,o)):(o=o.getCommentById(t.commentId))?o.dispose(!1,!1):console.warn("Can't uncreate non-existent comment: "+t.commentId)},e.Events.CommentDelete=function(t){e.Events.CommentDelete.superClass_.constructor.call(this,t),t&&(this.xml=t.toXmlWithXY())},e.utils.object.inherits(e.Events.CommentDelete,e.Events.CommentBase),e.Events.CommentDelete.prototype.type=e.Events.COMMENT_DELETE,e.Events.CommentDelete.prototype.toJson=function(){return e.Events.CommentDelete.superClass_.toJson.call(this)},e.Events.CommentDelete.prototype.fromJson=function(t){e.Events.CommentDelete.superClass_.fromJson.call(this,t)},e.Events.CommentDelete.prototype.run=function(t){e.Events.CommentCreateDeleteHelper(this,!t)},e.Events.CommentMove=function(t){e.Events.CommentMove.superClass_.constructor.call(this,t),t&&(this.comment_=t,this.oldCoordinate_=t.getXY(),this.newCoordinate_=null)},e.utils.object.inherits(e.Events.CommentMove,e.Events.CommentBase),e.Events.CommentMove.prototype.recordNew=function(){if(!this.comment_)throw Error("Tried to record the new position of a comment on the same event twice.");this.newCoordinate_=this.comment_.getXY(),this.comment_=null},e.Events.CommentMove.prototype.type=e.Events.COMMENT_MOVE,e.Events.CommentMove.prototype.setOldCoordinate=function(t){this.oldCoordinate_=t},e.Events.CommentMove.prototype.toJson=function(){var t=e.Events.CommentMove.superClass_.toJson.call(this);return this.oldCoordinate_&&(t.oldCoordinate=Math.round(this.oldCoordinate_.x)+","+Math.round(this.oldCoordinate_.y)),this.newCoordinate_&&(t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y)),t},e.Events.CommentMove.prototype.fromJson=function(t){if(e.Events.CommentMove.superClass_.fromJson.call(this,t),t.oldCoordinate){var n=t.oldCoordinate.split(",");this.oldCoordinate_=new e.utils.Coordinate(Number(n[0]),Number(n[1]))}t.newCoordinate&&(n=t.newCoordinate.split(","),this.newCoordinate_=new e.utils.Coordinate(Number(n[0]),Number(n[1])))},e.Events.CommentMove.prototype.isNull=function(){return e.utils.Coordinate.equals(this.oldCoordinate_,this.newCoordinate_)},e.Events.CommentMove.prototype.run=function(t){var n=this.getEventWorkspace_().getCommentById(this.commentId);if(n){t=t?this.newCoordinate_:this.oldCoordinate_;var o=n.getXY();n.moveBy(t.x-o.x,t.y-o.y)}else console.warn("Can't move non-existent comment: "+this.commentId)},e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_CREATE,e.Events.CommentCreate),e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_CHANGE,e.Events.CommentChange),e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_MOVE,e.Events.CommentMove),e.registry.register(e.registry.Type.EVENT,e.Events.COMMENT_DELETE,e.Events.CommentDelete),e.BubbleDragger=function(t,n){this.draggingBubble_=t,this.workspace_=n,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY(),this.dragSurface_=e.utils.is3dSupported()&&n.getBlockDragSurface()?n.getBlockDragSurface():null},e.BubbleDragger.prototype.dispose=function(){this.dragSurface_=this.workspace_=this.draggingBubble_=null},e.BubbleDragger.prototype.startBubbleDrag=function(){e.Events.getGroup()||e.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),this.draggingBubble_.setAutoLayout(!1),this.dragSurface_&&this.moveToDragSurface_(),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!0)},e.BubbleDragger.prototype.dragBubble=function(t,n){n=this.pixelsToWorkspaceUnits_(n),n=e.utils.Coordinate.sum(this.startXY_,n),this.draggingBubble_.moveDuringDrag(this.dragSurface_,n),n=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(t),t=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),t!=this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==n&&(n&&n.onDragExit(this.draggingBubble_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBubble_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBubble_)},e.BubbleDragger.prototype.shouldDelete_=function(t){return!(!t||!this.workspace_.getComponentManager().hasCapability(t.id,e.ComponentManager.Capability.DELETE_AREA))&&t.wouldDelete(this.draggingBubble_,!1)},e.BubbleDragger.prototype.updateCursorDuringBubbleDrag_=function(){this.draggingBubble_.setDeleteStyle(this.wouldDeleteBubble_)},e.BubbleDragger.prototype.endBubbleDrag=function(t,n){this.dragBubble(t,n),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBubble_)?t=this.startXY_:(t=this.pixelsToWorkspaceUnits_(n),t=e.utils.Coordinate.sum(this.startXY_,t)),this.draggingBubble_.moveTo(t.x,t.y),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBubble_),this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.draggingBubble_.dispose(!1,!0)):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas()),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!1),this.fireMoveEvent_()),this.workspace_.setResizesEnabled(!0),e.Events.setGroup(!1)},e.BubbleDragger.prototype.fireMoveEvent_=function(){if(this.draggingBubble_.isComment){var t=new(e.Events.get(e.Events.COMMENT_MOVE))(this.draggingBubble_);t.setOldCoordinate(this.startXY_),t.recordNew(),e.Events.fire(t)}},e.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new e.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},e.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())},e.Events.Click=function(t,n,o){e.Events.Click.superClass_.constructor.call(this,t?t.workspace.id:n),this.blockId=t?t.id:null,this.targetType=o},e.utils.object.inherits(e.Events.Click,e.Events.UiBase),e.Events.Click.prototype.type=e.Events.CLICK,e.Events.Click.prototype.toJson=function(){var t=e.Events.Click.superClass_.toJson.call(this);return t.targetType=this.targetType,this.blockId&&(t.blockId=this.blockId),t},e.Events.Click.prototype.fromJson=function(t){e.Events.Click.superClass_.fromJson.call(this,t),this.targetType=t.targetType,this.blockId=t.blockId},e.registry.register(e.registry.Type.EVENT,e.Events.CLICK,e.Events.Click),e.WorkspaceDragger=function(t){this.workspace_=t,this.horizontalScrollEnabled_=this.workspace_.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace_.isMovableVertically(),this.startScrollXY_=new e.utils.Coordinate(t.scrollX,t.scrollY)},e.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},e.WorkspaceDragger.prototype.startDrag=function(){e.selected&&e.selected.unselect(),this.workspace_.setupDragSurface()},e.WorkspaceDragger.prototype.endDrag=function(t){this.drag(t),this.workspace_.resetDragSurface()},e.WorkspaceDragger.prototype.drag=function(t){if(t=e.utils.Coordinate.sum(this.startScrollXY_,t),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace_.scroll(t.x,t.y);else if(this.horizontalScrollEnabled_)this.workspace_.scroll(t.x,this.workspace_.scrollY);else{if(!this.verticalScrollEnabled_)throw new TypeError("Invalid state.");this.workspace_.scroll(this.workspace_.scrollX,t.y)}},e.Gesture=function(t,n){this.mouseDownXY_=null,this.currentDragDeltaXY_=new e.utils.Coordinate(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.creatorWorkspace_=n,this.isDraggingBubble_=this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=t,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1,this.healStack_=!e.DRAG_STACK},e.Gesture.prototype.dispose=function(){e.Touch.clearTouchIdentifier(),e.Tooltip.unblock(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&e.browserEvents.unbind(this.onMoveWrapper_),this.onUpWrapper_&&e.browserEvents.unbind(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.bubbleDragger_&&this.bubbleDragger_.dispose()},e.Gesture.prototype.updateFromEvent_=function(t){var n=new e.utils.Coordinate(t.clientX,t.clientY);this.updateDragDelta_(n)&&(this.updateIsDragging_(),e.longStop_()),this.mostRecentEvent_=t},e.Gesture.prototype.updateDragDelta_=function(t){return this.currentDragDeltaXY_=e.utils.Coordinate.difference(t,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=e.utils.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?e.FLYOUT_DRAG_RADIUS:e.DRAG_RADIUS))},e.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(!this.targetBlock_||!this.flyout_.isBlockCreatable_(this.targetBlock_)||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),e.Events.getGroup()||e.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),0))},e.Gesture.prototype.updateIsDraggingBubble_=function(){return!!this.startBubble_&&(this.isDraggingBubble_=!0,this.startDraggingBubble_(),!0)},e.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},e.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=new e.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},e.Gesture.prototype.updateIsDragging_=function(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},e.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new(e.registry.getClassFromOptions(e.registry.Type.BLOCK_DRAGGER,this.creatorWorkspace_.options,!0))(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_)},e.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new e.BubbleDragger(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)},e.Gesture.prototype.doStart=function(t){e.utils.isTargetInput(t)?this.cancel():(this.hasStarted_=!0,e.blockAnimations.disconnectUiStop(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),e.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=t,e.Tooltip.block(),this.targetBlock_&&this.targetBlock_.select(),e.utils.isRightButton(t)?this.handleRightClick(t):("touchstart"!=t.type.toLowerCase()&&"pointerdown"!=t.type.toLowerCase()||"mouse"==t.pointerType||e.longStart(t,this),this.mouseDownXY_=new e.utils.Coordinate(t.clientX,t.clientY),this.healStack_=t.altKey||t.ctrlKey||t.metaKey,this.bindMouseEvents(t)))},e.Gesture.prototype.bindMouseEvents=function(t){this.onMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",null,this.handleUp.bind(this)),t.preventDefault(),t.stopPropagation()},e.Gesture.prototype.handleMove=function(t){this.updateFromEvent_(t),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBubble_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),t.preventDefault(),t.stopPropagation()},e.Gesture.prototype.handleUp=function(t){this.updateFromEvent_(t),e.longStop_(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(t,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(t,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(t),t.preventDefault(),t.stopPropagation(),this.dispose())},e.Gesture.prototype.cancel=function(){this.isEnding_||(e.longStop_(),this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},e.Gesture.prototype.handleRightClick=function(t){this.targetBlock_?(this.bringBlockToFront_(),e.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(t)):this.startBubble_?this.startBubble_.showContextMenu(t):this.startWorkspace_&&!this.flyout_&&(e.hideChaff(),this.startWorkspace_.showContextMenu(t)),t.preventDefault(),t.stopPropagation(),this.dispose()},e.Gesture.prototype.handleWsStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(n),this.mostRecentEvent_=t,this.doStart(t)},e.Gesture.prototype.fireWorkspaceClick_=function(t){e.Events.fire(new(e.Events.get(e.Events.CLICK))(null,t.id,"workspace"))},e.Gesture.prototype.handleFlyoutStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(n),this.handleWsStart(t,n.getWorkspace())},e.Gesture.prototype.handleBlockStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(n),this.mostRecentEvent_=t},e.Gesture.prototype.handleBubbleStart=function(t,n){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(n),this.mostRecentEvent_=t},e.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.setFocus&&this.startBubble_.setFocus(),this.startBubble_.select&&this.startBubble_.select()},e.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()},e.Gesture.prototype.doBlockClick_=function(){if(this.flyout_&&this.flyout_.autoClose)this.targetBlock_.isEnabled()&&(e.Events.getGroup()||e.Events.setGroup(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump());else{var t=new(e.Events.get(e.Events.CLICK))(this.startBlock_,this.startWorkspace_.id,"block");e.Events.fire(t)}this.bringBlockToFront_(),e.Events.setGroup(!1)},e.Gesture.prototype.doWorkspaceClick_=function(t){t=this.creatorWorkspace_,e.selected&&e.selected.unselect(),this.fireWorkspaceClick_(this.startWorkspace_||t)},e.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},e.Gesture.prototype.setStartField=function(t){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=t)},e.Gesture.prototype.setStartBubble=function(t){this.startBubble_||(this.startBubble_=t)},e.Gesture.prototype.setStartBlock=function(t){this.startBlock_||this.startBubble_||(this.startBlock_=t,t.isInFlyout&&t!=t.getRootBlock()?this.setTargetBlock_(t.getRootBlock()):this.setTargetBlock_(t))},e.Gesture.prototype.setTargetBlock_=function(t){t.isShadow()?this.setTargetBlock_(t.getParent()):this.targetBlock_=t},e.Gesture.prototype.setStartWorkspace_=function(t){this.startWorkspace_||(this.startWorkspace_=t)},e.Gesture.prototype.setStartFlyout_=function(t){this.flyout_||(this.flyout_=t)},e.Gesture.prototype.isBubbleClick_=function(){return!!this.startBubble_&&!this.hasExceededDragRadius_},e.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},e.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isClickable()&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)},e.Gesture.prototype.isWorkspaceClick_=function(){return!(this.startBlock_||this.startBubble_||this.startField_||this.hasExceededDragRadius_)},e.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_},e.Gesture.prototype.hasStarted=function(){return this.hasStarted_},e.Gesture.prototype.getInsertionMarkers=function(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]},e.Gesture.prototype.getCurrentDragger=function(){return this.isDraggingBlock_?this.blockDragger_:this.isDraggingWorkspace_?this.workspaceDragger_:this.isDraggingBubble_?this.bubbleDragger_:null},e.Gesture.inProgress=function(){for(var o,t=e.Workspace.getAll(),n=0;o=t[n];n++)if(o.currentGesture_)return!0;return!1},e.IRegistrable=function(){},e.Marker=function(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"},e.Marker.prototype.setDrawer=function(t){this.drawer_=t},e.Marker.prototype.getDrawer=function(){return this.drawer_},e.Marker.prototype.getCurNode=function(){return this.curNode_},e.Marker.prototype.setCurNode=function(t){var n=this.curNode_;this.curNode_=t,this.drawer_&&this.drawer_.draw(n,this.curNode_)},e.Marker.prototype.draw=function(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)},e.Marker.prototype.hide=function(){this.drawer_&&this.drawer_.hide()},e.Marker.prototype.dispose=function(){this.getDrawer()&&this.getDrawer().dispose()},e.Cursor=function(){e.Cursor.superClass_.constructor.call(this),this.type="cursor"},e.utils.object.inherits(e.Cursor,e.Marker),e.Cursor.prototype.next=function(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()==e.ASTNode.types.NEXT||t.getType()==e.ASTNode.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t},e.Cursor.prototype.in=function(){var t=this.getCurNode();return t?((t.getType()==e.ASTNode.types.PREVIOUS||t.getType()==e.ASTNode.types.OUTPUT)&&(t=t.next()),(t=t.in())&&this.setCurNode(t),t):null},e.Cursor.prototype.prev=function(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()==e.ASTNode.types.NEXT||t.getType()==e.ASTNode.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t},e.Cursor.prototype.out=function(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()==e.ASTNode.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null},e.registry.register(e.registry.Type.CURSOR,e.registry.DEFAULT,e.Cursor),e.MarkerManager=function(t){this.cursorSvg_=this.cursor_=null,this.markers_=Object.create(null),this.workspace_=t},e.MarkerManager.LOCAL_MARKER="local_marker_1",e.MarkerManager.prototype.registerMarker=function(t,n){this.markers_[t]&&this.unregisterMarker(t),n.setDrawer(this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,n)),this.setMarkerSvg(n.getDrawer().createDom()),this.markers_[t]=n},e.MarkerManager.prototype.unregisterMarker=function(t){var n=this.markers_[t];if(!n)throw Error("Marker with ID "+t+" does not exist. Can only unregister markers that exist.");n.dispose(),delete this.markers_[t]},e.MarkerManager.prototype.getCursor=function(){return this.cursor_},e.MarkerManager.prototype.getMarker=function(t){return this.markers_[t]||null},e.MarkerManager.prototype.setCursor=function(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(t=this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,this.cursor_),this.cursor_.setDrawer(t),this.setCursorSvg(this.cursor_.getDrawer().createDom()))},e.MarkerManager.prototype.setCursorSvg=function(t){t?(this.workspace_.getBlockCanvas().appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},e.MarkerManager.prototype.setMarkerSvg=function(t){t?this.workspace_.getBlockCanvas()&&(this.cursorSvg_?this.workspace_.getBlockCanvas().insertBefore(t,this.cursorSvg_):this.workspace_.getBlockCanvas().appendChild(t)):this.markerSvg_=null},e.MarkerManager.prototype.updateMarkers=function(){this.workspace_.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace_.getCursor().draw()},e.MarkerManager.prototype.dispose=function(){for(var o,t=Object.keys(this.markers_),n=0;o=t[n];n++)this.unregisterMarker(o);this.markers_=null,this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)},e.WidgetDiv={},e.WidgetDiv.owner_=null,e.WidgetDiv.dispose_=null,e.WidgetDiv.rendererClassName_="",e.WidgetDiv.themeClassName_="",e.WidgetDiv.createDom=function(){e.WidgetDiv.DIV||(e.WidgetDiv.DIV=document.createElement("div"),e.WidgetDiv.DIV.className="blocklyWidgetDiv",(e.parentContainer||document.body).appendChild(e.WidgetDiv.DIV))},e.WidgetDiv.show=function(t,n,o){e.WidgetDiv.hide(),e.WidgetDiv.owner_=t,e.WidgetDiv.dispose_=o,(t=e.WidgetDiv.DIV).style.direction=n?"rtl":"ltr",t.style.display="block",n=e.getMainWorkspace(),e.WidgetDiv.rendererClassName_=n.getRenderer().getClassName(),e.WidgetDiv.themeClassName_=n.getTheme().getClassName(),e.utils.dom.addClass(t,e.WidgetDiv.rendererClassName_),e.utils.dom.addClass(t,e.WidgetDiv.themeClassName_)},e.WidgetDiv.hide=function(){if(e.WidgetDiv.isVisible()){e.WidgetDiv.owner_=null;var t=e.WidgetDiv.DIV;t.style.display="none",t.style.left="",t.style.top="",e.WidgetDiv.dispose_&&e.WidgetDiv.dispose_(),e.WidgetDiv.dispose_=null,t.textContent="",e.WidgetDiv.rendererClassName_&&(e.utils.dom.removeClass(t,e.WidgetDiv.rendererClassName_),e.WidgetDiv.rendererClassName_=""),e.WidgetDiv.themeClassName_&&(e.utils.dom.removeClass(t,e.WidgetDiv.themeClassName_),e.WidgetDiv.themeClassName_=""),e.getMainWorkspace().markFocused()}},e.WidgetDiv.isVisible=function(){return!!e.WidgetDiv.owner_},e.WidgetDiv.hideIfOwner=function(t){e.WidgetDiv.owner_==t&&e.WidgetDiv.hide()},e.WidgetDiv.positionInternal_=function(t,n,o){e.WidgetDiv.DIV.style.left=t+"px",e.WidgetDiv.DIV.style.top=n+"px",e.WidgetDiv.DIV.style.height=o+"px"},e.WidgetDiv.positionWithAnchor=function(t,n,o,r){var a=e.WidgetDiv.calculateY_(t,n,o);t=e.WidgetDiv.calculateX_(t,n,o,r),0>a?e.WidgetDiv.positionInternal_(t,0,o.height+a):e.WidgetDiv.positionInternal_(t,a,o.height)},e.WidgetDiv.calculateX_=function(t,n,o,r){return r?(n=Math.max(n.right-o.width,t.left),Math.min(n,t.right-o.width)):(n=Math.min(n.left,t.right-o.width),Math.max(n,t.left))},e.WidgetDiv.calculateY_=function(t,n,o){return n.bottom+o.height>=t.bottom?n.top-o.height:n.bottom},e.Field=function(t,n,o){this.value_=this.DEFAULT_VALUE,this.tooltip_=this.validator_=null,this.size_=new e.utils.Size(0,0),this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=null,o&&this.configure_(o),this.setValue(t),n&&this.setValidator(n)},e.Field.prototype.DEFAULT_VALUE=null,e.Field.prototype.name=void 0,e.Field.prototype.disposed=!1,e.Field.prototype.maxDisplayLength=50,e.Field.prototype.sourceBlock_=null,e.Field.prototype.isDirty_=!0,e.Field.prototype.visible_=!0,e.Field.prototype.clickTarget_=null,e.Field.NBSP="\xa0",e.Field.prototype.EDITABLE=!0,e.Field.prototype.SERIALIZABLE=!1,e.Field.prototype.configure_=function(t){var n=t.tooltip;"string"==typeof n&&(n=e.utils.replaceMessageReferences(t.tooltip)),n&&this.setTooltip(n)},e.Field.prototype.setSourceBlock=function(t){if(this.sourceBlock_)throw Error("Field already bound to a block.");this.sourceBlock_=t},e.Field.prototype.getConstants=function(){return!this.constants_&&this.sourceBlock_&&this.sourceBlock_.workspace&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_},e.Field.prototype.getSourceBlock=function(){return this.sourceBlock_},e.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())},e.Field.prototype.initView=function(){this.createBorderRect_(),this.createTextElement_()},e.Field.prototype.initModel=function(){},e.Field.prototype.createBorderRect_=function(){this.borderRect_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)},e.Field.prototype.createTextElement_=function(){this.textElement_=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)},e.Field.prototype.bindEvents_=function(){e.Tooltip.bindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_=e.browserEvents.conditionalBind(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)},e.Field.prototype.fromXml=function(t){this.setValue(t.textContent)},e.Field.prototype.toXml=function(t){return t.textContent=this.getValue(),t},e.Field.prototype.dispose=function(){e.DropDownDiv.hideIfOwner(this),e.WidgetDiv.hideIfOwner(this),e.Tooltip.unbindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_&&e.browserEvents.unbind(this.mouseDownWrapper_),e.utils.dom.removeNode(this.fieldGroup_),this.disposed=!0},e.Field.prototype.updateEditable=function(){var t=this.fieldGroup_;this.EDITABLE&&t&&(this.sourceBlock_.isEditable()?(e.utils.dom.addClass(t,"blocklyEditableText"),e.utils.dom.removeClass(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(e.utils.dom.addClass(t,"blocklyNonEditableText"),e.utils.dom.removeClass(t,"blocklyEditableText"),t.style.cursor=""))},e.Field.prototype.isClickable=function(){return!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&!!this.showEditor_&&"function"==typeof this.showEditor_},e.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},e.Field.prototype.isSerializable=function(){var t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t},e.Field.prototype.isVisible=function(){return this.visible_},e.Field.prototype.setVisible=function(t){if(this.visible_!=t){this.visible_=t;var n=this.getSvgRoot();n&&(n.style.display=t?"block":"none")}},e.Field.prototype.setValidator=function(t){this.validator_=t},e.Field.prototype.getValidator=function(){return this.validator_},e.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},e.Field.prototype.applyColour=function(){},e.Field.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()},e.Field.prototype.showEditor=function(t){this.isClickable()&&this.showEditor_(t)},e.Field.prototype.updateSize_=function(t){var n=this.getConstants(),o=2*(t=null!=t?t:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0),r=n.FIELD_TEXT_HEIGHT,a=0;this.textElement_&&(o+=a=e.utils.dom.getFastTextWidth(this.textElement_,n.FIELD_TEXT_FONTSIZE,n.FIELD_TEXT_FONTWEIGHT,n.FIELD_TEXT_FONTFAMILY)),this.borderRect_&&(r=Math.max(r,n.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=r,this.size_.width=o,this.positionTextElement_(t,a),this.positionBorderRect_()},e.Field.prototype.positionTextElement_=function(t,n){if(this.textElement_){var o=this.getConstants(),r=this.size_.height/2;this.textElement_.setAttribute("x",this.sourceBlock_.RTL?this.size_.width-n-t:t),this.textElement_.setAttribute("y",o.FIELD_TEXT_BASELINE_CENTER?r:r-o.FIELD_TEXT_HEIGHT/2+o.FIELD_TEXT_BASELINE)}},e.Field.prototype.positionBorderRect_=function(){this.borderRect_&&(this.borderRect_.setAttribute("width",this.size_.width),this.borderRect_.setAttribute("height",this.size_.height),this.borderRect_.setAttribute("rx",this.getConstants().FIELD_BORDER_RECT_RADIUS),this.borderRect_.setAttribute("ry",this.getConstants().FIELD_BORDER_RECT_RADIUS))},e.Field.prototype.getSize=function(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0==this.size_.width&&(console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead."),this.render_()),this.size_):new e.utils.Size(0,0)},e.Field.prototype.getScaledBBox=function(){if(this.borderRect_)t=this.borderRect_.getBoundingClientRect(),o=e.utils.style.getPageOffset(this.borderRect_),r=t.width,t=t.height;else{var t=this.sourceBlock_.getHeightWidth(),n=this.sourceBlock_.workspace.scale,o=this.getAbsoluteXY_(),r=t.width*n;t=t.height*n,e.utils.userAgent.GECKO?(o.x+=1.5*n,o.y+=1.5*n):e.utils.userAgent.EDGE||e.utils.userAgent.IE||(o.x-=.5*n,o.y-=.5*n),r+=1*n,t+=1*n}return new e.utils.Rect(o.y,o.y+t,o.x,o.x+r)},e.Field.prototype.getDisplayText_=function(){var t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+"\u2026"),t=t.replace(/\s/g,e.Field.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+="\u200f"),t):e.Field.NBSP},e.Field.prototype.getText=function(){if(this.getText_){var t=this.getText_.call(this);if(null!==t)return String(t)}return String(this.getValue())},e.Field.prototype.markDirty=function(){this.isDirty_=!0,this.constants_=null},e.Field.prototype.forceRerender=function(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())},e.Field.prototype.setValue=function(t){if(null!==t){var n=this.doClassValidation_(t);if(!((t=this.processValidation_(t,n))instanceof Error)){if((n=this.getValidator())&&(n=n.call(this,t),(t=this.processValidation_(t,n))instanceof Error))return;if(!(n=this.sourceBlock_)||!n.disposed){var o=this.getValue();o===t?this.doValueUpdate_(t):(n&&e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(n,"field",this.name||null,o,t)),this.doValueUpdate_(t),this.isDirty_&&this.forceRerender())}}}},e.Field.prototype.processValidation_=function(t,n){return null===n?(this.doValueInvalid_(t),this.isDirty_&&this.forceRerender(),Error()):(void 0!==n&&(t=n),t)},e.Field.prototype.getValue=function(){return this.value_},e.Field.prototype.doClassValidation_=function(t){return null==t?null:t},e.Field.prototype.doValueUpdate_=function(t){this.value_=t,this.isDirty_=!0},e.Field.prototype.doValueInvalid_=function(t){},e.Field.prototype.onMouseDown_=function(t){this.sourceBlock_&&this.sourceBlock_.workspace&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)},e.Field.prototype.setTooltip=function(t){t||""===t||(t=this.sourceBlock_);var n=this.getClickTarget_();n?n.tooltip=t:this.tooltip_=t},e.Field.prototype.getTooltip=function(){var t=this.getClickTarget_();return e.Tooltip.getTooltipOfObject(t||{tooltip:this.tooltip_})},e.Field.prototype.getClickTarget_=function(){return this.clickTarget_||this.getSvgRoot()},e.Field.prototype.getAbsoluteXY_=function(){return e.utils.style.getPageOffset(this.getClickTarget_())},e.Field.prototype.referencesVariables=function(){return!1},e.Field.prototype.getParentInput=function(){for(var t=null,n=this.sourceBlock_,o=n.inputList,r=0;r<n.inputList.length;r++)for(var a=o[r],h=a.fieldRow,R=0;R<h.length;R++)if(h[R]===this){t=a;break}return t},e.Field.prototype.getFlipRtl=function(){return!1},e.Field.prototype.isTabNavigable=function(){return!1},e.Field.prototype.onShortcut=function(t){return!1},e.Field.prototype.setCursorSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},e.Field.prototype.setMarkerSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.markerSvg_=t):this.markerSvg_=null},e.Field.prototype.updateMarkers_=function(){var t=this.sourceBlock_.workspace;t.keyboardAccessibilityMode&&this.cursorSvg_&&t.getCursor().draw(),t.keyboardAccessibilityMode&&this.markerSvg_&&t.getMarker(e.MarkerManager.LOCAL_MARKER).draw()},e.FieldLabel=function(t,n,o){this.class_=null,e.FieldLabel.superClass_.constructor.call(this,t,null,o),o||(this.class_=n||null)},e.utils.object.inherits(e.FieldLabel,e.Field),e.FieldLabel.prototype.DEFAULT_VALUE="",e.FieldLabel.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldLabel(n,void 0,t)},e.FieldLabel.prototype.EDITABLE=!1,e.FieldLabel.prototype.configure_=function(t){e.FieldLabel.superClass_.configure_.call(this,t),this.class_=t.class},e.FieldLabel.prototype.initView=function(){this.createTextElement_(),this.class_&&e.utils.dom.addClass(this.textElement_,this.class_)},e.FieldLabel.prototype.doClassValidation_=function(t){return null==t?null:String(t)},e.FieldLabel.prototype.setClass=function(t){this.textElement_&&(this.class_&&e.utils.dom.removeClass(this.textElement_,this.class_),t&&e.utils.dom.addClass(this.textElement_,t)),this.class_=t},e.fieldRegistry.register("field_label",e.FieldLabel),e.Input=function(t,n,o,r){if(t!=e.inputTypes.DUMMY&&!n)throw Error("Value inputs and statement inputs must have non-empty name.");this.type=t,this.name=n,this.sourceBlock_=o,this.connection=r,this.fieldRow=[]},e.Input.prototype.align=e.constants.ALIGN.LEFT,e.Input.prototype.visible_=!0,e.Input.prototype.getSourceBlock=function(){return this.sourceBlock_},e.Input.prototype.appendField=function(t,n){return this.insertFieldAt(this.fieldRow.length,t,n),this},e.Input.prototype.insertFieldAt=function(t,n,o){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return(n||""==n&&o)&&("string"==typeof n&&(n=e.fieldRegistry.fromJson({type:"field_label",text:n})),n.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&(n.init(),n.applyColour()),n.name=o,n.setVisible(this.isVisible()),n.prefixField&&(t=this.insertFieldAt(t,n.prefixField)),this.fieldRow.splice(t,0,n),++t,n.suffixField&&(t=this.insertFieldAt(t,n.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours())),t},e.Input.prototype.removeField=function(t,n){for(var r,o=0;r=this.fieldRow[o];o++)if(r.name===t)return r.dispose(),this.fieldRow.splice(o,1),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),!0;if(n)return!1;throw Error('Field "'+t+'" not found.')},e.Input.prototype.isVisible=function(){return this.visible_},e.Input.prototype.setVisible=function(t){var n=[];if(this.visible_==t)return n;this.visible_=t;for(var r,o=0;r=this.fieldRow[o];o++)r.setVisible(t);return this.connection&&(this.connection=this.connection,t?n=this.connection.startTrackingAll():this.connection.stopTrackingAll(),o=this.connection.targetBlock())&&(o.getSvgRoot().style.display=t?"block":"none"),n},e.Input.prototype.markDirty=function(){for(var n,t=0;n=this.fieldRow[t];t++)n.markDirty()},e.Input.prototype.setCheck=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this},e.Input.prototype.setAlign=function(t){return this.align=t,this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render()),this},e.Input.prototype.setShadowDom=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(t),this},e.Input.prototype.getShadowDom=function(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()},e.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var t=0;t<this.fieldRow.length;t++)this.fieldRow[t].init()},e.Input.prototype.dispose=function(){for(var n,t=0;n=this.fieldRow[t];t++)n.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null},e.Block=function(t,n,o){if(e.Generator&&void 0!==e.Generator.prototype[n])throw Error('Block prototypeName "'+n+'" conflicts with Blockly.Generator members.');if(this.id=o&&!t.getBlockById(o)?o:e.utils.genUid(),t.setBlockById(this.id,this),this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.comment=this.outputShape_=null,this.commentModel={text:null,pinned:!1,size:new e.utils.Size(160,80)},this.xy_=new e.utils.Coordinate(0,0),this.workspace=t,this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,this.isInsertionMarker_=!1,this.hat=void 0,this.rendered=null,this.statementInputCount=0,n){if(this.type=n,!(o=e.Blocks[n])||"object"!=typeof o)throw TypeError("Unknown block type: "+n);e.utils.object.mixin(this,o)}t.addTopBlock(this),t.addTypedBlock(this),(t=e.Events.getGroup())||e.Events.setGroup(!0),n=e.Events.recordUndo;try{"function"==typeof this.init&&(e.Events.recordUndo=!1,this.init(),e.Events.recordUndo=n),e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(this))}finally{t||e.Events.setGroup(!1),e.Events.recordUndo=n}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)},e.Block.COLLAPSED_INPUT_NAME=e.constants.COLLAPSED_INPUT_NAME,e.Block.COLLAPSED_FIELD_NAME=e.constants.COLLAPSED_FIELD_NAME,e.Block.prototype.data=null,e.Block.prototype.disposed=!1,e.Block.prototype.hue_=null,e.Block.prototype.colour_="#000000",e.Block.prototype.styleName_="",e.Block.prototype.dispose=function(t){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_DELETE))(this)),e.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.workspace=null),e.selected==this&&(e.selected=null);for(var n=this.childBlocks_.length-1;0<=n;n--)this.childBlocks_[n].dispose(!1);n=0;for(var o;o=this.inputList[n];n++)o.dispose();this.inputList.length=0;var a,r=this.getConnections_(!0);for(n=0;a=r[n];n++)a.dispose()}finally{e.Events.enable(),this.disposed=!0}}},e.Block.prototype.initModel=function(){for(var n,t=0;n=this.inputList[t];t++)for(var r,o=0;r=n.fieldRow[o];o++)r.initModel&&r.initModel()},e.Block.prototype.unplug=function(t){this.outputConnection?this.unplugFromRow_(t):this.previousConnection&&this.unplugFromStack_(t)},e.Block.prototype.unplugFromRow_=function(t){var n=null;this.outputConnection.isConnected()&&(n=this.outputConnection.targetConnection,this.outputConnection.disconnect()),n&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&((t=t.targetConnection).disconnect(),this.workspace.connectionChecker.canConnect(t,n,!1)?n.connect(t):t.onFailedConnect(n))},e.Block.prototype.getOnlyValueConnection_=function(){for(var t=null,n=0;n<this.inputList.length;n++){var o=this.inputList[n].connection;if(o&&o.type==e.connectionTypes.INPUT_VALUE&&o.targetConnection){if(t)return null;t=o}}return t},e.Block.prototype.unplugFromStack_=function(t){var n=null;this.previousConnection.isConnected()&&(n=this.previousConnection.targetConnection,this.previousConnection.disconnect());var o=this.getNextBlock();t&&o&&!o.isShadow()&&((t=this.nextConnection.targetConnection).disconnect(),n&&this.workspace.connectionChecker.canConnect(n,t,!1)&&n.connect(t))},e.Block.prototype.getConnections_=function(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(var o,n=0;o=this.inputList[n];n++)o.connection&&t.push(o.connection);return t},e.Block.prototype.lastConnectionInStack=function(t){for(var n=this.nextConnection;n;){var o=n.targetBlock();if(!o||t&&o.isShadow())return n;n=o.nextConnection}return null},e.Block.prototype.bumpNeighbours=function(){},e.Block.prototype.getParent=function(){return this.parentBlock_},e.Block.prototype.getInputWithBlock=function(t){for(var o,n=0;o=this.inputList[n];n++)if(o.connection&&o.connection.targetBlock()==t)return o;return null},e.Block.prototype.getSurroundParent=function(){var t=this;do{var n=t;if(!(t=t.getParent()))return null}while(t.getNextBlock()==n);return t},e.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},e.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()},e.Block.prototype.getFirstStatementConnection=function(){for(var n,t=0;n=this.inputList[t];t++)if(n.connection&&n.connection.type==e.connectionTypes.NEXT_STATEMENT)return n.connection;return null},e.Block.prototype.getRootBlock=function(){var t=this;do{var n=t;t=n.parentBlock_}while(t);return n},e.Block.prototype.getTopStackBlock=function(){var t=this;do{var n=t.getPreviousBlock()}while(n&&n.getNextBlock()==t&&(t=n));return t},e.Block.prototype.getChildren=function(t){if(!t)return this.childBlocks_;t=[];for(var o,n=0;o=this.inputList[n];n++)o.connection&&(o=o.connection.targetBlock())&&t.push(o);return(n=this.getNextBlock())&&t.push(n),t},e.Block.prototype.setParent=function(t){if(t!=this.parentBlock_){if(this.parentBlock_){if(e.utils.arrayRemove(this.parentBlock_.childBlocks_,this),this.previousConnection&&this.previousConnection.isConnected())throw Error("Still connected to previous block.");if(this.outputConnection&&this.outputConnection.isConnected())throw Error("Still connected to parent block.");this.parentBlock_=null}else this.workspace.removeTopBlock(this);(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}},e.Block.prototype.getDescendants=function(t){for(var r,n=[this],o=this.getChildren(t),a=0;r=o[a];a++)n.push.apply(n,r.getDescendants(t));return n},e.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},e.Block.prototype.setDeletable=function(t){this.deletable_=t},e.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},e.Block.prototype.setMovable=function(t){this.movable_=t},e.Block.prototype.isDuplicatable=function(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(e.utils.getBlockTypeCounts(this,!0))},e.Block.prototype.isShadow=function(){return this.isShadow_},e.Block.prototype.setShadow=function(t){this.isShadow_=t},e.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_},e.Block.prototype.setInsertionMarker=function(t){this.isInsertionMarker_=t},e.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},e.Block.prototype.setEditable=function(t){this.editable_=t,t=0;for(var n;n=this.inputList[t];t++)for(var r,o=0;r=n.fieldRow[o];o++)r.updateEditable()},e.Block.prototype.isDisposed=function(){return this.disposed},e.Block.prototype.getMatchingConnection=function(t,n){var o=this.getConnections_(!0);if(t=t.getConnections_(!0),o.length!=t.length)throw Error("Connection lists did not match in length.");for(var r=0;r<t.length;r++)if(t[r]==n)return o[r];return null},e.Block.prototype.setHelpUrl=function(t){this.helpUrl=t},e.Block.prototype.setTooltip=function(t){this.tooltip=t},e.Block.prototype.getTooltip=function(){return e.Tooltip.getTooltipOfObject(this)},e.Block.prototype.getColour=function(){return this.colour_},e.Block.prototype.getStyleName=function(){return this.styleName_},e.Block.prototype.getHue=function(){return this.hue_},e.Block.prototype.setColour=function(t){t=e.utils.parseBlockColour(t),this.hue_=t.hue,this.colour_=t.hex},e.Block.prototype.setStyle=function(t){this.styleName_=t},e.Block.prototype.setOnChange=function(t){if(t&&"function"!=typeof t)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=t)&&(this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},e.Block.prototype.getField=function(t){if("string"!=typeof t)throw TypeError("Blockly.Block.prototype.getField expects a string with the field name but received "+(void 0===t?"nothing":t+" of type "+typeof t)+" instead");for(var o,n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)if(a.name===t)return a;return null},e.Block.prototype.getVars=function(){for(var o,t=[],n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)a.referencesVariables()&&t.push(a.getValue());return t},e.Block.prototype.getVarModels=function(){for(var o,t=[],n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)a.referencesVariables()&&(a=this.workspace.getVariableById(a.getValue()))&&t.push(a);return t},e.Block.prototype.updateVarName=function(t){for(var o,n=0;o=this.inputList[n];n++)for(var a,r=0;a=o.fieldRow[r];r++)a.referencesVariables()&&t.getId()==a.getValue()&&a.refreshVariableName()},e.Block.prototype.renameVarById=function(t,n){for(var r,o=0;r=this.inputList[o];o++)for(var h,a=0;h=r.fieldRow[a];a++)h.referencesVariables()&&t==h.getValue()&&h.setValue(n)},e.Block.prototype.getFieldValue=function(t){return(t=this.getField(t))?t.getValue():null},e.Block.prototype.setFieldValue=function(t,n){var o=this.getField(n);if(!o)throw Error('Field "'+n+'" not found.');o.setValue(t)},e.Block.prototype.setPreviousStatement=function(t,n){if(t){if(void 0===n&&(n=null),!this.previousConnection){if(this.outputConnection)throw Error("Remove output connection prior to adding previous connection.");this.previousConnection=this.makeConnection_(e.connectionTypes.PREVIOUS_STATEMENT)}this.previousConnection.setCheck(n)}else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}},e.Block.prototype.setNextStatement=function(t,n){if(t)void 0===n&&(n=null),this.nextConnection||(this.nextConnection=this.makeConnection_(e.connectionTypes.NEXT_STATEMENT)),this.nextConnection.setCheck(n);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}},e.Block.prototype.setOutput=function(t,n){if(t){if(void 0===n&&(n=null),!this.outputConnection){if(this.previousConnection)throw Error("Remove previous connection prior to adding output connection.");this.outputConnection=this.makeConnection_(e.connectionTypes.OUTPUT_VALUE)}this.outputConnection.setCheck(n)}else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}},e.Block.prototype.setInputsInline=function(t){this.inputsInline!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)},e.Block.prototype.getInputsInline=function(){if(null!=this.inputsInline)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==e.inputTypes.DUMMY&&this.inputList[t].type==e.inputTypes.DUMMY)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==e.inputTypes.VALUE&&this.inputList[t].type==e.inputTypes.DUMMY)return!0;return!1},e.Block.prototype.setOutputShape=function(t){this.outputShape_=t},e.Block.prototype.getOutputShape=function(){return this.outputShape_},e.Block.prototype.isEnabled=function(){return!this.disabled},e.Block.prototype.setEnabled=function(t){this.isEnabled()!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"disabled",null,this.disabled,!t)),this.disabled=!t)},e.Block.prototype.getInheritedDisabled=function(){for(var t=this.getSurroundParent();t;){if(t.disabled)return!0;t=t.getSurroundParent()}return!1},e.Block.prototype.isCollapsed=function(){return this.collapsed_},e.Block.prototype.setCollapsed=function(t){this.collapsed_!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)},e.Block.prototype.toString=function(t,n){function o(nt){var et=nt.getCheck();return!et&&nt.targetConnection&&(et=nt.targetConnection.getCheck()),!!et&&(-1!=et.indexOf("Boolean")||-1!=et.indexOf("Number"))}function r(){R&&R.getType()==L.getType()&&R.getLocation()==L.getLocation()&&(R=null)}var a=[];n=n||"?";var h=e.ASTNode.NAVIGATE_ALL_FIELDS;e.ASTNode.NAVIGATE_ALL_FIELDS=!0;for(var R=e.ASTNode.createBlockNode(this),L=R;R;){switch(R.getType()){case e.ASTNode.types.INPUT:var W=R.getLocation();R.in()?o(W)&&a.push("("):a.push(n);break;case e.ASTNode.types.FIELD:(W=R.getLocation()).name!=e.constants.COLLAPSED_FIELD_NAME&&a.push(W.getText())}if(!(R=(W=R).in()||W.next())){for(R=W.out(),r();R&&!R.next();)R=R.out(),r(),R&&R.getType()==e.ASTNode.types.INPUT&&o(R.getLocation())&&a.push(")");R&&(R=R.next())}}for(e.ASTNode.NAVIGATE_ALL_FIELDS=h,n=2;n<a.length;n++)"("==a[n-2]&&")"==a[n]&&(a[n-2]=a[n-1],a.splice(n-1,2));return a=(a=a.reduce(function(nt,et){return nt+("("==nt.substr(-1)||")"==et?"":" ")+et},"")).trim()||"???",t&&a.length>t&&(a=a.substring(0,t-3)+"..."),a},e.Block.prototype.appendValueInput=function(t){return this.appendInput_(e.inputTypes.VALUE,t)},e.Block.prototype.appendStatementInput=function(t){return this.appendInput_(e.inputTypes.STATEMENT,t)},e.Block.prototype.appendDummyInput=function(t){return this.appendInput_(e.inputTypes.DUMMY,t||"")},e.Block.prototype.jsonInit=function(t){var n=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(n+"Must not have both an output and a previousStatement.");if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(n+"Must not have both a colour and a style.");t.style?this.jsonInitStyle_(t,n):this.jsonInitColour_(t,n);for(var o=0;void 0!==t["message"+o];)this.interpolate_(t["message"+o],t["args"+o]||[],t["lastDummyAlign"+o],n),o++;if(void 0!==t.inputsInline&&this.setInputsInline(t.inputsInline),void 0!==t.output&&this.setOutput(!0,t.output),void 0!==t.outputShape&&this.setOutputShape(t.outputShape),void 0!==t.previousStatement&&this.setPreviousStatement(!0,t.previousStatement),void 0!==t.nextStatement&&this.setNextStatement(!0,t.nextStatement),void 0!==t.tooltip&&(o=e.utils.replaceMessageReferences(o=t.tooltip),this.setTooltip(o)),void 0!==t.enableContextMenu&&(this.contextMenu=!!(o=t.enableContextMenu)),void 0!==t.helpUrl&&(o=e.utils.replaceMessageReferences(o=t.helpUrl),this.setHelpUrl(o)),"string"==typeof t.extensions&&(console.warn(n+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),void 0!==t.mutator&&e.Extensions.apply(t.mutator,this,!0),t=t.extensions,Array.isArray(t))for(n=0;n<t.length;++n)e.Extensions.apply(t[n],this,!1)},e.Block.prototype.jsonInitColour_=function(t,n){if("colour"in t)if(void 0===t.colour)console.warn(n+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch(o){console.warn(n+"Illegal colour value: ",t)}}},e.Block.prototype.jsonInitStyle_=function(t,n){t=t.style;try{this.setStyle(t)}catch(o){console.warn(n+"Style does not exist: ",t)}},e.Block.prototype.mixin=function(t,n){if(void 0!==n&&"boolean"!=typeof n)throw Error("opt_disableCheck must be a boolean if provided");if(!n){for(var o in n=[],t)void 0!==this[o]&&n.push(o);if(n.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(n))}e.utils.object.mixin(this,t)},e.Block.prototype.interpolate_=function(t,n,o,r){t=e.utils.tokenizeInterpolation(t),this.validateTokens_(t,n.length),n=this.interpolateArguments_(t,n,o),o=[],t=0;for(var a;a=n[t];t++)if(this.isInputKeyword_(a.type)){if(a=this.inputFromJson_(a,r)){for(var R,h=0;R=o[h];h++)a.appendField(R[0],R[1]);o.length=0}}else(h=this.fieldFromJson_(a))&&o.push([h,a.name])},e.Block.prototype.validateTokens_=function(t,n){for(var o=[],r=0,a=0;a<t.length;a++){var h=t[a];if("number"==typeof h){if(1>h||h>n)throw Error('Block "'+this.type+'": Message index %'+h+" out of range.");if(o[h])throw Error('Block "'+this.type+'": Message index %'+h+" duplicated.");o[h]=!0,r++}}if(r!=n)throw Error('Block "'+this.type+'": Message does not reference all '+n+" arg(s).")},e.Block.prototype.interpolateArguments_=function(t,n,o){for(var r=[],a=0;a<t.length;a++){var h=t[a];"number"==typeof h&&(h=n[h-1]),("string"!=typeof h||(h=this.stringToFieldJson_(h)))&&r.push(h)}return(t=r.length)&&!this.isInputKeyword_(r[t-1].type)&&(t={type:"input_dummy"},o&&(t.align=o),r.push(t)),r},e.Block.prototype.fieldFromJson_=function(t){var n=e.fieldRegistry.fromJson(t);return!n&&t.alt?"string"==typeof t.alt?(t=this.stringToFieldJson_(t.alt))?this.fieldFromJson_(t):null:this.fieldFromJson_(t.alt):n},e.Block.prototype.inputFromJson_=function(t,n){var o={LEFT:e.constants.ALIGN.LEFT,RIGHT:e.constants.ALIGN.RIGHT,CENTRE:e.constants.ALIGN.CENTRE,CENTER:e.constants.ALIGN.CENTRE},r=null;switch(t.type){case"input_value":r=this.appendValueInput(t.name);break;case"input_statement":r=this.appendStatementInput(t.name);break;case"input_dummy":r=this.appendDummyInput(t.name)}return r?(t.check&&r.setCheck(t.check),t.align&&(void 0===(o=o[t.align.toUpperCase()])?console.warn(n+"Illegal align value: ",t.align):r.setAlign(o)),r):null},e.Block.prototype.isInputKeyword_=function(t){return"input_value"==t||"input_statement"==t||"input_dummy"==t},e.Block.prototype.stringToFieldJson_=function(t){return(t=t.trim())?{type:"field_label",text:t}:null},e.Block.prototype.appendInput_=function(t,n){var o=null;return(t==e.inputTypes.VALUE||t==e.inputTypes.STATEMENT)&&(o=this.makeConnection_(t)),t==e.inputTypes.STATEMENT&&this.statementInputCount++,t=new e.Input(t,n,this,o),this.inputList.push(t),t},e.Block.prototype.moveInputBefore=function(t,n){if(t!=n){for(var h,o=-1,r=n?-1:this.inputList.length,a=0;h=this.inputList[a];a++)if(h.name==t){if(o=a,-1!=r)break}else if(n&&h.name==n&&(r=a,-1!=o))break;if(-1==o)throw Error('Named input "'+t+'" not found.');if(-1==r)throw Error('Reference input "'+n+'" not found.');this.moveNumberedInputBefore(o,r)}},e.Block.prototype.moveNumberedInputBefore=function(t,n){if(t==n)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(n>this.inputList.length)throw RangeError("Reference input "+n+" out of bounds.");var o=this.inputList[t];this.inputList.splice(t,1),t<n&&n--,this.inputList.splice(n,0,o)},e.Block.prototype.removeInput=function(t,n){for(var r,o=0;r=this.inputList[o];o++)if(r.name==t)return r.type==e.inputTypes.STATEMENT&&this.statementInputCount--,r.dispose(),this.inputList.splice(o,1),!0;if(n)return!1;throw Error("Input not found: "+t)},e.Block.prototype.getInput=function(t){for(var o,n=0;o=this.inputList[n];n++)if(o.name==t)return o;return null},e.Block.prototype.getInputTargetBlock=function(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()},e.Block.prototype.getCommentText=function(){return this.commentModel.text},e.Block.prototype.setCommentText=function(t){this.commentModel.text!=t&&(e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this,"comment",null,this.commentModel.text,t)),this.comment=this.commentModel.text=t)},e.Block.prototype.setWarningText=function(t,n){},e.Block.prototype.setMutator=function(t){},e.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},e.Block.prototype.moveBy=function(t,n){if(this.parentBlock_)throw Error("Block has parent.");var o=new(e.Events.get(e.Events.BLOCK_MOVE))(this);this.xy_.translate(t,n),o.recordNew(),e.Events.fire(o)},e.Block.prototype.makeConnection_=function(t){return new e.Connection(this,t)},e.Block.prototype.allInputsFilled=function(t){if(void 0===t&&(t=!0),!t&&this.isShadow())return!1;for(var o,n=0;o=this.inputList[n];n++)if(o.connection&&(!(o=o.connection.targetBlock())||!o.allInputsFilled(t)))return!1;return!(n=this.getNextBlock())||n.allInputsFilled(t)},e.Block.prototype.toDevString=function(){var t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t},e.blockRendering.IPathObject=function(t,n){},e.utils.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,FF_HASH:163,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},e.Menu=function(){this.menuItems_=[],this.roleName_=this.element_=this.onKeyDownHandler_=this.mouseLeaveHandler_=this.mouseEnterHandler_=this.clickHandler_=this.mouseOverHandler_=this.highlightedItem_=this.openingCoords=null},e.Menu.prototype.addChild=function(t){this.menuItems_.push(t)},e.Menu.prototype.render=function(t){var n=document.createElement("div");n.className="blocklyMenu goog-menu blocklyNonSelectable",n.tabIndex=0,this.roleName_&&e.utils.aria.setRole(n,this.roleName_),this.element_=n;for(var r,o=0;r=this.menuItems_[o];o++)n.appendChild(r.createDom());this.mouseOverHandler_=e.browserEvents.conditionalBind(n,"mouseover",this,this.handleMouseOver_,!0),this.clickHandler_=e.browserEvents.conditionalBind(n,"click",this,this.handleClick_,!0),this.mouseEnterHandler_=e.browserEvents.conditionalBind(n,"mouseenter",this,this.handleMouseEnter_,!0),this.mouseLeaveHandler_=e.browserEvents.conditionalBind(n,"mouseleave",this,this.handleMouseLeave_,!0),this.onKeyDownHandler_=e.browserEvents.conditionalBind(n,"keydown",this,this.handleKeyEvent_),t.appendChild(n)},e.Menu.prototype.getElement=function(){return this.element_},e.Menu.prototype.focus=function(){var t=this.getElement();t&&(t.focus({preventScroll:!0}),e.utils.dom.addClass(t,"blocklyFocused"))},e.Menu.prototype.blur_=function(){var t=this.getElement();t&&(t.blur(),e.utils.dom.removeClass(t,"blocklyFocused"))},e.Menu.prototype.setRole=function(t){this.roleName_=t},e.Menu.prototype.dispose=function(){this.mouseOverHandler_&&(e.browserEvents.unbind(this.mouseOverHandler_),this.mouseOverHandler_=null),this.clickHandler_&&(e.browserEvents.unbind(this.clickHandler_),this.clickHandler_=null),this.mouseEnterHandler_&&(e.browserEvents.unbind(this.mouseEnterHandler_),this.mouseEnterHandler_=null),this.mouseLeaveHandler_&&(e.browserEvents.unbind(this.mouseLeaveHandler_),this.mouseLeaveHandler_=null),this.onKeyDownHandler_&&(e.browserEvents.unbind(this.onKeyDownHandler_),this.onKeyDownHandler_=null);for(var n,t=0;n=this.menuItems_[t];t++)n.dispose();this.element_=null},e.Menu.prototype.getMenuItem_=function(t){for(var n=this.getElement();t&&t!=n;){if(e.utils.dom.hasClass(t,"blocklyMenuItem"))for(var r,o=0;r=this.menuItems_[o];o++)if(r.getElement()==t)return r;t=t.parentElement}return null},e.Menu.prototype.setHighlighted=function(t){var n=this.highlightedItem_;n&&(n.setHighlighted(!1),this.highlightedItem_=null),t&&(t.setHighlighted(!0),this.highlightedItem_=t,n=this.getElement(),e.utils.style.scrollIntoContainerView(t.getElement(),n),e.utils.aria.setState(n,e.utils.aria.State.ACTIVEDESCENDANT,t.getId()))},e.Menu.prototype.highlightNext=function(){var t=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(t,1)},e.Menu.prototype.highlightPrevious=function(){var t=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(0>t?this.menuItems_.length:t,-1)},e.Menu.prototype.highlightFirst_=function(){this.highlightHelper_(-1,1)},e.Menu.prototype.highlightLast_=function(){this.highlightHelper_(this.menuItems_.length,-1)},e.Menu.prototype.highlightHelper_=function(t,n){t+=n;for(var o;o=this.menuItems_[t];){if(o.isEnabled()){this.setHighlighted(o);break}t+=n}},e.Menu.prototype.handleMouseOver_=function(t){(t=this.getMenuItem_(t.target))&&(t.isEnabled()?this.highlightedItem_!=t&&this.setHighlighted(t):this.setHighlighted(null))},e.Menu.prototype.handleClick_=function(t){var n=this.openingCoords;if(this.openingCoords=null,n&&"number"==typeof t.clientX){var o=new e.utils.Coordinate(t.clientX,t.clientY);if(1>e.utils.Coordinate.distance(n,o))return}(t=this.getMenuItem_(t.target))&&t.performAction()},e.Menu.prototype.handleMouseEnter_=function(t){this.focus()},e.Menu.prototype.handleMouseLeave_=function(t){this.getElement()&&(this.blur_(),this.setHighlighted(null))},e.Menu.prototype.handleKeyEvent_=function(t){if(this.menuItems_.length&&!(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)){var n=this.highlightedItem_;switch(t.keyCode){case e.utils.KeyCodes.ENTER:case e.utils.KeyCodes.SPACE:n&&n.performAction();break;case e.utils.KeyCodes.UP:this.highlightPrevious();break;case e.utils.KeyCodes.DOWN:this.highlightNext();break;case e.utils.KeyCodes.PAGE_UP:case e.utils.KeyCodes.HOME:this.highlightFirst_();break;case e.utils.KeyCodes.PAGE_DOWN:case e.utils.KeyCodes.END:this.highlightLast_();break;default:return}t.preventDefault(),t.stopPropagation()}},e.Menu.prototype.getSize=function(){var t=this.getElement(),n=e.utils.style.getSize(t);return n.height=t.scrollHeight,n},e.MenuItem=function(t,n){this.content_=t,this.value_=n,this.enabled_=!0,this.element_=null,this.rightToLeft_=!1,this.roleName_=null,this.highlight_=this.checked_=this.checkable_=!1,this.actionHandler_=null},e.MenuItem.prototype.createDom=function(){var t=document.createElement("div");t.id=e.utils.IdGenerator.getNextUniqueId(),this.element_=t,t.className="blocklyMenuItem goog-menuitem "+(this.enabled_?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked_?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight_?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft_?"blocklyMenuItemRtl goog-menuitem-rtl ":"");var n=document.createElement("div");if(n.className="blocklyMenuItemContent goog-menuitem-content",this.checkable_){var o=document.createElement("div");o.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",n.appendChild(o)}return o=this.content_,"string"==typeof this.content_&&(o=document.createTextNode(this.content_)),n.appendChild(o),t.appendChild(n),this.roleName_&&e.utils.aria.setRole(t,this.roleName_),e.utils.aria.setState(t,e.utils.aria.State.SELECTED,this.checkable_&&this.checked_||!1),e.utils.aria.setState(t,e.utils.aria.State.DISABLED,!this.enabled_),t},e.MenuItem.prototype.dispose=function(){this.element_=null},e.MenuItem.prototype.getElement=function(){return this.element_},e.MenuItem.prototype.getId=function(){return this.element_.id},e.MenuItem.prototype.getValue=function(){return this.value_},e.MenuItem.prototype.setRightToLeft=function(t){this.rightToLeft_=t},e.MenuItem.prototype.setRole=function(t){this.roleName_=t},e.MenuItem.prototype.setCheckable=function(t){this.checkable_=t},e.MenuItem.prototype.setChecked=function(t){this.checked_=t},e.MenuItem.prototype.setHighlighted=function(t){this.highlight_=t;var n=this.getElement();n&&this.isEnabled()&&(t?(e.utils.dom.addClass(n,"blocklyMenuItemHighlight"),e.utils.dom.addClass(n,"goog-menuitem-highlight")):(e.utils.dom.removeClass(n,"blocklyMenuItemHighlight"),e.utils.dom.removeClass(n,"goog-menuitem-highlight")))},e.MenuItem.prototype.isEnabled=function(){return this.enabled_},e.MenuItem.prototype.setEnabled=function(t){this.enabled_=t},e.MenuItem.prototype.performAction=function(){this.isEnabled()&&this.actionHandler_&&this.actionHandler_(this)},e.MenuItem.prototype.onAction=function(t,n){this.actionHandler_=t.bind(n)},e.ContextMenu={},e.ContextMenu.currentBlock=null,e.ContextMenu.menu_=null,e.ContextMenu.show=function(t,n,o){if(e.WidgetDiv.show(e.ContextMenu,o,e.ContextMenu.dispose),n.length){var r=e.ContextMenu.populate_(n,o);e.ContextMenu.menu_=r,e.ContextMenu.position_(r,t,o),setTimeout(function(){r.focus()},1),e.ContextMenu.currentBlock=null}else e.ContextMenu.hide()},e.ContextMenu.populate_=function(t,n){var o=new e.Menu;o.setRole(e.utils.aria.Role.MENU);for(var a,r=0;a=t[r];r++){var h=new e.MenuItem(a.text);h.setRightToLeft(n),h.setRole(e.utils.aria.Role.MENUITEM),o.addChild(h),h.setEnabled(a.enabled),a.enabled&&h.onAction(function(R){e.ContextMenu.hide(),this.callback(this.scope)},a)}return o},e.ContextMenu.position_=function(t,n,o){var r=e.utils.getViewportBBox();n=new e.utils.Rect(n.clientY+r.top,n.clientY+r.top,n.clientX+r.left,n.clientX+r.left),e.ContextMenu.createWidget_(t);var a=t.getSize();o&&(n.left+=a.width,n.right+=a.width,r.left+=a.width,r.right+=a.width),e.WidgetDiv.positionWithAnchor(r,n,a,o),t.focus()},e.ContextMenu.createWidget_=function(t){t.render(e.WidgetDiv.DIV);var n=t.getElement();e.utils.dom.addClass(n,"blocklyContextMenu"),e.browserEvents.conditionalBind(n,"contextmenu",null,e.utils.noEvent),t.focus()},e.ContextMenu.hide=function(){e.WidgetDiv.hideIfOwner(e.ContextMenu),e.ContextMenu.currentBlock=null},e.ContextMenu.dispose=function(){e.ContextMenu.menu_&&(e.ContextMenu.menu_.dispose(),e.ContextMenu.menu_=null)},e.ContextMenu.callbackFactory=function(t,n){return function(){e.Events.disable();try{var o=e.Xml.domToBlock(n,t.workspace),r=t.getRelativeToSurfaceXY();r.x=t.RTL?r.x-e.SNAP_RADIUS:r.x+e.SNAP_RADIUS,r.y+=2*e.SNAP_RADIUS,o.moveBy(r.x,r.y)}finally{e.Events.enable()}e.Events.isEnabled()&&!o.isShadow()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(o)),o.select()}},e.ContextMenu.commentDeleteOption=function(t){return{text:e.Msg.REMOVE_COMMENT,enabled:!0,callback:function(){e.Events.setGroup(!0),t.dispose(!0,!0),e.Events.setGroup(!1)}}},e.ContextMenu.commentDuplicateOption=function(t){return{text:e.Msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){e.duplicate(t)}}},e.ContextMenu.workspaceCommentOption=function(t,n){if(!e.WorkspaceCommentSvg)throw Error("Missing require for Blockly.WorkspaceCommentSvg");var o={enabled:!e.utils.userAgent.IE};return o.text=e.Msg.ADD_COMMENT,o.callback=function(){var r=new e.WorkspaceCommentSvg(t,e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT,e.WorkspaceCommentSvg.DEFAULT_SIZE,e.WorkspaceCommentSvg.DEFAULT_SIZE),a=t.getInjectionDiv().getBoundingClientRect();a=new e.utils.Coordinate(n.clientX-a.left,n.clientY-a.top);var h=t.getOriginOffsetInPixels();(a=e.utils.Coordinate.difference(a,h)).scale(1/t.scale),r.moveBy(a.x,a.y),t.rendered&&(r.initSvg(),r.render(),r.select())},o},e.ContextMenuRegistry=function(){e.ContextMenuRegistry.registry=this,this.registry_=Object.create(null)},e.ContextMenuRegistry.ScopeType={BLOCK:"block",WORKSPACE:"workspace"},e.ContextMenuRegistry.registry=null,e.ContextMenuRegistry.prototype.register=function(t){if(this.registry_[t.id])throw Error('Menu item with ID "'+t.id+'" is already registered.');this.registry_[t.id]=t},e.ContextMenuRegistry.prototype.unregister=function(t){if(!this.registry_[t])throw Error('Menu item with ID "'+t+'" not found.');delete this.registry_[t]},e.ContextMenuRegistry.prototype.getItem=function(t){return this.registry_[t]||null},e.ContextMenuRegistry.prototype.getContextMenuOptions=function(t,n){var o=[],r=this.registry_;return Object.keys(r).forEach(function(a){if(t==(a=r[a]).scopeType){var h=a.preconditionFn(n);"hidden"!=h&&(a={text:"function"==typeof a.displayText?a.displayText(n):a.displayText,enabled:"enabled"==h,callback:a.callback,scope:n,weight:a.weight},o.push(a))}}),o.sort(function(a,h){return a.weight-h.weight}),o},new e.ContextMenuRegistry,e.Events.Selected=function(t,n,o){e.Events.Selected.superClass_.constructor.call(this,o),this.oldElementId=t,this.newElementId=n},e.utils.object.inherits(e.Events.Selected,e.Events.UiBase),e.Events.Selected.prototype.type=e.Events.SELECTED,e.Events.Selected.prototype.toJson=function(){var t=e.Events.Selected.superClass_.toJson.call(this);return t.oldElementId=this.oldElementId,t.newElementId=this.newElementId,t},e.Events.Selected.prototype.fromJson=function(t){e.Events.Selected.superClass_.fromJson.call(this,t),this.oldElementId=t.oldElementId,this.newElementId=t.newElementId},e.registry.register(e.registry.Type.EVENT,e.Events.SELECTED,e.Events.Selected),e.IBoundedElement=function(){},e.ICopyable=function(){},e.RenderedConnection=function(t,n){e.RenderedConnection.superClass_.constructor.call(this,t,n),this.db_=t.workspace.connectionDBList[n],this.dbOpposite_=t.workspace.connectionDBList[e.OPPOSITE_TYPE[n]],this.offsetInBlock_=new e.utils.Coordinate(0,0),this.trackedState_=e.RenderedConnection.TrackedState.WILL_TRACK,this.targetConnection=null},e.utils.object.inherits(e.RenderedConnection,e.Connection),e.RenderedConnection.TrackedState={WILL_TRACK:-1,UNTRACKED:0,TRACKED:1},e.RenderedConnection.prototype.dispose=function(){e.RenderedConnection.superClass_.dispose.call(this),this.trackedState_==e.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)},e.RenderedConnection.prototype.getSourceBlock=function(){return e.RenderedConnection.superClass_.getSourceBlock.call(this)},e.RenderedConnection.prototype.targetBlock=function(){return e.RenderedConnection.superClass_.targetBlock.call(this)},e.RenderedConnection.prototype.distanceFrom=function(t){var n=this.x-t.x;return t=this.y-t.y,Math.sqrt(n*n+t*t)},e.RenderedConnection.prototype.bumpAwayFrom=function(t){if(!this.sourceBlock_.workspace.isDragging()){var n=this.sourceBlock_.getRootBlock();if(!n.isInFlyout){var o=!1;if(!n.isMovable()){if(!(n=t.getSourceBlock().getRootBlock()).isMovable())return;t=this,o=!0}var r=e.selected==n;r||n.addSelect();var a=t.x+e.SNAP_RADIUS+Math.floor(Math.random()*e.BUMP_RANDOMNESS)-this.x,h=t.y+e.SNAP_RADIUS+Math.floor(Math.random()*e.BUMP_RANDOMNESS)-this.y;o&&(h=-h),n.RTL&&(a=t.x-e.SNAP_RADIUS-Math.floor(Math.random()*e.BUMP_RANDOMNESS)-this.x),n.moveBy(a,h),r||n.removeSelect()}}},e.RenderedConnection.prototype.moveTo=function(t,n){this.trackedState_==e.RenderedConnection.TrackedState.WILL_TRACK?(this.db_.addConnection(this,n),this.trackedState_=e.RenderedConnection.TrackedState.TRACKED):this.trackedState_==e.RenderedConnection.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,n)),this.x=t,this.y=n},e.RenderedConnection.prototype.moveBy=function(t,n){this.moveTo(this.x+t,this.y+n)},e.RenderedConnection.prototype.moveToOffset=function(t){this.moveTo(t.x+this.offsetInBlock_.x,t.y+this.offsetInBlock_.y)},e.RenderedConnection.prototype.setOffsetInBlock=function(t,n){this.offsetInBlock_.x=t,this.offsetInBlock_.y=n},e.RenderedConnection.prototype.getOffsetInBlock=function(){return this.offsetInBlock_},e.RenderedConnection.prototype.tighten=function(){var t=this.targetConnection.x-this.x,n=this.targetConnection.y-this.y;if(0!=t||0!=n){var o=this.targetBlock(),r=o.getSvgRoot();if(!r)throw Error("block is not rendered.");r=e.utils.getRelativeXY(r),o.getSvgRoot().setAttribute("transform","translate("+(r.x-t)+","+(r.y-n)+")"),o.moveConnections(-t,-n)}},e.RenderedConnection.prototype.closest=function(t,n){return this.dbOpposite_.searchForClosest(this,t,n)},e.RenderedConnection.prototype.highlight=function(){var t=this.sourceBlock_.workspace.getRenderer().getConstants(),n=t.shapeFor(this);n=this.type==e.connectionTypes.INPUT_VALUE||this.type==e.connectionTypes.OUTPUT_VALUE?e.utils.svgPaths.moveBy(0,-(t=t.TAB_OFFSET_FROM_TOP))+e.utils.svgPaths.lineOnAxis("v",t)+n.pathDown+e.utils.svgPaths.lineOnAxis("v",t):e.utils.svgPaths.moveBy(-(t=t.NOTCH_OFFSET_LEFT-t.CORNER_RADIUS),0)+e.utils.svgPaths.lineOnAxis("h",t)+n.pathLeft+e.utils.svgPaths.lineOnAxis("h",t),t=this.sourceBlock_.getRelativeToSurfaceXY(),e.Connection.highlightedPath_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyHighlightedConnectionPath",d:n,transform:"translate("+(this.x-t.x)+","+(this.y-t.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},e.RenderedConnection.prototype.unhighlight=function(){e.utils.dom.removeNode(e.Connection.highlightedPath_),delete e.Connection.highlightedPath_},e.RenderedConnection.prototype.setTracking=function(t){t&&this.trackedState_==e.RenderedConnection.TrackedState.TRACKED||!t&&this.trackedState_==e.RenderedConnection.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(t?(this.db_.addConnection(this,this.y),this.trackedState_=e.RenderedConnection.TrackedState.TRACKED):(this.trackedState_==e.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=e.RenderedConnection.TrackedState.UNTRACKED))},e.RenderedConnection.prototype.stopTrackingAll=function(){if(this.setTracking(!1),this.targetConnection)for(var t=this.targetBlock().getDescendants(!1),n=0;n<t.length;n++){for(var o=t[n],r=o.getConnections_(!0),a=0;a<r.length;a++)r[a].setTracking(!1);for(o=o.getIcons(),a=0;a<o.length;a++)o[a].setVisible(!1)}},e.RenderedConnection.prototype.startTrackingAll=function(){this.setTracking(!0);var t=[];if(this.type!=e.connectionTypes.INPUT_VALUE&&this.type!=e.connectionTypes.NEXT_STATEMENT)return t;var n=this.targetBlock();if(n){if(n.isCollapsed()){var o=[];n.outputConnection&&o.push(n.outputConnection),n.nextConnection&&o.push(n.nextConnection),n.previousConnection&&o.push(n.previousConnection)}else o=n.getConnections_(!0);for(var r=0;r<o.length;r++)t.push.apply(t,o[r].startTrackingAll());t.length||(t[0]=n)}return t},e.RenderedConnection.prototype.isConnectionAllowed=function(t,n){return e.utils.deprecation.warn("RenderedConnection.prototype.isConnectionAllowed","July 2020","July 2021","Blockly.Workspace.prototype.getConnectionChecker().canConnect"),!(this.distanceFrom(t)>n)&&e.RenderedConnection.superClass_.isConnectionAllowed.call(this,t)},e.RenderedConnection.prototype.onFailedConnect=function(t){var n=this.getSourceBlock();if(e.Events.recordUndo){var o=e.Events.getGroup();setTimeout(function(){n.isDisposed()||n.getParent()||(e.Events.setGroup(o),this.bumpAwayFrom(t),e.Events.setGroup(!1))}.bind(this),e.BUMP_DELAY)}},e.RenderedConnection.prototype.disconnectInternal_=function(t,n){e.RenderedConnection.superClass_.disconnectInternal_.call(this,t,n),t.rendered&&t.render(),n.rendered&&(n.updateDisabled(),n.render(),n.getSvgRoot().style.display="block")},e.RenderedConnection.prototype.respawnShadow_=function(){e.RenderedConnection.superClass_.respawnShadow_.call(this);var t=this.targetBlock();t&&(t.initSvg(),t.render(!1),(t=this.getSourceBlock()).rendered&&t.render())},e.RenderedConnection.prototype.neighbours=function(t){return this.dbOpposite_.getNeighbours(this,t)},e.RenderedConnection.prototype.connect_=function(t){e.RenderedConnection.superClass_.connect_.call(this,t);var n=this.getSourceBlock();t=t.getSourceBlock();var o=n.rendered,r=t.rendered;o&&n.updateDisabled(),r&&t.updateDisabled(),o&&r&&(this.type==e.connectionTypes.NEXT_STATEMENT||this.type==e.connectionTypes.PREVIOUS_STATEMENT?t.render():n.render()),(n=n.getInputWithBlock(t))&&(n=n.isVisible(),t.getSvgRoot().style.display=n?"block":"none")},e.RenderedConnection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())},e.BasicCursor=function(){e.BasicCursor.superClass_.constructor.call(this)},e.utils.object.inherits(e.BasicCursor,e.Cursor),e.BasicCursor.registrationName="basicCursor",e.BasicCursor.prototype.next=function(){var t=this.getCurNode();return t?((t=this.getNextNode_(t,this.validNode_))&&this.setCurNode(t),t):null},e.BasicCursor.prototype.in=function(){return this.next()},e.BasicCursor.prototype.prev=function(){var t=this.getCurNode();return t?((t=this.getPreviousNode_(t,this.validNode_))&&this.setCurNode(t),t):null},e.BasicCursor.prototype.out=function(){return this.prev()},e.BasicCursor.prototype.getNextNode_=function(t,n){if(!t)return null;var o=t.in()||t.next();return n(o)?o:o?this.getNextNode_(o,n):n(t=this.findSiblingOrParent_(t.out()))?t:t?this.getNextNode_(t,n):null},e.BasicCursor.prototype.getPreviousNode_=function(t,n){if(!t)return null;var o=t.prev();return n(o=o?this.getRightMostChild_(o):t.out())?o:o?this.getPreviousNode_(o,n):null},e.BasicCursor.prototype.validNode_=function(t){var n=!1;return((t=t&&t.getType())==e.ASTNode.types.OUTPUT||t==e.ASTNode.types.INPUT||t==e.ASTNode.types.FIELD||t==e.ASTNode.types.NEXT||t==e.ASTNode.types.PREVIOUS||t==e.ASTNode.types.WORKSPACE)&&(n=!0),n},e.BasicCursor.prototype.findSiblingOrParent_=function(t){return t?t.next()||this.findSiblingOrParent_(t.out()):null},e.BasicCursor.prototype.getRightMostChild_=function(t){if(!t.in())return t;for(t=t.in();t.next();)t=t.next();return this.getRightMostChild_(t)},e.registry.register(e.registry.Type.CURSOR,e.BasicCursor.registrationName,e.BasicCursor),e.TabNavigateCursor=function(){e.TabNavigateCursor.superClass_.constructor.call(this)},e.utils.object.inherits(e.TabNavigateCursor,e.BasicCursor),e.TabNavigateCursor.prototype.validNode_=function(t){var n=!1,o=t&&t.getType();return t&&(t=t.getLocation(),o==e.ASTNode.types.FIELD&&t&&t.isTabNavigable()&&t.isClickable()&&(n=!0)),n},e.BlockSvg=function(t,n,o){this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null),this.svgGroup_.translate_="",this.style=t.getRenderer().getConstants().getBlockStyle(null),this.pathObject=t.getRenderer().makePathObject(this.svgGroup_,this.style),this.renderIsInProgress_=this.rendered=!1,this.workspace=t,this.previousConnection=this.nextConnection=this.outputConnection=null,this.useDragSurface_=e.utils.is3dSupported()&&!!t.getBlockDragSurface();var r=this.pathObject.svgPath;r.tooltip=this,e.Tooltip.bindMouseEvents(r),e.BlockSvg.superClass_.constructor.call(this,t,n,o),this.svgGroup_.dataset?this.svgGroup_.dataset.id=this.id:e.utils.userAgent.IE&&this.svgGroup_.setAttribute("data-id",this.id)},e.utils.object.inherits(e.BlockSvg,e.Block),e.BlockSvg.prototype.height=0,e.BlockSvg.prototype.width=0,e.BlockSvg.prototype.warningTextDb_=null,e.BlockSvg.INLINE=-1,e.BlockSvg.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",e.BlockSvg.prototype.initSvg=function(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(var n,t=0;n=this.inputList[t];t++)n.init();for(n=this.getIcons(),t=0;t<n.length;t++)n[t].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),t=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!t||e.browserEvents.conditionalBind(t,"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,t.parentNode||this.workspace.getCanvas().appendChild(t)},e.BlockSvg.prototype.getColourSecondary=function(){return this.style.colourSecondary},e.BlockSvg.prototype.getColourTertiary=function(){return this.style.colourTertiary},e.BlockSvg.prototype.getColourShadow=function(){return e.utils.deprecation.warn("BlockSvg.prototype.getColourShadow","January 2020","January 2021","style.colourSecondary"),this.getColourSecondary()},e.BlockSvg.prototype.getColourBorder=function(){return e.utils.deprecation.warn("BlockSvg.prototype.getColourBorder","January 2020","January 2021","style.colourTertiary"),{colourBorder:this.getColourTertiary(),colourLight:null,colourDark:null}},e.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(e.selected!=this){var t=null;if(e.selected){t=e.selected.id,e.Events.disable();try{e.selected.unselect()}finally{e.Events.enable()}}t=new(e.Events.get(e.Events.SELECTED))(t,this.id,this.workspace.id),e.Events.fire(t),e.selected=this,this.addSelect()}},e.BlockSvg.prototype.unselect=function(){if(e.selected==this){var t=new(e.Events.get(e.Events.SELECTED))(this.id,null,this.workspace.id);t.workspaceId=this.workspace.id,e.Events.fire(t),e.selected=null,this.removeSelect()}},e.BlockSvg.prototype.mutator=null,e.BlockSvg.prototype.comment=null,e.BlockSvg.prototype.commentIcon_=null,e.BlockSvg.prototype.warning=null,e.BlockSvg.prototype.getIcons=function(){var t=[];return this.mutator&&t.push(this.mutator),this.commentIcon_&&t.push(this.commentIcon_),this.warning&&t.push(this.warning),t},e.BlockSvg.prototype.setParent=function(t){var n=this.parentBlock_;if(t!=n){e.utils.dom.startTextWidthCache(),e.BlockSvg.superClass_.setParent.call(this,t),e.utils.dom.stopTextWidthCache();var o=this.getSvgRoot();if(!this.workspace.isClearing&&o){var r=this.getRelativeToSurfaceXY();t?(t.getSvgRoot().appendChild(o),t=this.getRelativeToSurfaceXY(),this.moveConnections(t.x-r.x,t.y-r.y)):n&&(this.workspace.getCanvas().appendChild(o),this.translate(r.x,r.y)),this.applyColour()}}},e.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var t=0,n=0,o=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null,r=this.getSvgRoot();if(r)do{var a=e.utils.getRelativeXY(r);t+=a.x,n+=a.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()==r&&(t+=(a=this.workspace.getBlockDragSurface().getSurfaceTranslation()).x,n+=a.y),r=r.parentNode}while(r&&r!=this.workspace.getCanvas()&&r!=o);return new e.utils.Coordinate(t,n)},e.BlockSvg.prototype.moveBy=function(t,n){if(this.parentBlock_)throw Error("Block has parent.");var o=e.Events.isEnabled();if(o)var r=new(e.Events.get(e.Events.BLOCK_MOVE))(this);var a=this.getRelativeToSurfaceXY();this.translate(a.x+t,a.y+n),this.moveConnections(t,n),o&&(r.recordNew(),e.Events.fire(r)),this.workspace.resizeContents()},e.BlockSvg.prototype.translate=function(t,n){this.getSvgRoot().setAttribute("transform","translate("+t+","+n+")")},e.BlockSvg.prototype.moveToDragSurface=function(){if(this.useDragSurface_){var t=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(t.x,t.y),(t=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(t)}},e.BlockSvg.prototype.moveTo=function(t){var n=this.getRelativeToSurfaceXY();this.moveBy(t.x-n.x,t.y-n.y)},e.BlockSvg.prototype.moveOffDragSurface=function(t){this.useDragSurface_&&(this.translate(t.x,t.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))},e.BlockSvg.prototype.moveDuringDrag=function(t){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},e.BlockSvg.prototype.clearTransformAttributes_=function(){this.getSvgRoot().removeAttribute("transform")},e.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var t=this.workspace.getGrid();if(t&&t.shouldSnap()){var n=t.getSpacing(),o=n/2,r=this.getRelativeToSurfaceXY();t=Math.round((r.x-o)/n)*n+o-r.x,n=Math.round((r.y-o)/n)*n+o-r.y,t=Math.round(t),n=Math.round(n),0==t&&0==n||this.moveBy(t,n)}}},e.BlockSvg.prototype.getBoundingRectangle=function(){var t=this.getRelativeToSurfaceXY(),n=this.getHeightWidth();if(this.RTL)var o=t.x-n.width,r=t.x;else o=t.x,r=t.x+n.width;return new e.utils.Rect(t.y,t.y+n.height,o,r)},e.BlockSvg.prototype.markDirty=function(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(var n,t=0;n=this.inputList[t];t++)n.markDirty()},e.BlockSvg.prototype.setCollapsed=function(t){this.collapsed_!=t&&(e.BlockSvg.superClass_.setCollapsed.call(this,t),t?this.rendered&&this.render():this.updateCollapsed_())},e.BlockSvg.prototype.updateCollapsed_=function(){for(var a,t=this.isCollapsed(),n=e.constants.COLLAPSED_INPUT_NAME,o=e.constants.COLLAPSED_FIELD_NAME,r=0;a=this.inputList[r];r++)a.name!=n&&a.setVisible(!t);if(t){for(a=this.getIcons(),r=0;t=a[r];r++)t.setVisible(!1);r=this.toString(e.COLLAPSE_CHARS),(a=this.getField(o))?a.setValue(r):(a=this.getInput(n)||this.appendDummyInput(n)).appendField(new e.FieldLabel(r),o)}else this.updateDisabled(),this.removeInput(n)},e.BlockSvg.prototype.tab=function(t,n){var o=new e.TabNavigateCursor;o.setCurNode(e.ASTNode.createFieldNode(t)),t=o.getCurNode(),n?o.next():o.prev(),(n=o.getCurNode())&&n!==t&&(n.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(n))},e.BlockSvg.prototype.onMouseDown_=function(t){var n=this.workspace&&this.workspace.getGesture(t);n&&n.handleBlockStart(t,this)},e.BlockSvg.prototype.showHelp=function(){var t="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;t&&window.open(t)},e.BlockSvg.prototype.generateContextMenu=function(){if(this.workspace.options.readOnly||!this.contextMenu)return null;var t=e.ContextMenuRegistry.registry.getContextMenuOptions(e.ContextMenuRegistry.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(t),t},e.BlockSvg.prototype.showContextMenu=function(t){var n=this.generateContextMenu();n&&n.length&&(e.ContextMenu.show(t,n,this.RTL),e.ContextMenu.currentBlock=this)},e.BlockSvg.prototype.moveConnections=function(t,n){if(this.rendered){for(var o=this.getConnections_(!1),r=0;r<o.length;r++)o[r].moveBy(t,n);for(o=this.getIcons(),r=0;r<o.length;r++)o[r].computeIconLocation();for(r=0;r<this.childBlocks_.length;r++)this.childBlocks_[r].moveConnections(t,n)}},e.BlockSvg.prototype.setDragging=function(t){if(t){var n=this.getSvgRoot();n.translate_="",n.skew_="",e.draggingConnections=e.draggingConnections.concat(this.getConnections_(!0)),e.utils.dom.addClass(this.svgGroup_,"blocklyDragging")}else e.draggingConnections=[],e.utils.dom.removeClass(this.svgGroup_,"blocklyDragging");for(n=0;n<this.childBlocks_.length;n++)this.childBlocks_[n].setDragging(t)},e.BlockSvg.prototype.setMovable=function(t){e.BlockSvg.superClass_.setMovable.call(this,t),this.pathObject.updateMovable(t)},e.BlockSvg.prototype.setEditable=function(t){e.BlockSvg.superClass_.setEditable.call(this,t),t=this.getIcons();for(var n=0;n<t.length;n++)t[n].updateEditable()},e.BlockSvg.prototype.setShadow=function(t){e.BlockSvg.superClass_.setShadow.call(this,t),this.applyColour()},e.BlockSvg.prototype.setInsertionMarker=function(t){this.isInsertionMarker_!=t&&(this.isInsertionMarker_=t)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))},e.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},e.BlockSvg.prototype.dispose=function(t,n){if(this.workspace){e.Tooltip.dispose(),e.Tooltip.unbindMouseEvents(this.pathObject.svgPath),e.utils.dom.startTextWidthCache();var o=this.workspace;if(e.selected==this&&(this.unselect(),this.workspace.cancelCurrentGesture()),e.ContextMenu.currentBlock==this&&e.ContextMenu.hide(),n&&this.rendered&&(this.unplug(t),e.blockAnimations.disposeUiEffect(this)),this.rendered=!1,this.warningTextDb_){for(var r in this.warningTextDb_)clearTimeout(this.warningTextDb_[r]);this.warningTextDb_=null}for(n=this.getIcons(),r=0;r<n.length;r++)n[r].dispose();e.BlockSvg.superClass_.dispose.call(this,!!t),e.utils.dom.removeNode(this.svgGroup_),o.resizeContents(),this.svgGroup_=null,e.utils.dom.stopTextWidthCache()}},e.BlockSvg.prototype.toCopyData=function(){if(this.isInsertionMarker_)return null;var t=e.Xml.blockToDom(this,!0);e.Xml.deleteNext(t);var n=this.getRelativeToSurfaceXY();return t.setAttribute("x",this.RTL?-n.x:n.x),t.setAttribute("y",n.y),{xml:t,source:this.workspace,typeCounts:e.utils.getBlockTypeCounts(this,!0)}},e.BlockSvg.prototype.applyColour=function(){this.pathObject.applyColour(this);for(var t=this.getIcons(),n=0;n<t.length;n++)t[n].applyColour();for(t=0;n=this.inputList[t];t++)for(var r,o=0;r=n.fieldRow[o];o++)r.applyColour()},e.BlockSvg.prototype.updateDisabled=function(){var t=this.getChildren(!1);if(this.applyColour(),!this.isCollapsed())for(var o,n=0;o=t[n];n++)o.rendered&&o.updateDisabled()},e.BlockSvg.prototype.getCommentIcon=function(){return this.commentIcon_},e.BlockSvg.prototype.setCommentText=function(t){if(!e.Comment)throw Error("Missing require for Blockly.Comment");this.commentModel.text!=t&&(e.BlockSvg.superClass_.setCommentText.call(this,t),!!this.commentIcon_==(t=null!=t)?this.commentIcon_.updateText():(t?this.comment=this.commentIcon_=new e.Comment(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))},e.BlockSvg.prototype.setWarningText=function(t,n){if(!e.Warning)throw Error("Missing require for Blockly.Warning");this.warningTextDb_||(this.warningTextDb_=Object.create(null));var o=n||"";if(o)this.warningTextDb_[o]&&(clearTimeout(this.warningTextDb_[o]),delete this.warningTextDb_[o]);else for(var r in this.warningTextDb_)clearTimeout(this.warningTextDb_[r]),delete this.warningTextDb_[r];if(this.workspace.isDragging()){var a=this;this.warningTextDb_[o]=setTimeout(function(){a.workspace&&(delete a.warningTextDb_[o],a.setWarningText(t,o))},100)}else{if(this.isInFlyout&&(t=null),n=!1,"string"==typeof t){r=this.getSurroundParent();for(var h=null;r;)r.isCollapsed()&&(h=r),r=r.getSurroundParent();h&&h.setWarningText(e.Msg.COLLAPSED_WARNINGS_WARNING,e.BlockSvg.COLLAPSED_WARNING_ID),this.warning||(this.warning=new e.Warning(this),n=!0),this.warning.setText(t,o)}else this.warning&&!o?(this.warning.dispose(),n=!0):this.warning&&(n=this.warning.getText(),this.warning.setText("",o),(r=this.warning.getText())||this.warning.dispose(),n=n!=r);n&&this.rendered&&(this.render(),this.bumpNeighbours())}},e.BlockSvg.prototype.setMutator=function(t){this.mutator&&this.mutator!==t&&this.mutator.dispose(),t&&(t.setBlock(this),this.mutator=t,t.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setEnabled=function(t){this.isEnabled()!=t&&(e.BlockSvg.superClass_.setEnabled.call(this,t),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())},e.BlockSvg.prototype.setHighlighted=function(t){this.rendered&&this.pathObject.updateHighlighted(t)},e.BlockSvg.prototype.addSelect=function(){this.pathObject.updateSelected(!0)},e.BlockSvg.prototype.removeSelect=function(){this.pathObject.updateSelected(!1)},e.BlockSvg.prototype.setDeleteStyle=function(t){this.pathObject.updateDraggingDelete(t)},e.BlockSvg.prototype.getColour=function(){return this.style.colourPrimary},e.BlockSvg.prototype.setColour=function(t){e.BlockSvg.superClass_.setColour.call(this,t),t=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(t.style),this.style=t.style,this.styleName_=t.name,this.applyColour()},e.BlockSvg.prototype.setStyle=function(t){var n=this.workspace.getRenderer().getConstants().getBlockStyle(t);if(this.styleName_=t,!n)throw Error("Invalid style name: "+t);this.hat=n.hat,this.pathObject.setStyle(n),this.colour_=n.colourPrimary,this.style=n,this.applyColour()},e.BlockSvg.prototype.bringToFront=function(){var t=this;do{var n=t.getSvgRoot(),o=n.parentNode,r=o.childNodes;r[r.length-1]!==n&&o.appendChild(n),t=t.getParent()}while(t)},e.BlockSvg.prototype.setPreviousStatement=function(t,n){e.BlockSvg.superClass_.setPreviousStatement.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setNextStatement=function(t,n){e.BlockSvg.superClass_.setNextStatement.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setOutput=function(t,n){e.BlockSvg.superClass_.setOutput.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.setInputsInline=function(t){e.BlockSvg.superClass_.setInputsInline.call(this,t),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.removeInput=function(t,n){return t=e.BlockSvg.superClass_.removeInput.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours()),t},e.BlockSvg.prototype.moveNumberedInputBefore=function(t,n){e.BlockSvg.superClass_.moveNumberedInputBefore.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours())},e.BlockSvg.prototype.appendInput_=function(t,n){return t=e.BlockSvg.superClass_.appendInput_.call(this,t,n),this.rendered&&(this.render(),this.bumpNeighbours()),t},e.BlockSvg.prototype.setConnectionTracking=function(t){if(this.previousConnection&&this.previousConnection.setTracking(t),this.outputConnection&&this.outputConnection.setTracking(t),this.nextConnection){this.nextConnection.setTracking(t);var n=this.nextConnection.targetBlock();n&&n.setConnectionTracking(t)}if(!this.collapsed_)for(n=0;n<this.inputList.length;n++){var o=this.inputList[n].connection;o&&(o.setTracking(t),(o=o.targetBlock())&&o.setConnectionTracking(t))}},e.BlockSvg.prototype.getConnections_=function(t){var n=[];if((t||this.rendered)&&(this.outputConnection&&n.push(this.outputConnection),this.previousConnection&&n.push(this.previousConnection),this.nextConnection&&n.push(this.nextConnection),t||!this.collapsed_)){t=0;for(var o;o=this.inputList[t];t++)o.connection&&n.push(o.connection)}return n},e.BlockSvg.prototype.lastConnectionInStack=function(t){return e.BlockSvg.superClass_.lastConnectionInStack.call(this,t)},e.BlockSvg.prototype.getMatchingConnection=function(t,n){return e.BlockSvg.superClass_.getMatchingConnection.call(this,t,n)},e.BlockSvg.prototype.makeConnection_=function(t){return new e.RenderedConnection(this,t)},e.BlockSvg.prototype.bumpNeighbours=function(){if(this.workspace&&!this.workspace.isDragging()){var t=this.getRootBlock();if(!t.isInFlyout)for(var r,n=this.getConnections_(!1),o=0;r=n[o];o++){r.isConnected()&&r.isSuperior()&&r.targetBlock().bumpNeighbours();for(var R,a=r.neighbours(e.SNAP_RADIUS),h=0;R=a[h];h++)r.isConnected()&&R.isConnected()||R.getSourceBlock().getRootBlock()!=t&&(r.isSuperior()?R.bumpAwayFrom(r):r.bumpAwayFrom(R))}}},e.BlockSvg.prototype.scheduleSnapAndBump=function(){var t=this,n=e.Events.getGroup();setTimeout(function(){e.Events.setGroup(n),t.snapToGrid(),e.Events.setGroup(!1)},e.BUMP_DELAY/2),setTimeout(function(){e.Events.setGroup(n),t.bumpNeighbours(),e.Events.setGroup(!1)},e.BUMP_DELAY)},e.BlockSvg.prototype.positionNearConnection=function(t,n){t.type!=e.connectionTypes.NEXT_STATEMENT&&t.type!=e.connectionTypes.INPUT_VALUE||this.moveBy(n.x-t.x,n.y-t.y)},e.BlockSvg.prototype.getParent=function(){return e.BlockSvg.superClass_.getParent.call(this)},e.BlockSvg.prototype.getRootBlock=function(){return e.BlockSvg.superClass_.getRootBlock.call(this)},e.BlockSvg.prototype.render=function(t){if(!this.renderIsInProgress_){this.renderIsInProgress_=!0;try{if(this.rendered=!0,e.utils.dom.startTextWidthCache(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),!1!==t){var n=this.getParent();n?n.render(!0):this.workspace.resizeContents()}e.utils.dom.stopTextWidthCache(),this.updateMarkers_()}finally{this.renderIsInProgress_=!1}}},e.BlockSvg.prototype.updateMarkers_=function(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(e.MarkerManager.LOCAL_MARKER).draw()},e.BlockSvg.prototype.updateConnectionLocations_=function(){var t=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(t),this.outputConnection&&this.outputConnection.moveToOffset(t);for(var n=0;n<this.inputList.length;n++){var o=this.inputList[n].connection;o&&(o.moveToOffset(t),o.isConnected()&&o.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(t),this.nextConnection.isConnected()&&this.nextConnection.tighten())},e.BlockSvg.prototype.setCursorSvg=function(t){this.pathObject.setCursorSvg(t)},e.BlockSvg.prototype.setMarkerSvg=function(t){this.pathObject.setMarkerSvg(t)},e.BlockSvg.prototype.getHeightWidth=function(){var t=this.height,n=this.width,o=this.getNextBlock();if(o){o=o.getHeightWidth();var r=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;t+=o.height-r,n=Math.max(n,o.width)}return{height:t,width:n}},e.BlockSvg.prototype.fadeForReplacement=function(t){this.pathObject.updateReplacementFade(t)},e.BlockSvg.prototype.highlightShapeForInput=function(t,n){this.pathObject.updateShapeForInputHighlight(t,n)},e.ConnectionDB=function(t){this.connections_=[],this.connectionChecker_=t},e.ConnectionDB.prototype.addConnection=function(t,n){n=this.calculateIndexForYPos_(n),this.connections_.splice(n,0,t)},e.ConnectionDB.prototype.findIndexOfConnection_=function(t,n){if(!this.connections_.length)return-1;var o=this.calculateIndexForYPos_(n);if(o>=this.connections_.length)return-1;n=t.y;for(var r=o;0<=r&&this.connections_[r].y==n;){if(this.connections_[r]==t)return r;r--}for(r=o;r<this.connections_.length&&this.connections_[r].y==n;){if(this.connections_[r]==t)return r;r++}return-1},e.ConnectionDB.prototype.calculateIndexForYPos_=function(t){if(!this.connections_.length)return 0;for(var n=0,o=this.connections_.length;n<o;){var r=Math.floor((n+o)/2);if(this.connections_[r].y<t)n=r+1;else{if(!(this.connections_[r].y>t)){n=r;break}o=r}}return n},e.ConnectionDB.prototype.removeConnection=function(t,n){if(-1==(t=this.findIndexOfConnection_(t,n)))throw Error("Unable to find connection in connectionDB.");this.connections_.splice(t,1)},e.ConnectionDB.prototype.getNeighbours=function(t,n){function o(nt){var et=a-r[nt].x,Et=h-r[nt].y;return Math.sqrt(et*et+Et*Et)<=n&&W.push(r[nt]),Et<n}var r=this.connections_,a=t.x,h=t.y;t=0;for(var R=r.length-2,L=R;t<L;)r[L].y<h?t=L:R=L,L=Math.floor((t+R)/2);var W=[];if(R=t=L,r.length){for(;0<=t&&o(t);)t--;do{R++}while(R<r.length&&o(R))}return W},e.ConnectionDB.prototype.isInYRange_=function(t,n,o){return Math.abs(this.connections_[t].y-n)<=o},e.ConnectionDB.prototype.searchForClosest=function(t,n,o){if(!this.connections_.length)return{connection:null,radius:n};var r=t.y,a=t.x;t.x=a+o.x,t.y=r+o.y;var h=this.calculateIndexForYPos_(t.y);o=null;for(var L,R=n,W=h-1;0<=W&&this.isInYRange_(W,t.y,n);)this.connectionChecker_.canConnect(t,L=this.connections_[W],!0,R)&&(o=L,R=L.distanceFrom(t)),W--;for(;h<this.connections_.length&&this.isInYRange_(h,t.y,n);)this.connectionChecker_.canConnect(t,L=this.connections_[h],!0,R)&&(o=L,R=L.distanceFrom(t)),h++;return t.x=a,t.y=r,{connection:o,radius:R}},e.ConnectionDB.init=function(t){var n=[];return n[e.connectionTypes.INPUT_VALUE]=new e.ConnectionDB(t),n[e.connectionTypes.OUTPUT_VALUE]=new e.ConnectionDB(t),n[e.connectionTypes.NEXT_STATEMENT]=new e.ConnectionDB(t),n[e.connectionTypes.PREVIOUS_STATEMENT]=new e.ConnectionDB(t),n},e.Events.ThemeChange=function(t,n){e.Events.ThemeChange.superClass_.constructor.call(this,n),this.themeName=t},e.utils.object.inherits(e.Events.ThemeChange,e.Events.UiBase),e.Events.ThemeChange.prototype.type=e.Events.THEME_CHANGE,e.Events.ThemeChange.prototype.toJson=function(){var t=e.Events.ThemeChange.superClass_.toJson.call(this);return t.themeName=this.themeName,t},e.Events.ThemeChange.prototype.fromJson=function(t){e.Events.ThemeChange.superClass_.fromJson.call(this,t),this.themeName=t.themeName},e.registry.register(e.registry.Type.EVENT,e.Events.THEME_CHANGE,e.Events.ThemeChange),e.Events.ViewportChange=function(t,n,o,r,a){e.Events.ViewportChange.superClass_.constructor.call(this,r),this.viewTop=t,this.viewLeft=n,this.scale=o,this.oldScale=a},e.utils.object.inherits(e.Events.ViewportChange,e.Events.UiBase),e.Events.ViewportChange.prototype.type=e.Events.VIEWPORT_CHANGE,e.Events.ViewportChange.prototype.toJson=function(){var t=e.Events.ViewportChange.superClass_.toJson.call(this);return t.viewTop=this.viewTop,t.viewLeft=this.viewLeft,t.scale=this.scale,t.oldScale=this.oldScale,t},e.Events.ViewportChange.prototype.fromJson=function(t){e.Events.ViewportChange.superClass_.fromJson.call(this,t),this.viewTop=t.viewTop,this.viewLeft=t.viewLeft,this.scale=t.scale,this.oldScale=t.oldScale},e.registry.register(e.registry.Type.EVENT,e.Events.VIEWPORT_CHANGE,e.Events.ViewportChange),e.IMetricsManager=function(){},e.MetricsManager=function(t){this.workspace_=t},e.MetricsManager.prototype.getDimensionsPx_=function(t){var n=0,o=0;return t&&(n=t.getWidth(),o=t.getHeight()),new e.utils.Size(n,o)},e.MetricsManager.prototype.getFlyoutMetrics=function(t){return{width:(t=this.getDimensionsPx_(this.workspace_.getFlyout(t))).width,height:t.height,position:this.workspace_.toolboxPosition}},e.MetricsManager.prototype.getToolboxMetrics=function(){var t=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}},e.MetricsManager.prototype.getSvgMetrics=function(){return this.workspace_.getCachedParentSvgSize()},e.MetricsManager.prototype.getAbsoluteMetrics=function(){var t=0,n=this.getToolboxMetrics(),o=this.getFlyoutMetrics(!0),r=!!this.workspace_.getToolbox(),a=!!this.workspace_.getFlyout(!0),h=r?n.position:o.position,R=h==e.utils.toolbox.Position.LEFT;return h=h==e.utils.toolbox.Position.TOP,r&&R?t=n.width:a&&R&&(t=o.width),R=0,r&&h?R=n.height:a&&h&&(R=o.height),{top:R,left:t}},e.MetricsManager.prototype.getViewMetrics=function(t){t=t?this.workspace_.scale:1;var n=this.getSvgMetrics(),o=this.getToolboxMetrics(),r=this.getFlyoutMetrics(!0),a=this.workspace_.getToolbox()?o.position:r.position;return this.workspace_.getToolbox()?a==e.utils.toolbox.Position.TOP||a==e.utils.toolbox.Position.BOTTOM?n.height-=o.height:(a==e.utils.toolbox.Position.LEFT||a==e.utils.toolbox.Position.RIGHT)&&(n.width-=o.width):this.workspace_.getFlyout(!0)&&(a==e.utils.toolbox.Position.TOP||a==e.utils.toolbox.Position.BOTTOM?n.height-=r.height:(a==e.utils.toolbox.Position.LEFT||a==e.utils.toolbox.Position.RIGHT)&&(n.width-=r.width)),{height:n.height/t,width:n.width/t,top:-this.workspace_.scrollY/t,left:-this.workspace_.scrollX/t}},e.MetricsManager.prototype.getContentMetrics=function(t){t=t?1:this.workspace_.scale;var n=this.workspace_.getBlocksBoundingBox();return{height:(n.bottom-n.top)*t,width:(n.right-n.left)*t,top:n.top*t,left:n.left*t}},e.MetricsManager.prototype.hasFixedEdges=function(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()},e.MetricsManager.prototype.getComputedFixedEdges_=function(t){if(!this.hasFixedEdges())return{};var n=this.workspace_.isMovableHorizontally(),o=this.workspace_.isMovableVertically();t=t||this.getViewMetrics(!1);var r={};return o||(r.top=t.top,r.bottom=t.top+t.height),n||(r.left=t.left,r.right=t.left+t.width),r},e.MetricsManager.prototype.getPaddedContent_=function(t,n){var o=n.top+n.height,r=n.left+n.width,a=t.width,h=a/2,R=(t=t.height)/2;return{top:Math.min(n.top-R,o-t),bottom:Math.max(o+R,n.top+t),left:Math.min(n.left-h,r-a),right:Math.max(r+h,n.left+a)}},e.MetricsManager.prototype.getScrollMetrics=function(t,n,o){t=t?this.workspace_.scale:1,n=n||this.getViewMetrics(!1);var r=o||this.getContentMetrics();o=this.getComputedFixedEdges_(n),n=this.getPaddedContent_(n,r);var a=void 0!==o.left?o.left:n.left;return{top:(r=void 0!==o.top?o.top:n.top)/t,left:a/t,width:((void 0!==o.right?o.right:n.right)-a)/t,height:((void 0!==o.bottom?o.bottom:n.bottom)-r)/t}},e.MetricsManager.prototype.getUiMetrics=function(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}},e.MetricsManager.prototype.getMetrics=function(){var t=this.getToolboxMetrics(),n=this.getFlyoutMetrics(!0),o=this.getSvgMetrics(),r=this.getAbsoluteMetrics(),a=this.getViewMetrics(),h=this.getContentMetrics(),R=this.getScrollMetrics(!1,a,h);return{contentHeight:h.height,contentWidth:h.width,contentTop:h.top,contentLeft:h.left,scrollHeight:R.height,scrollWidth:R.width,scrollTop:R.top,scrollLeft:R.left,viewHeight:a.height,viewWidth:a.width,viewTop:a.top,viewLeft:a.left,absoluteTop:r.top,absoluteLeft:r.left,svgHeight:o.height,svgWidth:o.width,toolboxWidth:t.width,toolboxHeight:t.height,toolboxPosition:t.position,flyoutWidth:n.width,flyoutHeight:n.height}},e.registry.register(e.registry.Type.METRICS_MANAGER,e.registry.DEFAULT,e.MetricsManager),e.FlyoutMetricsManager=function(t,n){this.flyout_=n,e.FlyoutMetricsManager.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.FlyoutMetricsManager,e.MetricsManager),e.FlyoutMetricsManager.prototype.getBoundingBox_=function(){try{var t=this.workspace_.getCanvas().getBBox()}catch(n){t={height:0,y:0,width:0,x:0}}return t},e.FlyoutMetricsManager.prototype.getContentMetrics=function(t){var n=this.getBoundingBox_();return{height:n.height*(t=t?1:this.workspace_.scale),width:n.width*t,top:n.y*t,left:n.x*t}},e.FlyoutMetricsManager.prototype.getScrollMetrics=function(t,n,o){return{height:((n=o||this.getContentMetrics()).height+2*(o=this.flyout_.MARGIN*this.workspace_.scale))/(t=t?this.workspace_.scale:1),width:(n.width+n.left+o)/t,top:0,left:0}},e.ThemeManager=function(t,n){this.workspace_=t,this.theme_=n,this.subscribedWorkspaces_=[],this.componentDB_=Object.create(null)},e.ThemeManager.prototype.getTheme=function(){return this.theme_},e.ThemeManager.prototype.setTheme=function(t){var o,n=this.theme_;for(this.theme_=t,(t=this.workspace_.getInjectionDiv())&&(n&&e.utils.dom.removeClass(t,n.getClassName()),e.utils.dom.addClass(t,this.theme_.getClassName())),n=0;t=this.subscribedWorkspaces_[n];n++)t.refreshTheme();for(n=0,t=Object.keys(this.componentDB_);o=t[n];n++)for(var a,r=0;a=this.componentDB_[o][r];r++){var h=a.element;a=a.propertyName;var R=this.theme_&&this.theme_.getComponentStyle(o);h.style[a]=R||""}e.hideChaff()},e.ThemeManager.prototype.subscribeWorkspace=function(t){this.subscribedWorkspaces_.push(t)},e.ThemeManager.prototype.unsubscribeWorkspace=function(t){if(0>(t=this.subscribedWorkspaces_.indexOf(t)))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.");this.subscribedWorkspaces_.splice(t,1)},e.ThemeManager.prototype.subscribe=function(t,n,o){this.componentDB_[n]||(this.componentDB_[n]=[]),this.componentDB_[n].push({element:t,propertyName:o}),n=this.theme_&&this.theme_.getComponentStyle(n),t.style[o]=n||""},e.ThemeManager.prototype.unsubscribe=function(t){if(t)for(var r,n=Object.keys(this.componentDB_),o=0;r=n[o];o++){for(var a=this.componentDB_[r],h=a.length-1;0<=h;h--)a[h].element===t&&a.splice(h,1);this.componentDB_[r].length||delete this.componentDB_[r]}},e.ThemeManager.prototype.dispose=function(){this.componentDB_=this.subscribedWorkspaces_=this.theme_=this.owner_=null},e.TouchGesture=function(t,n){e.TouchGesture.superClass_.constructor.call(this,t,n),this.isMultiTouch_=!1,this.cachedPoints_=Object.create(null),this.startDistance_=this.previousScale_=0,this.isPinchZoomEnabled_=this.onStartWrapper_=null},e.utils.object.inherits(e.TouchGesture,e.Gesture),e.TouchGesture.ZOOM_IN_MULTIPLIER=5,e.TouchGesture.ZOOM_OUT_MULTIPLIER=6,e.TouchGesture.prototype.doStart=function(t){this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,e.TouchGesture.superClass_.doStart.call(this,t),!this.isEnding_&&e.Touch.isTouchEvent(t)&&this.handleTouchStart(t)},e.TouchGesture.prototype.bindMouseEvents=function(t){this.onStartWrapper_=e.browserEvents.conditionalBind(document,"mousedown",null,this.handleStart.bind(this),!0),this.onMoveWrapper_=e.browserEvents.conditionalBind(document,"mousemove",null,this.handleMove.bind(this),!0),this.onUpWrapper_=e.browserEvents.conditionalBind(document,"mouseup",null,this.handleUp.bind(this),!0),t.preventDefault(),t.stopPropagation()},e.TouchGesture.prototype.handleStart=function(t){!this.isDragging()&&e.Touch.isTouchEvent(t)&&(this.handleTouchStart(t),this.isMultiTouch()&&e.longStop_())},e.TouchGesture.prototype.handleMove=function(t){this.isDragging()?e.Touch.shouldHandleEvent(t)&&e.TouchGesture.superClass_.handleMove.call(this,t):this.isMultiTouch()?(e.Touch.isTouchEvent(t)&&this.handleTouchMove(t),e.longStop_()):e.TouchGesture.superClass_.handleMove.call(this,t)},e.TouchGesture.prototype.handleUp=function(t){e.Touch.isTouchEvent(t)&&!this.isDragging()&&this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()?e.Touch.shouldHandleEvent(t)&&e.TouchGesture.superClass_.handleUp.call(this,t):(t.preventDefault(),t.stopPropagation(),this.dispose())},e.TouchGesture.prototype.isMultiTouch=function(){return this.isMultiTouch_},e.TouchGesture.prototype.dispose=function(){e.TouchGesture.superClass_.dispose.call(this),this.onStartWrapper_&&e.browserEvents.unbind(this.onStartWrapper_)},e.TouchGesture.prototype.handleTouchStart=function(t){var n=e.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[n]=this.getTouchPoint(t),2==(n=Object.keys(this.cachedPoints_)).length&&(this.startDistance_=e.utils.Coordinate.distance(this.cachedPoints_[n[0]],this.cachedPoints_[n[1]]),this.isMultiTouch_=!0,t.preventDefault())},e.TouchGesture.prototype.handleTouchMove=function(t){var n=e.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[n]=this.getTouchPoint(t),n=Object.keys(this.cachedPoints_),this.isPinchZoomEnabled_&&2===n.length?this.handlePinch_(t):e.TouchGesture.superClass_.handleMove.call(this,t)},e.TouchGesture.prototype.handlePinch_=function(t){var n=Object.keys(this.cachedPoints_);if(n=e.utils.Coordinate.distance(this.cachedPoints_[n[0]],this.cachedPoints_[n[1]])/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){var o=n-this.previousScale_;o=0<o?o*e.TouchGesture.ZOOM_IN_MULTIPLIER:o*e.TouchGesture.ZOOM_OUT_MULTIPLIER;var r=this.startWorkspace_,a=e.utils.mouseToSvg(t,r.getParentSvg(),r.getInverseScreenCTM());r.zoom(a.x,a.y,o)}this.previousScale_=n,t.preventDefault()},e.TouchGesture.prototype.handleTouchEnd=function(t){t=e.Touch.getTouchIdentifierFromEvent(t),this.cachedPoints_[t]&&delete this.cachedPoints_[t],2>Object.keys(this.cachedPoints_).length&&(this.cachedPoints_=Object.create(null),this.previousScale_=0)},e.TouchGesture.prototype.getTouchPoint=function(t){return this.startWorkspace_?new e.utils.Coordinate(t.pageX?t.pageX:t.changedTouches[0].pageX,t.pageY?t.pageY:t.changedTouches[0].pageY):null},e.WorkspaceAudio=function(t){this.parentWorkspace_=t,this.SOUNDS_=Object.create(null)},e.WorkspaceAudio.prototype.lastSound_=null,e.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},e.WorkspaceAudio.prototype.load=function(t,n){if(t.length){try{var o=new e.utils.global.Audio}catch(L){return}for(var r,a=0;a<t.length;a++){var h=t[a],R=h.match(/\.(\w+)$/);if(R&&o.canPlayType("audio/"+R[1])){r=new e.utils.global.Audio(h);break}}r&&r.play&&(this.SOUNDS_[n]=r)}},e.WorkspaceAudio.prototype.preload=function(){for(var t in this.SOUNDS_){var n=this.SOUNDS_[t];n.volume=.01;var o=n.play();if(void 0!==o?o.then(n.pause).catch(function(){}):n.pause(),e.utils.userAgent.IPAD||e.utils.userAgent.IPHONE)break}},e.WorkspaceAudio.prototype.play=function(t,n){var o=this.SOUNDS_[t];o?(t=new Date,null!=this.lastSound_&&t-this.lastSound_<e.SOUND_LIMIT||(this.lastSound_=t,(o=e.utils.userAgent.IPAD||e.utils.userAgent.ANDROID?o:o.cloneNode()).volume=void 0===n?1:n,o.play())):this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(t,n)},e.WorkspaceSvg=function(t,n,o){e.WorkspaceSvg.superClass_.constructor.call(this,t),this.metricsManager_=new(e.registry.getClassFromOptions(e.registry.Type.METRICS_MANAGER,t,!0))(this),this.getMetrics=t.getMetrics||this.metricsManager_.getMetrics.bind(this.metricsManager_),this.setMetrics=t.setMetrics||e.WorkspaceSvg.setTopLevelWorkspaceMetrics_,this.componentManager_=new e.ComponentManager,this.connectionDBList=e.ConnectionDB.init(this.connectionChecker),n&&(this.blockDragSurface_=n),o&&(this.workspaceDragSurface_=o),this.useWorkspaceDragSurface_=!!this.workspaceDragSurface_&&e.utils.is3dSupported(),this.highlightedBlocks_=[],this.audioManager_=new e.WorkspaceAudio(t.parentWorkspace),this.grid_=this.options.gridPattern?new e.Grid(this.options.gridPattern,t.gridOptions):null,this.markerManager_=new e.MarkerManager(this),this.toolboxCategoryCallbacks_=Object.create(null),this.flyoutButtonCallbacks_=Object.create(null),e.Variables&&e.Variables.flyoutCategory&&this.registerToolboxCategoryCallback(e.VARIABLE_CATEGORY_NAME,e.Variables.flyoutCategory),e.VariablesDynamic&&e.VariablesDynamic.flyoutCategory&&this.registerToolboxCategoryCallback(e.VARIABLE_DYNAMIC_CATEGORY_NAME,e.VariablesDynamic.flyoutCategory),e.Procedures&&e.Procedures.flyoutCategory&&(this.registerToolboxCategoryCallback(e.PROCEDURE_CATEGORY_NAME,e.Procedures.flyoutCategory),this.addChangeListener(e.Procedures.mutatorOpenListener)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new e.ThemeManager(this,this.options.theme||e.Themes.Classic),this.themeManager_.subscribeWorkspace(this),this.renderer_=e.blockRendering.init(this.options.renderer||"geras",this.getTheme(),this.options.rendererOverrides),this.cachedParentSvg_=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements_=[],this.dragTargetAreas_=[],this.cachedParentSvgSize_=new e.utils.Size(0,0)},e.utils.object.inherits(e.WorkspaceSvg,e.Workspace),e.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,e.WorkspaceSvg.prototype.rendered=!0,e.WorkspaceSvg.prototype.isVisible_=!0,e.WorkspaceSvg.prototype.isFlyout=!1,e.WorkspaceSvg.prototype.isMutator=!1,e.WorkspaceSvg.prototype.resizesEnabled_=!0,e.WorkspaceSvg.prototype.scrollX=0,e.WorkspaceSvg.prototype.scrollY=0,e.WorkspaceSvg.prototype.startScrollX=0,e.WorkspaceSvg.prototype.startScrollY=0,e.WorkspaceSvg.prototype.dragDeltaXY_=null,e.WorkspaceSvg.prototype.scale=1,e.WorkspaceSvg.prototype.oldScale_=1,e.WorkspaceSvg.prototype.oldTop_=0,e.WorkspaceSvg.prototype.oldLeft_=0,e.WorkspaceSvg.prototype.trashcan=null,e.WorkspaceSvg.prototype.scrollbar=null,e.WorkspaceSvg.prototype.flyout_=null,e.WorkspaceSvg.prototype.toolbox_=null,e.WorkspaceSvg.prototype.currentGesture_=null,e.WorkspaceSvg.prototype.blockDragSurface_=null,e.WorkspaceSvg.prototype.workspaceDragSurface_=null,e.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,e.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,e.WorkspaceSvg.prototype.injectionDiv_=null,e.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,e.WorkspaceSvg.prototype.targetWorkspace=null,e.WorkspaceSvg.prototype.inverseScreenCTM_=null,e.WorkspaceSvg.prototype.inverseScreenCTMDirty_=!0,e.WorkspaceSvg.prototype.getMarkerManager=function(){return this.markerManager_},e.WorkspaceSvg.prototype.getMetricsManager=function(){return this.metricsManager_},e.WorkspaceSvg.prototype.setMetricsManager=function(t){this.metricsManager_=t,this.getMetrics=this.metricsManager_.getMetrics.bind(this.metricsManager_)},e.WorkspaceSvg.prototype.getComponentManager=function(){return this.componentManager_},e.WorkspaceSvg.prototype.setCursorSvg=function(t){this.markerManager_.setCursorSvg(t)},e.WorkspaceSvg.prototype.setMarkerSvg=function(t){this.markerManager_.setMarkerSvg(t)},e.WorkspaceSvg.prototype.getMarker=function(t){return this.markerManager_?this.markerManager_.getMarker(t):null},e.WorkspaceSvg.prototype.getCursor=function(){return this.markerManager_?this.markerManager_.getCursor():null},e.WorkspaceSvg.prototype.getRenderer=function(){return this.renderer_},e.WorkspaceSvg.prototype.getThemeManager=function(){return this.themeManager_},e.WorkspaceSvg.prototype.getTheme=function(){return this.themeManager_.getTheme()},e.WorkspaceSvg.prototype.setTheme=function(t){t||(t=e.Themes.Classic),this.themeManager_.setTheme(t)},e.WorkspaceSvg.prototype.refreshTheme=function(){this.svgGroup_&&this.renderer_.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(n){return!!n.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);var t=new(e.Events.get(e.Events.THEME_CHANGE))(this.getTheme().name,this.id);e.Events.fire(t)},e.WorkspaceSvg.prototype.updateBlockStyles_=function(t){for(var o,n=0;o=t[n];n++){var r=o.getStyleName();r&&(o.setStyle(r),o.mutator&&o.mutator.updateBlockStyle())}},e.WorkspaceSvg.prototype.getInverseScreenCTM=function(){if(this.inverseScreenCTMDirty_){var t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM_=t.inverse(),this.inverseScreenCTMDirty_=!1)}return this.inverseScreenCTM_},e.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){this.inverseScreenCTMDirty_=!0},e.WorkspaceSvg.prototype.isVisible=function(){return this.isVisible_},e.WorkspaceSvg.prototype.getSvgXY=function(t){var n=0,o=0,r=1;(e.utils.dom.containsNode(this.getCanvas(),t)||e.utils.dom.containsNode(this.getBubbleCanvas(),t))&&(r=this.scale);do{var a=e.utils.getRelativeXY(t);(t==this.getCanvas()||t==this.getBubbleCanvas())&&(r=1),n+=a.x*r,o+=a.y*r,t=t.parentNode}while(t&&t!=this.getParentSvg());return new e.utils.Coordinate(n,o)},e.WorkspaceSvg.prototype.getCachedParentSvgSize=function(){var t=this.cachedParentSvgSize_;return new e.utils.Size(t.width,t.height)},e.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return e.utils.getInjectionDivXY_(this.getCanvas())},e.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_)for(var t=this.svgGroup_;t;){if(-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv_=t;break}t=t.parentNode}return this.injectionDiv_},e.WorkspaceSvg.prototype.getBlockCanvas=function(){return this.svgBlockCanvas_},e.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(t){this.resizeHandlerWrapper_=t},e.WorkspaceSvg.prototype.createDom=function(t){return this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyWorkspace"},null),t&&(this.svgBackground_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{height:"100%",width:"100%",class:t},this.svgGroup_),"blocklyMainBackground"==t&&this.grid_?this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(e.browserEvents.conditionalBind(this.svgGroup_,"mousedown",this,this.onMouseDown_,!1,!0),e.browserEvents.conditionalBind(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(e.registry.getClassFromOptions(e.registry.Type.TOOLBOX,this.options,!0))(this)),this.grid_&&this.grid_.update(this.scale),this.recordDragTargets(),(t=e.registry.getClassFromOptions(e.registry.Type.CURSOR,this.options))&&this.markerManager_.setCursor(new t),this.renderer_.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_},e.WorkspaceSvg.prototype.dispose=function(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&(e.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.renderer_.dispose(),this.markerManager_&&(this.markerManager_.dispose(),this.markerManager_=null),e.WorkspaceSvg.superClass_.dispose.call(this),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||(this.themeManager_.dispose(),this.themeManager_=null)),this.flyoutButtonCallbacks_=this.toolboxCategoryCallbacks_=this.connectionDBList=null,!this.options.parentWorkspace){var t=this.getParentSvg();t&&t.parentNode&&e.utils.dom.removeNode(t.parentNode)}this.resizeHandlerWrapper_&&(e.browserEvents.unbind(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},e.WorkspaceSvg.prototype.newBlock=function(t,n){return new e.BlockSvg(this,t,n)},e.WorkspaceSvg.prototype.addTrashcan=function(){if(!e.Trashcan)throw Error("Missing require for Blockly.Trashcan");this.trashcan=new e.Trashcan(this);var t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.svgBlockCanvas_)},e.WorkspaceSvg.prototype.addZoomControls=function(){if(!e.ZoomControls)throw Error("Missing require for Blockly.ZoomControls");this.zoomControls_=new e.ZoomControls(this);var t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)},e.WorkspaceSvg.prototype.addFlyout=function(t){var n=new e.Options({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return n.toolboxPosition=this.options.toolboxPosition,this.flyout_=this.horizontalLayout?new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(n):new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(n),this.flyout_.autoClose=!1,this.flyout_.getWorkspace().setVisible(!0),this.flyout_.createDom(t)},e.WorkspaceSvg.prototype.getFlyout=function(t){return this.flyout_||t?this.flyout_:this.toolbox_?this.toolbox_.getFlyout():null},e.WorkspaceSvg.prototype.getToolbox=function(){return this.toolbox_},e.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDragTargets()},e.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())},e.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position();for(var a,t=this.componentManager_.getComponents(e.ComponentManager.Capability.POSITIONABLE,!0),n=this.getMetricsManager().getUiMetrics(),o=[],r=0;a=t[r];r++)a.position(n,o),(a=a.getBoundingRectangle())&&o.push(a);this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},e.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var t=e.utils.getDocumentScroll();e.utils.Coordinate.equals(this.lastRecordedPageScroll_,t)||(this.lastRecordedPageScroll_=t,this.updateScreenCalculations_())},e.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},e.WorkspaceSvg.prototype.setCachedParentSvgSize=function(t,n){var o=this.getParentSvg();t&&(this.cachedParentSvgSize_.width=t,o.cachedWidth_=t),n&&(this.cachedParentSvgSize_.height=n,o.cachedHeight_=n)},e.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},e.WorkspaceSvg.prototype.getParentSvg=function(){if(!this.cachedParentSvg_)for(var t=this.svgGroup_;t;){if("svg"==t.tagName){this.cachedParentSvg_=t;break}t=t.parentNode}return this.cachedParentSvg_},e.WorkspaceSvg.prototype.maybeFireViewportChangeEvent=function(){if(e.Events.isEnabled()){var t=this.scale,n=-this.scrollY,o=-this.scrollX;if(!(t==this.oldScale_&&1>Math.abs(n-this.oldTop_)&&1>Math.abs(o-this.oldLeft_))){var r=new(e.Events.get(e.Events.VIEWPORT_CHANGE))(n,o,t,this.id,this.oldScale_);this.oldScale_=t,this.oldTop_=n,this.oldLeft_=o,e.Events.fire(r)}}},e.WorkspaceSvg.prototype.translate=function(t,n){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(t,n);else{var o="translate("+t+","+n+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",o),this.svgBubbleCanvas_.setAttribute("transform",o)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(t,n,this.scale),this.grid_&&this.grid_.moveTo(t,n),this.maybeFireViewportChangeEvent()},e.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var t=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),this.svgBlockCanvas_.setAttribute("transform",t="translate("+t.x+","+t.y+") scale("+this.scale+")"),this.svgBubbleCanvas_.setAttribute("transform",t)}},e.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var t=this.svgBlockCanvas_.previousSibling,n=parseInt(this.getParentSvg().getAttribute("width"),10),o=parseInt(this.getParentSvg().getAttribute("height"),10),r=e.utils.getRelativeXY(this.getCanvas());this.workspaceDragSurface_.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),t,n,o,this.scale),this.workspaceDragSurface_.translateSurface(r.x,r.y)}},e.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_},e.WorkspaceSvg.prototype.getWidth=function(){var t=this.getMetrics();return t?t.viewWidth/this.scale:0},e.WorkspaceSvg.prototype.setVisible=function(t){if(this.isVisible_=t,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&this.toolbox_.setVisible(t),t){for(var n=(t=this.getAllBlocks(!1)).length-1;0<=n;n--)t[n].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else e.hideChaff(!0)},e.WorkspaceSvg.prototype.render=function(){for(var t=this.getAllBlocks(!1),n=t.length-1;0<=n;n--)t[n].render(!1);if(this.currentGesture_)for(t=this.currentGesture_.getInsertionMarkers(),n=0;n<t.length;n++)t[n].render(!1);this.markerManager_.updateMarkers()},e.WorkspaceSvg.prototype.highlightBlock=function(t,n){if(void 0===n){for(var r,o=0;r=this.highlightedBlocks_[o];o++)r.setHighlighted(!1);this.highlightedBlocks_.length=0}(r=t?this.getBlockById(t):null)&&((t=void 0===n||n)?-1==this.highlightedBlocks_.indexOf(r)&&this.highlightedBlocks_.push(r):e.utils.arrayRemove(this.highlightedBlocks_,r),r.setHighlighted(t))},e.WorkspaceSvg.prototype.paste=function(t){!this.rendered||!t.tagName||t.getElementsByTagName("block").length>=this.remainingCapacity()||(this.currentGesture_&&this.currentGesture_.cancel(),"comment"==t.tagName.toLowerCase()?this.pasteWorkspaceComment_(t):this.pasteBlock_(t))},e.WorkspaceSvg.prototype.pasteBlock_=function(t){e.Events.disable();try{var n=e.Xml.domToBlock(t,this),o=parseInt(t.getAttribute("x"),10),r=parseInt(t.getAttribute("y"),10);if(!isNaN(o)&&!isNaN(r)){this.RTL&&(o=-o);do{t=!1;for(var R,a=this.getAllBlocks(!1),h=0;R=a[h];h++){var L=R.getRelativeToSurfaceXY();if(1>=Math.abs(o-L.x)&&1>=Math.abs(r-L.y)){t=!0;break}}if(!t){var nt,W=n.getConnections_(!1);for(h=0;nt=W[h];h++)if(nt.closest(e.SNAP_RADIUS,new e.utils.Coordinate(o,r)).connection){t=!0;break}}t&&(o=this.RTL?o-e.SNAP_RADIUS:o+e.SNAP_RADIUS,r+=2*e.SNAP_RADIUS)}while(t);n.moveBy(o,r)}}finally{e.Events.enable()}e.Events.isEnabled()&&!n.isShadow()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(n)),n.select()},e.WorkspaceSvg.prototype.pasteWorkspaceComment_=function(t){e.Events.disable();try{var n=e.WorkspaceCommentSvg.fromXml(t,this),o=parseInt(t.getAttribute("x"),10),r=parseInt(t.getAttribute("y"),10);isNaN(o)||isNaN(r)||(this.RTL&&(o=-o),n.moveBy(o+50,r+50))}finally{e.Events.enable()}e.Events.isEnabled()&&e.WorkspaceComment.fireCreateEvent(n),n.select()},e.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.getFlyout()&&t.toolbox_.refreshSelection()},e.WorkspaceSvg.prototype.renameVariableById=function(t,n){e.WorkspaceSvg.superClass_.renameVariableById.call(this,t,n),this.refreshToolboxSelection()},e.WorkspaceSvg.prototype.deleteVariableById=function(t){e.WorkspaceSvg.superClass_.deleteVariableById.call(this,t),this.refreshToolboxSelection()},e.WorkspaceSvg.prototype.createVariable=function(t,n,o){return t=e.WorkspaceSvg.superClass_.createVariable.call(this,t,n,o),this.refreshToolboxSelection(),t},e.WorkspaceSvg.prototype.recordDeleteAreas=function(){e.utils.deprecation.warn("WorkspaceSvg.prototype.recordDeleteAreas","June 2021","June 2022","WorkspaceSvg.prototype.recordDragTargets"),this.recordDragTargets()},e.WorkspaceSvg.prototype.recordDragTargets=function(){var t=this.componentManager_.getComponents(e.ComponentManager.Capability.DRAG_TARGET,!0);this.dragTargetAreas_=[];for(var o,n=0;o=t[n];n++){var r=o.getClientRect();r&&this.dragTargetAreas_.push({component:o,clientRect:r})}},e.WorkspaceSvg.prototype.getDragTarget=function(t){for(var o,n=0;o=this.dragTargetAreas_[n];n++)if(o.clientRect.contains(t.clientX,t.clientY))return o.component;return null},e.WorkspaceSvg.prototype.onMouseDown_=function(t){var n=this.getGesture(t);n&&n.handleWsStart(t,this)},e.WorkspaceSvg.prototype.startDrag=function(t,n){(t=e.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,this.dragDeltaXY_=e.utils.Coordinate.difference(n,t)},e.WorkspaceSvg.prototype.moveDrag=function(t){return(t=e.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,e.utils.Coordinate.sum(this.dragDeltaXY_,t)},e.WorkspaceSvg.prototype.isDragging=function(){return null!=this.currentGesture_&&this.currentGesture_.isDragging()},e.WorkspaceSvg.prototype.isDraggable=function(){return this.options.moveOptions&&this.options.moveOptions.drag},e.WorkspaceSvg.prototype.isMovable=function(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch},e.WorkspaceSvg.prototype.isMovableHorizontally=function(){var t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollHorizontally())},e.WorkspaceSvg.prototype.isMovableVertically=function(){var t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollVertically())},e.WorkspaceSvg.prototype.onMouseWheel_=function(t){if(e.Gesture.inProgress())t.preventDefault(),t.stopPropagation();else{var n=this.options.zoomOptions&&this.options.zoomOptions.wheel,o=this.options.moveOptions&&this.options.moveOptions.wheel;if(n||o){var r=e.utils.getScrollDeltaPixels(t);!n||!t.ctrlKey&&o?(n=this.scrollX-r.x,o=this.scrollY-r.y,t.shiftKey&&!r.x&&(n=this.scrollX-r.y,o=this.scrollY),this.scroll(n,o)):(r=-r.y/50,n=e.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(n.x,n.y,r)),t.preventDefault()}}},e.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var t=this.getTopBoundedElements();if(!t.length)return new e.utils.Rect(0,0,0,0);for(var n=t[0].getBoundingRectangle(),o=1;o<t.length;o++){var r=t[o];r.isInsertionMarker&&r.isInsertionMarker()||((r=r.getBoundingRectangle()).top<n.top&&(n.top=r.top),r.bottom>n.bottom&&(n.bottom=r.bottom),r.left<n.left&&(n.left=r.left),r.right>n.right&&(n.right=r.right))}return n},e.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(!1),e.Events.setGroup(!0);for(var r,t=this.getTopBlocks(!0),n=0,o=0;r=t[o];o++)if(r.isMovable()){var a=r.getRelativeToSurfaceXY();r.moveBy(-a.x,n-a.y),r.snapToGrid(),n=r.getRelativeToSurfaceXY().y+r.getHeightWidth().height+this.renderer_.getConstants().MIN_BLOCK_HEIGHT}e.Events.setGroup(!1),this.setResizesEnabled(!0)},e.WorkspaceSvg.prototype.showContextMenu=function(t){if(!this.options.readOnly&&!this.isFlyout){var n=e.ContextMenuRegistry.registry.getContextMenuOptions(e.ContextMenuRegistry.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(n,t),e.ContextMenu.show(t,n,this.RTL)}},e.WorkspaceSvg.prototype.updateToolbox=function(t){if(t=e.utils.toolbox.convertToolboxDefToJson(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(e.utils.toolbox.hasCategories(t)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.render(t)}else{if(!this.flyout_)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout_.show(t)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")},e.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(e.mainWorkspace=this,this.setBrowserFocus())},e.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:!0})}catch(t){try{this.getParentSvg().parentNode.setActive()}catch(n){this.getParentSvg().parentNode.focus({preventScroll:!0})}}},e.WorkspaceSvg.prototype.zoom=function(t,n,o){o=Math.pow(this.options.zoomOptions.scaleSpeed,o);var r=this.scale*o;if(this.scale!=r){r>this.options.zoomOptions.maxScale?o=this.options.zoomOptions.maxScale/this.scale:r<this.options.zoomOptions.minScale&&(o=this.options.zoomOptions.minScale/this.scale);var a=this.getCanvas().getCTM(),h=this.getParentSvg().createSVGPoint();h.x=t,h.y=n,h=h.matrixTransform(a.inverse()),a=a.translate((t=h.x)*(1-o),(n=h.y)*(1-o)).scale(o),this.scrollX=a.e,this.scrollY=a.f,this.setScale(r)}},e.WorkspaceSvg.prototype.zoomCenter=function(t){var n=this.getMetrics();if(this.flyout_){var o=n.svgWidth?n.svgWidth/2:0;n=n.svgHeight?n.svgHeight/2:0}else o=n.viewWidth/2+n.absoluteLeft,n=n.viewHeight/2+n.absoluteTop;this.zoom(o,n,t)},e.WorkspaceSvg.prototype.zoomToFit=function(){if(this.isMovable()){var t=this.getMetrics(),n=t.viewWidth;t=t.viewHeight;var o=this.getBlocksBoundingBox(),r=o.right-o.left;if(o=o.bottom-o.top,r){this.flyout_&&(this.horizontalLayout?(t+=this.flyout_.getHeight(),o+=this.flyout_.getHeight()/this.scale):(n+=this.flyout_.getWidth(),r+=this.flyout_.getWidth()/this.scale)),n/=r,t/=o,e.Events.disable();try{this.setScale(Math.min(n,t)),this.scrollCenter()}finally{e.Events.enable()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},e.WorkspaceSvg.prototype.beginCanvasTransition=function(){e.utils.dom.addClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),e.utils.dom.addClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},e.WorkspaceSvg.prototype.endCanvasTransition=function(){e.utils.dom.removeClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),e.utils.dom.removeClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},e.WorkspaceSvg.prototype.scrollCenter=function(){if(this.isMovable()){var t=this.getMetrics(),n=(t.scrollWidth-t.viewWidth)/2,o=(t.scrollHeight-t.viewHeight)/2;this.scroll(n=-n-t.scrollLeft,o=-o-t.scrollTop)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},e.WorkspaceSvg.prototype.centerOnBlock=function(t){if(this.isMovable()){if(t=t?this.getBlockById(t):null){var n=t.getRelativeToSurfaceXY(),o=t.getHeightWidth(),r=this.scale;t=(n.x+(this.RTL?-1:1)*o.width/2)*r,n=(n.y+o.height/2)*r,o=this.getMetrics(),this.scroll(-(t-o.viewWidth/2),-(n-o.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},e.WorkspaceSvg.prototype.setScale=function(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,e.hideChaff(!1),this.flyout_&&(this.flyout_.reflow(),this.recordDragTargets()),this.grid_&&this.grid_.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout_?this.scrollbar.resizeView(t):this.scrollbar.resizeContent(t))},e.WorkspaceSvg.prototype.getScale=function(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale},e.WorkspaceSvg.prototype.scroll=function(t,n){e.hideChaff(!0);var o=this.getMetrics();t=Math.min(t,-o.scrollLeft),n=Math.min(n,-o.scrollTop);var r=o.scrollTop+Math.max(0,o.scrollHeight-o.viewHeight);t=Math.max(t,-(o.scrollLeft+Math.max(0,o.scrollWidth-o.viewWidth))),n=Math.max(n,-r),this.scrollX=t,this.scrollY=n,this.scrollbar&&this.scrollbar.set(-(t+o.scrollLeft),-(n+o.scrollTop),!1),this.translate(t+=o.absoluteLeft,n+=o.absoluteTop)},e.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(t){var n=this.getMetrics();"number"==typeof t.x&&(this.scrollX=-(n.scrollLeft+(n.scrollWidth-n.viewWidth)*t.x)),"number"==typeof t.y&&(this.scrollY=-(n.scrollTop+(n.scrollHeight-n.viewHeight)*t.y)),this.translate(this.scrollX+n.absoluteLeft,this.scrollY+n.absoluteTop)},e.WorkspaceSvg.prototype.getBlockById=function(t){return e.WorkspaceSvg.superClass_.getBlockById.call(this,t)},e.WorkspaceSvg.prototype.getTopBlocks=function(t){return e.WorkspaceSvg.superClass_.getTopBlocks.call(this,t)},e.WorkspaceSvg.prototype.addTopBlock=function(t){this.addTopBoundedElement(t),e.WorkspaceSvg.superClass_.addTopBlock.call(this,t)},e.WorkspaceSvg.prototype.removeTopBlock=function(t){this.removeTopBoundedElement(t),e.WorkspaceSvg.superClass_.removeTopBlock.call(this,t)},e.WorkspaceSvg.prototype.addTopComment=function(t){this.addTopBoundedElement(t),e.WorkspaceSvg.superClass_.addTopComment.call(this,t)},e.WorkspaceSvg.prototype.removeTopComment=function(t){this.removeTopBoundedElement(t),e.WorkspaceSvg.superClass_.removeTopComment.call(this,t)},e.WorkspaceSvg.prototype.addTopBoundedElement=function(t){this.topBoundedElements_.push(t)},e.WorkspaceSvg.prototype.removeTopBoundedElement=function(t){e.utils.arrayRemove(this.topBoundedElements_,t)},e.WorkspaceSvg.prototype.getTopBoundedElements=function(){return[].concat(this.topBoundedElements_)},e.WorkspaceSvg.prototype.setResizesEnabled=function(t){var n=!this.resizesEnabled_&&t;this.resizesEnabled_=t,n&&this.resizeContents()},e.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),e.WorkspaceSvg.superClass_.clear.call(this),this.topBoundedElements_=[],this.setResizesEnabled(!0)},e.WorkspaceSvg.prototype.registerButtonCallback=function(t,n){if("function"!=typeof n)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks_[t]=n},e.WorkspaceSvg.prototype.getButtonCallback=function(t){return(t=this.flyoutButtonCallbacks_[t])?t:null},e.WorkspaceSvg.prototype.removeButtonCallback=function(t){this.flyoutButtonCallbacks_[t]=null},e.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(t,n){if("function"!=typeof n)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[t]=n},e.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(t){return this.toolboxCategoryCallbacks_[t]||null},e.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(t){this.toolboxCategoryCallbacks_[t]=null},e.WorkspaceSvg.prototype.getGesture=function(t){var n="mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type,o=this.currentGesture_;return o?n&&o.hasStarted()?(console.warn("Tried to start the same gesture twice."),o.cancel(),null):o:n?this.currentGesture_=new e.TouchGesture(t,this):null},e.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},e.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},e.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},e.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},e.inject=function(t,n){if(e.checkBlockColourConstants(),"string"==typeof t&&(t=document.getElementById(t)||document.querySelector(t)),!t||!e.utils.dom.containsNode(document,t))throw Error("Error: container is not in current document.");n=new e.Options(n||{});var o=document.createElement("div");o.className="injectionDiv",o.tabIndex=0,e.utils.aria.setState(o,e.utils.aria.State.LABEL,e.Msg.WORKSPACE_ARIA_LABEL),t.appendChild(o),t=e.createDom_(o,n);var r=new e.BlockDragSurfaceSvg(o),a=new e.WorkspaceDragSurfaceSvg(o),h=e.createMainWorkspace_(t,n,r,a);return e.init_(h),e.mainWorkspace=h,e.svgResize(h),o.addEventListener("focusin",function(){e.mainWorkspace=h}),h},e.createDom_=function(t,n){t.setAttribute("dir","LTR"),e.Css.inject(n.hasCss,n.pathToMedia),t=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",class:"blocklySvg",tabindex:"0"},t);var o=e.utils.dom.createSvgElement(e.utils.Svg.DEFS,{},t),r=String(Math.random()).substring(2);return n.gridPattern=e.Grid.createDom(r,n.gridOptions,o),t},e.createMainWorkspace_=function(t,n,o,r){return n.parentWorkspace=null,(n=new e.WorkspaceSvg(n,o,r)).scale=(o=n.options).zoomOptions.startScale,t.appendChild(n.createDom("blocklyMainBackground")),e.utils.dom.addClass(n.getInjectionDiv(),n.getRenderer().getClassName()),e.utils.dom.addClass(n.getInjectionDiv(),n.getTheme().getClassName()),!o.hasCategories&&o.languageTree&&(r=n.addFlyout(e.utils.Svg.SVG),e.utils.dom.insertAfter(r,t)),o.hasTrashcan&&n.addTrashcan(),o.zoomOptions&&o.zoomOptions.controls&&n.addZoomControls(),n.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),n.translate(0,0),n.addChangeListener(e.bumpIntoBoundsHandler_(n)),e.svgResize(n),e.WidgetDiv.createDom(),e.DropDownDiv.createDom(),e.Tooltip.createDom(),n},e.extractObjectFromEvent_=function(t,n){var o=null;switch(n.type){case e.Events.BLOCK_CREATE:case e.Events.BLOCK_MOVE:(o=t.getBlockById(n.blockId))&&(o=o.getRootBlock());break;case e.Events.COMMENT_CREATE:case e.Events.COMMENT_MOVE:o=t.getCommentById(n.commentId)}return o},e.bumpTopObjectsIntoBounds_=function(t){var n=t.getMetricsManager();if(n.hasFixedEdges()&&!t.isDragging()){n=n.getScrollMetrics(!0);for(var a,o=t.getTopBoundedElements(),r=0;a=o[r];r++)e.bumpObjectIntoBounds_(t,n,a)}},e.bumpIntoBoundsHandler_=function(t){return function(n){var o=t.getMetricsManager();if(o.hasFixedEdges()&&!t.isDragging())if(-1!==e.Events.BUMP_EVENTS.indexOf(n.type)){o=o.getScrollMetrics(!0);var r=e.extractObjectFromEvent_(t,n);if(r){var a=e.Events.getGroup();e.Events.setGroup(n.group),e.bumpObjectIntoBounds_(t,o,r)&&!n.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),null!==a&&e.Events.setGroup(a)}}else n.type===e.Events.VIEWPORT_CHANGE&&n.scale>n.oldScale&&e.bumpTopObjectsIntoBounds_(t)}},e.bumpObjectIntoBounds_=function(t,n,o){var r=o.getBoundingRectangle(),a=r.right-r.left,h=e.utils.math.clamp(n.top,r.top,n.top+n.height-(r.bottom-r.top))-r.top,R=n.left;return n=n.left+n.width-a,t.RTL?R=Math.min(n,R):n=Math.max(R,n),!(!(t=e.utils.math.clamp(R,r.left,n)-r.left)&&!h||(o.moveBy(t,h),0))},e.init_=function(t){var n=t.options,o=t.getParentSvg();if(e.browserEvents.conditionalBind(o.parentNode,"contextmenu",null,function(a){e.utils.isTargetInput(a)||a.preventDefault()}),o=e.browserEvents.conditionalBind(window,"resize",null,function(){e.hideChaff(!0),e.svgResize(t),e.bumpTopObjectsIntoBounds_(t)}),t.setResizeHandlerWrapper(o),e.inject.bindDocumentEvents_(),n.languageTree){o=t.getToolbox();var r=t.getFlyout(!0);o?o.init():r&&(r.init(t),r.show(n.languageTree),"function"==typeof r.scrollToStart&&r.scrollToStart())}n.hasTrashcan&&t.trashcan.init(),n.zoomOptions&&n.zoomOptions.controls&&t.zoomControls_.init(),n.moveOptions&&n.moveOptions.scrollbars?(t.scrollbar=new e.ScrollbarPair(t,!0===n.moveOptions.scrollbars||!!n.moveOptions.scrollbars.horizontal,!0===n.moveOptions.scrollbars||!!n.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),n.hasSounds&&e.inject.loadSounds_(n.pathToMedia,t)},e.inject.bindDocumentEvents_=function(){e.documentEventsBound_||(e.browserEvents.conditionalBind(document,"scroll",null,function(){for(var o,t=e.Workspace.getAll(),n=0;o=t[n];n++)o.updateInverseScreenCTM&&o.updateInverseScreenCTM()}),e.browserEvents.conditionalBind(document,"keydown",null,e.onKeyDown),e.browserEvents.bind(document,"touchend",null,e.longStop_),e.browserEvents.bind(document,"touchcancel",null,e.longStop_),e.utils.userAgent.IPAD&&e.browserEvents.conditionalBind(window,"orientationchange",document,function(){e.svgResize(e.getMainWorkspace())})),e.documentEventsBound_=!0},e.inject.loadSounds_=function(t,n){var o=n.getAudioManager();o.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),o.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),o.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");var r=[];t=function(){for(;r.length;)e.browserEvents.unbind(r.pop());o.preload()},r.push(e.browserEvents.conditionalBind(document,"mousemove",null,t,!0)),r.push(e.browserEvents.conditionalBind(document,"touchstart",null,t,!0))},e.Names=function(t,n){if(this.variablePrefix_=n||"",this.reservedDict_=Object.create(null),t)for(t=t.split(","),n=0;n<t.length;n++)this.reservedDict_[t[n]]=!0;this.reset()},e.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE",e.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},e.Names.prototype.setVariableMap=function(t){this.variableMap_=t},e.Names.prototype.getNameForUserVariable_=function(t){return this.variableMap_?(t=this.variableMap_.getVariableById(t))?t.name:null:(console.warn("Deprecated call to Blockly.Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)},e.Names.prototype.populateVariables=function(t){t=e.Variables.allUsedVarModels(t);for(var n=0;n<t.length;n++)this.getName(t[n].getId(),e.VARIABLE_CATEGORY_NAME)},e.Names.prototype.populateProcedures=function(t){t=(t=e.Procedures.allProcedures(t))[0].concat(t[1]);for(var n=0;n<t.length;n++)this.getName(t[n][0],e.PROCEDURE_CATEGORY_NAME)},e.Names.prototype.getName=function(t,n){var o=t;n==e.VARIABLE_CATEGORY_NAME&&(t=this.getNameForUserVariable_(t))&&(o=t),t=o.toLowerCase();var r=n==e.VARIABLE_CATEGORY_NAME||n==e.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"";n in this.db_||(this.db_[n]=Object.create(null));var a=this.db_[n];return t in a?r+a[t]:(n=this.getDistinctName(o,n),a[t]=n.substr(r.length),n)},e.Names.prototype.getUserNames=function(t){return Object.keys(this.db_[t]||{})},e.Names.prototype.getDistinctName=function(t,n){t=this.safeName_(t);for(var o="";this.dbReverse_[t+o]||t+o in this.reservedDict_;)o=o?o+1:2;return this.dbReverse_[t+=o]=!0,(n==e.VARIABLE_CATEGORY_NAME||n==e.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"")+t},e.Names.prototype.safeName_=function(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(t[0])&&(t="my_"+t)):t=e.Msg.UNNAMED_KEY||"unnamed",t},e.Names.equals=function(t,n){return t.toLowerCase()==n.toLowerCase()},e.Procedures={},e.Procedures.NAME_TYPE=e.PROCEDURE_CATEGORY_NAME,e.Procedures.DEFAULT_ARG="x",e.Procedures.allProcedures=function(t){var n=t.getBlocksByType("procedures_defnoreturn",!1).map(function(o){return o.getProcedureDef()});return t=t.getBlocksByType("procedures_defreturn",!1).map(function(o){return o.getProcedureDef()}),n.sort(e.Procedures.procTupleComparator_),t.sort(e.Procedures.procTupleComparator_),[n,t]},e.Procedures.procTupleComparator_=function(t,n){return t[0].localeCompare(n[0],void 0,{sensitivity:"base"})},e.Procedures.findLegalName=function(t,n){if(n.isInFlyout)return t;for(t=t||e.Msg.UNNAMED_KEY||"unnamed";!e.Procedures.isLegalName_(t,n.workspace,n);){var o=t.match(/^(.*?)(\d+)$/);t=o?o[1]+(parseInt(o[2],10)+1):t+"2"}return t},e.Procedures.isLegalName_=function(t,n,o){return!e.Procedures.isNameUsed(t,n,o)},e.Procedures.isNameUsed=function(t,n,o){n=n.getAllBlocks(!1);for(var r=0;r<n.length;r++)if(n[r]!=o&&n[r].getProcedureDef){var a=n[r].getProcedureDef();if(e.Names.equals(a[0],t))return!0}return!1},e.Procedures.rename=function(t){t=t.trim();var n=e.Procedures.findLegalName(t,this.getSourceBlock()),o=this.getValue();if(o!=t&&o!=n){t=this.getSourceBlock().workspace.getAllBlocks(!1);for(var r=0;r<t.length;r++)t[r].renameProcedure&&t[r].renameProcedure(o,n)}return n},e.Procedures.flyoutCategory=function(t){function n(h,R){for(var L=0;L<h.length;L++){var W=h[L][0],nt=h[L][1],et=e.utils.xml.createElement("block");et.setAttribute("type",R),et.setAttribute("gap",16);var Et=e.utils.xml.createElement("mutation");for(Et.setAttribute("name",W),et.appendChild(Et),W=0;W<nt.length;W++){var It=e.utils.xml.createElement("arg");It.setAttribute("name",nt[W]),Et.appendChild(It)}o.push(et)}}var o=[];if(e.Blocks.procedures_defnoreturn){var r=e.utils.xml.createElement("block");r.setAttribute("type","procedures_defnoreturn"),r.setAttribute("gap",16);var a=e.utils.xml.createElement("field");a.setAttribute("name","NAME"),a.appendChild(e.utils.xml.createTextNode(e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE)),r.appendChild(a),o.push(r)}return e.Blocks.procedures_defreturn&&((r=e.utils.xml.createElement("block")).setAttribute("type","procedures_defreturn"),r.setAttribute("gap",16),(a=e.utils.xml.createElement("field")).setAttribute("name","NAME"),a.appendChild(e.utils.xml.createTextNode(e.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),r.appendChild(a),o.push(r)),e.Blocks.procedures_ifreturn&&((r=e.utils.xml.createElement("block")).setAttribute("type","procedures_ifreturn"),r.setAttribute("gap",16),o.push(r)),o.length&&o[o.length-1].setAttribute("gap",24),n((t=e.Procedures.allProcedures(t))[0],"procedures_callnoreturn"),n(t[1],"procedures_callreturn"),o},e.Procedures.updateMutatorFlyout_=function(t){for(var a,n=[],o=t.getBlocksByType("procedures_mutatorarg",!1),r=0;a=o[r];r++)n.push(a.getFieldValue("NAME"));o=e.utils.xml.createElement("xml"),(r=e.utils.xml.createElement("block")).setAttribute("type","procedures_mutatorarg"),(a=e.utils.xml.createElement("field")).setAttribute("name","NAME"),n=e.Variables.generateUniqueNameFromOptions(e.Procedures.DEFAULT_ARG,n),n=e.utils.xml.createTextNode(n),a.appendChild(n),r.appendChild(a),o.appendChild(r),t.updateToolbox(o)},e.Procedures.mutatorOpenListener=function(t){if(t.type==e.Events.BUBBLE_OPEN&&"mutator"===t.bubbleType&&t.isOpen){var n=(t=e.Workspace.getById(t.workspaceId).getBlockById(t.blockId)).type;("procedures_defnoreturn"==n||"procedures_defreturn"==n)&&(t=t.mutator.getWorkspace(),e.Procedures.updateMutatorFlyout_(t),t.addChangeListener(e.Procedures.mutatorChangeListener_))}},e.Procedures.mutatorChangeListener_=function(t){(t.type==e.Events.BLOCK_CREATE||t.type==e.Events.BLOCK_DELETE||t.type==e.Events.BLOCK_CHANGE)&&(t=e.Workspace.getById(t.workspaceId),e.Procedures.updateMutatorFlyout_(t))},e.Procedures.getCallers=function(t,n){var o=[];n=n.getAllBlocks(!1);for(var r=0;r<n.length;r++)if(n[r].getProcedureCall){var a=n[r].getProcedureCall();a&&e.Names.equals(a,t)&&o.push(n[r])}return o},e.Procedures.mutateCallers=function(t){var a,n=e.Events.recordUndo,o=t.getProcedureDef()[0],r=t.mutationToDom(!0);for(t=e.Procedures.getCallers(o,t.workspace),o=0;a=t[o];o++){var h=a.mutationToDom();h=h&&e.Xml.domToText(h),a.domToMutation(r);var R=a.mutationToDom();h!=(R=R&&e.Xml.domToText(R))&&(e.Events.recordUndo=!1,e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(a,"mutation",null,h,R)),e.Events.recordUndo=n)}},e.Procedures.getDefinition=function(t,n){n=n.getAllBlocks(!1);for(var o=0;o<n.length;o++)if(n[o].getProcedureDef){var r=n[o].getProcedureDef();if(r&&e.Names.equals(r[0],t))return n[o]}return null},e.ShortcutRegistry=function(){e.ShortcutRegistry.registry=this,this.registry_=Object.create(null),this.keyMap_=Object.create(null)},e.ShortcutRegistry.modifierKeys={Shift:e.utils.KeyCodes.SHIFT,Control:e.utils.KeyCodes.CTRL,Alt:e.utils.KeyCodes.ALT,Meta:e.utils.KeyCodes.META},e.ShortcutRegistry.prototype.register=function(t,n){if(this.registry_[t.name]&&!n)throw Error('Shortcut with name "'+t.name+'" already exists.');this.registry_[t.name]=t},e.ShortcutRegistry.prototype.unregister=function(t){return this.registry_[t]?(this.removeAllKeyMappings(t),delete this.registry_[t],!0):(console.warn('Keyboard shortcut with name "'+t+'" not found.'),!1)},e.ShortcutRegistry.prototype.addKeyMapping=function(t,n,o){t=String(t);var r=this.keyMap_[t];if(r&&!o)throw Error('Shortcut with name "'+n+'" collides with shortcuts '+r.toString());r&&o?r.unshift(n):this.keyMap_[t]=[n]},e.ShortcutRegistry.prototype.removeKeyMapping=function(t,n,o){var r=this.keyMap_[t];if(!r&&!o)return console.warn('No keyboard shortcut with name "'+n+'" registered with key code "'+t+'"'),!1;var a=r.indexOf(n);return-1<a?(r.splice(a,1),0==r.length&&delete this.keyMap_[t],!0):(o||console.warn('No keyboard shortcut with name "'+n+'" registered with key code "'+t+'"'),!1)},e.ShortcutRegistry.prototype.removeAllKeyMappings=function(t){for(var n in this.keyMap_)this.removeKeyMapping(n,t,!0)},e.ShortcutRegistry.prototype.setKeyMap=function(t){this.keyMap_=t},e.ShortcutRegistry.prototype.getKeyMap=function(){return e.utils.object.deepMerge(Object.create(null),this.keyMap_)},e.ShortcutRegistry.prototype.getRegistry=function(){return e.utils.object.deepMerge(Object.create(null),this.registry_)},e.ShortcutRegistry.prototype.onKeyDown=function(t,n){var o=this.serializeKeyEvent_(n);if(!(o=this.getShortcutNamesByKeyCode(o)))return!1;for(var a,r=0;a=o[r];r++)if((!(a=this.registry_[a]).preconditionFn||a.preconditionFn(t))&&a.callback&&a.callback(t,n,a))return!0;return!1},e.ShortcutRegistry.prototype.getShortcutNamesByKeyCode=function(t){return this.keyMap_[t]||[]},e.ShortcutRegistry.prototype.getKeyCodesByShortcutName=function(t){var o,n=[];for(o in this.keyMap_)-1<this.keyMap_[o].indexOf(t)&&n.push(o);return n},e.ShortcutRegistry.prototype.serializeKeyEvent_=function(t){var o,n="";for(o in e.ShortcutRegistry.modifierKeys)t.getModifierState(o)&&(""!=n&&(n+="+"),n+=o);return""!=n&&t.keyCode?n=n+"+"+t.keyCode:t.keyCode&&(n=t.keyCode.toString()),n},e.ShortcutRegistry.prototype.checkModifiers_=function(t){for(var r,n=e.utils.object.values(e.ShortcutRegistry.modifierKeys),o=0;r=t[o];o++)if(0>n.indexOf(r))throw Error(r+" is not a valid modifier key.")},e.ShortcutRegistry.prototype.createSerializedKey=function(t,n){var o="";if(n)for(var r in this.checkModifiers_(n),e.ShortcutRegistry.modifierKeys)-1<n.indexOf(e.ShortcutRegistry.modifierKeys[r])&&(""!=o&&(o+="+"),o+=r);return""!=o&&t?o=o+"+"+t:t&&(o=t.toString()),o},new e.ShortcutRegistry,e.VariableModel=function(t,n,o,r){this.workspace=t,this.name=n,this.type=o||"",this.id_=r||e.utils.genUid(),e.Events.fire(new(e.Events.get(e.Events.VAR_CREATE))(this))},e.VariableModel.prototype.getId=function(){return this.id_},e.VariableModel.compareByName=function(t,n){return t.name.localeCompare(n.name,void 0,{sensitivity:"base"})},e.Variables={},e.Variables.NAME_TYPE=e.VARIABLE_CATEGORY_NAME,e.Variables.allUsedVarModels=function(t){var n=t.getAllBlocks(!1);t=Object.create(null);for(var o=0;o<n.length;o++){var r=n[o].getVarModels();if(r)for(var a=0;a<r.length;a++){var h=r[a],R=h.getId();R&&(t[R]=h)}}for(R in n=[],t)n.push(t[R]);return n},e.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_={},e.Variables.allDeveloperVariables=function(t){t=t.getAllBlocks(!1);for(var r,n=Object.create(null),o=0;r=t[o];o++){var a=r.getDeveloperVariables;if(!a&&r.getDeveloperVars&&(a=r.getDeveloperVars,e.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[r.type]||(console.warn("Function getDeveloperVars() deprecated. Use getDeveloperVariables() (block type '"+r.type+"')"),e.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[r.type]=!0)),a)for(r=a(),a=0;a<r.length;a++)n[r[a]]=!0}return Object.keys(n)},e.Variables.flyoutCategory=function(t){var n=[],o=document.createElement("button");return o.setAttribute("text","%{BKY_NEW_VARIABLE}"),o.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",function(r){e.Variables.createVariableButtonHandler(r.getTargetWorkspace())}),n.push(o),t=e.Variables.flyoutCategoryBlocks(t),n.concat(t)},e.Variables.flyoutCategoryBlocks=function(t){var n=[];if(0<(t=t.getVariablesOfType("")).length){var o=t[t.length-1];if(e.Blocks.variables_set){var r=e.utils.xml.createElement("block");r.setAttribute("type","variables_set"),r.setAttribute("gap",e.Blocks.math_change?8:24),r.appendChild(e.Variables.generateVariableFieldDom(o)),n.push(r)}if(e.Blocks.math_change&&((r=e.utils.xml.createElement("block")).setAttribute("type","math_change"),r.setAttribute("gap",e.Blocks.variables_get?20:8),r.appendChild(e.Variables.generateVariableFieldDom(o)),o=e.Xml.textToDom('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),r.appendChild(o),n.push(r)),e.Blocks.variables_get){t.sort(e.VariableModel.compareByName),o=0;for(var a;a=t[o];o++)(r=e.utils.xml.createElement("block")).setAttribute("type","variables_get"),r.setAttribute("gap",8),r.appendChild(e.Variables.generateVariableFieldDom(a)),n.push(r)}}return n},e.Variables.VAR_LETTER_OPTIONS="ijkmnopqrstuvwxyzabcdefgh",e.Variables.generateUniqueName=function(t){return e.Variables.generateUniqueNameFromOptions(e.Variables.VAR_LETTER_OPTIONS.charAt(0),t.getAllVariableNames())},e.Variables.generateUniqueNameFromOptions=function(t,n){if(!n.length)return t;for(var o=e.Variables.VAR_LETTER_OPTIONS,r="",a=o.indexOf(t);;){for(var h=!1,R=0;R<n.length;R++)if(n[R].toLowerCase()==t){h=!0;break}if(!h)return t;++a==o.length&&(a=0,r=Number(r)+1),t=o.charAt(a)+r}},e.Variables.createVariableButtonHandler=function(t,n,o){var r=o||"",a=function(h){e.Variables.promptName(e.Msg.NEW_VARIABLE_TITLE,h,function(R){if(R){var L=e.Variables.nameUsedWithAnyType(R,t);if(L){if(L.type==r)var W=e.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",L.name);else W=(W=e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",L.name).replace("%2",L.type);e.alert(W,function(){a(R)})}else t.createVariable(R,r),n&&n(R)}else n&&n(null)})};a("")},e.Variables.createVariable=e.Variables.createVariableButtonHandler,e.Variables.renameVariable=function(t,n,o){var r=function(a){var h=e.Msg.RENAME_VARIABLE_TITLE.replace("%1",n.name);e.Variables.promptName(h,a,function(R){if(R){var L=e.Variables.nameUsedWithOtherType_(R,n.type,t);L?(L=e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",L.name).replace("%2",L.type),e.alert(L,function(){r(R)})):(t.renameVariableById(n.getId(),R),o&&o(R))}else o&&o(null)})};r("")},e.Variables.promptName=function(t,n,o){e.prompt(t,n,function(r){r&&((r=r.replace(/[\s\xa0]+/g," ").trim())==e.Msg.RENAME_VARIABLE||r==e.Msg.NEW_VARIABLE)&&(r=null),o(r)})},e.Variables.nameUsedWithOtherType_=function(t,n,o){o=o.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var a,r=0;a=o[r];r++)if(a.name.toLowerCase()==t&&a.type!=n)return a;return null},e.Variables.nameUsedWithAnyType=function(t,n){n=n.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var r,o=0;r=n[o];o++)if(r.name.toLowerCase()==t)return r;return null},e.Variables.generateVariableFieldDom=function(t){var n=e.utils.xml.createElement("field");return n.setAttribute("name","VAR"),n.setAttribute("id",t.getId()),n.setAttribute("variabletype",t.type),t=e.utils.xml.createTextNode(t.name),n.appendChild(t),n},e.Variables.getOrCreateVariablePackage=function(t,n,o,r){var a=e.Variables.getVariable(t,n,o,r);return a||(a=e.Variables.createVariable_(t,n,o,r)),a},e.Variables.getVariable=function(t,n,o,r){var a=t.getPotentialVariableMap(),h=null;if(n&&(!(h=t.getVariableById(n))&&a&&(h=a.getVariableById(n)),h))return h;if(o){if(null==r)throw Error("Tried to look up a variable by name without a type");!(h=t.getVariable(o,r))&&a&&(h=a.getVariable(o,r))}return h},e.Variables.createVariable_=function(t,n,o,r){var a=t.getPotentialVariableMap();return o||(o=e.Variables.generateUniqueName(t.isFlyout?t.targetWorkspace:t)),a?a.createVariable(o,r,n):t.createVariable(o,r,n)},e.Variables.getAddedVariables=function(t,n){t=t.getAllVariables();var o=[];if(n.length!=t.length)for(var r=0;r<t.length;r++){var a=t[r];-1==n.indexOf(a)&&o.push(a)}return o},e.VERSION="6.20210701.0",e.mainWorkspace=null,e.selected=null,e.draggingConnections=[],e.clipboardXml_=null,e.clipboardSource_=null,e.clipboardTypeCounts_=null,e.cache3dSupported_=null,e.parentContainer=null,e.svgSize=function(t){return e.utils.deprecation.warn("Blockly.svgSize","March 2021","March 2022","workspace.getCachedParentSvgSize"),new e.utils.Size(t.cachedWidth_,t.cachedHeight_)},e.resizeSvgContents=function(t){t.resizeContents()},e.svgResize=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;var n=t.getParentSvg(),o=t.getCachedParentSvgSize(),r=n.parentNode;if(r){var a=r.offsetWidth;r=r.offsetHeight,o.width!=a&&(n.setAttribute("width",a+"px"),t.setCachedParentSvgSize(a,null)),o.height!=r&&(n.setAttribute("height",r+"px"),t.setCachedParentSvgSize(null,r)),t.resize()}},e.onKeyDown=function(t){var n=e.mainWorkspace;n&&!(e.utils.isTargetInput(t)||n.rendered&&!n.isVisible())&&e.ShortcutRegistry.registry.onKeyDown(n,t)},e.deleteBlock=function(t){t.workspace.isFlyout||(e.Events.setGroup(!0),e.hideChaff(),t.dispose(!t.outputConnection,!0),e.Events.setGroup(!1))},e.copy=function(t){(t=t.toCopyData())&&(e.clipboardXml_=t.xml,e.clipboardSource_=t.source,e.clipboardTypeCounts_=t.typeCounts)},e.paste=function(){if(!e.clipboardXml_)return!1;var t=e.clipboardSource_;return t.isFlyout&&(t=t.targetWorkspace),!(!e.clipboardTypeCounts_||!t.isCapacityAvailable(e.clipboardTypeCounts_)||(e.Events.setGroup(!0),t.paste(e.clipboardXml_),e.Events.setGroup(!1),0))},e.duplicate=function(t){var n=e.clipboardXml_,o=e.clipboardSource_;e.copy(t),t.workspace.paste(e.clipboardXml_),e.clipboardXml_=n,e.clipboardSource_=o},e.onContextMenu_=function(t){e.utils.isTargetInput(t)||t.preventDefault()},e.hideChaff=function(t){e.Tooltip.hide(),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation();var n=!!t;e.getMainWorkspace().getComponentManager().getComponents(e.ComponentManager.Capability.AUTOHIDEABLE,!0).forEach(function(o){o.autoHide(n)})},e.getMainWorkspace=function(){return e.mainWorkspace},e.alert=function(t,n){alert(t),n&&n()},e.confirm=function(t,n){n(confirm(t))},e.prompt=function(t,n,o){o(prompt(t,n))},e.jsonInitFactory_=function(t){return function(){this.jsonInit(t)}},e.defineBlocksWithJsonArray=function(t){for(var n=0;n<t.length;n++){var o=t[n];if(o){var r=o.type;null==r||""===r?console.warn("Block definition #"+n+" in JSON array is missing a type attribute. Skipping."):(e.Blocks[r]&&console.warn("Block definition #"+n+' in JSON array overwrites prior definition of "'+r+'".'),e.Blocks[r]={init:e.jsonInitFactory_(o)})}else console.warn("Block definition #"+n+" in JSON array is "+o+". Skipping.")}},e.isNumber=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},e.hueToHex=function(t){return e.utils.colour.hsvToHex(t,e.HSV_SATURATION,255*e.HSV_VALUE)},e.checkBlockColourConstants=function(){e.checkBlockColourConstant_("LOGIC_HUE",["Blocks","logic","HUE"],void 0),e.checkBlockColourConstant_("LOGIC_HUE",["Constants","Logic","HUE"],210),e.checkBlockColourConstant_("LOOPS_HUE",["Blocks","loops","HUE"],void 0),e.checkBlockColourConstant_("LOOPS_HUE",["Constants","Loops","HUE"],120),e.checkBlockColourConstant_("MATH_HUE",["Blocks","math","HUE"],void 0),e.checkBlockColourConstant_("MATH_HUE",["Constants","Math","HUE"],230),e.checkBlockColourConstant_("TEXTS_HUE",["Blocks","texts","HUE"],void 0),e.checkBlockColourConstant_("TEXTS_HUE",["Constants","Text","HUE"],160),e.checkBlockColourConstant_("LISTS_HUE",["Blocks","lists","HUE"],void 0),e.checkBlockColourConstant_("LISTS_HUE",["Constants","Lists","HUE"],260),e.checkBlockColourConstant_("COLOUR_HUE",["Blocks","colour","HUE"],void 0),e.checkBlockColourConstant_("COLOUR_HUE",["Constants","Colour","HUE"],20),e.checkBlockColourConstant_("VARIABLES_HUE",["Blocks","variables","HUE"],void 0),e.checkBlockColourConstant_("VARIABLES_HUE",["Constants","Variables","HUE"],330),e.checkBlockColourConstant_("VARIABLES_DYNAMIC_HUE",["Constants","VariablesDynamic","HUE"],310),e.checkBlockColourConstant_("PROCEDURES_HUE",["Blocks","procedures","HUE"],void 0)},e.checkBlockColourConstant_=function(t,n,o){for(var r="Blockly",a=e,h=0;h<n.length;++h)r+="."+n[h],a&&(a=a[n[h]]);a&&a!==o&&(t=(void 0===o?'%1 has been removed. Use Blockly.Msg["%2"].':'%1 is deprecated and unused. Override Blockly.Msg["%2"].').replace("%1",r).replace("%2",t),console.warn(t))},e.setParentContainer=function(t){e.parentContainer=t},e.bindEvent_=e.browserEvents.bind,e.unbindEvent_=e.browserEvents.unbind,e.bindEventWithChecks_=e.browserEvents.conditionalBind,e.ALIGN_LEFT=e.constants.ALIGN.LEFT,e.ALIGN_CENTRE=e.constants.ALIGN.CENTRE,e.ALIGN_RIGHT=e.constants.ALIGN.RIGHT,e.INPUT_VALUE=e.connectionTypes.INPUT_VALUE,e.OUTPUT_VALUE=e.connectionTypes.OUTPUT_VALUE,e.NEXT_STATEMENT=e.connectionTypes.NEXT_STATEMENT,e.PREVIOUS_STATEMENT=e.connectionTypes.PREVIOUS_STATEMENT,e.DUMMY_INPUT=e.inputTypes.DUMMY,e.TOOLBOX_AT_TOP=e.utils.toolbox.Position.TOP,e.TOOLBOX_AT_BOTTOM=e.utils.toolbox.Position.BOTTOM,e.TOOLBOX_AT_LEFT=e.utils.toolbox.Position.LEFT,e.TOOLBOX_AT_RIGHT=e.utils.toolbox.Position.RIGHT,e.Events.BubbleOpen=function(t,n,o){e.Events.BubbleOpen.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.isOpen=n,this.bubbleType=o},e.utils.object.inherits(e.Events.BubbleOpen,e.Events.UiBase),e.Events.BubbleOpen.prototype.type=e.Events.BUBBLE_OPEN,e.Events.BubbleOpen.prototype.toJson=function(){var t=e.Events.BubbleOpen.superClass_.toJson.call(this);return t.isOpen=this.isOpen,t.bubbleType=this.bubbleType,t.blockId=this.blockId,t},e.Events.BubbleOpen.prototype.fromJson=function(t){e.Events.BubbleOpen.superClass_.fromJson.call(this,t),this.isOpen=t.isOpen,this.bubbleType=t.bubbleType,this.blockId=t.blockId},e.registry.register(e.registry.Type.EVENT,e.Events.BUBBLE_OPEN,e.Events.BubbleOpen),e.Icon=function(t){this.block_=t,this.iconGroup_=null},e.Icon.prototype.collapseHidden=!0,e.Icon.prototype.SIZE=17,e.Icon.prototype.bubble_=null,e.Icon.prototype.iconXY_=null,e.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&e.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),e.browserEvents.conditionalBind(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},e.Icon.prototype.dispose=function(){e.utils.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},e.Icon.prototype.updateEditable=function(){},e.Icon.prototype.isVisible=function(){return!!this.bubble_},e.Icon.prototype.iconClick_=function(t){this.block_.workspace.isDragging()||this.block_.isInFlyout||e.utils.isRightButton(t)||this.setVisible(!this.isVisible())},e.Icon.prototype.applyColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.style.colourPrimary)},e.Icon.prototype.setIconLocation=function(t){this.iconXY_=t,this.isVisible()&&this.bubble_.setAnchorLocation(t)},e.Icon.prototype.computeIconLocation=function(){var t=this.block_.getRelativeToSurfaceXY(),n=e.utils.getRelativeXY(this.iconGroup_);t=new e.utils.Coordinate(t.x+n.x+this.SIZE/2,t.y+n.y+this.SIZE/2),e.utils.Coordinate.equals(this.getIconLocation(),t)||this.setIconLocation(t)},e.Icon.prototype.getIconLocation=function(){return this.iconXY_},e.Icon.prototype.getCorrectedSize=function(){return new e.utils.Size(e.Icon.prototype.SIZE,e.Icon.prototype.SIZE-2)},e.Warning=function(t){e.Warning.superClass_.constructor.call(this,t),this.createIcon(),this.text_=Object.create(null)},e.utils.object.inherits(e.Warning,e.Icon),e.Warning.prototype.collapseHidden=!1,e.Warning.prototype.drawIcon_=function(t){e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},t),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},t),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},t)},e.Warning.prototype.setVisible=function(t){t!=this.isVisible()&&(e.Events.fire(new(e.Events.get(e.Events.BUBBLE_OPEN))(this.block_,t,"warning")),t?this.createBubble_():this.disposeBubble_())},e.Warning.prototype.createBubble_=function(){this.paragraphElement_=e.Bubble.textToDom(this.getText()),this.bubble_=e.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},e.Warning.prototype.disposeBubble_=function(){this.bubble_.dispose(),this.paragraphElement_=this.bubble_=null},e.Warning.prototype.setText=function(t,n){this.text_[n]!=t&&(t?this.text_[n]=t:delete this.text_[n],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},e.Warning.prototype.getText=function(){var n,t=[];for(n in this.text_)t.push(this.text_[n]);return t.join("\n")},e.Warning.prototype.dispose=function(){this.block_.warning=null,e.Icon.prototype.dispose.call(this)},e.Comment=function(t){e.Comment.superClass_.constructor.call(this,t),this.model_=t.commentModel,this.model_.text=this.model_.text||"",this.cachedText_="",this.onInputWrapper_=this.onChangeWrapper_=this.onWheelWrapper_=this.onMouseUpWrapper_=null,this.createIcon()},e.utils.object.inherits(e.Comment,e.Icon),e.Comment.prototype.drawIcon_=function(t){e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},t),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},t),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},t)},e.Comment.prototype.createEditor_=function(){this.foreignObject_=e.utils.dom.createSvgElement(e.utils.Svg.FOREIGNOBJECT,{x:e.Bubble.BORDER_WIDTH,y:e.Bubble.BORDER_WIDTH},null);var t=document.createElementNS(e.utils.dom.HTML_NS,"body");t.setAttribute("xmlns",e.utils.dom.HTML_NS),t.className="blocklyMinimalBody";var n=this.textarea_=document.createElementNS(e.utils.dom.HTML_NS,"textarea");return n.className="blocklyCommentTextarea",n.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),n.value=this.model_.text,this.resizeTextarea_(),t.appendChild(n),this.foreignObject_.appendChild(t),this.onMouseUpWrapper_=e.browserEvents.conditionalBind(n,"mouseup",this,this.startEdit_,!0,!0),this.onWheelWrapper_=e.browserEvents.conditionalBind(n,"wheel",this,function(o){o.stopPropagation()}),this.onChangeWrapper_=e.browserEvents.conditionalBind(n,"change",this,function(o){this.cachedText_!=this.model_.text&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this.block_,"comment",null,this.cachedText_,this.model_.text))}),this.onInputWrapper_=e.browserEvents.conditionalBind(n,"input",this,function(o){this.model_.text=n.value}),setTimeout(n.focus.bind(n),0),this.foreignObject_},e.Comment.prototype.updateEditable=function(){e.Comment.superClass_.updateEditable.call(this),this.isVisible()&&(this.disposeBubble_(),this.createBubble_())},e.Comment.prototype.onBubbleResize_=function(){this.isVisible()&&(this.model_.size=this.bubble_.getBubbleSize(),this.resizeTextarea_())},e.Comment.prototype.resizeTextarea_=function(){var t=this.model_.size,n=2*e.Bubble.BORDER_WIDTH,o=t.width-n;t=t.height-n,this.foreignObject_.setAttribute("width",o),this.foreignObject_.setAttribute("height",t),this.textarea_.style.width=o-4+"px",this.textarea_.style.height=t-4+"px"},e.Comment.prototype.setVisible=function(t){t!=this.isVisible()&&(e.Events.fire(new(e.Events.get(e.Events.BUBBLE_OPEN))(this.block_,t,"comment")),(this.model_.pinned=t)?this.createBubble_():this.disposeBubble_())},e.Comment.prototype.createBubble_=function(){!this.block_.isEditable()||e.utils.userAgent.IE?this.createNonEditableBubble_():this.createEditableBubble_()},e.Comment.prototype.createEditableBubble_=function(){this.bubble_=new e.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,this.model_.size.width,this.model_.size.height),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerResizeEvent(this.onBubbleResize_.bind(this)),this.applyColour()},e.Comment.prototype.createNonEditableBubble_=function(){this.paragraphElement_=e.Bubble.textToDom(this.block_.getCommentText()),this.bubble_=e.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},e.Comment.prototype.disposeBubble_=function(){this.onMouseUpWrapper_&&(e.browserEvents.unbind(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onWheelWrapper_&&(e.browserEvents.unbind(this.onWheelWrapper_),this.onWheelWrapper_=null),this.onChangeWrapper_&&(e.browserEvents.unbind(this.onChangeWrapper_),this.onChangeWrapper_=null),this.onInputWrapper_&&(e.browserEvents.unbind(this.onInputWrapper_),this.onInputWrapper_=null),this.bubble_.dispose(),this.paragraphElement_=this.foreignObject_=this.textarea_=this.bubble_=null},e.Comment.prototype.startEdit_=function(t){this.bubble_.promote()&&this.textarea_.focus(),this.cachedText_=this.model_.text},e.Comment.prototype.getBubbleSize=function(){return this.model_.size},e.Comment.prototype.setBubbleSize=function(t,n){this.bubble_?this.bubble_.setBubbleSize(t,n):(this.model_.size.width=t,this.model_.size.height=n)},e.Comment.prototype.updateText=function(){this.textarea_?this.textarea_.value=this.model_.text:this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model_.text)},e.Comment.prototype.dispose=function(){this.block_.comment=null,e.Icon.prototype.dispose.call(this)},e.Css.register(".blocklyCommentTextarea {,background-color: #fef49c;,border: 0;,outline: 0;,margin: 0;,padding: 3px;,resize: none;,display: block;,text-overflow: hidden;,}".split(",")),e.IComponent=function(){},e.IDragTarget=function(){},e.DragTarget=function(){},e.DragTarget.prototype.onDragEnter=function(t){},e.DragTarget.prototype.onDragOver=function(t){},e.DragTarget.prototype.onDragExit=function(t){},e.DragTarget.prototype.onDrop=function(t){},e.DragTarget.prototype.shouldPreventMove=function(t){return!1},e.IDeleteArea=function(){},e.DeleteArea=function(){e.DeleteArea.superClass_.constructor.call(this),this.wouldDelete_=!1},e.utils.object.inherits(e.DeleteArea,e.DragTarget),e.DeleteArea.prototype.wouldDelete=function(t,n){return t instanceof e.BlockSvg?(t=!t.getParent()&&t.isDeletable(),this.updateWouldDelete_(t&&!n)):this.updateWouldDelete_(t.isDeletable()),this.wouldDelete_},e.DeleteArea.prototype.updateWouldDelete_=function(t){this.wouldDelete_=t},e.IFlyout=function(){},e.Flyout=function(t){e.Flyout.superClass_.constructor.call(this),t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new e.WorkspaceSvg(t),this.workspace_.setMetricsManager(new e.FlyoutMetricsManager(this.workspace_,this)),this.workspace_.isFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=e.utils.genUid(),this.RTL=!!t.RTL,this.horizontalLayout=!1,this.toolboxPosition_=t.toolboxPosition,this.eventWrappers_=[],this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.targetWorkspace=null},e.utils.object.inherits(e.Flyout,e.DeleteArea),e.Flyout.prototype.autoClose=!0,e.Flyout.prototype.isVisible_=!1,e.Flyout.prototype.containerVisible_=!0,e.Flyout.prototype.CORNER_RADIUS=8,e.Flyout.prototype.MARGIN=e.Flyout.prototype.CORNER_RADIUS,e.Flyout.prototype.GAP_X=3*e.Flyout.prototype.MARGIN,e.Flyout.prototype.GAP_Y=3*e.Flyout.prototype.MARGIN,e.Flyout.prototype.SCROLLBAR_MARGIN=2.5,e.Flyout.prototype.width_=0,e.Flyout.prototype.height_=0,e.Flyout.prototype.dragAngleRange_=70,e.Flyout.prototype.createDom=function(t){return this.svgGroup_=e.utils.dom.createSvgElement(t,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_},e.Flyout.prototype.init=function(t){this.targetWorkspace=t,this.workspace_.targetWorkspace=t,this.workspace_.scrollbar=new e.ScrollbarPair(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),Array.prototype.push.apply(this.eventWrappers_,e.browserEvents.conditionalBind(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,e.browserEvents.conditionalBind(this.svgBackground_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),t.getComponentManager().addComponent({component:this,weight:1,capabilities:[e.ComponentManager.Capability.DELETE_AREA,e.ComponentManager.Capability.DRAG_TARGET]})},e.Flyout.prototype.dispose=function(){this.hide(),this.workspace_.getComponentManager().removeComponent(this.id),e.browserEvents.unbind(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&(e.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace=this.svgBackground_=null},e.Flyout.prototype.getWidth=function(){return this.width_},e.Flyout.prototype.getHeight=function(){return this.height_},e.Flyout.prototype.getFlyoutScale=function(){return this.targetWorkspace.scale},e.Flyout.prototype.getWorkspace=function(){return this.workspace_},e.Flyout.prototype.isVisible=function(){return this.isVisible_},e.Flyout.prototype.setVisible=function(t){var n=t!=this.isVisible();this.isVisible_=t,n&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_())},e.Flyout.prototype.setContainerVisible=function(t){var n=t!=this.containerVisible_;this.containerVisible_=t,n&&this.updateDisplay_()},e.Flyout.prototype.updateDisplay_=function(){var t=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=t?"block":"none",this.workspace_.scrollbar.setContainerVisible(t)},e.Flyout.prototype.positionAt_=function(t,n,o,r){this.svgGroup_.setAttribute("width",t),this.svgGroup_.setAttribute("height",n),this.workspace_.setCachedParentSvgSize(t,n),"svg"==this.svgGroup_.tagName?e.utils.dom.setCssTransform(this.svgGroup_,"translate("+o+"px,"+r+"px)"):this.svgGroup_.setAttribute("transform","translate("+o+","+r+")"),(t=this.workspace_.scrollbar)&&(t.setOrigin(o,r),t.resize(),t.hScroll&&t.hScroll.setPosition(t.hScroll.position.x,t.hScroll.position.y),t.vScroll&&t.vScroll.setPosition(t.vScroll.position.x,t.vScroll.position.y))},e.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var n,t=0;n=this.listeners_[t];t++)e.browserEvents.unbind(n);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},e.Flyout.prototype.show=function(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof t&&(t=this.getDynamicCategoryContents_(t)),this.setVisible(!0),t=e.utils.toolbox.convertFlyoutDefToJsonArray(t),t=this.createFlyoutInfo_(t),this.layout_(t.contents,t.gaps),this.listeners_.push(e.browserEvents.conditionalBind(this.svgBackground_,"mouseover",this,function(){for(var r,n=this.workspace_.getTopBlocks(!1),o=0;r=n[o];o++)r.removeSelect()})),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_)},e.Flyout.prototype.createFlyoutInfo_=function(t){var n=[],o=[];this.permanentlyDisabled_.length=0;for(var h,r=this.horizontalLayout?this.GAP_X:this.GAP_Y,a=0;h=t[a];a++)switch(h.custom&&(h=this.getDynamicCategoryContents_(h.custom),h=e.utils.toolbox.convertFlyoutDefToJsonArray(h),t.splice.apply(t,[a,1].concat(h)),h=t[a]),h.kind.toUpperCase()){case"BLOCK":var R=h,L=this.getBlockXml_(R);h=this.createBlock_(L),R=parseInt(R.gap||L.getAttribute("gap"),10),o.push(isNaN(R)?r:R),n.push({type:"block",block:h});break;case"SEP":this.addSeparatorGap_(h,o,r);break;case"LABEL":h=this.createButton_(h,!0),n.push({type:"button",button:h}),o.push(r);break;case"BUTTON":h=this.createButton_(h,!1),n.push({type:"button",button:h}),o.push(r)}return{contents:n,gaps:o}},e.Flyout.prototype.getDynamicCategoryContents_=function(t){if("function"!=typeof(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");if(t=t(this.workspace_.targetWorkspace),!Array.isArray(t))throw new TypeError("Result of toolbox category callback must be an array.");return t},e.Flyout.prototype.createButton_=function(t,n){if(!e.FlyoutButton)throw Error("Missing require for Blockly.FlyoutButton");return new e.FlyoutButton(this.workspace_,this.targetWorkspace,t,n)},e.Flyout.prototype.createBlock_=function(t){return(t=e.Xml.domToBlock(t,this.workspace_)).isEnabled()||this.permanentlyDisabled_.push(t),t},e.Flyout.prototype.getBlockXml_=function(t){var n=null,o=t.blockxml;if(o&&"string"!=typeof o?n=o:o&&"string"==typeof o?(n=e.Xml.textToDom(o),t.blockxml=n):t.type&&((n=e.utils.xml.createElement("xml")).setAttribute("type",t.type),n.setAttribute("disabled",t.disabled),t.blockxml=n),!n)throw Error("Error: Invalid block definition. Block definition must have blockxml or type.");return n},e.Flyout.prototype.addSeparatorGap_=function(t,n,o){t=parseInt(t.gap,10),!isNaN(t)&&0<n.length?n[n.length-1]=t:n.push(o)},e.Flyout.prototype.clearOldBlocks_=function(){for(var o,t=this.workspace_.getTopBlocks(!1),n=0;o=t[n];n++)o.workspace==this.workspace_&&o.dispose(!1,!1);for(n=0;n<this.mats_.length;n++)(t=this.mats_[n])&&(e.Tooltip.unbindMouseEvents(t),e.utils.dom.removeNode(t));for(n=this.mats_.length=0;t=this.buttons_[n];n++)t.dispose();this.buttons_.length=0,this.workspace_.getPotentialVariableMap().clear()},e.Flyout.prototype.addBlockListeners_=function(t,n,o){this.listeners_.push(e.browserEvents.conditionalBind(t,"mousedown",null,this.blockMouseDown_(n))),this.listeners_.push(e.browserEvents.conditionalBind(o,"mousedown",null,this.blockMouseDown_(n))),this.listeners_.push(e.browserEvents.bind(t,"mouseenter",n,n.addSelect)),this.listeners_.push(e.browserEvents.bind(t,"mouseleave",n,n.removeSelect)),this.listeners_.push(e.browserEvents.bind(o,"mouseenter",n,n.addSelect)),this.listeners_.push(e.browserEvents.bind(o,"mouseleave",n,n.removeSelect))},e.Flyout.prototype.blockMouseDown_=function(t){var n=this;return function(o){var r=n.targetWorkspace.getGesture(o);r&&(r.setStartBlock(t),r.handleFlyoutStart(o,n))}},e.Flyout.prototype.onMouseDown_=function(t){var n=this.targetWorkspace.getGesture(t);n&&n.handleFlyoutStart(t,this)},e.Flyout.prototype.isBlockCreatable_=function(t){return t.isEnabled()},e.Flyout.prototype.createBlock=function(t){var n=null;e.Events.disable();var o=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{n=this.placeNewBlock_(t)}finally{e.Events.enable()}if(e.hideChaff(),t=e.Variables.getAddedVariables(this.targetWorkspace,o),e.Events.isEnabled()){for(e.Events.setGroup(!0),o=0;o<t.length;o++){var r=t[o];e.Events.fire(new(e.Events.get(e.Events.VAR_CREATE))(r))}e.Events.fire(new(e.Events.get(e.Events.BLOCK_CREATE))(n))}return this.autoClose?this.hide():this.filterForCapacity_(),n},e.Flyout.prototype.initFlyoutButton_=function(t,n,o){var r=t.createDom();t.moveTo(n,o),t.show(),this.listeners_.push(e.browserEvents.conditionalBind(r,"mousedown",this,this.onMouseDown_)),this.buttons_.push(t)},e.Flyout.prototype.createRect_=function(t,n,o,r,a){return(n=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{"fill-opacity":0,x:n,y:o,height:r.height,width:r.width},null)).tooltip=t,e.Tooltip.bindMouseEvents(n),this.workspace_.getCanvas().insertBefore(n,t.getSvgRoot()),t.flyoutRect_=n,this.mats_[a]=n},e.Flyout.prototype.moveRectToBlock_=function(t,n){var o=n.getHeightWidth();t.setAttribute("width",o.width),t.setAttribute("height",o.height),n=n.getRelativeToSurfaceXY(),t.setAttribute("y",n.y),t.setAttribute("x",this.RTL?n.x-o.width:n.x)},e.Flyout.prototype.filterForCapacity_=function(){for(var o,t=this.workspace_.getTopBlocks(!1),n=0;o=t[n];n++)if(-1==this.permanentlyDisabled_.indexOf(o))for(var r=this.targetWorkspace.isCapacityAvailable(e.utils.getBlockTypeCounts(o));o;)o.setEnabled(r),o=o.getNextBlock()},e.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},e.Flyout.prototype.isScrollable=function(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()},e.Flyout.prototype.placeNewBlock_=function(t){var n=this.targetWorkspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered.");var o=e.Xml.blockToDom(t,!0);if(n.setResizesEnabled(!1),!(o=e.Xml.domToBlock(o,n)).getSvgRoot())throw Error("block is not rendered.");var r=n.getOriginOffsetInPixels(),a=this.workspace_.getOriginOffsetInPixels();return(t=t.getRelativeToSurfaceXY()).scale(this.workspace_.scale),t=e.utils.Coordinate.sum(a,t),(r=e.utils.Coordinate.difference(t,r)).scale(1/n.scale),o.moveBy(r.x,r.y),o},e.HorizontalFlyout=function(t){e.HorizontalFlyout.superClass_.constructor.call(this,t),this.horizontalLayout=!0},e.utils.object.inherits(e.HorizontalFlyout,e.Flyout),e.HorizontalFlyout.prototype.setMetrics_=function(t){if(this.isVisible()){var n=this.workspace_.getMetricsManager(),o=n.getScrollMetrics(),r=n.getViewMetrics();n=n.getAbsoluteMetrics(),"number"==typeof t.x&&(this.workspace_.scrollX=-(o.left+(o.width-r.width)*t.x)),this.workspace_.translate(this.workspace_.scrollX+n.left,this.workspace_.scrollY+n.top)}},e.HorizontalFlyout.prototype.getX=function(){return 0},e.HorizontalFlyout.prototype.getY=function(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager(),n=t.getAbsoluteMetrics(),o=t.getViewMetrics();t=t.getToolboxMetrics();var r=this.toolboxPosition_==e.utils.toolbox.Position.TOP;return this.targetWorkspace.toolboxPosition==this.toolboxPosition_?this.targetWorkspace.getToolbox()?r?t.height:o.height-this.height_:r?0:o.height:r?0:o.height+n.top-this.height_},e.HorizontalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=t.width,this.setBackgroundPath_(t.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),t=this.getX();var n=this.getY();this.positionAt_(this.width_,this.height_,t,n)}},e.HorizontalFlyout.prototype.setBackgroundPath_=function(t,n){var o=this.toolboxPosition_==e.utils.toolbox.Position.TOP,r=["M 0,"+(o?0:this.CORNER_RADIUS)];o?(r.push("h",t+2*this.CORNER_RADIUS),r.push("v",n),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("h",-t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),r.push("h",t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("v",n),r.push("h",-t-2*this.CORNER_RADIUS)),r.push("z"),this.svgBackground_.setAttribute("d",r.join(" "))},e.HorizontalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setX(this.RTL?1/0:0)},e.HorizontalFlyout.prototype.wheel_=function(t){var n=e.utils.getScrollDeltaPixels(t);if(n=n.x||n.y){var o=this.workspace_.getMetricsManager(),r=o.getScrollMetrics();n=o.getViewMetrics().left-r.left+n,this.workspace_.scrollbar.setX(n),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()}t.preventDefault(),t.stopPropagation()},e.HorizontalFlyout.prototype.layout_=function(t,n){this.workspace_.scale=this.targetWorkspace.scale;var o=this.MARGIN,r=o+this.tabWidth_;this.RTL&&(t=t.reverse());for(var h,a=0;h=t[a];a++)if("block"==h.type){for(var W,R=(h=h.block).getDescendants(!1),L=0;W=R[L];L++)W.isInFlyout=!0;h.render(),R=h.getSvgRoot(),L=h.getHeightWidth(),W=h.outputConnection?this.tabWidth_:0,h.moveBy(W=this.RTL?r+L.width:r-W,o),W=this.createRect_(h,W,o,L,a),r+=L.width+n[a],this.addBlockListeners_(R,h,W)}else"button"==h.type&&(this.initFlyoutButton_(h.button,r,o),r+=h.button.width+n[a])},e.HorizontalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var n=this.dragAngleRange_;return t<90+n&&t>90-n||t>-90-n&&t<-90+n},e.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var t=this.svgGroup_.getBoundingClientRect(),n=t.top;return this.toolboxPosition_==e.utils.toolbox.Position.TOP?new e.utils.Rect(-1e9,n+t.height,-1e9,1e9):new e.utils.Rect(n,1e9,-1e9,1e9)},e.HorizontalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var r,t=0,n=this.workspace_.getTopBlocks(!1),o=0;r=n[o];o++)t=Math.max(t,r.getHeightWidth().height);if(t+=1.5*this.MARGIN,t*=this.workspace_.scale,this.height_!=(t+=e.Scrollbar.scrollbarThickness)){for(o=0;r=n[o];o++)r.flyoutRect_&&this.moveRectToBlock_(r.flyoutRect_,r);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=e.utils.toolbox.Position.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+t),this.height_=t,this.position(),this.targetWorkspace.recordDragTargets()}},e.registry.register(e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,e.registry.DEFAULT,e.HorizontalFlyout),e.VerticalFlyout=function(t){e.VerticalFlyout.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.VerticalFlyout,e.Flyout),e.VerticalFlyout.registryName="verticalFlyout",e.VerticalFlyout.prototype.setMetrics_=function(t){if(this.isVisible()){var n=this.workspace_.getMetricsManager(),o=n.getScrollMetrics(),r=n.getViewMetrics();n=n.getAbsoluteMetrics(),"number"==typeof t.y&&(this.workspace_.scrollY=-(o.top+(o.height-r.height)*t.y)),this.workspace_.translate(this.workspace_.scrollX+n.left,this.workspace_.scrollY+n.top)}},e.VerticalFlyout.prototype.getX=function(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager(),n=t.getAbsoluteMetrics(),o=t.getViewMetrics();return t=t.getToolboxMetrics(),this.targetWorkspace.toolboxPosition==this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_==e.utils.toolbox.Position.LEFT?t.width:o.width-this.width_:this.toolboxPosition_==e.utils.toolbox.Position.LEFT?0:o.width:this.toolboxPosition_==e.utils.toolbox.Position.LEFT?0:o.width+n.left-this.width_},e.VerticalFlyout.prototype.getY=function(){return 0},e.VerticalFlyout.prototype.position=function(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=t.height,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,t.height-2*this.CORNER_RADIUS),t=this.getX();var n=this.getY();this.positionAt_(this.width_,this.height_,t,n)}},e.VerticalFlyout.prototype.setBackgroundPath_=function(t,n){var o=this.toolboxPosition_==e.utils.toolbox.Position.RIGHT,r=t+this.CORNER_RADIUS;(r=["M "+(o?r:0)+",0"]).push("h",o?-t:t),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("v",Math.max(0,n)),r.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),r.push("h",o?t:-t),r.push("z"),this.svgBackground_.setAttribute("d",r.join(" "))},e.VerticalFlyout.prototype.scrollToStart=function(){this.workspace_.scrollbar.setY(0)},e.VerticalFlyout.prototype.wheel_=function(t){var n=e.utils.getScrollDeltaPixels(t);if(n.y){var o=this.workspace_.getMetricsManager(),r=o.getScrollMetrics();n=o.getViewMetrics().top-r.top+n.y,this.workspace_.scrollbar.setY(n),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()}t.preventDefault(),t.stopPropagation()},e.VerticalFlyout.prototype.layout_=function(t,n){this.workspace_.scale=this.targetWorkspace.scale;for(var h,o=this.MARGIN,r=this.RTL?o:o+this.tabWidth_,a=0;h=t[a];a++)if("block"==h.type){for(var W,R=(h=h.block).getDescendants(!1),L=0;W=R[L];L++)W.isInFlyout=!0;h.render(),R=h.getSvgRoot(),L=h.getHeightWidth(),h.moveBy(W=h.outputConnection?r-this.tabWidth_:r,o),W=this.createRect_(h,this.RTL?W-L.width:W,o,L,a),this.addBlockListeners_(R,h,W),o+=L.height+n[a]}else"button"==h.type&&(this.initFlyoutButton_(h.button,r,o),o+=h.button.height+n[a])},e.VerticalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var n=this.dragAngleRange_;return t<n&&t>-n||t<-180+n||t>180-n},e.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var t=this.svgGroup_.getBoundingClientRect(),n=t.left;return this.toolboxPosition_==e.utils.toolbox.Position.LEFT?new e.utils.Rect(-1e9,1e9,-1e9,n+t.width):new e.utils.Rect(-1e9,1e9,n,1e9)},e.VerticalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.getFlyoutScale();for(var r,t=0,n=this.workspace_.getTopBlocks(!1),o=0;r=n[o];o++){var a=r.getHeightWidth().width;r.outputConnection&&(a-=this.tabWidth_),t=Math.max(t,a)}for(o=0;r=this.buttons_[o];o++)t=Math.max(t,r.width);if(t+=1.5*this.MARGIN+this.tabWidth_,t*=this.workspace_.scale,this.width_!=(t+=e.Scrollbar.scrollbarThickness)){for(o=0;r=n[o];o++){if(this.RTL){a=r.getRelativeToSurfaceXY().x;var h=t/this.workspace_.scale-this.MARGIN;r.outputConnection||(h-=this.tabWidth_),r.moveBy(h-a,0)}r.flyoutRect_&&this.moveRectToBlock_(r.flyoutRect_,r)}if(this.RTL)for(o=0;r=this.buttons_[o];o++)n=r.getPosition().y,r.moveTo(t/this.workspace_.scale-r.width-this.MARGIN-this.tabWidth_,n);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=e.utils.toolbox.Position.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+t,this.targetWorkspace.scrollY),this.width_=t,this.position(),this.targetWorkspace.recordDragTargets()}},e.registry.register(e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,e.registry.DEFAULT,e.VerticalFlyout),e.FlyoutButton=function(t,n,o,r){this.workspace_=t,this.targetWorkspace_=n,this.text_=o.text,this.position_=new e.utils.Coordinate(0,0),this.isLabel_=r,this.callbackKey_=o.callbackKey||o.callbackkey,this.cssClass_=o["web-class"]||null,this.onMouseUpWrapper_=null,this.info=o},e.FlyoutButton.MARGIN_X=5,e.FlyoutButton.MARGIN_Y=2,e.FlyoutButton.prototype.width=0,e.FlyoutButton.prototype.height=0,e.FlyoutButton.prototype.createDom=function(){var t=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";if(this.cssClass_&&(t+=" "+this.cssClass_),this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:t},this.workspace_.getCanvas()),!this.isLabel_)var n=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_);t=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var o=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_),r=e.utils.replaceMessageReferences(this.text_);this.workspace_.RTL&&(r+="\u200f"),o.textContent=r,this.isLabel_&&(this.svgText_=o,this.workspace_.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));var a=e.utils.style.getComputedStyle(o,"fontSize"),h=e.utils.style.getComputedStyle(o,"fontWeight"),R=e.utils.style.getComputedStyle(o,"fontFamily");return this.width=e.utils.dom.getFastTextWidthWithSizeString(o,a,h,R),r=e.utils.dom.measureFontMetrics(r,a,h,R),this.height=r.height,this.isLabel_||(this.width+=2*e.FlyoutButton.MARGIN_X,this.height+=2*e.FlyoutButton.MARGIN_Y,n.setAttribute("width",this.width),n.setAttribute("height",this.height)),t.setAttribute("width",this.width),t.setAttribute("height",this.height),o.setAttribute("x",this.width/2),o.setAttribute("y",this.height/2-r.height/2+r.baseline),this.updateTransform_(),this.onMouseUpWrapper_=e.browserEvents.conditionalBind(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},e.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},e.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},e.FlyoutButton.prototype.moveTo=function(t,n){this.position_.x=t,this.position_.y=n,this.updateTransform_()},e.FlyoutButton.prototype.isLabel=function(){return this.isLabel_},e.FlyoutButton.prototype.getPosition=function(){return this.position_},e.FlyoutButton.prototype.getButtonText=function(){return this.text_},e.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},e.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&e.browserEvents.unbind(this.onMouseUpWrapper_),this.svgGroup_&&e.utils.dom.removeNode(this.svgGroup_),this.svgText_&&this.workspace_.getThemeManager().unsubscribe(this.svgText_)},e.FlyoutButton.prototype.onMouseUp_=function(t){(t=this.targetWorkspace_.getGesture(t))&&t.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace_.getButtonCallback(this.callbackKey_)?this.isLabel_||this.targetWorkspace_.getButtonCallback(this.callbackKey_)(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)},e.Css.register(".blocklyFlyoutButton {,fill: #888;,cursor: default;,},.blocklyFlyoutButtonShadow {,fill: #666;,},.blocklyFlyoutButton:hover {,fill: #aaa;,},.blocklyFlyoutLabel {,cursor: default;,},.blocklyFlyoutLabelBackground {,opacity: 0;,}".split(",")),e.Generator=function(t){this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")},e.Generator.prototype.INFINITE_LOOP_TRAP=null,e.Generator.prototype.STATEMENT_PREFIX=null,e.Generator.prototype.STATEMENT_SUFFIX=null,e.Generator.prototype.INDENT="  ",e.Generator.prototype.COMMENT_WRAP=60,e.Generator.prototype.ORDER_OVERRIDES=[],e.Generator.prototype.isInitialized=null,e.Generator.prototype.workspaceToCode=function(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=e.getMainWorkspace());var n=[];this.init(t),t=t.getTopBlocks(!0);for(var r,o=0;r=t[o];o++){var a=this.blockToCode(r);Array.isArray(a)&&(a=a[0]),a&&(r.outputConnection&&(a=this.scrubNakedValue(a),this.STATEMENT_PREFIX&&!r.suppressPrefixSuffix&&(a=this.injectId(this.STATEMENT_PREFIX,r)+a),this.STATEMENT_SUFFIX&&!r.suppressPrefixSuffix&&(a+=this.injectId(this.STATEMENT_SUFFIX,r))),n.push(a))}return n=n.join("\n"),(n=(n=(n=this.finish(n)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")},e.Generator.prototype.prefixLines=function(t,n){return n+t.replace(/(?!\n$)\n/g,"\n"+n)},e.Generator.prototype.allNestedComments=function(t){var n=[];t=t.getDescendants(!0);for(var o=0;o<t.length;o++){var r=t[o].getCommentText();r&&n.push(r)}return n.length&&n.push(""),n.join("\n")},e.Generator.prototype.blockToCode=function(t,n){if(!1===this.isInitialized&&console.warn("Generator init was not called before blockToCode was called."),!t)return"";if(!t.isEnabled())return n?"":this.blockToCode(t.getNextBlock());if(t.isInsertionMarker())return n?"":this.blockToCode(t.getChildren(!1)[0]);var o=this[t.type];if("function"!=typeof o)throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+t.type+'".');if(o=o.call(t,t),Array.isArray(o)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,o[0],n),o[1]]}if("string"==typeof o)return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(o=this.injectId(this.STATEMENT_PREFIX,t)+o),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(o+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,o,n);if(null===o)return"";throw SyntaxError("Invalid code generated: "+o)},e.Generator.prototype.valueToCode=function(t,n,o){if(isNaN(o))throw TypeError("Expecting valid order from block: "+t.type);var r=t.getInputTargetBlock(n);if(!r||""===(n=this.blockToCode(r)))return"";if(!Array.isArray(n))throw TypeError("Expecting tuple from value block: "+r.type);if(t=n[0],n=n[1],isNaN(n))throw TypeError("Expecting valid order from value block: "+r.type);if(!t)return"";r=!1;var a=Math.floor(o),h=Math.floor(n);if(a<=h&&(a!=h||0!=a&&99!=a))for(r=!0,a=0;a<this.ORDER_OVERRIDES.length;a++)if(this.ORDER_OVERRIDES[a][0]==o&&this.ORDER_OVERRIDES[a][1]==n){r=!1;break}return r&&(t="("+t+")"),t},e.Generator.prototype.statementToCode=function(t,n){if(t=t.getInputTargetBlock(n),"string"!=typeof(n=this.blockToCode(t)))throw TypeError("Expecting code from statement block: "+(t&&t.type));return n&&(n=this.prefixLines(n,this.INDENT)),n},e.Generator.prototype.addLoopTrap=function(t,n){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,n),this.INDENT)+t),this.STATEMENT_SUFFIX&&!n.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,n),this.INDENT)+t),this.STATEMENT_PREFIX&&!n.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,n),this.INDENT)),t},e.Generator.prototype.injectId=function(t,n){return n=n.id.replace(/\$/g,"$$$$"),t.replace(/%1/g,"'"+n+"'")},e.Generator.prototype.RESERVED_WORDS_="",e.Generator.prototype.addReservedWords=function(t){this.RESERVED_WORDS_+=t+","},e.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",Object.defineProperty(e.Generator.prototype,"variableDB_",{get:function(){return e.utils.deprecation.warn("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_},set:function(t){e.utils.deprecation.warn("variableDB_","May 2021","May 2026","nameDB_"),this.nameDB_=t}}),e.Generator.prototype.provideFunction_=function(t,n){if(!this.definitions_[t]){var r,o=this.nameDB_.getDistinctName(t,e.PROCEDURE_CATEGORY_NAME);for(this.functionNames_[t]=o,n=n.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,o);r!=n;)r=n,n=n.replace(/^(( {2})*) {2}/gm,"$1\0");n=n.replace(/\0/g,this.INDENT),this.definitions_[t]=n}return this.functionNames_[t]},e.Generator.prototype.init=function(t){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)},e.Generator.prototype.scrub_=function(t,n,o){return n},e.Generator.prototype.finish=function(t){return delete this.definitions_,delete this.functionNames_,t},e.Generator.prototype.scrubNakedValue=function(t){return t},e.IToolboxItem=function(){},e.ISelectableToolboxItem=function(){},e.ICollapsibleToolboxItem=function(){},e.ToolboxItem=function(t,n,o){this.id_=t.toolboxitemid||e.utils.IdGenerator.getNextUniqueId(),this.level_=(this.parent_=o||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=t,this.parentToolbox_=n,this.workspace_=this.parentToolbox_.getWorkspace()},e.ToolboxItem.prototype.init=function(){},e.ToolboxItem.prototype.getDiv=function(){return null},e.ToolboxItem.prototype.getId=function(){return this.id_},e.ToolboxItem.prototype.getParent=function(){return null},e.ToolboxItem.prototype.getLevel=function(){return this.level_},e.ToolboxItem.prototype.isSelectable=function(){return!1},e.ToolboxItem.prototype.isCollapsible=function(){return!1},e.ToolboxItem.prototype.dispose=function(){},e.ToolboxCategory=function(t,n,o){e.ToolboxCategory.superClass_.constructor.call(this,t,n,o),this.name_=e.utils.replaceMessageReferences(t.name),this.colour_=this.getColour_(t),this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.cssConfig_=this.makeDefaultCssConfig_(),e.utils.object.mixin(this.cssConfig_,t.cssconfig||t.cssConfig),this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.parseContents_(t)},e.utils.object.inherits(e.ToolboxCategory,e.ToolboxItem),e.ToolboxCategory.registrationName="category",e.ToolboxCategory.nestedPadding=19,e.ToolboxCategory.borderWidth=8,e.ToolboxCategory.defaultBackgroundColour="#57e",e.ToolboxCategory.prototype.makeDefaultCssConfig_=function(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}},e.ToolboxCategory.prototype.parseContents_=function(t){var n=t.contents;if(t.custom)this.flyoutItems_=t.custom;else if(n){t=0;for(var o;o=n[t];t++)this.flyoutItems_.push(o)}},e.ToolboxCategory.prototype.init=function(){this.createDom_(),"true"==this.toolboxItemDef_.hidden&&this.hide()},e.ToolboxCategory.prototype.createDom_=function(){return this.htmlDiv_=this.createContainer_(),e.utils.aria.setRole(this.htmlDiv_,e.utils.aria.Role.TREEITEM),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.SELECTED,!1),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),e.utils.aria.setRole(this.iconDom_,e.utils.aria.Role.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.LABELLEDBY,this.labelDom_.getAttribute("id")),this.addColourBorder_(this.colour_),this.htmlDiv_},e.ToolboxCategory.prototype.createContainer_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,this.cssConfig_.container),t},e.ToolboxCategory.prototype.createRowContainer_=function(){var t=document.createElement("div");e.utils.dom.addClass(t,this.cssConfig_.row);var n=e.ToolboxCategory.nestedPadding*this.getLevel();return n=n.toString()+"px",this.workspace_.RTL?t.style.paddingRight=n:t.style.paddingLeft=n,t},e.ToolboxCategory.prototype.createRowContentsContainer_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,this.cssConfig_.rowcontentcontainer),t},e.ToolboxCategory.prototype.createIconDom_=function(){var t=document.createElement("span");return this.parentToolbox_.isHorizontal()||e.utils.dom.addClass(t,this.cssConfig_.icon),t.style.display="inline-block",t},e.ToolboxCategory.prototype.createLabelDom_=function(t){var n=document.createElement("span");return n.setAttribute("id",this.getId()+".label"),n.textContent=t,e.utils.dom.addClass(n,this.cssConfig_.label),n},e.ToolboxCategory.prototype.refreshTheme=function(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)},e.ToolboxCategory.prototype.addColourBorder_=function(t){t&&(t=e.ToolboxCategory.borderWidth+"px solid "+(t||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=t:this.rowDiv_.style.borderLeft=t)},e.ToolboxCategory.prototype.getColour_=function(t){var n=t.categorystyle||t.categoryStyle;return(t=t.colour)&&n?(console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour'),""):n?this.getColourfromStyle_(n):this.parseColour_(t)},e.ToolboxCategory.prototype.getColourfromStyle_=function(t){var n=this.workspace_.getTheme();if(t&&n){if((n=n.categoryStyles[t])&&n.colour)return this.parseColour_(n.colour);console.warn('Style "'+t+'" must exist and contain a colour value')}return""},e.ToolboxCategory.prototype.getClickTarget=function(){return this.rowDiv_},e.ToolboxCategory.prototype.parseColour_=function(t){if(null==(t=e.utils.replaceMessageReferences(t))||""===t)return"";var n=Number(t);return isNaN(n)?(n=e.utils.colour.parse(t))?n:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+t),""):e.hueToHex(n)},e.ToolboxCategory.prototype.openIcon_=function(t){t&&(e.utils.dom.removeClasses(t,this.cssConfig_.closedicon),e.utils.dom.addClass(t,this.cssConfig_.openicon))},e.ToolboxCategory.prototype.closeIcon_=function(t){t&&(e.utils.dom.removeClasses(t,this.cssConfig_.openicon),e.utils.dom.addClass(t,this.cssConfig_.closedicon))},e.ToolboxCategory.prototype.setVisible_=function(t){this.htmlDiv_.style.display=t?"block":"none",this.isHidden_=!t,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},e.ToolboxCategory.prototype.hide=function(){this.setVisible_(!1)},e.ToolboxCategory.prototype.show=function(){this.setVisible_(!0)},e.ToolboxCategory.prototype.isVisible=function(){return!this.isHidden_&&this.allAncestorsExpanded_()},e.ToolboxCategory.prototype.allAncestorsExpanded_=function(){for(var t=this;t.getParent();)if(!(t=t.getParent()).isExpanded())return!1;return!0},e.ToolboxCategory.prototype.isSelectable=function(){return this.isVisible()&&!this.isDisabled_},e.ToolboxCategory.prototype.onClick=function(t){},e.ToolboxCategory.prototype.setSelected=function(t){if(t){var n=this.parseColour_(e.ToolboxCategory.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||n,e.utils.dom.addClass(this.rowDiv_,this.cssConfig_.selected)}else this.rowDiv_.style.backgroundColor="",e.utils.dom.removeClass(this.rowDiv_,this.cssConfig_.selected);e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.SELECTED,t)},e.ToolboxCategory.prototype.setDisabled=function(t){this.isDisabled_=t,this.getDiv().setAttribute("disabled",t),t?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")},e.ToolboxCategory.prototype.getName=function(){return this.name_},e.ToolboxCategory.prototype.getParent=function(){return this.parent_},e.ToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},e.ToolboxCategory.prototype.getContents=function(){return this.flyoutItems_},e.ToolboxCategory.prototype.updateFlyoutContents=function(t){this.flyoutItems_=[],"string"==typeof t?this.toolboxItemDef_.custom=t:(delete this.toolboxItemDef_.custom,this.toolboxItemDef_.contents=e.utils.toolbox.convertFlyoutDefToJsonArray(t)),this.parseContents_(this.toolboxItemDef_)},e.ToolboxCategory.prototype.dispose=function(){e.utils.dom.removeNode(this.htmlDiv_)},e.Css.register([".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: rgba(255, 255, 255, 0.2);","}",'.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {',"margin: 1px 5px 1px 0;","}",'.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {',"margin: 1px 0 1px 5px;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","padding-right: 0px","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","visibility: hidden;","width: 16px;","}",".blocklyTreeIconClosed {","background-position: -32px -1px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {',"background-position: 0 -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosed {","background-position: -32px -17px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {',"background-position: 0 -17px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeLabel {","cursor: default;","font: 16px sans-serif;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}"]),e.registry.register(e.registry.Type.TOOLBOX_ITEM,e.ToolboxCategory.registrationName,e.ToolboxCategory),e.ToolboxSeparator=function(t,n){e.ToolboxSeparator.superClass_.constructor.call(this,t,n),this.cssConfig_={container:"blocklyTreeSeparator"},e.utils.object.mixin(this.cssConfig_,t.cssconfig||t.cssConfig)},e.utils.object.inherits(e.ToolboxSeparator,e.ToolboxItem),e.ToolboxSeparator.registrationName="sep",e.ToolboxSeparator.prototype.init=function(){this.createDom_()},e.ToolboxSeparator.prototype.createDom_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,this.cssConfig_.container),this.htmlDiv_=t},e.ToolboxSeparator.prototype.getDiv=function(){return this.htmlDiv_},e.ToolboxSeparator.prototype.dispose=function(){e.utils.dom.removeNode(this.htmlDiv_)},e.Css.register('.blocklyTreeSeparator {,border-bottom: solid #e5e5e5 1px;,height: 0;,margin: 5px 0;,},.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {,border-right: solid #e5e5e5 1px;,border-bottom: none;,height: auto;,margin: 0 5px 0 5px;,padding: 5px 0;,width: 0;,}'.split(",")),e.registry.register(e.registry.Type.TOOLBOX_ITEM,e.ToolboxSeparator.registrationName,e.ToolboxSeparator),e.CollapsibleToolboxCategory=function(t,n,o){this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[],e.CollapsibleToolboxCategory.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.CollapsibleToolboxCategory,e.ToolboxCategory),e.CollapsibleToolboxCategory.registrationName="collapsibleCategory",e.CollapsibleToolboxCategory.prototype.makeDefaultCssConfig_=function(){var t=e.CollapsibleToolboxCategory.superClass_.makeDefaultCssConfig_.call(this);return t.contents="blocklyToolboxContents",t},e.CollapsibleToolboxCategory.prototype.parseContents_=function(t){var n=t.contents,o=!0;if(t.custom)this.flyoutItems_=t.custom;else if(n){t=0;for(var r;r=n[t];t++)!e.registry.hasItem(e.registry.Type.TOOLBOX_ITEM,r.kind)||r.kind.toLowerCase()==e.ToolboxSeparator.registrationName&&o?(this.flyoutItems_.push(r),o=!0):(this.createToolboxItem_(r),o=!1)}},e.CollapsibleToolboxCategory.prototype.createToolboxItem_=function(t){var n=t.kind;"CATEGORY"==n.toUpperCase()&&e.utils.toolbox.isCategoryCollapsible(t)&&(n=e.CollapsibleToolboxCategory.registrationName),t=new(e.registry.getClass(e.registry.Type.TOOLBOX_ITEM,n))(t,this.parentToolbox_,this),this.toolboxItems_.push(t)},e.CollapsibleToolboxCategory.prototype.init=function(){e.CollapsibleToolboxCategory.superClass_.init.call(this),this.setExpanded("true"==this.toolboxItemDef_.expanded||this.toolboxItemDef_.expanded)},e.CollapsibleToolboxCategory.prototype.createDom_=function(){e.CollapsibleToolboxCategory.superClass_.createDom_.call(this);var t=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(t),e.utils.aria.setRole(this.subcategoriesDiv_,e.utils.aria.Role.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_},e.CollapsibleToolboxCategory.prototype.createIconDom_=function(){var t=document.createElement("span");return this.parentToolbox_.isHorizontal()||(e.utils.dom.addClass(t,this.cssConfig_.icon),t.style.visibility="visible"),t.style.display="inline-block",t},e.CollapsibleToolboxCategory.prototype.createSubCategoriesDom_=function(t){var n=document.createElement("div");e.utils.dom.addClass(n,this.cssConfig_.contents);for(var o=0;o<t.length;o++){var r=t[o];r.init();var a=r.getDiv();n.appendChild(a),r.getClickTarget&&r.getClickTarget().setAttribute("id",r.getId())}return n},e.CollapsibleToolboxCategory.prototype.setExpanded=function(t){this.expanded_!=t&&((this.expanded_=t)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),e.utils.aria.setState(this.htmlDiv_,e.utils.aria.State.EXPANDED,t),this.parentToolbox_.handleToolboxItemResize())},e.CollapsibleToolboxCategory.prototype.setVisible_=function(t){this.htmlDiv_.style.display=t?"block":"none";for(var o,n=0;o=this.getChildToolboxItems()[n];n++)o.setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},e.CollapsibleToolboxCategory.prototype.isExpanded=function(){return this.expanded_},e.CollapsibleToolboxCategory.prototype.isCollapsible=function(){return!0},e.CollapsibleToolboxCategory.prototype.onClick=function(t){this.toggleExpanded()},e.CollapsibleToolboxCategory.prototype.toggleExpanded=function(){this.setExpanded(!this.expanded_)},e.CollapsibleToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},e.CollapsibleToolboxCategory.prototype.getChildToolboxItems=function(){return this.toolboxItems_},e.registry.register(e.registry.Type.TOOLBOX_ITEM,e.CollapsibleToolboxCategory.registrationName,e.CollapsibleToolboxCategory),e.Events.ToolboxItemSelect=function(t,n,o){e.Events.ToolboxItemSelect.superClass_.constructor.call(this,o),this.oldItem=t,this.newItem=n},e.utils.object.inherits(e.Events.ToolboxItemSelect,e.Events.UiBase),e.Events.ToolboxItemSelect.prototype.type=e.Events.TOOLBOX_ITEM_SELECT,e.Events.ToolboxItemSelect.prototype.toJson=function(){var t=e.Events.ToolboxItemSelect.superClass_.toJson.call(this);return t.oldItem=this.oldItem,t.newItem=this.newItem,t},e.Events.ToolboxItemSelect.prototype.fromJson=function(t){e.Events.ToolboxItemSelect.superClass_.fromJson.call(this,t),this.oldItem=t.oldItem,this.newItem=t.newItem},e.registry.register(e.registry.Type.EVENT,e.Events.TOOLBOX_ITEM_SELECT,e.Events.ToolboxItemSelect),e.IAutoHideable=function(){},e.IStyleable=function(){},e.IToolbox=function(){},e.Toolbox=function(t){e.Toolbox.superClass_.constructor.call(this),this.workspace_=t,this.id="toolbox",this.toolboxDef_=t.options.languageTree||{contents:[]},this.horizontalLayout_=t.options.horizontalLayout,this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.RTL=t.options.RTL,this.flyout_=null,this.contentMap_=Object.create(null),this.toolboxPosition=t.options.toolboxPosition,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[]},e.utils.object.inherits(e.Toolbox,e.DeleteArea),e.Toolbox.prototype.onShortcut=function(t){return!1},e.Toolbox.prototype.init=function(){var t=this.workspace_,n=t.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),e.utils.dom.insertAfter(this.flyout_.createDom("svg"),n),this.setVisible(!0),this.flyout_.init(t),this.render(this.toolboxDef_),(t=t.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),t.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[e.ComponentManager.Capability.AUTOHIDEABLE,e.ComponentManager.Capability.DELETE_AREA,e.ComponentManager.Capability.DRAG_TARGET]})},e.Toolbox.prototype.createDom_=function(t){t=t.getParentSvg();var n=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,e.utils.aria.setRole(this.contentsDiv_,e.utils.aria.Role.TREE),n.appendChild(this.contentsDiv_),t.parentNode.insertBefore(n,t),this.attachEvents_(n,this.contentsDiv_),n},e.Toolbox.prototype.createContainer_=function(){var t=document.createElement("div");return t.setAttribute("layout",this.isHorizontal()?"h":"v"),e.utils.dom.addClass(t,"blocklyToolboxDiv"),e.utils.dom.addClass(t,"blocklyNonSelectable"),t.setAttribute("dir",this.RTL?"RTL":"LTR"),t},e.Toolbox.prototype.createContentsContainer_=function(){var t=document.createElement("div");return e.utils.dom.addClass(t,"blocklyToolboxContents"),this.isHorizontal()&&(t.style.flexDirection="row"),t},e.Toolbox.prototype.attachEvents_=function(t,n){t=e.browserEvents.conditionalBind(t,"click",this,this.onClick_,!1,!0),this.boundEvents_.push(t),n=e.browserEvents.conditionalBind(n,"keydown",this,this.onKeyDown_,!1,!0),this.boundEvents_.push(n)},e.Toolbox.prototype.onClick_=function(t){if(e.utils.isRightButton(t)||t.target==this.HtmlDiv)e.hideChaff(!1);else{var n=t.target.getAttribute("id");n&&(n=this.getToolboxItemById(n)).isSelectable()&&(this.setSelectedItem(n),n.onClick(t)),e.hideChaff(!0)}e.Touch.clearTouchIdentifier()},e.Toolbox.prototype.onKeyDown_=function(t){var n=!1;switch(t.keyCode){case e.utils.KeyCodes.DOWN:n=this.selectNext_();break;case e.utils.KeyCodes.UP:n=this.selectPrevious_();break;case e.utils.KeyCodes.LEFT:n=this.selectParent_();break;case e.utils.KeyCodes.RIGHT:n=this.selectChild_();break;case e.utils.KeyCodes.ENTER:case e.utils.KeyCodes.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),n=!0);break;default:n=!1}!n&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(n=this.selectedItem_.onKeyDown(t)),n&&t.preventDefault()},e.Toolbox.prototype.createFlyout_=function(){var t=this.workspace_,n=new e.Options({parentWorkspace:t,rtl:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,renderer:t.options.renderer,rendererOverrides:t.options.rendererOverrides,move:{scrollbars:!0}});return n.toolboxPosition=t.options.toolboxPosition,new(e.registry.getClassFromOptions(t.horizontalLayout?e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX:e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,t.options,!0))(n)},e.Toolbox.prototype.render=function(t){this.toolboxDef_=t;for(var n=0;n<this.contents_.length;n++){var o=this.contents_[n];o&&o.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(t.contents),this.position(),this.handleToolboxItemResize()},e.Toolbox.prototype.renderContents_=function(t){for(var r,n=document.createDocumentFragment(),o=0;r=t[o];o++)this.createToolboxItem_(r,n);this.contentsDiv_.appendChild(n)},e.Toolbox.prototype.createToolboxItem_=function(t,n){var o=t.kind;"CATEGORY"==o.toUpperCase()&&e.utils.toolbox.isCategoryCollapsible(t)&&(o=e.CollapsibleToolboxCategory.registrationName),(o=e.registry.getClass(e.registry.Type.TOOLBOX_ITEM,o.toLowerCase()))&&(t=new o(t,this),this.addToolboxItem_(t),t.init(),(o=t.getDiv())&&n.appendChild(o),t.getClickTarget&&t.getClickTarget().setAttribute("id",t.getId()))},e.Toolbox.prototype.addToolboxItem_=function(t){if(this.contents_.push(t),this.contentMap_[t.getId()]=t,t.isCollapsible())for(var o,n=0;o=t.getChildToolboxItems()[n];n++)this.addToolboxItem_(o)},e.Toolbox.prototype.getToolboxItems=function(){return this.contents_},e.Toolbox.prototype.addStyle=function(t){e.utils.dom.addClass(this.HtmlDiv,t)},e.Toolbox.prototype.removeStyle=function(t){e.utils.dom.removeClass(this.HtmlDiv,t)},e.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv||!this.isVisible_)return null;var t=this.HtmlDiv.getBoundingClientRect(),n=t.top,o=n+t.height,r=t.left;return t=r+t.width,this.toolboxPosition==e.utils.toolbox.Position.TOP?new e.utils.Rect(-1e7,o,-1e7,1e7):this.toolboxPosition==e.utils.toolbox.Position.BOTTOM?new e.utils.Rect(n,1e7,-1e7,1e7):this.toolboxPosition==e.utils.toolbox.Position.LEFT?new e.utils.Rect(-1e7,1e7,-1e7,t):new e.utils.Rect(-1e7,1e7,r,1e7)},e.Toolbox.prototype.wouldDelete=function(t,n){return this.updateWouldDelete_(t instanceof e.BlockSvg?!t.getParent()&&t.isDeletable():t.isDeletable()),this.wouldDelete_},e.Toolbox.prototype.onDragEnter=function(t){this.updateCursorDeleteStyle_(!0)},e.Toolbox.prototype.onDragExit=function(t){this.updateCursorDeleteStyle_(!1)},e.Toolbox.prototype.onDrop=function(t){this.updateCursorDeleteStyle_(!1)},e.Toolbox.prototype.updateWouldDelete_=function(t){t!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=t,this.updateCursorDeleteStyle_(!0))},e.Toolbox.prototype.updateCursorDeleteStyle_=function(t){var n=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";t?this.addStyle(n):this.removeStyle(n)},e.Toolbox.prototype.getToolboxItemById=function(t){return this.contentMap_[t]||null},e.Toolbox.prototype.getWidth=function(){return this.width_},e.Toolbox.prototype.getHeight=function(){return this.height_},e.Toolbox.prototype.getFlyout=function(){return this.flyout_},e.Toolbox.prototype.getWorkspace=function(){return this.workspace_},e.Toolbox.prototype.getSelectedItem=function(){return this.selectedItem_},e.Toolbox.prototype.getPreviouslySelectedItem=function(){return this.previouslySelectedItem_},e.Toolbox.prototype.isHorizontal=function(){return this.horizontalLayout_},e.Toolbox.prototype.position=function(){var t=this.workspace_.getMetrics(),n=this.HtmlDiv;n&&(this.horizontalLayout_?(n.style.left="0",n.style.height="auto",n.style.width="100%",this.height_=n.offsetHeight,this.width_=t.viewWidth,this.toolboxPosition==e.utils.toolbox.Position.TOP?n.style.top="0":n.style.bottom="0"):(this.toolboxPosition==e.utils.toolbox.Position.RIGHT?n.style.right="0":n.style.left="0",n.style.height="100%",this.width_=n.offsetWidth,this.height_=t.viewHeight),this.flyout_.position())},e.Toolbox.prototype.handleToolboxItemResize=function(){var t=this.workspace_,n=this.HtmlDiv.getBoundingClientRect();t.translate(this.toolboxPosition==e.utils.toolbox.Position.LEFT?t.scrollX+n.width:t.scrollX,this.toolboxPosition==e.utils.toolbox.Position.TOP?t.scrollY+n.height:t.scrollY),e.svgResize(t)},e.Toolbox.prototype.clearSelection=function(){this.setSelectedItem(null)},e.Toolbox.prototype.refreshTheme=function(){for(var t=0;t<this.contents_.length;t++){var n=this.contents_[t];n.refreshTheme&&n.refreshTheme()}},e.Toolbox.prototype.refreshSelection=function(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())},e.Toolbox.prototype.setVisible=function(t){this.isVisible_!==t&&(this.HtmlDiv.style.display=t?"block":"none",this.isVisible_=t,this.workspace_.recordDragTargets())},e.Toolbox.prototype.autoHide=function(t){!t&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()},e.Toolbox.prototype.setSelectedItem=function(t){var n=this.selectedItem_;!t&&!n||t&&!t.isSelectable()||(this.shouldDeselectItem_(n,t)&&null!=n&&this.deselectItem_(n),this.shouldSelectItem_(n,t)&&null!=t&&this.selectItem_(n,t),this.updateFlyout_(n,t),this.fireSelectEvent_(n,t))},e.Toolbox.prototype.shouldDeselectItem_=function(t,n){return null!=t&&(!t.isCollapsible()||t!=n)},e.Toolbox.prototype.shouldSelectItem_=function(t,n){return null!=n&&n!=t},e.Toolbox.prototype.deselectItem_=function(t){this.selectedItem_=null,this.previouslySelectedItem_=t,t.setSelected(!1),e.utils.aria.setState(this.contentsDiv_,e.utils.aria.State.ACTIVEDESCENDANT,"")},e.Toolbox.prototype.selectItem_=function(t,n){this.selectedItem_=n,this.previouslySelectedItem_=t,n.setSelected(!0),e.utils.aria.setState(this.contentsDiv_,e.utils.aria.State.ACTIVEDESCENDANT,n.getId())},e.Toolbox.prototype.selectItemByPosition=function(t){-1<t&&t<this.contents_.length&&(t=this.contents_[t]).isSelectable()&&this.setSelectedItem(t)},e.Toolbox.prototype.updateFlyout_=function(t,n){(t!=n||n.isCollapsible())&&n&&n.getContents().length?(this.flyout_.show(n.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()},e.Toolbox.prototype.fireSelectEvent_=function(t,n){var o=t&&t.getName(),r=n&&n.getName();t==n&&(r=null),t=new(e.Events.get(e.Events.TOOLBOX_ITEM_SELECT))(o,r,this.workspace_.id),e.Events.fire(t)},e.Toolbox.prototype.selectParent_=function(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.setExpanded(!1),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))},e.Toolbox.prototype.selectChild_=function(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;var t=this.selectedItem_;return t.isExpanded()?this.selectNext_():t.setExpanded(!0),!0},e.Toolbox.prototype.selectNext_=function(){if(!this.selectedItem_)return!1;var t=this.contents_.indexOf(this.selectedItem_)+1;if(-1<t&&t<this.contents_.length){for(var n=this.contents_[t];n&&!n.isSelectable();)n=this.contents_[++t];if(n&&n.isSelectable())return this.setSelectedItem(n),!0}return!1},e.Toolbox.prototype.selectPrevious_=function(){if(!this.selectedItem_)return!1;var t=this.contents_.indexOf(this.selectedItem_)-1;if(-1<t&&t<this.contents_.length){for(var n=this.contents_[t];n&&!n.isSelectable();)n=this.contents_[--t];if(n&&n.isSelectable())return this.setSelectedItem(n),!0}return!1},e.Toolbox.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var t=0;t<this.contents_.length;t++)this.contents_[t].dispose();for(t=0;t<this.boundEvents_.length;t++)e.browserEvents.unbind(this.boundEvents_[t]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),e.utils.dom.removeNode(this.HtmlDiv)},e.Css.register([".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyToolboxDiv {","background-color: #ddd;","overflow-x: visible;","overflow-y: auto;","padding: 4px 0 4px 0;","position: absolute;","z-index: 70;","-webkit-tap-highlight-color: transparent;","}",".blocklyToolboxContents {","display: flex;","flex-wrap: wrap;","flex-direction: column;","}",".blocklyToolboxContents:focus {","outline: none;","}"]),e.registry.register(e.registry.Type.TOOLBOX,e.registry.DEFAULT,e.Toolbox),e.Events.TrashcanOpen=function(t,n){e.Events.TrashcanOpen.superClass_.constructor.call(this,n),this.isOpen=t},e.utils.object.inherits(e.Events.TrashcanOpen,e.Events.UiBase),e.Events.TrashcanOpen.prototype.type=e.Events.TRASHCAN_OPEN,e.Events.TrashcanOpen.prototype.toJson=function(){var t=e.Events.TrashcanOpen.superClass_.toJson.call(this);return t.isOpen=this.isOpen,t},e.Events.TrashcanOpen.prototype.fromJson=function(t){e.Events.TrashcanOpen.superClass_.fromJson.call(this,t),this.isOpen=t.isOpen},e.registry.register(e.registry.Type.EVENT,e.Events.TRASHCAN_OPEN,e.Events.TrashcanOpen),e.IPositionable=function(){},e.uiPosition={},e.uiPosition.verticalPosition={TOP:0,BOTTOM:1},e.uiPosition.horizontalPosition={LEFT:0,RIGHT:1},e.uiPosition.bumpDirection={UP:0,DOWN:1},e.uiPosition.getStartPositionRect=function(t,n,o,r,a,h){var R=h.scrollbar&&h.scrollbar.canScrollVertically();return t.horizontal===e.uiPosition.horizontalPosition.LEFT?(o=a.absoluteMetrics.left+o,R&&h.RTL&&(o+=e.Scrollbar.scrollbarThickness)):(o=a.absoluteMetrics.left+a.viewMetrics.width-n.width-o,R&&!h.RTL&&(o-=e.Scrollbar.scrollbarThickness)),t.vertical===e.uiPosition.verticalPosition.TOP?t=a.absoluteMetrics.top+r:(t=a.absoluteMetrics.top+a.viewMetrics.height-n.height-r,h.scrollbar&&h.scrollbar.canScrollHorizontally()&&(t-=e.Scrollbar.scrollbarThickness)),new e.utils.Rect(t,t+n.height,o,o+n.width)},e.uiPosition.getCornerOppositeToolbox=function(t,n){return{horizontal:n.toolboxMetrics.position===e.utils.toolbox.Position.LEFT||t.horizontalLayout&&!t.RTL?e.uiPosition.horizontalPosition.RIGHT:e.uiPosition.horizontalPosition.LEFT,vertical:n.toolboxMetrics.position===e.utils.toolbox.Position.BOTTOM?e.uiPosition.verticalPosition.TOP:e.uiPosition.verticalPosition.BOTTOM}},e.uiPosition.bumpPositionRect=function(t,n,o,r){for(var W,a=t.left,h=t.right-t.left,R=t.bottom-t.top,L=0;W=r[L];L++)t.intersects(W)&&(t=new e.utils.Rect(t=o===e.uiPosition.bumpDirection.UP?W.top-R-n:W.bottom+n,t+R,a,a+h),L=-1);return t},e.Trashcan=function(t){e.Trashcan.superClass_.constructor.call(this),this.workspace_=t,this.id="trashcan",this.contents_=[],this.flyout=null,0>=this.workspace_.options.maxTrashcanContents||(t=new e.Options({scrollbars:!0,parentWorkspace:this.workspace_,rtl:this.workspace_.RTL,oneBasedIndex:this.workspace_.options.oneBasedIndex,renderer:this.workspace_.options.renderer,rendererOverrides:this.workspace_.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace_.horizontalLayout?(t.toolboxPosition=this.workspace_.toolboxPosition==e.utils.toolbox.Position.TOP?e.utils.toolbox.Position.BOTTOM:e.utils.toolbox.Position.TOP,this.flyout=new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace_.options,!0))(t)):(t.toolboxPosition=this.workspace_.toolboxPosition==e.utils.toolbox.Position.RIGHT?e.utils.toolbox.Position.LEFT:e.utils.toolbox.Position.RIGHT,this.flyout=new(e.registry.getClassFromOptions(e.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,this.workspace_.options,!0))(t)),this.workspace_.addChangeListener(this.onDelete_.bind(this)))},e.utils.object.inherits(e.Trashcan,e.DeleteArea),e.Trashcan.prototype.WIDTH_=47,e.Trashcan.prototype.BODY_HEIGHT_=44,e.Trashcan.prototype.LID_HEIGHT_=16,e.Trashcan.prototype.MARGIN_VERTICAL_=20,e.Trashcan.prototype.MARGIN_HORIZONTAL_=20,e.Trashcan.prototype.MARGIN_HOTSPOT_=10,e.Trashcan.prototype.SPRITE_LEFT_=0,e.Trashcan.prototype.SPRITE_TOP_=32,e.Trashcan.prototype.HAS_BLOCKS_LID_ANGLE_=.1,e.Trashcan.ANIMATION_LENGTH_=80,e.Trashcan.ANIMATION_FRAMES_=4,e.Trashcan.OPACITY_MIN_=.4,e.Trashcan.OPACITY_MAX_=.8,e.Trashcan.MAX_LID_ANGLE_=45,e.Trashcan.prototype.isLidOpen=!1,e.Trashcan.prototype.minOpenness_=0,e.Trashcan.prototype.svgGroup_=null,e.Trashcan.prototype.svgLid_=null,e.Trashcan.prototype.lidTask_=0,e.Trashcan.prototype.lidOpen_=0,e.Trashcan.prototype.left_=0,e.Trashcan.prototype.top_=0,e.Trashcan.prototype.initialized_=!1,e.Trashcan.prototype.createDom=function(){this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyTrash"},null);var t=String(Math.random()).substring(2),n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},n);var o=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,x:-this.SPRITE_LEFT_,height:e.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup_);return o.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup_),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:this.WIDTH_,height:this.LID_HEIGHT_},n),this.svgLid_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,x:-this.SPRITE_LEFT_,height:e.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup_),this.svgLid_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),e.browserEvents.bind(this.svgGroup_,"mousedown",this,this.blockMouseDownWhenOpenable_),e.browserEvents.bind(this.svgGroup_,"mouseup",this,this.click),e.browserEvents.bind(o,"mouseover",this,this.mouseOver_),e.browserEvents.bind(o,"mouseout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_},e.Trashcan.prototype.init=function(){0<this.workspace_.options.maxTrashcanContents&&(e.utils.dom.insertAfter(this.flyout.createDom(e.utils.Svg.SVG),this.workspace_.getParentSvg()),this.flyout.init(this.workspace_)),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[e.ComponentManager.Capability.AUTOHIDEABLE,e.ComponentManager.Capability.DELETE_AREA,e.ComponentManager.Capability.DRAG_TARGET,e.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0,this.setLidOpen(!1)},e.Trashcan.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("trashcan"),this.svgGroup_&&(e.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,clearTimeout(this.lidTask_)},e.Trashcan.prototype.hasContents_=function(){return!!this.contents_.length},e.Trashcan.prototype.contentsIsOpen=function(){return this.flyout.isVisible()},e.Trashcan.prototype.openFlyout=function(){if(!this.contentsIsOpen()){var t=this.contents_.map(e.Xml.textToDom);this.flyout.show(t),this.fireUiEvent_(!0)}},e.Trashcan.prototype.closeFlyout=function(){this.contentsIsOpen()&&(this.flyout.hide(),this.fireUiEvent_(!1))},e.Trashcan.prototype.autoHide=function(t){!t&&this.flyout&&this.closeFlyout()},e.Trashcan.prototype.emptyContents=function(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())},e.Trashcan.prototype.position=function(t,n){if(this.initialized_){var o=e.uiPosition.getCornerOppositeToolbox(this.workspace_,t);t=e.uiPosition.getStartPositionRect(o,new e.utils.Size(this.WIDTH_,this.BODY_HEIGHT_+this.LID_HEIGHT_),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,t,this.workspace_),n=e.uiPosition.bumpPositionRect(t,this.MARGIN_VERTICAL_,o.vertical===e.uiPosition.verticalPosition.TOP?e.uiPosition.bumpDirection.DOWN:e.uiPosition.bumpDirection.UP,n),this.top_=n.top,this.left_=n.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},e.Trashcan.prototype.getBoundingRectangle=function(){return new e.utils.Rect(this.top_,this.top_+this.BODY_HEIGHT_+this.LID_HEIGHT_,this.left_,this.left_+this.WIDTH_)},e.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),n=t.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_;return new e.utils.Rect(n,n+this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_,t=t.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,t+this.WIDTH_+2*this.MARGIN_HOTSPOT_)},e.Trashcan.prototype.onDragOver=function(t){this.setLidOpen(this.wouldDelete_)},e.Trashcan.prototype.onDragExit=function(t){this.setLidOpen(!1)},e.Trashcan.prototype.onDrop=function(t){setTimeout(this.setLidOpen.bind(this,!1),100)},e.Trashcan.prototype.setLidOpen=function(t){this.isLidOpen!=t&&(clearTimeout(this.lidTask_),this.isLidOpen=t,this.animateLid_())},e.Trashcan.prototype.animateLid_=function(){var t=e.Trashcan.ANIMATION_FRAMES_,n=1/(t+1);this.lidOpen_+=this.isLidOpen?n:-n,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*e.Trashcan.MAX_LID_ANGLE_),this.svgGroup_.style.opacity=(n=e.Trashcan.OPACITY_MIN_)+this.lidOpen_*(e.Trashcan.OPACITY_MAX_-n),this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),e.Trashcan.ANIMATION_LENGTH_/t))},e.Trashcan.prototype.setLidAngle_=function(t){var n=this.workspace_.toolboxPosition==e.utils.toolbox.Position.RIGHT||this.workspace_.horizontalLayout&&this.workspace_.RTL;this.svgLid_.setAttribute("transform","rotate("+(n?-t:t)+","+(n?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")")},e.Trashcan.prototype.setMinOpenness_=function(t){this.minOpenness_=t,this.isLidOpen||this.setLidAngle_(t*e.Trashcan.MAX_LID_ANGLE_)},e.Trashcan.prototype.closeLid=function(){this.setLidOpen(!1)},e.Trashcan.prototype.click=function(){this.hasContents_()&&this.openFlyout()},e.Trashcan.prototype.fireUiEvent_=function(t){t=new(e.Events.get(e.Events.TRASHCAN_OPEN))(t,this.workspace_.id),e.Events.fire(t)},e.Trashcan.prototype.blockMouseDownWhenOpenable_=function(t){!this.contentsIsOpen()&&this.hasContents_()&&t.stopPropagation()},e.Trashcan.prototype.mouseOver_=function(){this.hasContents_()&&this.setLidOpen(!0)},e.Trashcan.prototype.mouseOut_=function(){this.setLidOpen(!1)},e.Trashcan.prototype.onDelete_=function(t){if(!(0>=this.workspace_.options.maxTrashcanContents)&&t.type==e.Events.BLOCK_DELETE&&t.oldXml.tagName&&"shadow"!=t.oldXml.tagName.toLowerCase()&&(t=this.cleanBlockXML_(t.oldXml),-1==this.contents_.indexOf(t))){for(this.contents_.unshift(t);this.contents_.length>this.workspace_.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(this.HAS_BLOCKS_LID_ANGLE_)}},e.Trashcan.prototype.cleanBlockXML_=function(t){for(var n=t=t.cloneNode(!0);n;){n.removeAttribute&&(n.removeAttribute("x"),n.removeAttribute("y"),n.removeAttribute("id"),n.removeAttribute("disabled"),"comment"==n.nodeName&&(n.removeAttribute("h"),n.removeAttribute("w"),n.removeAttribute("pinned")));var o=n.firstChild||n.nextSibling;if(!o)for(o=n.parentNode;o;){if(o.nextSibling){o=o.nextSibling;break}o=o.parentNode}n=o}return e.Xml.domToText(t)},e.VariablesDynamic={},e.VariablesDynamic.onCreateVariableButtonClick_String=function(t){e.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"String")},e.VariablesDynamic.onCreateVariableButtonClick_Number=function(t){e.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"Number")},e.VariablesDynamic.onCreateVariableButtonClick_Colour=function(t){e.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"Colour")},e.VariablesDynamic.flyoutCategory=function(t){var n=[],o=document.createElement("button");return o.setAttribute("text",e.Msg.NEW_STRING_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),n.push(o),(o=document.createElement("button")).setAttribute("text",e.Msg.NEW_NUMBER_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),n.push(o),(o=document.createElement("button")).setAttribute("text",e.Msg.NEW_COLOUR_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),n.push(o),t.registerButtonCallback("CREATE_VARIABLE_STRING",e.VariablesDynamic.onCreateVariableButtonClick_String),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",e.VariablesDynamic.onCreateVariableButtonClick_Number),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",e.VariablesDynamic.onCreateVariableButtonClick_Colour),t=e.VariablesDynamic.flyoutCategoryBlocks(t),n.concat(t)},e.VariablesDynamic.flyoutCategoryBlocks=function(t){var n=[];if(0<(t=t.getAllVariables()).length){if(e.Blocks.variables_set_dynamic){var o=t[t.length-1],r=e.utils.xml.createElement("block");r.setAttribute("type","variables_set_dynamic"),r.setAttribute("gap",24),r.appendChild(e.Variables.generateVariableFieldDom(o)),n.push(r)}if(e.Blocks.variables_get_dynamic){t.sort(e.VariableModel.compareByName),o=0;for(var a;a=t[o];o++)(r=e.utils.xml.createElement("block")).setAttribute("type","variables_get_dynamic"),r.setAttribute("gap",8),r.appendChild(e.Variables.generateVariableFieldDom(a)),n.push(r)}}return n},e.ZoomControls=function(t){this.workspace_=t,this.id="zoomControls",this.zoomResetGroup_=this.zoomOutGroup_=this.zoomInGroup_=this.onZoomOutWrapper_=this.onZoomInWrapper_=this.onZoomResetWrapper_=null},e.ZoomControls.prototype.WIDTH_=32,e.ZoomControls.prototype.HEIGHT_=32,e.ZoomControls.prototype.SMALL_SPACING_=2,e.ZoomControls.prototype.LARGE_SPACING_=11,e.ZoomControls.prototype.MARGIN_VERTICAL_=20,e.ZoomControls.prototype.MARGIN_HORIZONTAL_=20,e.ZoomControls.prototype.svgGroup_=null,e.ZoomControls.prototype.left_=0,e.ZoomControls.prototype.top_=0,e.ZoomControls.prototype.initialized_=!1,e.ZoomControls.prototype.createDom=function(){this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{},null);var t=String(Math.random()).substring(2);return this.createZoomOutSvg_(t),this.createZoomInSvg_(t),this.workspace_.isMovable()&&this.createZoomResetSvg_(t),this.svgGroup_},e.ZoomControls.prototype.init=function(){this.workspace_.getComponentManager().addComponent({component:this,weight:2,capabilities:[e.ComponentManager.Capability.POSITIONABLE]}),this.initialized_=!0},e.ZoomControls.prototype.dispose=function(){this.workspace_.getComponentManager().removeComponent("zoomControls"),this.svgGroup_&&e.utils.dom.removeNode(this.svgGroup_),this.onZoomResetWrapper_&&e.browserEvents.unbind(this.onZoomResetWrapper_),this.onZoomInWrapper_&&e.browserEvents.unbind(this.onZoomInWrapper_),this.onZoomOutWrapper_&&e.browserEvents.unbind(this.onZoomOutWrapper_)},e.ZoomControls.prototype.getBoundingRectangle=function(){var t=this.SMALL_SPACING_+2*this.HEIGHT_;return this.zoomResetGroup_&&(t+=this.LARGE_SPACING_+this.HEIGHT_),new e.utils.Rect(this.top_,this.top_+t,this.left_,this.left_+this.WIDTH_)},e.ZoomControls.prototype.position=function(t,n){if(this.initialized_){var o=e.uiPosition.getCornerOppositeToolbox(this.workspace_,t),r=this.SMALL_SPACING_+2*this.HEIGHT_;this.zoomResetGroup_&&(r+=this.LARGE_SPACING_+this.HEIGHT_),t=e.uiPosition.getStartPositionRect(o,new e.utils.Size(this.WIDTH_,r),this.MARGIN_HORIZONTAL_,this.MARGIN_VERTICAL_,t,this.workspace_),n=e.uiPosition.bumpPositionRect(t,this.MARGIN_VERTICAL_,(o=o.vertical)===e.uiPosition.verticalPosition.TOP?e.uiPosition.bumpDirection.DOWN:e.uiPosition.bumpDirection.UP,n),o===e.uiPosition.verticalPosition.TOP?(this.zoomInGroup_.setAttribute("transform","translate(0, "+(o=this.SMALL_SPACING_+this.HEIGHT_)+")"),this.zoomResetGroup_&&this.zoomResetGroup_.setAttribute("transform","translate(0, "+(o+this.LARGE_SPACING_+this.HEIGHT_)+")")):(this.zoomInGroup_.setAttribute("transform","translate(0, "+(o=this.zoomResetGroup_?this.LARGE_SPACING_+this.HEIGHT_:0)+")"),this.zoomOutGroup_.setAttribute("transform","translate(0, "+(o+this.SMALL_SPACING_+this.HEIGHT_)+")")),this.top_=n.top,this.left_=n.left,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")")}},e.ZoomControls.prototype.createZoomOutSvg_=function(t){this.zoomOutGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:32,height:32},n),e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,height:e.SPRITE.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup_).setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),this.onZoomOutWrapper_=e.browserEvents.conditionalBind(this.zoomOutGroup_,"mousedown",null,this.zoom_.bind(this,-1))},e.ZoomControls.prototype.createZoomInSvg_=function(t){this.zoomInGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyZoominClipPath"+t},this.zoomInGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:32,height:32},n),e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,height:e.SPRITE.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup_).setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),this.onZoomInWrapper_=e.browserEvents.conditionalBind(this.zoomInGroup_,"mousedown",null,this.zoom_.bind(this,1))},e.ZoomControls.prototype.zoom_=function(t,n){this.workspace_.markFocused(),this.workspace_.zoomCenter(t),this.fireZoomEvent_(),e.Touch.clearTouchIdentifier(),n.stopPropagation(),n.preventDefault()},e.ZoomControls.prototype.createZoomResetSvg_=function(t){this.zoomResetGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var n=e.utils.dom.createSvgElement(e.utils.Svg.CLIPPATH,{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup_);e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:32,height:32},n),e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{width:e.SPRITE.width,height:e.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup_).setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+e.SPRITE.url),this.onZoomResetWrapper_=e.browserEvents.conditionalBind(this.zoomResetGroup_,"mousedown",null,this.resetZoom_.bind(this))},e.ZoomControls.prototype.resetZoom_=function(t){this.workspace_.markFocused();var n=Math.log(this.workspace_.options.zoomOptions.startScale/this.workspace_.scale)/Math.log(this.workspace_.options.zoomOptions.scaleSpeed);this.workspace_.beginCanvasTransition(),this.workspace_.zoomCenter(n),this.workspace_.scrollCenter(),setTimeout(this.workspace_.endCanvasTransition.bind(this.workspace_),500),this.fireZoomEvent_(),e.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()},e.ZoomControls.prototype.fireZoomEvent_=function(){var t=new(e.Events.get(e.Events.CLICK))(null,this.workspace_.id,"zoom_controls");e.Events.fire(t)},e.Css.register([".blocklyZoom>image, .blocklyZoom>svg>image {","opacity: .4;","}",".blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {","opacity: .6;","}",".blocklyZoom>image:active, .blocklyZoom>svg>image:active {","opacity: .8;","}"]),e.ShortcutItems={},e.ShortcutItems.names={ESCAPE:"escape",DELETE:"delete",COPY:"copy",CUT:"cut",PASTE:"paste",UNDO:"undo",REDO:"redo"},e.ShortcutItems.registerEscape=function(){var t={name:e.ShortcutItems.names.ESCAPE,preconditionFn:function(n){return!n.options.readOnly},callback:function(){return e.hideChaff(),!0}};e.ShortcutRegistry.registry.register(t),e.ShortcutRegistry.registry.addKeyMapping(e.utils.KeyCodes.ESC,t.name)},e.ShortcutItems.registerDelete=function(){var t={name:e.ShortcutItems.names.DELETE,preconditionFn:function(n){return!n.options.readOnly&&e.selected&&e.selected.isDeletable()},callback:function(n,o){return o.preventDefault(),!e.Gesture.inProgress()&&(e.deleteBlock(e.selected),!0)}};e.ShortcutRegistry.registry.register(t),e.ShortcutRegistry.registry.addKeyMapping(e.utils.KeyCodes.DELETE,t.name),e.ShortcutRegistry.registry.addKeyMapping(e.utils.KeyCodes.BACKSPACE,t.name)},e.ShortcutItems.registerCopy=function(){var t={name:e.ShortcutItems.names.COPY,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()&&e.selected&&e.selected.isDeletable()&&e.selected.isMovable()},callback:function(o,r){return r.preventDefault(),e.hideChaff(),e.copy(e.selected),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.C,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerCut=function(){var t={name:e.ShortcutItems.names.CUT,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()&&e.selected&&e.selected.isDeletable()&&e.selected.isMovable()&&!e.selected.workspace.isFlyout},callback:function(){return e.copy(e.selected),e.deleteBlock(e.selected),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.X,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerPaste=function(){var t={name:e.ShortcutItems.names.PASTE,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()},callback:function(){return e.paste()}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.V,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerUndo=function(){var t={name:e.ShortcutItems.names.UNDO,preconditionFn:function(o){return!o.options.readOnly&&!e.Gesture.inProgress()},callback:function(o){return e.hideChaff(),o.undo(!1),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerRedo=function(){var t={name:e.ShortcutItems.names.REDO,preconditionFn:function(o){return!e.Gesture.inProgress()&&!o.options.readOnly},callback:function(o){return e.hideChaff(),o.undo(!0),!0}};e.ShortcutRegistry.registry.register(t);var n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.SHIFT,e.utils.KeyCodes.CTRL]);e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.SHIFT,e.utils.KeyCodes.ALT]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Z,[e.utils.KeyCodes.SHIFT,e.utils.KeyCodes.META]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name),n=e.ShortcutRegistry.registry.createSerializedKey(e.utils.KeyCodes.Y,[e.utils.KeyCodes.CTRL]),e.ShortcutRegistry.registry.addKeyMapping(n,t.name)},e.ShortcutItems.registerDefaultShortcuts=function(){e.ShortcutItems.registerEscape(),e.ShortcutItems.registerDelete(),e.ShortcutItems.registerCopy(),e.ShortcutItems.registerCut(),e.ShortcutItems.registerPaste(),e.ShortcutItems.registerUndo(),e.ShortcutItems.registerRedo()},e.ShortcutItems.registerDefaultShortcuts(),e.ContextMenuItems={},e.ContextMenuItems.registerUndo=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.UNDO},preconditionFn:function(t){return 0<t.workspace.getUndoStack().length?"enabled":"disabled"},callback:function(t){t.workspace.undo(!1)},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},e.ContextMenuItems.registerRedo=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.REDO},preconditionFn:function(t){return 0<t.workspace.getRedoStack().length?"enabled":"disabled"},callback:function(t){t.workspace.undo(!0)},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},e.ContextMenuItems.registerCleanup=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.CLEAN_UP},preconditionFn:function(t){return t.workspace.isMovable()?1<t.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback:function(t){t.workspace.cleanUp()},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},e.ContextMenuItems.toggleOption_=function(t,n){for(var o=0,r=0;r<n.length;r++)for(var a=n[r];a;)setTimeout(a.setCollapsed.bind(a,t),o),a=a.getNextBlock(),o+=10},e.ContextMenuItems.registerCollapse=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.COLLAPSE_ALL},preconditionFn:function(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(var n=0;n<t.length;n++)for(var o=t[n];o;){if(!o.isCollapsed())return"enabled";o=o.getNextBlock()}return"disabled"}return"hidden"},callback:function(t){e.ContextMenuItems.toggleOption_(!0,t.workspace.getTopBlocks(!0))},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},e.ContextMenuItems.registerExpand=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.EXPAND_ALL},preconditionFn:function(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(var n=0;n<t.length;n++)for(var o=t[n];o;){if(o.isCollapsed())return"enabled";o=o.getNextBlock()}return"disabled"}return"hidden"},callback:function(t){e.ContextMenuItems.toggleOption_(!1,t.workspace.getTopBlocks(!0))},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},e.ContextMenuItems.addDeletableBlocks_=function(t,n){if(t.isDeletable())Array.prototype.push.apply(n,t.getDescendants(!1));else{t=t.getChildren(!1);for(var o=0;o<t.length;o++)e.ContextMenuItems.addDeletableBlocks_(t[o],n)}},e.ContextMenuItems.getDeletableBlocks_=function(t){var n=[];t=t.getTopBlocks(!0);for(var o=0;o<t.length;o++)e.ContextMenuItems.addDeletableBlocks_(t[o],n);return n},e.ContextMenuItems.deleteNext_=function(t,n){e.Events.setGroup(n);var o=t.shift();o&&(o.workspace?(o.dispose(!1,!0),setTimeout(e.ContextMenuItems.deleteNext_,10,t,n)):e.ContextMenuItems.deleteNext_(t,n)),e.Events.setGroup(!1)},e.ContextMenuItems.registerDeleteAll=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){if(t.workspace)return 1==(t=e.ContextMenuItems.getDeletableBlocks_(t.workspace).length)?e.Msg.DELETE_BLOCK:e.Msg.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn:function(t){if(t.workspace)return 0<e.ContextMenuItems.getDeletableBlocks_(t.workspace).length?"enabled":"disabled"},callback:function(t){if(t.workspace){t.workspace.cancelCurrentGesture();var n=e.ContextMenuItems.getDeletableBlocks_(t.workspace),o=e.utils.genUid();2>n.length?e.ContextMenuItems.deleteNext_(n,o):e.confirm(e.Msg.DELETE_ALL_BLOCKS.replace("%1",n.length),function(r){r&&e.ContextMenuItems.deleteNext_(n,o)})}},scopeType:e.ContextMenuRegistry.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},e.ContextMenuItems.registerWorkspaceOptions_=function(){e.ContextMenuItems.registerUndo(),e.ContextMenuItems.registerRedo(),e.ContextMenuItems.registerCleanup(),e.ContextMenuItems.registerCollapse(),e.ContextMenuItems.registerExpand(),e.ContextMenuItems.registerDeleteAll()},e.ContextMenuItems.registerDuplicate=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.DUPLICATE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden"},callback:function(t){t.block&&e.duplicate(t.block)},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},e.ContextMenuItems.registerComment=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.getCommentIcon()?e.Msg.REMOVE_COMMENT:e.Msg.ADD_COMMENT},preconditionFn:function(t){return t=t.block,e.utils.userAgent.IE||t.isInFlyout||!t.workspace.options.comments||t.isCollapsed()||!t.isEditable()?"hidden":"enabled"},callback:function(t){(t=t.block).getCommentIcon()?t.setCommentText(null):t.setCommentText("")},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockComment",weight:2})},e.ContextMenuItems.registerInline=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.getInputsInline()?e.Msg.EXTERNAL_INPUTS:e.Msg.INLINE_INPUTS},preconditionFn:function(t){if(!(t=t.block).isInFlyout&&t.isMovable()&&!t.isCollapsed())for(var n=1;n<t.inputList.length;n++)if(t.inputList[n-1].type!=e.inputTypes.STATEMENT&&t.inputList[n].type!=e.inputTypes.STATEMENT)return"enabled";return"hidden"},callback:function(t){t.block.setInputsInline(!t.block.getInputsInline())},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockInline",weight:3})},e.ContextMenuItems.registerCollapseExpandBlock=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.isCollapsed()?e.Msg.EXPAND_BLOCK:e.Msg.COLLAPSE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback:function(t){t.block.setCollapsed(!t.block.isCollapsed())},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},e.ContextMenuItems.registerDisable=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.isEnabled()?e.Msg.DISABLE_BLOCK:e.Msg.ENABLE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.workspace.options.disable&&t.isEditable()?t.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback:function(t){t=t.block;var n=e.Events.getGroup();n||e.Events.setGroup(!0),t.setEnabled(!t.isEnabled()),n||e.Events.setGroup(!1)},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDisable",weight:5})},e.ContextMenuItems.registerDelete=function(){e.ContextMenuRegistry.registry.register({displayText:function(t){var n=t.block;return t=n.getDescendants(!1).length,(n=n.getNextBlock())&&(t-=n.getDescendants(!1).length),1==t?e.Msg.DELETE_BLOCK:e.Msg.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn:function(t){return!t.block.isInFlyout&&t.block.isDeletable()?"enabled":"hidden"},callback:function(t){e.Events.setGroup(!0),t.block&&e.deleteBlock(t.block),e.Events.setGroup(!1)},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDelete",weight:6})},e.ContextMenuItems.registerHelp=function(){e.ContextMenuRegistry.registry.register({displayText:function(){return e.Msg.HELP},preconditionFn:function(t){return("function"==typeof(t=t.block).helpUrl?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback:function(t){t.block.showHelp()},scopeType:e.ContextMenuRegistry.ScopeType.BLOCK,id:"blockHelp",weight:7})},e.ContextMenuItems.registerBlockOptions_=function(){e.ContextMenuItems.registerDuplicate(),e.ContextMenuItems.registerComment(),e.ContextMenuItems.registerInline(),e.ContextMenuItems.registerCollapseExpandBlock(),e.ContextMenuItems.registerDisable(),e.ContextMenuItems.registerDelete(),e.ContextMenuItems.registerHelp()},e.ContextMenuItems.registerDefaultOptions=function(){e.ContextMenuItems.registerWorkspaceOptions_(),e.ContextMenuItems.registerBlockOptions_()},e.ContextMenuItems.registerDefaultOptions(),e.Mutator=function(t){e.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=t},e.utils.object.inherits(e.Mutator,e.Icon),e.Mutator.prototype.workspace_=null,e.Mutator.prototype.workspaceWidth_=0,e.Mutator.prototype.workspaceHeight_=0,e.Mutator.prototype.setBlock=function(t){this.block_=t},e.Mutator.prototype.getWorkspace=function(){return this.workspace_},e.Mutator.prototype.drawIcon_=function(t){e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},t),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},t),e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},t)},e.Mutator.prototype.iconClick_=function(t){this.block_.isEditable()&&e.Icon.prototype.iconClick_.call(this,t)},e.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{x:e.Bubble.BORDER_WIDTH,y:e.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var o,t=e.utils.xml.createElement("xml"),n=0;o=this.quarkNames_[n];n++){var r=e.utils.xml.createElement("block");r.setAttribute("type",o),t.appendChild(r)}else t=null;return(n=new e.Options({disable:!1,parentWorkspace:this.block_.workspace,media:this.block_.workspace.options.pathToMedia,rtl:this.block_.RTL,horizontalLayout:!1,renderer:this.block_.workspace.options.renderer,rendererOverrides:this.block_.workspace.options.rendererOverrides})).toolboxPosition=this.block_.RTL?e.utils.toolbox.Position.RIGHT:e.utils.toolbox.Position.LEFT,(o=!!t)&&(n.languageTree=e.utils.toolbox.convertToolboxDefToJson(t)),this.workspace_=new e.WorkspaceSvg(n),this.workspace_.isMutator=!0,this.workspace_.addChangeListener(e.Events.disableOrphans),t=o?this.workspace_.addFlyout(e.utils.Svg.G):null,n=this.workspace_.createDom("blocklyMutatorBackground"),t&&n.insertBefore(t,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(n),this.svgDialog_},e.Mutator.prototype.updateEditable=function(){e.Mutator.superClass_.updateEditable.call(this),this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&e.utils.dom.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&e.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly")))},e.Mutator.prototype.resizeBubble_=function(){var t=2*e.Bubble.BORDER_WIDTH,n=this.workspace_.getCanvas().getBBox(),o=n.width+n.x,r=n.height+3*t,a=this.workspace_.getFlyout();if(a){var h=a.getWorkspace().getMetricsManager().getScrollMetrics();r=Math.max(r,h.height+20),o+=a.getWidth()}this.block_.RTL&&(o=-n.x),o+=3*t,(Math.abs(this.workspaceWidth_-o)>t||Math.abs(this.workspaceHeight_-r)>t)&&(this.workspaceWidth_=o,this.workspaceHeight_=r,this.bubble_.setBubbleSize(o+t,r+t),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_),this.workspace_.setCachedParentSvgSize(this.workspaceWidth_,this.workspaceHeight_)),this.block_.RTL&&(t="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",t)),this.workspace_.resize()},e.Mutator.prototype.onBubbleMove_=function(){this.workspace_&&this.workspace_.recordDragTargets()},e.Mutator.prototype.setVisible=function(t){if(t!=this.isVisible())if(e.Events.fire(new(e.Events.get(e.Events.BUBBLE_OPEN))(this.block_,t,"mutator")),t){this.bubble_=new e.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerMoveEvent(this.onBubbleMove_.bind(this));var n=this.workspace_.options.languageTree;t=this.workspace_.getFlyout(),n&&(t.init(this.workspace_),t.show(n)),this.rootBlock_=this.block_.decompose(this.workspace_),n=this.rootBlock_.getDescendants(!1);for(var r,o=0;r=n[o];o++)r.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),t?(n=2*t.CORNER_RADIUS,t=this.rootBlock_.RTL?t.getWidth()+n:n):t=n=16,this.block_.RTL&&(t=-t),this.rootBlock_.moveBy(t,n),this.block_.saveConnections){var a=this,h=this.block_;h.saveConnections(this.rootBlock_),this.sourceListener_=function(){h.saveConnections(a.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.applyColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},e.Mutator.prototype.workspaceChanged_=function(t){if(!(t.isUiEvent||t.type==e.Events.CHANGE&&"disabled"==t.element)){if(!this.workspace_.isDragging()){t=this.workspace_.getTopBlocks(!1);for(var o,n=0;o=t[n];n++){var r=o.getRelativeToSurfaceXY();if(20>r.y&&o.moveBy(0,20-r.y),o.RTL){var a=-20,h=this.workspace_.getFlyout();h&&(a-=h.getWidth()),r.x>a&&o.moveBy(a-r.x,0)}else 20>r.x&&o.moveBy(20-r.x,0)}}if(this.rootBlock_.workspace==this.workspace_){if(e.Events.setGroup(!0),t=(t=(o=this.block_).mutationToDom())&&e.Xml.domToText(t),n=o.rendered,o.rendered=!1,o.compose(this.rootBlock_),o.rendered=n,o.initSvg(),o.rendered&&o.render(),t!=(n=(n=o.mutationToDom())&&e.Xml.domToText(n))){e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(o,"mutation",null,t,n));var R=e.Events.getGroup();setTimeout(function(){e.Events.setGroup(R),o.bumpNeighbours(),e.Events.setGroup(!1)},e.BUMP_DELAY)}this.workspace_.isDragging()||this.resizeBubble_(),e.Events.setGroup(!1)}}},e.Mutator.prototype.dispose=function(){this.block_.mutator=null,e.Icon.prototype.dispose.call(this)},e.Mutator.prototype.updateBlockStyle=function(){var t=this.workspace_;if(t&&t.getAllBlocks(!1)){for(var r,n=t.getAllBlocks(!1),o=0;r=n[o];o++)r.setStyle(r.getStyleName());if(o=t.getFlyout())for(t=o.workspace_.getAllBlocks(!1),o=0;r=t[o];o++)r.setStyle(r.getStyleName())}},e.Mutator.reconnect=function(t,n,o){if(!t||!t.getSourceBlock().workspace)return!1;o=n.getInput(o).connection;var r=t.targetBlock();return!(r&&r!=n||o.targetConnection==t||(o.isConnected()&&o.disconnect(),o.connect(t),0))},e.Mutator.findParentWs=function(t){var n=null;if(t&&t.options){var o=t.options.parentWorkspace;t.isFlyout?o&&o.options&&(n=o.options.parentWorkspace):o&&(n=o)}return n},e.FieldTextInput=function(t,n,o){this.spellcheck_=!0,e.FieldTextInput.superClass_.constructor.call(this,t,n,o),this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.htmlInput_=null,this.fullBlockClickTarget_=!1,this.workspace_=null},e.utils.object.inherits(e.FieldTextInput,e.Field),e.FieldTextInput.prototype.DEFAULT_VALUE="",e.FieldTextInput.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldTextInput(n,void 0,t)},e.FieldTextInput.prototype.SERIALIZABLE=!0,e.FieldTextInput.BORDERRADIUS=4,e.FieldTextInput.prototype.CURSOR="text",e.FieldTextInput.prototype.configure_=function(t){e.FieldTextInput.superClass_.configure_.call(this,t),"boolean"==typeof t.spellcheck&&(this.spellcheck_=t.spellcheck)},e.FieldTextInput.prototype.initView=function(){if(this.getConstants().FULL_BLOCK_FIELDS){for(var r,t=0,n=0,o=0;r=this.sourceBlock_.inputList[o];o++){for(var a=0;r.fieldRow[a];a++)t++;r.connection&&n++}this.fullBlockClickTarget_=1>=t&&this.sourceBlock_.outputConnection&&!n}else this.fullBlockClickTarget_=!1;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()},e.FieldTextInput.prototype.doClassValidation_=function(t){return null==t?null:String(t)},e.FieldTextInput.prototype.doValueInvalid_=function(t){this.isBeingEdited_&&(this.isTextValid_=!1,t=this.value_,this.value_=this.htmlInput_.untypedDefaultValue_,this.sourceBlock_&&e.Events.isEnabled()&&e.Events.fire(new(e.Events.get(e.Events.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,t,this.value_)))},e.FieldTextInput.prototype.doValueUpdate_=function(t){this.isTextValid_=!0,this.value_=t,this.isBeingEdited_||(this.isDirty_=!0)},e.FieldTextInput.prototype.applyColour=function(){this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS&&(this.borderRect_?this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR))},e.FieldTextInput.prototype.render_=function(){if(e.FieldTextInput.superClass_.render_.call(this),this.isBeingEdited_){this.resizeEditor_();var t=this.htmlInput_;this.isTextValid_?(e.utils.dom.removeClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!1)):(e.utils.dom.addClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!0))}},e.FieldTextInput.prototype.setSpellcheck=function(t){t!=this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))},e.FieldTextInput.prototype.showEditor_=function(t,n){this.workspace_=this.sourceBlock_.workspace,!(t=n||!1)&&(e.utils.userAgent.MOBILE||e.utils.userAgent.ANDROID||e.utils.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(t)},e.FieldTextInput.prototype.showPromptEditor_=function(){e.prompt(e.Msg.CHANGE_VALUE_TITLE,this.getText(),function(t){this.setValue(this.getValueFromEditorText_(t))}.bind(this))},e.FieldTextInput.prototype.showInlineEditor_=function(t){e.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,t||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())},e.FieldTextInput.prototype.widgetCreate_=function(){var t=e.WidgetDiv.DIV;e.utils.dom.addClass(this.getClickTarget_(),"editing");var n=document.createElement("input");n.className="blocklyHtmlInput",n.setAttribute("spellcheck",this.spellcheck_);var o=this.workspace_.getScale(),r=this.getConstants().FIELD_TEXT_FONTSIZE*o+"pt";if(t.style.fontSize=r,n.style.fontSize=r,r=e.FieldTextInput.BORDERRADIUS*o+"px",this.fullBlockClickTarget_){r=((r=this.getScaledBBox()).bottom-r.top)/2+"px";var a=this.sourceBlock_.getParent()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;n.style.border=1*o+"px solid "+a,t.style.borderRadius=r,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0px 0px 0px "+4*o+"px")}return n.style.borderRadius=r,t.appendChild(n),n.value=n.defaultValue=this.getEditorText_(this.value_),n.untypedDefaultValue_=this.value_,n.oldValue_=null,this.resizeEditor_(),this.bindInputEvents_(n),n},e.FieldTextInput.prototype.widgetDispose_=function(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_&&this.onFinishEditing_(this.value_),this.unbindInputEvents_();var t=e.WidgetDiv.DIV.style;t.width="auto",t.height="auto",t.fontSize="",t.transition="",t.boxShadow="",this.htmlInput_=null,e.utils.dom.removeClass(this.getClickTarget_(),"editing")},e.FieldTextInput.prototype.bindInputEvents_=function(t){this.onKeyDownWrapper_=e.browserEvents.conditionalBind(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=e.browserEvents.conditionalBind(t,"input",this,this.onHtmlInputChange_)},e.FieldTextInput.prototype.unbindInputEvents_=function(){this.onKeyDownWrapper_&&(e.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(e.browserEvents.unbind(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)},e.FieldTextInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode==e.utils.KeyCodes.ENTER?(e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()):t.keyCode==e.utils.KeyCodes.ESC?(this.setValue(this.htmlInput_.untypedDefaultValue_),e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation()):t.keyCode==e.utils.KeyCodes.TAB&&(e.WidgetDiv.hide(),e.DropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())},e.FieldTextInput.prototype.onHtmlInputChange_=function(t){(t=this.htmlInput_.value)!==this.htmlInput_.oldValue_&&(this.htmlInput_.oldValue_=t,e.Events.setGroup(!0),t=this.getValueFromEditorText_(t),this.setValue(t),this.forceRerender(),this.resizeEditor_(),e.Events.setGroup(!1))},e.FieldTextInput.prototype.setEditorValue_=function(t){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t)},e.FieldTextInput.prototype.resizeEditor_=function(){var t=e.WidgetDiv.DIV,n=this.getScaledBBox();t.style.width=n.right-n.left+"px",t.style.height=n.bottom-n.top+"px",n=new e.utils.Coordinate(this.sourceBlock_.RTL?n.right-t.offsetWidth:n.left,n.top),t.style.left=n.x+"px",t.style.top=n.y+"px"},e.FieldTextInput.prototype.isTabNavigable=function(){return!0},e.FieldTextInput.prototype.getText_=function(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null},e.FieldTextInput.prototype.getEditorText_=function(t){return String(t)},e.FieldTextInput.prototype.getValueFromEditorText_=function(t){return t},e.fieldRegistry.register("field_input",e.FieldTextInput),e.FieldAngle=function(t,n,o){this.clockwise_=e.FieldAngle.CLOCKWISE,this.offset_=e.FieldAngle.OFFSET,this.wrap_=e.FieldAngle.WRAP,this.round_=e.FieldAngle.ROUND,e.FieldAngle.superClass_.constructor.call(this,t,n,o),this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.line_=this.gauge_=this.editor_=null},e.utils.object.inherits(e.FieldAngle,e.FieldTextInput),e.FieldAngle.prototype.DEFAULT_VALUE=0,e.FieldAngle.fromJson=function(t){return new e.FieldAngle(t.angle,void 0,t)},e.FieldAngle.prototype.SERIALIZABLE=!0,e.FieldAngle.ROUND=15,e.FieldAngle.HALF=50,e.FieldAngle.CLOCKWISE=!1,e.FieldAngle.OFFSET=0,e.FieldAngle.WRAP=360,e.FieldAngle.RADIUS=e.FieldAngle.HALF-1,e.FieldAngle.prototype.configure_=function(t){switch(e.FieldAngle.superClass_.configure_.call(this,t),t.mode){case"compass":this.clockwise_=!0,this.offset_=90;break;case"protractor":this.clockwise_=!1,this.offset_=0}var n=t.clockwise;"boolean"==typeof n&&(this.clockwise_=n),null!=(n=t.offset)&&(n=Number(n),isNaN(n)||(this.offset_=n)),null!=(n=t.wrap)&&(n=Number(n),isNaN(n)||(this.wrap_=n)),null!=(t=t.round)&&(t=Number(t),isNaN(t)||(this.round_=t))},e.FieldAngle.prototype.initView=function(){e.FieldAngle.superClass_.initView.call(this),this.symbol_=e.utils.dom.createSvgElement(e.utils.Svg.TSPAN,{},null),this.symbol_.appendChild(document.createTextNode("\xb0")),this.textElement_.appendChild(this.symbol_)},e.FieldAngle.prototype.render_=function(){e.FieldAngle.superClass_.render_.call(this),this.updateGraph_()},e.FieldAngle.prototype.showEditor_=function(t){e.FieldAngle.superClass_.showEditor_.call(this,t,e.utils.userAgent.MOBILE||e.utils.userAgent.ANDROID||e.utils.userAgent.IPAD),this.dropdownCreate_(),e.DropDownDiv.getContentDiv().appendChild(this.editor_),e.DropDownDiv.setColour(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),e.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.updateGraph_()},e.FieldAngle.prototype.dropdownCreate_=function(){var t=e.utils.dom.createSvgElement(e.utils.Svg.SVG,{xmlns:e.utils.dom.SVG_NS,"xmlns:html":e.utils.dom.HTML_NS,"xmlns:xlink":e.utils.dom.XLINK_NS,version:"1.1",height:2*e.FieldAngle.HALF+"px",width:2*e.FieldAngle.HALF+"px",style:"touch-action: none"},null),n=e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{cx:e.FieldAngle.HALF,cy:e.FieldAngle.HALF,r:e.FieldAngle.RADIUS,class:"blocklyAngleCircle"},t);this.gauge_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyAngleGauge"},t),this.line_=e.utils.dom.createSvgElement(e.utils.Svg.LINE,{x1:e.FieldAngle.HALF,y1:e.FieldAngle.HALF,class:"blocklyAngleLine"},t);for(var o=0;360>o;o+=15)e.utils.dom.createSvgElement(e.utils.Svg.LINE,{x1:e.FieldAngle.HALF+e.FieldAngle.RADIUS,y1:e.FieldAngle.HALF,x2:e.FieldAngle.HALF+e.FieldAngle.RADIUS-(o%45==0?10:5),y2:e.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+o+","+e.FieldAngle.HALF+","+e.FieldAngle.HALF+")"},t);this.clickWrapper_=e.browserEvents.conditionalBind(t,"click",this,this.hide_),this.clickSurfaceWrapper_=e.browserEvents.conditionalBind(n,"click",this,this.onMouseMove_,!0,!0),this.moveSurfaceWrapper_=e.browserEvents.conditionalBind(n,"mousemove",this,this.onMouseMove_,!0,!0),this.editor_=t},e.FieldAngle.prototype.dropdownDispose_=function(){this.clickWrapper_&&(e.browserEvents.unbind(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(e.browserEvents.unbind(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(e.browserEvents.unbind(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null},e.FieldAngle.prototype.hide_=function(){e.DropDownDiv.hideIfOwner(this),e.WidgetDiv.hide()},e.FieldAngle.prototype.onMouseMove_=function(t){var n=this.gauge_.ownerSVGElement.getBoundingClientRect(),o=t.clientX-n.left-e.FieldAngle.HALF;t=t.clientY-n.top-e.FieldAngle.HALF,n=Math.atan(-t/o),isNaN(n)||(n=e.utils.math.toDegrees(n),0>o?n+=180:0<t&&(n+=360),this.displayMouseOrKeyboardValue_(n=this.clockwise_?this.offset_+360-n:360-(this.offset_-n)))},e.FieldAngle.prototype.displayMouseOrKeyboardValue_=function(t){this.round_&&(t=Math.round(t/this.round_)*this.round_),(t=this.wrapValue_(t))!=this.value_&&this.setEditorValue_(t)},e.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var t=Number(this.getText())+this.offset_,n=e.utils.math.toRadians(t%360);t=["M ",e.FieldAngle.HALF,",",e.FieldAngle.HALF];var o=e.FieldAngle.HALF,r=e.FieldAngle.HALF;if(!isNaN(n)){var a=Number(this.clockwise_),h=e.utils.math.toRadians(this.offset_),R=Math.cos(h)*e.FieldAngle.RADIUS,L=Math.sin(h)*-e.FieldAngle.RADIUS;a&&(n=2*h-n),o+=Math.cos(n)*e.FieldAngle.RADIUS,r-=Math.sin(n)*e.FieldAngle.RADIUS,n=Math.abs(Math.floor((n-h)/Math.PI)%2),a&&(n=1-n),t.push(" l ",R,",",L," A ",e.FieldAngle.RADIUS,",",e.FieldAngle.RADIUS," 0 ",n," ",a," ",o,",",r," z")}this.gauge_.setAttribute("d",t.join("")),this.line_.setAttribute("x2",o),this.line_.setAttribute("y2",r)}},e.FieldAngle.prototype.onHtmlInputKeyDown_=function(t){var n;if(e.FieldAngle.superClass_.onHtmlInputKeyDown_.call(this,t),t.keyCode===e.utils.KeyCodes.LEFT?n=this.sourceBlock_.RTL?1:-1:t.keyCode===e.utils.KeyCodes.RIGHT?n=this.sourceBlock_.RTL?-1:1:t.keyCode===e.utils.KeyCodes.DOWN?n=-1:t.keyCode===e.utils.KeyCodes.UP&&(n=1),n){var o=this.getValue();this.displayMouseOrKeyboardValue_(o+n*this.round_),t.preventDefault(),t.stopPropagation()}},e.FieldAngle.prototype.doClassValidation_=function(t){return t=Number(t),isNaN(t)||!isFinite(t)?null:this.wrapValue_(t)},e.FieldAngle.prototype.wrapValue_=function(t){return 0>(t%=360)&&(t+=360),t>this.wrap_&&(t-=360),t},e.Css.register(".blocklyAngleCircle {,stroke: #444;,stroke-width: 1;,fill: #ddd;,fill-opacity: .8;,},.blocklyAngleMarks {,stroke: #444;,stroke-width: 1;,},.blocklyAngleGauge {,fill: #f88;,fill-opacity: .8;,pointer-events: none;,},.blocklyAngleLine {,stroke: #f00;,stroke-width: 2;,stroke-linecap: round;,pointer-events: none;,}".split(",")),e.fieldRegistry.register("field_angle",e.FieldAngle),e.FieldCheckbox=function(t,n,o){this.checkChar_=null,e.FieldCheckbox.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.FieldCheckbox,e.Field),e.FieldCheckbox.prototype.DEFAULT_VALUE=!1,e.FieldCheckbox.fromJson=function(t){return new e.FieldCheckbox(t.checked,void 0,t)},e.FieldCheckbox.CHECK_CHAR="\u2713",e.FieldCheckbox.prototype.SERIALIZABLE=!0,e.FieldCheckbox.prototype.CURSOR="default",e.FieldCheckbox.prototype.configure_=function(t){e.FieldCheckbox.superClass_.configure_.call(this,t),t.checkCharacter&&(this.checkChar_=t.checkCharacter)},e.FieldCheckbox.prototype.initView=function(){e.FieldCheckbox.superClass_.initView.call(this),e.utils.dom.addClass(this.textElement_,"blocklyCheckbox"),this.textElement_.style.display=this.value_?"block":"none"},e.FieldCheckbox.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)},e.FieldCheckbox.prototype.getDisplayText_=function(){return this.checkChar_||e.FieldCheckbox.CHECK_CHAR},e.FieldCheckbox.prototype.setCheckCharacter=function(t){this.checkChar_=t,this.forceRerender()},e.FieldCheckbox.prototype.showEditor_=function(){this.setValue(!this.value_)},e.FieldCheckbox.prototype.doClassValidation_=function(t){return!0===t||"TRUE"===t?"TRUE":!1===t||"FALSE"===t?"FALSE":null},e.FieldCheckbox.prototype.doValueUpdate_=function(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")},e.FieldCheckbox.prototype.getValue=function(){return this.value_?"TRUE":"FALSE"},e.FieldCheckbox.prototype.getValueBoolean=function(){return this.value_},e.FieldCheckbox.prototype.getText=function(){return String(this.convertValueToBool_(this.value_))},e.FieldCheckbox.prototype.convertValueToBool_=function(t){return"string"==typeof t?"TRUE"==t:!!t},e.fieldRegistry.register("field_checkbox",e.FieldCheckbox),e.FieldColour=function(t,n,o){e.FieldColour.superClass_.constructor.call(this,t,n,o),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null},e.utils.object.inherits(e.FieldColour,e.Field),e.FieldColour.fromJson=function(t){return new e.FieldColour(t.colour,void 0,t)},e.FieldColour.prototype.SERIALIZABLE=!0,e.FieldColour.prototype.CURSOR="default",e.FieldColour.prototype.isDirty_=!1,e.FieldColour.prototype.colours_=null,e.FieldColour.prototype.titles_=null,e.FieldColour.prototype.columns_=0,e.FieldColour.prototype.configure_=function(t){e.FieldColour.superClass_.configure_.call(this,t),t.colourOptions&&(this.colours_=t.colourOptions,this.titles_=t.colourTitles),t.columns&&(this.columns_=t.columns)},e.FieldColour.prototype.initView=function(){this.size_=new e.utils.Size(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.clickTarget_=this.sourceBlock_.getSvgRoot():(this.createBorderRect_(),this.borderRect_.style.fillOpacity="1")},e.FieldColour.prototype.applyColour=function(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())},e.FieldColour.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:e.utils.colour.parse(t)},e.FieldColour.prototype.doValueUpdate_=function(t){this.value_=t,this.borderRect_?this.borderRect_.style.fill=t:this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",t),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))},e.FieldColour.prototype.getText=function(){var t=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(t)&&(t="#"+t[1]+t[3]+t[5]),t},e.FieldColour.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),e.FieldColour.prototype.DEFAULT_VALUE=e.FieldColour.COLOURS[0],e.FieldColour.TITLES=[],e.FieldColour.COLUMNS=7,e.FieldColour.prototype.setColours=function(t,n){return this.colours_=t,n&&(this.titles_=n),this},e.FieldColour.prototype.setColumns=function(t){return this.columns_=t,this},e.FieldColour.prototype.showEditor_=function(){this.dropdownCreate_(),e.DropDownDiv.getContentDiv().appendChild(this.picker_),e.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:!0})},e.FieldColour.prototype.onClick_=function(t){null!==(t=(t=t.target)&&t.label)&&(this.setValue(t),e.DropDownDiv.hideIfOwner(this))},e.FieldColour.prototype.onKeyDown_=function(t){var n=!1;t.keyCode===e.utils.KeyCodes.UP?(this.moveHighlightBy_(0,-1),n=!0):t.keyCode===e.utils.KeyCodes.DOWN?(this.moveHighlightBy_(0,1),n=!0):t.keyCode===e.utils.KeyCodes.LEFT?(this.moveHighlightBy_(-1,0),n=!0):t.keyCode===e.utils.KeyCodes.RIGHT?(this.moveHighlightBy_(1,0),n=!0):t.keyCode===e.utils.KeyCodes.ENTER&&((n=this.getHighlighted_())&&null!==(n=n&&n.label)&&this.setValue(n),e.DropDownDiv.hideWithoutAnimation(),n=!0),n&&t.stopPropagation()},e.FieldColour.prototype.moveHighlightBy_=function(t,n){var o=this.colours_||e.FieldColour.COLOURS,r=this.columns_||e.FieldColour.COLUMNS,a=this.highlightedIndex_%r,h=Math.floor(this.highlightedIndex_/r);a+=t,h+=n,0>t?0>a&&0<h?(a=r-1,h--):0>a&&(a=0):0<t?a>r-1&&h<Math.floor(o.length/r)-1?(a=0,h++):a>r-1&&a--:0>n?0>h&&(h=0):0<n&&h>Math.floor(o.length/r)-1&&(h=Math.floor(o.length/r)-1),this.setHighlightedCell_(this.picker_.childNodes[h].childNodes[a],h*r+a)},e.FieldColour.prototype.onMouseMove_=function(t){var n=(t=t.target)&&Number(t.getAttribute("data-index"));null!==n&&n!==this.highlightedIndex_&&this.setHighlightedCell_(t,n)},e.FieldColour.prototype.onMouseEnter_=function(){this.picker_.focus({preventScroll:!0})},e.FieldColour.prototype.onMouseLeave_=function(){this.picker_.blur();var t=this.getHighlighted_();t&&e.utils.dom.removeClass(t,"blocklyColourHighlighted")},e.FieldColour.prototype.getHighlighted_=function(){var t=this.columns_||e.FieldColour.COLUMNS,n=this.picker_.childNodes[Math.floor(this.highlightedIndex_/t)];return n?n.childNodes[this.highlightedIndex_%t]:null},e.FieldColour.prototype.setHighlightedCell_=function(t,n){var o=this.getHighlighted_();o&&e.utils.dom.removeClass(o,"blocklyColourHighlighted"),e.utils.dom.addClass(t,"blocklyColourHighlighted"),this.highlightedIndex_=n,e.utils.aria.setState(this.picker_,e.utils.aria.State.ACTIVEDESCENDANT,t.getAttribute("id"))},e.FieldColour.prototype.dropdownCreate_=function(){var t=this.columns_||e.FieldColour.COLUMNS,n=this.colours_||e.FieldColour.COLOURS,o=this.titles_||e.FieldColour.TITLES,r=this.getValue(),a=document.createElement("table");a.className="blocklyColourTable",a.tabIndex=0,a.dir="ltr",e.utils.aria.setRole(a,e.utils.aria.Role.GRID),e.utils.aria.setState(a,e.utils.aria.State.EXPANDED,!0),e.utils.aria.setState(a,e.utils.aria.State.ROWCOUNT,Math.floor(n.length/t)),e.utils.aria.setState(a,e.utils.aria.State.COLCOUNT,t);for(var h,R=0;R<n.length;R++){R%t==0&&(h=document.createElement("tr"),e.utils.aria.setRole(h,e.utils.aria.Role.ROW),a.appendChild(h));var L=document.createElement("td");h.appendChild(L),L.label=n[R],L.title=o[R]||n[R],L.id=e.utils.IdGenerator.getNextUniqueId(),L.setAttribute("data-index",R),e.utils.aria.setRole(L,e.utils.aria.Role.GRIDCELL),e.utils.aria.setState(L,e.utils.aria.State.LABEL,n[R]),e.utils.aria.setState(L,e.utils.aria.State.SELECTED,n[R]==r),L.style.backgroundColor=n[R],n[R]==r&&(L.className="blocklyColourSelected",this.highlightedIndex_=R)}this.onClickWrapper_=e.browserEvents.conditionalBind(a,"click",this,this.onClick_,!0),this.onMouseMoveWrapper_=e.browserEvents.conditionalBind(a,"mousemove",this,this.onMouseMove_,!0),this.onMouseEnterWrapper_=e.browserEvents.conditionalBind(a,"mouseenter",this,this.onMouseEnter_,!0),this.onMouseLeaveWrapper_=e.browserEvents.conditionalBind(a,"mouseleave",this,this.onMouseLeave_,!0),this.onKeyDownWrapper_=e.browserEvents.conditionalBind(a,"keydown",this,this.onKeyDown_),this.picker_=a},e.FieldColour.prototype.dropdownDispose_=function(){this.onClickWrapper_&&(e.browserEvents.unbind(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(e.browserEvents.unbind(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(e.browserEvents.unbind(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(e.browserEvents.unbind(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(e.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null},e.Css.register([".blocklyColourTable {","border-collapse: collapse;","display: block;","outline: none;","padding: 1px;","}",".blocklyColourTable>tr>td {","border: .5px solid #888;","box-sizing: border-box;","cursor: pointer;","display: inline-block;","height: 20px;","padding: 0;","width: 20px;","}",".blocklyColourTable>tr>td.blocklyColourHighlighted {","border-color: #eee;","box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);","position: relative;","}",".blocklyColourSelected, .blocklyColourSelected:hover {","border-color: #eee !important;","outline: 1px solid #333;","position: relative;","}"]),e.fieldRegistry.register("field_colour",e.FieldColour),e.FieldDropdown=function(t,n,o){"function"!=typeof t&&e.FieldDropdown.validateOptions_(t),this.menuGenerator_=t,this.suffixField=this.prefixField=this.generatedOptions_=null,this.trimOptions_(),this.selectedOption_=this.getOptions(!1)[0],e.FieldDropdown.superClass_.constructor.call(this,this.selectedOption_[1],n,o),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null},e.utils.object.inherits(e.FieldDropdown,e.Field),e.FieldDropdown.fromJson=function(t){return new e.FieldDropdown(t.options,void 0,t)},e.FieldDropdown.prototype.fromXml=function(t){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t.textContent)},e.FieldDropdown.prototype.SERIALIZABLE=!0,e.FieldDropdown.CHECKMARK_OVERHANG=25,e.FieldDropdown.MAX_MENU_HEIGHT_VH=.45,e.FieldDropdown.IMAGE_Y_OFFSET=5,e.FieldDropdown.IMAGE_Y_PADDING=2*e.FieldDropdown.IMAGE_Y_OFFSET,e.FieldDropdown.ARROW_CHAR=e.utils.userAgent.ANDROID?"\u25bc":"\u25be",e.FieldDropdown.prototype.CURSOR="default",e.FieldDropdown.prototype.initView=function(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&e.utils.dom.addClass(this.borderRect_,"blocklyDropdownRect")},e.FieldDropdown.prototype.shouldAddBorderRect_=function(){return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!this.sourceBlock_.isShadow()},e.FieldDropdown.prototype.createTextArrow_=function(){this.arrow_=e.utils.dom.createSvgElement(e.utils.Svg.TSPAN,{},this.textElement_),this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?e.FieldDropdown.ARROW_CHAR+" ":" "+e.FieldDropdown.ARROW_CHAR)),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textContent_):this.textElement_.appendChild(this.arrow_)},e.FieldDropdown.prototype.createSVGArrow_=function(){this.svgArrow_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)},e.FieldDropdown.prototype.showEditor_=function(t){if(this.dropdownCreate_(),this.menu_.openingCoords=t&&"number"==typeof t.clientX?new e.utils.Coordinate(t.clientX,t.clientY):null,this.menu_.render(e.DropDownDiv.getContentDiv()),t=this.menu_.getElement(),e.utils.dom.addClass(t,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV){t=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().getColour():this.sourceBlock_.getColour();var n=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;e.DropDownDiv.setColour(t,n)}e.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()},e.FieldDropdown.prototype.dropdownCreate_=function(){var t=new e.Menu;t.setRole(e.utils.aria.Role.LISTBOX),this.menu_=t;var n=this.getOptions(!1);this.selectedMenuItem_=null;for(var o=0;o<n.length;o++){var r=n[o][0],a=n[o][1];if("object"==typeof r){var h=new Image(r.width,r.height);h.src=r.src,h.alt=r.alt||"",r=h}(r=new e.MenuItem(r,a)).setRole(e.utils.aria.Role.OPTION),r.setRightToLeft(this.sourceBlock_.RTL),r.setCheckable(!0),t.addChild(r),r.setChecked(a==this.value_),a==this.value_&&(this.selectedMenuItem_=r),r.onAction(this.handleMenuActionEvent_,this)}},e.FieldDropdown.prototype.dropdownDispose_=function(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()},e.FieldDropdown.prototype.handleMenuActionEvent_=function(t){e.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,t)},e.FieldDropdown.prototype.onItemSelected_=function(t,n){this.setValue(n.getValue())},e.FieldDropdown.prototype.trimOptions_=function(){var t=this.menuGenerator_;if(Array.isArray(t)){for(var n=!1,o=0;o<t.length;o++){var r=t[o][0];"string"==typeof r?t[o][0]=e.utils.replaceMessageReferences(r):(null!=r.alt&&(t[o][0].alt=e.utils.replaceMessageReferences(r.alt)),n=!0)}if(!(n||2>t.length)){for(n=[],o=0;o<t.length;o++)n.push(t[o][0]);o=e.utils.string.shortestStringLength(n),r=e.utils.string.commonWordPrefix(n,o);var a=e.utils.string.commonWordSuffix(n,o);!r&&!a||o<=r+a||(r&&(this.prefixField=n[0].substring(0,r-1)),a&&(this.suffixField=n[0].substr(1-a)),this.menuGenerator_=e.FieldDropdown.applyTrim_(t,r,a))}}},e.FieldDropdown.applyTrim_=function(t,n,o){for(var r=[],a=0;a<t.length;a++){var h=t[a][0],R=t[a][1];h=h.substring(n,h.length-o),r[a]=[h,R]}return r},e.FieldDropdown.prototype.isOptionListDynamic=function(){return"function"==typeof this.menuGenerator_},e.FieldDropdown.prototype.getOptions=function(t){return this.isOptionListDynamic()?(this.generatedOptions_&&t||(this.generatedOptions_=this.menuGenerator_.call(this),e.FieldDropdown.validateOptions_(this.generatedOptions_)),this.generatedOptions_):this.menuGenerator_},e.FieldDropdown.prototype.doClassValidation_=function(t){for(var a,n=!1,o=this.getOptions(!0),r=0;a=o[r];r++)if(a[1]==t){n=!0;break}return n?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)},e.FieldDropdown.prototype.doValueUpdate_=function(t){e.FieldDropdown.superClass_.doValueUpdate_.call(this,t),t=this.getOptions(!0);for(var o,n=0;o=t[n];n++)o[1]==this.value_&&(this.selectedOption_=o)},e.FieldDropdown.prototype.applyColour=function(){this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary),this.borderRect_.setAttribute("fill",this.menu_?this.sourceBlock_.style.colourTertiary:"transparent")),this.sourceBlock_&&this.arrow_&&(this.arrow_.style.fill=this.sourceBlock_.isShadow()?this.sourceBlock_.style.colourSecondary:this.sourceBlock_.style.colourPrimary)},e.FieldDropdown.prototype.render_=function(){this.textContent_.nodeValue="",this.imageElement_.style.display="none";var t=this.selectedOption_&&this.selectedOption_[0];t&&"object"==typeof t?this.renderSelectedImage_(t):this.renderSelectedText_(),this.positionBorderRect_()},e.FieldDropdown.prototype.renderSelectedImage_=function(t){this.imageElement_.style.display="",this.imageElement_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",t.src),this.imageElement_.setAttribute("height",t.height),this.imageElement_.setAttribute("width",t.width);var n=Number(t.height);t=Number(t.width);var o=!!this.borderRect_,r=Math.max(o?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,n+e.FieldDropdown.IMAGE_Y_PADDING);o=o?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var a=this.svgArrow_?this.positionSVGArrow_(t+o,r/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):e.utils.dom.getFastTextWidth(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);this.size_.width=t+a+2*o,this.size_.height=r;var h=0;this.sourceBlock_.RTL?this.imageElement_.setAttribute("x",o+a):(h=t+a,this.textElement_.setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",o)),this.imageElement_.setAttribute("y",r/2-n/2),this.positionTextElement_(h+o,t+a)},e.FieldDropdown.prototype.renderSelectedText_=function(){this.textContent_.nodeValue=this.getDisplayText_(),e.utils.dom.addClass(this.textElement_,"blocklyDropdownText"),this.textElement_.setAttribute("text-anchor","start");var t=!!this.borderRect_,n=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT),o=e.utils.dom.getFastTextWidth(this.textElement_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var r=0;this.svgArrow_&&(r=this.positionSVGArrow_(o+t,n/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=o+r+2*t,this.size_.height=n,this.positionTextElement_(t,o)},e.FieldDropdown.prototype.positionSVGArrow_=function(t,n){if(!this.svgArrow_)return 0;var o=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,r=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,a=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(this.sourceBlock_.RTL?o:t+r)+","+n+")"),a+r},e.FieldDropdown.prototype.getText_=function(){if(!this.selectedOption_)return null;var t=this.selectedOption_[0];return"object"==typeof t?t.alt:t},e.FieldDropdown.validateOptions_=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");for(var n=!1,o=0;o<t.length;++o){var r=t[o];Array.isArray(r)?"string"!=typeof r[1]?(n=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option id must be a string. Found "+r[1]+" in: ",r)):r[0]&&"string"!=typeof r[0]&&"string"!=typeof r[0].src&&(n=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option must have a string label or image description. Found"+r[0]+" in: ",r)):(n=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option must be an array. Found: ",r))}if(n)throw TypeError("Found invalid FieldDropdown options.")},e.fieldRegistry.register("field_dropdown",e.FieldDropdown),e.FieldLabelSerializable=function(t,n,o){e.FieldLabelSerializable.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.FieldLabelSerializable,e.FieldLabel),e.FieldLabelSerializable.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldLabelSerializable(n,void 0,t)},e.FieldLabelSerializable.prototype.EDITABLE=!1,e.FieldLabelSerializable.prototype.SERIALIZABLE=!0,e.fieldRegistry.register("field_label_serializable",e.FieldLabelSerializable),e.FieldImage=function(t,n,o,r,a,h,R){if(!t)throw Error("Src value of an image field is required");if(t=e.utils.replaceMessageReferences(t),o=Number(e.utils.replaceMessageReferences(o)),n=Number(e.utils.replaceMessageReferences(n)),isNaN(o)||isNaN(n))throw Error("Height and width values of an image field must cast to numbers.");if(0>=o||0>=n)throw Error("Height and width values of an image field must be greater than 0.");this.flipRtl_=!1,this.altText_="",e.FieldImage.superClass_.constructor.call(this,t,null,R),R||(this.flipRtl_=!!h,this.altText_=e.utils.replaceMessageReferences(r)||""),this.size_=new e.utils.Size(n,o+e.FieldImage.Y_PADDING),this.imageHeight_=o,this.clickHandler_=null,"function"==typeof a&&(this.clickHandler_=a),this.imageElement_=null},e.utils.object.inherits(e.FieldImage,e.Field),e.FieldImage.prototype.DEFAULT_VALUE="",e.FieldImage.fromJson=function(t){return new e.FieldImage(t.src,t.width,t.height,void 0,void 0,void 0,t)},e.FieldImage.Y_PADDING=1,e.FieldImage.prototype.EDITABLE=!1,e.FieldImage.prototype.isDirty_=!1,e.FieldImage.prototype.configure_=function(t){e.FieldImage.superClass_.configure_.call(this,t),this.flipRtl_=!!t.flipRtl,this.altText_=e.utils.replaceMessageReferences(t.alt)||""},e.FieldImage.prototype.initView=function(){this.imageElement_=e.utils.dom.createSvgElement(e.utils.Svg.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")},e.FieldImage.prototype.updateSize_=function(){},e.FieldImage.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:t},e.FieldImage.prototype.doValueUpdate_=function(t){this.value_=t,this.imageElement_&&this.imageElement_.setAttributeNS(e.utils.dom.XLINK_NS,"xlink:href",String(this.value_))},e.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},e.FieldImage.prototype.setAlt=function(t){t!=this.altText_&&(this.altText_=t||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))},e.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},e.FieldImage.prototype.setOnClickHandler=function(t){this.clickHandler_=t},e.FieldImage.prototype.getText_=function(){return this.altText_},e.fieldRegistry.register("field_image",e.FieldImage),e.FieldMultilineInput=function(t,n,o){e.FieldMultilineInput.superClass_.constructor.call(this,t,n,o),this.textGroup_=null,this.maxLines_=1/0,this.isOverflowedY_=!1},e.utils.object.inherits(e.FieldMultilineInput,e.FieldTextInput),e.FieldMultilineInput.prototype.configure_=function(t){e.FieldMultilineInput.superClass_.configure_.call(this,t),t.maxLines&&this.setMaxLines(t.maxLines)},e.FieldMultilineInput.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.text);return new e.FieldMultilineInput(n,void 0,t)},e.FieldMultilineInput.prototype.toXml=function(t){return t.textContent=this.getValue().replace(/\n/g,"&#10;"),t},e.FieldMultilineInput.prototype.fromXml=function(t){this.setValue(t.textContent.replace(/&#10;/g,"\n"))},e.FieldMultilineInput.prototype.initView=function(){this.createBorderRect_(),this.textGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:"blocklyEditableText"},this.fieldGroup_)},e.FieldMultilineInput.prototype.getDisplayText_=function(){var t=this.getText();if(!t)return e.Field.NBSP;var n=t.split("\n");t="";for(var o=this.isOverflowedY_?this.maxLines_:n.length,r=0;r<o;r++){var a=n[r];a.length>this.maxDisplayLength?a=a.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&r===o-1&&(a=a.substring(0,a.length-3)+"..."),t+=a=a.replace(/\s/g,e.Field.NBSP),r!==o-1&&(t+="\n")}return this.sourceBlock_.RTL&&(t+="\u200f"),t},e.FieldMultilineInput.prototype.doValueUpdate_=function(t){e.FieldMultilineInput.superClass_.doValueUpdate_.call(this,t),this.isOverflowedY_=this.value_.split("\n").length>this.maxLines_},e.FieldMultilineInput.prototype.render_=function(){for(var t;t=this.textGroup_.firstChild;)this.textGroup_.removeChild(t);t=this.getDisplayText_().split("\n");for(var n=0,o=0;o<t.length;o++){var r=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:n+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(t[o])),n+=r}this.isBeingEdited_&&(t=this.htmlInput_,this.isOverflowedY_?e.utils.dom.addClass(t,"blocklyHtmlTextAreaInputOverflowedY"):e.utils.dom.removeClass(t,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(this.sourceBlock_.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),t=this.htmlInput_,this.isTextValid_?(e.utils.dom.removeClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!1)):(e.utils.dom.addClass(t,"blocklyInvalidInput"),e.utils.aria.setState(t,e.utils.aria.State.INVALID,!0)))},e.FieldMultilineInput.prototype.updateSize_=function(){for(var t=this.textGroup_.childNodes,n=0,o=0,r=0;r<t.length;r++){var a=e.utils.dom.getTextWidth(t[r]);a>n&&(n=a),o+=this.getConstants().FIELD_TEXT_HEIGHT+(0<r?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){t=this.value_.split("\n"),a=e.utils.dom.createSvgElement(e.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText"});var h=this.getConstants().FIELD_TEXT_FONTSIZE,R=this.getConstants().FIELD_TEXT_FONTWEIGHT,L=this.getConstants().FIELD_TEXT_FONTFAMILY;for(r=0;r<t.length;r++){t[r].length>this.maxDisplayLength&&(t[r]=t[r].substring(0,this.maxDisplayLength)),a.textContent=t[r];var W=e.utils.dom.getFastTextWidth(a,h,R,L);W>n&&(n=W)}n+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(o+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,n+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",n),this.borderRect_.setAttribute("height",o)),this.size_.width=n,this.size_.height=o,this.positionBorderRect_()},e.FieldMultilineInput.prototype.showEditor_=function(t,n){e.FieldMultilineInput.superClass_.showEditor_.call(this,t,n),this.forceRerender()},e.FieldMultilineInput.prototype.widgetCreate_=function(){var t=e.WidgetDiv.DIV,n=this.workspace_.getScale(),o=document.createElement("textarea");o.className="blocklyHtmlInput blocklyHtmlTextAreaInput",o.setAttribute("spellcheck",this.spellcheck_);var r=this.getConstants().FIELD_TEXT_FONTSIZE*n+"pt";t.style.fontSize=r,o.style.fontSize=r,o.style.borderRadius=e.FieldTextInput.BORDERRADIUS*n+"px",r=this.getConstants().FIELD_BORDER_RECT_X_PADDING*n;var a=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*n/2;return o.style.padding=a+"px "+r+"px "+a+"px "+r+"px",r=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,o.style.lineHeight=r*n+"px",t.appendChild(o),o.value=o.defaultValue=this.getEditorText_(this.value_),o.untypedDefaultValue_=this.value_,o.oldValue_=null,e.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(o),o},e.FieldMultilineInput.prototype.setMaxLines=function(t){"number"==typeof t&&0<t&&t!==this.maxLines_&&(this.maxLines_=t,this.forceRerender())},e.FieldMultilineInput.prototype.getMaxLines=function(){return this.maxLines_},e.FieldMultilineInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode!==e.utils.KeyCodes.ENTER&&e.FieldMultilineInput.superClass_.onHtmlInputKeyDown_.call(this,t)},e.Css.register(".blocklyHtmlTextAreaInput {,font-family: monospace;,resize: none;,overflow: hidden;,height: 100%;,text-align: left;,},.blocklyHtmlTextAreaInputOverflowedY {,overflow-y: scroll;,}".split(",")),e.fieldRegistry.register("field_multilinetext",e.FieldMultilineInput),e.FieldNumber=function(t,n,o,r,a,h){this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,e.FieldNumber.superClass_.constructor.call(this,t,a,h),h||this.setConstraints(n,o,r)},e.utils.object.inherits(e.FieldNumber,e.FieldTextInput),e.FieldNumber.prototype.DEFAULT_VALUE=0,e.FieldNumber.fromJson=function(t){return new e.FieldNumber(t.value,void 0,void 0,void 0,void 0,t)},e.FieldNumber.prototype.SERIALIZABLE=!0,e.FieldNumber.prototype.configure_=function(t){e.FieldNumber.superClass_.configure_.call(this,t),this.setMinInternal_(t.min),this.setMaxInternal_(t.max),this.setPrecisionInternal_(t.precision)},e.FieldNumber.prototype.setConstraints=function(t,n,o){this.setMinInternal_(t),this.setMaxInternal_(n),this.setPrecisionInternal_(o),this.setValue(this.getValue())},e.FieldNumber.prototype.setMin=function(t){this.setMinInternal_(t),this.setValue(this.getValue())},e.FieldNumber.prototype.setMinInternal_=function(t){null==t?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))},e.FieldNumber.prototype.getMin=function(){return this.min_},e.FieldNumber.prototype.setMax=function(t){this.setMaxInternal_(t),this.setValue(this.getValue())},e.FieldNumber.prototype.setMaxInternal_=function(t){null==t?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))},e.FieldNumber.prototype.getMax=function(){return this.max_},e.FieldNumber.prototype.setPrecision=function(t){this.setPrecisionInternal_(t),this.setValue(this.getValue())},e.FieldNumber.prototype.setPrecisionInternal_=function(t){this.precision_=Number(t)||0;var n=String(this.precision_);-1!=n.indexOf("e")&&(n=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));var o=n.indexOf(".");this.decimalPlaces_=-1==o?t?0:null:n.length-o-1},e.FieldNumber.prototype.getPrecision=function(){return this.precision_},e.FieldNumber.prototype.doClassValidation_=function(t){return null===t||(t=(t=(t=(t=String(t)).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),t=Number(t||0),isNaN(t))?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),null!=this.decimalPlaces_&&(t=Number(t.toFixed(this.decimalPlaces_))),t)},e.FieldNumber.prototype.widgetCreate_=function(){var t=e.FieldNumber.superClass_.widgetCreate_.call(this);return-1/0<this.min_&&e.utils.aria.setState(t,e.utils.aria.State.VALUEMIN,this.min_),1/0>this.max_&&e.utils.aria.setState(t,e.utils.aria.State.VALUEMAX,this.max_),t},e.fieldRegistry.register("field_number",e.FieldNumber),e.FieldVariable=function(t,n,o,r,a){this.menuGenerator_=e.FieldVariable.dropdownCreate,this.defaultVariableName="string"==typeof t?t:"",this.size_=new e.utils.Size(0,0),a&&this.configure_(a),n&&this.setValidator(n),a||this.setTypes_(o,r)},e.utils.object.inherits(e.FieldVariable,e.FieldDropdown),e.FieldVariable.fromJson=function(t){var n=e.utils.replaceMessageReferences(t.variable);return new e.FieldVariable(n,void 0,void 0,void 0,t)},e.FieldVariable.prototype.SERIALIZABLE=!0,e.FieldVariable.prototype.configure_=function(t){e.FieldVariable.superClass_.configure_.call(this,t),this.setTypes_(t.variableTypes,t.defaultType)},e.FieldVariable.prototype.initModel=function(){if(!this.variable_){var t=e.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,null,this.defaultVariableName,this.defaultType_);this.doValueUpdate_(t.getId())}},e.FieldVariable.prototype.shouldAddBorderRect_=function(){return e.FieldVariable.superClass_.shouldAddBorderRect_.call(this)&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!=this.sourceBlock_.type)},e.FieldVariable.prototype.fromXml=function(t){var n=t.getAttribute("id"),o=t.textContent,r=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(n=e.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,n,o,r),null!=r&&r!==n.type)throw Error("Serialized variable type with id '"+n.getId()+"' had type "+n.type+", and does not match variable field that references it: "+e.Xml.domToText(t)+".");this.setValue(n.getId())},e.FieldVariable.prototype.toXml=function(t){return this.initModel(),t.id=this.variable_.getId(),t.textContent=this.variable_.name,this.variable_.type&&t.setAttribute("variabletype",this.variable_.type),t},e.FieldVariable.prototype.setSourceBlock=function(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");e.FieldVariable.superClass_.setSourceBlock.call(this,t)},e.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null},e.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""},e.FieldVariable.prototype.getVariable=function(){return this.variable_},e.FieldVariable.prototype.getValidator=function(){return this.variable_?this.validator_:null},e.FieldVariable.prototype.doClassValidation_=function(t){if(null===t)return null;var n=e.Variables.getVariable(this.sourceBlock_.workspace,t);return n?this.typeIsAllowed_(n=n.type)?t:(console.warn("Variable type doesn't match this field!  Type was "+n),null):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)},e.FieldVariable.prototype.doValueUpdate_=function(t){this.variable_=e.Variables.getVariable(this.sourceBlock_.workspace,t),e.FieldVariable.superClass_.doValueUpdate_.call(this,t)},e.FieldVariable.prototype.typeIsAllowed_=function(t){var n=this.getVariableTypes_();if(!n)return!0;for(var o=0;o<n.length;o++)if(t==n[o])return!0;return!1},e.FieldVariable.prototype.getVariableTypes_=function(){var t=this.variableTypes;if(null===t&&this.sourceBlock_&&this.sourceBlock_.workspace)return this.sourceBlock_.workspace.getVariableTypes();if(0==(t=t||[""]).length)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t},e.FieldVariable.prototype.setTypes_=function(t,n){if(n=n||"",null==t||null==t)t=null;else{if(!Array.isArray(t))throw Error("'variableTypes' was not an array in the definition of a FieldVariable");for(var o=!1,r=0;r<t.length;r++)t[r]==n&&(o=!0);if(!o)throw Error("Invalid default type '"+n+"' in the definition of a FieldVariable")}this.defaultType_=n,this.variableTypes=t},e.FieldVariable.prototype.refreshVariableName=function(){this.forceRerender()},e.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var t=this.getText(),n=[];if(this.sourceBlock_&&this.sourceBlock_.workspace)for(var o=this.getVariableTypes_(),r=0;r<o.length;r++){var a=this.sourceBlock_.workspace.getVariablesOfType(o[r]);n=n.concat(a)}for(n.sort(e.VariableModel.compareByName),o=[],r=0;r<n.length;r++)o[r]=[n[r].name,n[r].getId()];return o.push([e.Msg.RENAME_VARIABLE,e.RENAME_VARIABLE_ID]),e.Msg.DELETE_VARIABLE&&o.push([e.Msg.DELETE_VARIABLE.replace("%1",t),e.DELETE_VARIABLE_ID]),o},e.FieldVariable.prototype.onItemSelected_=function(t,n){if(t=n.getValue(),this.sourceBlock_&&this.sourceBlock_.workspace){if(t==e.RENAME_VARIABLE_ID)return void e.Variables.renameVariable(this.sourceBlock_.workspace,this.variable_);if(t==e.DELETE_VARIABLE_ID)return void this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId())}this.setValue(t)},e.FieldVariable.prototype.referencesVariables=function(){return!0},e.fieldRegistry.register("field_variable",e.FieldVariable),e.utils.svgPaths={},e.utils.svgPaths.point=function(t,n){return" "+t+","+n+" "},e.utils.svgPaths.curve=function(t,n){return" "+t+n.join("")},e.utils.svgPaths.moveTo=function(t,n){return" M "+t+","+n+" "},e.utils.svgPaths.moveBy=function(t,n){return" m "+t+","+n+" "},e.utils.svgPaths.lineTo=function(t,n){return" l "+t+","+n+" "},e.utils.svgPaths.line=function(t){return" l"+t.join("")},e.utils.svgPaths.lineOnAxis=function(t,n){return" "+t+" "+n+" "},e.utils.svgPaths.arc=function(t,n,o,r){return t+" "+o+" "+o+" "+n+r},e.blockRendering.ConstantProvider=function(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.CORNER_RADIUS=8,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=e.utils.svgPaths.moveBy(0,0),this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_TEXT_BASELINE_CENTER=!e.utils.userAgent.IE&&!e.utils.userAgent.EDGE,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2),this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2}},e.blockRendering.ConstantProvider.prototype.init=function(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()},e.blockRendering.ConstantProvider.prototype.setTheme=function(t){this.blockStyles=Object.create(null);var o,n=t.blockStyles;for(o in n)this.blockStyles[o]=this.validatedBlockStyle_(n[o]);this.setDynamicProperties_(t)},e.blockRendering.ConstantProvider.prototype.setDynamicProperties_=function(t){this.setFontConstants_(t),this.setComponentConstants_(t),this.ADD_START_HATS=null!=t.startHats?t.startHats:this.ADD_START_HATS},e.blockRendering.ConstantProvider.prototype.setFontConstants_=function(t){this.FIELD_TEXT_FONTFAMILY=t.fontStyle&&null!=t.fontStyle.family?t.fontStyle.family:this.FIELD_TEXT_FONTFAMILY,this.FIELD_TEXT_FONTWEIGHT=t.fontStyle&&null!=t.fontStyle.weight?t.fontStyle.weight:this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTSIZE=t.fontStyle&&null!=t.fontStyle.size?t.fontStyle.size:this.FIELD_TEXT_FONTSIZE,t=e.utils.dom.measureFontMetrics("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=t.height,this.FIELD_TEXT_BASELINE=t.baseline},e.blockRendering.ConstantProvider.prototype.setComponentConstants_=function(t){this.CURSOR_COLOUR=t.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=t.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=t.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(t.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY},e.blockRendering.ConstantProvider.prototype.getBlockStyleForColour=function(t){var n="auto_"+t;return this.blockStyles[n]||(this.blockStyles[n]=this.createBlockStyle_(t)),{style:this.blockStyles[n],name:n}},e.blockRendering.ConstantProvider.prototype.getBlockStyle=function(t){return this.blockStyles[t||""]||(t&&0==t.indexOf("auto_")?this.getBlockStyleForColour(t.substring(5)).style:this.createBlockStyle_("#000000"))},e.blockRendering.ConstantProvider.prototype.createBlockStyle_=function(t){return this.validatedBlockStyle_({colourPrimary:t})},e.blockRendering.ConstantProvider.prototype.validatedBlockStyle_=function(t){var n={};return t&&e.utils.object.mixin(n,t),t=e.utils.parseBlockColour(n.colourPrimary||"#000"),n.colourPrimary=t.hex,n.colourSecondary=n.colourSecondary?e.utils.parseBlockColour(n.colourSecondary).hex:this.generateSecondaryColour_(n.colourPrimary),n.colourTertiary=n.colourTertiary?e.utils.parseBlockColour(n.colourTertiary).hex:this.generateTertiaryColour_(n.colourPrimary),n.hat=n.hat||"",n},e.blockRendering.ConstantProvider.prototype.generateSecondaryColour_=function(t){return e.utils.colour.blend("#fff",t,.6)||t},e.blockRendering.ConstantProvider.prototype.generateTertiaryColour_=function(t){return e.utils.colour.blend("#fff",t,.3)||t},e.blockRendering.ConstantProvider.prototype.dispose=function(){this.embossFilter_&&e.utils.dom.removeNode(this.embossFilter_),this.disabledPattern_&&e.utils.dom.removeNode(this.disabledPattern_),this.debugFilter_&&e.utils.dom.removeNode(this.debugFilter_),this.cssNode_=null},e.blockRendering.ConstantProvider.prototype.makeJaggedTeeth=function(){var t=this.JAGGED_TEETH_HEIGHT,n=this.JAGGED_TEETH_WIDTH;return{height:t,width:n,path:e.utils.svgPaths.line([e.utils.svgPaths.point(n,t/4),e.utils.svgPaths.point(2*-n,t/2),e.utils.svgPaths.point(n,t/4)])}},e.blockRendering.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,n=this.START_HAT_WIDTH;return{height:t,width:n,path:e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(30,-t),e.utils.svgPaths.point(70,-t),e.utils.svgPaths.point(n,0)])}},e.blockRendering.ConstantProvider.prototype.makePuzzleTab=function(){function t(h){var R=-(h=h?-1:1),L=o/2,W=L+2.5,nt=L+.5,et=e.utils.svgPaths.point(-n,h*L);return L=e.utils.svgPaths.point(n,h*L),e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(0,h*W),e.utils.svgPaths.point(-n,R*nt),et])+e.utils.svgPaths.curve("s",[e.utils.svgPaths.point(n,2.5*R),L])}var n=this.TAB_WIDTH,o=this.TAB_HEIGHT,r=t(!0),a=t(!1);return{type:this.SHAPES.PUZZLE,width:n,height:o,pathDown:a,pathUp:r}},e.blockRendering.ConstantProvider.prototype.makeNotch=function(){function t(R){return e.utils.svgPaths.line([e.utils.svgPaths.point(R*r,o),e.utils.svgPaths.point(3*R,0),e.utils.svgPaths.point(R*r,-o)])}var n=this.NOTCH_WIDTH,o=this.NOTCH_HEIGHT,r=(n-3)/2,a=t(1),h=t(-1);return{type:this.SHAPES.NOTCH,width:n,height:o,pathLeft:a,pathRight:h}},e.blockRendering.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS;return{width:t,height:t,pathTop:e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(-t,t)),pathBottom:e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(t,t))}},e.blockRendering.ConstantProvider.prototype.makeOutsideCorners=function(){var t=this.CORNER_RADIUS,n=e.utils.svgPaths.moveBy(0,t)+e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(t,-t)),o=e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(t,t)),r=e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(-t,-t));return{topLeft:n,topRight:o,bottomRight:e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(-t,t)),bottomLeft:r,rightHeight:t}},e.blockRendering.ConstantProvider.prototype.shapeFor=function(t){switch(t.type){case e.connectionTypes.INPUT_VALUE:case e.connectionTypes.OUTPUT_VALUE:return this.PUZZLE_TAB;case e.connectionTypes.PREVIOUS_STATEMENT:case e.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}},e.blockRendering.ConstantProvider.prototype.createDom=function(t,n,o){this.injectCSS_(n,o),t=e.utils.dom.createSvgElement(e.utils.Svg.DEFS,{},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},t),e.utils.dom.createSvgElement(e.utils.Svg.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},n),o=e.utils.dom.createSvgElement(e.utils.Svg.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},o),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},n),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},n),this.embossFilterId=n.id,this.embossFilter_=n,n=e.utils.dom.createSvgElement(e.utils.Svg.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},t),e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:10,height:10,fill:"#aaa"},n),e.utils.dom.createSvgElement(e.utils.Svg.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},n),this.disabledPatternId=n.id,this.disabledPattern_=n,e.blockRendering.Debug&&(t=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},t),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.debugFilterId=t.id,this.debugFilter_=t)},e.blockRendering.ConstantProvider.prototype.injectCSS_=function(t,n){n=this.getCSS_(n),t="blockly-renderer-style-"+t,this.cssNode_=document.getElementById(t);var o=n.join("\n");this.cssNode_?this.cssNode_.firstChild.textContent=o:((n=document.createElement("style")).id=t,t=document.createTextNode(o),n.appendChild(t),document.head.insertBefore(n,document.head.firstChild),this.cssNode_=n)},e.blockRendering.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText, ",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect,",t+" .blocklyEditableText>rect {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","fill-opacity: .6;","stroke: none;","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text {","fill: #000;","}",t+" .blocklyFlyoutLabelText {","fill: #000;","}",t+" .blocklyText.blocklyBubbleText {","fill: #000;","}",t+" .blocklyEditableText:not(.editing):hover>rect {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","}",t+" .blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",t+" .blocklyHighlightedConnectionPath {","stroke: #fc3;","}",t+" .blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",t+" .blocklyReplaceable .blocklyPathLight,",t+" .blocklyReplaceable .blocklyPathDark {","display: none;","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},e.blockRendering.Types={NONE:0,FIELD:1,HAT:2,ICON:4,SPACER:8,BETWEEN_ROW_SPACER:16,IN_ROW_SPACER:32,EXTERNAL_VALUE_INPUT:64,INPUT:128,INLINE_INPUT:256,STATEMENT_INPUT:512,CONNECTION:1024,PREVIOUS_CONNECTION:2048,NEXT_CONNECTION:4096,OUTPUT_CONNECTION:8192,CORNER:16384,LEFT_SQUARE_CORNER:32768,LEFT_ROUND_CORNER:65536,RIGHT_SQUARE_CORNER:131072,RIGHT_ROUND_CORNER:262144,JAGGED_EDGE:524288,ROW:1048576,TOP_ROW:2097152,BOTTOM_ROW:4194304,INPUT_ROW:8388608},e.blockRendering.Types.LEFT_CORNER=e.blockRendering.Types.LEFT_SQUARE_CORNER|e.blockRendering.Types.LEFT_ROUND_CORNER,e.blockRendering.Types.RIGHT_CORNER=e.blockRendering.Types.RIGHT_SQUARE_CORNER|e.blockRendering.Types.RIGHT_ROUND_CORNER,e.blockRendering.Types.nextTypeValue_=16777216,e.blockRendering.Types.getType=function(t){return Object.prototype.hasOwnProperty.call(e.blockRendering.Types,t)||(e.blockRendering.Types[t]=e.blockRendering.Types.nextTypeValue_,e.blockRendering.Types.nextTypeValue_<<=1),e.blockRendering.Types[t]},e.blockRendering.Types.isField=function(t){return t.type&e.blockRendering.Types.FIELD},e.blockRendering.Types.isHat=function(t){return t.type&e.blockRendering.Types.HAT},e.blockRendering.Types.isIcon=function(t){return t.type&e.blockRendering.Types.ICON},e.blockRendering.Types.isSpacer=function(t){return t.type&e.blockRendering.Types.SPACER},e.blockRendering.Types.isInRowSpacer=function(t){return t.type&e.blockRendering.Types.IN_ROW_SPACER},e.blockRendering.Types.isInput=function(t){return t.type&e.blockRendering.Types.INPUT},e.blockRendering.Types.isExternalInput=function(t){return t.type&e.blockRendering.Types.EXTERNAL_VALUE_INPUT},e.blockRendering.Types.isInlineInput=function(t){return t.type&e.blockRendering.Types.INLINE_INPUT},e.blockRendering.Types.isStatementInput=function(t){return t.type&e.blockRendering.Types.STATEMENT_INPUT},e.blockRendering.Types.isPreviousConnection=function(t){return t.type&e.blockRendering.Types.PREVIOUS_CONNECTION},e.blockRendering.Types.isNextConnection=function(t){return t.type&e.blockRendering.Types.NEXT_CONNECTION},e.blockRendering.Types.isPreviousOrNextConnection=function(t){return t.type&(e.blockRendering.Types.PREVIOUS_CONNECTION|e.blockRendering.Types.NEXT_CONNECTION)},e.blockRendering.Types.isLeftRoundedCorner=function(t){return t.type&e.blockRendering.Types.LEFT_ROUND_CORNER},e.blockRendering.Types.isRightRoundedCorner=function(t){return t.type&e.blockRendering.Types.RIGHT_ROUND_CORNER},e.blockRendering.Types.isLeftSquareCorner=function(t){return t.type&e.blockRendering.Types.LEFT_SQUARE_CORNER},e.blockRendering.Types.isRightSquareCorner=function(t){return t.type&e.blockRendering.Types.RIGHT_SQUARE_CORNER},e.blockRendering.Types.isCorner=function(t){return t.type&e.blockRendering.Types.CORNER},e.blockRendering.Types.isJaggedEdge=function(t){return t.type&e.blockRendering.Types.JAGGED_EDGE},e.blockRendering.Types.isRow=function(t){return t.type&e.blockRendering.Types.ROW},e.blockRendering.Types.isBetweenRowSpacer=function(t){return t.type&e.blockRendering.Types.BETWEEN_ROW_SPACER},e.blockRendering.Types.isTopRow=function(t){return t.type&e.blockRendering.Types.TOP_ROW},e.blockRendering.Types.isBottomRow=function(t){return t.type&e.blockRendering.Types.BOTTOM_ROW},e.blockRendering.Types.isTopOrBottomRow=function(t){return t.type&(e.blockRendering.Types.TOP_ROW|e.blockRendering.Types.BOTTOM_ROW)},e.blockRendering.Types.isInputRow=function(t){return t.type&e.blockRendering.Types.INPUT_ROW},e.blockRendering.Measurable=function(t){this.height=this.width=0,this.type=e.blockRendering.Types.NONE,this.centerline=this.xPos=0,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT},e.blockRendering.Connection=function(t,n){e.blockRendering.Connection.superClass_.constructor.call(this,t),this.connectionModel=n,this.shape=this.constants_.shapeFor(n),this.isDynamicShape=!!this.shape.isDynamic,this.type|=e.blockRendering.Types.CONNECTION},e.utils.object.inherits(e.blockRendering.Connection,e.blockRendering.Measurable),e.blockRendering.OutputConnection=function(t,n){e.blockRendering.OutputConnection.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=0},e.utils.object.inherits(e.blockRendering.OutputConnection,e.blockRendering.Connection),e.blockRendering.PreviousConnection=function(t,n){e.blockRendering.PreviousConnection.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},e.utils.object.inherits(e.blockRendering.PreviousConnection,e.blockRendering.Connection),e.blockRendering.NextConnection=function(t,n){e.blockRendering.NextConnection.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},e.utils.object.inherits(e.blockRendering.NextConnection,e.blockRendering.Connection),e.blockRendering.InputConnection=function(t,n){e.blockRendering.InputConnection.superClass_.constructor.call(this,t,n.connection),this.type|=e.blockRendering.Types.INPUT,this.input=n,this.align=n.align,(this.connectedBlock=n.connection&&n.connection.targetBlock()?n.connection.targetBlock():null)?(t=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=t.width,this.connectedBlockHeight=t.height):this.connectedBlockHeight=this.connectedBlockWidth=0,this.connectionOffsetY=this.connectionOffsetX=0},e.utils.object.inherits(e.blockRendering.InputConnection,e.blockRendering.Connection),e.blockRendering.InlineInput=function(t,n){e.blockRendering.InlineInput.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY=this.isDynamicShape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=this.isDynamicShape?this.shape.connectionOffsetX(this.connectionWidth):0},e.utils.object.inherits(e.blockRendering.InlineInput,e.blockRendering.InputConnection),e.blockRendering.StatementInput=function(t,n){e.blockRendering.StatementInput.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width},e.utils.object.inherits(e.blockRendering.StatementInput,e.blockRendering.InputConnection),e.blockRendering.ExternalValueInput=function(t,n){e.blockRendering.ExternalValueInput.superClass_.constructor.call(this,t,n),this.type|=e.blockRendering.Types.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width},e.utils.object.inherits(e.blockRendering.ExternalValueInput,e.blockRendering.InputConnection),e.blockRendering.Icon=function(t,n){e.blockRendering.Icon.superClass_.constructor.call(this,t),this.icon=n,this.isVisible=n.isVisible(),this.type|=e.blockRendering.Types.ICON,t=n.getCorrectedSize(),this.height=t.height,this.width=t.width},e.utils.object.inherits(e.blockRendering.Icon,e.blockRendering.Measurable),e.blockRendering.JaggedEdge=function(t){e.blockRendering.JaggedEdge.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width},e.utils.object.inherits(e.blockRendering.JaggedEdge,e.blockRendering.Measurable),e.blockRendering.Field=function(t,n,o){e.blockRendering.Field.superClass_.constructor.call(this,t),this.field=n,this.isEditable=n.EDITABLE,this.flipRtl=n.getFlipRtl(),this.type|=e.blockRendering.Types.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width,this.parentInput=o},e.utils.object.inherits(e.blockRendering.Field,e.blockRendering.Measurable),e.blockRendering.Hat=function(t){e.blockRendering.Hat.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height},e.utils.object.inherits(e.blockRendering.Hat,e.blockRendering.Measurable),e.blockRendering.SquareCorner=function(t,n){e.blockRendering.SquareCorner.superClass_.constructor.call(this,t),this.type=(n&&"left"!=n?e.blockRendering.Types.RIGHT_SQUARE_CORNER:e.blockRendering.Types.LEFT_SQUARE_CORNER)|e.blockRendering.Types.CORNER,this.width=this.height=this.constants_.NO_PADDING},e.utils.object.inherits(e.blockRendering.SquareCorner,e.blockRendering.Measurable),e.blockRendering.RoundCorner=function(t,n){e.blockRendering.RoundCorner.superClass_.constructor.call(this,t),this.type=(n&&"left"!=n?e.blockRendering.Types.RIGHT_ROUND_CORNER:e.blockRendering.Types.LEFT_ROUND_CORNER)|e.blockRendering.Types.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2},e.utils.object.inherits(e.blockRendering.RoundCorner,e.blockRendering.Measurable),e.blockRendering.InRowSpacer=function(t,n){e.blockRendering.InRowSpacer.superClass_.constructor.call(this,t),this.type=this.type|e.blockRendering.Types.SPACER|e.blockRendering.Types.IN_ROW_SPACER,this.width=n,this.height=this.constants_.SPACER_DEFAULT_HEIGHT},e.utils.object.inherits(e.blockRendering.InRowSpacer,e.blockRendering.Measurable),e.blockRendering.Row=function(t){this.type=e.blockRendering.Types.ROW,this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=this.hasStatement=this.hasExternalInput=!1,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT,this.align=null},e.blockRendering.Row.prototype.measure=function(){throw Error("Unexpected attempt to measure a base Row.")},e.blockRendering.Row.prototype.getLastInput=function(){for(var n,t=this.elements.length-1;n=this.elements[t];t--)if(e.blockRendering.Types.isInput(n))return n;return null},e.blockRendering.Row.prototype.startsWithElemSpacer=function(){return!0},e.blockRendering.Row.prototype.endsWithElemSpacer=function(){return!0},e.blockRendering.Row.prototype.getFirstSpacer=function(){for(var n,t=0;n=this.elements[t];t++)if(e.blockRendering.Types.isSpacer(n))return n;return null},e.blockRendering.Row.prototype.getLastSpacer=function(){for(var n,t=this.elements.length-1;n=this.elements[t];t--)if(e.blockRendering.Types.isSpacer(n))return n;return null},e.blockRendering.TopRow=function(t){e.blockRendering.TopRow.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.TOP_ROW,this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null},e.utils.object.inherits(e.blockRendering.TopRow,e.blockRendering.Row),e.blockRendering.TopRow.prototype.hasLeftSquareCorner=function(t){var n=(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection,o=t.getPreviousBlock();return!!t.outputConnection||n||!!o&&o.getNextBlock()==t},e.blockRendering.TopRow.prototype.hasRightSquareCorner=function(t){return!0},e.blockRendering.TopRow.prototype.measure=function(){for(var a,t=0,n=0,o=0,r=0;a=this.elements[r];r++)n+=a.width,e.blockRendering.Types.isSpacer(a)||(e.blockRendering.Types.isHat(a)?o=Math.max(o,a.ascenderHeight):t=Math.max(t,a.height));this.width=Math.max(this.minWidth,n),this.height=Math.max(this.minHeight,t)+o,this.capline=this.ascenderHeight=o,this.widthWithConnectedBlocks=this.width},e.blockRendering.TopRow.prototype.startsWithElemSpacer=function(){return!1},e.blockRendering.TopRow.prototype.endsWithElemSpacer=function(){return!1},e.blockRendering.BottomRow=function(t){e.blockRendering.BottomRow.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.BOTTOM_ROW,this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0},e.utils.object.inherits(e.blockRendering.BottomRow,e.blockRendering.Row),e.blockRendering.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection||!!t.getNextBlock()},e.blockRendering.BottomRow.prototype.hasRightSquareCorner=function(t){return!0},e.blockRendering.BottomRow.prototype.measure=function(){for(var a,t=0,n=0,o=0,r=0;a=this.elements[r];r++)n+=a.width,e.blockRendering.Types.isSpacer(a)||(e.blockRendering.Types.isNextConnection(a)?o=Math.max(o,a.height):t=Math.max(t,a.height));this.width=Math.max(this.minWidth,n),this.height=Math.max(this.minHeight,t)+o,this.descenderHeight=o,this.widthWithConnectedBlocks=this.width},e.blockRendering.BottomRow.prototype.startsWithElemSpacer=function(){return!1},e.blockRendering.BottomRow.prototype.endsWithElemSpacer=function(){return!1},e.blockRendering.SpacerRow=function(t,n,o){e.blockRendering.SpacerRow.superClass_.constructor.call(this,t),this.type=this.type|e.blockRendering.Types.SPACER|e.blockRendering.Types.BETWEEN_ROW_SPACER,this.width=o,this.height=n,this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.elements=[new e.blockRendering.InRowSpacer(this.constants_,o)]},e.utils.object.inherits(e.blockRendering.SpacerRow,e.blockRendering.Row),e.blockRendering.SpacerRow.prototype.measure=function(){},e.blockRendering.InputRow=function(t){e.blockRendering.InputRow.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.INPUT_ROW,this.connectedBlockWidths=0},e.utils.object.inherits(e.blockRendering.InputRow,e.blockRendering.Row),e.blockRendering.InputRow.prototype.measure=function(){this.width=this.minWidth,this.height=this.minHeight;for(var o,t=0,n=0;o=this.elements[n];n++)this.width+=o.width,e.blockRendering.Types.isInput(o)&&(e.blockRendering.Types.isStatementInput(o)?t+=o.connectedBlockWidth:e.blockRendering.Types.isExternalInput(o)&&0!=o.connectedBlockWidth&&(t+=o.connectedBlockWidth-o.connectionWidth)),e.blockRendering.Types.isSpacer(o)||(this.height=Math.max(this.height,o.height));this.connectedBlockWidths=t,this.widthWithConnectedBlocks=this.width+t},e.blockRendering.InputRow.prototype.endsWithElemSpacer=function(){return!this.hasExternalInput&&!this.hasStatement},e.blockRendering.RenderInfo=function(t,n){this.block_=n,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=n.outputConnection?new e.blockRendering.OutputConnection(this.constants_,n.outputConnection):null,this.isInline=n.getInputsInline()&&!n.isCollapsed(),this.isCollapsed=n.isCollapsed(),this.isInsertionMarker=n.isInsertionMarker(),this.RTL=n.RTL,this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.topRow=new e.blockRendering.TopRow(this.constants_),this.bottomRow=new e.blockRendering.BottomRow(this.constants_),this.startY=this.startX=0},e.blockRendering.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.blockRendering.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},e.blockRendering.RenderInfo.prototype.createRows_=function(){this.populateTopRow_(),this.rows.push(this.topRow);var t=new e.blockRendering.InputRow(this.constants_);this.inputRows.push(t);for(var r,n=this.block_.getIcons(),o=0;r=n[o];o++){var a=new e.blockRendering.Icon(this.constants_,r);this.isCollapsed&&r.collapseHidden?this.hiddenIcons.push(a):t.elements.push(a)}for(r=null,o=0;n=this.block_.inputList[o];o++)if(n.isVisible()){for(this.shouldStartNewRow_(n,r)&&(this.rows.push(t),t=new e.blockRendering.InputRow(this.constants_),this.inputRows.push(t)),r=0;a=n.fieldRow[r];r++)t.elements.push(new e.blockRendering.Field(this.constants_,a,n));this.addInput_(n,t),r=n}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new e.blockRendering.JaggedEdge(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)},e.blockRendering.RenderInfo.prototype.populateTopRow_=function(){var t=!!this.block_.previousConnection,n=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!t,o=this.topRow.hasLeftSquareCorner(this.block_)?e.blockRendering.SquareCorner:e.blockRendering.RoundCorner;this.topRow.elements.push(new o(this.constants_)),n?(t=new e.blockRendering.Hat(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new e.blockRendering.PreviousConnection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.topRow.minHeight=this.block_.inputList.length&&this.block_.inputList[0].type==e.inputTypes.STATEMENT&&!this.block_.isCollapsed()?this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.constants_.TOP_ROW_MIN_HEIGHT,o=this.topRow.hasRightSquareCorner(this.block_)?e.blockRendering.SquareCorner:e.blockRendering.RoundCorner,this.topRow.elements.push(new o(this.constants_,"right"))},e.blockRendering.RenderInfo.prototype.populateBottomRow_=function(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==e.inputTypes.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new e.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new e.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new e.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new e.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new e.blockRendering.RoundCorner(this.constants_,"right"))},e.blockRendering.RenderInfo.prototype.addInput_=function(t,n){this.isInline&&t.type==e.inputTypes.VALUE?(n.elements.push(new e.blockRendering.InlineInput(this.constants_,t)),n.hasInlineInput=!0):t.type==e.inputTypes.STATEMENT?(n.elements.push(new e.blockRendering.StatementInput(this.constants_,t)),n.hasStatement=!0):t.type==e.inputTypes.VALUE?(n.elements.push(new e.blockRendering.ExternalValueInput(this.constants_,t)),n.hasExternalInput=!0):t.type==e.inputTypes.DUMMY&&(n.minHeight=Math.max(n.minHeight,t.getSourceBlock()&&t.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),n.hasDummyInput=!0),null==n.align&&(n.align=t.align)},e.blockRendering.RenderInfo.prototype.shouldStartNewRow_=function(t,n){return!(!n||t.type!=e.inputTypes.STATEMENT&&n.type!=e.inputTypes.STATEMENT&&(t.type!=e.inputTypes.VALUE&&t.type!=e.inputTypes.DUMMY||this.isInline))},e.blockRendering.RenderInfo.prototype.addElemSpacing_=function(){for(var n,t=0;n=this.rows[t];t++){var o=n.elements;if(n.elements=[],n.startsWithElemSpacer()&&n.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,o[0]))),o.length){for(var r=0;r<o.length-1;r++){n.elements.push(o[r]);var a=this.getInRowSpacing_(o[r],o[r+1]);n.elements.push(new e.blockRendering.InRowSpacer(this.constants_,a))}n.elements.push(o[o.length-1]),n.endsWithElemSpacer()&&n.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(o[o.length-1],null)))}}},e.blockRendering.RenderInfo.prototype.getInRowSpacing_=function(t,n){if(!t&&n&&e.blockRendering.Types.isStatementInput(n))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(t&&e.blockRendering.Types.isInput(t)&&!n){if(e.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}return t&&e.blockRendering.Types.isLeftSquareCorner(t)&&n&&(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))?n.notchOffset:t&&e.blockRendering.Types.isLeftRoundedCorner(t)&&n&&(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))?n.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},e.blockRendering.RenderInfo.prototype.computeBounds_=function(){for(var a,t=0,n=0,o=0,r=0;a=this.rows[r];r++){if(a.measure(),n=Math.max(n,a.width),a.hasStatement){var h=a.getLastInput();t=Math.max(t,a.width-h.width)}o=Math.max(o,a.widthWithConnectedBlocks)}for(this.statementEdge=t,this.width=n,r=0;a=this.rows[r];r++)a.hasStatement&&(a.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(n,o),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)},e.blockRendering.RenderInfo.prototype.alignRowElements_=function(){for(var n,t=0;n=this.rows[t];t++)if(n.hasStatement)this.alignStatementRow_(n);else{var o=n.width;0<(o=this.getDesiredRowWidth_(n)-o)&&this.addAlignmentPadding_(n,o),e.blockRendering.Types.isTopOrBottomRow(n)&&(n.widthWithConnectedBlocks=n.width)}},e.blockRendering.RenderInfo.prototype.getDesiredRowWidth_=function(t){return this.width-this.startX},e.blockRendering.RenderInfo.prototype.addAlignmentPadding_=function(t,n){var o=t.getFirstSpacer(),r=t.getLastSpacer();(t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=n),t.align==e.constants.ALIGN.LEFT?r.width+=n:t.align==e.constants.ALIGN.CENTRE?(o.width+=n/2,r.width+=n/2):t.align==e.constants.ALIGN.RIGHT?o.width+=n:r.width+=n,t.width+=n},e.blockRendering.RenderInfo.prototype.alignStatementRow_=function(t){var n=t.getLastInput(),o=t.width-n.width,r=this.statementEdge;0<(o=r-o)&&this.addAlignmentPadding_(t,o),o=t.width,r=this.getDesiredRowWidth_(t),n.width+=r-o,n.height=Math.max(n.height,t.height),t.width+=r-o,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)},e.blockRendering.RenderInfo.prototype.addRowSpacing_=function(){var t=this.rows;this.rows=[];for(var n=0;n<t.length;n++)this.rows.push(t[n]),n!=t.length-1&&this.rows.push(this.makeSpacerRow_(t[n],t[n+1]))},e.blockRendering.RenderInfo.prototype.makeSpacerRow_=function(t,n){var o=this.getSpacerRowHeight_(t,n),r=this.getSpacerRowWidth_(t,n);return o=new e.blockRendering.SpacerRow(this.constants_,o,r),t.hasStatement&&(o.followsStatement=!0),n.hasStatement&&(o.precedesStatement=!0),o},e.blockRendering.RenderInfo.prototype.getSpacerRowWidth_=function(t,n){return this.width-this.startX},e.blockRendering.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){return this.constants_.MEDIUM_PADDING},e.blockRendering.RenderInfo.prototype.getElemCenterline_=function(t,n){return e.blockRendering.Types.isSpacer(n)?t.yPos+n.height/2:e.blockRendering.Types.isBottomRow(t)?(t=t.yPos+t.height-t.descenderHeight,e.blockRendering.Types.isNextConnection(n)?t+n.height/2:t-n.height/2):e.blockRendering.Types.isTopRow(t)?e.blockRendering.Types.isHat(n)?t.capline-n.height/2:t.capline+n.height/2:t.yPos+t.height/2},e.blockRendering.RenderInfo.prototype.recordElemPositions_=function(t){for(var r,n=t.xPos,o=0;r=t.elements[o];o++)e.blockRendering.Types.isSpacer(r)&&(r.height=t.height),r.xPos=n,r.centerline=this.getElemCenterline_(t,r),n+=r.width},e.blockRendering.RenderInfo.prototype.finalize_=function(){for(var r,t=0,n=0,o=0;r=this.rows[o];o++)r.yPos=n,r.xPos=this.startX,n+=r.height,t=Math.max(t,r.widthWithConnectedBlocks),this.recordElemPositions_(r);this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(t=Math.max(t,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.widthWithChildren=t+this.startX,this.height=n,this.startY=this.topRow.capline,this.bottomRow.baseline=n-this.bottomRow.descenderHeight},e.blockRendering.Debug=function(t){this.debugElements_=[],this.svgRoot_=null,this.constants_=t},e.blockRendering.Debug.config={rowSpacers:!0,elemSpacers:!0,rows:!0,elems:!0,connections:!0,blockBounds:!0,connectedBlockBounds:!0,render:!0},e.blockRendering.Debug.prototype.clearElems=function(){for(var n,t=0;n=this.debugElements_[t];t++)e.utils.dom.removeNode(n);this.debugElements_=[]},e.blockRendering.Debug.prototype.drawSpacerRow=function(t,n,o){if(e.blockRendering.Debug.config.rowSpacers){var r=Math.abs(t.height),a=0>t.height;a&&(n-=r),this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"rowSpacerRect blockRenderDebug",x:o?-(t.xPos+t.width):t.xPos,y:n,width:t.width,height:r,stroke:a?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawSpacerElem=function(t,n,o){if(e.blockRendering.Debug.config.elemSpacers){n=Math.abs(t.width);var r=0>t.width,a=r?t.xPos-n:t.xPos;o&&(a=-(a+n)),this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"elemSpacerRect blockRenderDebug",x:a,y:t.centerline-t.height/2,width:n,height:t.height,stroke:"pink",fill:r?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawRenderedElem=function(t,n){if(e.blockRendering.Debug.config.elems){var o=t.xPos;n&&(o=-(o+t.width)),this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:o,y:n=t.centerline-t.height/2,width:t.width,height:t.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_)),e.blockRendering.Types.isField(t)&&t.field instanceof e.FieldLabel&&this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"rowRenderingRect blockRenderDebug",x:o,y:n+this.constants_.FIELD_TEXT_BASELINE,width:t.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_))}e.blockRendering.Types.isInput(t)&&e.blockRendering.Debug.config.connections&&this.drawConnection(t.connectionModel)},e.blockRendering.Debug.prototype.drawConnection=function(t){if(e.blockRendering.Debug.config.connections){if(t.type==e.connectionTypes.INPUT_VALUE)var n=4,o="magenta",r="none";else t.type==e.connectionTypes.OUTPUT_VALUE?(n=2,r=o="magenta"):t.type==e.connectionTypes.NEXT_STATEMENT?(n=4,o="goldenrod",r="none"):t.type==e.connectionTypes.PREVIOUS_STATEMENT&&(n=2,r=o="goldenrod");this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{class:"blockRenderDebug",cx:t.offsetInBlock_.x,cy:t.offsetInBlock_.y,r:n,fill:r,stroke:o},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawRenderedRow=function(t,n,o){e.blockRendering.Debug.config.rows&&(this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"elemRenderingRect blockRenderDebug",x:o?-(t.xPos+t.width):t.xPos,y:t.yPos,width:t.width,height:t.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),e.blockRendering.Types.isTopOrBottomRow(t)||e.blockRendering.Debug.config.connectedBlockBounds&&this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"connectedBlockWidth blockRenderDebug",x:o?-(t.xPos+t.widthWithConnectedBlocks):t.xPos,y:t.yPos,width:t.widthWithConnectedBlocks,height:t.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)))},e.blockRendering.Debug.prototype.drawRowWithElements=function(t,n,o){for(var r=0,a=t.elements.length;r<a;r++){var h=t.elements[r];h?e.blockRendering.Types.isSpacer(h)?this.drawSpacerElem(h,t.height,o):this.drawRenderedElem(h,o):console.warn("A row has an undefined or null element.",t,h)}this.drawRenderedRow(t,n,o)},e.blockRendering.Debug.prototype.drawBoundingBox=function(t){if(e.blockRendering.Debug.config.blockBounds){var n=t.RTL?-t.width:0;this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blockBoundingBox blockRenderDebug",x:n,y:0,width:t.width,height:t.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_)),e.blockRendering.Debug.config.connectedBlockBounds&&this.debugElements_.push(e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blockRenderDebug",x:n=t.RTL?-t.widthWithChildren:0,y:0,width:t.widthWithChildren,height:t.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_))}},e.blockRendering.Debug.prototype.drawDebug=function(t,n){this.clearElems(),this.svgRoot_=t.getSvgRoot(),this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);for(var a,o=0,r=0;a=n.rows[r];r++)e.blockRendering.Types.isBetweenRowSpacer(a)?this.drawSpacerRow(a,o,n.RTL):this.drawRowWithElements(a,o,n.RTL),o+=a.height;t.previousConnection&&this.drawConnection(t.previousConnection),t.nextConnection&&this.drawConnection(t.nextConnection),t.outputConnection&&this.drawConnection(t.outputConnection),n.rightSide&&this.drawRenderedElem(n.rightSide,n.RTL),this.drawBoundingBox(n),this.drawRender(t.pathObject.svgPath)},e.blockRendering.Debug.prototype.drawRender=function(t){e.blockRendering.Debug.config.render&&(t.setAttribute("filter","url(#"+this.constants_.debugFilterId+")"),setTimeout(function(){t.setAttribute("filter","")},100))},e.blockRendering.Drawer=function(t,n){this.block_=t,this.info_=n,this.topLeft_=t.getRelativeToSurfaceXY(),this.inlinePath_=this.outlinePath_="",this.constants_=n.getRenderer().getConstants()},e.blockRendering.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),e.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},e.blockRendering.Drawer.prototype.recordSizeOnBlock_=function(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren},e.blockRendering.Drawer.prototype.hideHiddenIcons_=function(){for(var n,t=0;n=this.info_.hiddenIcons[t];t++)n.icon.iconGroup_.setAttribute("display","none")},e.blockRendering.Drawer.prototype.drawOutline_=function(){this.drawTop_();for(var t=1;t<this.info_.rows.length-1;t++){var n=this.info_.rows[t];n.hasJaggedEdge?this.drawJaggedEdge_(n):n.hasStatement?this.drawStatementInput_(n):n.hasExternalInput?this.drawValueInput_(n):this.drawRightSideRow_(n)}this.drawBottom_(),this.drawLeft_()},e.blockRendering.Drawer.prototype.drawTop_=function(){var t=this.info_.topRow,n=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=e.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var r,o=0;r=n[o];o++)e.blockRendering.Types.isLeftRoundedCorner(r)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:e.blockRendering.Types.isRightRoundedCorner(r)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:e.blockRendering.Types.isPreviousConnection(r)?this.outlinePath_+=r.shape.pathLeft:e.blockRendering.Types.isHat(r)?this.outlinePath_+=this.constants_.START_HAT.path:e.blockRendering.Types.isSpacer(r)&&(this.outlinePath_+=e.utils.svgPaths.lineOnAxis("h",r.width));this.outlinePath_+=e.utils.svgPaths.lineOnAxis("v",t.height)},e.blockRendering.Drawer.prototype.drawJaggedEdge_=function(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+e.utils.svgPaths.lineOnAxis("v",t.height-this.constants_.JAGGED_TEETH.height)},e.blockRendering.Drawer.prototype.drawValueInput_=function(t){var n=t.getLastInput();this.positionExternalValueConnection_(t);var o="function"==typeof n.shape.pathDown?n.shape.pathDown(n.height):n.shape.pathDown;this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",n.xPos+n.width)+o+e.utils.svgPaths.lineOnAxis("v",t.height-n.connectionHeight)},e.blockRendering.Drawer.prototype.drawStatementInput_=function(t){var n=t.getLastInput(),o=n.xPos+n.notchOffset+n.shape.width;n=n.shape.pathRight+e.utils.svgPaths.lineOnAxis("h",-(n.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var r=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",o)+n+e.utils.svgPaths.lineOnAxis("v",r)+this.constants_.INSIDE_CORNERS.pathBottom+e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},e.blockRendering.Drawer.prototype.drawRightSideRow_=function(t){this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},e.blockRendering.Drawer.prototype.drawBottom_=function(){var t=this.info_.bottomRow,n=t.elements;this.positionNextConnection_();for(var h,o=0,r="",a=n.length-1;h=n[a];a--)e.blockRendering.Types.isNextConnection(h)?r+=h.shape.pathRight:e.blockRendering.Types.isLeftSquareCorner(h)?r+=e.utils.svgPaths.lineOnAxis("H",t.xPos):e.blockRendering.Types.isLeftRoundedCorner(h)?r+=this.constants_.OUTSIDE_CORNERS.bottomLeft:e.blockRendering.Types.isRightRoundedCorner(h)?(r+=this.constants_.OUTSIDE_CORNERS.bottomRight,o=this.constants_.OUTSIDE_CORNERS.rightHeight):e.blockRendering.Types.isSpacer(h)&&(r+=e.utils.svgPaths.lineOnAxis("h",-1*h.width));this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.baseline-o),this.outlinePath_+=r},e.blockRendering.Drawer.prototype.drawLeft_=function(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){var n=t.connectionOffsetY+t.height;t="function"==typeof t.shape.pathUp?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",n)+t}this.outlinePath_+="z"},e.blockRendering.Drawer.prototype.drawInternals_=function(){for(var n,t=0;n=this.info_.rows[t];t++)for(var r,o=0;r=n.elements[o];o++)e.blockRendering.Types.isInlineInput(r)?this.drawInlineInput_(r):(e.blockRendering.Types.isIcon(r)||e.blockRendering.Types.isField(r))&&this.layoutField_(r)},e.blockRendering.Drawer.prototype.layoutField_=function(t){if(e.blockRendering.Types.isField(t))var n=t.field.getSvgRoot();else e.blockRendering.Types.isIcon(t)&&(n=t.icon.iconGroup_);var o=t.centerline-t.height/2,r=t.xPos,a="";this.info_.RTL&&(r=-(r+t.width),t.flipRtl&&(r+=t.width,a="scale(-1 1)")),e.blockRendering.Types.isIcon(t)?(n.setAttribute("display","block"),n.setAttribute("transform","translate("+r+","+o+")"),t.icon.computeIconLocation()):n.setAttribute("transform","translate("+r+","+o+")"+a),this.info_.isInsertionMarker&&n.setAttribute("display","none")},e.blockRendering.Drawer.prototype.drawInlineInput_=function(t){var n=t.width,o=t.height,r=t.connectionOffsetY,a=t.connectionHeight+r;this.inlinePath_+=e.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-o/2)+e.utils.svgPaths.lineOnAxis("v",r)+t.shape.pathDown+e.utils.svgPaths.lineOnAxis("v",o-a)+e.utils.svgPaths.lineOnAxis("h",n-t.connectionWidth)+e.utils.svgPaths.lineOnAxis("v",-o)+"z",this.positionInlineInputConnection_(t)},e.blockRendering.Drawer.prototype.positionInlineInputConnection_=function(t){if(t.connectionModel){var o=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(o*=-1),t.connectionModel.setOffsetInBlock(o,t.centerline-t.height/2+t.connectionOffsetY)}},e.blockRendering.Drawer.prototype.positionStatementInputConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.statementEdge+n.notchOffset;this.info_.RTL&&(o*=-1),n.connectionModel.setOffsetInBlock(o,t.yPos)}},e.blockRendering.Drawer.prototype.positionExternalValueConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.width;this.info_.RTL&&(o*=-1),n.connectionModel.setOffsetInBlock(o,t.yPos)}},e.blockRendering.Drawer.prototype.positionPreviousConnection_=function(){var t=this.info_.topRow;if(t.connection){var n=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-n:n,0)}},e.blockRendering.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var n=t.connection,o=n.xPos;n.connectionModel.setOffsetInBlock(this.info_.RTL?-o:o,t.baseline)}},e.blockRendering.Drawer.prototype.positionOutputConnection_=function(){if(this.info_.outputConnection){var t=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}},e.Events.MarkerMove=function(t,n,o,r){var a=t?t.workspace.id:void 0;r&&r.getType()==e.ASTNode.types.WORKSPACE&&(a=r.getLocation().id),e.Events.MarkerMove.superClass_.constructor.call(this,a),this.blockId=t?t.id:null,this.oldNode=o,this.newNode=r,this.isCursor=n},e.utils.object.inherits(e.Events.MarkerMove,e.Events.UiBase),e.Events.MarkerMove.prototype.type=e.Events.MARKER_MOVE,e.Events.MarkerMove.prototype.toJson=function(){var t=e.Events.MarkerMove.superClass_.toJson.call(this);return t.isCursor=this.isCursor,t.blockId=this.blockId,t.oldNode=this.oldNode,t.newNode=this.newNode,t},e.Events.MarkerMove.prototype.fromJson=function(t){e.Events.MarkerMove.superClass_.fromJson.call(this,t),this.isCursor=t.isCursor,this.blockId=t.blockId,this.oldNode=t.oldNode,this.newNode=t.newNode},e.registry.register(e.registry.Type.EVENT,e.Events.MARKER_MOVE,e.Events.MarkerMove),e.blockRendering.MarkerSvg=function(t,n,o){this.workspace_=t,this.marker_=o,this.parent_=null,this.constants_=n,this.currentMarkerSvg=null,t=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=o.colour||t},e.blockRendering.MarkerSvg.CURSOR_CLASS="blocklyCursor",e.blockRendering.MarkerSvg.MARKER_CLASS="blocklyMarker",e.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER=.75,e.blockRendering.MarkerSvg.prototype.getSvgRoot=function(){return this.svgGroup_},e.blockRendering.MarkerSvg.prototype.getMarker=function(){return this.marker_},e.blockRendering.MarkerSvg.prototype.isCursor=function(){return"cursor"==this.marker_.type},e.blockRendering.MarkerSvg.prototype.createDom=function(){var t=this.isCursor()?e.blockRendering.MarkerSvg.CURSOR_CLASS:e.blockRendering.MarkerSvg.MARKER_CLASS;return this.svgGroup_=e.utils.dom.createSvgElement(e.utils.Svg.G,{class:t},null),this.createDomInternal_(),this.svgGroup_},e.blockRendering.MarkerSvg.prototype.setParent_=function(t){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())),this.parent_=t},e.blockRendering.MarkerSvg.prototype.draw=function(t,n){if(n){this.constants_=this.workspace_.getRenderer().getConstants();var o=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker_.colour||o,this.applyColour_(n),this.showAtLocation_(n),this.fireMarkerEvent_(t,n),void 0!==(t=this.currentMarkerSvg.childNodes[0])&&t.beginElement&&t.beginElement()}else this.hide()},e.blockRendering.MarkerSvg.prototype.showAtLocation_=function(t){var n=t.getLocation().type;t.getType()==e.ASTNode.types.BLOCK?this.showWithBlock_(t):t.getType()==e.ASTNode.types.OUTPUT?this.showWithOutput_(t):n==e.connectionTypes.INPUT_VALUE?this.showWithInput_(t):n==e.connectionTypes.NEXT_STATEMENT?this.showWithNext_(t):t.getType()==e.ASTNode.types.PREVIOUS?this.showWithPrevious_(t):t.getType()==e.ASTNode.types.FIELD?this.showWithField_(t):t.getType()==e.ASTNode.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()==e.ASTNode.types.STACK&&this.showWithStack_(t)},e.blockRendering.MarkerSvg.prototype.showWithBlockPrevOutput_=function(t){var n=(t=t.getSourceBlock()).width,o=t.height,r=o*e.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER,a=this.constants_.CURSOR_BLOCK_PADDING;if(t.previousConnection){var h=this.constants_.shapeFor(t.previousConnection);this.positionPrevious_(n,a,r,h)}else t.outputConnection?(h=this.constants_.shapeFor(t.outputConnection),this.positionOutput_(n,o,h)):this.positionBlock_(n,a,r);this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithBlock_=function(t){this.showWithBlockPrevOutput_(t)},e.blockRendering.MarkerSvg.prototype.showWithPrevious_=function(t){this.showWithBlockPrevOutput_(t)},e.blockRendering.MarkerSvg.prototype.showWithOutput_=function(t){this.showWithBlockPrevOutput_(t)},e.blockRendering.MarkerSvg.prototype.showWithCoordinates_=function(t){var n=t.getWsCoordinate();t=n.x,this.workspace_.RTL&&(t-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(t,n=n.y,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace_),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithField_=function(t){var n=(t=t.getLocation()).getSize().width,o=t.getSize().height;this.positionRect_(0,0,n,o),this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithInput_=function(t){var n=(t=t.getLocation()).getSourceBlock();this.positionInput_(t),this.setParent_(n),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithNext_=function(t){var n=t.getLocation();t=n.getSourceBlock();var o=0;n=n.getOffsetInBlock().y;var r=t.getHeightWidth().width;this.workspace_.RTL&&(o=-r),this.positionLine_(o,n,r),this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showWithStack_=function(t){var n=(t=t.getLocation()).getHeightWidth(),o=n.width+this.constants_.CURSOR_STACK_PADDING,r=-this.constants_.CURSOR_STACK_PADDING/2,h=r;this.workspace_.RTL&&(h=-(o+r)),this.positionRect_(h,-this.constants_.CURSOR_STACK_PADDING/2,o,n=n.height+this.constants_.CURSOR_STACK_PADDING),this.setParent_(t),this.showCurrent_()},e.blockRendering.MarkerSvg.prototype.showCurrent_=function(){this.hide(),this.currentMarkerSvg.style.display=""},e.blockRendering.MarkerSvg.prototype.positionBlock_=function(t,n,o){t=e.utils.svgPaths.moveBy(-n,o)+e.utils.svgPaths.lineOnAxis("V",-n)+e.utils.svgPaths.lineOnAxis("H",t+2*n)+e.utils.svgPaths.lineOnAxis("V",o),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},e.blockRendering.MarkerSvg.prototype.positionInput_=function(t){var n=t.getOffsetInBlock().x,o=t.getOffsetInBlock().y;t=e.utils.svgPaths.moveTo(0,0)+this.constants_.shapeFor(t).pathDown,this.markerInput_.setAttribute("d",t),this.markerInput_.setAttribute("transform","translate("+n+","+o+")"+(this.workspace_.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_},e.blockRendering.MarkerSvg.prototype.positionLine_=function(t,n,o){this.markerSvgLine_.setAttribute("x",t),this.markerSvgLine_.setAttribute("y",n),this.markerSvgLine_.setAttribute("width",o),this.currentMarkerSvg=this.markerSvgLine_},e.blockRendering.MarkerSvg.prototype.positionOutput_=function(t,n,o){t=e.utils.svgPaths.moveBy(t,0)+e.utils.svgPaths.lineOnAxis("h",-(t-o.width))+e.utils.svgPaths.lineOnAxis("v",this.constants_.TAB_OFFSET_FROM_TOP)+o.pathDown+e.utils.svgPaths.lineOnAxis("V",n)+e.utils.svgPaths.lineOnAxis("H",t),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},e.blockRendering.MarkerSvg.prototype.positionPrevious_=function(t,n,o,r){t=e.utils.svgPaths.moveBy(-n,o)+e.utils.svgPaths.lineOnAxis("V",-n)+e.utils.svgPaths.lineOnAxis("H",this.constants_.NOTCH_OFFSET_LEFT)+r.pathLeft+e.utils.svgPaths.lineOnAxis("H",t+2*n)+e.utils.svgPaths.lineOnAxis("V",o),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},e.blockRendering.MarkerSvg.prototype.positionRect_=function(t,n,o,r){this.markerSvgRect_.setAttribute("x",t),this.markerSvgRect_.setAttribute("y",n),this.markerSvgRect_.setAttribute("width",o),this.markerSvgRect_.setAttribute("height",r),this.currentMarkerSvg=this.markerSvgRect_},e.blockRendering.MarkerSvg.prototype.flipRtl_=function(t){t.setAttribute("transform","scale(-1 1)")},e.blockRendering.MarkerSvg.prototype.hide=function(){this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"},e.blockRendering.MarkerSvg.prototype.fireMarkerEvent_=function(t,n){var o=n.getSourceBlock();t=new(e.Events.get(e.Events.MARKER_MOVE))(o,this.isCursor(),t,n),e.Events.fire(t)},e.blockRendering.MarkerSvg.prototype.getBlinkProperties_=function(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}},e.blockRendering.MarkerSvg.prototype.createDomInternal_=function(){if(this.markerSvg_=e.utils.dom.createSvgElement(e.utils.Svg.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=e.utils.dom.createSvgElement(e.utils.Svg.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var t=this.getBlinkProperties_();e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerSvgLine_),e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerInput_),t.attributeName="stroke",e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerBlock_)}return this.markerSvg_},e.blockRendering.MarkerSvg.prototype.applyColour_=function(t){this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(this.markerSvgLine_.firstChild.setAttribute("values",t=this.colour_+";transparent;transparent;"),this.markerInput_.firstChild.setAttribute("values",t),this.markerBlock_.firstChild.setAttribute("values",t))},e.blockRendering.MarkerSvg.prototype.dispose=function(){this.svgGroup_&&e.utils.dom.removeNode(this.svgGroup_)},e.blockRendering.PathObject=function(t,n,o){this.constants=o,this.svgRoot=t,this.svgPath=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.style=n,this.markerSvg=this.cursorSvg=null},e.blockRendering.PathObject.prototype.setPath=function(t){this.svgPath.setAttribute("d",t)},e.blockRendering.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)")},e.blockRendering.PathObject.prototype.setCursorSvg=function(t){t?(this.svgRoot.appendChild(t),this.cursorSvg=t):this.cursorSvg=null},e.blockRendering.PathObject.prototype.setMarkerSvg=function(t){t?(this.cursorSvg?this.svgRoot.insertBefore(t,this.cursorSvg):this.svgRoot.appendChild(t),this.markerSvg=t):this.markerSvg=null},e.blockRendering.PathObject.prototype.applyColour=function(t){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(t.isShadow()),this.updateDisabled_(!t.isEnabled()||t.getInheritedDisabled())},e.blockRendering.PathObject.prototype.setStyle=function(t){this.style=t},e.blockRendering.PathObject.prototype.setClass_=function(t,n){n?e.utils.dom.addClass(this.svgRoot,t):e.utils.dom.removeClass(this.svgRoot,t)},e.blockRendering.PathObject.prototype.updateHighlighted=function(t){this.svgPath.setAttribute("filter",t?"url(#"+this.constants.embossFilterId+")":"none")},e.blockRendering.PathObject.prototype.updateShadow_=function(t){t&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},e.blockRendering.PathObject.prototype.updateDisabled_=function(t){this.setClass_("blocklyDisabled",t),t&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")},e.blockRendering.PathObject.prototype.updateSelected=function(t){this.setClass_("blocklySelected",t)},e.blockRendering.PathObject.prototype.updateDraggingDelete=function(t){this.setClass_("blocklyDraggingDelete",t)},e.blockRendering.PathObject.prototype.updateInsertionMarker=function(t){this.setClass_("blocklyInsertionMarker",t)},e.blockRendering.PathObject.prototype.updateMovable=function(t){this.setClass_("blocklyDraggable",t)},e.blockRendering.PathObject.prototype.updateReplacementFade=function(t){this.setClass_("blocklyReplaceable",t)},e.blockRendering.PathObject.prototype.updateShapeForInputHighlight=function(t,n){},e.blockRendering.Renderer=function(t){this.name=t,this.overrides=this.constants_=null},e.blockRendering.Renderer.prototype.getClassName=function(){return this.name+"-renderer"},e.blockRendering.Renderer.prototype.init=function(t,n){this.constants_=this.makeConstants_(),n&&(this.overrides=n,e.utils.object.mixin(this.constants_,n)),this.constants_.setTheme(t),this.constants_.init()},e.blockRendering.Renderer.prototype.createDom=function(t,n){this.constants_.createDom(t,this.name+"-"+n.name,"."+this.getClassName()+"."+n.getClassName())},e.blockRendering.Renderer.prototype.refreshDom=function(t,n){var o=this.getConstants();o.dispose(),this.constants_=this.makeConstants_(),this.overrides&&e.utils.object.mixin(this.constants_,this.overrides),this.constants_.randomIdentifier=o.randomIdentifier,this.constants_.setTheme(n),this.constants_.init(),this.createDom(t,n)},e.blockRendering.Renderer.prototype.dispose=function(){this.constants_&&this.constants_.dispose()},e.blockRendering.Renderer.prototype.makeConstants_=function(){return new e.blockRendering.ConstantProvider},e.blockRendering.Renderer.prototype.makeRenderInfo_=function(t){return new e.blockRendering.RenderInfo(this,t)},e.blockRendering.Renderer.prototype.makeDrawer_=function(t,n){return new e.blockRendering.Drawer(t,n)},e.blockRendering.Renderer.prototype.makeDebugger_=function(){if(!e.blockRendering.Debug)throw Error("Missing require for Blockly.blockRendering.Debug");return new e.blockRendering.Debug(this.getConstants())},e.blockRendering.Renderer.prototype.makeMarkerDrawer=function(t,n){return new e.blockRendering.MarkerSvg(t,this.getConstants(),n)},e.blockRendering.Renderer.prototype.makePathObject=function(t,n){return new e.blockRendering.PathObject(t,n,this.constants_)},e.blockRendering.Renderer.prototype.getConstants=function(){return this.constants_},e.blockRendering.Renderer.prototype.shouldHighlightConnection=function(t){return!0},e.blockRendering.Renderer.prototype.orphanCanConnectAtEnd=function(t,n,o){return!!e.Connection.getConnectionForOrphanedConnection(t,o===e.connectionTypes.OUTPUT_VALUE?n.outputConnection:n.previousConnection)},e.blockRendering.Renderer.prototype.getConnectionPreviewMethod=function(t,n,o){return n.type==e.connectionTypes.OUTPUT_VALUE||n.type==e.connectionTypes.PREVIOUS_STATEMENT?!t.isConnected()||this.orphanCanConnectAtEnd(o,t.targetBlock(),n.type)?e.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:e.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:e.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER},e.blockRendering.Renderer.prototype.render=function(t){e.blockRendering.useDebugger&&!t.renderingDebugger&&(t.renderingDebugger=this.makeDebugger_());var n=this.makeRenderInfo_(t);n.measure(),this.makeDrawer_(t,n).draw()},e.geras={},e.geras.ConstantProvider=function(){e.geras.ConstantProvider.superClass_.constructor.call(this),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2},e.utils.object.inherits(e.geras.ConstantProvider,e.blockRendering.ConstantProvider),e.geras.ConstantProvider.prototype.getCSS_=function(t){return e.geras.ConstantProvider.superClass_.getCSS_.call(this,t).concat([t+" .blocklyInsertionMarker>.blocklyPathLight,",t+" .blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"])},e.geras.Highlighter=function(t){this.info_=t,this.inlineSteps_=this.steps_="",this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH},e.geras.Highlighter.prototype.getPath=function(){return this.steps_+"\n"+this.inlineSteps_},e.geras.Highlighter.prototype.drawTopCorner=function(t){this.steps_+=e.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var o,n=0;o=t.elements[n];n++)e.blockRendering.Types.isLeftSquareCorner(o)?this.steps_+=this.highlightConstants_.START_POINT:e.blockRendering.Types.isLeftRoundedCorner(o)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):e.blockRendering.Types.isPreviousConnection(o)?this.steps_+=this.notchPaths_.pathLeft:e.blockRendering.Types.isHat(o)?this.steps_+=this.startPaths_.path(this.RTL_):e.blockRendering.Types.isSpacer(o)&&0!=o.width&&(this.steps_+=e.utils.svgPaths.lineOnAxis("H",o.xPos+o.width-this.highlightOffset_));this.steps_+=e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width-this.highlightOffset_)},e.geras.Highlighter.prototype.drawJaggedEdge_=function(t){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+e.utils.svgPaths.lineOnAxis("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset_))},e.geras.Highlighter.prototype.drawValueInput=function(t){var n=t.getLastInput();if(this.RTL_){var o=t.height-n.connectionHeight;this.steps_+=e.utils.svgPaths.moveTo(n.xPos+n.width-this.highlightOffset_,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+e.utils.svgPaths.lineOnAxis("v",o)}else this.steps_+=e.utils.svgPaths.moveTo(n.xPos+n.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)},e.geras.Highlighter.prototype.drawStatementInput=function(t){var n=t.getLastInput();if(this.RTL_){var o=t.height-2*this.insideCornerPaths_.height;this.steps_+=e.utils.svgPaths.moveTo(n.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+e.utils.svgPaths.lineOnAxis("v",o)+this.insideCornerPaths_.pathBottom(this.RTL_)+e.utils.svgPaths.lineTo(t.width-n.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=e.utils.svgPaths.moveTo(n.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+e.utils.svgPaths.lineTo(t.width-n.xPos-this.insideCornerPaths_.width,0)},e.geras.Highlighter.prototype.drawRightSideRow=function(t){var n=t.xPos+t.width-this.highlightOffset_;t.followsStatement&&(this.steps_+=e.utils.svgPaths.lineOnAxis("H",n)),this.RTL_&&(this.steps_+=e.utils.svgPaths.lineOnAxis("H",n),t.height>this.highlightOffset_&&(this.steps_+=e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height-this.highlightOffset_)))},e.geras.Highlighter.prototype.drawBottomRow=function(t){if(this.RTL_)this.steps_+=e.utils.svgPaths.lineOnAxis("V",t.baseline-this.highlightOffset_);else{var n=this.info_.bottomRow.elements[0];e.blockRendering.Types.isLeftSquareCorner(n)?this.steps_+=e.utils.svgPaths.moveTo(t.xPos+this.highlightOffset_,t.baseline-this.highlightOffset_):e.blockRendering.Types.isLeftRoundedCorner(n)&&(this.steps_+=e.utils.svgPaths.moveTo(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}},e.geras.Highlighter.prototype.drawLeft=function(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=e.utils.svgPaths.moveTo(this.info_.startX,t):(this.steps_+=e.utils.svgPaths.moveTo(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=e.utils.svgPaths.lineOnAxis("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e.blockRendering.Types.isLeftRoundedCorner((t=this.info_.topRow).elements[0])?this.steps_+=e.utils.svgPaths.lineOnAxis("V",this.outsideCornerPaths_.height):this.steps_+=e.utils.svgPaths.lineOnAxis("V",t.capline+this.highlightOffset_))},e.geras.Highlighter.prototype.drawInlineInput=function(t){var n=this.highlightOffset_,o=t.xPos+t.connectionWidth,r=t.centerline-t.height/2,a=t.width-t.connectionWidth,h=r+n;this.RTL_?(r=t.connectionOffsetY-n,t=t.height-(t.connectionOffsetY+t.connectionHeight)+n,this.inlineSteps_+=e.utils.svgPaths.moveTo(o-n,h)+e.utils.svgPaths.lineOnAxis("v",r)+this.puzzleTabPaths_.pathDown(this.RTL_)+e.utils.svgPaths.lineOnAxis("v",t)+e.utils.svgPaths.lineOnAxis("h",a)):this.inlineSteps_+=e.utils.svgPaths.moveTo(t.xPos+t.width+n,h)+e.utils.svgPaths.lineOnAxis("v",t.height)+e.utils.svgPaths.lineOnAxis("h",-a)+e.utils.svgPaths.moveTo(o,r+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)},e.geras.InlineInput=function(t,n){e.geras.InlineInput.superClass_.constructor.call(this,t,n),this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)},e.utils.object.inherits(e.geras.InlineInput,e.blockRendering.InlineInput),e.geras.StatementInput=function(t,n){e.geras.StatementInput.superClass_.constructor.call(this,t,n),this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)},e.utils.object.inherits(e.geras.StatementInput,e.blockRendering.StatementInput),e.geras.RenderInfo=function(t,n){e.geras.RenderInfo.superClass_.constructor.call(this,t,n)},e.utils.object.inherits(e.geras.RenderInfo,e.blockRendering.RenderInfo),e.geras.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.geras.RenderInfo.prototype.populateBottomRow_=function(){e.geras.RenderInfo.superClass_.populateBottomRow_.call(this),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==e.inputTypes.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)},e.geras.RenderInfo.prototype.addInput_=function(t,n){this.isInline&&t.type==e.inputTypes.VALUE?(n.elements.push(new e.geras.InlineInput(this.constants_,t)),n.hasInlineInput=!0):t.type==e.inputTypes.STATEMENT?(n.elements.push(new e.geras.StatementInput(this.constants_,t)),n.hasStatement=!0):t.type==e.inputTypes.VALUE?(n.elements.push(new e.blockRendering.ExternalValueInput(this.constants_,t)),n.hasExternalInput=!0):t.type==e.inputTypes.DUMMY&&(n.minHeight=Math.max(n.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),n.hasDummyInput=!0),this.isInline||null!=n.align||(n.align=t.align)},e.geras.RenderInfo.prototype.addElemSpacing_=function(){for(var o,t=!1,n=0;o=this.rows[n];n++)o.hasExternalInput&&(t=!0);for(n=0;o=this.rows[n];n++){var r=o.elements;if(o.elements=[],o.startsWithElemSpacer()&&o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(var a=0;a<r.length-1;a++){o.elements.push(r[a]);var h=this.getInRowSpacing_(r[a],r[a+1]);o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h))}o.elements.push(r[r.length-1]),o.endsWithElemSpacer()&&(h=this.getInRowSpacing_(r[r.length-1],null),t&&o.hasDummyInput&&(h+=this.constants_.TAB_WIDTH),o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h)))}}},e.geras.RenderInfo.prototype.getInRowSpacing_=function(t,n){if(!t)return n&&e.blockRendering.Types.isField(n)&&n.isEditable?this.constants_.MEDIUM_PADDING:n&&e.blockRendering.Types.isInlineInput(n)?this.constants_.MEDIUM_LARGE_PADDING:n&&e.blockRendering.Types.isStatementInput(n)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!e.blockRendering.Types.isInput(t)&&(!n||e.blockRendering.Types.isStatementInput(n)))return e.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:e.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:e.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:e.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:e.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:e.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInput(t)&&!n){if(e.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!e.blockRendering.Types.isInput(t)&&n&&e.blockRendering.Types.isInput(n)){if(e.blockRendering.Types.isField(t)&&t.isEditable){if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.SMALL_PADDING}else{if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.MEDIUM_LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(n))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(e.blockRendering.Types.isIcon(t)&&n&&!e.blockRendering.Types.isInput(n))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInlineInput(t)&&n&&e.blockRendering.Types.isField(n))return n.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isLeftSquareCorner(t)&&n){if(e.blockRendering.Types.isHat(n))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isPreviousConnection(n))return n.notchOffset;if(e.blockRendering.Types.isNextConnection(n))return n.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(e.blockRendering.Types.isLeftRoundedCorner(t)&&n){if(e.blockRendering.Types.isPreviousConnection(n))return n.notchOffset-this.constants_.CORNER_RADIUS;if(e.blockRendering.Types.isNextConnection(n))return n.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return e.blockRendering.Types.isField(t)&&n&&e.blockRendering.Types.isField(n)&&t.isEditable==n.isEditable||n&&e.blockRendering.Types.isJaggedEdge(n)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.geras.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){return e.blockRendering.Types.isTopRow(t)&&e.blockRendering.Types.isBottomRow(n)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:e.blockRendering.Types.isTopRow(t)||e.blockRendering.Types.isBottomRow(n)?this.constants_.NO_PADDING:t.hasExternalInput&&n.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&n.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&n.hasStatement||!t.hasStatement&&n.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.geras.RenderInfo.prototype.getElemCenterline_=function(t,n){if(e.blockRendering.Types.isSpacer(n))return t.yPos+n.height/2;if(e.blockRendering.Types.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,e.blockRendering.Types.isNextConnection(n)?t+n.height/2:t-n.height/2;if(e.blockRendering.Types.isTopRow(t))return e.blockRendering.Types.isHat(n)?t.capline-n.height/2:t.capline+n.height/2;var o=t.yPos;return e.blockRendering.Types.isField(n)||e.blockRendering.Types.isIcon(n)?(o+=n.height/2,(t.hasInlineInput||t.hasStatement)&&n.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(o+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):o=e.blockRendering.Types.isInlineInput(n)?o+n.height/2:o+t.height/2,o},e.geras.RenderInfo.prototype.alignRowElements_=function(){if(this.isInline){for(var r,t=0,n=null,o=this.rows.length-1;r=this.rows[o];o--)r.nextRightEdge=t,e.blockRendering.Types.isInputRow(r)&&(r.hasStatement&&this.alignStatementRow_(r),n&&n.hasStatement&&r.width<n.width?r.nextRightEdge=n.width:t=r.width,n=r);for(o=t=0;r=this.rows[o];o++)r.hasStatement?t=this.getDesiredRowWidth_(r):e.blockRendering.Types.isSpacer(r)?r.width=Math.max(t,r.nextRightEdge):(0<(t=Math.max(t,r.nextRightEdge)-r.width)&&this.addAlignmentPadding_(r,t),t=r.width)}else e.geras.RenderInfo.superClass_.alignRowElements_.call(this)},e.geras.RenderInfo.prototype.getDesiredRowWidth_=function(t){return this.isInline&&t.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:e.geras.RenderInfo.superClass_.getDesiredRowWidth_.call(this,t)},e.geras.RenderInfo.prototype.finalize_=function(){for(var r,t=0,n=0,o=0;r=this.rows[o];o++){r.yPos=n,r.xPos=this.startX,n+=r.height,t=Math.max(t,r.widthWithConnectedBlocks);var a=n-this.topRow.ascenderHeight;r==this.bottomRow&&a<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=a=this.constants_.MIN_BLOCK_HEIGHT-a,n+=a),this.recordElemPositions_(r)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(t=Math.max(t,this.block_.nextConnection.targetBlock().getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=n-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=n+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline},e.geras.Drawer=function(t,n){e.geras.Drawer.superClass_.constructor.call(this,t,n),this.highlighter_=new e.geras.Highlighter(n)},e.utils.object.inherits(e.geras.Drawer,e.blockRendering.Drawer),e.geras.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();var t=this.block_.pathObject;t.setPath(this.outlinePath_+"\n"+this.inlinePath_),t.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&t.flipRTL(),e.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},e.geras.Drawer.prototype.drawTop_=function(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),e.geras.Drawer.superClass_.drawTop_.call(this)},e.geras.Drawer.prototype.drawJaggedEdge_=function(t){this.highlighter_.drawJaggedEdge_(t),e.geras.Drawer.superClass_.drawJaggedEdge_.call(this,t)},e.geras.Drawer.prototype.drawValueInput_=function(t){this.highlighter_.drawValueInput(t),e.geras.Drawer.superClass_.drawValueInput_.call(this,t)},e.geras.Drawer.prototype.drawStatementInput_=function(t){this.highlighter_.drawStatementInput(t),e.geras.Drawer.superClass_.drawStatementInput_.call(this,t)},e.geras.Drawer.prototype.drawRightSideRow_=function(t){this.highlighter_.drawRightSideRow(t),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width)+e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},e.geras.Drawer.prototype.drawBottom_=function(){this.highlighter_.drawBottomRow(this.info_.bottomRow),e.geras.Drawer.superClass_.drawBottom_.call(this)},e.geras.Drawer.prototype.drawLeft_=function(){this.highlighter_.drawLeft(),e.geras.Drawer.superClass_.drawLeft_.call(this)},e.geras.Drawer.prototype.drawInlineInput_=function(t){this.highlighter_.drawInlineInput(t),e.geras.Drawer.superClass_.drawInlineInput_.call(this,t)},e.geras.Drawer.prototype.positionInlineInputConnection_=function(t){if(t.connectionModel){var o=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(o*=-1),t.connectionModel.setOffsetInBlock(o,t.centerline-t.height/2+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}},e.geras.Drawer.prototype.positionStatementInputConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.statementEdge+n.notchOffset;n.connectionModel.setOffsetInBlock(o=this.info_.RTL?-1*o:o+this.constants_.DARK_PATH_OFFSET,t.yPos+this.constants_.DARK_PATH_OFFSET)}},e.geras.Drawer.prototype.positionExternalValueConnection_=function(t){var n=t.getLastInput();if(n.connectionModel){var o=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(o*=-1),n.connectionModel.setOffsetInBlock(o,t.yPos)}},e.geras.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var n=t.connection,o=n.xPos;n.connectionModel.setOffsetInBlock((this.info_.RTL?-o:o)+this.constants_.DARK_PATH_OFFSET/2,t.baseline+this.constants_.DARK_PATH_OFFSET)}},e.geras.HighlightConstantProvider=function(t){this.constantProvider=t,this.OFFSET=.5,this.START_POINT=e.utils.svgPaths.moveBy(this.OFFSET,this.OFFSET)},e.geras.HighlightConstantProvider.prototype.init=function(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()},e.geras.HighlightConstantProvider.prototype.makeInsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,n=this.OFFSET,o=(1-Math.SQRT1_2)*(t+n)-n,r=e.utils.svgPaths.moveBy(o,o)+e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(-o-n,t-o)),a=e.utils.svgPaths.arc("a","0 0,0",t+n,e.utils.svgPaths.point(t+n,t+n)),h=e.utils.svgPaths.moveBy(o,-o)+e.utils.svgPaths.arc("a","0 0,0",t+n,e.utils.svgPaths.point(t-o,o+n));return{width:t+n,height:t,pathTop:function(R){return R?r:""},pathBottom:function(R){return R?a:h}}},e.geras.HighlightConstantProvider.prototype.makeOutsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,n=this.OFFSET,o=(1-Math.SQRT1_2)*(t-n)+n,r=e.utils.svgPaths.moveBy(o,o)+e.utils.svgPaths.arc("a","0 0,1",t-n,e.utils.svgPaths.point(t-o,-o+n)),a=e.utils.svgPaths.moveBy(n,t)+e.utils.svgPaths.arc("a","0 0,1",t-n,e.utils.svgPaths.point(t,-t+n)),h=-o,R=e.utils.svgPaths.moveBy(o,h)+e.utils.svgPaths.arc("a","0 0,1",t-n,e.utils.svgPaths.point(-o+n,-h-t));return{height:t,topLeft:function(L){return L?r:a},bottomLeft:function(){return R}}},e.geras.HighlightConstantProvider.prototype.makePuzzleTab=function(){var t=this.constantProvider.TAB_WIDTH,n=this.constantProvider.TAB_HEIGHT,o=e.utils.svgPaths.moveBy(-2,3.4-n)+e.utils.svgPaths.lineTo(-.45*t,-2.1),r=e.utils.svgPaths.lineOnAxis("v",2.5)+e.utils.svgPaths.moveBy(.97*-t,2.5)+e.utils.svgPaths.curve("q",[e.utils.svgPaths.point(.05*-t,10),e.utils.svgPaths.point(.3*t,9.5)])+e.utils.svgPaths.moveBy(.67*t,-1.9)+e.utils.svgPaths.lineOnAxis("v",2.5),a=e.utils.svgPaths.lineOnAxis("v",-1.5)+e.utils.svgPaths.moveBy(-.92*t,-.5)+e.utils.svgPaths.curve("q",[e.utils.svgPaths.point(-.19*t,-5.5),e.utils.svgPaths.point(0,-11)])+e.utils.svgPaths.moveBy(.92*t,1),h=e.utils.svgPaths.moveBy(-5,n-.7)+e.utils.svgPaths.lineTo(.46*t,-2.1);return{width:t,height:n,pathUp:function(R){return R?o:a},pathDown:function(R){return R?r:h}}},e.geras.HighlightConstantProvider.prototype.makeNotch=function(){return{pathLeft:e.utils.svgPaths.lineOnAxis("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}},e.geras.HighlightConstantProvider.prototype.makeJaggedTeeth=function(){return{pathLeft:e.utils.svgPaths.lineTo(5.1,2.6)+e.utils.svgPaths.moveBy(-10.2,6.8)+e.utils.svgPaths.lineTo(5.1,2.6),height:12,width:10.2}},e.geras.HighlightConstantProvider.prototype.makeStartHat=function(){var t=this.constantProvider.START_HAT.height,n=e.utils.svgPaths.moveBy(25,-8.7)+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(29.7,-6.2),e.utils.svgPaths.point(57.2,-.5),e.utils.svgPaths.point(75,8.7)]),o=e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(17.8,-9.2),e.utils.svgPaths.point(45.3,-14.9),e.utils.svgPaths.point(75,-8.7)])+e.utils.svgPaths.moveTo(100.5,t+.5);return{path:function(r){return r?n:o}}},e.geras.PathObject=function(t,n,o){this.constants=o,this.svgRoot=t,this.svgPathDark=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgRoot),this.svgPath=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.svgPathLight=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyPathLight"},this.svgRoot),this.colourDark="#000000",this.style=n},e.utils.object.inherits(e.geras.PathObject,e.blockRendering.PathObject),e.geras.PathObject.prototype.setPath=function(t){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t)},e.geras.PathObject.prototype.setHighlightPath=function(t){this.svgPathLight.setAttribute("d",t)},e.geras.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")},e.geras.PathObject.prototype.applyColour=function(t){this.svgPathLight.style.display="",this.svgPathDark.style.display="",this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),e.geras.PathObject.superClass_.applyColour.call(this,t),this.svgPath.setAttribute("stroke","none")},e.geras.PathObject.prototype.setStyle=function(t){this.style=t,this.colourDark=e.utils.colour.blend("#000",this.style.colourPrimary,.2)||this.colourDark},e.geras.PathObject.prototype.updateHighlighted=function(t){t?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")},e.geras.PathObject.prototype.updateShadow_=function(t){t&&(this.svgPathLight.style.display="none",this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},e.geras.PathObject.prototype.updateDisabled_=function(t){e.geras.PathObject.superClass_.updateDisabled_.call(this,t),t&&this.svgPath.setAttribute("stroke","none")},e.geras.Renderer=function(t){e.geras.Renderer.superClass_.constructor.call(this,t),this.highlightConstants_=null},e.utils.object.inherits(e.geras.Renderer,e.blockRendering.Renderer),e.geras.Renderer.prototype.init=function(t,n){e.geras.Renderer.superClass_.init.call(this,t,n),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()},e.geras.Renderer.prototype.refreshDom=function(t,n){e.geras.Renderer.superClass_.refreshDom.call(this,t,n),this.getHighlightConstants().init()},e.geras.Renderer.prototype.makeConstants_=function(){return new e.geras.ConstantProvider},e.geras.Renderer.prototype.makeRenderInfo_=function(t){return new e.geras.RenderInfo(this,t)},e.geras.Renderer.prototype.makeDrawer_=function(t,n){return new e.geras.Drawer(t,n)},e.geras.Renderer.prototype.makePathObject=function(t,n){return new e.geras.PathObject(t,n,this.getConstants())},e.geras.Renderer.prototype.makeHighlightConstants_=function(){return new e.geras.HighlightConstantProvider(this.getConstants())},e.geras.Renderer.prototype.getHighlightConstants=function(){return this.highlightConstants_},e.blockRendering.register("geras",e.geras.Renderer),e.thrasos={},e.thrasos.RenderInfo=function(t,n){e.thrasos.RenderInfo.superClass_.constructor.call(this,t,n)},e.utils.object.inherits(e.thrasos.RenderInfo,e.blockRendering.RenderInfo),e.thrasos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.thrasos.RenderInfo.prototype.addElemSpacing_=function(){for(var o,t=!1,n=0;o=this.rows[n];n++)o.hasExternalInput&&(t=!0);for(n=0;o=this.rows[n];n++){var r=o.elements;o.elements=[],o.startsWithElemSpacer()&&o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,r[0])));for(var a=0;a<r.length-1;a++){o.elements.push(r[a]);var h=this.getInRowSpacing_(r[a],r[a+1]);o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h))}o.elements.push(r[r.length-1]),o.endsWithElemSpacer()&&(h=this.getInRowSpacing_(r[r.length-1],null),t&&o.hasDummyInput&&(h+=this.constants_.TAB_WIDTH),o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,h)))}},e.thrasos.RenderInfo.prototype.getInRowSpacing_=function(t,n){if(!t)return n&&e.blockRendering.Types.isField(n)&&n.isEditable?this.constants_.MEDIUM_PADDING:n&&e.blockRendering.Types.isInlineInput(n)?this.constants_.MEDIUM_LARGE_PADDING:n&&e.blockRendering.Types.isStatementInput(n)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!e.blockRendering.Types.isInput(t)&&!n)return e.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:e.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:e.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:e.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:e.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:e.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInput(t)&&!n){if(e.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!e.blockRendering.Types.isInput(t)&&n&&e.blockRendering.Types.isInput(n)){if(e.blockRendering.Types.isField(t)&&t.isEditable){if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.SMALL_PADDING}else{if(e.blockRendering.Types.isInlineInput(n)||e.blockRendering.Types.isExternalInput(n))return this.constants_.MEDIUM_LARGE_PADDING;if(e.blockRendering.Types.isStatementInput(n))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(e.blockRendering.Types.isIcon(t)&&n&&!e.blockRendering.Types.isInput(n))return this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isInlineInput(t)&&n&&e.blockRendering.Types.isField(n))return n.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(e.blockRendering.Types.isLeftSquareCorner(t)&&n){if(e.blockRendering.Types.isHat(n))return this.constants_.NO_PADDING;if(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))return n.notchOffset}return e.blockRendering.Types.isLeftRoundedCorner(t)&&n?n.notchOffset-this.constants_.CORNER_RADIUS:e.blockRendering.Types.isField(t)&&n&&e.blockRendering.Types.isField(n)&&t.isEditable==n.isEditable||n&&e.blockRendering.Types.isJaggedEdge(n)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.thrasos.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){return e.blockRendering.Types.isTopRow(t)&&e.blockRendering.Types.isBottomRow(n)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:e.blockRendering.Types.isTopRow(t)||e.blockRendering.Types.isBottomRow(n)?this.constants_.NO_PADDING:t.hasExternalInput&&n.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&n.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&n.hasStatement||t.hasDummyInput||n.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},e.thrasos.RenderInfo.prototype.getElemCenterline_=function(t,n){if(e.blockRendering.Types.isSpacer(n))return t.yPos+n.height/2;if(e.blockRendering.Types.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,e.blockRendering.Types.isNextConnection(n)?t+n.height/2:t-n.height/2;if(e.blockRendering.Types.isTopRow(t))return e.blockRendering.Types.isHat(n)?t.capline-n.height/2:t.capline+n.height/2;var o=t.yPos;return e.blockRendering.Types.isField(n)&&t.hasStatement?o+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+n.height/2):o+t.height/2},e.thrasos.RenderInfo.prototype.finalize_=function(){for(var r,t=0,n=0,o=0;r=this.rows[o];o++){r.yPos=n,r.xPos=this.startX,n+=r.height,t=Math.max(t,r.widthWithConnectedBlocks);var a=n-this.topRow.ascenderHeight;r==this.bottomRow&&a<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=a=this.constants_.MIN_BLOCK_HEIGHT-a,n+=a),this.recordElemPositions_(r)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(t=Math.max(t,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.bottomRow.baseline=n-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX,this.height=n,this.startY=this.topRow.capline},e.thrasos.Renderer=function(t){e.thrasos.Renderer.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.thrasos.Renderer,e.blockRendering.Renderer),e.thrasos.Renderer.prototype.makeRenderInfo_=function(t){return new e.thrasos.RenderInfo(this,t)},e.blockRendering.register("thrasos",e.thrasos.Renderer),e.zelos={},e.zelos.ConstantProvider=function(){e.zelos.ConstantProvider.superClass_.constructor.call(this),this.SMALL_PADDING=this.GRID_UNIT=4,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TAB_OFFSET_FROM_TOP=0,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!0,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.replacementGlowFilter_=null},e.utils.object.inherits(e.zelos.ConstantProvider,e.blockRendering.ConstantProvider),e.zelos.ConstantProvider.prototype.setFontConstants_=function(t){e.zelos.ConstantProvider.superClass_.setFontConstants_.call(this,t),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING},e.zelos.ConstantProvider.prototype.init=function(){e.zelos.ConstantProvider.superClass_.init.call(this),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth},e.zelos.ConstantProvider.prototype.setDynamicProperties_=function(t){e.zelos.ConstantProvider.superClass_.setDynamicProperties_.call(this,t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var n=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=n&&!isNaN(n)?n:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(t=Number(t.getComponentStyle("replacementGlowSize")))&&!isNaN(t)?t:this.REPLACEMENT_GLOW_SIZE},e.zelos.ConstantProvider.prototype.dispose=function(){e.zelos.ConstantProvider.superClass_.dispose.call(this),this.selectedGlowFilter_&&e.utils.dom.removeNode(this.selectedGlowFilter_),this.replacementGlowFilter_&&e.utils.dom.removeNode(this.replacementGlowFilter_)},e.zelos.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,n=this.START_HAT_WIDTH;return{height:t,width:n,path:e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(25,-t),e.utils.svgPaths.point(71,-t),e.utils.svgPaths.point(n,0)])}},e.zelos.ConstantProvider.prototype.makeHexagonal=function(){function t(o,r,a){var h=o/2;return e.utils.svgPaths.lineTo(-(a=a?-1:1)*(h=h>n?n:h),o=(r?-1:1)*o/2)+e.utils.svgPaths.lineTo(a*h,o)}var n=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:function(o){return(o/=2)>n?n:o},height:function(o){return o},connectionOffsetY:function(o){return o/2},connectionOffsetX:function(o){return-o},pathDown:function(o){return t(o,!1,!1)},pathUp:function(o){return t(o,!0,!1)},pathRightDown:function(o){return t(o,!1,!0)},pathRightUp:function(o){return t(o,!1,!0)}}},e.zelos.ConstantProvider.prototype.makeRounded=function(){function t(r,a,h){var R=r>o?r-o:0;return e.utils.svgPaths.arc("a","0 0,1",r=(r>o?o:r)/2,e.utils.svgPaths.point((a?-1:1)*r,(a?-1:1)*r))+e.utils.svgPaths.lineOnAxis("v",(h?1:-1)*R)+e.utils.svgPaths.arc("a","0 0,1",r,e.utils.svgPaths.point((a?1:-1)*r,(a?-1:1)*r))}var n=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,o=2*n;return{type:this.SHAPES.ROUND,isDynamic:!0,width:function(r){return(r/=2)>n?n:r},height:function(r){return r},connectionOffsetY:function(r){return r/2},connectionOffsetX:function(r){return-r},pathDown:function(r){return t(r,!1,!1)},pathUp:function(r){return t(r,!0,!1)},pathRightDown:function(r){return t(r,!1,!0)},pathRightUp:function(r){return t(r,!1,!0)}}},e.zelos.ConstantProvider.prototype.makeSquared=function(){function t(o,r,a){return o-=2*n,e.utils.svgPaths.arc("a","0 0,1",n,e.utils.svgPaths.point((r?-1:1)*n,(r?-1:1)*n))+e.utils.svgPaths.lineOnAxis("v",(a?1:-1)*o)+e.utils.svgPaths.arc("a","0 0,1",n,e.utils.svgPaths.point((r?1:-1)*n,(r?-1:1)*n))}var n=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:function(o){return n},height:function(o){return o},connectionOffsetY:function(o){return o/2},connectionOffsetX:function(o){return-o},pathDown:function(o){return t(o,!1,!1)},pathUp:function(o){return t(o,!0,!1)},pathRightDown:function(o){return t(o,!1,!0)},pathRightUp:function(o){return t(o,!1,!0)}}},e.zelos.ConstantProvider.prototype.shapeFor=function(t){var n=t.getCheck();switch(!n&&t.targetConnection&&(n=t.targetConnection.getCheck()),t.type){case e.connectionTypes.INPUT_VALUE:case e.connectionTypes.OUTPUT_VALUE:if(null!=(t=t.getSourceBlock().getOutputShape()))switch(t){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return n&&-1!=n.indexOf("Boolean")?this.HEXAGONAL:(n&&-1!=n.indexOf("Number")||n&&n.indexOf("String"),this.ROUNDED);case e.connectionTypes.PREVIOUS_STATEMENT:case e.connectionTypes.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}},e.zelos.ConstantProvider.prototype.makeNotch=function(){function t(nt){return e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/2,0),e.utils.svgPaths.point(nt*a*3/4,R/2),e.utils.svgPaths.point(nt*a,R)])+e.utils.svgPaths.line([e.utils.svgPaths.point(nt*a,h)])+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/4,R/2),e.utils.svgPaths.point(nt*a/2,R),e.utils.svgPaths.point(nt*a,R)])+e.utils.svgPaths.lineOnAxis("h",nt*r)+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/2,0),e.utils.svgPaths.point(nt*a*3/4,-R/2),e.utils.svgPaths.point(nt*a,-R)])+e.utils.svgPaths.line([e.utils.svgPaths.point(nt*a,-h)])+e.utils.svgPaths.curve("c",[e.utils.svgPaths.point(nt*a/4,-R/2),e.utils.svgPaths.point(nt*a/2,-R),e.utils.svgPaths.point(nt*a,-R)])}var n=this.NOTCH_WIDTH,o=this.NOTCH_HEIGHT,r=n/3,a=r/3,h=o/2,R=h/2,L=t(1),W=t(-1);return{type:this.SHAPES.NOTCH,width:n,height:o,pathLeft:L,pathRight:W}},e.zelos.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS,n=e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(-t,t)),o=e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(-t,t));return{width:t,height:t,pathTop:n,pathBottom:e.utils.svgPaths.arc("a","0 0,0",t,e.utils.svgPaths.point(t,t)),rightWidth:t,rightHeight:t,pathTopRight:o,pathBottomRight:e.utils.svgPaths.arc("a","0 0,1",t,e.utils.svgPaths.point(t,t))}},e.zelos.ConstantProvider.prototype.generateSecondaryColour_=function(t){return e.utils.colour.blend("#000",t,.15)||t},e.zelos.ConstantProvider.prototype.generateTertiaryColour_=function(t){return e.utils.colour.blend("#000",t,.25)||t},e.zelos.ConstantProvider.prototype.createDom=function(t,n,o){e.zelos.ConstantProvider.superClass_.createDom.call(this,t,n,o),t=e.utils.dom.createSvgElement(e.utils.Svg.DEFS,{},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},n),o=e.utils.dom.createSvgElement(e.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},o),e.utils.dom.createSvgElement(e.utils.Svg.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},n),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},n),this.selectedGlowFilterId=n.id,this.selectedGlowFilter_=n,t=e.utils.dom.createSvgElement(e.utils.Svg.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},t),n=e.utils.dom.createSvgElement(e.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),e.utils.dom.createSvgElement(e.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},n),e.utils.dom.createSvgElement(e.utils.Svg.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),e.utils.dom.createSvgElement(e.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},t),this.replacementGlowFilterId=t.id,this.replacementGlowFilter_=t},e.zelos.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText,",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect:not(.blocklyDropdownRect),",t+" .blocklyEditableText>rect:not(.blocklyDropdownRect) {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text,",t+" .blocklyNonEditableText>g>text,",t+" .blocklyEditableText>g>text {","fill: #575E75;","}",t+" .blocklyFlyoutLabelText {","fill: #575E75;","}",t+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>rect,",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","color: #575E75;","}",t+" .blocklyDropdownText {","fill: #fff !important;","}",t+".blocklyWidgetDiv .goog-menuitem,",t+".blocklyDropDownDiv .goog-menuitem {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","}",t+".blocklyDropDownDiv .goog-menuitem-content {","color: #fff;","}",t+" .blocklyHighlightedConnectionPath {","stroke: "+this.SELECTED_GLOW_COLOUR+";","}",t+" .blocklyDisabled > .blocklyOutlinePath {","fill: url(#blocklyDisabledPattern"+this.randomIdentifier+")","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},e.zelos.TopRow=function(t){e.zelos.TopRow.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.zelos.TopRow,e.blockRendering.TopRow),e.zelos.TopRow.prototype.endsWithElemSpacer=function(){return!1},e.zelos.TopRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection||(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection},e.zelos.TopRow.prototype.hasRightSquareCorner=function(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection},e.zelos.BottomRow=function(t){e.zelos.BottomRow.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.zelos.BottomRow,e.blockRendering.BottomRow),e.zelos.BottomRow.prototype.endsWithElemSpacer=function(){return!1},e.zelos.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection},e.zelos.BottomRow.prototype.hasRightSquareCorner=function(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection},e.zelos.RightConnectionShape=function(t){e.zelos.RightConnectionShape.superClass_.constructor.call(this,t),this.type|=e.blockRendering.Types.getType("RIGHT_CONNECTION"),this.width=this.height=0},e.utils.object.inherits(e.zelos.RightConnectionShape,e.blockRendering.Measurable),e.zelos.RenderInfo=function(t,n){e.zelos.RenderInfo.superClass_.constructor.call(this,t,n),this.topRow=new e.zelos.TopRow(this.constants_),this.bottomRow=new e.zelos.BottomRow(this.constants_),this.isInline=!0,this.isMultiRow=!n.getInputsInline()||n.isCollapsed(),this.hasStatementInput=0<n.statementInputCount,this.rightSide=this.outputConnection?new e.zelos.RightConnectionShape(this.constants_):null},e.utils.object.inherits(e.zelos.RenderInfo,e.blockRendering.RenderInfo),e.zelos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},e.zelos.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},e.zelos.RenderInfo.prototype.shouldStartNewRow_=function(t,n){return!!n&&(t.type==e.inputTypes.STATEMENT||n.type==e.inputTypes.STATEMENT||(t.type==e.inputTypes.VALUE||t.type==e.inputTypes.DUMMY)&&(!this.isInline||this.isMultiRow))},e.zelos.RenderInfo.prototype.getDesiredRowWidth_=function(t){return t.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):e.zelos.RenderInfo.superClass_.getDesiredRowWidth_.call(this,t)},e.zelos.RenderInfo.prototype.getInRowSpacing_=function(t,n){return t&&n||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!t&&n&&e.blockRendering.Types.isStatementInput(n)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:t&&e.blockRendering.Types.isLeftRoundedCorner(t)&&n&&(e.blockRendering.Types.isPreviousConnection(n)||e.blockRendering.Types.isNextConnection(n))?n.notchOffset-this.constants_.CORNER_RADIUS:t&&e.blockRendering.Types.isLeftSquareCorner(t)&&n&&e.blockRendering.Types.isHat(n)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING},e.zelos.RenderInfo.prototype.getSpacerRowHeight_=function(t,n){if(e.blockRendering.Types.isTopRow(t)&&e.blockRendering.Types.isBottomRow(n))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;var o=e.blockRendering.Types.isInputRow(t)&&t.hasStatement,r=e.blockRendering.Types.isInputRow(n)&&n.hasStatement;return r||o?(t=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),r&&o?Math.max(t,this.constants_.DUMMY_INPUT_MIN_HEIGHT):t):e.blockRendering.Types.isTopRow(t)?t.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):e.blockRendering.Types.isBottomRow(n)?this.outputConnection?!n.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},e.zelos.RenderInfo.prototype.getSpacerRowWidth_=function(t,n){var o=this.width-this.startX;return e.blockRendering.Types.isInputRow(t)&&t.hasStatement||e.blockRendering.Types.isInputRow(n)&&n.hasStatement?Math.max(o,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):o},e.zelos.RenderInfo.prototype.getElemCenterline_=function(t,n){if(t.hasStatement&&!e.blockRendering.Types.isSpacer(n)&&!e.blockRendering.Types.isStatementInput(n))return t.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(e.blockRendering.Types.isInlineInput(n)){var o=n.connectedBlock;if(o&&o.outputConnection&&o.nextConnection)return t.yPos+o.height/2}return e.zelos.RenderInfo.superClass_.getElemCenterline_.call(this,t,n)},e.zelos.RenderInfo.prototype.addInput_=function(t,n){t.type==e.inputTypes.DUMMY&&n.hasDummyInput&&n.align==e.constants.ALIGN.LEFT&&t.align==e.constants.ALIGN.RIGHT&&(n.rightAlignedDummyInput=t),e.zelos.RenderInfo.superClass_.addInput_.call(this,t,n)},e.zelos.RenderInfo.prototype.addAlignmentPadding_=function(t,n){if(t.rightAlignedDummyInput){for(var o,a,r=0;(a=t.elements[r])&&(e.blockRendering.Types.isSpacer(a)&&(o=a),!e.blockRendering.Types.isField(a)||a.parentInput!=t.rightAlignedDummyInput);r++);if(o)return o.width+=n,void(t.width+=n)}e.zelos.RenderInfo.superClass_.addAlignmentPadding_.call(this,t,n)},e.zelos.RenderInfo.prototype.adjustXPosition_=function(){for(var t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH,n=t,o=2;o<this.rows.length-1;o+=2){var r=this.rows[o-1],a=this.rows[o],h=this.rows[o+1];if(r=2==o?!!this.topRow.hasPreviousConnection:!!r.followsStatement,h=o+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!h.precedesStatement,e.blockRendering.Types.isInputRow(a)&&a.hasStatement)a.measure(),n=a.width-a.getLastInput().width+t;else if(r&&(2==o||h)&&e.blockRendering.Types.isInputRow(a)&&!a.hasStatement){h=a.xPos,r=null;for(var L,R=0;L=a.elements[R];R++)e.blockRendering.Types.isSpacer(L)&&(r=L),!(r&&(e.blockRendering.Types.isField(L)||e.blockRendering.Types.isInput(L))&&h<n)||e.blockRendering.Types.isField(L)&&(L.field instanceof e.FieldLabel||L.field instanceof e.FieldImage)||(r.width+=n-h),h+=L.width}}},e.zelos.RenderInfo.prototype.finalizeOutputConnection_=function(){if(this.outputConnection&&this.outputConnection.isDynamicShape){for(var o,t=0,n=0;o=this.rows[n];n++)o.yPos=t,t+=o.height;this.height=t,t=this.outputConnection.shape.height(n=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height),n=this.outputConnection.shape.width(n),this.outputConnection.height=t,this.outputConnection.width=n,this.outputConnection.startX=n,this.outputConnection.connectionOffsetY=this.outputConnection.shape.connectionOffsetY(t),this.outputConnection.connectionOffsetX=this.outputConnection.shape.connectionOffsetX(n),o=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(o=n,this.rightSide.height=t,this.rightSide.width=o,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+o),this.startX=n,this.width+=n+o,this.widthWithChildren+=n+o}},e.zelos.RenderInfo.prototype.finalizeHorizontalAlignment_=function(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var o,t=0,n=0;o=this.rows[n];n++)if(e.blockRendering.Types.isInputRow(o)){t=o.elements[o.elements.length-2];var r=this.getNegativeSpacing_(o.elements[1]),a=this.getNegativeSpacing_(t),h=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-(t=r+a)<h&&(r=(t=this.width-h)/2,a=t/2),o.elements.unshift(new e.blockRendering.InRowSpacer(this.constants_,-r)),o.elements.push(new e.blockRendering.InRowSpacer(this.constants_,-a))}if(t)for(this.width-=t,this.widthWithChildren-=t,this.rightSide.xPos-=t,n=0;o=this.rows[n];n++)e.blockRendering.Types.isTopOrBottomRow(o)&&(o.elements[1].width-=t,o.elements[1].widthWithConnectedBlocks-=t),o.width-=t,o.widthWithConnectedBlocks-=t}},e.zelos.RenderInfo.prototype.getNegativeSpacing_=function(t){if(!t)return 0;var n=this.outputConnection.width,o=this.outputConnection.shape.type,r=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)return o===r.SHAPES.ROUND?n-(o=this.height/2>(o=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH)?o:this.height/2)*(1-Math.sin(Math.acos((o-this.constants_.SMALL_PADDING)/o))):0;if(e.blockRendering.Types.isInlineInput(t)){var a=t.connectedBlock;return t=a?a.pathObject.outputShapeType:t.shape.type,a&&a.outputConnection&&(a.statementInputCount||a.nextConnection)||o==r.SHAPES.HEXAGONAL&&o!=t?0:n-this.constants_.SHAPE_IN_SHAPE_PADDING[o][t]}return e.blockRendering.Types.isField(t)?o==r.SHAPES.ROUND&&t.field instanceof e.FieldTextInput?n-2.75*r.GRID_UNIT:n-this.constants_.SHAPE_IN_SHAPE_PADDING[o][0]:e.blockRendering.Types.isIcon(t)?this.constants_.SMALL_PADDING:0},e.zelos.RenderInfo.prototype.finalizeVerticalAlignment_=function(){if(!this.outputConnection)for(var t=2;t<this.rows.length-1;t+=2){var n=this.rows[t-1],o=this.rows[t],r=this.rows[t+1],a=2==t,h=t+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!r.precedesStatement;if(a?this.topRow.hasPreviousConnection:n.followsStatement){var R=3==o.elements.length&&(o.elements[1].field instanceof e.FieldLabel||o.elements[1].field instanceof e.FieldImage);if(!a&&R)n.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.MEDIUM_PADDING;else if(a||h){if(h){for(a=!1,h=0;R=o.elements[h];h++)if(e.blockRendering.Types.isInlineInput(R)&&R.connectedBlock&&!R.connectedBlock.isShadow()&&40<=R.connectedBlock.getHeightWidth().height){a=!0;break}a&&(n.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.SMALL_PADDING)}}else n.height+=this.constants_.SMALL_PADDING}}},e.zelos.RenderInfo.prototype.finalize_=function(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),e.zelos.RenderInfo.superClass_.finalize_.call(this),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)},e.zelos.Drawer=function(t,n){e.zelos.Drawer.superClass_.constructor.call(this,t,n)},e.utils.object.inherits(e.zelos.Drawer,e.blockRendering.Drawer),e.zelos.Drawer.prototype.draw=function(){var t=this.block_.pathObject;t.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),t.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&t.flipRTL(),e.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_(),this.info_.outputConnection&&(t.outputShapeType=this.info_.outputConnection.shape.type),t.endDrawing()},e.zelos.Drawer.prototype.drawOutline_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):e.zelos.Drawer.superClass_.drawOutline_.call(this)},e.zelos.Drawer.prototype.drawLeft_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():e.zelos.Drawer.superClass_.drawLeft_.call(this)},e.zelos.Drawer.prototype.drawRightSideRow_=function(t){if(!(0>=t.height))if(t.precedesStatement||t.followsStatement){var n=this.constants_.INSIDE_CORNERS.rightHeight;this.outlinePath_+=(t.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<(n=t.height-(t.precedesStatement?n:0))?e.utils.svgPaths.lineOnAxis("V",t.yPos+n):"")+(t.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},e.zelos.Drawer.prototype.drawRightDynamicConnection_=function(){this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)},e.zelos.Drawer.prototype.drawLeftDynamicConnection_=function(){this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"},e.zelos.Drawer.prototype.drawFlatTop_=function(){var t=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=e.utils.svgPaths.moveBy(t.xPos,this.info_.startY),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("h",t.width)},e.zelos.Drawer.prototype.drawFlatBottom_=function(){var t=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("V",t.baseline),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("h",-t.width)},e.zelos.Drawer.prototype.drawInlineInput_=function(t){this.positionInlineInputConnection_(t);var n=t.input.name;if(!t.connectedBlock&&!this.info_.isInsertionMarker){var o=t.width-2*t.connectionWidth;t=e.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-t.height/2)+e.utils.svgPaths.lineOnAxis("h",o)+t.shape.pathRightDown(t.height)+e.utils.svgPaths.lineOnAxis("h",-o)+t.shape.pathUp(t.height)+"z",this.block_.pathObject.setOutlinePath(n,t)}},e.zelos.Drawer.prototype.drawStatementInput_=function(t){var n=t.getLastInput(),o=n.xPos+n.notchOffset+n.shape.width,r=n.shape.pathRight+e.utils.svgPaths.lineOnAxis("h",-(n.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,a=t.height-2*this.constants_.INSIDE_CORNERS.height;n=this.constants_.INSIDE_CORNERS.pathBottom+e.utils.svgPaths.lineOnAxis("h",n.notchOffset-this.constants_.INSIDE_CORNERS.width)+(n.connectedBottomNextConnection?"":n.shape.pathLeft),this.outlinePath_+=e.utils.svgPaths.lineOnAxis("H",o)+r+e.utils.svgPaths.lineOnAxis("v",a)+n+e.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},e.zelos.MarkerSvg=function(t,n,o){e.zelos.MarkerSvg.superClass_.constructor.call(this,t,n,o)},e.utils.object.inherits(e.zelos.MarkerSvg,e.blockRendering.MarkerSvg),e.zelos.MarkerSvg.prototype.showWithInputOutput_=function(t){var n=t.getSourceBlock();t=t.getLocation().getOffsetInBlock(),this.positionCircle_(t.x,t.y),this.setParent_(n),this.showCurrent_()},e.zelos.MarkerSvg.prototype.showWithOutput_=function(t){this.showWithInputOutput_(t)},e.zelos.MarkerSvg.prototype.showWithInput_=function(t){this.showWithInputOutput_(t)},e.zelos.MarkerSvg.prototype.showWithBlock_=function(t){var n=(t=t.getLocation()).getHeightWidth();this.positionRect_(0,0,n.width,n.height),this.setParent_(t),this.showCurrent_()},e.zelos.MarkerSvg.prototype.positionCircle_=function(t,n){this.markerCircle_.setAttribute("cx",t),this.markerCircle_.setAttribute("cy",n),this.currentMarkerSvg=this.markerCircle_},e.zelos.MarkerSvg.prototype.hide=function(){e.zelos.MarkerSvg.superClass_.hide.call(this),this.markerCircle_.style.display="none"},e.zelos.MarkerSvg.prototype.createDomInternal_=function(){if(e.zelos.MarkerSvg.superClass_.createDomInternal_.call(this),this.markerCircle_=e.utils.dom.createSvgElement(e.utils.Svg.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var t=this.getBlinkProperties_();e.utils.dom.createSvgElement(e.utils.Svg.ANIMATE,t,this.markerCircle_)}return this.markerSvg_},e.zelos.MarkerSvg.prototype.applyColour_=function(t){e.zelos.MarkerSvg.superClass_.applyColour_.call(this,t),this.markerCircle_.setAttribute("fill",this.colour_),this.markerCircle_.setAttribute("stroke",this.colour_),this.isCursor()&&this.markerCircle_.firstChild.setAttribute("values",this.colour_+";transparent;transparent;")},e.zelos.PathObject=function(t,n,o){e.zelos.PathObject.superClass_.constructor.call(this,t,n,o),this.constants=o,this.svgPathSelected_=null,this.outlines_=Object.create(null),this.outputShapeType=this.remainingOutlines_=null},e.utils.object.inherits(e.zelos.PathObject,e.blockRendering.PathObject),e.zelos.PathObject.prototype.setPath=function(t){e.zelos.PathObject.superClass_.setPath.call(this,t),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",t)},e.zelos.PathObject.prototype.applyColour=function(t){for(var n in e.zelos.PathObject.superClass_.applyColour.call(this,t),t.isShadow()&&t.getParent()&&this.svgPath.setAttribute("stroke",t.getParent().style.colourTertiary),this.outlines_)this.outlines_[n].setAttribute("fill",this.style.colourTertiary)},e.zelos.PathObject.prototype.flipRTL=function(){for(var t in e.zelos.PathObject.superClass_.flipRTL.call(this),this.outlines_)this.outlines_[t].setAttribute("transform","scale(-1 1)")},e.zelos.PathObject.prototype.updateSelected=function(t){this.setClass_("blocklySelected",t),t?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(!0),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)},e.zelos.PathObject.prototype.updateReplacementFade=function(t){this.setClass_("blocklyReplaceable",t),t?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")},e.zelos.PathObject.prototype.updateShapeForInputHighlight=function(t,n){t=t.getParentInput().name,(t=this.getOutlinePath_(t))&&(n?t.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):t.removeAttribute("filter"))},e.zelos.PathObject.prototype.beginDrawing=function(){for(var t in this.remainingOutlines_=Object.create(null),this.outlines_)this.remainingOutlines_[t]=1},e.zelos.PathObject.prototype.endDrawing=function(){if(this.remainingOutlines_)for(var t in this.remainingOutlines_)this.removeOutlinePath_(t);this.remainingOutlines_=null},e.zelos.PathObject.prototype.setOutlinePath=function(t,n){(t=this.getOutlinePath_(t)).setAttribute("d",n),t.setAttribute("fill",this.style.colourTertiary)},e.zelos.PathObject.prototype.getOutlinePath_=function(t){return this.outlines_[t]||(this.outlines_[t]=e.utils.dom.createSvgElement(e.utils.Svg.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines_&&delete this.remainingOutlines_[t],this.outlines_[t]},e.zelos.PathObject.prototype.removeOutlinePath_=function(t){this.outlines_[t].parentNode.removeChild(this.outlines_[t]),delete this.outlines_[t]},e.zelos.Renderer=function(t){e.zelos.Renderer.superClass_.constructor.call(this,t)},e.utils.object.inherits(e.zelos.Renderer,e.blockRendering.Renderer),e.zelos.Renderer.prototype.makeConstants_=function(){return new e.zelos.ConstantProvider},e.zelos.Renderer.prototype.makeRenderInfo_=function(t){return new e.zelos.RenderInfo(this,t)},e.zelos.Renderer.prototype.makeDrawer_=function(t,n){return new e.zelos.Drawer(t,n)},e.zelos.Renderer.prototype.makeMarkerDrawer=function(t,n){return new e.zelos.MarkerSvg(t,this.getConstants(),n)},e.zelos.Renderer.prototype.makePathObject=function(t,n){return new e.zelos.PathObject(t,n,this.getConstants())},e.zelos.Renderer.prototype.shouldHighlightConnection=function(t){return t.type!=e.connectionTypes.INPUT_VALUE&&t.type!==e.connectionTypes.OUTPUT_VALUE},e.zelos.Renderer.prototype.getConnectionPreviewMethod=function(t,n,o){return n.type==e.connectionTypes.OUTPUT_VALUE?t.isConnected()?e.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:e.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:e.zelos.Renderer.superClass_.getConnectionPreviewMethod(t,n,o)},e.blockRendering.register("zelos",e.zelos.Renderer),e.Themes.Dark=e.Theme.defineTheme("dark",{base:e.Themes.Classic,componentStyles:{workspaceBackgroundColour:"#1e1e1e",toolboxBackgroundColour:"blackBackground",toolboxForegroundColour:"#fff",flyoutBackgroundColour:"#252526",flyoutForegroundColour:"#ccc",flyoutOpacity:1,scrollbarColour:"#797979",insertionMarkerColour:"#fff",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#d0d0d0",blackBackground:"#333"}}),e.Themes.Deuteranopia={},e.Themes.Deuteranopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#f2a72c",colourSecondary:"#f1c172",colourTertiary:"#da921c"},list_blocks:{colourPrimary:"#7d65ab",colourSecondary:"#a88be0",colourTertiary:"#66518e"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#795a07",colourSecondary:"#ac8726",colourTertiary:"#c4a03f"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"},variable_dynamic_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"}},e.Themes.Deuteranopia.categoryStyles={colour_category:{colour:"#f2a72c"},list_category:{colour:"#7d65ab"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#795a07"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#47025a"},variable_dynamic_category:{colour:"#47025a"}},e.Themes.Deuteranopia=new e.Theme("deuteranopia",e.Themes.Deuteranopia.defaultBlockStyles,e.Themes.Deuteranopia.categoryStyles),e.Themes.HighContrast={},e.Themes.HighContrast.defaultBlockStyles={colour_blocks:{colourPrimary:"#a52714",colourSecondary:"#FB9B8C",colourTertiary:"#FBE1DD"},list_blocks:{colourPrimary:"#4a148c",colourSecondary:"#AD7BE9",colourTertiary:"#CDB6E9"},logic_blocks:{colourPrimary:"#01579b",colourSecondary:"#64C7FF",colourTertiary:"#C5EAFF"},loop_blocks:{colourPrimary:"#33691e",colourSecondary:"#9AFF78",colourTertiary:"#E1FFD7"},math_blocks:{colourPrimary:"#1a237e",colourSecondary:"#8A9EFF",colourTertiary:"#DCE2FF"},procedure_blocks:{colourPrimary:"#006064",colourSecondary:"#77E6EE",colourTertiary:"#CFECEE"},text_blocks:{colourPrimary:"#004d40",colourSecondary:"#5ae27c",colourTertiary:"#D2FFDD"},variable_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},variable_dynamic_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},hat_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB",hat:"cap"}},e.Themes.HighContrast.categoryStyles={colour_category:{colour:"#a52714"},list_category:{colour:"#4a148c"},logic_category:{colour:"#01579b"},loop_category:{colour:"#33691e"},math_category:{colour:"#1a237e"},procedure_category:{colour:"#006064"},text_category:{colour:"#004d40"},variable_category:{colour:"#880e4f"},variable_dynamic_category:{colour:"#880e4f"}},e.Themes.HighContrast=new e.Theme("highcontrast",e.Themes.HighContrast.defaultBlockStyles,e.Themes.HighContrast.categoryStyles),e.Themes.HighContrast.setComponentStyle("selectedGlowColour","#000000"),e.Themes.HighContrast.setComponentStyle("selectedGlowSize",1),e.Themes.HighContrast.setComponentStyle("replacementGlowColour","#000000"),e.Themes.HighContrast.setFontStyle({family:null,weight:null,size:16}),e.Themes.Tritanopia={},e.Themes.Tritanopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#05427f",colourSecondary:"#2974c0",colourTertiary:"#2d74bb"},list_blocks:{colourPrimary:"#b69ce8",colourSecondary:"#ccbaef",colourTertiary:"#9176c5"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#aa1846",colourSecondary:"#d36185",colourTertiary:"#7c1636"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"},variable_dynamic_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"}},e.Themes.Tritanopia.categoryStyles={colour_category:{colour:"#05427f"},list_category:{colour:"#b69ce8"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#aa1846"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#4b2d84"},variable_dynamic_category:{colour:"#4b2d84"}},e.Themes.Tritanopia=new e.Theme("tritanopia",e.Themes.Tritanopia.defaultBlockStyles,e.Themes.Tritanopia.categoryStyles),e.requires={},e}.apply(X,[]))&&(B.exports=m)},24773:function(B,X,_){var m,e;m=[_(93677)],void 0!==(e=function(t){"use strict";return t.Blocks={},t.Blocks}.apply(X,m))&&(B.exports=e)},93677:function(B,X,_){var m,e;m=[_(46251)],void 0!==(e=function(t){"use strict";return t.Blocks.colour={},t.Constants={},t.Constants.Colour={},t.Constants.Colour.HUE=20,t.defineBlocksWithJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),t.Constants.Lists={},t.Constants.Lists.HUE=260,t.defineBlocksWithJsonArray([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),t.Blocks.lists_create_with={init:function(){this.setHelpUrl(t.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new t.Mutator(["lists_create_with_item"])),this.setTooltip(t.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("items",this.itemCount_),n},domToMutation:function(n){this.itemCount_=parseInt(n.getAttribute("items"),10),this.updateShape_()},decompose:function(n){var o=n.newBlock("lists_create_with_container");o.initSvg();for(var r=o.getInput("STACK").connection,a=0;a<this.itemCount_;a++){var h=n.newBlock("lists_create_with_item");h.initSvg(),r.connect(h.previousConnection),r=h.nextConnection}return o},compose:function(n){var o=n.getInputTargetBlock("STACK");for(n=[];o&&!o.isInsertionMarker();)n.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();for(o=0;o<this.itemCount_;o++){var r=this.getInput("ADD"+o).connection.targetConnection;r&&-1==n.indexOf(r)&&r.disconnect()}for(this.itemCount_=n.length,this.updateShape_(),o=0;o<this.itemCount_;o++)t.Mutator.reconnect(n[o],this,"ADD"+o)},saveConnections:function(n){n=n.getInputTargetBlock("STACK");for(var o=0;n;){var r=this.getInput("ADD"+o);n.valueConnection_=r&&r.connection.targetConnection,o++,n=n.nextConnection&&n.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(t.Msg.LISTS_CREATE_EMPTY_TITLE);for(var n=0;n<this.itemCount_;n++)if(!this.getInput("ADD"+n)){var o=this.appendValueInput("ADD"+n).setAlign(t.ALIGN_RIGHT);0==n&&o.appendField(t.Msg.LISTS_CREATE_WITH_INPUT_WITH)}for(;this.getInput("ADD"+n);)this.removeInput("ADD"+n),n++}},t.Blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(t.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},t.Blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},t.Blocks.lists_indexOf={init:function(){var n=[[t.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[t.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(t.Msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new t.FieldDropdown(n),"END"),this.setInputsInline(!0);var o=this;this.setTooltip(function(){return t.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",o.workspace.options.oneBasedIndex?"0":"-1")})}},t.Blocks.lists_getIndex={init:function(){var n=[[t.Msg.LISTS_GET_INDEX_GET,"GET"],[t.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[t.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[t.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),n=new t.FieldDropdown(n,function(r){r="REMOVE"==r,this.getSourceBlock().updateStatement_(r)}),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(n,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),t.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);var o=this;this.setTooltip(function(){var r=o.getFieldValue("MODE"),a=o.getFieldValue("WHERE"),h="";switch(r+" "+a){case"GET FROM_START":case"GET FROM_END":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":h=t.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"==a||"FROM_END"==a)&&(h+="  "+("FROM_START"==a?t.Msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",o.workspace.options.oneBasedIndex?"#1":"#0")),h})},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");n.setAttribute("statement",!this.outputConnection);var o=this.getInput("AT").type==t.INPUT_VALUE;return n.setAttribute("at",o),n},domToMutation:function(n){var o="true"==n.getAttribute("statement");this.updateStatement_(o),n="false"!=n.getAttribute("at"),this.updateAt_(n)},updateStatement_:function(n){n!=!this.outputConnection&&(this.unplug(!0,!0),n?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(n){this.removeInput("AT"),this.removeInput("ORDINAL",!0),n?(this.appendValueInput("AT").setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var o=new t.FieldDropdown(this.WHERE_OPTIONS,function(r){var a="FROM_START"==r||"FROM_END"==r;if(a!=n){var h=this.getSourceBlock();return h.updateAt_(a),h.setFieldValue(r,"WHERE"),null}});this.getInput("AT").appendField(o,"WHERE"),t.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},t.Blocks.lists_setIndex={init:function(){var n=[[t.Msg.LISTS_SET_INDEX_SET,"SET"],[t.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[t.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new t.FieldDropdown(n),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(t.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);var o=this;this.setTooltip(function(){var r=o.getFieldValue("MODE"),a=o.getFieldValue("WHERE"),h="";switch(r+" "+a){case"SET FROM_START":case"SET FROM_END":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":h=t.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"==a||"FROM_END"==a)&&(h+="  "+t.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",o.workspace.options.oneBasedIndex?"#1":"#0")),h})},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o=this.getInput("AT").type==t.INPUT_VALUE;return n.setAttribute("at",o),n},domToMutation:function(n){n="false"!=n.getAttribute("at"),this.updateAt_(n)},updateAt_:function(n){this.removeInput("AT"),this.removeInput("ORDINAL",!0),n?(this.appendValueInput("AT").setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var o=new t.FieldDropdown(this.WHERE_OPTIONS,function(r){var a="FROM_START"==r||"FROM_END"==r;if(a!=n){var h=this.getSourceBlock();return h.updateAt_(a),h.setFieldValue(r,"WHERE"),null}});this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(o,"WHERE")}},t.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[t.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[t.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[t.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(t.Msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o=this.getInput("AT1").type==t.INPUT_VALUE;return n.setAttribute("at1",o),o=this.getInput("AT2").type==t.INPUT_VALUE,n.setAttribute("at2",o),n},domToMutation:function(n){var o="true"==n.getAttribute("at1");n="true"==n.getAttribute("at2"),this.updateAt_(1,o),this.updateAt_(2,n)},updateAt_:function(n,o){this.removeInput("AT"+n),this.removeInput("ORDINAL"+n,!0),o?(this.appendValueInput("AT"+n).setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+n).appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+n);var r=new t.FieldDropdown(this["WHERE_OPTIONS_"+n],function(a){var h="FROM_START"==a||"FROM_END"==a;if(h!=o){var R=this.getSourceBlock();return R.updateAt_(n,h),R.setFieldValue(a,"WHERE"+n),null}});this.getInput("AT"+n).appendField(r,"WHERE"+n),1==n&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),t.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},t.Blocks.lists_sort={init:function(){this.jsonInit({message0:t.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[t.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[t.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[t.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[t.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[t.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:t.Msg.LISTS_SORT_TOOLTIP,helpUrl:t.Msg.LISTS_SORT_HELPURL})}},t.Blocks.lists_split={init:function(){var n=this,o=new t.FieldDropdown([[t.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[t.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],function(r){n.updateType_(r)});this.setHelpUrl(t.Msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(o,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(t.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(function(){var r=n.getFieldValue("MODE");if("SPLIT"==r)return t.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"==r)return t.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+r)})},updateType_:function(n){if(this.getFieldValue("MODE")!=n){var o=this.getInput("INPUT").connection;o.setShadowDom(null);var r=o.targetBlock();r&&(o.disconnect(),r.isShadow()?r.dispose():this.bumpNeighbours())}"SPLIT"==n?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("mode",this.getFieldValue("MODE")),n},domToMutation:function(n){this.updateType_(n.getAttribute("mode"))}},t.Blocks.logic={},t.Constants.Logic={},t.Constants.Logic.HUE=210,t.defineBlocksWithJsonArray([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["\u2260","NEQ"],["\u200f<","LT"],["\u200f\u2264","LTE"],["\u200f>","GT"],["\u200f\u2265","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]}]),t.defineBlocksWithJsonArray([{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),t.Constants.Logic.TOOLTIPS_BY_OP={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"},t.Extensions.register("logic_op_tooltip",t.Extensions.buildTooltipForDropdown("OP",t.Constants.Logic.TOOLTIPS_BY_OP)),t.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN={elseifCount_:0,elseCount_:0,suppressPrefixSuffix:!0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var n=t.utils.xml.createElement("mutation");return this.elseifCount_&&n.setAttribute("elseif",this.elseifCount_),this.elseCount_&&n.setAttribute("else",1),n},domToMutation:function(n){this.elseifCount_=parseInt(n.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(n.getAttribute("else"),10)||0,this.rebuildShape_()},decompose:function(n){var o=n.newBlock("controls_if_if");o.initSvg();for(var r=o.nextConnection,a=1;a<=this.elseifCount_;a++){var h=n.newBlock("controls_if_elseif");h.initSvg(),r.connect(h.previousConnection),r=h.nextConnection}return this.elseCount_&&((n=n.newBlock("controls_if_else")).initSvg(),r.connect(n.previousConnection)),o},compose:function(n){n=n.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;for(var o=[null],r=[null],a=null;n&&!n.isInsertionMarker();){switch(n.type){case"controls_if_elseif":this.elseifCount_++,o.push(n.valueConnection_),r.push(n.statementConnection_);break;case"controls_if_else":this.elseCount_++,a=n.statementConnection_;break;default:throw TypeError("Unknown block type: "+n.type)}n=n.nextConnection&&n.nextConnection.targetBlock()}this.updateShape_(),this.reconnectChildBlocks_(o,r,a)},saveConnections:function(n){n=n.nextConnection.targetBlock();for(var o=1;n;){switch(n.type){case"controls_if_elseif":var r=this.getInput("IF"+o),a=this.getInput("DO"+o);n.valueConnection_=r&&r.connection.targetConnection,n.statementConnection_=a&&a.connection.targetConnection,o++;break;case"controls_if_else":a=this.getInput("ELSE"),n.statementConnection_=a&&a.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+n.type)}n=n.nextConnection&&n.nextConnection.targetBlock()}},rebuildShape_:function(){var n=[null],o=[null],r=null;this.getInput("ELSE")&&(r=this.getInput("ELSE").connection.targetConnection);for(var a=1;this.getInput("IF"+a);){var h=this.getInput("IF"+a),R=this.getInput("DO"+a);n.push(h.connection.targetConnection),o.push(R.connection.targetConnection),a++}this.updateShape_(),this.reconnectChildBlocks_(n,o,r)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var n=1;this.getInput("IF"+n);)this.removeInput("IF"+n),this.removeInput("DO"+n),n++;for(n=1;n<=this.elseifCount_;n++)this.appendValueInput("IF"+n).setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+n).appendField(t.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(t.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(n,o,r){for(var a=1;a<=this.elseifCount_;a++)t.Mutator.reconnect(n[a],this,"IF"+a),t.Mutator.reconnect(o[a],this,"DO"+a);t.Mutator.reconnect(r,this,"ELSE")}},t.Extensions.registerMutator("controls_if_mutator",t.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN,null,["controls_if_elseif","controls_if_else"]),t.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?t.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?t.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?t.Msg.CONTROLS_IF_TOOLTIP_4:"":t.Msg.CONTROLS_IF_TOOLTIP_1}.bind(this))},t.Extensions.register("controls_if_tooltip",t.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION),t.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN={onchange:function(n){this.prevBlocks_||(this.prevBlocks_=[null,null]);var o=this.getInputTargetBlock("A"),r=this.getInputTargetBlock("B");o&&r&&!this.workspace.connectionChecker.doTypeChecks(o.outputConnection,r.outputConnection)&&(t.Events.setGroup(n.group),(n=this.prevBlocks_[0])!==o&&(o.unplug(),!n||n.isDisposed()||n.isShadow()||this.getInput("A").connection.connect(n.outputConnection)),(o=this.prevBlocks_[1])!==r&&(r.unplug(),!o||o.isDisposed()||o.isShadow()||this.getInput("B").connection.connect(o.outputConnection)),this.bumpNeighbours(),t.Events.setGroup(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},t.Constants.Logic.LOGIC_COMPARE_EXTENSION=function(){this.mixin(t.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN)},t.Extensions.register("logic_compare",t.Constants.Logic.LOGIC_COMPARE_EXTENSION),t.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN={prevParentConnection_:null,onchange:function(n){var o=this.getInputTargetBlock("THEN"),r=this.getInputTargetBlock("ELSE"),a=this.outputConnection.targetConnection;if((o||r)&&a)for(var h=0;2>h;h++){var R=1==h?o:r;R&&!R.workspace.connectionChecker.doTypeChecks(R.outputConnection,a)&&(t.Events.setGroup(n.group),a===this.prevParentConnection_?(this.unplug(),a.getSourceBlock().bumpNeighbours()):(R.unplug(),R.bumpNeighbours()),t.Events.setGroup(!1))}this.prevParentConnection_=a}},t.Extensions.registerMixin("logic_ternary",t.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN),t.Blocks.loops={},t.Constants.Loops={},t.Constants.Loops.HUE=120,t.defineBlocksWithJsonArray([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),t.Constants.Loops.WHILE_UNTIL_TOOLTIPS={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"},t.Extensions.register("controls_whileUntil_tooltip",t.Extensions.buildTooltipForDropdown("MODE",t.Constants.Loops.WHILE_UNTIL_TOOLTIPS)),t.Constants.Loops.BREAK_CONTINUE_TOOLTIPS={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"},t.Extensions.register("controls_flow_tooltip",t.Extensions.buildTooltipForDropdown("FLOW",t.Constants.Loops.BREAK_CONTINUE_TOOLTIPS)),t.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN={customContextMenu:function(n){if(!this.isInFlyout){var o=this.getField("VAR").getVariable(),r=o.name;if(!this.isCollapsed()&&null!=r){var a={enabled:!0};a.text=t.Msg.VARIABLES_SET_CREATE_GET.replace("%1",r),o=t.Variables.generateVariableFieldDom(o),(r=t.utils.xml.createElement("block")).setAttribute("type","variables_get"),r.appendChild(o),a.callback=t.ContextMenu.callbackFactory(this,r),n.push(a)}}}},t.Extensions.registerMixin("contextMenu_newGetVariableBlock",t.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN),t.Extensions.register("controls_for_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),t.Extensions.register("controls_forEach_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN={LOOP_TYPES:["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"],suppressPrefixSuffix:!0,getSurroundLoop:function(n){do{if(-1!=t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.LOOP_TYPES.indexOf(n.type))return n;n=n.getSurroundParent()}while(n);return null},onchange:function(n){if(this.workspace.isDragging&&!this.workspace.isDragging()&&n.type==t.Events.BLOCK_MOVE){var o=t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(this);if(this.setWarningText(o?null:t.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){var r=t.Events.getGroup();t.Events.setGroup(n.group),this.setEnabled(o),t.Events.setGroup(r)}}}},t.Extensions.registerMixin("controls_flow_in_loop_check",t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN),t.Blocks.math={},t.Constants.Math={},t.Constants.Math.HUE=230,t.defineBlocksWithJsonArray([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["\u03c0","PI"],["e","E"],["\u03c6","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(\xbd)","SQRT1_2"],["\u221e","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),t.Constants.Math.TOOLTIPS_BY_OP={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"},t.Extensions.register("math_op_tooltip",t.Extensions.buildTooltipForDropdown("OP",t.Constants.Math.TOOLTIPS_BY_OP)),t.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN={mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o="DIVISIBLE_BY"==this.getFieldValue("PROPERTY");return n.setAttribute("divisor_input",o),n},domToMutation:function(n){n="true"==n.getAttribute("divisor_input"),this.updateShape_(n)},updateShape_:function(n){var o=this.getInput("DIVISOR");n?o||this.appendValueInput("DIVISOR").setCheck("Number"):o&&this.removeInput("DIVISOR")}},t.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION=function(){this.getField("PROPERTY").setValidator(function(n){n="DIVISIBLE_BY"==n,this.getSourceBlock().updateShape_(n)})},t.Extensions.registerMutator("math_is_divisibleby_mutator",t.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN,t.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION),t.Extensions.register("math_change_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),t.Constants.Math.LIST_MODES_MUTATOR_MIXIN={updateType_:function(n){this.outputConnection.setCheck("MODE"==n?"Array":"Number")},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("op",this.getFieldValue("OP")),n},domToMutation:function(n){this.updateType_(n.getAttribute("op"))}},t.Constants.Math.LIST_MODES_MUTATOR_EXTENSION=function(){this.getField("OP").setValidator(function(n){this.updateType_(n)}.bind(this))},t.Extensions.registerMutator("math_modes_of_list_mutator",t.Constants.Math.LIST_MODES_MUTATOR_MIXIN,t.Constants.Math.LIST_MODES_MUTATOR_EXTENSION),t.Blocks.procedures={},t.Blocks.procedures_defnoreturn={init:function(){var n=t.Procedures.findLegalName("",this);(n=new t.FieldTextInput(n,t.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(n,"NAME").appendField("","PARAMS"),this.setMutator(new t.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(t.Msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(t.Msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:function(n){this.hasStatements_!==n&&(n?(this.appendStatementInput("STACK").appendField(t.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=n)},updateParams_:function(){var n="";this.arguments_.length&&(n=t.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),t.Events.disable();try{this.setFieldValue(n,"PARAMS")}finally{t.Events.enable()}},mutationToDom:function(n){var o=t.utils.xml.createElement("mutation");n&&o.setAttribute("name",this.getFieldValue("NAME"));for(var r=0;r<this.argumentVarModels_.length;r++){var a=t.utils.xml.createElement("arg"),h=this.argumentVarModels_[r];a.setAttribute("name",h.name),a.setAttribute("varid",h.getId()),n&&this.paramIds_&&a.setAttribute("paramId",this.paramIds_[r]),o.appendChild(a)}return this.hasStatements_||o.setAttribute("statements","false"),o},domToMutation:function(n){this.arguments_=[],this.argumentVarModels_=[];for(var r,o=0;r=n.childNodes[o];o++)if("arg"==r.nodeName.toLowerCase()){var a=r.getAttribute("name");r=r.getAttribute("varid")||r.getAttribute("varId"),this.arguments_.push(a),null!=(r=t.Variables.getOrCreateVariablePackage(this.workspace,r,a,""))?this.argumentVarModels_.push(r):console.log("Failed to create a variable with name "+a+", ignoring.")}this.updateParams_(),t.Procedures.mutateCallers(this),this.setStatements_("false"!==n.getAttribute("statements"))},decompose:function(n){var o=t.utils.xml.createElement("block");o.setAttribute("type","procedures_mutatorcontainer");var r=t.utils.xml.createElement("statement");r.setAttribute("name","STACK"),o.appendChild(r);for(var a=0;a<this.arguments_.length;a++){var h=t.utils.xml.createElement("block");h.setAttribute("type","procedures_mutatorarg");var R=t.utils.xml.createElement("field");R.setAttribute("name","NAME");var L=t.utils.xml.createTextNode(this.arguments_[a]);R.appendChild(L),h.appendChild(R),R=t.utils.xml.createElement("next"),h.appendChild(R),r.appendChild(h),r=R}return n=t.Xml.domToBlock(o,n),"procedures_defreturn"==this.type?n.setFieldValue(this.hasStatements_,"STATEMENTS"):n.removeInput("STATEMENT_INPUT"),t.Procedures.mutateCallers(this),n},compose:function(n){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];for(var o=n.getInputTargetBlock("STACK");o&&!o.isInsertionMarker();){var r=o.getFieldValue("NAME");this.arguments_.push(r),r=this.workspace.getVariable(r,""),this.argumentVarModels_.push(r),this.paramIds_.push(o.id),o=o.nextConnection&&o.nextConnection.targetBlock()}this.updateParams_(),t.Procedures.mutateCallers(this),null!==(n=n.getFieldValue("STATEMENTS"))&&this.hasStatements_!=(n="TRUE"==n)&&(n?(this.setStatements_(!0),t.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(n=this.getInput("STACK").connection,(this.statementConnection_=n.targetConnection)&&((n=n.targetBlock()).unplug(),n.bumpNeighbours()),this.setStatements_(!1)))},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(n,o){var r=this.workspace.getVariableById(n);if(""==r.type){r=r.name,o=this.workspace.getVariableById(o);for(var a=!1,h=0;h<this.argumentVarModels_.length;h++)this.argumentVarModels_[h].getId()==n&&(this.arguments_[h]=o.name,this.argumentVarModels_[h]=o,a=!0);a&&(this.displayRenamedVar_(r,o.name),t.Procedures.mutateCallers(this))}},updateVarName:function(n){for(var o=n.name,r=!1,a=0;a<this.argumentVarModels_.length;a++)if(this.argumentVarModels_[a].getId()==n.getId()){var h=this.arguments_[a];this.arguments_[a]=o,r=!0}r&&(this.displayRenamedVar_(h,o),t.Procedures.mutateCallers(this))},displayRenamedVar_:function(n,o){if(this.updateParams_(),this.mutator&&this.mutator.isVisible())for(var h,r=this.mutator.workspace_.getAllBlocks(!1),a=0;h=r[a];a++)"procedures_mutatorarg"==h.type&&t.Names.equals(n,h.getFieldValue("NAME"))&&h.setFieldValue(o,"NAME")},customContextMenu:function(n){if(!this.isInFlyout){var o={enabled:!0},r=this.getFieldValue("NAME");o.text=t.Msg.PROCEDURES_CREATE_DO.replace("%1",r);var a=t.utils.xml.createElement("mutation");for(a.setAttribute("name",r),r=0;r<this.arguments_.length;r++){var h=t.utils.xml.createElement("arg");h.setAttribute("name",this.arguments_[r]),a.appendChild(h)}if((r=t.utils.xml.createElement("block")).setAttribute("type",this.callType_),r.appendChild(a),o.callback=t.ContextMenu.callbackFactory(this,r),n.push(o),!this.isCollapsed())for(r=0;r<this.argumentVarModels_.length;r++)(o={enabled:!0}).text=t.Msg.VARIABLES_SET_CREATE_GET.replace("%1",(a=this.argumentVarModels_[r]).name),a=t.Variables.generateVariableFieldDom(a),(h=t.utils.xml.createElement("block")).setAttribute("type","variables_get"),h.appendChild(a),o.callback=t.ContextMenu.callbackFactory(this,h),n.push(o)}},callType_:"procedures_callnoreturn"},t.Blocks.procedures_defreturn={init:function(){var n=t.Procedures.findLegalName("",this);(n=new t.FieldTextInput(n,t.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(n,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(t.ALIGN_RIGHT).appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new t.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(t.Msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(t.Msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:t.Blocks.procedures_defnoreturn.setStatements_,updateParams_:t.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:t.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:t.Blocks.procedures_defnoreturn.domToMutation,decompose:t.Blocks.procedures_defnoreturn.decompose,compose:t.Blocks.procedures_defnoreturn.compose,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:t.Blocks.procedures_defnoreturn.getVars,getVarModels:t.Blocks.procedures_defnoreturn.getVarModels,renameVarById:t.Blocks.procedures_defnoreturn.renameVarById,updateVarName:t.Blocks.procedures_defnoreturn.updateVarName,displayRenamedVar_:t.Blocks.procedures_defnoreturn.displayRenamedVar_,customContextMenu:t.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"},t.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(t.Msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(t.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new t.FieldCheckbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}},t.Blocks.procedures_mutatorarg={init:function(){var n=new t.FieldTextInput(t.Procedures.DEFAULT_ARG,this.validator_);n.oldShowEditorFn_=n.showEditor_,n.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(t.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(n,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,n.onFinishEditing_=this.deleteIntermediateVars_,n.createdVariables_=[],n.onFinishEditing_("x")},validator_:function(n){var o=this.getSourceBlock(),r=t.Mutator.findParentWs(o.workspace);if(!(n=n.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;for(var a=(o.workspace.targetWorkspace||o.workspace).getAllBlocks(!1),h=n.toLowerCase(),R=0;R<a.length;R++)if(a[R].id!=this.getSourceBlock().id){var L=a[R].getFieldValue("NAME");if(L&&L.toLowerCase()==h)return null}return o.isInFlyout||((o=r.getVariable(n,""))&&o.name!=n&&r.renameVariableById(o.getId(),n),o||(o=r.createVariable(n,""))&&this.createdVariables_&&this.createdVariables_.push(o)),n},deleteIntermediateVars_:function(n){var o=t.Mutator.findParentWs(this.getSourceBlock().workspace);if(o)for(var r=0;r<this.createdVariables_.length;r++){var a=this.createdVariables_[r];a.name!=n&&o.deleteVariableById(a.getId())}}},t.Blocks.procedures_callnoreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(n,o){t.Names.equals(n,this.getProcedureCall())&&(this.setFieldValue(o,"NAME"),this.setTooltip((this.outputConnection?t.Msg.PROCEDURES_CALLRETURN_TOOLTIP:t.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",o)))},setProcedureParameters_:function(n,o){var r=t.Procedures.getDefinition(this.getProcedureCall(),this.workspace),a=r&&r.mutator&&r.mutator.isVisible();if(a||(this.quarkConnections_={},this.quarkIds_=null),o)if(n.join("\n")==this.arguments_.join("\n"))this.quarkIds_=o;else{if(o.length!=n.length)throw RangeError("paramNames and paramIds must be the same length.");this.setCollapsed(!1),this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),r=this.rendered,this.rendered=!1;for(var h=0;h<this.arguments_.length;h++){var R=this.getInput("ARG"+h);R&&(this.quarkConnections_[this.quarkIds_[h]]=R=R.connection.targetConnection,a&&R&&-1==o.indexOf(this.quarkIds_[h])&&(R.disconnect(),R.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(n),this.argumentVarModels_=[],h=0;h<this.arguments_.length;h++)n=t.Variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[h],""),this.argumentVarModels_.push(n);if(this.updateShape_(),this.quarkIds_=o)for(h=0;h<this.arguments_.length;h++)(o=this.quarkIds_[h])in this.quarkConnections_&&(t.Mutator.reconnect(R=this.quarkConnections_[o],this,"ARG"+h)||delete this.quarkConnections_[o]);(this.rendered=r)&&this.render()}},updateShape_:function(){for(var n=0;n<this.arguments_.length;n++){var o=this.getField("ARGNAME"+n);if(o){t.Events.disable();try{o.setValue(this.arguments_[n])}finally{t.Events.enable()}}else o=new t.FieldLabel(this.arguments_[n]),this.appendValueInput("ARG"+n).setAlign(t.ALIGN_RIGHT).appendField(o,"ARGNAME"+n).init()}for(;this.getInput("ARG"+n);)this.removeInput("ARG"+n),n++;(n=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(n.appendField(t.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),n.init()):this.getField("WITH")&&n.removeField("WITH"))},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");n.setAttribute("name",this.getProcedureCall());for(var o=0;o<this.arguments_.length;o++){var r=t.utils.xml.createElement("arg");r.setAttribute("name",this.arguments_[o]),n.appendChild(r)}return n},domToMutation:function(n){var o=n.getAttribute("name");this.renameProcedure(this.getProcedureCall(),o),o=[];for(var h,r=[],a=0;h=n.childNodes[a];a++)"arg"==h.nodeName.toLowerCase()&&(o.push(h.getAttribute("name")),r.push(h.getAttribute("paramId")));this.setProcedureParameters_(o,r)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(n){if(this.workspace&&!this.workspace.isFlyout&&n.recordUndo)if(n.type==t.Events.BLOCK_CREATE&&-1!=n.ids.indexOf(this.id)){var o=this.getProcedureCall();if(!(o=t.Procedures.getDefinition(o,this.workspace))||o.type==this.defType_&&JSON.stringify(o.getVars())==JSON.stringify(this.arguments_)||(o=null),!o){t.Events.setGroup(n.group),n=t.utils.xml.createElement("xml"),(o=t.utils.xml.createElement("block")).setAttribute("type",this.defType_);var r=this.getRelativeToSurfaceXY(),a=r.y+2*t.SNAP_RADIUS;o.setAttribute("x",r.x+t.SNAP_RADIUS*(this.RTL?-1:1)),o.setAttribute("y",a),r=this.mutationToDom(),o.appendChild(r),(r=t.utils.xml.createElement("field")).setAttribute("name","NAME"),(a=this.getProcedureCall())||(a=t.Procedures.findLegalName("",this),this.renameProcedure("",a)),r.appendChild(t.utils.xml.createTextNode(a)),o.appendChild(r),n.appendChild(o),t.Xml.domToWorkspace(n,this.workspace),t.Events.setGroup(!1)}}else n.type==t.Events.BLOCK_DELETE?(o=this.getProcedureCall(),(o=t.Procedures.getDefinition(o,this.workspace))||(t.Events.setGroup(n.group),this.dispose(!0),t.Events.setGroup(!1))):n.type==t.Events.CHANGE&&"disabled"==n.element&&(o=this.getProcedureCall(),(o=t.Procedures.getDefinition(o,this.workspace))&&o.id==n.blockId&&((o=t.Events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),t.Events.setGroup(n.group),n.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),t.Events.setGroup(o)))},customContextMenu:function(n){if(this.workspace.isMovable()){var o={enabled:!0};o.text=t.Msg.PROCEDURES_HIGHLIGHT_DEF;var r=this.getProcedureCall(),a=this.workspace;o.callback=function(){var h=t.Procedures.getDefinition(r,a);h&&(a.centerOnBlock(h.id),h.select())},n.push(o)}},defType_:"procedures_defnoreturn"},t.Blocks.procedures_callreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:t.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:t.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:t.Blocks.procedures_callnoreturn.setProcedureParameters_,updateShape_:t.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:t.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:t.Blocks.procedures_callnoreturn.domToMutation,getVars:t.Blocks.procedures_callnoreturn.getVars,getVarModels:t.Blocks.procedures_callnoreturn.getVarModels,onchange:t.Blocks.procedures_callnoreturn.onchange,customContextMenu:t.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defreturn"},t.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(t.Msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(t.Msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("value",Number(this.hasReturnValue_)),n},domToMutation:function(n){this.hasReturnValue_=1==n.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(n){if(this.workspace.isDragging&&!this.workspace.isDragging()){n=!1;var o=this;do{if(-1!=this.FUNCTION_TYPES.indexOf(o.type)){n=!0;break}o=o.getSurroundParent()}while(o);n?("procedures_defnoreturn"==o.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!=o.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(t.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setEnabled(!0)):(this.setWarningText(t.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setEnabled(!1))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},t.Blocks.texts={},t.Constants.Text={},t.Constants.Text.HUE=160,t.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"\xb6"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),t.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[t.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[t.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[t.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[t.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[t.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(t.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(t.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),t.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var n=t.utils.xml.createElement("mutation"),o=this.getInput("AT1").type==t.INPUT_VALUE;return n.setAttribute("at1",o),o=this.getInput("AT2").type==t.INPUT_VALUE,n.setAttribute("at2",o),n},domToMutation:function(n){var o="true"==n.getAttribute("at1");n="true"==n.getAttribute("at2"),this.updateAt_(1,o),this.updateAt_(2,n)},updateAt_:function(n,o){this.removeInput("AT"+n),this.removeInput("ORDINAL"+n,!0),o?(this.appendValueInput("AT"+n).setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+n).appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+n),2==n&&t.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg.TEXT_GET_SUBSTRING_TAIL));var r=new t.FieldDropdown(this["WHERE_OPTIONS_"+n],function(a){var h="FROM_START"==a||"FROM_END"==a;if(h!=o){var R=this.getSourceBlock();return R.updateAt_(n,h),R.setFieldValue(a,"WHERE"+n),null}});this.getInput("AT"+n).appendField(r,"WHERE"+n),1==n&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},t.Blocks.text_changeCase={init:function(){var n=[[t.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[t.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[t.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(t.Msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new t.FieldDropdown(n),"CASE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg.TEXT_CHANGECASE_TOOLTIP)}},t.Blocks.text_trim={init:function(){var n=[[t.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[t.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[t.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(t.Msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new t.FieldDropdown(n),"MODE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg.TEXT_TRIM_TOOLTIP)}},t.Blocks.text_print={init:function(){this.jsonInit({message0:t.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:t.Msg.TEXT_PRINT_TOOLTIP,helpUrl:t.Msg.TEXT_PRINT_HELPURL})}},t.Blocks.text_prompt_ext={init:function(){var n=[[t.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");var o=this;n=new t.FieldDropdown(n,function(r){o.updateType_(r)}),this.appendValueInput("TEXT").appendField(n,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==o.getFieldValue("TYPE")?t.Msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:function(n){this.outputConnection.setCheck("NUMBER"==n?"Number":"String")},mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("type",this.getFieldValue("TYPE")),n},domToMutation:function(n){this.updateType_(n.getAttribute("type"))}},t.Blocks.text_prompt={init:function(){this.mixin(t.Constants.Text.QUOTE_IMAGE_MIXIN);var n=[[t.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],o=this;this.setHelpUrl(t.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),n=new t.FieldDropdown(n,function(r){o.updateType_(r)}),this.appendDummyInput().appendField(n,"TYPE").appendField(this.newQuote_(!0)).appendField(new t.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(function(){return"TEXT"==o.getFieldValue("TYPE")?t.Msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg.TEXT_PROMPT_TOOLTIP_NUMBER})},updateType_:t.Blocks.text_prompt_ext.updateType_,mutationToDom:t.Blocks.text_prompt_ext.mutationToDom,domToMutation:t.Blocks.text_prompt_ext.domToMutation},t.Blocks.text_count={init:function(){this.jsonInit({message0:t.Msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:t.Msg.TEXT_COUNT_TOOLTIP,helpUrl:t.Msg.TEXT_COUNT_HELPURL})}},t.Blocks.text_replace={init:function(){this.jsonInit({message0:t.Msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg.TEXT_REPLACE_TOOLTIP,helpUrl:t.Msg.TEXT_REPLACE_HELPURL})}},t.Blocks.text_reverse={init:function(){this.jsonInit({message0:t.Msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg.TEXT_REVERSE_TOOLTIP,helpUrl:t.Msg.TEXT_REVERSE_HELPURL})}},t.Constants.Text.QUOTE_IMAGE_MIXIN={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(n){for(var r,o=0;r=this.inputList[o];o++)for(var h,a=0;h=r.fieldRow[a];a++)if(n==h.name)return r.insertFieldAt(a,this.newQuote_(!0)),void r.insertFieldAt(a+2,this.newQuote_(!1));console.warn('field named "'+n+'" not found in '+this.toDevString())},newQuote_:function(n){return new t.FieldImage((n=this.RTL?!n:n)?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,n?"\u201c":"\u201d")}},t.Constants.Text.TEXT_QUOTES_EXTENSION=function(){this.mixin(t.Constants.Text.QUOTE_IMAGE_MIXIN),this.quoteField_("TEXT")},t.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN={mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("items",this.itemCount_),n},domToMutation:function(n){this.itemCount_=parseInt(n.getAttribute("items"),10),this.updateShape_()},decompose:function(n){var o=n.newBlock("text_create_join_container");o.initSvg();for(var r=o.getInput("STACK").connection,a=0;a<this.itemCount_;a++){var h=n.newBlock("text_create_join_item");h.initSvg(),r.connect(h.previousConnection),r=h.nextConnection}return o},compose:function(n){var o=n.getInputTargetBlock("STACK");for(n=[];o&&!o.isInsertionMarker();)n.push(o.valueConnection_),o=o.nextConnection&&o.nextConnection.targetBlock();for(o=0;o<this.itemCount_;o++){var r=this.getInput("ADD"+o).connection.targetConnection;r&&-1==n.indexOf(r)&&r.disconnect()}for(this.itemCount_=n.length,this.updateShape_(),o=0;o<this.itemCount_;o++)t.Mutator.reconnect(n[o],this,"ADD"+o)},saveConnections:function(n){n=n.getInputTargetBlock("STACK");for(var o=0;n;){var r=this.getInput("ADD"+o);n.valueConnection_=r&&r.connection.targetConnection,o++,n=n.nextConnection&&n.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var n=0;n<this.itemCount_;n++)if(!this.getInput("ADD"+n)){var o=this.appendValueInput("ADD"+n).setAlign(t.ALIGN_RIGHT);0==n&&o.appendField(t.Msg.TEXT_JOIN_TITLE_CREATEWITH)}for(;this.getInput("ADD"+n);)this.removeInput("ADD"+n),n++}},t.Constants.Text.TEXT_JOIN_EXTENSION=function(){this.mixin(t.Constants.Text.QUOTE_IMAGE_MIXIN),this.itemCount_=2,this.updateShape_(),this.setMutator(new t.Mutator(["text_create_join_item"]))},t.Extensions.register("text_append_tooltip",t.Extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),t.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION=function(){var n=this;this.setTooltip(function(){return t.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",n.workspace.options.oneBasedIndex?"0":"-1")})},t.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN={mutationToDom:function(){var n=t.utils.xml.createElement("mutation");return n.setAttribute("at",!!this.isAt_),n},domToMutation:function(n){n="false"!=n.getAttribute("at"),this.updateAt_(n)},updateAt_:function(n){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),n&&(this.appendValueInput("AT").setCheck("Number"),t.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg.ORDINAL_NUMBER_SUFFIX)),t.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg.TEXT_CHARAT_TAIL)),this.isAt_=n}},t.Constants.Text.TEXT_CHARAT_EXTENSION=function(){this.getField("WHERE").setValidator(function(o){(o="FROM_START"==o||"FROM_END"==o)!=this.isAt_&&this.getSourceBlock().updateAt_(o)}),this.updateAt_(!0);var n=this;this.setTooltip(function(){var o=n.getFieldValue("WHERE"),r=t.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"==o||"FROM_END"==o)&&(o="FROM_START"==o?t.Msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(r+="  "+o.replace("%1",n.workspace.options.oneBasedIndex?"#1":"#0")),r})},t.Extensions.register("text_indexOf_tooltip",t.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION),t.Extensions.register("text_quotes",t.Constants.Text.TEXT_QUOTES_EXTENSION),t.Extensions.registerMutator("text_join_mutator",t.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN,t.Constants.Text.TEXT_JOIN_EXTENSION),t.Extensions.registerMutator("text_charAt_mutator",t.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN,t.Constants.Text.TEXT_CHARAT_EXTENSION),t.Blocks.variables={},t.Constants.Variables={},t.Constants.Variables.HUE=330,t.defineBlocksWithJsonArray([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),t.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(n){if(this.isInFlyout)("variables_get"==this.type||"variables_get_reporter"==this.type)&&(o={text:t.Msg.RENAME_VARIABLE,enabled:!0,callback:t.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},h=this.getField("VAR").getText(),a={text:t.Msg.DELETE_VARIABLE.replace("%1",h),enabled:!0,callback:t.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},n.unshift(o),n.unshift(a));else{if("variables_get"==this.type)var o="variables_set",r=t.Msg.VARIABLES_GET_CREATE_SET;else o="variables_get",r=t.Msg.VARIABLES_SET_CREATE_GET;var a={enabled:0<this.workspace.remainingCapacity()},h=this.getField("VAR").getText();a.text=r.replace("%1",h),(r=t.utils.xml.createElement("field")).setAttribute("name","VAR"),r.appendChild(t.utils.xml.createTextNode(h)),(h=t.utils.xml.createElement("block")).setAttribute("type",o),h.appendChild(r),a.callback=t.ContextMenu.callbackFactory(this,h),n.push(a)}}},t.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();t.Variables.renameVariable(o,r)}},t.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();o.deleteVariableById(r.getId()),o.refreshToolboxSelection()}},t.Extensions.registerMixin("contextMenu_variableSetterGetter",t.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),t.Constants.VariablesDynamic={},t.Constants.VariablesDynamic.HUE=310,t.defineBlocksWithJsonArray([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),t.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(n){if(this.isInFlyout)("variables_get_dynamic"==this.type||"variables_get_reporter_dynamic"==this.type)&&(o={text:t.Msg.RENAME_VARIABLE,enabled:!0,callback:t.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},R=this.getField("VAR").getText(),h={text:t.Msg.DELETE_VARIABLE.replace("%1",R),enabled:!0,callback:t.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},n.unshift(o),n.unshift(h));else{var o=this.getFieldValue("VAR"),r=this.workspace.getVariableById(o).type;if("variables_get_dynamic"==this.type){o="variables_set_dynamic";var a=t.Msg.VARIABLES_GET_CREATE_SET}else o="variables_get_dynamic",a=t.Msg.VARIABLES_SET_CREATE_GET;var h={enabled:0<this.workspace.remainingCapacity()},R=this.getField("VAR").getText();h.text=a.replace("%1",R),(a=t.utils.xml.createElement("field")).setAttribute("name","VAR"),a.setAttribute("variabletype",r),a.appendChild(t.utils.xml.createTextNode(R)),(R=t.utils.xml.createElement("block")).setAttribute("type",o),R.appendChild(a),h.callback=t.ContextMenu.callbackFactory(this,R),n.push(h)}},onchange:function(n){n=this.getFieldValue("VAR"),n=t.Variables.getVariable(this.workspace,n),"variables_get_dynamic"==this.type?this.outputConnection.setCheck(n.type):this.getInput("VALUE").connection.setCheck(n.type)}},t.Constants.VariablesDynamic.RENAME_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();t.Variables.renameVariable(o,r)}},t.Constants.VariablesDynamic.DELETE_OPTION_CALLBACK_FACTORY=function(n){return function(){var o=n.workspace,r=n.getField("VAR").getVariable();o.deleteVariableById(r.getId()),o.refreshToolboxSelection()}},t.Extensions.registerMixin("contextMenu_variableDynamicSetterGetter",t.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),t.Blocks}.apply(X,m))&&(B.exports=e)},5962:function(B,X,_){var m,e;m=[_(68207),_(39809),_(24773),_(20147)],void 0!==(e=function(t,n,o,r){"use strict";return t.setLocale(n),t.Blocks=t.Blocks||{},Object.keys(o).forEach(function(a){t.Blocks[a]=o[a]}),t.JavaScript=r,t}.apply(X,m))&&(B.exports=e)},68207:function(B,X,_){var m,e;m=[_(54364)],void 0!==(e=function(t){"use strict";return t.setLocale=function(n){t.Msg=t.Msg||{},Object.keys(n).forEach(function(o){t.Msg[o]=n[o]})},t}.apply(X,m))&&(B.exports=e)},68699:function(B,X,_){var m,e;m=[_(5962)],void 0!==(e=function(t){"use strict";return t}.apply(X,m))&&(B.exports=e)},20147:function(B,X,_){var m,e;m=[_(68207),_(19242)],void 0!==(e=function(t,n){"use strict";return t.JavaScript=n,n}.apply(X,m))&&(B.exports=e)},19242:function(B,X,_){var m,e;m=[_(46251)],void 0!==(e=function(t){"use strict";return t.JavaScript=new t.Generator("JavaScript"),t.JavaScript.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(t.utils.global).join(",")),t.JavaScript.ORDER_ATOMIC=0,t.JavaScript.ORDER_NEW=1.1,t.JavaScript.ORDER_MEMBER=1.2,t.JavaScript.ORDER_FUNCTION_CALL=2,t.JavaScript.ORDER_INCREMENT=3,t.JavaScript.ORDER_DECREMENT=3,t.JavaScript.ORDER_BITWISE_NOT=4.1,t.JavaScript.ORDER_UNARY_PLUS=4.2,t.JavaScript.ORDER_UNARY_NEGATION=4.3,t.JavaScript.ORDER_LOGICAL_NOT=4.4,t.JavaScript.ORDER_TYPEOF=4.5,t.JavaScript.ORDER_VOID=4.6,t.JavaScript.ORDER_DELETE=4.7,t.JavaScript.ORDER_AWAIT=4.8,t.JavaScript.ORDER_EXPONENTIATION=5,t.JavaScript.ORDER_MULTIPLICATION=5.1,t.JavaScript.ORDER_DIVISION=5.2,t.JavaScript.ORDER_MODULUS=5.3,t.JavaScript.ORDER_SUBTRACTION=6.1,t.JavaScript.ORDER_ADDITION=6.2,t.JavaScript.ORDER_BITWISE_SHIFT=7,t.JavaScript.ORDER_RELATIONAL=8,t.JavaScript.ORDER_IN=8,t.JavaScript.ORDER_INSTANCEOF=8,t.JavaScript.ORDER_EQUALITY=9,t.JavaScript.ORDER_BITWISE_AND=10,t.JavaScript.ORDER_BITWISE_XOR=11,t.JavaScript.ORDER_BITWISE_OR=12,t.JavaScript.ORDER_LOGICAL_AND=13,t.JavaScript.ORDER_LOGICAL_OR=14,t.JavaScript.ORDER_CONDITIONAL=15,t.JavaScript.ORDER_ASSIGNMENT=16,t.JavaScript.ORDER_YIELD=17,t.JavaScript.ORDER_COMMA=18,t.JavaScript.ORDER_NONE=99,t.JavaScript.ORDER_OVERRIDES=[[t.JavaScript.ORDER_FUNCTION_CALL,t.JavaScript.ORDER_MEMBER],[t.JavaScript.ORDER_FUNCTION_CALL,t.JavaScript.ORDER_FUNCTION_CALL],[t.JavaScript.ORDER_MEMBER,t.JavaScript.ORDER_MEMBER],[t.JavaScript.ORDER_MEMBER,t.JavaScript.ORDER_FUNCTION_CALL],[t.JavaScript.ORDER_LOGICAL_NOT,t.JavaScript.ORDER_LOGICAL_NOT],[t.JavaScript.ORDER_MULTIPLICATION,t.JavaScript.ORDER_MULTIPLICATION],[t.JavaScript.ORDER_ADDITION,t.JavaScript.ORDER_ADDITION],[t.JavaScript.ORDER_LOGICAL_AND,t.JavaScript.ORDER_LOGICAL_AND],[t.JavaScript.ORDER_LOGICAL_OR,t.JavaScript.ORDER_LOGICAL_OR]],t.JavaScript.isInitialized=!1,t.JavaScript.init=function(n){Object.getPrototypeOf(this).init.call(this),this.nameDB_?this.nameDB_.reset():this.nameDB_=new t.Names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(n.getVariableMap()),this.nameDB_.populateVariables(n),this.nameDB_.populateProcedures(n);for(var o=[],r=t.Variables.allDeveloperVariables(n),a=0;a<r.length;a++)o.push(this.nameDB_.getName(r[a],t.Names.DEVELOPER_VARIABLE_TYPE));for(n=t.Variables.allUsedVarModels(n),a=0;a<n.length;a++)o.push(this.nameDB_.getName(n[a].getId(),t.VARIABLE_CATEGORY_NAME));o.length&&(this.definitions_.variables="var "+o.join(", ")+";"),this.isInitialized=!0},t.JavaScript.finish=function(n){var o=t.utils.object.values(this.definitions_);return n=Object.getPrototypeOf(this).finish.call(this,n),this.isInitialized=!1,this.nameDB_.reset(),o.join("\n\n")+"\n\n\n"+n},t.JavaScript.scrubNakedValue=function(n){return n+";\n"},t.JavaScript.quote_=function(n){return"'"+(n=n.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},t.JavaScript.multiline_quote_=function(n){return n.split(/\n/g).map(this.quote_).join(" + '\\n' +\n")},t.JavaScript.scrub_=function(n,o,r){var a="";if(!n.outputConnection||!n.outputConnection.targetConnection){var h=n.getCommentText();h&&(h=t.utils.string.wrap(h,this.COMMENT_WRAP-3),a+=this.prefixLines(h+"\n","// "));for(var R=0;R<n.inputList.length;R++)n.inputList[R].type==t.inputTypes.VALUE&&(h=n.inputList[R].connection.targetBlock())&&(h=this.allNestedComments(h))&&(a+=this.prefixLines(h,"// "))}return n=n.nextConnection&&n.nextConnection.targetBlock(),a+o+(r?"":this.blockToCode(n))},t.JavaScript.getAdjusted=function(n,o,r,a,h){r=r||0,h=h||this.ORDER_NONE,n.workspace.options.oneBasedIndex&&r--;var R=n.workspace.options.oneBasedIndex?"1":"0";if(n=0<r?this.valueToCode(n,o,this.ORDER_ADDITION)||R:0>r?this.valueToCode(n,o,this.ORDER_SUBTRACTION)||R:a?this.valueToCode(n,o,this.ORDER_UNARY_NEGATION)||R:this.valueToCode(n,o,h)||R,t.isNumber(n))n=Number(n)+r,a&&(n=-n);else{if(0<r){n=n+" + "+r;var L=this.ORDER_ADDITION}else 0>r&&(n=n+" - "+-r,L=this.ORDER_SUBTRACTION);a&&(n=r?"-("+n+")":"-"+n,L=this.ORDER_UNARY_NEGATION),L=Math.floor(L),h=Math.floor(h),L&&h>=L&&(n="("+n+")")}return n},t.JavaScript.colour={},t.JavaScript.colour_picker=function(n){return[t.JavaScript.quote_(n.getFieldValue("COLOUR")),t.JavaScript.ORDER_ATOMIC]},t.JavaScript.colour_random=function(n){return[t.JavaScript.provideFunction_("colourRandom",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.colour_rgb=function(n){var o=t.JavaScript.valueToCode(n,"RED",t.JavaScript.ORDER_NONE)||0,r=t.JavaScript.valueToCode(n,"GREEN",t.JavaScript.ORDER_NONE)||0;return n=t.JavaScript.valueToCode(n,"BLUE",t.JavaScript.ORDER_NONE)||0,[t.JavaScript.provideFunction_("colourRgb",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+o+", "+r+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.colour_blend=function(n){var o=t.JavaScript.valueToCode(n,"COLOUR1",t.JavaScript.ORDER_NONE)||"'#000000'",r=t.JavaScript.valueToCode(n,"COLOUR2",t.JavaScript.ORDER_NONE)||"'#000000'";return n=t.JavaScript.valueToCode(n,"RATIO",t.JavaScript.ORDER_NONE)||.5,[t.JavaScript.provideFunction_("colourBlend",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+o+", "+r+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists={},t.JavaScript.lists_create_empty=function(n){return["[]",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.lists_create_with=function(n){for(var o=Array(n.itemCount_),r=0;r<n.itemCount_;r++)o[r]=t.JavaScript.valueToCode(n,"ADD"+r,t.JavaScript.ORDER_NONE)||"null";return["["+o.join(", ")+"]",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.lists_repeat=function(n){return[t.JavaScript.provideFunction_("listsRepeat",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"])+"("+(t.JavaScript.valueToCode(n,"ITEM",t.JavaScript.ORDER_NONE)||"null")+", "+(n=t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_NONE)||"0")+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_length=function(n){return[(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"[]")+".length",t.JavaScript.ORDER_MEMBER]},t.JavaScript.lists_isEmpty=function(n){return["!"+(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"[]")+".length",t.JavaScript.ORDER_LOGICAL_NOT]},t.JavaScript.lists_indexOf=function(n){var o="FIRST"==n.getFieldValue("END")?"indexOf":"lastIndexOf",r=t.JavaScript.valueToCode(n,"FIND",t.JavaScript.ORDER_NONE)||"''";return o=(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"[]")+"."+o+"("+r+")",n.workspace.options.oneBasedIndex?[o+" + 1",t.JavaScript.ORDER_ADDITION]:[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_getIndex=function(n){var o=n.getFieldValue("MODE")||"GET",r=n.getFieldValue("WHERE")||"FROM_START",a=t.JavaScript.valueToCode(n,"VALUE","RANDOM"==r?t.JavaScript.ORDER_NONE:t.JavaScript.ORDER_MEMBER)||"[]";switch(r){case"FIRST":if("GET"==o)return[a+"[0]",t.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[a+".shift()",t.JavaScript.ORDER_MEMBER];if("REMOVE"==o)return a+".shift();\n";break;case"LAST":if("GET"==o)return[a+".slice(-1)[0]",t.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[a+".pop()",t.JavaScript.ORDER_MEMBER];if("REMOVE"==o)return a+".pop();\n";break;case"FROM_START":if(n=t.JavaScript.getAdjusted(n,"AT"),"GET"==o)return[a+"["+n+"]",t.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==o)return[a+".splice("+n+", 1)[0]",t.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return a+".splice("+n+", 1);\n";break;case"FROM_END":if(n=t.JavaScript.getAdjusted(n,"AT",1,!0),"GET"==o)return[a+".slice("+n+")[0]",t.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"==o)return[a+".splice("+n+", 1)[0]",t.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return a+".splice("+n+", 1);";break;case"RANDOM":if(a=t.JavaScript.provideFunction_("listsGetRandomItem",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+a+", "+("GET"!=o)+")","GET"==o||"GET_REMOVE"==o)return[a,t.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==o)return a+";\n"}throw Error("Unhandled combination (lists_getIndex).")},t.JavaScript.lists_setIndex=function(n){function o(){if(r.match(/^\w+$/))return"";var L=t.JavaScript.nameDB_.getDistinctName("tmpList",t.VARIABLE_CATEGORY_NAME),W="var "+L+" = "+r+";\n";return r=L,W}var r=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_MEMBER)||"[]",a=n.getFieldValue("MODE")||"GET",h=n.getFieldValue("WHERE")||"FROM_START",R=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_ASSIGNMENT)||"null";switch(h){case"FIRST":if("SET"==a)return r+"[0] = "+R+";\n";if("INSERT"==a)return r+".unshift("+R+");\n";break;case"LAST":if("SET"==a)return(n=o())+(r+"[")+r+".length - 1] = "+R+";\n";if("INSERT"==a)return r+".push("+R+");\n";break;case"FROM_START":if(h=t.JavaScript.getAdjusted(n,"AT"),"SET"==a)return r+"["+h+"] = "+R+";\n";if("INSERT"==a)return r+".splice("+h+", 0, "+R+");\n";break;case"FROM_END":if(h=t.JavaScript.getAdjusted(n,"AT",1,!1,t.JavaScript.ORDER_SUBTRACTION),n=o(),"SET"==a)return n+(r+"[")+r+".length - "+h+"] = "+R+";\n";if("INSERT"==a)return n+(r+".splice(")+r+".length - "+h+", 0, "+R+");\n";break;case"RANDOM":if(n=o(),n+="var "+(h=t.JavaScript.nameDB_.getDistinctName("tmpX",t.VARIABLE_CATEGORY_NAME))+" = Math.floor(Math.random() * "+r+".length);\n","SET"==a)return n+(r+"[")+h+"] = "+R+";\n";if("INSERT"==a)return n+(r+".splice(")+h+", 0, "+R+");\n"}throw Error("Unhandled combination (lists_setIndex).")},t.JavaScript.lists.getIndex_=function(n,o,r){return"FIRST"==o?"0":"FROM_END"==o?n+".length - 1 - "+r:"LAST"==o?n+".length - 1":r},t.JavaScript.lists_getSublist=function(n){var o=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_MEMBER)||"[]",r=n.getFieldValue("WHERE1"),a=n.getFieldValue("WHERE2");if("FIRST"==r&&"LAST"==a)o+=".slice(0)";else if(o.match(/^\w+$/)||"FROM_END"!=r&&"FROM_START"==a){switch(r){case"FROM_START":var h=t.JavaScript.getAdjusted(n,"AT1");break;case"FROM_END":h=o+".length - "+(h=t.JavaScript.getAdjusted(n,"AT1",1,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":h="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(a){case"FROM_START":n=t.JavaScript.getAdjusted(n,"AT2",1);break;case"FROM_END":n=o+".length - "+(n=t.JavaScript.getAdjusted(n,"AT2",0,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"LAST":n=o+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}o=o+".slice("+h+", "+n+")"}else{h=t.JavaScript.getAdjusted(n,"AT1"),n=t.JavaScript.getAdjusted(n,"AT2");var R=t.JavaScript.lists.getIndex_,L={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};o=t.JavaScript.provideFunction_("subsequence"+L[r]+L[a],["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==r||"FROM_START"==r?", at1":"")+("FROM_END"==a||"FROM_START"==a?", at2":"")+") {","  var start = "+R("sequence",r,"at1")+";","  var end = "+R("sequence",a,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+o+("FROM_END"==r||"FROM_START"==r?", "+h:"")+("FROM_END"==a||"FROM_START"==a?", "+n:"")+")"}return[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_sort=function(n){var o=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_FUNCTION_CALL)||"[]",r="1"===n.getFieldValue("DIRECTION")?1:-1;return n=n.getFieldValue("TYPE"),[o+".slice().sort("+t.JavaScript.provideFunction_("listsGetSortCompare",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+n+'", '+r+"))",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_split=function(n){var o=t.JavaScript.valueToCode(n,"INPUT",t.JavaScript.ORDER_MEMBER),r=t.JavaScript.valueToCode(n,"DELIM",t.JavaScript.ORDER_NONE)||"''";if("SPLIT"==(n=n.getFieldValue("MODE")))o||(o="''"),n="split";else{if("JOIN"!=n)throw Error("Unknown mode: "+n);o||(o="[]"),n="join"}return[o+"."+n+"("+r+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.lists_reverse=function(n){return[(t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.logic={},t.JavaScript.controls_if=function(n){var o=0,r="";t.JavaScript.STATEMENT_PREFIX&&(r+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,n));do{var a=t.JavaScript.valueToCode(n,"IF"+o,t.JavaScript.ORDER_NONE)||"false",h=t.JavaScript.statementToCode(n,"DO"+o);t.JavaScript.STATEMENT_SUFFIX&&(h=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n),t.JavaScript.INDENT)+h),r+=(0<o?" else ":"")+"if ("+a+") {\n"+h+"}",++o}while(n.getInput("IF"+o));return(n.getInput("ELSE")||t.JavaScript.STATEMENT_SUFFIX)&&(h=t.JavaScript.statementToCode(n,"ELSE"),t.JavaScript.STATEMENT_SUFFIX&&(h=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n),t.JavaScript.INDENT)+h),r+=" else {\n"+h+"}"),r+"\n"},t.JavaScript.controls_ifelse=t.JavaScript.controls_if,t.JavaScript.logic_compare=function(n){var o={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[n.getFieldValue("OP")],r="=="==o||"!="==o?t.JavaScript.ORDER_EQUALITY:t.JavaScript.ORDER_RELATIONAL;return[(t.JavaScript.valueToCode(n,"A",r)||"0")+" "+o+" "+(n=t.JavaScript.valueToCode(n,"B",r)||"0"),r]},t.JavaScript.logic_operation=function(n){var o="AND"==n.getFieldValue("OP")?"&&":"||",r="&&"==o?t.JavaScript.ORDER_LOGICAL_AND:t.JavaScript.ORDER_LOGICAL_OR,a=t.JavaScript.valueToCode(n,"A",r);if(n=t.JavaScript.valueToCode(n,"B",r),a||n){var h="&&"==o?"true":"false";a||(a=h),n||(n=h)}else n=a="false";return[a+" "+o+" "+n,r]},t.JavaScript.logic_negate=function(n){var o=t.JavaScript.ORDER_LOGICAL_NOT;return["!"+(t.JavaScript.valueToCode(n,"BOOL",o)||"true"),o]},t.JavaScript.logic_boolean=function(n){return["TRUE"==n.getFieldValue("BOOL")?"true":"false",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.logic_null=function(n){return["null",t.JavaScript.ORDER_ATOMIC]},t.JavaScript.logic_ternary=function(n){return[(t.JavaScript.valueToCode(n,"IF",t.JavaScript.ORDER_CONDITIONAL)||"false")+" ? "+(t.JavaScript.valueToCode(n,"THEN",t.JavaScript.ORDER_CONDITIONAL)||"null")+" : "+(n=t.JavaScript.valueToCode(n,"ELSE",t.JavaScript.ORDER_CONDITIONAL)||"null"),t.JavaScript.ORDER_CONDITIONAL]},t.JavaScript.loops={},t.JavaScript.controls_repeat_ext=function(n){var o=n.getField("TIMES")?String(Number(n.getFieldValue("TIMES"))):t.JavaScript.valueToCode(n,"TIMES",t.JavaScript.ORDER_ASSIGNMENT)||"0",r=t.JavaScript.statementToCode(n,"DO");r=t.JavaScript.addLoopTrap(r,n),n="";var a=t.JavaScript.nameDB_.getDistinctName("count",t.VARIABLE_CATEGORY_NAME),h=o;return o.match(/^\w+$/)||t.isNumber(o)||(n+="var "+(h=t.JavaScript.nameDB_.getDistinctName("repeat_end",t.VARIABLE_CATEGORY_NAME))+" = "+o+";\n"),n+"for (var "+a+" = 0; "+a+" < "+h+"; "+a+"++) {\n"+r+"}\n"},t.JavaScript.controls_repeat=t.JavaScript.controls_repeat_ext,t.JavaScript.controls_whileUntil=function(n){var o="UNTIL"==n.getFieldValue("MODE"),r=t.JavaScript.valueToCode(n,"BOOL",o?t.JavaScript.ORDER_LOGICAL_NOT:t.JavaScript.ORDER_NONE)||"false",a=t.JavaScript.statementToCode(n,"DO");return o&&(r="!"+r),"while ("+r+") {\n"+(a=t.JavaScript.addLoopTrap(a,n))+"}\n"},t.JavaScript.controls_for=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME),r=t.JavaScript.valueToCode(n,"FROM",t.JavaScript.ORDER_ASSIGNMENT)||"0",a=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_ASSIGNMENT)||"0",h=t.JavaScript.valueToCode(n,"BY",t.JavaScript.ORDER_ASSIGNMENT)||"1",R=t.JavaScript.statementToCode(n,"DO");if(R=t.JavaScript.addLoopTrap(R,n),t.isNumber(r)&&t.isNumber(a)&&t.isNumber(h)){var L=Number(r)<=Number(a);n="for ("+o+" = "+r+"; "+o+(L?" <= ":" >= ")+a+"; "+o,n=(1==(o=Math.abs(Number(h)))?n+(L?"++":"--"):n+(L?" += ":" -= ")+o)+") {\n"+R+"}\n"}else n="",L=r,r.match(/^\w+$/)||t.isNumber(r)||(n+="var "+(L=t.JavaScript.nameDB_.getDistinctName(o+"_start",t.VARIABLE_CATEGORY_NAME))+" = "+r+";\n"),r=a,a.match(/^\w+$/)||t.isNumber(a)||(n+="var "+(r=t.JavaScript.nameDB_.getDistinctName(o+"_end",t.VARIABLE_CATEGORY_NAME))+" = "+a+";\n"),n+="var "+(a=t.JavaScript.nameDB_.getDistinctName(o+"_inc",t.VARIABLE_CATEGORY_NAME))+" = ",n=(n=t.isNumber(h)?n+(Math.abs(h)+";\n"):n+"Math.abs("+h+");\n")+"if ("+L+" > "+r+") {\n"+(t.JavaScript.INDENT+a)+" = -"+a+";\n",n+="}\n",n+="for ("+o+" = "+L+"; "+a+" >= 0 ? "+o+" <= "+r+" : "+o+" >= "+r+"; "+o+" += "+a+") {\n"+R+"}\n";return n},t.JavaScript.controls_forEach=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME),r=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_ASSIGNMENT)||"[]",a=t.JavaScript.statementToCode(n,"DO");a=t.JavaScript.addLoopTrap(a,n),n="";var h=r;return r.match(/^\w+$/)||(n+="var "+(h=t.JavaScript.nameDB_.getDistinctName(o+"_list",t.VARIABLE_CATEGORY_NAME))+" = "+r+";\n"),n+"for (var "+(r=t.JavaScript.nameDB_.getDistinctName(o+"_index",t.VARIABLE_CATEGORY_NAME))+" in "+h+") {\n"+(a=t.JavaScript.INDENT+o+" = "+h+"["+r+"];\n"+a)+"}\n"},t.JavaScript.controls_flow_statements=function(n){var o="";if(t.JavaScript.STATEMENT_PREFIX&&(o+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,n)),t.JavaScript.STATEMENT_SUFFIX&&(o+=t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n)),t.JavaScript.STATEMENT_PREFIX){var r=t.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(n);r&&!r.suppressPrefixSuffix&&(o+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,r))}switch(n.getFieldValue("FLOW")){case"BREAK":return o+"break;\n";case"CONTINUE":return o+"continue;\n"}throw Error("Unknown flow statement.")},t.JavaScript.math={},t.JavaScript.math_number=function(n){return[n=Number(n.getFieldValue("NUM")),0<=n?t.JavaScript.ORDER_ATOMIC:t.JavaScript.ORDER_UNARY_NEGATION]},t.JavaScript.math_arithmetic=function(n){var o={ADD:[" + ",t.JavaScript.ORDER_ADDITION],MINUS:[" - ",t.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",t.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",t.JavaScript.ORDER_DIVISION],POWER:[null,t.JavaScript.ORDER_NONE]}[n.getFieldValue("OP")],r=o[0],a=t.JavaScript.valueToCode(n,"A",o=o[1])||"0";return n=t.JavaScript.valueToCode(n,"B",o)||"0",r?[a+r+n,o]:["Math.pow("+a+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_single=function(n){var o=n.getFieldValue("OP");if("NEG"==o)return"-"==(n=t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(n=" "+n),["-"+n,t.JavaScript.ORDER_UNARY_NEGATION];switch(n="SIN"==o||"COS"==o||"TAN"==o?t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_DIVISION)||"0":t.JavaScript.valueToCode(n,"NUM",t.JavaScript.ORDER_NONE)||"0",o){case"ABS":var r="Math.abs("+n+")";break;case"ROOT":r="Math.sqrt("+n+")";break;case"LN":r="Math.log("+n+")";break;case"EXP":r="Math.exp("+n+")";break;case"POW10":r="Math.pow(10,"+n+")";break;case"ROUND":r="Math.round("+n+")";break;case"ROUNDUP":r="Math.ceil("+n+")";break;case"ROUNDDOWN":r="Math.floor("+n+")";break;case"SIN":r="Math.sin("+n+" / 180 * Math.PI)";break;case"COS":r="Math.cos("+n+" / 180 * Math.PI)";break;case"TAN":r="Math.tan("+n+" / 180 * Math.PI)"}if(r)return[r,t.JavaScript.ORDER_FUNCTION_CALL];switch(o){case"LOG10":r="Math.log("+n+") / Math.log(10)";break;case"ASIN":r="Math.asin("+n+") / Math.PI * 180";break;case"ACOS":r="Math.acos("+n+") / Math.PI * 180";break;case"ATAN":r="Math.atan("+n+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+o)}return[r,t.JavaScript.ORDER_DIVISION]},t.JavaScript.math_constant=function(n){return{PI:["Math.PI",t.JavaScript.ORDER_MEMBER],E:["Math.E",t.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",t.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",t.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",t.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",t.JavaScript.ORDER_ATOMIC]}[n.getFieldValue("CONSTANT")]},t.JavaScript.math_number_property=function(n){var o=t.JavaScript.valueToCode(n,"NUMBER_TO_CHECK",t.JavaScript.ORDER_MODULUS)||"0",r=n.getFieldValue("PROPERTY");if("PRIME"==r)return[t.JavaScript.provideFunction_("mathIsPrime",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+o+")",t.JavaScript.ORDER_FUNCTION_CALL];switch(r){case"EVEN":var a=o+" % 2 == 0";break;case"ODD":a=o+" % 2 == 1";break;case"WHOLE":a=o+" % 1 == 0";break;case"POSITIVE":a=o+" > 0";break;case"NEGATIVE":a=o+" < 0";break;case"DIVISIBLE_BY":a=o+" % "+(n=t.JavaScript.valueToCode(n,"DIVISOR",t.JavaScript.ORDER_MODULUS)||"0")+" == 0"}return[a,t.JavaScript.ORDER_EQUALITY]},t.JavaScript.math_change=function(n){var o=t.JavaScript.valueToCode(n,"DELTA",t.JavaScript.ORDER_ADDITION)||"0";return(n=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME))+" = (typeof "+n+" == 'number' ? "+n+" : 0) + "+o+";\n"},t.JavaScript.math_round=t.JavaScript.math_single,t.JavaScript.math_trig=t.JavaScript.math_single,t.JavaScript.math_on_list=function(n){var o=n.getFieldValue("OP");switch(o){case"SUM":n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_MEMBER)||"[]",n+=".reduce(function(x, y) {return x + y;})";break;case"MIN":n="Math.min.apply(null, "+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"MAX":n="Math.max.apply(null, "+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"AVERAGE":n=(o=t.JavaScript.provideFunction_("mathMean",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"MEDIAN":n=(o=t.JavaScript.provideFunction_("mathMedian",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"MODE":n=(o=t.JavaScript.provideFunction_("mathModes",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"STD_DEV":n=(o=t.JavaScript.provideFunction_("mathStandardDeviation",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;case"RANDOM":n=(o=t.JavaScript.provideFunction_("mathRandomList",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]))+"("+(n=t.JavaScript.valueToCode(n,"LIST",t.JavaScript.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+o)}return[n,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_modulo=function(n){return[(t.JavaScript.valueToCode(n,"DIVIDEND",t.JavaScript.ORDER_MODULUS)||"0")+" % "+(n=t.JavaScript.valueToCode(n,"DIVISOR",t.JavaScript.ORDER_MODULUS)||"0"),t.JavaScript.ORDER_MODULUS]},t.JavaScript.math_constrain=function(n){return["Math.min(Math.max("+(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_NONE)||"0")+", "+(t.JavaScript.valueToCode(n,"LOW",t.JavaScript.ORDER_NONE)||"0")+"), "+(n=t.JavaScript.valueToCode(n,"HIGH",t.JavaScript.ORDER_NONE)||"Infinity")+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_random_int=function(n){var o=t.JavaScript.valueToCode(n,"FROM",t.JavaScript.ORDER_NONE)||"0";return n=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_NONE)||"0",[t.JavaScript.provideFunction_("mathRandomInt",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+o+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_random_float=function(n){return["Math.random()",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.math_atan2=function(n){var o=t.JavaScript.valueToCode(n,"X",t.JavaScript.ORDER_NONE)||"0";return["Math.atan2("+(t.JavaScript.valueToCode(n,"Y",t.JavaScript.ORDER_NONE)||"0")+", "+o+") / Math.PI * 180",t.JavaScript.ORDER_DIVISION]},t.JavaScript.procedures={},t.JavaScript.procedures_defreturn=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("NAME"),t.PROCEDURE_CATEGORY_NAME),r="";t.JavaScript.STATEMENT_PREFIX&&(r+=t.JavaScript.injectId(t.JavaScript.STATEMENT_PREFIX,n)),t.JavaScript.STATEMENT_SUFFIX&&(r+=t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n)),r&&(r=t.JavaScript.prefixLines(r,t.JavaScript.INDENT));var a="";t.JavaScript.INFINITE_LOOP_TRAP&&(a=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.INFINITE_LOOP_TRAP,n),t.JavaScript.INDENT));var h=t.JavaScript.statementToCode(n,"STACK"),R=t.JavaScript.valueToCode(n,"RETURN",t.JavaScript.ORDER_NONE)||"",L="";h&&R&&(L=r),R&&(R=t.JavaScript.INDENT+"return "+R+";\n");for(var W=[],nt=n.getVars(),et=0;et<nt.length;et++)W[et]=t.JavaScript.nameDB_.getName(nt[et],t.VARIABLE_CATEGORY_NAME);return r="function "+o+"("+W.join(", ")+") {\n"+r+a+h+L+R+"}",r=t.JavaScript.scrub_(n,r),t.JavaScript.definitions_["%"+o]=r,null},t.JavaScript.procedures_defnoreturn=t.JavaScript.procedures_defreturn,t.JavaScript.procedures_callreturn=function(n){for(var o=t.JavaScript.nameDB_.getName(n.getFieldValue("NAME"),t.PROCEDURE_CATEGORY_NAME),r=[],a=n.getVars(),h=0;h<a.length;h++)r[h]=t.JavaScript.valueToCode(n,"ARG"+h,t.JavaScript.ORDER_NONE)||"null";return[o+"("+r.join(", ")+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.procedures_callnoreturn=function(n){return t.JavaScript.procedures_callreturn(n)[0]+";\n"},t.JavaScript.procedures_ifreturn=function(n){var o="if ("+(t.JavaScript.valueToCode(n,"CONDITION",t.JavaScript.ORDER_NONE)||"false")+") {\n";return t.JavaScript.STATEMENT_SUFFIX&&(o+=t.JavaScript.prefixLines(t.JavaScript.injectId(t.JavaScript.STATEMENT_SUFFIX,n),t.JavaScript.INDENT)),n.hasReturnValue_?(n=t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_NONE)||"null",o+=t.JavaScript.INDENT+"return "+n+";\n"):o+=t.JavaScript.INDENT+"return;\n",o+"}\n"},t.JavaScript.texts={},t.JavaScript.text=function(n){return[t.JavaScript.quote_(n.getFieldValue("TEXT")),t.JavaScript.ORDER_ATOMIC]},t.JavaScript.text_multiline=function(n){var o=-1!=(n=t.JavaScript.multiline_quote_(n.getFieldValue("TEXT"))).indexOf("+")?t.JavaScript.ORDER_ADDITION:t.JavaScript.ORDER_ATOMIC;return[n,o]},t.JavaScript.text.forceString_=function(n){return t.JavaScript.text.forceString_.strRegExp.test(n)?[n,t.JavaScript.ORDER_ATOMIC]:["String("+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/,t.JavaScript.text_join=function(n){switch(n.itemCount_){case 0:return["''",t.JavaScript.ORDER_ATOMIC];case 1:return n=t.JavaScript.valueToCode(n,"ADD0",t.JavaScript.ORDER_NONE)||"''",t.JavaScript.text.forceString_(n);case 2:var o=t.JavaScript.valueToCode(n,"ADD0",t.JavaScript.ORDER_NONE)||"''";return n=t.JavaScript.valueToCode(n,"ADD1",t.JavaScript.ORDER_NONE)||"''",[n=t.JavaScript.text.forceString_(o)[0]+" + "+t.JavaScript.text.forceString_(n)[0],t.JavaScript.ORDER_ADDITION];default:o=Array(n.itemCount_);for(var r=0;r<n.itemCount_;r++)o[r]=t.JavaScript.valueToCode(n,"ADD"+r,t.JavaScript.ORDER_NONE)||"''";return[n="["+o.join(",")+"].join('')",t.JavaScript.ORDER_FUNCTION_CALL]}},t.JavaScript.text_append=function(n){var o=t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME);return n=t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''",o+" += "+t.JavaScript.text.forceString_(n)[0]+";\n"},t.JavaScript.text_length=function(n){return[(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"''")+".length",t.JavaScript.ORDER_MEMBER]},t.JavaScript.text_isEmpty=function(n){return["!"+(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"''")+".length",t.JavaScript.ORDER_LOGICAL_NOT]},t.JavaScript.text_indexOf=function(n){var o="FIRST"==n.getFieldValue("END")?"indexOf":"lastIndexOf",r=t.JavaScript.valueToCode(n,"FIND",t.JavaScript.ORDER_NONE)||"''";return o=(t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_MEMBER)||"''")+"."+o+"("+r+")",n.workspace.options.oneBasedIndex?[o+" + 1",t.JavaScript.ORDER_ADDITION]:[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_charAt=function(n){var o=n.getFieldValue("WHERE")||"FROM_START",r=t.JavaScript.valueToCode(n,"VALUE","RANDOM"==o?t.JavaScript.ORDER_NONE:t.JavaScript.ORDER_MEMBER)||"''";switch(o){case"FIRST":return[r+".charAt(0)",t.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[r+".slice(-1)",t.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[r+".charAt("+(n=t.JavaScript.getAdjusted(n,"AT"))+")",t.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[r+".slice("+(n=t.JavaScript.getAdjusted(n,"AT",1,!0))+").charAt(0)",t.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[t.JavaScript.provideFunction_("textRandomLetter",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+r+")",t.JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},t.JavaScript.text.getIndex_=function(n,o,r){return"FIRST"==o?"0":"FROM_END"==o?n+".length - 1 - "+r:"LAST"==o?n+".length - 1":r},t.JavaScript.text_getSubstring=function(n){var o=n.getFieldValue("WHERE1"),r=n.getFieldValue("WHERE2"),a="FROM_END"!=o&&"LAST"!=o&&"FROM_END"!=r&&"LAST"!=r,h=t.JavaScript.valueToCode(n,"STRING",a?t.JavaScript.ORDER_MEMBER:t.JavaScript.ORDER_NONE)||"''";if("FIRST"==o&&"LAST"==r)return[h,t.JavaScript.ORDER_NONE];if(h.match(/^'?\w+'?$/)||a){switch(o){case"FROM_START":a=t.JavaScript.getAdjusted(n,"AT1");break;case"FROM_END":a=h+".length - "+(a=t.JavaScript.getAdjusted(n,"AT1",1,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":a="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(r){case"FROM_START":n=t.JavaScript.getAdjusted(n,"AT2",1);break;case"FROM_END":n=h+".length - "+(n=t.JavaScript.getAdjusted(n,"AT2",0,!1,t.JavaScript.ORDER_SUBTRACTION));break;case"LAST":n=h+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}o=h+".slice("+a+", "+n+")"}else{a=t.JavaScript.getAdjusted(n,"AT1"),n=t.JavaScript.getAdjusted(n,"AT2");var R=t.JavaScript.text.getIndex_,L={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};o=t.JavaScript.provideFunction_("subsequence"+L[o]+L[r],["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==o||"FROM_START"==o?", at1":"")+("FROM_END"==r||"FROM_START"==r?", at2":"")+") {","  var start = "+R("sequence",o,"at1")+";","  var end = "+R("sequence",r,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+h+("FROM_END"==o||"FROM_START"==o?", "+a:"")+("FROM_END"==r||"FROM_START"==r?", "+n:"")+")"}return[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_changeCase=function(n){var o={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[n.getFieldValue("CASE")];return n=t.JavaScript.valueToCode(n,"TEXT",o?t.JavaScript.ORDER_MEMBER:t.JavaScript.ORDER_NONE)||"''",[o?n+o:t.JavaScript.provideFunction_("textToTitleCase",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+"("+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_trim=function(n){var o={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[n.getFieldValue("MODE")];return[(t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_MEMBER)||"''")+o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_print=function(n){return"window.alert("+(t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''")+");\n"},t.JavaScript.text_prompt_ext=function(n){var o="window.prompt("+(n.getField("TEXT")?t.JavaScript.quote_(n.getFieldValue("TEXT")):t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''")+")";return"NUMBER"==n.getFieldValue("TYPE")&&(o="Number("+o+")"),[o,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_prompt=t.JavaScript.text_prompt_ext,t.JavaScript.text_count=function(n){var o=t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''";return n=t.JavaScript.valueToCode(n,"SUB",t.JavaScript.ORDER_NONE)||"''",[t.JavaScript.provideFunction_("textCount",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+o+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_replace=function(n){var o=t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_NONE)||"''",r=t.JavaScript.valueToCode(n,"FROM",t.JavaScript.ORDER_NONE)||"''";return n=t.JavaScript.valueToCode(n,"TO",t.JavaScript.ORDER_NONE)||"''",[t.JavaScript.provideFunction_("textReplace",["function "+t.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+o+", "+r+", "+n+")",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.text_reverse=function(n){return[(t.JavaScript.valueToCode(n,"TEXT",t.JavaScript.ORDER_MEMBER)||"''")+".split('').reverse().join('')",t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.variables={},t.JavaScript.variables_get=function(n){return[t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME),t.JavaScript.ORDER_ATOMIC]},t.JavaScript.variables_set=function(n){var o=t.JavaScript.valueToCode(n,"VALUE",t.JavaScript.ORDER_ASSIGNMENT)||"0";return t.JavaScript.nameDB_.getName(n.getFieldValue("VAR"),t.VARIABLE_CATEGORY_NAME)+" = "+o+";\n"},t.JavaScript.variablesDynamic={},t.JavaScript.variables_get_dynamic=t.JavaScript.variables_get,t.JavaScript.variables_set_dynamic=t.JavaScript.variables_set,t.JavaScript}.apply(X,m))&&(B.exports=e)},39809:function(B,X,_){var m,e;m=[_(68207)],void 0!==(e=function(n){return(n={Msg:{}}).Msg.ADD_COMMENT="Add Comment",n.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",n.Msg.CHANGE_VALUE_TITLE="Change value:",n.Msg.CLEAN_UP="Clean up Blocks",n.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",n.Msg.COLLAPSE_ALL="Collapse Blocks",n.Msg.COLLAPSE_BLOCK="Collapse Block",n.Msg.COLOUR_BLEND_COLOUR1="colour 1",n.Msg.COLOUR_BLEND_COLOUR2="colour 2",n.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",n.Msg.COLOUR_BLEND_RATIO="ratio",n.Msg.COLOUR_BLEND_TITLE="blend",n.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",n.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",n.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",n.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",n.Msg.COLOUR_RANDOM_TITLE="random colour",n.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",n.Msg.COLOUR_RGB_BLUE="blue",n.Msg.COLOUR_RGB_GREEN="green",n.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",n.Msg.COLOUR_RGB_RED="red",n.Msg.COLOUR_RGB_TITLE="colour with",n.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",n.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",n.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",n.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",n.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",n.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",n.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",n.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",n.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",n.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",n.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",n.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",n.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",n.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",n.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",n.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",n.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",n.Msg.CONTROLS_IF_MSG_ELSE="else",n.Msg.CONTROLS_IF_MSG_ELSEIF="else if",n.Msg.CONTROLS_IF_MSG_IF="if",n.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",n.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",n.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",n.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",n.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",n.Msg.CONTROLS_REPEAT_INPUT_DO="do",n.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",n.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",n.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",n.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",n.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",n.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",n.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",n.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",n.Msg.DELETE_BLOCK="Delete Block",n.Msg.DELETE_VARIABLE="Delete the '%1' variable",n.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",n.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",n.Msg.DISABLE_BLOCK="Disable Block",n.Msg.DUPLICATE_BLOCK="Duplicate",n.Msg.DUPLICATE_COMMENT="Duplicate Comment",n.Msg.ENABLE_BLOCK="Enable Block",n.Msg.EXPAND_ALL="Expand Blocks",n.Msg.EXPAND_BLOCK="Expand Block",n.Msg.EXTERNAL_INPUTS="External Inputs",n.Msg.HELP="Help",n.Msg.INLINE_INPUTS="Inline Inputs",n.Msg.IOS_CANCEL="Cancel",n.Msg.IOS_ERROR="Error",n.Msg.IOS_OK="OK",n.Msg.IOS_PROCEDURES_ADD_INPUT="+ Add Input",n.Msg.IOS_PROCEDURES_ALLOW_STATEMENTS="Allow statements",n.Msg.IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR="This function has duplicate inputs.",n.Msg.IOS_PROCEDURES_INPUTS="INPUTS",n.Msg.IOS_VARIABLES_ADD_BUTTON="Add",n.Msg.IOS_VARIABLES_ADD_VARIABLE="+ Add Variable",n.Msg.IOS_VARIABLES_DELETE_BUTTON="Delete",n.Msg.IOS_VARIABLES_EMPTY_NAME_ERROR="You can't use an empty variable name.",n.Msg.IOS_VARIABLES_RENAME_BUTTON="Rename",n.Msg.IOS_VARIABLES_VARIABLE_NAME="Variable name",n.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",n.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",n.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",n.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",n.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",n.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",n.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",n.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",n.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",n.Msg.LISTS_GET_INDEX_FIRST="first",n.Msg.LISTS_GET_INDEX_FROM_END="# from end",n.Msg.LISTS_GET_INDEX_FROM_START="#",n.Msg.LISTS_GET_INDEX_GET="get",n.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",n.Msg.LISTS_GET_INDEX_LAST="last",n.Msg.LISTS_GET_INDEX_RANDOM="random",n.Msg.LISTS_GET_INDEX_REMOVE="remove",n.Msg.LISTS_GET_INDEX_TAIL="",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",n.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",n.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",n.Msg.LISTS_GET_SUBLIST_END_LAST="to last",n.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",n.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",n.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",n.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",n.Msg.LISTS_GET_SUBLIST_TAIL="",n.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",n.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",n.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",n.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",n.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",n.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",n.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",n.Msg.LISTS_INLIST="in list",n.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",n.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",n.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",n.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",n.Msg.LISTS_LENGTH_TITLE="length of %1",n.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",n.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",n.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",n.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",n.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",n.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",n.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",n.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",n.Msg.LISTS_SET_INDEX_INPUT_TO="as",n.Msg.LISTS_SET_INDEX_INSERT="insert at",n.Msg.LISTS_SET_INDEX_SET="set",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",n.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",n.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",n.Msg.LISTS_SORT_ORDER_DESCENDING="descending",n.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",n.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",n.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",n.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",n.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",n.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",n.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",n.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",n.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",n.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",n.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",n.Msg.LOGIC_BOOLEAN_FALSE="false",n.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",n.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",n.Msg.LOGIC_BOOLEAN_TRUE="true",n.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",n.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",n.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",n.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",n.Msg.LOGIC_NEGATE_TITLE="not %1",n.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",n.Msg.LOGIC_NULL="null",n.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",n.Msg.LOGIC_NULL_TOOLTIP="Returns null.",n.Msg.LOGIC_OPERATION_AND="and",n.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",n.Msg.LOGIC_OPERATION_OR="or",n.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",n.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",n.Msg.LOGIC_TERNARY_CONDITION="test",n.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",n.Msg.LOGIC_TERNARY_IF_FALSE="if false",n.Msg.LOGIC_TERNARY_IF_TRUE="if true",n.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",n.Msg.MATH_ADDITION_SYMBOL="+",n.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",n.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",n.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",n.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",n.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",n.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",n.Msg.MATH_CHANGE_TITLE="change %1 by %2",n.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",n.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",n.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: \u03c0 (3.141\u2026), e (2.718\u2026), \u03c6 (1.618\u2026), sqrt(2) (1.414\u2026), sqrt(\xbd) (0.707\u2026), or \u221e (infinity).",n.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",n.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",n.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",n.Msg.MATH_DIVISION_SYMBOL="\xf7",n.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",n.Msg.MATH_IS_EVEN="is even",n.Msg.MATH_IS_NEGATIVE="is negative",n.Msg.MATH_IS_ODD="is odd",n.Msg.MATH_IS_POSITIVE="is positive",n.Msg.MATH_IS_PRIME="is prime",n.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",n.Msg.MATH_IS_WHOLE="is whole",n.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",n.Msg.MATH_MODULO_TITLE="remainder of %1 \xf7 %2",n.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",n.Msg.MATH_MULTIPLICATION_SYMBOL="\xd7",n.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",n.Msg.MATH_NUMBER_TOOLTIP="A number.",n.Msg.MATH_ONLIST_HELPURL="",n.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",n.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",n.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",n.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",n.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",n.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",n.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",n.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",n.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",n.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",n.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",n.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",n.Msg.MATH_POWER_SYMBOL="^",n.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",n.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",n.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",n.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",n.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",n.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",n.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",n.Msg.MATH_ROUND_OPERATOR_ROUND="round",n.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",n.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",n.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",n.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",n.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",n.Msg.MATH_SINGLE_OP_ROOT="square root",n.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",n.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",n.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",n.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",n.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",n.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",n.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",n.Msg.MATH_SUBTRACTION_SYMBOL="-",n.Msg.MATH_TRIG_ACOS="acos",n.Msg.MATH_TRIG_ASIN="asin",n.Msg.MATH_TRIG_ATAN="atan",n.Msg.MATH_TRIG_COS="cos",n.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",n.Msg.MATH_TRIG_SIN="sin",n.Msg.MATH_TRIG_TAN="tan",n.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",n.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",n.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",n.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",n.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",n.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",n.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",n.Msg.NEW_NUMBER_VARIABLE="Create number variable...",n.Msg.NEW_STRING_VARIABLE="Create string variable...",n.Msg.NEW_VARIABLE="Create variable...",n.Msg.NEW_VARIABLE_TITLE="New variable name:",n.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",n.Msg.ORDINAL_NUMBER_SUFFIX="",n.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",n.Msg.PROCEDURES_BEFORE_PARAMS="with:",n.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",n.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",n.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",n.Msg.PROCEDURES_CREATE_DO="Create '%1'",n.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",n.Msg.PROCEDURES_DEFNORETURN_DO="",n.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",n.Msg.PROCEDURES_DEFNORETURN_TITLE="to",n.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",n.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_DEFRETURN_RETURN="return",n.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",n.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",n.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",n.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",n.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",n.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",n.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",n.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",n.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",n.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",n.Msg.REDO="Redo",n.Msg.REMOVE_COMMENT="Remove Comment",n.Msg.RENAME_VARIABLE="Rename variable...",n.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",n.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",n.Msg.TEXT_APPEND_TITLE="to %1 append text %2",n.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",n.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",n.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",n.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",n.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",n.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",n.Msg.TEXT_CHARAT_FIRST="get first letter",n.Msg.TEXT_CHARAT_FROM_END="get letter # from end",n.Msg.TEXT_CHARAT_FROM_START="get letter #",n.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",n.Msg.TEXT_CHARAT_LAST="get last letter",n.Msg.TEXT_CHARAT_RANDOM="get random letter",n.Msg.TEXT_CHARAT_TAIL="",n.Msg.TEXT_CHARAT_TITLE="in text %1 %2",n.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",n.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",n.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",n.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",n.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",n.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",n.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",n.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",n.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",n.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",n.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",n.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",n.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",n.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",n.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",n.Msg.TEXT_GET_SUBSTRING_TAIL="",n.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",n.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",n.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",n.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",n.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",n.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",n.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",n.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",n.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",n.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",n.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",n.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",n.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",n.Msg.TEXT_LENGTH_TITLE="length of %1",n.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",n.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",n.Msg.TEXT_PRINT_TITLE="print %1",n.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",n.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",n.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",n.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",n.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",n.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",n.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",n.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",n.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",n.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",n.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",n.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",n.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",n.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",n.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",n.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",n.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",n.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",n.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",n.Msg.TODAY="Today",n.Msg.UNDO="Undo",n.Msg.UNNAMED_KEY="unnamed",n.Msg.VARIABLES_DEFAULT_NAME="item",n.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",n.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",n.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",n.Msg.VARIABLES_SET="set %1 to %2",n.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",n.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",n.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",n.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",n.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",n.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",n.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",n.Msg.CONTROLS_FOREACH_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_FOR_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=n.Msg.CONTROLS_IF_MSG_ELSEIF,n.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=n.Msg.CONTROLS_IF_MSG_ELSE,n.Msg.CONTROLS_IF_IF_TITLE_IF=n.Msg.CONTROLS_IF_MSG_IF,n.Msg.CONTROLS_IF_MSG_THEN=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.LISTS_CREATE_WITH_ITEM_TITLE=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.LISTS_GET_INDEX_HELPURL=n.Msg.LISTS_INDEX_OF_HELPURL,n.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.MATH_CHANGE_TITLE_ITEM=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.PROCEDURES_DEFRETURN_COMMENT=n.Msg.PROCEDURES_DEFNORETURN_COMMENT,n.Msg.PROCEDURES_DEFRETURN_DO=n.Msg.PROCEDURES_DEFNORETURN_DO,n.Msg.PROCEDURES_DEFRETURN_PROCEDURE=n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,n.Msg.PROCEDURES_DEFRETURN_TITLE=n.Msg.PROCEDURES_DEFNORETURN_TITLE,n.Msg.TEXT_APPEND_VARIABLE=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.MATH_HUE="230",n.Msg.LOOPS_HUE="120",n.Msg.LISTS_HUE="260",n.Msg.LOGIC_HUE="210",n.Msg.VARIABLES_HUE="330",n.Msg.TEXTS_HUE="160",n.Msg.PROCEDURES_HUE="290",n.Msg.COLOUR_HUE="20",n.Msg.VARIABLES_DYNAMIC_HUE="310",n.Msg}.apply(X,m))&&(B.exports=e)},34686:B=>{!function(){"use strict";B.exports=function X(_){return(_ instanceof Buffer?_:Buffer.from(_.toString(),"binary")).toString("base64")}}()},72167:(B,X,_)=>{"use strict";var C=_(23141),m=_(74141),e=m(C("String.prototype.indexOf"));B.exports=function(n,o){var r=C(n,!!o);return"function"==typeof r&&e(n,".prototype.")>-1?m(r):r}},74141:(B,X,_)=>{"use strict";var C=_(37341),m=_(23141),e=m("%Function.prototype.apply%"),t=m("%Function.prototype.call%"),n=m("%Reflect.apply%",!0)||C.call(t,e),o=m("%Object.getOwnPropertyDescriptor%",!0),r=m("%Object.defineProperty%",!0),a=m("%Math.max%");if(r)try{r({},"a",{value:1})}catch(R){r=null}B.exports=function(L){var W=n(C,t,arguments);if(o&&r){var nt=o(W,"length");nt.configurable&&r(W,"length",{value:1+a(0,L.length-(arguments.length-1))})}return W};var h=function(){return n(C,e,arguments)};r?r(B.exports,"apply",{value:h}):B.exports.apply=h},88941:(B,X)=>{"use strict";X.parse=function e(o,r){if("string"!=typeof o)throw new TypeError("argument str must be a string");for(var a={},h=r||{},R=o.split(";"),L=h.decode||_,W=0;W<R.length;W++){var nt=R[W],et=nt.indexOf("=");if(!(et<0)){var Et=nt.substring(0,et).trim();if(null==a[Et]){var It=nt.substring(et+1,nt.length).trim();'"'===It[0]&&(It=It.slice(1,-1)),a[Et]=n(It,L)}}}return a},X.serialize=function t(o,r,a){var h=a||{},R=h.encode||C;if("function"!=typeof R)throw new TypeError("option encode is invalid");if(!m.test(o))throw new TypeError("argument name is invalid");var L=R(r);if(L&&!m.test(L))throw new TypeError("argument val is invalid");var W=o+"="+L;if(null!=h.maxAge){var nt=h.maxAge-0;if(isNaN(nt)||!isFinite(nt))throw new TypeError("option maxAge is invalid");W+="; Max-Age="+Math.floor(nt)}if(h.domain){if(!m.test(h.domain))throw new TypeError("option domain is invalid");W+="; Domain="+h.domain}if(h.path){if(!m.test(h.path))throw new TypeError("option path is invalid");W+="; Path="+h.path}if(h.expires){if("function"!=typeof h.expires.toUTCString)throw new TypeError("option expires is invalid");W+="; Expires="+h.expires.toUTCString()}if(h.httpOnly&&(W+="; HttpOnly"),h.secure&&(W+="; Secure"),h.sameSite)switch("string"==typeof h.sameSite?h.sameSite.toLowerCase():h.sameSite){case!0:W+="; SameSite=Strict";break;case"lax":W+="; SameSite=Lax";break;case"strict":W+="; SameSite=Strict";break;case"none":W+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return W};var _=decodeURIComponent,C=encodeURIComponent,m=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function n(o,r){try{return r(o)}catch(a){return o}}},25491:(B,X,_)=>{var C=_(47471);B.exports=C},73223:(B,X,_)=>{var C=_(37722);B.exports=C},14053:(B,X,_)=>{var C=_(91081);B.exports=C},23997:(B,X,_)=>{var C=_(3352);B.exports=C},38806:(B,X,_)=>{var C=_(35558);B.exports=C},62347:(B,X,_)=>{var C=_(49127);B.exports=C},69803:(B,X,_)=>{var C=_(46726);B.exports=C},52944:(B,X,_)=>{var C=_(87968);B.exports=C},11072:(B,X,_)=>{var C=_(81040);B.exports=C},78562:(B,X,_)=>{var C=_(18047);B.exports=C},84120:(B,X,_)=>{var C=_(16521);B.exports=C},84377:(B,X,_)=>{var C=_(32825);B.exports=C},54012:(B,X,_)=>{var C=_(70977);B.exports=C},2687:(B,X,_)=>{var C=_(35019);B.exports=C},49949:(B,X,_)=>{var C=_(11830);B.exports=C},15525:(B,X,_)=>{var C=_(61453);B.exports=C},75426:(B,X,_)=>{_(80651),_(48161);var C=_(35060);B.exports=C.Array.from},11529:(B,X,_)=>{_(71006);var C=_(35060);B.exports=C.Array.isArray},73534:(B,X,_)=>{_(56874);var C=_(15547);B.exports=C("Array").concat},66213:(B,X,_)=>{_(71420),_(42271);var C=_(15547);B.exports=C("Array").entries},60212:(B,X,_)=>{_(7100);var C=_(15547);B.exports=C("Array").filter},67373:(B,X,_)=>{_(96648);var C=_(15547);B.exports=C("Array").find},88191:(B,X,_)=>{_(58665);var C=_(15547);B.exports=C("Array").forEach},41581:(B,X,_)=>{_(85124);var C=_(15547);B.exports=C("Array").includes},91855:(B,X,_)=>{_(89815);var C=_(15547);B.exports=C("Array").indexOf},77466:(B,X,_)=>{_(81171);var C=_(15547);B.exports=C("Array").map},68097:(B,X,_)=>{_(21311);var C=_(15547);B.exports=C("Array").slice},70747:(B,X,_)=>{_(19314);var C=_(15547);B.exports=C("Array").splice},45347:(B,X,_)=>{_(71420),_(80651);var C=_(56958);B.exports=C},36022:(B,X,_)=>{var C=_(76185),m=_(73534),e=Array.prototype;B.exports=function(t){var n=t.concat;return t===e||C(e,t)&&n===e.concat?m:n}},73301:(B,X,_)=>{var C=_(76185),m=_(60212),e=Array.prototype;B.exports=function(t){var n=t.filter;return t===e||C(e,t)&&n===e.filter?m:n}},38387:(B,X,_)=>{var C=_(76185),m=_(67373),e=Array.prototype;B.exports=function(t){var n=t.find;return t===e||C(e,t)&&n===e.find?m:n}},1629:(B,X,_)=>{var C=_(76185),m=_(41581),e=_(73459),t=Array.prototype,n=String.prototype;B.exports=function(o){var r=o.includes;return o===t||C(t,o)&&r===t.includes?m:"string"==typeof o||o===n||C(n,o)&&r===n.includes?e:r}},66338:(B,X,_)=>{var C=_(76185),m=_(91855),e=Array.prototype;B.exports=function(t){var n=t.indexOf;return t===e||C(e,t)&&n===e.indexOf?m:n}},57378:(B,X,_)=>{var C=_(76185),m=_(77466),e=Array.prototype;B.exports=function(t){var n=t.map;return t===e||C(e,t)&&n===e.map?m:n}},70093:(B,X,_)=>{var C=_(76185),m=_(68097),e=Array.prototype;B.exports=function(t){var n=t.slice;return t===e||C(e,t)&&n===e.slice?m:n}},16172:(B,X,_)=>{var C=_(76185),m=_(70747),e=Array.prototype;B.exports=function(t){var n=t.splice;return t===e||C(e,t)&&n===e.splice?m:n}},7706:(B,X,_)=>{var C=_(76185),m=_(9464),e=String.prototype;B.exports=function(t){var n=t.startsWith;return"string"==typeof t||t===e||C(e,t)&&n===e.startsWith?m:n}},22730:(B,X,_)=>{_(86061);var C=_(35060),m=_(30547);C.JSON||(C.JSON={stringify:JSON.stringify}),B.exports=function(t,n,o){return m(C.JSON.stringify,null,arguments)}},66619:(B,X,_)=>{_(7923);var C=_(35060);B.exports=C.Object.assign},4040:(B,X,_)=>{_(13227);var m=_(35060).Object,e=B.exports=function(n,o){return m.defineProperties(n,o)};m.defineProperties.sham&&(e.sham=!0)},7420:(B,X,_)=>{_(24526);var m=_(35060).Object,e=B.exports=function(n,o,r){return m.defineProperty(n,o,r)};m.defineProperty.sham&&(e.sham=!0)},2011:(B,X,_)=>{_(50042);var C=_(35060);B.exports=C.Object.entries},95595:(B,X,_)=>{_(49711);var m=_(35060).Object,e=B.exports=function(n,o){return m.getOwnPropertyDescriptor(n,o)};m.getOwnPropertyDescriptor.sham&&(e.sham=!0)},42093:(B,X,_)=>{_(10130);var C=_(35060);B.exports=C.Object.getOwnPropertyDescriptors},93296:(B,X,_)=>{_(83136);var C=_(35060);B.exports=C.Object.getOwnPropertySymbols},31159:(B,X,_)=>{_(68126);var C=_(35060);B.exports=C.Object.keys},9850:(B,X,_)=>{_(84722),_(71420),_(42271),_(17569),_(52568),_(64111),_(1395),_(80651);var C=_(35060);B.exports=C.Promise},73459:(B,X,_)=>{_(11568);var C=_(15547);B.exports=C("String").includes},9464:(B,X,_)=>{_(72068);var C=_(15547);B.exports=C("String").startsWith},18297:(B,X,_)=>{_(56874),_(42271),_(83136),_(9266),_(87189),_(94898),_(57133),_(3766),_(49342),_(84765),_(83606),_(25909),_(42383),_(98547),_(73418),_(82266),_(30797),_(85504),_(15551),_(61897);var C=_(35060);B.exports=C.Symbol},5933:(B,X,_)=>{_(71420),_(42271),_(80651),_(3766);var C=_(14525);B.exports=C.f("iterator")},70238:(B,X,_)=>{_(71420),_(42271),_(29960);var C=_(35060);B.exports=C.WeakMap},4517:(B,X,_)=>{B.exports=_(28966)},31584:(B,X,_)=>{B.exports=_(4863)},46025:(B,X,_)=>{B.exports=_(60407)},81613:(B,X,_)=>{B.exports=_(15053)},19775:(B,X,_)=>{B.exports=_(26892)},9483:(B,X,_)=>{B.exports=_(6834)},60061:(B,X,_)=>{B.exports=_(56012)},27254:(B,X,_)=>{B.exports=_(31459)},62691:(B,X,_)=>{B.exports=_(38689)},98244:(B,X,_)=>{B.exports=_(29882)},79668:(B,X,_)=>{B.exports=_(34312)},5797:(B,X,_)=>{B.exports=_(6334)},35248:(B,X,_)=>{B.exports=_(17229)},58316:(B,X,_)=>{B.exports=_(37329)},51479:(B,X,_)=>{B.exports=_(2407)},35392:(B,X,_)=>{B.exports=_(87135)},28966:(B,X,_)=>{var C=_(25491);B.exports=C},4863:(B,X,_)=>{var C=_(73223);B.exports=C},60407:(B,X,_)=>{var C=_(14053);B.exports=C},15053:(B,X,_)=>{var C=_(23997);B.exports=C},26892:(B,X,_)=>{var C=_(38806);B.exports=C},6834:(B,X,_)=>{var C=_(62347);B.exports=C},56012:(B,X,_)=>{var C=_(69803);B.exports=C},31459:(B,X,_)=>{var C=_(52944);B.exports=C},38689:(B,X,_)=>{var C=_(11072);B.exports=C},29882:(B,X,_)=>{var C=_(78562);B.exports=C},34312:(B,X,_)=>{var C=_(84120);B.exports=C},6334:(B,X,_)=>{var C=_(84377);B.exports=C},17229:(B,X,_)=>{var C=_(54012);B.exports=C},37329:(B,X,_)=>{var C=_(2687);_(38669),_(33483),_(65193),_(30389),B.exports=C},2407:(B,X,_)=>{var C=_(49949);_(59108),_(98488),_(65802),_(38772),_(96398),_(79699),_(86669),B.exports=C},87135:(B,X,_)=>{var C=_(15525);B.exports=C},80866:(B,X,_)=>{var C=_(22743),m=_(24732),e=_(99727),t=C.TypeError;B.exports=function(n){if(m(n))return n;throw t(e(n)+" is not a function")}},77498:(B,X,_)=>{var C=_(22743),m=_(67459),e=_(99727),t=C.TypeError;B.exports=function(n){if(m(n))return n;throw t(e(n)+" is not a constructor")}},58995:(B,X,_)=>{var C=_(22743),m=_(24732),e=C.String,t=C.TypeError;B.exports=function(n){if("object"==typeof n||m(n))return n;throw t("Can't set "+e(n)+" as a prototype")}},70677:B=>{B.exports=function(){}},43017:(B,X,_)=>{var C=_(22743),m=_(76185),e=C.TypeError;B.exports=function(t,n){if(m(n,t))return t;throw e("Incorrect invocation")}},10157:(B,X,_)=>{var C=_(22743),m=_(78103),e=C.String,t=C.TypeError;B.exports=function(n){if(m(n))return n;throw t(e(n)+" is not an object")}},35877:(B,X,_)=>{var C=_(31469);B.exports=C(function(){if("function"==typeof ArrayBuffer){var m=new ArrayBuffer(8);Object.isExtensible(m)&&Object.defineProperty(m,"a",{value:8})}})},19875:(B,X,_)=>{"use strict";var C=_(53877).forEach,e=_(52995)("forEach");B.exports=e?[].forEach:function(n){return C(this,n,arguments.length>1?arguments[1]:void 0)}},96397:(B,X,_)=>{"use strict";var C=_(22743),m=_(21137),e=_(85246),t=_(49402),n=_(3570),o=_(83672),r=_(67459),a=_(33706),h=_(3115),R=_(74471),L=_(56958),W=C.Array;B.exports=function(et){var Et=t(et),It=r(this),gt=arguments.length,wt=gt>1?arguments[1]:void 0,Ut=void 0!==wt;Ut&&(wt=m(wt,gt>2?arguments[2]:void 0));var bt,at,ft,lt,Ft,Mt,Jt=L(Et),Ct=0;if(!Jt||this==W&&o(Jt))for(bt=a(Et),at=It?new this(bt):W(bt);bt>Ct;Ct++)Mt=Ut?wt(Et[Ct],Ct):Et[Ct],h(at,Ct,Mt);else for(Ft=(lt=R(Et,Jt)).next,at=It?new this:[];!(ft=e(Ft,lt)).done;Ct++)Mt=Ut?n(lt,wt,[ft.value,Ct],!0):ft.value,h(at,Ct,Mt);return at.length=Ct,at}},68047:(B,X,_)=>{var C=_(35197),m=_(83889),e=_(33706),t=function(n){return function(o,r,a){var W,h=C(o),R=e(h),L=m(a,R);if(n&&r!=r){for(;R>L;)if((W=h[L++])!=W)return!0}else for(;R>L;L++)if((n||L in h)&&h[L]===r)return n||L||0;return!n&&-1}};B.exports={includes:t(!0),indexOf:t(!1)}},53877:(B,X,_)=>{var C=_(21137),m=_(31588),e=_(23767),t=_(49402),n=_(33706),o=_(4414),r=m([].push),a=function(h){var R=1==h,L=2==h,W=3==h,nt=4==h,et=6==h,Et=7==h,It=5==h||et;return function(gt,wt,Ut,Jt){for(var yt,ct,Ct=t(gt),bt=e(Ct),at=C(wt,Ut),ft=n(bt),lt=0,Ft=Jt||o,Mt=R?Ft(gt,ft):L||Et?Ft(gt,0):void 0;ft>lt;lt++)if((It||lt in bt)&&(ct=at(yt=bt[lt],lt,Ct),h))if(R)Mt[lt]=ct;else if(ct)switch(h){case 3:return!0;case 5:return yt;case 6:return lt;case 2:r(Mt,yt)}else switch(h){case 4:return!1;case 7:r(Mt,yt)}return et?-1:W||nt?nt:Mt}};B.exports={forEach:a(0),map:a(1),filter:a(2),some:a(3),every:a(4),find:a(5),findIndex:a(6),filterReject:a(7)}},85367:(B,X,_)=>{var C=_(31469),m=_(7084),e=_(10322),t=m("species");B.exports=function(n){return e>=51||!C(function(){var o=[];return(o.constructor={})[t]=function(){return{foo:1}},1!==o[n](Boolean).foo})}},52995:(B,X,_)=>{"use strict";var C=_(31469);B.exports=function(m,e){var t=[][m];return!!t&&C(function(){t.call(null,e||function(){return 1},1)})}},11566:(B,X,_)=>{var C=_(22743),m=_(83889),e=_(33706),t=_(3115),n=C.Array,o=Math.max;B.exports=function(r,a,h){for(var R=e(r),L=m(a,R),W=m(void 0===h?R:h,R),nt=n(o(W-L,0)),et=0;L<W;L++,et++)t(nt,et,r[L]);return nt.length=et,nt}},90840:(B,X,_)=>{var C=_(31588);B.exports=C([].slice)},69274:(B,X,_)=>{var C=_(11566),m=Math.floor,e=function(o,r){var a=o.length,h=m(a/2);return a<8?t(o,r):n(o,e(C(o,0,h),r),e(C(o,h),r),r)},t=function(o,r){for(var R,L,a=o.length,h=1;h<a;){for(L=h,R=o[h];L&&r(o[L-1],R)>0;)o[L]=o[--L];L!==h++&&(o[L]=R)}return o},n=function(o,r,a,h){for(var R=r.length,L=a.length,W=0,nt=0;W<R||nt<L;)o[W+nt]=W<R&&nt<L?h(r[W],a[nt])<=0?r[W++]:a[nt++]:W<R?r[W++]:a[nt++];return o};B.exports=e},68921:(B,X,_)=>{var C=_(22743),m=_(10371),e=_(67459),t=_(78103),o=_(7084)("species"),r=C.Array;B.exports=function(a){var h;return m(a)&&(e(h=a.constructor)&&(h===r||m(h.prototype))||t(h)&&null===(h=h[o]))&&(h=void 0),void 0===h?r:h}},4414:(B,X,_)=>{var C=_(68921);B.exports=function(m,e){return new(C(m))(0===e?0:e)}},3570:(B,X,_)=>{var C=_(10157),m=_(14964);B.exports=function(e,t,n,o){try{return o?t(C(n)[0],n[1]):t(n)}catch(r){m(e,"throw",r)}}},4402:(B,X,_)=>{var m=_(7084)("iterator"),e=!1;try{var t=0,n={next:function(){return{done:!!t++}},return:function(){e=!0}};n[m]=function(){return this},Array.from(n,function(){throw 2})}catch(o){}B.exports=function(o,r){if(!r&&!e)return!1;var a=!1;try{var h={};h[m]=function(){return{next:function(){return{done:a=!0}}}},o(h)}catch(R){}return a}},50181:(B,X,_)=>{var C=_(31588),m=C({}.toString),e=C("".slice);B.exports=function(t){return e(m(t),8,-1)}},80063:(B,X,_)=>{var C=_(22743),m=_(57575),e=_(24732),t=_(50181),o=_(7084)("toStringTag"),r=C.Object,a="Arguments"==t(function(){return arguments}());B.exports=m?t:function(R){var L,W,nt;return void 0===R?"Undefined":null===R?"Null":"string"==typeof(W=function(R,L){try{return R[L]}catch(W){}}(L=r(R),o))?W:a?t(L):"Object"==(nt=t(L))&&e(L.callee)?"Arguments":nt}},79087:(B,X,_)=>{var C=_(31588),m=Error,e=C("".replace),t=String(m("zxcasd").stack),n=/\n\s*at [^:]*:[^\n]*/,o=n.test(t);B.exports=function(r,a){if(o&&"string"==typeof r&&!m.prepareStackTrace)for(;a--;)r=e(r,n,"");return r}},75925:(B,X,_)=>{"use strict";var C=_(31588),m=_(97950),e=_(33613).getWeakData,t=_(10157),n=_(78103),o=_(43017),r=_(99883),a=_(53877),h=_(44030),R=_(34520),L=R.set,W=R.getterFor,nt=a.find,et=a.findIndex,Et=C([].splice),It=0,gt=function(Jt){return Jt.frozen||(Jt.frozen=new wt)},wt=function(){this.entries=[]},Ut=function(Jt,Ct){return nt(Jt.entries,function(bt){return bt[0]===Ct})};wt.prototype={get:function(Jt){var Ct=Ut(this,Jt);if(Ct)return Ct[1]},has:function(Jt){return!!Ut(this,Jt)},set:function(Jt,Ct){var bt=Ut(this,Jt);bt?bt[1]=Ct:this.entries.push([Jt,Ct])},delete:function(Jt){var Ct=et(this.entries,function(bt){return bt[0]===Jt});return~Ct&&Et(this.entries,Ct,1),!!~Ct}},B.exports={getConstructor:function(Jt,Ct,bt,at){var ft=Jt(function(yt,ct){o(yt,lt),L(yt,{type:Ct,id:It++,frozen:void 0}),null!=ct&&r(ct,yt[at],{that:yt,AS_ENTRIES:bt})}),lt=ft.prototype,Ft=W(Ct),Mt=function(yt,ct,rt){var se=Ft(yt),xt=e(t(ct),!0);return!0===xt?gt(se).set(ct,rt):xt[se.id]=rt,yt};return m(lt,{delete:function(yt){var ct=Ft(this);if(!n(yt))return!1;var rt=e(yt);return!0===rt?gt(ct).delete(yt):rt&&h(rt,ct.id)&&delete rt[ct.id]},has:function(ct){var rt=Ft(this);if(!n(ct))return!1;var se=e(ct);return!0===se?gt(rt).has(ct):se&&h(se,rt.id)}}),m(lt,bt?{get:function(ct){var rt=Ft(this);if(n(ct)){var se=e(ct);return!0===se?gt(rt).get(ct):se?se[rt.id]:void 0}},set:function(ct,rt){return Mt(this,ct,rt)}}:{add:function(ct){return Mt(this,ct,!0)}}),ft}}},66657:(B,X,_)=>{"use strict";var C=_(70147),m=_(22743),e=_(33613),t=_(31469),n=_(78204),o=_(99883),r=_(43017),a=_(24732),h=_(78103),R=_(63598),L=_(13528).f,W=_(53877).forEach,nt=_(25847),et=_(34520),Et=et.set,It=et.getterFor;B.exports=function(gt,wt,Ut){var Ft,Jt=-1!==gt.indexOf("Map"),Ct=-1!==gt.indexOf("Weak"),bt=Jt?"set":"add",at=m[gt],ft=at&&at.prototype,lt={};if(nt&&a(at)&&(Ct||ft.forEach&&!t(function(){(new at).entries().next()}))){var Mt=(Ft=wt(function(ct,rt){Et(r(ct,Mt),{type:gt,collection:new at}),null!=rt&&o(rt,ct[bt],{that:ct,AS_ENTRIES:Jt})})).prototype,yt=It(gt);W(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(ct){var rt="add"==ct||"set"==ct;ct in ft&&(!Ct||"clear"!=ct)&&n(Mt,ct,function(se,xt){var Lt=yt(this).collection;if(!rt&&Ct&&!h(se))return"get"==ct&&void 0;var de=Lt[ct](0===se?0:se,xt);return rt?this:de})}),Ct||L(Mt,"size",{configurable:!0,get:function(){return yt(this).collection.size}})}else Ft=Ut.getConstructor(wt,gt,Jt,bt),e.enable();return R(Ft,gt,!1,!0),lt[gt]=Ft,C({global:!0,forced:!0},lt),Ct||Ut.setStrong(Ft,gt,Jt),Ft}},47902:(B,X,_)=>{var C=_(44030),m=_(68566),e=_(26552),t=_(13528);B.exports=function(n,o,r){for(var a=m(o),h=t.f,R=e.f,L=0;L<a.length;L++){var W=a[L];!C(n,W)&&(!r||!C(r,W))&&h(n,W,R(o,W))}}},15268:(B,X,_)=>{var m=_(7084)("match");B.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[m]=!1,"/./"[e](t)}catch(o){}}return!1}},87275:(B,X,_)=>{var C=_(31469);B.exports=!C(function(){function m(){}return m.prototype.constructor=null,Object.getPrototypeOf(new m)!==m.prototype})},690:(B,X,_)=>{"use strict";var C=_(39336).IteratorPrototype,m=_(80332),e=_(41137),t=_(63598),n=_(44362),o=function(){return this};B.exports=function(r,a,h,R){var L=a+" Iterator";return r.prototype=m(C,{next:e(+!R,h)}),t(r,L,!1,!0),n[L]=o,r}},78204:(B,X,_)=>{var C=_(25847),m=_(13528),e=_(41137);B.exports=C?function(t,n,o){return m.f(t,n,e(1,o))}:function(t,n,o){return t[n]=o,t}},41137:B=>{B.exports=function(X,_){return{enumerable:!(1&X),configurable:!(2&X),writable:!(4&X),value:_}}},3115:(B,X,_)=>{"use strict";var C=_(73540),m=_(13528),e=_(41137);B.exports=function(t,n,o){var r=C(n);r in t?m.f(t,r,e(0,o)):t[r]=o}},20569:(B,X,_)=>{var C=_(78204);B.exports=function(m,e,t,n){return n&&n.enumerable?m[e]=t:C(m,e,t),m}},97950:(B,X,_)=>{var C=_(20569);B.exports=function(m,e,t){for(var n in e)t&&t.unsafe&&m[n]?m[n]=e[n]:C(m,n,e[n],t);return m}},52928:(B,X,_)=>{"use strict";var C=_(70147),m=_(85246),e=_(92838),t=_(56089),n=_(24732),o=_(690),r=_(84361),a=_(91100),h=_(63598),R=_(78204),L=_(20569),W=_(7084),nt=_(44362),et=_(39336),Et=t.PROPER,It=t.CONFIGURABLE,gt=et.IteratorPrototype,wt=et.BUGGY_SAFARI_ITERATORS,Ut=W("iterator"),Ct="values",bt="entries",at=function(){return this};B.exports=function(ft,lt,Ft,Mt,yt,ct,rt){o(Ft,lt,Mt);var Ne,qe,Di,se=function(ei){if(ei===yt&&ce)return ce;if(!wt&&ei in de)return de[ei];switch(ei){case"keys":case Ct:case bt:return function(){return new Ft(this,ei)}}return function(){return new Ft(this)}},xt=lt+" Iterator",Lt=!1,de=ft.prototype,_e=de[Ut]||de["@@iterator"]||yt&&de[yt],ce=!wt&&_e||se(yt),Ae="Array"==lt&&de.entries||_e;if(Ae&&(Ne=r(Ae.call(new ft)))!==Object.prototype&&Ne.next&&(!e&&r(Ne)!==gt&&(a?a(Ne,gt):n(Ne[Ut])||L(Ne,Ut,at)),h(Ne,xt,!0,!0),e&&(nt[xt]=at)),Et&&yt==Ct&&_e&&_e.name!==Ct&&(!e&&It?R(de,"name",Ct):(Lt=!0,ce=function(){return m(_e,this)})),yt)if(qe={values:se(Ct),keys:ct?ce:se("keys"),entries:se(bt)},rt)for(Di in qe)(wt||Lt||!(Di in de))&&L(de,Di,qe[Di]);else C({target:lt,proto:!0,forced:wt||Lt},qe);return(!e||rt)&&de[Ut]!==ce&&L(de,Ut,ce,{name:yt}),nt[lt]=ce,qe}},59478:(B,X,_)=>{var C=_(35060),m=_(44030),e=_(14525),t=_(13528).f;B.exports=function(n){var o=C.Symbol||(C.Symbol={});m(o,n)||t(o,n,{value:e.f(n)})}},25847:(B,X,_)=>{var C=_(31469);B.exports=!C(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},97947:(B,X,_)=>{var C=_(22743),m=_(78103),e=C.document,t=m(e)&&m(e.createElement);B.exports=function(n){return t?e.createElement(n):{}}},9113:B=>{B.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},28150:B=>{B.exports="object"==typeof window&&"object"!=typeof Deno},93221:(B,X,_)=>{var C=_(91339),m=_(22743);B.exports=/ipad|iphone|ipod/i.test(C)&&void 0!==m.Pebble},49612:(B,X,_)=>{var C=_(91339);B.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(C)},70751:(B,X,_)=>{var C=_(50181),m=_(22743);B.exports="process"==C(m.process)},25330:(B,X,_)=>{var C=_(91339);B.exports=/web0s(?!.*chrome)/i.test(C)},91339:(B,X,_)=>{var C=_(85697);B.exports=C("navigator","userAgent")||""},10322:(B,X,_)=>{var r,a,C=_(22743),m=_(91339),e=C.process,t=C.Deno,n=e&&e.versions||t&&t.version,o=n&&n.v8;o&&(a=(r=o.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!a&&m&&(!(r=m.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=m.match(/Chrome\/(\d+)/))&&(a=+r[1]),B.exports=a},15547:(B,X,_)=>{var C=_(35060);B.exports=function(m){return C[m+"Prototype"]}},44169:B=>{B.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},92335:(B,X,_)=>{var C=_(31469),m=_(41137);B.exports=!C(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",m(1,7)),7!==e.stack)})},70147:(B,X,_)=>{"use strict";var C=_(22743),m=_(30547),e=_(31588),t=_(24732),n=_(26552).f,o=_(35059),r=_(35060),a=_(21137),h=_(78204),R=_(44030),L=function(W){var nt=function(et,Et,It){if(this instanceof nt){switch(arguments.length){case 0:return new W;case 1:return new W(et);case 2:return new W(et,Et)}return new W(et,Et,It)}return m(W,this,arguments)};return nt.prototype=W.prototype,nt};B.exports=function(W,nt){var bt,at,ft,lt,Ft,Mt,yt,ct,et=W.target,Et=W.global,It=W.stat,gt=W.proto,wt=Et?C:It?C[et]:(C[et]||{}).prototype,Ut=Et?r:r[et]||h(r,et,{})[et],Jt=Ut.prototype;for(ft in nt)bt=!o(Et?ft:et+(It?".":"#")+ft,W.forced)&&wt&&R(wt,ft),Ft=Ut[ft],bt&&(Mt=W.noTargetGet?(ct=n(wt,ft))&&ct.value:wt[ft]),lt=bt&&Mt?Mt:nt[ft],(!bt||typeof Ft!=typeof lt)&&(yt=W.bind&&bt?a(lt,C):W.wrap&&bt?L(lt):gt&&t(lt)?e(lt):lt,(W.sham||lt&&lt.sham||Ft&&Ft.sham)&&h(yt,"sham",!0),h(Ut,ft,yt),gt&&(R(r,at=et+"Prototype")||h(r,at,{}),h(r[at],ft,lt),W.real&&Jt&&!Jt[ft]&&h(Jt,ft,lt)))}},31469:B=>{B.exports=function(X){try{return!!X()}catch(_){return!0}}},23216:(B,X,_)=>{var C=_(31469);B.exports=!C(function(){return Object.isExtensible(Object.preventExtensions({}))})},30547:(B,X,_)=>{var C=_(74973),m=Function.prototype,e=m.apply,t=m.call;B.exports="object"==typeof Reflect&&Reflect.apply||(C?t.bind(e):function(){return t.apply(e,arguments)})},21137:(B,X,_)=>{var C=_(31588),m=_(80866),e=_(74973),t=C(C.bind);B.exports=function(n,o){return m(n),void 0===o?n:e?t(n,o):function(){return n.apply(o,arguments)}}},74973:(B,X,_)=>{var C=_(31469);B.exports=!C(function(){var m=function(){}.bind();return"function"!=typeof m||m.hasOwnProperty("prototype")})},85246:(B,X,_)=>{var C=_(74973),m=Function.prototype.call;B.exports=C?m.bind(m):function(){return m.apply(m,arguments)}},56089:(B,X,_)=>{var C=_(25847),m=_(44030),e=Function.prototype,t=C&&Object.getOwnPropertyDescriptor,n=m(e,"name"),o=n&&"something"===function(){}.name,r=n&&(!C||C&&t(e,"name").configurable);B.exports={EXISTS:n,PROPER:o,CONFIGURABLE:r}},31588:(B,X,_)=>{var C=_(74973),m=Function.prototype,t=m.call,n=C&&m.bind.bind(t,t);B.exports=C?function(o){return o&&n(o)}:function(o){return o&&function(){return t.apply(o,arguments)}}},85697:(B,X,_)=>{var C=_(35060),m=_(22743),e=_(24732),t=function(n){return e(n)?n:void 0};B.exports=function(n,o){return arguments.length<2?t(C[n])||t(m[n]):C[n]&&C[n][o]||m[n]&&m[n][o]}},56958:(B,X,_)=>{var C=_(80063),m=_(30047),e=_(44362),n=_(7084)("iterator");B.exports=function(o){if(null!=o)return m(o,n)||m(o,"@@iterator")||e[C(o)]}},74471:(B,X,_)=>{var C=_(22743),m=_(85246),e=_(80866),t=_(10157),n=_(99727),o=_(56958),r=C.TypeError;B.exports=function(a,h){var R=arguments.length<2?o(a):h;if(e(R))return t(m(R,a));throw r(n(a)+" is not iterable")}},30047:(B,X,_)=>{var C=_(80866);B.exports=function(m,e){var t=m[e];return null==t?void 0:C(t)}},22743:B=>{var X=function(_){return _&&_.Math==Math&&_};B.exports=X("object"==typeof globalThis&&globalThis)||X("object"==typeof window&&window)||X("object"==typeof self&&self)||X("object"==typeof global&&global)||function(){return this}()||Function("return this")()},44030:(B,X,_)=>{var C=_(31588),m=_(49402),e=C({}.hasOwnProperty);B.exports=Object.hasOwn||function(n,o){return e(m(n),o)}},89675:B=>{B.exports={}},18819:(B,X,_)=>{var C=_(22743);B.exports=function(m,e){var t=C.console;t&&t.error&&(1==arguments.length?t.error(m):t.error(m,e))}},93074:(B,X,_)=>{var C=_(85697);B.exports=C("document","documentElement")},5223:(B,X,_)=>{var C=_(25847),m=_(31469),e=_(97947);B.exports=!C&&!m(function(){return 7!=Object.defineProperty(e("div"),"a",{get:function(){return 7}}).a})},23767:(B,X,_)=>{var C=_(22743),m=_(31588),e=_(31469),t=_(50181),n=C.Object,o=m("".split);B.exports=e(function(){return!n("z").propertyIsEnumerable(0)})?function(r){return"String"==t(r)?o(r,""):n(r)}:n},13271:(B,X,_)=>{var C=_(31588),m=_(24732),e=_(65732),t=C(Function.toString);m(e.inspectSource)||(e.inspectSource=function(n){return t(n)}),B.exports=e.inspectSource},42783:(B,X,_)=>{var C=_(78103),m=_(78204);B.exports=function(e,t){C(t)&&"cause"in t&&m(e,"cause",t.cause)}},33613:(B,X,_)=>{var C=_(70147),m=_(31588),e=_(89675),t=_(78103),n=_(44030),o=_(13528).f,r=_(42769),a=_(24281),h=_(19086),R=_(7226),L=_(23216),W=!1,nt=R("meta"),et=0,Et=function(Ct){o(Ct,nt,{value:{objectID:"O"+et++,weakData:{}}})},Jt=B.exports={enable:function(){Jt.enable=function(){},W=!0;var Ct=r.f,bt=m([].splice),at={};at[nt]=1,Ct(at).length&&(r.f=function(ft){for(var lt=Ct(ft),Ft=0,Mt=lt.length;Ft<Mt;Ft++)if(lt[Ft]===nt){bt(lt,Ft,1);break}return lt},C({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:a.f}))},fastKey:function(Ct,bt){if(!t(Ct))return"symbol"==typeof Ct?Ct:("string"==typeof Ct?"S":"P")+Ct;if(!n(Ct,nt)){if(!h(Ct))return"F";if(!bt)return"E";Et(Ct)}return Ct[nt].objectID},getWeakData:function(Ct,bt){if(!n(Ct,nt)){if(!h(Ct))return!0;if(!bt)return!1;Et(Ct)}return Ct[nt].weakData},onFreeze:function(Ct){return L&&W&&h(Ct)&&!n(Ct,nt)&&Et(Ct),Ct}};e[nt]=!0},34520:(B,X,_)=>{var nt,et,Et,C=_(63185),m=_(22743),e=_(31588),t=_(78103),n=_(78204),o=_(44030),r=_(65732),a=_(35027),h=_(89675),R="Object already initialized",L=m.TypeError;if(C||r.state){var wt=r.state||(r.state=new(0,m.WeakMap)),Ut=e(wt.get),Jt=e(wt.has),Ct=e(wt.set);nt=function(at,ft){if(Jt(wt,at))throw new L(R);return ft.facade=at,Ct(wt,at,ft),ft},et=function(at){return Ut(wt,at)||{}},Et=function(at){return Jt(wt,at)}}else{var bt=a("state");h[bt]=!0,nt=function(at,ft){if(o(at,bt))throw new L(R);return ft.facade=at,n(at,bt,ft),ft},et=function(at){return o(at,bt)?at[bt]:{}},Et=function(at){return o(at,bt)}}B.exports={set:nt,get:et,has:Et,enforce:function(at){return Et(at)?et(at):nt(at,{})},getterFor:function(at){return function(ft){var lt;if(!t(ft)||(lt=et(ft)).type!==at)throw L("Incompatible receiver, "+at+" required");return lt}}}},83672:(B,X,_)=>{var C=_(7084),m=_(44362),e=C("iterator"),t=Array.prototype;B.exports=function(n){return void 0!==n&&(m.Array===n||t[e]===n)}},10371:(B,X,_)=>{var C=_(50181);B.exports=Array.isArray||function(e){return"Array"==C(e)}},24732:B=>{B.exports=function(X){return"function"==typeof X}},67459:(B,X,_)=>{var C=_(31588),m=_(31469),e=_(24732),t=_(80063),n=_(85697),o=_(13271),r=function(){},a=[],h=n("Reflect","construct"),R=/^\s*(?:class|function)\b/,L=C(R.exec),W=!R.exec(r),nt=function(It){if(!e(It))return!1;try{return h(r,a,It),!0}catch(gt){return!1}},et=function(It){if(!e(It))return!1;switch(t(It)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return W||!!L(R,o(It))}catch(gt){return!0}};et.sham=!0,B.exports=!h||m(function(){var Et;return nt(nt.call)||!nt(Object)||!nt(function(){Et=!0})||Et})?et:nt},35059:(B,X,_)=>{var C=_(31469),m=_(24732),e=/#|\.prototype\./,t=function(h,R){var L=o[n(h)];return L==a||L!=r&&(m(R)?C(R):!!R)},n=t.normalize=function(h){return String(h).replace(e,".").toLowerCase()},o=t.data={},r=t.NATIVE="N",a=t.POLYFILL="P";B.exports=t},78103:(B,X,_)=>{var C=_(24732);B.exports=function(m){return"object"==typeof m?null!==m:C(m)}},92838:B=>{B.exports=!0},82888:(B,X,_)=>{var C=_(78103),m=_(50181),t=_(7084)("match");B.exports=function(n){var o;return C(n)&&(void 0!==(o=n[t])?!!o:"RegExp"==m(n))}},90094:(B,X,_)=>{var C=_(22743),m=_(85697),e=_(24732),t=_(76185),n=_(43587),o=C.Object;B.exports=n?function(r){return"symbol"==typeof r}:function(r){var a=m("Symbol");return e(a)&&t(a.prototype,o(r))}},99883:(B,X,_)=>{var C=_(22743),m=_(21137),e=_(85246),t=_(10157),n=_(99727),o=_(83672),r=_(33706),a=_(76185),h=_(74471),R=_(56958),L=_(14964),W=C.TypeError,nt=function(Et,It){this.stopped=Et,this.result=It},et=nt.prototype;B.exports=function(Et,It,gt){var at,ft,lt,Ft,Mt,yt,ct,Ut=!(!gt||!gt.AS_ENTRIES),Jt=!(!gt||!gt.IS_ITERATOR),Ct=!(!gt||!gt.INTERRUPTED),bt=m(It,gt&&gt.that),rt=function(xt){return at&&L(at,"normal",xt),new nt(!0,xt)},se=function(xt){return Ut?(t(xt),Ct?bt(xt[0],xt[1],rt):bt(xt[0],xt[1])):Ct?bt(xt,rt):bt(xt)};if(Jt)at=Et;else{if(!(ft=R(Et)))throw W(n(Et)+" is not iterable");if(o(ft)){for(lt=0,Ft=r(Et);Ft>lt;lt++)if((Mt=se(Et[lt]))&&a(et,Mt))return Mt;return new nt(!1)}at=h(Et,ft)}for(yt=at.next;!(ct=e(yt,at)).done;){try{Mt=se(ct.value)}catch(xt){L(at,"throw",xt)}if("object"==typeof Mt&&Mt&&a(et,Mt))return Mt}return new nt(!1)}},14964:(B,X,_)=>{var C=_(85246),m=_(10157),e=_(30047);B.exports=function(t,n,o){var r,a;m(t);try{if(!(r=e(t,"return"))){if("throw"===n)throw o;return o}r=C(r,t)}catch(h){a=!0,r=h}if("throw"===n)throw o;if(a)throw r;return m(r),o}},39336:(B,X,_)=>{"use strict";var R,L,W,C=_(31469),m=_(24732),e=_(80332),t=_(84361),n=_(20569),o=_(7084),r=_(92838),a=o("iterator"),h=!1;[].keys&&("next"in(W=[].keys())?(L=t(t(W)))!==Object.prototype&&(R=L):h=!0),null==R||C(function(){var et={};return R[a].call(et)!==et})?R={}:r&&(R=e(R)),m(R[a])||n(R,a,function(){return this}),B.exports={IteratorPrototype:R,BUGGY_SAFARI_ITERATORS:h}},44362:B=>{B.exports={}},33706:(B,X,_)=>{var C=_(61468);B.exports=function(m){return C(m.length)}},72845:(B,X,_)=>{var Et,It,gt,wt,Ut,Jt,Ct,bt,C=_(22743),m=_(21137),e=_(26552).f,t=_(76401).set,n=_(49612),o=_(93221),r=_(25330),a=_(70751),h=C.MutationObserver||C.WebKitMutationObserver,R=C.document,L=C.process,W=C.Promise,nt=e(C,"queueMicrotask"),et=nt&&nt.value;et||(Et=function(){var at,ft;for(a&&(at=L.domain)&&at.exit();It;){ft=It.fn,It=It.next;try{ft()}catch(lt){throw It?wt():gt=void 0,lt}}gt=void 0,at&&at.enter()},n||a||r||!h||!R?!o&&W&&W.resolve?((Ct=W.resolve(void 0)).constructor=W,bt=m(Ct.then,Ct),wt=function(){bt(Et)}):a?wt=function(){L.nextTick(Et)}:(t=m(t,C),wt=function(){t(Et)}):(Ut=!0,Jt=R.createTextNode(""),new h(Et).observe(Jt,{characterData:!0}),wt=function(){Jt.data=Ut=!Ut})),B.exports=et||function(at){var ft={fn:at,next:void 0};gt&&(gt.next=ft),It||(It=ft,wt()),gt=ft}},64580:(B,X,_)=>{var C=_(62581);B.exports=C&&!!Symbol.for&&!!Symbol.keyFor},62581:(B,X,_)=>{var C=_(10322),m=_(31469);B.exports=!!Object.getOwnPropertySymbols&&!m(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&C&&C<41})},2049:(B,X,_)=>{var C=_(31469),m=_(7084),e=_(92838),t=m("iterator");B.exports=!C(function(){var n=new URL("b?a=1&b=2&c=3","http://a"),o=n.searchParams,r="";return n.pathname="c%20d",o.forEach(function(a,h){o.delete("b"),r+=h+a}),e&&!n.toJSON||!o.sort||"http://a/c%20d?a=1&c=3"!==n.href||"3"!==o.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!o[t]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})},63185:(B,X,_)=>{var C=_(22743),m=_(24732),e=_(13271),t=C.WeakMap;B.exports=m(t)&&/native code/.test(e(t))},39802:(B,X,_)=>{"use strict";var C=_(80866),m=function(e){var t,n;this.promise=new e(function(o,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=o,n=r}),this.resolve=C(t),this.reject=C(n)};B.exports.f=function(e){return new m(e)}},58823:(B,X,_)=>{var C=_(94506);B.exports=function(m,e){return void 0===m?arguments.length<2?"":e:C(m)}},43353:(B,X,_)=>{var C=_(22743),m=_(82888),e=C.TypeError;B.exports=function(t){if(m(t))throw e("The method doesn't accept regular expressions");return t}},94347:(B,X,_)=>{"use strict";var C=_(25847),m=_(31588),e=_(85246),t=_(31469),n=_(77978),o=_(30233),r=_(19664),a=_(49402),h=_(23767),R=Object.assign,L=Object.defineProperty,W=m([].concat);B.exports=!R||t(function(){if(C&&1!==R({b:1},R(L({},"a",{enumerable:!0,get:function(){L(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var nt={},et={},Et=Symbol(),It="abcdefghijklmnopqrst";return nt[Et]=7,It.split("").forEach(function(gt){et[gt]=gt}),7!=R({},nt)[Et]||n(R({},et)).join("")!=It})?function(et,Et){for(var It=a(et),gt=arguments.length,wt=1,Ut=o.f,Jt=r.f;gt>wt;)for(var lt,Ct=h(arguments[wt++]),bt=Ut?W(n(Ct),Ut(Ct)):n(Ct),at=bt.length,ft=0;at>ft;)lt=bt[ft++],(!C||e(Jt,Ct,lt))&&(It[lt]=Ct[lt]);return It}:R},80332:(B,X,_)=>{var gt,C=_(10157),m=_(68453),e=_(44169),t=_(89675),n=_(93074),o=_(97947),r=_(35027),R="prototype",L="script",W=r("IE_PROTO"),nt=function(){},et=function(Ut){return"<"+L+">"+Ut+"</"+L+">"},Et=function(Ut){Ut.write(et("")),Ut.close();var Jt=Ut.parentWindow.Object;return Ut=null,Jt},wt=function(){try{gt=new ActiveXObject("htmlfile")}catch(Jt){}wt="undefined"!=typeof document?document.domain&&gt?Et(gt):function(){var Ct,Ut=o("iframe");return Ut.style.display="none",n.appendChild(Ut),Ut.src=String("javascript:"),(Ct=Ut.contentWindow.document).open(),Ct.write(et("document.F=Object")),Ct.close(),Ct.F}():Et(gt);for(var Ut=e.length;Ut--;)delete wt[R][e[Ut]];return wt()};t[W]=!0,B.exports=Object.create||function(Jt,Ct){var bt;return null!==Jt?(nt[R]=C(Jt),bt=new nt,nt[R]=null,bt[W]=Jt):bt=wt(),void 0===Ct?bt:m.f(bt,Ct)}},68453:(B,X,_)=>{var C=_(25847),m=_(49828),e=_(13528),t=_(10157),n=_(35197),o=_(77978);X.f=C&&!m?Object.defineProperties:function(a,h){t(a);for(var et,R=n(h),L=o(h),W=L.length,nt=0;W>nt;)e.f(a,et=L[nt++],R[et]);return a}},13528:(B,X,_)=>{var C=_(22743),m=_(25847),e=_(5223),t=_(49828),n=_(10157),o=_(73540),r=C.TypeError,a=Object.defineProperty,h=Object.getOwnPropertyDescriptor,R="enumerable",L="configurable",W="writable";X.f=m?t?function(et,Et,It){if(n(et),Et=o(Et),n(It),"function"==typeof et&&"prototype"===Et&&"value"in It&&W in It&&!It[W]){var gt=h(et,Et);gt&&gt[W]&&(et[Et]=It.value,It={configurable:L in It?It[L]:gt[L],enumerable:R in It?It[R]:gt[R],writable:!1})}return a(et,Et,It)}:a:function(et,Et,It){if(n(et),Et=o(Et),n(It),e)try{return a(et,Et,It)}catch(gt){}if("get"in It||"set"in It)throw r("Accessors not supported");return"value"in It&&(et[Et]=It.value),et}},26552:(B,X,_)=>{var C=_(25847),m=_(85246),e=_(19664),t=_(41137),n=_(35197),o=_(73540),r=_(44030),a=_(5223),h=Object.getOwnPropertyDescriptor;X.f=C?h:function(L,W){if(L=n(L),W=o(W),a)try{return h(L,W)}catch(nt){}if(r(L,W))return t(!m(e.f,L,W),L[W])}},24281:(B,X,_)=>{var C=_(50181),m=_(35197),e=_(42769).f,t=_(11566),n="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];B.exports.f=function(a){return n&&"Window"==C(a)?function(r){try{return e(r)}catch(a){return t(n)}}(a):e(m(a))}},42769:(B,X,_)=>{var C=_(1991),e=_(44169).concat("length","prototype");X.f=Object.getOwnPropertyNames||function(n){return C(n,e)}},30233:(B,X)=>{X.f=Object.getOwnPropertySymbols},84361:(B,X,_)=>{var C=_(22743),m=_(44030),e=_(24732),t=_(49402),n=_(35027),o=_(87275),r=n("IE_PROTO"),a=C.Object,h=a.prototype;B.exports=o?a.getPrototypeOf:function(R){var L=t(R);if(m(L,r))return L[r];var W=L.constructor;return e(W)&&L instanceof W?W.prototype:L instanceof a?h:null}},19086:(B,X,_)=>{var C=_(31469),m=_(78103),e=_(50181),t=_(35877),n=Object.isExtensible,o=C(function(){n(1)});B.exports=o||t?function(a){return!(!m(a)||t&&"ArrayBuffer"==e(a))&&(!n||n(a))}:n},76185:(B,X,_)=>{var C=_(31588);B.exports=C({}.isPrototypeOf)},1991:(B,X,_)=>{var C=_(31588),m=_(44030),e=_(35197),t=_(68047).indexOf,n=_(89675),o=C([].push);B.exports=function(r,a){var W,h=e(r),R=0,L=[];for(W in h)!m(n,W)&&m(h,W)&&o(L,W);for(;a.length>R;)m(h,W=a[R++])&&(~t(L,W)||o(L,W));return L}},77978:(B,X,_)=>{var C=_(1991),m=_(44169);B.exports=Object.keys||function(t){return C(t,m)}},19664:(B,X)=>{"use strict";var _={}.propertyIsEnumerable,C=Object.getOwnPropertyDescriptor,m=C&&!_.call({1:2},1);X.f=m?function(t){var n=C(this,t);return!!n&&n.enumerable}:_},91100:(B,X,_)=>{var C=_(31588),m=_(10157),e=_(58995);B.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var o,t=!1,n={};try{(o=C(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(r){}return function(a,h){return m(a),e(h),t?o(a,h):a.__proto__=h,a}}():void 0)},6936:(B,X,_)=>{var C=_(25847),m=_(31588),e=_(77978),t=_(35197),o=m(_(19664).f),r=m([].push),a=function(h){return function(R){for(var It,L=t(R),W=e(L),nt=W.length,et=0,Et=[];nt>et;)It=W[et++],(!C||o(L,It))&&r(Et,h?[It,L[It]]:L[It]);return Et}};B.exports={entries:a(!0),values:a(!1)}},93005:(B,X,_)=>{"use strict";var C=_(57575),m=_(80063);B.exports=C?{}.toString:function(){return"[object "+m(this)+"]"}},75671:(B,X,_)=>{var C=_(22743),m=_(85246),e=_(24732),t=_(78103),n=C.TypeError;B.exports=function(o,r){var a,h;if("string"===r&&e(a=o.toString)&&!t(h=m(a,o))||e(a=o.valueOf)&&!t(h=m(a,o))||"string"!==r&&e(a=o.toString)&&!t(h=m(a,o)))return h;throw n("Can't convert object to primitive value")}},68566:(B,X,_)=>{var C=_(85697),m=_(31588),e=_(42769),t=_(30233),n=_(10157),o=m([].concat);B.exports=C("Reflect","ownKeys")||function(a){var h=e.f(n(a)),R=t.f;return R?o(h,R(a)):h}},35060:B=>{B.exports={}},50819:B=>{B.exports=function(X){try{return{error:!1,value:X()}}catch(_){return{error:!0,value:_}}}},96799:(B,X,_)=>{var C=_(22743),m=_(31762),e=_(24732),t=_(35059),n=_(13271),o=_(7084),r=_(28150),a=_(92838),h=_(10322),R=m&&m.prototype,L=o("species"),W=!1,nt=e(C.PromiseRejectionEvent),et=t("Promise",function(){var Et=n(m),It=Et!==String(m);if(!It&&66===h||a&&(!R.catch||!R.finally))return!0;if(h>=51&&/native code/.test(Et))return!1;var gt=new m(function(Jt){Jt(1)}),wt=function(Jt){Jt(function(){},function(){})};return(gt.constructor={})[L]=wt,!(W=gt.then(function(){})instanceof wt)||!It&&r&&!nt});B.exports={CONSTRUCTOR:et,REJECTION_EVENT:nt,SUBCLASSING:W}},31762:(B,X,_)=>{var C=_(22743);B.exports=C.Promise},92273:(B,X,_)=>{var C=_(10157),m=_(78103),e=_(39802);B.exports=function(t,n){if(C(t),m(n)&&n.constructor===t)return n;var o=e.f(t);return(0,o.resolve)(n),o.promise}},65194:(B,X,_)=>{var C=_(31762),m=_(4402),e=_(96799).CONSTRUCTOR;B.exports=e||!m(function(t){C.all(t).then(void 0,function(){})})},75893:B=>{var X=function(){this.head=null,this.tail=null};X.prototype={add:function(_){var C={item:_,next:null};this.head?this.tail.next=C:this.head=C,this.tail=C},get:function(){var _=this.head;if(_)return this.head=_.next,this.tail===_&&(this.tail=null),_.item}},B.exports=X},86213:(B,X,_)=>{var m=_(22743).TypeError;B.exports=function(e){if(null==e)throw m("Can't call method on "+e);return e}},41728:(B,X,_)=>{var C=_(22743),m=Object.defineProperty;B.exports=function(e,t){try{m(C,e,{value:t,configurable:!0,writable:!0})}catch(n){C[e]=t}return t}},13961:(B,X,_)=>{"use strict";var C=_(85697),m=_(13528),e=_(7084),t=_(25847),n=e("species");B.exports=function(o){var r=C(o);t&&r&&!r[n]&&(0,m.f)(r,n,{configurable:!0,get:function(){return this}})}},63598:(B,X,_)=>{var C=_(57575),m=_(13528).f,e=_(78204),t=_(44030),n=_(93005),r=_(7084)("toStringTag");B.exports=function(a,h,R,L){if(a){var W=R?a:a.prototype;t(W,r)||m(W,r,{configurable:!0,value:h}),L&&!C&&e(W,"toString",n)}}},35027:(B,X,_)=>{var C=_(843),m=_(7226),e=C("keys");B.exports=function(t){return e[t]||(e[t]=m(t))}},65732:(B,X,_)=>{var C=_(22743),m=_(41728),e="__core-js_shared__",t=C[e]||m(e,{});B.exports=t},843:(B,X,_)=>{var C=_(92838),m=_(65732);(B.exports=function(e,t){return m[e]||(m[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.5",mode:C?"pure":"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.5/LICENSE",source:"https://github.com/zloirock/core-js"})},85972:(B,X,_)=>{var C=_(10157),m=_(77498),t=_(7084)("species");B.exports=function(n,o){var a,r=C(n).constructor;return void 0===r||null==(a=C(r)[t])?o:m(a)}},93071:(B,X,_)=>{var C=_(31588),m=_(21524),e=_(94506),t=_(86213),n=C("".charAt),o=C("".charCodeAt),r=C("".slice),a=function(h){return function(R,L){var Et,It,W=e(t(R)),nt=m(L),et=W.length;return nt<0||nt>=et?h?"":void 0:(Et=o(W,nt))<55296||Et>56319||nt+1===et||(It=o(W,nt+1))<56320||It>57343?h?n(W,nt):Et:h?r(W,nt,nt+2):It-56320+(Et-55296<<10)+65536}};B.exports={codeAt:a(!1),charAt:a(!0)}},33169:(B,X,_)=>{var C=_(85246),m=_(85697),e=_(7084),t=_(20569);B.exports=function(){var n=m("Symbol"),o=n&&n.prototype,r=o&&o.valueOf,a=e("toPrimitive");o&&!o[a]&&t(o,a,function(h){return C(r,this)},{arity:1})}},76401:(B,X,_)=>{var at,ft,lt,Ft,C=_(22743),m=_(30547),e=_(21137),t=_(24732),n=_(44030),o=_(31469),r=_(93074),a=_(90840),h=_(97947),R=_(1467),L=_(49612),W=_(70751),nt=C.setImmediate,et=C.clearImmediate,Et=C.process,It=C.Dispatch,gt=C.Function,wt=C.MessageChannel,Ut=C.String,Jt=0,Ct={},bt="onreadystatechange";try{at=C.location}catch(se){}var Mt=function(se){if(n(Ct,se)){var xt=Ct[se];delete Ct[se],xt()}},yt=function(se){return function(){Mt(se)}},ct=function(se){Mt(se.data)},rt=function(se){C.postMessage(Ut(se),at.protocol+"//"+at.host)};(!nt||!et)&&(nt=function(xt){R(arguments.length,1);var Lt=t(xt)?xt:gt(xt),de=a(arguments,1);return Ct[++Jt]=function(){m(Lt,void 0,de)},ft(Jt),Jt},et=function(xt){delete Ct[xt]},W?ft=function(se){Et.nextTick(yt(se))}:It&&It.now?ft=function(se){It.now(yt(se))}:wt&&!L?(Ft=(lt=new wt).port2,lt.port1.onmessage=ct,ft=e(Ft.postMessage,Ft)):C.addEventListener&&t(C.postMessage)&&!C.importScripts&&at&&"file:"!==at.protocol&&!o(rt)?(ft=rt,C.addEventListener("message",ct,!1)):ft=bt in h("script")?function(se){r.appendChild(h("script"))[bt]=function(){r.removeChild(this),Mt(se)}}:function(se){setTimeout(yt(se),0)}),B.exports={set:nt,clear:et}},83889:(B,X,_)=>{var C=_(21524),m=Math.max,e=Math.min;B.exports=function(t,n){var o=C(t);return o<0?m(o+n,0):e(o,n)}},35197:(B,X,_)=>{var C=_(23767),m=_(86213);B.exports=function(e){return C(m(e))}},21524:B=>{var X=Math.ceil,_=Math.floor;B.exports=function(C){var m=+C;return m!=m||0===m?0:(m>0?_:X)(m)}},61468:(B,X,_)=>{var C=_(21524),m=Math.min;B.exports=function(e){return e>0?m(C(e),9007199254740991):0}},49402:(B,X,_)=>{var C=_(22743),m=_(86213),e=C.Object;B.exports=function(t){return e(m(t))}},25696:(B,X,_)=>{var C=_(22743),m=_(85246),e=_(78103),t=_(90094),n=_(30047),o=_(75671),r=_(7084),a=C.TypeError,h=r("toPrimitive");B.exports=function(R,L){if(!e(R)||t(R))return R;var nt,W=n(R,h);if(W){if(void 0===L&&(L="default"),nt=m(W,R,L),!e(nt)||t(nt))return nt;throw a("Can't convert object to primitive value")}return void 0===L&&(L="number"),o(R,L)}},73540:(B,X,_)=>{var C=_(25696),m=_(90094);B.exports=function(e){var t=C(e,"string");return m(t)?t:t+""}},57575:(B,X,_)=>{var e={};e[_(7084)("toStringTag")]="z",B.exports="[object z]"===String(e)},94506:(B,X,_)=>{var C=_(22743),m=_(80063),e=C.String;B.exports=function(t){if("Symbol"===m(t))throw TypeError("Cannot convert a Symbol value to a string");return e(t)}},99727:(B,X,_)=>{var m=_(22743).String;B.exports=function(e){try{return m(e)}catch(t){return"Object"}}},7226:(B,X,_)=>{var C=_(31588),m=0,e=Math.random(),t=C(1..toString);B.exports=function(n){return"Symbol("+(void 0===n?"":n)+")_"+t(++m+e,36)}},43587:(B,X,_)=>{var C=_(62581);B.exports=C&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},49828:(B,X,_)=>{var C=_(25847),m=_(31469);B.exports=C&&m(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},1467:(B,X,_)=>{var m=_(22743).TypeError;B.exports=function(e,t){if(e<t)throw m("Not enough arguments");return e}},14525:(B,X,_)=>{var C=_(7084);X.f=C},7084:(B,X,_)=>{var C=_(22743),m=_(843),e=_(44030),t=_(7226),n=_(62581),o=_(43587),r=m("wks"),a=C.Symbol,h=a&&a.for,R=o?a:a&&a.withoutSetter||t;B.exports=function(L){if(!e(r,L)||!n&&"string"!=typeof r[L]){var W="Symbol."+L;r[L]=n&&e(a,L)?a[L]:o&&h?h(W):R(W)}return r[L]}},65806:(B,X,_)=>{"use strict";var C=_(70147),m=_(22743),e=_(76185),t=_(84361),n=_(91100),o=_(47902),r=_(80332),a=_(78204),h=_(41137),R=_(79087),L=_(42783),W=_(99883),nt=_(58823),et=_(7084),Et=_(92335),It=et("toStringTag"),gt=m.Error,wt=[].push,Ut=function(bt,at){var Ft,ft=arguments.length>2?arguments[2]:void 0,lt=e(Jt,this);n?Ft=n(new gt,lt?t(this):Jt):(Ft=lt?this:r(Jt),a(Ft,It,"Error")),void 0!==at&&a(Ft,"message",nt(at)),Et&&a(Ft,"stack",R(Ft.stack,1)),L(Ft,ft);var Mt=[];return W(bt,wt,{that:Mt}),a(Ft,"errors",Mt),Ft};n?n(Ut,gt):o(Ut,gt,{name:!0});var Jt=Ut.prototype=r(gt.prototype,{constructor:h(1,Ut),message:h(1,""),name:h(1,"AggregateError")});C({global:!0,constructor:!0,arity:2},{AggregateError:Ut})},84722:(B,X,_)=>{_(65806)},56874:(B,X,_)=>{"use strict";var C=_(70147),m=_(22743),e=_(31469),t=_(10371),n=_(78103),o=_(49402),r=_(33706),a=_(3115),h=_(4414),R=_(85367),L=_(7084),W=_(10322),nt=L("isConcatSpreadable"),et=9007199254740991,Et="Maximum allowed index exceeded",It=m.TypeError,gt=W>=51||!e(function(){var Ct=[];return Ct[nt]=!1,Ct.concat()[0]!==Ct}),wt=R("concat"),Ut=function(Ct){if(!n(Ct))return!1;var bt=Ct[nt];return void 0!==bt?!!bt:t(Ct)};C({target:"Array",proto:!0,arity:1,forced:!gt||!wt},{concat:function(bt){var Ft,Mt,yt,ct,rt,at=o(this),ft=h(at,0),lt=0;for(Ft=-1,yt=arguments.length;Ft<yt;Ft++)if(Ut(rt=-1===Ft?at:arguments[Ft])){if(lt+(ct=r(rt))>et)throw It(Et);for(Mt=0;Mt<ct;Mt++,lt++)Mt in rt&&a(ft,lt,rt[Mt])}else{if(lt>=et)throw It(Et);a(ft,lt++,rt)}return ft.length=lt,ft}})},7100:(B,X,_)=>{"use strict";var C=_(70147),m=_(53877).filter;C({target:"Array",proto:!0,forced:!_(85367)("filter")},{filter:function(o){return m(this,o,arguments.length>1?arguments[1]:void 0)}})},96648:(B,X,_)=>{"use strict";var C=_(70147),m=_(53877).find,e=_(70677),t="find",n=!0;t in[]&&Array(1)[t](function(){n=!1}),C({target:"Array",proto:!0,forced:n},{find:function(r){return m(this,r,arguments.length>1?arguments[1]:void 0)}}),e(t)},58665:(B,X,_)=>{"use strict";var C=_(70147),m=_(19875);C({target:"Array",proto:!0,forced:[].forEach!=m},{forEach:m})},48161:(B,X,_)=>{var C=_(70147),m=_(96397);C({target:"Array",stat:!0,forced:!_(4402)(function(n){Array.from(n)})},{from:m})},85124:(B,X,_)=>{"use strict";var C=_(70147),m=_(68047).includes,e=_(31469),t=_(70677);C({target:"Array",proto:!0,forced:e(function(){return!Array(1).includes()})},{includes:function(r){return m(this,r,arguments.length>1?arguments[1]:void 0)}}),t("includes")},89815:(B,X,_)=>{"use strict";var C=_(70147),m=_(31588),e=_(68047).indexOf,t=_(52995),n=m([].indexOf),o=!!n&&1/n([1],1,-0)<0,r=t("indexOf");C({target:"Array",proto:!0,forced:o||!r},{indexOf:function(h){var R=arguments.length>1?arguments[1]:void 0;return o?n(this,h,R)||0:e(this,h,R)}})},71006:(B,X,_)=>{_(70147)({target:"Array",stat:!0},{isArray:_(10371)})},71420:(B,X,_)=>{"use strict";var C=_(35197),m=_(70677),e=_(44362),t=_(34520),n=_(13528).f,o=_(52928),r=_(92838),a=_(25847),h="Array Iterator",R=t.set,L=t.getterFor(h);B.exports=o(Array,"Array",function(nt,et){R(this,{type:h,target:C(nt),index:0,kind:et})},function(){var nt=L(this),et=nt.target,Et=nt.kind,It=nt.index++;return!et||It>=et.length?(nt.target=void 0,{value:void 0,done:!0}):"keys"==Et?{value:It,done:!1}:"values"==Et?{value:et[It],done:!1}:{value:[It,et[It]],done:!1}},"values");var W=e.Arguments=e.Array;if(m("keys"),m("values"),m("entries"),!r&&a&&"values"!==W.name)try{n(W,"name",{value:"values"})}catch(nt){}},81171:(B,X,_)=>{"use strict";var C=_(70147),m=_(53877).map;C({target:"Array",proto:!0,forced:!_(85367)("map")},{map:function(o){return m(this,o,arguments.length>1?arguments[1]:void 0)}})},21311:(B,X,_)=>{"use strict";var C=_(70147),m=_(22743),e=_(10371),t=_(67459),n=_(78103),o=_(83889),r=_(33706),a=_(35197),h=_(3115),R=_(7084),L=_(85367),W=_(90840),nt=L("slice"),et=R("species"),Et=m.Array,It=Math.max;C({target:"Array",proto:!0,forced:!nt},{slice:function(wt,Ut){var ft,lt,Ft,Jt=a(this),Ct=r(Jt),bt=o(wt,Ct),at=o(void 0===Ut?Ct:Ut,Ct);if(e(Jt)&&((t(ft=Jt.constructor)&&(ft===Et||e(ft.prototype))||n(ft)&&null===(ft=ft[et]))&&(ft=void 0),ft===Et||void 0===ft))return W(Jt,bt,at);for(lt=new(void 0===ft?Et:ft)(It(at-bt,0)),Ft=0;bt<at;bt++,Ft++)bt in Jt&&h(lt,Ft,Jt[bt]);return lt.length=Ft,lt}})},19314:(B,X,_)=>{"use strict";var C=_(70147),m=_(22743),e=_(83889),t=_(21524),n=_(33706),o=_(49402),r=_(4414),a=_(3115),R=_(85367)("splice"),L=m.TypeError,W=Math.max,nt=Math.min,et=9007199254740991,Et="Maximum allowed length exceeded";C({target:"Array",proto:!0,forced:!R},{splice:function(gt,wt){var at,ft,lt,Ft,Mt,yt,Ut=o(this),Jt=n(Ut),Ct=e(gt,Jt),bt=arguments.length;if(0===bt?at=ft=0:1===bt?(at=0,ft=Jt-Ct):(at=bt-2,ft=nt(W(t(wt),0),Jt-Ct)),Jt+at-ft>et)throw L(Et);for(lt=r(Ut,ft),Ft=0;Ft<ft;Ft++)(Mt=Ct+Ft)in Ut&&a(lt,Ft,Ut[Mt]);if(lt.length=ft,at<ft){for(Ft=Ct;Ft<Jt-ft;Ft++)yt=Ft+at,(Mt=Ft+ft)in Ut?Ut[yt]=Ut[Mt]:delete Ut[yt];for(Ft=Jt;Ft>Jt-ft+at;Ft--)delete Ut[Ft-1]}else if(at>ft)for(Ft=Jt-ft;Ft>Ct;Ft--)yt=Ft+at-1,(Mt=Ft+ft-1)in Ut?Ut[yt]=Ut[Mt]:delete Ut[yt];for(Ft=0;Ft<at;Ft++)Ut[Ft+Ct]=arguments[Ft+2];return Ut.length=Jt-ft+at,lt}})},86061:(B,X,_)=>{var C=_(70147),m=_(85697),e=_(30547),t=_(85246),n=_(31588),o=_(31469),r=_(10371),a=_(24732),h=_(78103),R=_(90094),L=_(90840),W=_(62581),nt=m("JSON","stringify"),et=n(/./.exec),Et=n("".charAt),It=n("".charCodeAt),gt=n("".replace),wt=n(1..toString),Ut=/[\uD800-\uDFFF]/g,Jt=/^[\uD800-\uDBFF]$/,Ct=/^[\uDC00-\uDFFF]$/,bt=!W||o(function(){var Ft=m("Symbol")();return"[null]"!=nt([Ft])||"{}"!=nt({a:Ft})||"{}"!=nt(Object(Ft))}),at=o(function(){return'"\\udf06\\ud834"'!==nt("\udf06\ud834")||'"\\udead"'!==nt("\udead")}),ft=function(Ft,Mt){var yt=L(arguments),ct=Mt;if((h(Mt)||void 0!==Ft)&&!R(Ft))return r(Mt)||(Mt=function(rt,se){if(a(ct)&&(se=t(ct,this,rt,se)),!R(se))return se}),yt[1]=Mt,e(nt,null,yt)},lt=function(Ft,Mt,yt){var ct=Et(yt,Mt-1),rt=Et(yt,Mt+1);return et(Jt,Ft)&&!et(Ct,rt)||et(Ct,Ft)&&!et(Jt,ct)?"\\u"+wt(It(Ft,0),16):Ft};nt&&C({target:"JSON",stat:!0,arity:3,forced:bt||at},{stringify:function(Mt,yt,ct){var rt=L(arguments),se=e(bt?ft:nt,null,rt);return at&&"string"==typeof se?gt(se,Ut,lt):se}})},85504:(B,X,_)=>{var C=_(22743);_(63598)(C.JSON,"JSON",!0)},15551:()=>{},7923:(B,X,_)=>{var C=_(70147),m=_(94347);C({target:"Object",stat:!0,arity:2,forced:Object.assign!==m},{assign:m})},13227:(B,X,_)=>{var C=_(70147),m=_(25847),e=_(68453).f;C({target:"Object",stat:!0,forced:Object.defineProperties!==e,sham:!m},{defineProperties:e})},24526:(B,X,_)=>{var C=_(70147),m=_(25847),e=_(13528).f;C({target:"Object",stat:!0,forced:Object.defineProperty!==e,sham:!m},{defineProperty:e})},50042:(B,X,_)=>{var C=_(70147),m=_(6936).entries;C({target:"Object",stat:!0},{entries:function(t){return m(t)}})},49711:(B,X,_)=>{var C=_(70147),m=_(31469),e=_(35197),t=_(26552).f,n=_(25847),o=m(function(){t(1)});C({target:"Object",stat:!0,forced:!n||o,sham:!n},{getOwnPropertyDescriptor:function(h,R){return t(e(h),R)}})},10130:(B,X,_)=>{var C=_(70147),m=_(25847),e=_(68566),t=_(35197),n=_(26552),o=_(3115);C({target:"Object",stat:!0,sham:!m},{getOwnPropertyDescriptors:function(a){for(var et,Et,h=t(a),R=n.f,L=e(h),W={},nt=0;L.length>nt;)void 0!==(Et=R(h,et=L[nt++]))&&o(W,et,Et);return W}})},64758:(B,X,_)=>{var C=_(70147),m=_(62581),e=_(31469),t=_(30233),n=_(49402);C({target:"Object",stat:!0,forced:!m||e(function(){t.f(1)})},{getOwnPropertySymbols:function(a){var h=t.f;return h?h(n(a)):[]}})},68126:(B,X,_)=>{var C=_(70147),m=_(49402),e=_(77978);C({target:"Object",stat:!0,forced:_(31469)(function(){e(1)})},{keys:function(r){return e(m(r))}})},42271:()=>{},52568:(B,X,_)=>{"use strict";var C=_(70147),m=_(85246),e=_(80866),t=_(39802),n=_(50819),o=_(99883);C({target:"Promise",stat:!0},{allSettled:function(a){var h=this,R=t.f(h),L=R.resolve,W=R.reject,nt=n(function(){var et=e(h.resolve),Et=[],It=0,gt=1;o(a,function(wt){var Ut=It++,Jt=!1;gt++,m(et,h,wt).then(function(Ct){Jt||(Jt=!0,Et[Ut]={status:"fulfilled",value:Ct},--gt||L(Et))},function(Ct){Jt||(Jt=!0,Et[Ut]={status:"rejected",reason:Ct},--gt||L(Et))})}),--gt||L(Et)});return nt.error&&W(nt.value),R.promise}})},17275:(B,X,_)=>{"use strict";var C=_(70147),m=_(85246),e=_(80866),t=_(39802),n=_(50819),o=_(99883);C({target:"Promise",stat:!0,forced:_(65194)},{all:function(h){var R=this,L=t.f(R),W=L.resolve,nt=L.reject,et=n(function(){var Et=e(R.resolve),It=[],gt=0,wt=1;o(h,function(Ut){var Jt=gt++,Ct=!1;wt++,m(Et,R,Ut).then(function(bt){Ct||(Ct=!0,It[Jt]=bt,--wt||W(It))},nt)}),--wt||W(It)});return et.error&&nt(et.value),L.promise}})},64111:(B,X,_)=>{"use strict";var C=_(70147),m=_(85246),e=_(80866),t=_(85697),n=_(39802),o=_(50819),r=_(99883),a="No one promise resolved";C({target:"Promise",stat:!0},{any:function(R){var L=this,W=t("AggregateError"),nt=n.f(L),et=nt.resolve,Et=nt.reject,It=o(function(){var gt=e(L.resolve),wt=[],Ut=0,Jt=1,Ct=!1;r(R,function(bt){var at=Ut++,ft=!1;Jt++,m(gt,L,bt).then(function(lt){ft||Ct||(Ct=!0,et(lt))},function(lt){ft||Ct||(ft=!0,wt[at]=lt,--Jt||Et(new W(wt,a)))})}),--Jt||Et(new W(wt,a))});return It.error&&Et(It.value),nt.promise}})},60299:(B,X,_)=>{"use strict";var C=_(70147),m=_(92838),e=_(96799).CONSTRUCTOR,t=_(31762),n=_(85697),o=_(24732),r=_(20569),a=t&&t.prototype;if(C({target:"Promise",proto:!0,forced:e,real:!0},{catch:function(R){return this.then(void 0,R)}}),!m&&o(t)){var h=n("Promise").prototype.catch;a.catch!==h&&r(a,"catch",h,{unsafe:!0})}},7101:(B,X,_)=>{"use strict";var Xt,he,ve,C=_(70147),m=_(92838),e=_(70751),t=_(22743),n=_(85246),o=_(20569),r=_(91100),a=_(63598),h=_(13961),R=_(80866),L=_(24732),W=_(78103),nt=_(43017),et=_(85972),Et=_(76401).set,It=_(72845),gt=_(18819),wt=_(50819),Ut=_(75893),Jt=_(34520),Ct=_(31762),bt=_(96799),at=_(39802),ft="Promise",lt=bt.CONSTRUCTOR,Ft=bt.REJECTION_EVENT,Mt=bt.SUBCLASSING,yt=Jt.getterFor(ft),ct=Jt.set,rt=Ct&&Ct.prototype,se=Ct,xt=rt,Lt=t.TypeError,de=t.document,_e=t.process,ce=at.f,Ae=ce,Ne=!!(de&&de.createEvent&&t.dispatchEvent),qe="unhandledrejection",je=function(Zt){var We;return!(!W(Zt)||!L(We=Zt.then))&&We},gi=function(Zt,We){var rn,ge,De,$e=We.value,Ti=1==We.state,vi=Ti?Zt.ok:Zt.fail,di=Zt.resolve,Gi=Zt.reject,Ri=Zt.domain;try{vi?(Ti||(2===We.rejection&&le(We),We.rejection=1),!0===vi?rn=$e:(Ri&&Ri.enter(),rn=vi($e),Ri&&(Ri.exit(),De=!0)),rn===Zt.promise?Gi(Lt("Promise-chain cycle")):(ge=je(rn))?n(ge,rn,di,Gi):di(rn)):Gi($e)}catch(_i){Ri&&!De&&Ri.exit(),Gi(_i)}},Ee=function(Zt,We){Zt.notified||(Zt.notified=!0,It(function(){for(var Ti,$e=Zt.reactions;Ti=$e.get();)gi(Ti,Zt);Zt.notified=!1,We&&!Zt.rejection&&ee(Zt)}))},ne=function(Zt,We,$e){var Ti,vi;Ne?((Ti=de.createEvent("Event")).promise=We,Ti.reason=$e,Ti.initEvent(Zt,!1,!0),t.dispatchEvent(Ti)):Ti={promise:We,reason:$e},!Ft&&(vi=t["on"+Zt])?vi(Ti):Zt===qe&&gt("Unhandled promise rejection",$e)},ee=function(Zt){n(Et,t,function(){var vi,We=Zt.facade,$e=Zt.value;if(Oe(Zt)&&(vi=wt(function(){e?_e.emit("unhandledRejection",$e,We):ne(qe,We,$e)}),Zt.rejection=e||Oe(Zt)?2:1,vi.error))throw vi.value})},Oe=function(Zt){return 1!==Zt.rejection&&!Zt.parent},le=function(Zt){n(Et,t,function(){var We=Zt.facade;e?_e.emit("rejectionHandled",We):ne("rejectionhandled",We,Zt.value)})},me=function(Zt,We,$e){return function(Ti){Zt(We,Ti,$e)}},ye=function(Zt,We,$e){Zt.done||(Zt.done=!0,$e&&(Zt=$e),Zt.value=We,Zt.state=2,Ee(Zt,!0))},Kt=function(Zt,We,$e){if(!Zt.done){Zt.done=!0,$e&&(Zt=$e);try{if(Zt.facade===We)throw Lt("Promise can't be resolved itself");var Ti=je(We);Ti?It(function(){var vi={done:!1};try{n(Ti,We,me(Kt,vi,Zt),me(ye,vi,Zt))}catch(di){ye(vi,di,Zt)}}):(Zt.value=We,Zt.state=1,Ee(Zt,!1))}catch(vi){ye({done:!1},vi,Zt)}}};if(lt&&(se=function(We){nt(this,xt),R(We),n(Xt,this);var $e=yt(this);try{We(me(Kt,$e),me(ye,$e))}catch(Ti){ye($e,Ti)}},(Xt=function(We){ct(this,{type:ft,done:!1,notified:!1,parent:!1,reactions:new Ut,rejection:!1,state:0,value:void 0})}).prototype=o(xt=se.prototype,"then",function(We,$e){var Ti=yt(this),vi=ce(et(this,se));return Ti.parent=!0,vi.ok=!L(We)||We,vi.fail=L($e)&&$e,vi.domain=e?_e.domain:void 0,0==Ti.state?Ti.reactions.add(vi):It(function(){gi(vi,Ti)}),vi.promise}),he=function(){var Zt=new Xt,We=yt(Zt);this.promise=Zt,this.resolve=me(Kt,We),this.reject=me(ye,We)},at.f=ce=function(Zt){return Zt===se||void 0===Zt?new he(Zt):Ae(Zt)},!m&&L(Ct)&&rt!==Object.prototype)){ve=rt.then,Mt||o(rt,"then",function(We,$e){var Ti=this;return new se(function(vi,di){n(ve,Ti,vi,di)}).then(We,$e)},{unsafe:!0});try{delete rt.constructor}catch(Zt){}r&&r(rt,xt)}C({global:!0,constructor:!0,wrap:!0,forced:lt},{Promise:se}),a(se,ft,!1,!0),h(ft)},1395:(B,X,_)=>{"use strict";var C=_(70147),m=_(92838),e=_(31762),t=_(31469),n=_(85697),o=_(24732),r=_(85972),a=_(92273),h=_(20569),R=e&&e.prototype;if(C({target:"Promise",proto:!0,real:!0,forced:!!e&&t(function(){R.finally.call({then:function(){}},function(){})})},{finally:function(nt){var et=r(this,n("Promise")),Et=o(nt);return this.then(Et?function(It){return a(et,nt()).then(function(){return It})}:nt,Et?function(It){return a(et,nt()).then(function(){throw It})}:nt)}}),!m&&o(e)){var W=n("Promise").prototype.finally;R.finally!==W&&h(R,"finally",W,{unsafe:!0})}},17569:(B,X,_)=>{_(7101),_(17275),_(60299),_(45190),_(43415),_(72399)},45190:(B,X,_)=>{"use strict";var C=_(70147),m=_(85246),e=_(80866),t=_(39802),n=_(50819),o=_(99883);C({target:"Promise",stat:!0,forced:_(65194)},{race:function(h){var R=this,L=t.f(R),W=L.reject,nt=n(function(){var et=e(R.resolve);o(h,function(Et){m(et,R,Et).then(L.resolve,W)})});return nt.error&&W(nt.value),L.promise}})},43415:(B,X,_)=>{"use strict";var C=_(70147),m=_(85246),e=_(39802);C({target:"Promise",stat:!0,forced:_(96799).CONSTRUCTOR},{reject:function(o){var r=e.f(this);return m(r.reject,void 0,o),r.promise}})},72399:(B,X,_)=>{"use strict";var C=_(70147),m=_(85697),e=_(92838),t=_(31762),n=_(96799).CONSTRUCTOR,o=_(92273),r=m("Promise"),a=e&&!n;C({target:"Promise",stat:!0,forced:e||n},{resolve:function(R){return o(a&&this===r?t:this,R)}})},61897:()=>{},11568:(B,X,_)=>{"use strict";var C=_(70147),m=_(31588),e=_(43353),t=_(86213),n=_(94506),o=_(15268),r=m("".indexOf);C({target:"String",proto:!0,forced:!o("includes")},{includes:function(h){return!!~r(n(t(this)),n(e(h)),arguments.length>1?arguments[1]:void 0)}})},80651:(B,X,_)=>{"use strict";var C=_(93071).charAt,m=_(94506),e=_(34520),t=_(52928),n="String Iterator",o=e.set,r=e.getterFor(n);t(String,"String",function(a){o(this,{type:n,string:m(a),index:0})},function(){var W,h=r(this),R=h.string,L=h.index;return L>=R.length?{value:void 0,done:!0}:(W=C(R,L),h.index+=W.length,{value:W,done:!1})})},72068:(B,X,_)=>{"use strict";var Et,C=_(70147),m=_(31588),e=_(26552).f,t=_(61468),n=_(94506),o=_(43353),r=_(86213),a=_(15268),h=_(92838),R=m("".startsWith),L=m("".slice),W=Math.min,nt=a("startsWith");C({target:"String",proto:!0,forced:!(!h&&!nt&&(Et=e(String.prototype,"startsWith"),Et&&!Et.writable)||nt)},{startsWith:function(It){var gt=n(r(this));o(It);var wt=t(W(arguments.length>1?arguments[1]:void 0,gt.length)),Ut=n(It);return R?R(gt,Ut,wt):L(gt,wt,wt+Ut.length)===Ut}})},9266:(B,X,_)=>{_(59478)("asyncIterator")},67583:(B,X,_)=>{"use strict";var C=_(70147),m=_(22743),e=_(85246),t=_(31588),n=_(92838),o=_(25847),r=_(62581),a=_(31469),h=_(44030),R=_(76185),L=_(10157),W=_(35197),nt=_(73540),et=_(94506),Et=_(41137),It=_(80332),gt=_(77978),wt=_(42769),Ut=_(24281),Jt=_(30233),Ct=_(26552),bt=_(13528),at=_(68453),ft=_(19664),lt=_(20569),Ft=_(843),Mt=_(35027),yt=_(89675),ct=_(7226),rt=_(7084),se=_(14525),xt=_(59478),Lt=_(33169),de=_(63598),_e=_(34520),ce=_(53877).forEach,Ae=Mt("hidden"),Ne="Symbol",qe="prototype",Di=_e.set,ei=_e.getterFor(Ne),Me=Object[qe],ri=m.Symbol,Bt=ri&&ri[qe],Ie=m.TypeError,Xt=m.QObject,he=Ct.f,Dt=bt.f,ve=Ut.f,je=ft.f,gi=t([].push),Ee=Ft("symbols"),ne=Ft("op-symbols"),ee=Ft("wks"),Oe=!Xt||!Xt[qe]||!Xt[qe].findChild,le=o&&a(function(){return 7!=It(Dt({},"a",{get:function(){return Dt(this,"a",{value:7}).a}})).a})?function(di,Gi,Ri){var rn=he(Me,Gi);rn&&delete Me[Gi],Dt(di,Gi,Ri),rn&&di!==Me&&Dt(Me,Gi,rn)}:Dt,me=function(di,Gi){var Ri=Ee[di]=It(Bt);return Di(Ri,{type:Ne,tag:di,description:Gi}),o||(Ri.description=Gi),Ri},ye=function(Gi,Ri,rn){Gi===Me&&ye(ne,Ri,rn),L(Gi);var ge=nt(Ri);return L(rn),h(Ee,ge)?(rn.enumerable?(h(Gi,Ae)&&Gi[Ae][ge]&&(Gi[Ae][ge]=!1),rn=It(rn,{enumerable:Et(0,!1)})):(h(Gi,Ae)||Dt(Gi,Ae,Et(1,{})),Gi[Ae][ge]=!0),le(Gi,ge,rn)):Dt(Gi,ge,rn)},Kt=function(Gi,Ri){L(Gi);var rn=W(Ri),ge=gt(rn).concat(vi(rn));return ce(ge,function(De){(!o||e(We,rn,De))&&ye(Gi,De,rn[De])}),Gi},We=function(Gi){var Ri=nt(Gi),rn=e(je,this,Ri);return!(this===Me&&h(Ee,Ri)&&!h(ne,Ri))&&(!(rn||!h(this,Ri)||!h(Ee,Ri)||h(this,Ae)&&this[Ae][Ri])||rn)},$e=function(Gi,Ri){var rn=W(Gi),ge=nt(Ri);if(rn!==Me||!h(Ee,ge)||h(ne,ge)){var De=he(rn,ge);return De&&h(Ee,ge)&&!(h(rn,Ae)&&rn[Ae][ge])&&(De.enumerable=!0),De}},Ti=function(Gi){var Ri=ve(W(Gi)),rn=[];return ce(Ri,function(ge){!h(Ee,ge)&&!h(yt,ge)&&gi(rn,ge)}),rn},vi=function(di){var Gi=di===Me,Ri=ve(Gi?ne:W(di)),rn=[];return ce(Ri,function(ge){h(Ee,ge)&&(!Gi||h(Me,ge))&&gi(rn,Ee[ge])}),rn};r||(lt(Bt=(ri=function(){if(R(Bt,this))throw Ie("Symbol is not a constructor");var Gi=arguments.length&&void 0!==arguments[0]?et(arguments[0]):void 0,Ri=ct(Gi),rn=function(ge){this===Me&&e(rn,ne,ge),h(this,Ae)&&h(this[Ae],Ri)&&(this[Ae][Ri]=!1),le(this,Ri,Et(1,ge))};return o&&Oe&&le(Me,Ri,{configurable:!0,set:rn}),me(Ri,Gi)})[qe],"toString",function(){return ei(this).tag}),lt(ri,"withoutSetter",function(di){return me(ct(di),di)}),ft.f=We,bt.f=ye,at.f=Kt,Ct.f=$e,wt.f=Ut.f=Ti,Jt.f=vi,se.f=function(di){return me(rt(di),di)},o&&(Dt(Bt,"description",{configurable:!0,get:function(){return ei(this).description}}),n||lt(Me,"propertyIsEnumerable",We,{unsafe:!0}))),C({global:!0,constructor:!0,wrap:!0,forced:!r,sham:!r},{Symbol:ri}),ce(gt(ee),function(di){xt(di)}),C({target:Ne,stat:!0,forced:!r},{useSetter:function(){Oe=!0},useSimple:function(){Oe=!1}}),C({target:"Object",stat:!0,forced:!r,sham:!o},{create:function(Gi,Ri){return void 0===Ri?It(Gi):Kt(It(Gi),Ri)},defineProperty:ye,defineProperties:Kt,getOwnPropertyDescriptor:$e}),C({target:"Object",stat:!0,forced:!r},{getOwnPropertyNames:Ti}),Lt(),de(ri,Ne),yt[Ae]=!0},87189:()=>{},98098:(B,X,_)=>{var C=_(70147),m=_(85697),e=_(44030),t=_(94506),n=_(843),o=_(64580),r=n("string-to-symbol-registry"),a=n("symbol-to-string-registry");C({target:"Symbol",stat:!0,forced:!o},{for:function(h){var R=t(h);if(e(r,R))return r[R];var L=m("Symbol")(R);return r[R]=L,a[L]=R,L}})},94898:(B,X,_)=>{_(59478)("hasInstance")},57133:(B,X,_)=>{_(59478)("isConcatSpreadable")},3766:(B,X,_)=>{_(59478)("iterator")},83136:(B,X,_)=>{_(67583),_(98098),_(96642),_(86061),_(64758)},96642:(B,X,_)=>{var C=_(70147),m=_(44030),e=_(90094),t=_(99727),n=_(843),o=_(64580),r=n("symbol-to-string-registry");C({target:"Symbol",stat:!0,forced:!o},{keyFor:function(h){if(!e(h))throw TypeError(t(h)+" is not a symbol");if(m(r,h))return r[h]}})},84765:(B,X,_)=>{_(59478)("matchAll")},49342:(B,X,_)=>{_(59478)("match")},83606:(B,X,_)=>{_(59478)("replace")},25909:(B,X,_)=>{_(59478)("search")},42383:(B,X,_)=>{_(59478)("species")},98547:(B,X,_)=>{_(59478)("split")},73418:(B,X,_)=>{var C=_(59478),m=_(33169);C("toPrimitive"),m()},82266:(B,X,_)=>{var C=_(85697),m=_(59478),e=_(63598);m("toStringTag"),e(C("Symbol"),"Symbol")},30797:(B,X,_)=>{_(59478)("unscopables")},5807:(B,X,_)=>{"use strict";var W,C=_(22743),m=_(31588),e=_(97950),t=_(33613),n=_(66657),o=_(75925),r=_(78103),a=_(19086),h=_(34520).enforce,R=_(63185),L=!C.ActiveXObject&&"ActiveXObject"in C,nt=function(Jt){return function(){return Jt(this,arguments.length?arguments[0]:void 0)}},et=n("WeakMap",nt,o);if(R&&L){W=o.getConstructor(nt,"WeakMap",!0),t.enable();var Et=et.prototype,It=m(Et.delete),gt=m(Et.has),wt=m(Et.get),Ut=m(Et.set);e(Et,{delete:function(Jt){if(r(Jt)&&!a(Jt)){var Ct=h(this);return Ct.frozen||(Ct.frozen=new W),It(this,Jt)||Ct.frozen.delete(Jt)}return It(this,Jt)},has:function(Ct){if(r(Ct)&&!a(Ct)){var bt=h(this);return bt.frozen||(bt.frozen=new W),gt(this,Ct)||bt.frozen.has(Ct)}return gt(this,Ct)},get:function(Ct){if(r(Ct)&&!a(Ct)){var bt=h(this);return bt.frozen||(bt.frozen=new W),gt(this,Ct)?wt(this,Ct):bt.frozen.get(Ct)}return wt(this,Ct)},set:function(Ct,bt){if(r(Ct)&&!a(Ct)){var at=h(this);at.frozen||(at.frozen=new W),gt(this,Ct)?Ut(this,Ct,bt):at.frozen.set(Ct,bt)}else Ut(this,Ct,bt);return this}})}},29960:(B,X,_)=>{_(5807)},38669:(B,X,_)=>{_(84722)},33483:(B,X,_)=>{_(52568)},30389:(B,X,_)=>{_(64111)},65193:(B,X,_)=>{"use strict";var C=_(70147),m=_(39802),e=_(50819);C({target:"Promise",stat:!0,forced:!0},{try:function(t){var n=m.f(this),o=e(t);return(o.error?n.reject:n.resolve)(o.value),n.promise}})},59108:(B,X,_)=>{_(59478)("asyncDispose")},98488:(B,X,_)=>{_(59478)("dispose")},65802:(B,X,_)=>{_(59478)("matcher")},38772:(B,X,_)=>{_(59478)("metadata")},96398:(B,X,_)=>{_(59478)("observable")},79699:(B,X,_)=>{_(59478)("patternMatch")},86669:(B,X,_)=>{_(59478)("replaceAll")},72760:(B,X,_)=>{_(71420);var C=_(9113),m=_(22743),e=_(80063),t=_(78204),n=_(44362),r=_(7084)("toStringTag");for(var a in C){var h=m[a],R=h&&h.prototype;R&&e(R)!==r&&t(R,r,a),n[a]=n.Array}},10397:(B,X,_)=>{"use strict";_(71420);var C=_(70147),m=_(22743),e=_(85246),t=_(31588),n=_(25847),o=_(2049),r=_(20569),a=_(97950),h=_(63598),R=_(690),L=_(34520),W=_(43017),nt=_(24732),et=_(44030),Et=_(21137),It=_(80063),gt=_(10157),wt=_(78103),Ut=_(94506),Jt=_(80332),Ct=_(41137),bt=_(74471),at=_(56958),ft=_(1467),lt=_(7084),Ft=_(69274),Mt=lt("iterator"),yt="URLSearchParams",ct=yt+"Iterator",rt=L.set,se=L.getterFor(yt),xt=L.getterFor(ct),Lt=Object.getOwnPropertyDescriptor,de=function(ge){if(!n)return m[ge];var De=Lt(m,ge);return De&&De.value},_e=de("fetch"),ce=de("Request"),Ae=de("Headers"),Ne=ce&&ce.prototype,qe=Ae&&Ae.prototype,Di=m.RegExp,ei=m.TypeError,Me=m.decodeURIComponent,ri=m.encodeURIComponent,Bt=t("".charAt),Ie=t([].join),Xt=t([].push),he=t("".replace),Dt=t([].shift),ve=t([].splice),je=t("".split),gi=t("".slice),Ee=/\+/g,ne=Array(4),ee=function(ge){return ne[ge-1]||(ne[ge-1]=Di("((?:%[\\da-f]{2}){"+ge+"})","gi"))},Oe=function(ge){try{return Me(ge)}catch(De){return ge}},le=function(ge){var De=he(ge,Ee," "),_i=4;try{return Me(De)}catch(yi){for(;_i;)De=he(De,ee(_i--),Oe);return De}},me=/[!'()~]|%20/g,ye={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Kt=function(ge){return ye[ge]},Zt=function(ge){return he(ri(ge),me,Kt)},We=R(function(De,_i){rt(this,{type:ct,iterator:bt(se(De).entries),kind:_i})},"Iterator",function(){var De=xt(this),_i=De.kind,yi=De.iterator.next(),Fi=yi.value;return yi.done||(yi.value="keys"===_i?Fi.key:"values"===_i?Fi.value:[Fi.key,Fi.value]),yi},!0),$e=function(ge){this.entries=[],this.url=null,void 0!==ge&&(wt(ge)?this.parseObject(ge):this.parseQuery("string"==typeof ge?"?"===Bt(ge,0)?gi(ge,1):ge:Ut(ge)))};$e.prototype={type:yt,bindURL:function(ge){this.url=ge,this.update()},parseObject:function(ge){var _i,yi,Fi,Ni,mn,si,Ce,De=at(ge);if(De)for(yi=(_i=bt(ge,De)).next;!(Fi=e(yi,_i)).done;){if(Ni=bt(gt(Fi.value)),(si=e(mn=Ni.next,Ni)).done||(Ce=e(mn,Ni)).done||!e(mn,Ni).done)throw ei("Expected sequence with length 2");Xt(this.entries,{key:Ut(si.value),value:Ut(Ce.value)})}else for(var Vt in ge)et(ge,Vt)&&Xt(this.entries,{key:Vt,value:Ut(ge[Vt])})},parseQuery:function(ge){if(ge)for(var yi,Fi,De=je(ge,"&"),_i=0;_i<De.length;)(yi=De[_i++]).length&&(Fi=je(yi,"="),Xt(this.entries,{key:le(Dt(Fi)),value:le(Ie(Fi,"="))}))},serialize:function(){for(var yi,ge=this.entries,De=[],_i=0;_i<ge.length;)yi=ge[_i++],Xt(De,Zt(yi.key)+"="+Zt(yi.value));return Ie(De,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Ti=function(){W(this,vi);var De=arguments.length>0?arguments[0]:void 0;rt(this,new $e(De))},vi=Ti.prototype;if(a(vi,{append:function(De,_i){ft(arguments.length,2);var yi=se(this);Xt(yi.entries,{key:Ut(De),value:Ut(_i)}),yi.updateURL()},delete:function(ge){ft(arguments.length,1);for(var De=se(this),_i=De.entries,yi=Ut(ge),Fi=0;Fi<_i.length;)_i[Fi].key===yi?ve(_i,Fi,1):Fi++;De.updateURL()},get:function(De){ft(arguments.length,1);for(var _i=se(this).entries,yi=Ut(De),Fi=0;Fi<_i.length;Fi++)if(_i[Fi].key===yi)return _i[Fi].value;return null},getAll:function(De){ft(arguments.length,1);for(var _i=se(this).entries,yi=Ut(De),Fi=[],Ni=0;Ni<_i.length;Ni++)_i[Ni].key===yi&&Xt(Fi,_i[Ni].value);return Fi},has:function(De){ft(arguments.length,1);for(var _i=se(this).entries,yi=Ut(De),Fi=0;Fi<_i.length;)if(_i[Fi++].key===yi)return!0;return!1},set:function(De,_i){ft(arguments.length,1);for(var Vt,yi=se(this),Fi=yi.entries,Ni=!1,mn=Ut(De),si=Ut(_i),Ce=0;Ce<Fi.length;Ce++)(Vt=Fi[Ce]).key===mn&&(Ni?ve(Fi,Ce--,1):(Ni=!0,Vt.value=si));Ni||Xt(Fi,{key:mn,value:si}),yi.updateURL()},sort:function(){var De=se(this);Ft(De.entries,function(_i,yi){return _i.key>yi.key?1:-1}),De.updateURL()},forEach:function(De){for(var Ni,_i=se(this).entries,yi=Et(De,arguments.length>1?arguments[1]:void 0),Fi=0;Fi<_i.length;)yi((Ni=_i[Fi++]).value,Ni.key,this)},keys:function(){return new We(this,"keys")},values:function(){return new We(this,"values")},entries:function(){return new We(this,"entries")}},{enumerable:!0}),r(vi,Mt,vi.entries,{name:"entries"}),r(vi,"toString",function(){return se(this).serialize()},{enumerable:!0}),h(Ti,yt),C({global:!0,constructor:!0,forced:!o},{URLSearchParams:Ti}),!o&&nt(Ae)){var di=t(qe.has),Gi=t(qe.set),Ri=function(ge){if(wt(ge)){var _i,De=ge.body;if(It(De)===yt)return _i=ge.headers?new Ae(ge.headers):new Ae,di(_i,"content-type")||Gi(_i,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Jt(ge,{body:Ct(0,Ut(De)),headers:Ct(0,_i)})}return ge};if(nt(_e)&&C({global:!0,enumerable:!0,noTargetGet:!0,forced:!0},{fetch:function(De){return _e(De,arguments.length>1?Ri(arguments[1]):{})}}),nt(ce)){var rn=function(De){return W(this,Ne),new ce(De,arguments.length>1?Ri(arguments[1]):{})};Ne.constructor=rn,rn.prototype=Ne,C({global:!0,constructor:!0,noTargetGet:!0,forced:!0},{Request:rn})}}B.exports={URLSearchParams:Ti,getState:se}},17606:(B,X,_)=>{_(10397)},47471:(B,X,_)=>{var C=_(75426);B.exports=C},37722:(B,X,_)=>{var C=_(11529);B.exports=C},93049:(B,X,_)=>{var C=_(66213);B.exports=C},34863:(B,X,_)=>{var C=_(88191);B.exports=C},91081:(B,X,_)=>{var C=_(45347);_(72760),B.exports=C},21049:(B,X,_)=>{var C=_(36022);B.exports=C},43175:(B,X,_)=>{_(72760);var C=_(80063),m=_(44030),e=_(76185),t=_(93049),n=Array.prototype,o={DOMTokenList:!0,NodeList:!0};B.exports=function(r){var a=r.entries;return r===n||e(n,r)&&a===n.entries||m(o,C(r))?t:a}},3352:(B,X,_)=>{var C=_(73301);B.exports=C},13566:(B,X,_)=>{var C=_(38387);B.exports=C},35558:(B,X,_)=>{_(72760);var C=_(80063),m=_(44030),e=_(76185),t=_(34863),n=Array.prototype,o={DOMTokenList:!0,NodeList:!0};B.exports=function(r){var a=r.forEach;return r===n||e(n,r)&&a===n.forEach||m(o,C(r))?t:a}},70201:(B,X,_)=>{var C=_(1629);B.exports=C},49127:(B,X,_)=>{var C=_(66338);B.exports=C},21570:(B,X,_)=>{var C=_(57378);B.exports=C},46726:(B,X,_)=>{var C=_(70093);B.exports=C},38366:(B,X,_)=>{var C=_(16172);B.exports=C},63317:(B,X,_)=>{var C=_(7706);B.exports=C},68687:(B,X,_)=>{var C=_(22730);B.exports=C},15256:(B,X,_)=>{var C=_(66619);B.exports=C},87968:(B,X,_)=>{var C=_(4040);B.exports=C},81040:(B,X,_)=>{var C=_(7420);B.exports=C},21929:(B,X,_)=>{var C=_(2011);B.exports=C},18047:(B,X,_)=>{var C=_(95595);B.exports=C},16521:(B,X,_)=>{var C=_(42093);B.exports=C},32825:(B,X,_)=>{var C=_(93296);B.exports=C},70977:(B,X,_)=>{var C=_(31159);B.exports=C},35019:(B,X,_)=>{var C=_(9850);_(72760),B.exports=C},11830:(B,X,_)=>{var C=_(18297);_(72760),B.exports=C},61453:(B,X,_)=>{var C=_(5933);_(72760),B.exports=C},24733:(B,X,_)=>{var C=_(74107);_(72760),B.exports=C},65623:(B,X,_)=>{var C=_(70238);_(72760),B.exports=C},74107:(B,X,_)=>{_(17606);var C=_(35060);B.exports=C.URLSearchParams},76400:function(){var B;B="undefined"!=typeof self?self:this,function(_){var C_searchParams="URLSearchParams"in B,C_iterable="Symbol"in B&&"iterator"in Symbol,C_blob="FileReader"in B&&"Blob"in B&&function(){try{return new Blob,!0}catch(ft){return!1}}(),C_formData="FormData"in B,C_arrayBuffer="ArrayBuffer"in B;if(C_arrayBuffer)var e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],t=ArrayBuffer.isView||function(ft){return ft&&e.indexOf(Object.prototype.toString.call(ft))>-1};function n(ft){if("string"!=typeof ft&&(ft=String(ft)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(ft))throw new TypeError("Invalid character in header field name");return ft.toLowerCase()}function o(ft){return"string"!=typeof ft&&(ft=String(ft)),ft}function r(ft){var lt={next:function(){var Ft=ft.shift();return{done:void 0===Ft,value:Ft}}};return C_iterable&&(lt[Symbol.iterator]=function(){return lt}),lt}function a(ft){this.map={},ft instanceof a?ft.forEach(function(lt,Ft){this.append(Ft,lt)},this):Array.isArray(ft)?ft.forEach(function(lt){this.append(lt[0],lt[1])},this):ft&&Object.getOwnPropertyNames(ft).forEach(function(lt){this.append(lt,ft[lt])},this)}function h(ft){if(ft.bodyUsed)return Promise.reject(new TypeError("Already read"));ft.bodyUsed=!0}function R(ft){return new Promise(function(lt,Ft){ft.onload=function(){lt(ft.result)},ft.onerror=function(){Ft(ft.error)}})}function L(ft){var lt=new FileReader,Ft=R(lt);return lt.readAsArrayBuffer(ft),Ft}function et(ft){if(ft.slice)return ft.slice(0);var lt=new Uint8Array(ft.byteLength);return lt.set(new Uint8Array(ft)),lt.buffer}function Et(){return this.bodyUsed=!1,this._initBody=function(ft){this._bodyInit=ft,ft?"string"==typeof ft?this._bodyText=ft:C_blob&&Blob.prototype.isPrototypeOf(ft)?this._bodyBlob=ft:C_formData&&FormData.prototype.isPrototypeOf(ft)?this._bodyFormData=ft:C_searchParams&&URLSearchParams.prototype.isPrototypeOf(ft)?this._bodyText=ft.toString():C_arrayBuffer&&C_blob&&function m(ft){return ft&&DataView.prototype.isPrototypeOf(ft)}(ft)?(this._bodyArrayBuffer=et(ft.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):C_arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(ft)||t(ft))?this._bodyArrayBuffer=et(ft):this._bodyText=ft=Object.prototype.toString.call(ft):this._bodyText="",this.headers.get("content-type")||("string"==typeof ft?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):C_searchParams&&URLSearchParams.prototype.isPrototypeOf(ft)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},C_blob&&(this.blob=function(){var ft=h(this);if(ft)return ft;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(L)}),this.text=function(){var ft=h(this);if(ft)return ft;if(this._bodyBlob)return function W(ft){var lt=new FileReader,Ft=R(lt);return lt.readAsText(ft),Ft}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function nt(ft){for(var lt=new Uint8Array(ft),Ft=new Array(lt.length),Mt=0;Mt<lt.length;Mt++)Ft[Mt]=String.fromCharCode(lt[Mt]);return Ft.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},C_formData&&(this.formData=function(){return this.text().then(Ut)}),this.json=function(){return this.text().then(JSON.parse)},this}a.prototype.append=function(ft,lt){ft=n(ft),lt=o(lt);var Ft=this.map[ft];this.map[ft]=Ft?Ft+", "+lt:lt},a.prototype.delete=function(ft){delete this.map[n(ft)]},a.prototype.get=function(ft){return ft=n(ft),this.has(ft)?this.map[ft]:null},a.prototype.has=function(ft){return this.map.hasOwnProperty(n(ft))},a.prototype.set=function(ft,lt){this.map[n(ft)]=o(lt)},a.prototype.forEach=function(ft,lt){for(var Ft in this.map)this.map.hasOwnProperty(Ft)&&ft.call(lt,this.map[Ft],Ft,this)},a.prototype.keys=function(){var ft=[];return this.forEach(function(lt,Ft){ft.push(Ft)}),r(ft)},a.prototype.values=function(){var ft=[];return this.forEach(function(lt){ft.push(lt)}),r(ft)},a.prototype.entries=function(){var ft=[];return this.forEach(function(lt,Ft){ft.push([Ft,lt])}),r(ft)},C_iterable&&(a.prototype[Symbol.iterator]=a.prototype.entries);var It=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function wt(ft,lt){var Ft=(lt=lt||{}).body;if(ft instanceof wt){if(ft.bodyUsed)throw new TypeError("Already read");this.url=ft.url,this.credentials=ft.credentials,lt.headers||(this.headers=new a(ft.headers)),this.method=ft.method,this.mode=ft.mode,this.signal=ft.signal,!Ft&&null!=ft._bodyInit&&(Ft=ft._bodyInit,ft.bodyUsed=!0)}else this.url=String(ft);if(this.credentials=lt.credentials||this.credentials||"same-origin",(lt.headers||!this.headers)&&(this.headers=new a(lt.headers)),this.method=function gt(ft){var lt=ft.toUpperCase();return It.indexOf(lt)>-1?lt:ft}(lt.method||this.method||"GET"),this.mode=lt.mode||this.mode||null,this.signal=lt.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&Ft)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Ft)}function Ut(ft){var lt=new FormData;return ft.trim().split("&").forEach(function(Ft){if(Ft){var Mt=Ft.split("="),yt=Mt.shift().replace(/\+/g," "),ct=Mt.join("=").replace(/\+/g," ");lt.append(decodeURIComponent(yt),decodeURIComponent(ct))}}),lt}function Jt(ft){var lt=new a;return ft.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(Mt){var yt=Mt.split(":"),ct=yt.shift().trim();if(ct){var rt=yt.join(":").trim();lt.append(ct,rt)}}),lt}function Ct(ft,lt){lt||(lt={}),this.type="default",this.status=void 0===lt.status?200:lt.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in lt?lt.statusText:"OK",this.headers=new a(lt.headers),this.url=lt.url||"",this._initBody(ft)}wt.prototype.clone=function(){return new wt(this,{body:this._bodyInit})},Et.call(wt.prototype),Et.call(Ct.prototype),Ct.prototype.clone=function(){return new Ct(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},Ct.error=function(){var ft=new Ct(null,{status:0,statusText:""});return ft.type="error",ft};var bt=[301,302,303,307,308];Ct.redirect=function(ft,lt){if(-1===bt.indexOf(lt))throw new RangeError("Invalid status code");return new Ct(null,{status:lt,headers:{location:ft}})},_.DOMException=B.DOMException;try{new _.DOMException}catch(ft){_.DOMException=function(lt,Ft){this.message=lt,this.name=Ft;var Mt=Error(lt);this.stack=Mt.stack},_.DOMException.prototype=Object.create(Error.prototype),_.DOMException.prototype.constructor=_.DOMException}function at(ft,lt){return new Promise(function(Ft,Mt){var yt=new wt(ft,lt);if(yt.signal&&yt.signal.aborted)return Mt(new _.DOMException("Aborted","AbortError"));var ct=new XMLHttpRequest;function rt(){ct.abort()}ct.onload=function(){var se={status:ct.status,statusText:ct.statusText,headers:Jt(ct.getAllResponseHeaders()||"")};se.url="responseURL"in ct?ct.responseURL:se.headers.get("X-Request-URL"),Ft(new Ct("response"in ct?ct.response:ct.responseText,se))},ct.onerror=function(){Mt(new TypeError("Network request failed"))},ct.ontimeout=function(){Mt(new TypeError("Network request failed"))},ct.onabort=function(){Mt(new _.DOMException("Aborted","AbortError"))},ct.open(yt.method,yt.url,!0),"include"===yt.credentials?ct.withCredentials=!0:"omit"===yt.credentials&&(ct.withCredentials=!1),"responseType"in ct&&C_blob&&(ct.responseType="blob"),yt.headers.forEach(function(se,xt){ct.setRequestHeader(xt,se)}),yt.signal&&(yt.signal.addEventListener("abort",rt),ct.onreadystatechange=function(){4===ct.readyState&&yt.signal.removeEventListener("abort",rt)}),ct.send(void 0===yt._bodyInit?null:yt._bodyInit)})}at.polyfill=!0,B.fetch||(B.fetch=at,B.Headers=a,B.Request=wt,B.Response=Ct),_.Headers=a,_.Request=wt,_.Response=Ct,_.fetch=at,Object.defineProperty(_,"__esModule",{value:!0})}({})},89986:B=>{"use strict";function X(t){return t instanceof Buffer||t instanceof Date||t instanceof RegExp}function _(t){if(t instanceof Buffer){var n=Buffer.alloc?Buffer.alloc(t.length):new Buffer(t.length);return t.copy(n),n}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t);throw new Error("Unexpected situation")}function C(t){var n=[];return t.forEach(function(o,r){n[r]="object"==typeof o&&null!==o?Array.isArray(o)?C(o):X(o)?_(o):e({},o):o}),n}function m(t,n){return"__proto__"===n?void 0:t[n]}var e=B.exports=function(){if(arguments.length<1||"object"!=typeof arguments[0])return!1;if(arguments.length<2)return arguments[0];var o,r,t=arguments[0],n=Array.prototype.slice.call(arguments,1);return n.forEach(function(h){"object"!=typeof h||null===h||Array.isArray(h)||Object.keys(h).forEach(function(R){if(r=m(t,R),(o=m(h,R))!==t)return"object"!=typeof o||null===o?void(t[R]=o):Array.isArray(o)?void(t[R]=C(o)):X(o)?void(t[R]=_(o)):"object"!=typeof r||null===r||Array.isArray(r)?void(t[R]=e({},o)):void(t[R]=e(r,o))})}),t}},66939:B=>{"use strict";var X="Function.prototype.bind called on incompatible ",_=Array.prototype.slice,C=Object.prototype.toString,m="[object Function]";B.exports=function(t){var n=this;if("function"!=typeof n||C.call(n)!==m)throw new TypeError(X+n);for(var r,o=_.call(arguments,1),a=function(){if(this instanceof r){var nt=n.apply(this,o.concat(_.call(arguments)));return Object(nt)===nt?nt:this}return n.apply(t,o.concat(_.call(arguments)))},h=Math.max(0,n.length-o.length),R=[],L=0;L<h;L++)R.push("$"+L);if(r=Function("binder","return function ("+R.join(",")+"){ return binder.apply(this,arguments); }")(a),n.prototype){var W=function(){};W.prototype=n.prototype,r.prototype=new W,W.prototype=null}return r}},37341:(B,X,_)=>{"use strict";var C=_(66939);B.exports=Function.prototype.bind||C},23141:(B,X,_)=>{"use strict";var C,m=SyntaxError,e=Function,t=TypeError,n=function(Ft){try{return e('"use strict"; return ('+Ft+").constructor;")()}catch(Mt){}},o=Object.getOwnPropertyDescriptor;if(o)try{o({},"")}catch(Ft){o=null}var r=function(){throw new t},a=o?function(){try{return r}catch(Ft){try{return o(arguments,"callee").get}catch(Mt){return r}}}():r,h=_(73165)(),R=Object.getPrototypeOf||function(Ft){return Ft.__proto__},L={},W="undefined"==typeof Uint8Array?C:R(Uint8Array),nt={"%AggregateError%":"undefined"==typeof AggregateError?C:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?C:ArrayBuffer,"%ArrayIteratorPrototype%":h?R([][Symbol.iterator]()):C,"%AsyncFromSyncIteratorPrototype%":C,"%AsyncFunction%":L,"%AsyncGenerator%":L,"%AsyncGeneratorFunction%":L,"%AsyncIteratorPrototype%":L,"%Atomics%":"undefined"==typeof Atomics?C:Atomics,"%BigInt%":"undefined"==typeof BigInt?C:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?C:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?C:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?C:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?C:FinalizationRegistry,"%Function%":e,"%GeneratorFunction%":L,"%Int8Array%":"undefined"==typeof Int8Array?C:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?C:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?C:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h?R(R([][Symbol.iterator]())):C,"%JSON%":"object"==typeof JSON?JSON:C,"%Map%":"undefined"==typeof Map?C:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&h?R((new Map)[Symbol.iterator]()):C,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?C:Promise,"%Proxy%":"undefined"==typeof Proxy?C:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?C:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?C:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&h?R((new Set)[Symbol.iterator]()):C,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?C:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h?R(""[Symbol.iterator]()):C,"%Symbol%":h?Symbol:C,"%SyntaxError%":m,"%ThrowTypeError%":a,"%TypedArray%":W,"%TypeError%":t,"%Uint8Array%":"undefined"==typeof Uint8Array?C:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?C:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?C:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?C:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?C:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?C:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?C:WeakSet},et=function Ft(Mt){var yt;if("%AsyncFunction%"===Mt)yt=n("async function () {}");else if("%GeneratorFunction%"===Mt)yt=n("function* () {}");else if("%AsyncGeneratorFunction%"===Mt)yt=n("async function* () {}");else if("%AsyncGenerator%"===Mt){var ct=Ft("%AsyncGeneratorFunction%");ct&&(yt=ct.prototype)}else if("%AsyncIteratorPrototype%"===Mt){var rt=Ft("%AsyncGenerator%");rt&&(yt=R(rt.prototype))}return nt[Mt]=yt,yt},Et={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},It=_(37341),gt=_(91279),wt=It.call(Function.call,Array.prototype.concat),Ut=It.call(Function.apply,Array.prototype.splice),Jt=It.call(Function.call,String.prototype.replace),Ct=It.call(Function.call,String.prototype.slice),bt=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,at=/\\(\\)?/g,ft=function(Mt){var yt=Ct(Mt,0,1),ct=Ct(Mt,-1);if("%"===yt&&"%"!==ct)throw new m("invalid intrinsic syntax, expected closing `%`");if("%"===ct&&"%"!==yt)throw new m("invalid intrinsic syntax, expected opening `%`");var rt=[];return Jt(Mt,bt,function(se,xt,Lt,de){rt[rt.length]=Lt?Jt(de,at,"$1"):xt||se}),rt},lt=function(Mt,yt){var rt,ct=Mt;if(gt(Et,ct)&&(ct="%"+(rt=Et[ct])[0]+"%"),gt(nt,ct)){var se=nt[ct];if(se===L&&(se=et(ct)),void 0===se&&!yt)throw new t("intrinsic "+Mt+" exists, but is not available. Please file an issue!");return{alias:rt,name:ct,value:se}}throw new m("intrinsic "+Mt+" does not exist!")};B.exports=function(Mt,yt){if("string"!=typeof Mt||0===Mt.length)throw new t("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof yt)throw new t('"allowMissing" argument must be a boolean');var ct=ft(Mt),rt=ct.length>0?ct[0]:"",se=lt("%"+rt+"%",yt),xt=se.name,Lt=se.value,de=!1,_e=se.alias;_e&&(rt=_e[0],Ut(ct,wt([0,1],_e)));for(var ce=1,Ae=!0;ce<ct.length;ce+=1){var Ne=ct[ce],qe=Ct(Ne,0,1),Di=Ct(Ne,-1);if(('"'===qe||"'"===qe||"`"===qe||'"'===Di||"'"===Di||"`"===Di)&&qe!==Di)throw new m("property names with quotes must have matching quotes");if(("constructor"===Ne||!Ae)&&(de=!0),gt(nt,xt="%"+(rt+="."+Ne)+"%"))Lt=nt[xt];else if(null!=Lt){if(!(Ne in Lt)){if(!yt)throw new t("base intrinsic for "+Mt+" exists, but the property is not available.");return}if(o&&ce+1>=ct.length){var ei=o(Lt,Ne);Lt=(Ae=!!ei)&&"get"in ei&&!("originalValue"in ei.get)?ei.get:Lt[Ne]}else Ae=gt(Lt,Ne),Lt=Lt[Ne];Ae&&!de&&(nt[xt]=Lt)}}return Lt}},73165:(B,X,_)=>{"use strict";var C="undefined"!=typeof Symbol&&Symbol,m=_(43918);B.exports=function(){return"function"==typeof C&&"function"==typeof Symbol&&"symbol"==typeof C("foo")&&"symbol"==typeof Symbol("bar")&&m()}},43918:B=>{"use strict";B.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var _={},C=Symbol("test"),m=Object(C);if("string"==typeof C||"[object Symbol]"!==Object.prototype.toString.call(C)||"[object Symbol]"!==Object.prototype.toString.call(m))return!1;for(C in _[C]=42,_)return!1;if("function"==typeof Object.keys&&0!==Object.keys(_).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(_).length)return!1;var t=Object.getOwnPropertySymbols(_);if(1!==t.length||t[0]!==C||!Object.prototype.propertyIsEnumerable.call(_,C))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var n=Object.getOwnPropertyDescriptor(_,C);if(42!==n.value||!0!==n.enumerable)return!1}return!0}},91279:(B,X,_)=>{"use strict";var C=_(37341);B.exports=C.call(Function.call,Object.prototype.hasOwnProperty)},9976:(B,X,_)=>{var e=_(66463)(_(75719),"DataView");B.exports=e},35705:(B,X,_)=>{var C=_(51089),m=_(2564),e=_(65929),t=_(1422),n=_(24795);function o(r){var a=-1,h=null==r?0:r.length;for(this.clear();++a<h;){var R=r[a];this.set(R[0],R[1])}}o.prototype.clear=C,o.prototype.delete=m,o.prototype.get=e,o.prototype.has=t,o.prototype.set=n,B.exports=o},64616:(B,X,_)=>{var C=_(45909),m=_(62578),e=_(20701),t=_(17438),n=_(60369);function o(r){var a=-1,h=null==r?0:r.length;for(this.clear();++a<h;){var R=r[a];this.set(R[0],R[1])}}o.prototype.clear=C,o.prototype.delete=m,o.prototype.get=e,o.prototype.has=t,o.prototype.set=n,B.exports=o},61805:(B,X,_)=>{var e=_(66463)(_(75719),"Map");B.exports=e},90923:(B,X,_)=>{var C=_(68791),m=_(3805),e=_(9274),t=_(31967),n=_(27537);function o(r){var a=-1,h=null==r?0:r.length;for(this.clear();++a<h;){var R=r[a];this.set(R[0],R[1])}}o.prototype.clear=C,o.prototype.delete=m,o.prototype.get=e,o.prototype.has=t,o.prototype.set=n,B.exports=o},49845:(B,X,_)=>{var e=_(66463)(_(75719),"Promise");B.exports=e},79716:(B,X,_)=>{var e=_(66463)(_(75719),"Set");B.exports=e},3824:(B,X,_)=>{var C=_(64616),m=_(25411),e=_(79582),t=_(26415),n=_(30666),o=_(58669);function r(a){var h=this.__data__=new C(a);this.size=h.size}r.prototype.clear=m,r.prototype.delete=e,r.prototype.get=t,r.prototype.has=n,r.prototype.set=o,B.exports=r},87425:(B,X,_)=>{var C=_(75719);B.exports=C.Symbol},2236:(B,X,_)=>{var C=_(75719);B.exports=C.Uint8Array},65626:(B,X,_)=>{var e=_(66463)(_(75719),"WeakMap");B.exports=e},57990:B=>{B.exports=function X(_,C){for(var m=-1,e=null==_?0:_.length;++m<e&&!1!==C(_[m],m,_););return _}},92161:B=>{B.exports=function X(_,C){for(var m=-1,e=null==_?0:_.length,t=0,n=[];++m<e;){var o=_[m];C(o,m,_)&&(n[t++]=o)}return n}},75715:(B,X,_)=>{var C=_(93784),m=_(93832),e=_(83684),t=_(18666),n=_(28207),o=_(78558),a=Object.prototype.hasOwnProperty;B.exports=function h(R,L){var W=e(R),nt=!W&&m(R),et=!W&&!nt&&t(R),Et=!W&&!nt&&!et&&o(R),It=W||nt||et||Et,gt=It?C(R.length,String):[],wt=gt.length;for(var Ut in R)(L||a.call(R,Ut))&&(!It||!("length"==Ut||et&&("offset"==Ut||"parent"==Ut)||Et&&("buffer"==Ut||"byteLength"==Ut||"byteOffset"==Ut)||n(Ut,wt)))&&gt.push(Ut);return gt}},72437:B=>{B.exports=function X(_,C){for(var m=-1,e=null==_?0:_.length,t=Array(e);++m<e;)t[m]=C(_[m],m,_);return t}},85271:B=>{B.exports=function X(_,C){for(var m=-1,e=C.length,t=_.length;++m<e;)_[t+m]=C[m];return _}},82407:(B,X,_)=>{var C=_(92034),m=_(79106),t=Object.prototype.hasOwnProperty;B.exports=function n(o,r,a){var h=o[r];(!t.call(o,r)||!m(h,a)||void 0===a&&!(r in o))&&C(o,r,a)}},84760:(B,X,_)=>{var C=_(79106);B.exports=function m(e,t){for(var n=e.length;n--;)if(C(e[n][0],t))return n;return-1}},54883:(B,X,_)=>{var C=_(21492),m=_(63344);B.exports=function e(t,n){return t&&C(n,m(n),t)}},26031:(B,X,_)=>{var C=_(21492),m=_(39479);B.exports=function e(t,n){return t&&C(n,m(n),t)}},92034:(B,X,_)=>{var C=_(90086);B.exports=function m(e,t,n){"__proto__"==t&&C?C(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},74857:(B,X,_)=>{var C=_(3824),m=_(57990),e=_(82407),t=_(54883),n=_(26031),o=_(20416),r=_(14601),a=_(36377),h=_(54646),R=_(20419),L=_(80553),W=_(40691),nt=_(49965),et=_(40349),Et=_(31743),It=_(83684),gt=_(18666),wt=_(15261),Ut=_(6264),Jt=_(57221),Ct=_(63344),bt=_(39479),Ft="[object Arguments]",se="[object Function]",_e="[object Object]",Ee={};Ee[Ft]=Ee["[object Array]"]=Ee["[object ArrayBuffer]"]=Ee["[object DataView]"]=Ee["[object Boolean]"]=Ee["[object Date]"]=Ee["[object Float32Array]"]=Ee["[object Float64Array]"]=Ee["[object Int8Array]"]=Ee["[object Int16Array]"]=Ee["[object Int32Array]"]=Ee["[object Map]"]=Ee["[object Number]"]=Ee[_e]=Ee["[object RegExp]"]=Ee["[object Set]"]=Ee["[object String]"]=Ee["[object Symbol]"]=Ee["[object Uint8Array]"]=Ee["[object Uint8ClampedArray]"]=Ee["[object Uint16Array]"]=Ee["[object Uint32Array]"]=!0,Ee["[object Error]"]=Ee[se]=Ee["[object WeakMap]"]=!1,B.exports=function ne(ee,Oe,le,me,ye,Kt){var Zt,We=1&Oe,$e=2&Oe,Ti=4&Oe;if(le&&(Zt=ye?le(ee,me,ye,Kt):le(ee)),void 0!==Zt)return Zt;if(!Ut(ee))return ee;var vi=It(ee);if(vi){if(Zt=nt(ee),!We)return r(ee,Zt)}else{var di=W(ee),Gi=di==se||"[object GeneratorFunction]"==di;if(gt(ee))return o(ee,We);if(di==_e||di==Ft||Gi&&!ye){if(Zt=$e||Gi?{}:Et(ee),!We)return $e?h(ee,n(Zt,ee)):a(ee,t(Zt,ee))}else{if(!Ee[di])return ye?ee:{};Zt=et(ee,di,We)}}Kt||(Kt=new C);var Ri=Kt.get(ee);if(Ri)return Ri;Kt.set(ee,Zt),Jt(ee)?ee.forEach(function(De){Zt.add(ne(De,Oe,le,De,ee,Kt))}):wt(ee)&&ee.forEach(function(De,_i){Zt.set(_i,ne(De,Oe,le,_i,ee,Kt))});var ge=vi?void 0:(Ti?$e?L:R:$e?bt:Ct)(ee);return m(ge||ee,function(De,_i){ge&&(De=ee[_i=De]),e(Zt,_i,ne(De,Oe,le,_i,ee,Kt))}),Zt}},85602:(B,X,_)=>{var C=_(6264),m=Object.create,e=function(){function t(){}return function(n){if(!C(n))return{};if(m)return m(n);t.prototype=n;var o=new t;return t.prototype=void 0,o}}();B.exports=e},17046:(B,X,_)=>{var C=_(57783),m=_(97046);B.exports=function e(t,n){for(var o=0,r=(n=C(n,t)).length;null!=t&&o<r;)t=t[m(n[o++])];return o&&o==r?t:void 0}},27879:(B,X,_)=>{var C=_(85271),m=_(83684);B.exports=function e(t,n,o){var r=n(t);return m(t)?r:C(r,o(t))}},40232:(B,X,_)=>{var C=_(87425),m=_(98329),e=_(78295),o=C?C.toStringTag:void 0;B.exports=function r(a){return null==a?void 0===a?"[object Undefined]":"[object Null]":o&&o in Object(a)?m(a):e(a)}},81065:(B,X,_)=>{var C=_(40232),m=_(22308);B.exports=function t(n){return m(n)&&"[object Arguments]"==C(n)}},16612:(B,X,_)=>{var C=_(40691),m=_(22308);B.exports=function t(n){return m(n)&&"[object Map]"==C(n)}},23796:(B,X,_)=>{var C=_(88066),m=_(98031),e=_(6264),t=_(65295),o=/^\[object .+?Constructor\]$/,L=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");B.exports=function W(nt){return!(!e(nt)||m(nt))&&(C(nt)?L:o).test(t(nt))}},26987:(B,X,_)=>{var C=_(40691),m=_(22308);B.exports=function t(n){return m(n)&&"[object Set]"==C(n)}},11264:(B,X,_)=>{var C=_(40232),m=_(67818),e=_(22308),yt={};yt["[object Float32Array]"]=yt["[object Float64Array]"]=yt["[object Int8Array]"]=yt["[object Int16Array]"]=yt["[object Int32Array]"]=yt["[object Uint8Array]"]=yt["[object Uint8ClampedArray]"]=yt["[object Uint16Array]"]=yt["[object Uint32Array]"]=!0,yt["[object Arguments]"]=yt["[object Array]"]=yt["[object ArrayBuffer]"]=yt["[object Boolean]"]=yt["[object DataView]"]=yt["[object Date]"]=yt["[object Error]"]=yt["[object Function]"]=yt["[object Map]"]=yt["[object Number]"]=yt["[object Object]"]=yt["[object RegExp]"]=yt["[object Set]"]=yt["[object String]"]=yt["[object WeakMap]"]=!1,B.exports=function ct(rt){return e(rt)&&m(rt.length)&&!!yt[C(rt)]}},16249:(B,X,_)=>{var C=_(27877),m=_(73595),t=Object.prototype.hasOwnProperty;B.exports=function n(o){if(!C(o))return m(o);var r=[];for(var a in Object(o))t.call(o,a)&&"constructor"!=a&&r.push(a);return r}},90374:(B,X,_)=>{var C=_(6264),m=_(27877),e=_(47098),n=Object.prototype.hasOwnProperty;B.exports=function o(r){if(!C(r))return e(r);var a=m(r),h=[];for(var R in r)"constructor"==R&&(a||!n.call(r,R))||h.push(R);return h}},93784:B=>{B.exports=function X(_,C){for(var m=-1,e=Array(_);++m<_;)e[m]=C(m);return e}},15825:(B,X,_)=>{var C=_(87425),m=_(72437),e=_(83684),t=_(38380),o=C?C.prototype:void 0,r=o?o.toString:void 0;B.exports=function a(h){if("string"==typeof h)return h;if(e(h))return m(h,a)+"";if(t(h))return r?r.call(h):"";var R=h+"";return"0"==R&&1/h==-1/0?"-0":R}},81279:B=>{B.exports=function X(_){return function(C){return _(C)}}},57783:(B,X,_)=>{var C=_(83684),m=_(92615),e=_(4113),t=_(30381);B.exports=function n(o,r){return C(o)?o:m(o,r)?[o]:e(t(o))}},2050:(B,X,_)=>{var C=_(2236);B.exports=function m(e){var t=new e.constructor(e.byteLength);return new C(t).set(new C(e)),t}},20416:(B,X,_)=>{B=_.nmd(B);var C=_(75719),m=X&&!X.nodeType&&X,e=m&&B&&!B.nodeType&&B,n=e&&e.exports===m?C.Buffer:void 0,o=n?n.allocUnsafe:void 0;B.exports=function r(a,h){if(h)return a.slice();var R=a.length,L=o?o(R):new a.constructor(R);return a.copy(L),L}},85975:(B,X,_)=>{var C=_(2050);B.exports=function m(e,t){var n=t?C(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},57092:B=>{var X=/\w*$/;B.exports=function _(C){var m=new C.constructor(C.source,X.exec(C));return m.lastIndex=C.lastIndex,m}},954:(B,X,_)=>{var C=_(87425),m=C?C.prototype:void 0,e=m?m.valueOf:void 0;B.exports=function t(n){return e?Object(e.call(n)):{}}},76009:(B,X,_)=>{var C=_(2050);B.exports=function m(e,t){var n=t?C(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},14601:B=>{B.exports=function X(_,C){var m=-1,e=_.length;for(C||(C=Array(e));++m<e;)C[m]=_[m];return C}},21492:(B,X,_)=>{var C=_(82407),m=_(92034);B.exports=function e(t,n,o,r){var a=!o;o||(o={});for(var h=-1,R=n.length;++h<R;){var L=n[h],W=r?r(o[L],t[L],L,o,t):void 0;void 0===W&&(W=t[L]),a?m(o,L,W):C(o,L,W)}return o}},36377:(B,X,_)=>{var C=_(21492),m=_(640);B.exports=function e(t,n){return C(t,m(t),n)}},54646:(B,X,_)=>{var C=_(21492),m=_(87884);B.exports=function e(t,n){return C(t,m(t),n)}},66092:(B,X,_)=>{var C=_(75719);B.exports=C["__core-js_shared__"]},90086:(B,X,_)=>{var C=_(66463),m=function(){try{var e=C(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();B.exports=m},15307:B=>{var X="object"==typeof global&&global&&global.Object===Object&&global;B.exports=X},20419:(B,X,_)=>{var C=_(27879),m=_(640),e=_(63344);B.exports=function t(n){return C(n,e,m)}},80553:(B,X,_)=>{var C=_(27879),m=_(87884),e=_(39479);B.exports=function t(n){return C(n,e,m)}},90327:(B,X,_)=>{var C=_(40497);B.exports=function m(e,t){var n=e.__data__;return C(t)?n["string"==typeof t?"string":"hash"]:n.map}},66463:(B,X,_)=>{var C=_(23796),m=_(47820);B.exports=function e(t,n){var o=m(t,n);return C(o)?o:void 0}},566:(B,X,_)=>{var m=_(75854)(Object.getPrototypeOf,Object);B.exports=m},98329:(B,X,_)=>{var C=_(87425),m=Object.prototype,e=m.hasOwnProperty,t=m.toString,n=C?C.toStringTag:void 0;B.exports=function o(r){var a=e.call(r,n),h=r[n];try{r[n]=void 0;var R=!0}catch(W){}var L=t.call(r);return R&&(a?r[n]=h:delete r[n]),L}},640:(B,X,_)=>{var C=_(92161),m=_(35587),t=Object.prototype.propertyIsEnumerable,n=Object.getOwnPropertySymbols;B.exports=n?function(r){return null==r?[]:(r=Object(r),C(n(r),function(a){return t.call(r,a)}))}:m},87884:(B,X,_)=>{var C=_(85271),m=_(566),e=_(640),t=_(35587);B.exports=Object.getOwnPropertySymbols?function(r){for(var a=[];r;)C(a,e(r)),r=m(r);return a}:t},40691:(B,X,_)=>{var C=_(9976),m=_(61805),e=_(49845),t=_(79716),n=_(65626),o=_(40232),r=_(65295),a="[object Map]",R="[object Promise]",L="[object Set]",W="[object WeakMap]",nt="[object DataView]",et=r(C),Et=r(m),It=r(e),gt=r(t),wt=r(n),Ut=o;(C&&Ut(new C(new ArrayBuffer(1)))!=nt||m&&Ut(new m)!=a||e&&Ut(e.resolve())!=R||t&&Ut(new t)!=L||n&&Ut(new n)!=W)&&(Ut=function(Jt){var Ct=o(Jt),bt="[object Object]"==Ct?Jt.constructor:void 0,at=bt?r(bt):"";if(at)switch(at){case et:return nt;case Et:return a;case It:return R;case gt:return L;case wt:return W}return Ct}),B.exports=Ut},47820:B=>{B.exports=function X(_,C){return null==_?void 0:_[C]}},51089:(B,X,_)=>{var C=_(13947);B.exports=function m(){this.__data__=C?C(null):{},this.size=0}},2564:B=>{B.exports=function X(_){var C=this.has(_)&&delete this.__data__[_];return this.size-=C?1:0,C}},65929:(B,X,_)=>{var C=_(13947),t=Object.prototype.hasOwnProperty;B.exports=function n(o){var r=this.__data__;if(C){var a=r[o];return"__lodash_hash_undefined__"===a?void 0:a}return t.call(r,o)?r[o]:void 0}},1422:(B,X,_)=>{var C=_(13947),e=Object.prototype.hasOwnProperty;B.exports=function t(n){var o=this.__data__;return C?void 0!==o[n]:e.call(o,n)}},24795:(B,X,_)=>{var C=_(13947);B.exports=function e(t,n){var o=this.__data__;return this.size+=this.has(t)?0:1,o[t]=C&&void 0===n?"__lodash_hash_undefined__":n,this}},49965:B=>{var _=Object.prototype.hasOwnProperty;B.exports=function C(m){var e=m.length,t=new m.constructor(e);return e&&"string"==typeof m[0]&&_.call(m,"index")&&(t.index=m.index,t.input=m.input),t}},40349:(B,X,_)=>{var C=_(2050),m=_(85975),e=_(57092),t=_(954),n=_(76009);B.exports=function lt(Ft,Mt,yt){var ct=Ft.constructor;switch(Mt){case"[object ArrayBuffer]":return C(Ft);case"[object Boolean]":case"[object Date]":return new ct(+Ft);case"[object DataView]":return m(Ft,yt);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return n(Ft,yt);case"[object Map]":case"[object Set]":return new ct;case"[object Number]":case"[object String]":return new ct(Ft);case"[object RegExp]":return e(Ft);case"[object Symbol]":return t(Ft)}}},31743:(B,X,_)=>{var C=_(85602),m=_(566),e=_(27877);B.exports=function t(n){return"function"!=typeof n.constructor||e(n)?{}:C(m(n))}},28207:B=>{var _=/^(?:0|[1-9]\d*)$/;B.exports=function C(m,e){var t=typeof m;return!!(e=null==e?9007199254740991:e)&&("number"==t||"symbol"!=t&&_.test(m))&&m>-1&&m%1==0&&m<e}},92615:(B,X,_)=>{var C=_(83684),m=_(38380),e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,t=/^\w*$/;B.exports=function n(o,r){if(C(o))return!1;var a=typeof o;return!("number"!=a&&"symbol"!=a&&"boolean"!=a&&null!=o&&!m(o))||t.test(o)||!e.test(o)||null!=r&&o in Object(r)}},40497:B=>{B.exports=function X(_){var C=typeof _;return"string"==C||"number"==C||"symbol"==C||"boolean"==C?"__proto__"!==_:null===_}},98031:(B,X,_)=>{var t,C=_(66092),m=(t=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";B.exports=function e(t){return!!m&&m in t}},27877:B=>{var X=Object.prototype;B.exports=function _(C){var m=C&&C.constructor;return C===("function"==typeof m&&m.prototype||X)}},45909:B=>{B.exports=function X(){this.__data__=[],this.size=0}},62578:(B,X,_)=>{var C=_(84760),e=Array.prototype.splice;B.exports=function t(n){var o=this.__data__,r=C(o,n);return!(r<0||(r==o.length-1?o.pop():e.call(o,r,1),--this.size,0))}},20701:(B,X,_)=>{var C=_(84760);B.exports=function m(e){var t=this.__data__,n=C(t,e);return n<0?void 0:t[n][1]}},17438:(B,X,_)=>{var C=_(84760);B.exports=function m(e){return C(this.__data__,e)>-1}},60369:(B,X,_)=>{var C=_(84760);B.exports=function m(e,t){var n=this.__data__,o=C(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},68791:(B,X,_)=>{var C=_(35705),m=_(64616),e=_(61805);B.exports=function t(){this.size=0,this.__data__={hash:new C,map:new(e||m),string:new C}}},3805:(B,X,_)=>{var C=_(90327);B.exports=function m(e){var t=C(this,e).delete(e);return this.size-=t?1:0,t}},9274:(B,X,_)=>{var C=_(90327);B.exports=function m(e){return C(this,e).get(e)}},31967:(B,X,_)=>{var C=_(90327);B.exports=function m(e){return C(this,e).has(e)}},27537:(B,X,_)=>{var C=_(90327);B.exports=function m(e,t){var n=C(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},48815:(B,X,_)=>{var C=_(40917);B.exports=function e(t){var n=C(t,function(r){return 500===o.size&&o.clear(),r}),o=n.cache;return n}},13947:(B,X,_)=>{var m=_(66463)(Object,"create");B.exports=m},73595:(B,X,_)=>{var m=_(75854)(Object.keys,Object);B.exports=m},47098:B=>{B.exports=function X(_){var C=[];if(null!=_)for(var m in Object(_))C.push(m);return C}},56520:(B,X,_)=>{B=_.nmd(B);var C=_(15307),m=X&&!X.nodeType&&X,e=m&&B&&!B.nodeType&&B,n=e&&e.exports===m&&C.process,o=function(){try{return e&&e.require&&e.require("util").types||n&&n.binding&&n.binding("util")}catch(a){}}();B.exports=o},78295:B=>{var _=Object.prototype.toString;B.exports=function C(m){return _.call(m)}},75854:B=>{B.exports=function X(_,C){return function(m){return _(C(m))}}},75719:(B,X,_)=>{var C=_(15307),m="object"==typeof self&&self&&self.Object===Object&&self,e=C||m||Function("return this")();B.exports=e},25411:(B,X,_)=>{var C=_(64616);B.exports=function m(){this.__data__=new C,this.size=0}},79582:B=>{B.exports=function X(_){var C=this.__data__,m=C.delete(_);return this.size=C.size,m}},26415:B=>{B.exports=function X(_){return this.__data__.get(_)}},30666:B=>{B.exports=function X(_){return this.__data__.has(_)}},58669:(B,X,_)=>{var C=_(64616),m=_(61805),e=_(90923);B.exports=function n(o,r){var a=this.__data__;if(a instanceof C){var h=a.__data__;if(!m||h.length<199)return h.push([o,r]),this.size=++a.size,this;a=this.__data__=new e(h)}return a.set(o,r),this.size=a.size,this}},4113:(B,X,_)=>{var C=_(48815),m=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,e=/\\(\\)?/g,t=C(function(n){var o=[];return 46===n.charCodeAt(0)&&o.push(""),n.replace(m,function(r,a,h,R){o.push(h?R.replace(e,"$1"):a||r)}),o});B.exports=t},97046:(B,X,_)=>{var C=_(38380);B.exports=function e(t){if("string"==typeof t||C(t))return t;var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},65295:B=>{var _=Function.prototype.toString;B.exports=function C(m){if(null!=m){try{return _.call(m)}catch(e){}try{return m+""}catch(e){}}return""}},69380:(B,X,_)=>{var C=_(74857);B.exports=function t(n){return C(n,5)}},79106:B=>{B.exports=function X(_,C){return _===C||_!=_&&C!=C}},36817:(B,X,_)=>{var C=_(17046);B.exports=function m(e,t,n){var o=null==e?void 0:C(e,t);return void 0===o?n:o}},93832:(B,X,_)=>{var C=_(81065),m=_(22308),e=Object.prototype,t=e.hasOwnProperty,n=e.propertyIsEnumerable,o=C(function(){return arguments}())?C:function(r){return m(r)&&t.call(r,"callee")&&!n.call(r,"callee")};B.exports=o},83684:B=>{B.exports=Array.isArray},49300:(B,X,_)=>{var C=_(88066),m=_(67818);B.exports=function e(t){return null!=t&&m(t.length)&&!C(t)}},18666:(B,X,_)=>{B=_.nmd(B);var C=_(75719),m=_(93320),e=X&&!X.nodeType&&X,t=e&&B&&!B.nodeType&&B,o=t&&t.exports===e?C.Buffer:void 0;B.exports=(o?o.isBuffer:void 0)||m},65359:(B,X,_)=>{var C=_(16249),m=_(40691),e=_(93832),t=_(83684),n=_(49300),o=_(18666),r=_(27877),a=_(78558),W=Object.prototype.hasOwnProperty;B.exports=function nt(et){if(null==et)return!0;if(n(et)&&(t(et)||"string"==typeof et||"function"==typeof et.splice||o(et)||a(et)||e(et)))return!et.length;var Et=m(et);if("[object Map]"==Et||"[object Set]"==Et)return!et.size;if(r(et))return!C(et).length;for(var It in et)if(W.call(et,It))return!1;return!0}},88066:(B,X,_)=>{var C=_(40232),m=_(6264);B.exports=function r(a){if(!m(a))return!1;var h=C(a);return"[object Function]"==h||"[object GeneratorFunction]"==h||"[object AsyncFunction]"==h||"[object Proxy]"==h}},67818:B=>{B.exports=function _(C){return"number"==typeof C&&C>-1&&C%1==0&&C<=9007199254740991}},15261:(B,X,_)=>{var C=_(16612),m=_(81279),e=_(56520),t=e&&e.isMap,n=t?m(t):C;B.exports=n},6264:B=>{B.exports=function X(_){var C=typeof _;return null!=_&&("object"==C||"function"==C)}},22308:B=>{B.exports=function X(_){return null!=_&&"object"==typeof _}},27935:(B,X,_)=>{var C=_(40232),m=_(566),e=_(22308),r=Function.prototype.toString,a=Object.prototype.hasOwnProperty,h=r.call(Object);B.exports=function R(L){if(!e(L)||"[object Object]"!=C(L))return!1;var W=m(L);if(null===W)return!0;var nt=a.call(W,"constructor")&&W.constructor;return"function"==typeof nt&&nt instanceof nt&&r.call(nt)==h}},57221:(B,X,_)=>{var C=_(26987),m=_(81279),e=_(56520),t=e&&e.isSet,n=t?m(t):C;B.exports=n},38380:(B,X,_)=>{var C=_(40232),m=_(22308);B.exports=function t(n){return"symbol"==typeof n||m(n)&&"[object Symbol]"==C(n)}},78558:(B,X,_)=>{var C=_(11264),m=_(81279),e=_(56520),t=e&&e.isTypedArray,n=t?m(t):C;B.exports=n},63344:(B,X,_)=>{var C=_(75715),m=_(16249),e=_(49300);B.exports=function t(n){return e(n)?C(n):m(n)}},39479:(B,X,_)=>{var C=_(75715),m=_(90374),e=_(49300);B.exports=function t(n){return e(n)?C(n,!0):m(n)}},40917:(B,X,_)=>{var C=_(90923);function e(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");var o=function(){var r=arguments,a=n?n.apply(this,r):r[0],h=o.cache;if(h.has(a))return h.get(a);var R=t.apply(this,r);return o.cache=h.set(a,R)||h,R};return o.cache=new(e.Cache||C),o}e.Cache=C,B.exports=e},35587:B=>{B.exports=function X(){return[]}},93320:B=>{B.exports=function X(){return!1}},30381:(B,X,_)=>{var C=_(15825);B.exports=function m(e){return null==e?"":C(e)}},50847:(B,X,_)=>{var C="function"==typeof Map&&Map.prototype,m=Object.getOwnPropertyDescriptor&&C?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,e=C&&m&&"function"==typeof m.get?m.get:null,t=C&&Map.prototype.forEach,n="function"==typeof Set&&Set.prototype,o=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,r=n&&o&&"function"==typeof o.get?o.get:null,a=n&&Set.prototype.forEach,R="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,W="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,et="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,Et=Boolean.prototype.valueOf,It=Object.prototype.toString,gt=Function.prototype.toString,wt=String.prototype.match,Ut=String.prototype.slice,Jt=String.prototype.replace,Ct=String.prototype.toUpperCase,bt=String.prototype.toLowerCase,at=RegExp.prototype.test,ft=Array.prototype.concat,lt=Array.prototype.join,Ft=Array.prototype.slice,Mt=Math.floor,yt="function"==typeof BigInt?BigInt.prototype.valueOf:null,ct=Object.getOwnPropertySymbols,rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,se="function"==typeof Symbol&&"object"==typeof Symbol.iterator,xt="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol,1)?Symbol.toStringTag:null,Lt=Object.prototype.propertyIsEnumerable,de=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(ge){return ge.__proto__}:null);function _e(ge,De){if(ge===1/0||ge===-1/0||ge!=ge||ge&&ge>-1e3&&ge<1e3||at.call(/e/,De))return De;var _i=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof ge){var yi=ge<0?-Mt(-ge):Mt(ge);if(yi!==ge){var Fi=String(yi),Ni=Ut.call(De,Fi.length+1);return Jt.call(Fi,_i,"$&_")+"."+Jt.call(Jt.call(Ni,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Jt.call(De,_i,"$&_")}var ce=_(52175).custom,Ae=ce&&he(ce)?ce:null;function Ne(ge,De,_i){var yi="double"===(_i.quoteStyle||De)?'"':"'";return yi+ge+yi}function qe(ge){return Jt.call(String(ge),/"/g,"&quot;")}function Di(ge){return!("[object Array]"!==gi(ge)||xt&&"object"==typeof ge&&xt in ge)}function he(ge){if(se)return ge&&"object"==typeof ge&&ge instanceof Symbol;if("symbol"==typeof ge)return!0;if(!ge||"object"!=typeof ge||!rt)return!1;try{return rt.call(ge),!0}catch(De){}return!1}B.exports=function ge(De,_i,yi,Fi){var Ni=_i||{};if(je(Ni,"quoteStyle")&&"single"!==Ni.quoteStyle&&"double"!==Ni.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(je(Ni,"maxStringLength")&&("number"==typeof Ni.maxStringLength?Ni.maxStringLength<0&&Ni.maxStringLength!==1/0:null!==Ni.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var mn=!je(Ni,"customInspect")||Ni.customInspect;if("boolean"!=typeof mn&&"symbol"!==mn)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(je(Ni,"indent")&&null!==Ni.indent&&"\t"!==Ni.indent&&!(parseInt(Ni.indent,10)===Ni.indent&&Ni.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(je(Ni,"numericSeparator")&&"boolean"!=typeof Ni.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var si=Ni.numericSeparator;if(void 0===De)return"undefined";if(null===De)return"null";if("boolean"==typeof De)return De?"true":"false";if("string"==typeof De)return Zt(De,Ni);if("number"==typeof De){if(0===De)return 1/0/De>0?"0":"-0";var Ce=String(De);return si?_e(De,Ce):Ce}if("bigint"==typeof De){var Vt=String(De)+"n";return si?_e(De,Vt):Vt}var vt=void 0===Ni.depth?5:Ni.depth;if(void 0===yi&&(yi=0),yi>=vt&&vt>0&&"object"==typeof De)return Di(De)?"[Array]":"[Object]";var Gt=function Gi(ge,De){var _i;if("\t"===ge.indent)_i="\t";else{if(!("number"==typeof ge.indent&&ge.indent>0))return null;_i=lt.call(Array(ge.indent+1)," ")}return{base:_i,prev:lt.call(Array(De+1),_i)}}(Ni,yi);if(void 0===Fi)Fi=[];else if(ne(Fi,De)>=0)return"[Circular]";function fe(yr,xo,vo){if(xo&&(Fi=Ft.call(Fi)).push(xo),vo){var Fr={depth:Ni.depth};return je(Ni,"quoteStyle")&&(Fr.quoteStyle=Ni.quoteStyle),ge(yr,Fr,yi+1,Fi)}return ge(yr,Ni,yi+1,Fi)}if("function"==typeof De){var He=function Ee(ge){if(ge.name)return ge.name;var De=wt.call(gt.call(ge),/^function\s*([\w$]+)/);return De?De[1]:null}(De),$i=rn(De,fe);return"[Function"+(He?": "+He:" (anonymous)")+"]"+($i.length>0?" { "+lt.call($i,", ")+" }":"")}if(he(De)){var tn=se?Jt.call(String(De),/^(Symbol\(.*\))_[^)]*$/,"$1"):rt.call(De);return"object"!=typeof De||se?tn:$e(tn)}if(function Kt(ge){return!(!ge||"object"!=typeof ge)&&("undefined"!=typeof HTMLElement&&ge instanceof HTMLElement||"string"==typeof ge.nodeName&&"function"==typeof ge.getAttribute)}(De)){for(var In="<"+bt.call(String(De.nodeName)),no=De.attributes||[],li=0;li<no.length;li++)In+=" "+no[li].name+"="+Ne(qe(no[li].value),"double",Ni);return In+=">",De.childNodes&&De.childNodes.length&&(In+="..."),In+"</"+bt.call(String(De.nodeName))+">"}if(Di(De)){if(0===De.length)return"[]";var Je=rn(De,fe);return Gt&&!function di(ge){for(var De=0;De<ge.length;De++)if(ne(ge[De],"\n")>=0)return!1;return!0}(Je)?"["+Ri(Je,Gt)+"]":"[ "+lt.call(Je,", ")+" ]"}if(function ri(ge){return!("[object Error]"!==gi(ge)||xt&&"object"==typeof ge&&xt in ge)}(De)){var xe=rn(De,fe);return"cause"in De&&!Lt.call(De,"cause")?"{ ["+String(De)+"] "+lt.call(ft.call("[cause]: "+fe(De.cause),xe),", ")+" }":0===xe.length?"["+String(De)+"]":"{ ["+String(De)+"] "+lt.call(xe,", ")+" }"}if("object"==typeof De&&mn){if(Ae&&"function"==typeof De[Ae])return De[Ae]();if("symbol"!==mn&&"function"==typeof De.inspect)return De.inspect()}if(function ee(ge){if(!e||!ge||"object"!=typeof ge)return!1;try{e.call(ge);try{r.call(ge)}catch(De){return!0}return ge instanceof Map}catch(De){}return!1}(De)){var hi=[];return t.call(De,function(yr,xo){hi.push(fe(xo,De,!0)+" => "+fe(yr,De))}),vi("Map",e.call(De),hi,Gt)}if(function me(ge){if(!r||!ge||"object"!=typeof ge)return!1;try{r.call(ge);try{e.call(ge)}catch(De){return!0}return ge instanceof Set}catch(De){}return!1}(De)){var Oi=[];return a.call(De,function(yr){Oi.push(fe(yr,De))}),vi("Set",r.call(De),Oi,Gt)}if(function Oe(ge){if(!R||!ge||"object"!=typeof ge)return!1;try{R.call(ge,R);try{W.call(ge,W)}catch(De){return!0}return ge instanceof WeakMap}catch(De){}return!1}(De))return Ti("WeakMap");if(function ye(ge){if(!W||!ge||"object"!=typeof ge)return!1;try{W.call(ge,W);try{R.call(ge,R)}catch(De){return!0}return ge instanceof WeakSet}catch(De){}return!1}(De))return Ti("WeakSet");if(function le(ge){if(!et||!ge||"object"!=typeof ge)return!1;try{return et.call(ge),!0}catch(De){}return!1}(De))return Ti("WeakRef");if(function Ie(ge){return!("[object Number]"!==gi(ge)||xt&&"object"==typeof ge&&xt in ge)}(De))return $e(fe(Number(De)));if(function Dt(ge){if(!ge||"object"!=typeof ge||!yt)return!1;try{return yt.call(ge),!0}catch(De){}return!1}(De))return $e(fe(yt.call(De)));if(function Xt(ge){return!("[object Boolean]"!==gi(ge)||xt&&"object"==typeof ge&&xt in ge)}(De))return $e(Et.call(De));if(function Bt(ge){return!("[object String]"!==gi(ge)||xt&&"object"==typeof ge&&xt in ge)}(De))return $e(fe(String(De)));if(!function ei(ge){return!("[object Date]"!==gi(ge)||xt&&"object"==typeof ge&&xt in ge)}(De)&&!function Me(ge){return!("[object RegExp]"!==gi(ge)||xt&&"object"==typeof ge&&xt in ge)}(De)){var gn=rn(De,fe),kn=de?de(De)===Object.prototype:De instanceof Object||De.constructor===Object,so=De instanceof Object?"":"null prototype",Do=!kn&&xt&&Object(De)===De&&xt in De?Ut.call(gi(De),8,-1):so?"Object":"",qo=(kn||"function"!=typeof De.constructor?"":De.constructor.name?De.constructor.name+" ":"")+(Do||so?"["+lt.call(ft.call([],Do||[],so||[]),": ")+"] ":"");return 0===gn.length?qo+"{}":Gt?qo+"{"+Ri(gn,Gt)+"}":qo+"{ "+lt.call(gn,", ")+" }"}return String(De)};var ve=Object.prototype.hasOwnProperty||function(ge){return ge in this};function je(ge,De){return ve.call(ge,De)}function gi(ge){return It.call(ge)}function ne(ge,De){if(ge.indexOf)return ge.indexOf(De);for(var _i=0,yi=ge.length;_i<yi;_i++)if(ge[_i]===De)return _i;return-1}function Zt(ge,De){if(ge.length>De.maxStringLength){var _i=ge.length-De.maxStringLength,yi="... "+_i+" more character"+(_i>1?"s":"");return Zt(Ut.call(ge,0,De.maxStringLength),De)+yi}return Ne(Jt.call(Jt.call(ge,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,We),"single",De)}function We(ge){var De=ge.charCodeAt(0),_i={8:"b",9:"t",10:"n",12:"f",13:"r"}[De];return _i?"\\"+_i:"\\x"+(De<16?"0":"")+Ct.call(De.toString(16))}function $e(ge){return"Object("+ge+")"}function Ti(ge){return ge+" { ? }"}function vi(ge,De,_i,yi){return ge+" ("+De+") {"+(yi?Ri(_i,yi):lt.call(_i,", "))+"}"}function Ri(ge,De){if(0===ge.length)return"";var _i="\n"+De.prev+De.base;return _i+lt.call(ge,","+_i)+"\n"+De.prev}function rn(ge,De){var _i=Di(ge),yi=[];if(_i){yi.length=ge.length;for(var Fi=0;Fi<ge.length;Fi++)yi[Fi]=je(ge,Fi)?De(ge[Fi],ge):""}var mn,Ni="function"==typeof ct?ct(ge):[];if(se){mn={};for(var si=0;si<Ni.length;si++)mn["$"+Ni[si]]=Ni[si]}for(var Ce in ge)!je(ge,Ce)||_i&&String(Number(Ce))===Ce&&Ce<ge.length||se&&mn["$"+Ce]instanceof Symbol||(at.call(/[^\w$]/,Ce)?yi.push(De(Ce,ge)+": "+De(ge[Ce],ge)):yi.push(Ce+": "+De(ge[Ce],ge)));if("function"==typeof ct)for(var Vt=0;Vt<Ni.length;Vt++)Lt.call(ge,Ni[Vt])&&yi.push("["+De(Ni[Vt])+"]: "+De(ge[Ni[Vt]],ge));return yi}},66352:B=>{"use strict";function X(_,C){return Object.prototype.hasOwnProperty.call(_,C)}B.exports=function(_,C,m,e){m=m||"=";var t={};if("string"!=typeof _||0===_.length)return t;var n=/\+/g;_=_.split(C=C||"&");var o=1e3;e&&"number"==typeof e.maxKeys&&(o=e.maxKeys);var r=_.length;o>0&&r>o&&(r=o);for(var a=0;a<r;++a){var L,W,nt,et,h=_[a].replace(n,"%20"),R=h.indexOf(m);R>=0?(L=h.substr(0,R),W=h.substr(R+1)):(L=h,W=""),nt=decodeURIComponent(L),et=decodeURIComponent(W),X(t,nt)?Array.isArray(t[nt])?t[nt].push(et):t[nt]=[t[nt],et]:t[nt]=et}return t}},17519:B=>{"use strict";var X=function(_){switch(typeof _){case"string":return _;case"boolean":return _?"true":"false";case"number":return isFinite(_)?_:"";default:return""}};B.exports=function(_,C,m,e){return C=C||"&",m=m||"=",null===_&&(_=void 0),"object"==typeof _?Object.keys(_).map(function(t){var n=encodeURIComponent(X(t))+m;return Array.isArray(_[t])?_[t].map(function(o){return n+encodeURIComponent(X(o))}).join(C):n+encodeURIComponent(X(_[t]))}).join(C):e?encodeURIComponent(X(e))+m+encodeURIComponent(X(_)):""}},10569:(B,X,_)=>{"use strict";X.decode=X.parse=_(66352),X.encode=X.stringify=_(17519)},43510:B=>{var X=function(_){"use strict";var e,C=Object.prototype,m=C.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",o=t.asyncIterator||"@@asyncIterator",r=t.toStringTag||"@@toStringTag";function a(xt,Lt,de){return Object.defineProperty(xt,Lt,{value:de,enumerable:!0,configurable:!0,writable:!0}),xt[Lt]}try{a({},"")}catch(xt){a=function(Lt,de,_e){return Lt[de]=_e}}function h(xt,Lt,de,_e){var Ae=Object.create((Lt&&Lt.prototype instanceof It?Lt:It).prototype),Ne=new ct(_e||[]);return Ae._invoke=function lt(xt,Lt,de){var _e=L;return function(Ae,Ne){if(_e===nt)throw new Error("Generator is already running");if(_e===et){if("throw"===Ae)throw Ne;return se()}for(de.method=Ae,de.arg=Ne;;){var qe=de.delegate;if(qe){var Di=Ft(qe,de);if(Di){if(Di===Et)continue;return Di}}if("next"===de.method)de.sent=de._sent=de.arg;else if("throw"===de.method){if(_e===L)throw _e=et,de.arg;de.dispatchException(de.arg)}else"return"===de.method&&de.abrupt("return",de.arg);_e=nt;var ei=R(xt,Lt,de);if("normal"===ei.type){if(_e=de.done?et:W,ei.arg===Et)continue;return{value:ei.arg,done:de.done}}"throw"===ei.type&&(_e=et,de.method="throw",de.arg=ei.arg)}}}(xt,de,Ne),Ae}function R(xt,Lt,de){try{return{type:"normal",arg:xt.call(Lt,de)}}catch(_e){return{type:"throw",arg:_e}}}_.wrap=h;var L="suspendedStart",W="suspendedYield",nt="executing",et="completed",Et={};function It(){}function gt(){}function wt(){}var Ut={};a(Ut,n,function(){return this});var Jt=Object.getPrototypeOf,Ct=Jt&&Jt(Jt(rt([])));Ct&&Ct!==C&&m.call(Ct,n)&&(Ut=Ct);var bt=wt.prototype=It.prototype=Object.create(Ut);function at(xt){["next","throw","return"].forEach(function(Lt){a(xt,Lt,function(de){return this._invoke(Lt,de)})})}function ft(xt,Lt){function de(Ae,Ne,qe,Di){var ei=R(xt[Ae],xt,Ne);if("throw"!==ei.type){var Me=ei.arg,ri=Me.value;return ri&&"object"==typeof ri&&m.call(ri,"__await")?Lt.resolve(ri.__await).then(function(Bt){de("next",Bt,qe,Di)},function(Bt){de("throw",Bt,qe,Di)}):Lt.resolve(ri).then(function(Bt){Me.value=Bt,qe(Me)},function(Bt){return de("throw",Bt,qe,Di)})}Di(ei.arg)}var _e;this._invoke=function ce(Ae,Ne){function qe(){return new Lt(function(Di,ei){de(Ae,Ne,Di,ei)})}return _e=_e?_e.then(qe,qe):qe()}}function Ft(xt,Lt){var de=xt.iterator[Lt.method];if(de===e){if(Lt.delegate=null,"throw"===Lt.method){if(xt.iterator.return&&(Lt.method="return",Lt.arg=e,Ft(xt,Lt),"throw"===Lt.method))return Et;Lt.method="throw",Lt.arg=new TypeError("The iterator does not provide a 'throw' method")}return Et}var _e=R(de,xt.iterator,Lt.arg);if("throw"===_e.type)return Lt.method="throw",Lt.arg=_e.arg,Lt.delegate=null,Et;var ce=_e.arg;return ce?ce.done?(Lt[xt.resultName]=ce.value,Lt.next=xt.nextLoc,"return"!==Lt.method&&(Lt.method="next",Lt.arg=e),Lt.delegate=null,Et):ce:(Lt.method="throw",Lt.arg=new TypeError("iterator result is not an object"),Lt.delegate=null,Et)}function Mt(xt){var Lt={tryLoc:xt[0]};1 in xt&&(Lt.catchLoc=xt[1]),2 in xt&&(Lt.finallyLoc=xt[2],Lt.afterLoc=xt[3]),this.tryEntries.push(Lt)}function yt(xt){var Lt=xt.completion||{};Lt.type="normal",delete Lt.arg,xt.completion=Lt}function ct(xt){this.tryEntries=[{tryLoc:"root"}],xt.forEach(Mt,this),this.reset(!0)}function rt(xt){if(xt){var Lt=xt[n];if(Lt)return Lt.call(xt);if("function"==typeof xt.next)return xt;if(!isNaN(xt.length)){var de=-1,_e=function ce(){for(;++de<xt.length;)if(m.call(xt,de))return ce.value=xt[de],ce.done=!1,ce;return ce.value=e,ce.done=!0,ce};return _e.next=_e}}return{next:se}}function se(){return{value:e,done:!0}}return gt.prototype=wt,a(bt,"constructor",wt),a(wt,"constructor",gt),gt.displayName=a(wt,r,"GeneratorFunction"),_.isGeneratorFunction=function(xt){var Lt="function"==typeof xt&&xt.constructor;return!!Lt&&(Lt===gt||"GeneratorFunction"===(Lt.displayName||Lt.name))},_.mark=function(xt){return Object.setPrototypeOf?Object.setPrototypeOf(xt,wt):(xt.__proto__=wt,a(xt,r,"GeneratorFunction")),xt.prototype=Object.create(bt),xt},_.awrap=function(xt){return{__await:xt}},at(ft.prototype),a(ft.prototype,o,function(){return this}),_.AsyncIterator=ft,_.async=function(xt,Lt,de,_e,ce){void 0===ce&&(ce=Promise);var Ae=new ft(h(xt,Lt,de,_e),ce);return _.isGeneratorFunction(Lt)?Ae:Ae.next().then(function(Ne){return Ne.done?Ne.value:Ae.next()})},at(bt),a(bt,r,"Generator"),a(bt,n,function(){return this}),a(bt,"toString",function(){return"[object Generator]"}),_.keys=function(xt){var Lt=[];for(var de in xt)Lt.push(de);return Lt.reverse(),function _e(){for(;Lt.length;){var ce=Lt.pop();if(ce in xt)return _e.value=ce,_e.done=!1,_e}return _e.done=!0,_e}},_.values=rt,ct.prototype={constructor:ct,reset:function(xt){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(yt),!xt)for(var Lt in this)"t"===Lt.charAt(0)&&m.call(this,Lt)&&!isNaN(+Lt.slice(1))&&(this[Lt]=e)},stop:function(){this.done=!0;var Lt=this.tryEntries[0].completion;if("throw"===Lt.type)throw Lt.arg;return this.rval},dispatchException:function(xt){if(this.done)throw xt;var Lt=this;function de(Di,ei){return Ae.type="throw",Ae.arg=xt,Lt.next=Di,ei&&(Lt.method="next",Lt.arg=e),!!ei}for(var _e=this.tryEntries.length-1;_e>=0;--_e){var ce=this.tryEntries[_e],Ae=ce.completion;if("root"===ce.tryLoc)return de("end");if(ce.tryLoc<=this.prev){var Ne=m.call(ce,"catchLoc"),qe=m.call(ce,"finallyLoc");if(Ne&&qe){if(this.prev<ce.catchLoc)return de(ce.catchLoc,!0);if(this.prev<ce.finallyLoc)return de(ce.finallyLoc)}else if(Ne){if(this.prev<ce.catchLoc)return de(ce.catchLoc,!0)}else{if(!qe)throw new Error("try statement without catch or finally");if(this.prev<ce.finallyLoc)return de(ce.finallyLoc)}}}},abrupt:function(xt,Lt){for(var de=this.tryEntries.length-1;de>=0;--de){var _e=this.tryEntries[de];if(_e.tryLoc<=this.prev&&m.call(_e,"finallyLoc")&&this.prev<_e.finallyLoc){var ce=_e;break}}ce&&("break"===xt||"continue"===xt)&&ce.tryLoc<=Lt&&Lt<=ce.finallyLoc&&(ce=null);var Ae=ce?ce.completion:{};return Ae.type=xt,Ae.arg=Lt,ce?(this.method="next",this.next=ce.finallyLoc,Et):this.complete(Ae)},complete:function(xt,Lt){if("throw"===xt.type)throw xt.arg;return"break"===xt.type||"continue"===xt.type?this.next=xt.arg:"return"===xt.type?(this.rval=this.arg=xt.arg,this.method="return",this.next="end"):"normal"===xt.type&&Lt&&(this.next=Lt),Et},finish:function(xt){for(var Lt=this.tryEntries.length-1;Lt>=0;--Lt){var de=this.tryEntries[Lt];if(de.finallyLoc===xt)return this.complete(de.completion,de.afterLoc),yt(de),Et}},catch:function(xt){for(var Lt=this.tryEntries.length-1;Lt>=0;--Lt){var de=this.tryEntries[Lt];if(de.tryLoc===xt){var _e=de.completion;if("throw"===_e.type){var ce=_e.arg;yt(de)}return ce}}throw new Error("illegal catch attempt")},delegateYield:function(xt,Lt,de){return this.delegate={iterator:rt(xt),resultName:Lt,nextLoc:de},"next"===this.method&&(this.arg=e),Et}},_}(B.exports);try{regeneratorRuntime=X}catch(_){"object"==typeof globalThis?globalThis.regeneratorRuntime=X:Function("r","regeneratorRuntime = r")(X)}},83030:(B,X,_)=>{"use strict";var C=_(23141),m=_(72167),e=_(50847),t=C("%TypeError%"),n=C("%WeakMap%",!0),o=C("%Map%",!0),r=m("WeakMap.prototype.get",!0),a=m("WeakMap.prototype.set",!0),h=m("WeakMap.prototype.has",!0),R=m("Map.prototype.get",!0),L=m("Map.prototype.set",!0),W=m("Map.prototype.has",!0),nt=function(gt,wt){for(var Jt,Ut=gt;null!==(Jt=Ut.next);Ut=Jt)if(Jt.key===wt)return Ut.next=Jt.next,Jt.next=gt.next,gt.next=Jt,Jt};B.exports=function(){var wt,Ut,Jt,Ct={assert:function(bt){if(!Ct.has(bt))throw new t("Side channel does not contain "+e(bt))},get:function(bt){if(n&&bt&&("object"==typeof bt||"function"==typeof bt)){if(wt)return r(wt,bt)}else if(o){if(Ut)return R(Ut,bt)}else if(Jt)return function(gt,wt){var Ut=nt(gt,wt);return Ut&&Ut.value}(Jt,bt)},has:function(bt){if(n&&bt&&("object"==typeof bt||"function"==typeof bt)){if(wt)return h(wt,bt)}else if(o){if(Ut)return W(Ut,bt)}else if(Jt)return function(gt,wt){return!!nt(gt,wt)}(Jt,bt);return!1},set:function(bt,at){n&&bt&&("object"==typeof bt||"function"==typeof bt)?(wt||(wt=new n),a(wt,bt,at)):o?(Ut||(Ut=new o),L(Ut,bt,at)):(Jt||(Jt={key:{},next:null}),function(gt,wt,Ut){var Jt=nt(gt,wt);Jt?Jt.value=Ut:gt.next={key:wt,next:gt.next,value:Ut}}(Jt,bt,at))}};return Ct}},10695:(B,X,_)=>{"use strict";_.r(X),_.d(X,{default:()=>ls,helpers:()=>as});var C={};_.r(C),_.d(C,{JsonPatchError:()=>Mr,_areEquals:()=>Ol,applyOperation:()=>qa,applyPatch:()=>ta,applyReducer:()=>Wc,deepClone:()=>Iu,getValueByPointer:()=>Ml,validate:()=>Yr,validator:()=>ul});var m={};_.r(m),_.d(m,{compare:()=>zl,generate:()=>Rc,observe:()=>vl,unobserve:()=>Ra});var e={};_.r(e),_.d(e,{cookie:()=>$t,header:()=>Ht,path:()=>K,query:()=>ut});var t=_(90986),n=_(96915),o=_(40715),r=_(77901),a=_(88577),h=_(95942),R=_(46188),L=_(8797);function W(S,U,Y){return U in S?L(S,U,{value:Y,enumerable:!0,configurable:!0,writable:!0}):S[U]=Y,S}function nt(S,U){var Y=t(S);if(n){var it=n(S);U&&(it=o(it).call(it,function(pt){return r(S,pt).enumerable})),Y.push.apply(Y,it)}return Y}function et(S){for(var U=1;U<arguments.length;U++){var Y,it,pt=null!=arguments[U]?arguments[U]:{};U%2?a(Y=nt(Object(pt),!0)).call(Y,function(zt){W(S,zt,pt[zt])}):h?R(S,h(pt)):a(it=nt(Object(pt))).call(it,function(zt){L(S,zt,r(pt,zt))})}return S}var Et=_(12782),It=_.n(Et),gt=_(81836),wt=_.n(gt),Ut=_(20434),Jt=_(45698),Ct=_(92909),bt=_(10278),at=_(48735),ft=_(49067);function lt(S,U){(null==U||U>S.length)&&(U=S.length);for(var Y=0,it=new Array(U);Y<U;Y++)it[Y]=S[Y];return it}function Ft(S,U){var Y;if(S){if("string"==typeof S)return lt(S,U);var it=at(Y=Object.prototype.toString.call(S)).call(Y,8,-1);if("Object"===it&&S.constructor&&(it=S.constructor.name),"Map"===it||"Set"===it)return ft(S);if("Arguments"===it||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(it))return lt(S,U)}}function Mt(S,U){var Y=void 0!==Jt&&Ct(S)||S["@@iterator"];if(!Y){if(bt(S)||(Y=Ft(S))||U&&S&&"number"==typeof S.length){Y&&(S=Y);var it=0,pt=function(){};return{s:pt,n:function(){return it>=S.length?{done:!0}:{done:!1,value:S[it++]}},e:function(we){throw we},f:pt}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var oe,zt=!0,Yt=!1;return{s:function(){Y=Y.call(S)},n:function(){var we=Y.next();return zt=we.done,we},e:function(we){Yt=!0,oe=we},f:function(){try{!zt&&null!=Y.return&&Y.return()}finally{if(Yt)throw oe}}}}var yt=_(48972);function ct(S){return(ct="function"==typeof Jt&&"symbol"==typeof yt?function(U){return typeof U}:function(U){return U&&"function"==typeof Jt&&U.constructor===Jt&&U!==Jt.prototype?"symbol":typeof U})(S)}function Lt(S,U){return function rt(S){if(bt(S))return S}(S)||function se(S,U){var Y=null==S?null:void 0!==Jt&&Ct(S)||S["@@iterator"];if(null!=Y){var Yt,oe,it=[],pt=!0,zt=!1;try{for(Y=Y.call(S);!(pt=(Yt=Y.next()).done)&&(it.push(Yt.value),!U||it.length!==U);pt=!0);}catch(Se){zt=!0,oe=Se}finally{try{!pt&&null!=Y.return&&Y.return()}finally{if(zt)throw oe}}return it}}(S,U)||Ft(S,U)||function xt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var de=_(62917);function _e(S,U,Y,it,pt,zt,Yt){try{var oe=S[zt](Yt),Se=oe.value}catch(we){return void Y(we)}oe.done?U(Se):de.resolve(Se).then(it,pt)}function ce(S){return function(){var U=this,Y=arguments;return new de(function(it,pt){var zt=S.apply(U,Y);function Yt(Se){_e(zt,it,pt,Yt,oe,"next",Se)}function oe(Se){_e(zt,it,pt,Yt,oe,"throw",Se)}Yt(void 0)})}}var Ae=_(59680),Ne=_.n(Ae),qe=_(40750),Di=_.n(qe),ei=_(20036),Me=_.n(ei),ri=_(70433),Bt=_.n(ri),Ie=_(25710),Xt=_.n(Ie),he=_(55742),Dt=_.n(he),ve=_(32472),je=_.n(ve),gi=_(82476),Ee=_.n(gi),ne=_(27733),ee=_.n(ne),Oe=_(55672),le=_.n(Oe),ye=(_(76400),_(7029)),Kt=_.n(ye);function Zt(S){return null==S}var yi={isNothing:Zt,isObject:function We(S){return"object"==typeof S&&null!==S},toArray:function $e(S){return Array.isArray(S)?S:Zt(S)?[]:[S]},repeat:function vi(S,U){var it,Y="";for(it=0;it<U;it+=1)Y+=S;return Y},isNegativeZero:function di(S){return 0===S&&Number.NEGATIVE_INFINITY===1/S},extend:function Ti(S,U){var Y,it,pt,zt;if(U)for(Y=0,it=(zt=Object.keys(U)).length;Y<it;Y+=1)S[pt=zt[Y]]=U[pt];return S}};function Fi(S,U){var Y="",it=S.reason||"(unknown reason)";return S.mark?(S.mark.name&&(Y+='in "'+S.mark.name+'" '),Y+="("+(S.mark.line+1)+":"+(S.mark.column+1)+")",!U&&S.mark.snippet&&(Y+="\n\n"+S.mark.snippet),it+" "+Y):it}function Ni(S,U){Error.call(this),this.name="YAMLException",this.reason=S,this.mark=U,this.message=Fi(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(Ni.prototype=Object.create(Error.prototype)).constructor=Ni,Ni.prototype.toString=function(U){return this.name+": "+Fi(this,U)};var mn=Ni;function si(S,U,Y,it,pt){var zt="",Yt="",oe=Math.floor(pt/2)-1;return it-U>oe&&(U=it-oe+(zt=" ... ").length),Y-it>oe&&(Y=it+oe-(Yt=" ...").length),{str:zt+S.slice(U,Y).replace(/\t/g,"\u2192")+Yt,pos:it-U+zt.length}}function Ce(S,U){return yi.repeat(" ",U-S.length)+S}var Gt=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],fe=["scalar","sequence","mapping"],tn=function $i(S,U){if(U=U||{},Object.keys(U).forEach(function(Y){if(-1===Gt.indexOf(Y))throw new mn('Unknown option "'+Y+'" is met in definition of "'+S+'" YAML type.')}),this.options=U,this.tag=S,this.kind=U.kind||null,this.resolve=U.resolve||function(){return!0},this.construct=U.construct||function(Y){return Y},this.instanceOf=U.instanceOf||null,this.predicate=U.predicate||null,this.represent=U.represent||null,this.representName=U.representName||null,this.defaultStyle=U.defaultStyle||null,this.multi=U.multi||!1,this.styleAliases=function He(S){var U={};return null!==S&&Object.keys(S).forEach(function(Y){S[Y].forEach(function(it){U[String(it)]=Y})}),U}(U.styleAliases||null),-1===fe.indexOf(this.kind))throw new mn('Unknown kind "'+this.kind+'" is specified for "'+S+'" YAML type.')};function In(S,U){var Y=[];return S[U].forEach(function(it){var pt=Y.length;Y.forEach(function(zt,Yt){zt.tag===it.tag&&zt.kind===it.kind&&zt.multi===it.multi&&(pt=Yt)}),Y[pt]=it}),Y}function li(S){return this.extend(S)}li.prototype.extend=function(U){var Y=[],it=[];if(U instanceof tn)it.push(U);else if(Array.isArray(U))it=it.concat(U);else{if(!U||!Array.isArray(U.implicit)&&!Array.isArray(U.explicit))throw new mn("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");U.implicit&&(Y=Y.concat(U.implicit)),U.explicit&&(it=it.concat(U.explicit))}Y.forEach(function(zt){if(!(zt instanceof tn))throw new mn("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(zt.loadKind&&"scalar"!==zt.loadKind)throw new mn("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(zt.multi)throw new mn("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),it.forEach(function(zt){if(!(zt instanceof tn))throw new mn("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var pt=Object.create(li.prototype);return pt.implicit=(this.implicit||[]).concat(Y),pt.explicit=(this.explicit||[]).concat(it),pt.compiledImplicit=In(pt,"implicit"),pt.compiledExplicit=In(pt,"explicit"),pt.compiledTypeMap=function no(){var U,Y,S={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function it(pt){pt.multi?(S.multi[pt.kind].push(pt),S.multi.fallback.push(pt)):S[pt.kind][pt.tag]=S.fallback[pt.tag]=pt}for(U=0,Y=arguments.length;U<Y;U+=1)arguments[U].forEach(it);return S}(pt.compiledImplicit,pt.compiledExplicit),pt};var Je=li,xe=new tn("tag:yaml.org,2002:str",{kind:"scalar",construct:function(S){return null!==S?S:""}}),hi=new tn("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(S){return null!==S?S:[]}}),Oi=new tn("tag:yaml.org,2002:map",{kind:"mapping",construct:function(S){return null!==S?S:{}}}),gn=new Je({explicit:[xe,hi,Oi]}),Zo=new tn("tag:yaml.org,2002:null",{kind:"scalar",resolve:function kn(S){if(null===S)return!0;var U=S.length;return 1===U&&"~"===S||4===U&&("null"===S||"Null"===S||"NULL"===S)},construct:function so(){return null},predicate:function Do(S){return null===S},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),vo=new tn("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function qo(S){if(null===S)return!1;var U=S.length;return 4===U&&("true"===S||"True"===S||"TRUE"===S)||5===U&&("false"===S||"False"===S||"FALSE"===S)},construct:function yr(S){return"true"===S||"True"===S||"TRUE"===S},predicate:function xo(S){return"[object Boolean]"===Object.prototype.toString.call(S)},represent:{lowercase:function(S){return S?"true":"false"},uppercase:function(S){return S?"TRUE":"FALSE"},camelcase:function(S){return S?"True":"False"}},defaultStyle:"lowercase"});function Fr(S){return 48<=S&&S<=57||65<=S&&S<=70||97<=S&&S<=102}function co(S){return 48<=S&&S<=55}function Ii(S){return 48<=S&&S<=57}var yo=new tn("tag:yaml.org,2002:int",{kind:"scalar",resolve:function Gn(S){if(null===S)return!1;var pt,U=S.length,Y=0,it=!1;if(!U)return!1;if(("-"===(pt=S[Y])||"+"===pt)&&(pt=S[++Y]),"0"===pt){if(Y+1===U)return!0;if("b"===(pt=S[++Y])){for(Y++;Y<U;Y++)if("_"!==(pt=S[Y])){if("0"!==pt&&"1"!==pt)return!1;it=!0}return it&&"_"!==pt}if("x"===pt){for(Y++;Y<U;Y++)if("_"!==(pt=S[Y])){if(!Fr(S.charCodeAt(Y)))return!1;it=!0}return it&&"_"!==pt}if("o"===pt){for(Y++;Y<U;Y++)if("_"!==(pt=S[Y])){if(!co(S.charCodeAt(Y)))return!1;it=!0}return it&&"_"!==pt}}if("_"===pt)return!1;for(;Y<U;Y++)if("_"!==(pt=S[Y])){if(!Ii(S.charCodeAt(Y)))return!1;it=!0}return!(!it||"_"===pt)},construct:function To(S){var it,U=S,Y=1;if(-1!==U.indexOf("_")&&(U=U.replace(/_/g,"")),("-"===(it=U[0])||"+"===it)&&("-"===it&&(Y=-1),it=(U=U.slice(1))[0]),"0"===U)return 0;if("0"===it){if("b"===U[1])return Y*parseInt(U.slice(2),2);if("x"===U[1])return Y*parseInt(U.slice(2),16);if("o"===U[1])return Y*parseInt(U.slice(2),8)}return Y*parseInt(U,10)},predicate:function Uo(S){return"[object Number]"===Object.prototype.toString.call(S)&&S%1==0&&!yi.isNegativeZero(S)},represent:{binary:function(S){return S>=0?"0b"+S.toString(2):"-0b"+S.toString(2).slice(1)},octal:function(S){return S>=0?"0o"+S.toString(8):"-0o"+S.toString(8).slice(1)},decimal:function(S){return S.toString(10)},hexadecimal:function(S){return S>=0?"0x"+S.toString(16).toUpperCase():"-0x"+S.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Mo=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),Bi=/^[-+]?[0-9]+e/,ae=new tn("tag:yaml.org,2002:float",{kind:"scalar",resolve:function Qo(S){return!(null===S||!Mo.test(S)||"_"===S[S.length-1])},construct:function Oo(S){var U,Y;return Y="-"===(U=S.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(U[0])>=0&&(U=U.slice(1)),".inf"===U?1===Y?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===U?NaN:Y*parseFloat(U,10)},predicate:function Wn(S){return"[object Number]"===Object.prototype.toString.call(S)&&(S%1!=0||yi.isNegativeZero(S))},represent:function On(S,U){var Y;if(isNaN(S))switch(U){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===S)switch(U){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===S)switch(U){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(yi.isNegativeZero(S))return"-0.0";return Y=S.toString(10),Bi.test(Y)?Y.replace("e",".e"):Y},defaultStyle:"lowercase"}),Fe=gn.extend({implicit:[Zo,vo,yo,ae]}),Mi=Fe,Yi=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Ki=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),Rn=new tn("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function qn(S){return null!==S&&(null!==Yi.exec(S)||null!==Ki.exec(S))},construct:function ao(S){var U,Y,it,pt,zt,Yt,oe,fi,Se=0,we=null;if(null===(U=Yi.exec(S))&&(U=Ki.exec(S)),null===U)throw new Error("Date resolve error");if(Y=+U[1],it=+U[2]-1,pt=+U[3],!U[4])return new Date(Date.UTC(Y,it,pt));if(zt=+U[4],Yt=+U[5],oe=+U[6],U[7]){for(Se=U[7].slice(0,3);Se.length<3;)Se+="0";Se=+Se}return U[9]&&(we=6e4*(60*+U[10]+ +(U[11]||0)),"-"===U[9]&&(we=-we)),fi=new Date(Date.UTC(Y,it,pt,zt,Yt,oe,Se)),we&&fi.setTime(fi.getTime()-we),fi},instanceOf:Date,represent:function lo(S){return S.toISOString()}}),_r=new tn("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function Kr(S){return"<<"===S||null===S}}),rr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",sr=new tn("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function Or(S){if(null===S)return!1;var U,Y,it=0,pt=S.length,zt=rr;for(Y=0;Y<pt;Y++)if(!((U=zt.indexOf(S.charAt(Y)))>64)){if(U<0)return!1;it+=6}return it%8==0},construct:function uo(S){var U,Y,it=S.replace(/[\r\n=]/g,""),pt=it.length,zt=rr,Yt=0,oe=[];for(U=0;U<pt;U++)U%4==0&&U&&(oe.push(Yt>>16&255),oe.push(Yt>>8&255),oe.push(255&Yt)),Yt=Yt<<6|zt.indexOf(it.charAt(U));return 0==(Y=pt%4*6)?(oe.push(Yt>>16&255),oe.push(Yt>>8&255),oe.push(255&Yt)):18===Y?(oe.push(Yt>>10&255),oe.push(Yt>>2&255)):12===Y&&oe.push(Yt>>4&255),new Uint8Array(oe)},predicate:function Wr(S){return"[object Uint8Array]"===Object.prototype.toString.call(S)},represent:function Os(S){var it,pt,U="",Y=0,zt=S.length,Yt=rr;for(it=0;it<zt;it++)it%3==0&&it&&(U+=Yt[Y>>18&63],U+=Yt[Y>>12&63],U+=Yt[Y>>6&63],U+=Yt[63&Y]),Y=(Y<<8)+S[it];return 0==(pt=zt%3)?(U+=Yt[Y>>18&63],U+=Yt[Y>>12&63],U+=Yt[Y>>6&63],U+=Yt[63&Y]):2===pt?(U+=Yt[Y>>10&63],U+=Yt[Y>>4&63],U+=Yt[Y<<2&63],U+=Yt[64]):1===pt&&(U+=Yt[Y>>2&63],U+=Yt[Y<<4&63],U+=Yt[64],U+=Yt[64]),U}}),wr=Object.prototype.hasOwnProperty,Ua=Object.prototype.toString,ya=new tn("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function Cr(S){if(null===S)return!0;var Y,it,pt,zt,Yt,U=[],oe=S;for(Y=0,it=oe.length;Y<it;Y+=1){if(Yt=!1,"[object Object]"!==Ua.call(pt=oe[Y]))return!1;for(zt in pt)if(wr.call(pt,zt)){if(Yt)return!1;Yt=!0}if(!Yt)return!1;if(-1!==U.indexOf(zt))return!1;U.push(zt)}return!0},construct:function us(S){return null!==S?S:[]}}),Vo=Object.prototype.toString,js=new tn("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function Ma(S){if(null===S)return!0;var U,Y,it,pt,zt,Yt=S;for(zt=new Array(Yt.length),U=0,Y=Yt.length;U<Y;U+=1){if("[object Object]"!==Vo.call(it=Yt[U])||1!==(pt=Object.keys(it)).length)return!1;zt[U]=[pt[0],it[pt[0]]]}return!0},construct:function dl(S){if(null===S)return[];var U,Y,it,pt,zt,Yt=S;for(zt=new Array(Yt.length),U=0,Y=Yt.length;U<Y;U+=1)it=Yt[U],pt=Object.keys(it),zt[U]=[pt[0],it[pt[0]]];return zt}}),ia=Object.prototype.hasOwnProperty,Ys=new tn("tag:yaml.org,2002:set",{kind:"mapping",resolve:function nl(S){if(null===S)return!0;var U,Y=S;for(U in Y)if(ia.call(Y,U)&&null!==Y[U])return!1;return!0},construct:function Va(S){return null!==S?S:{}}}),ol=Mi.extend({implicit:[Rn,_r],explicit:[sr,ya,js,Ys]}),Xs=Object.prototype.hasOwnProperty,Ar=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,zr=/[\x85\u2028\u2029]/,oa=/[,\[\]\{\}]/,Br=/^(?:!|!!|![a-z\-]+!)$/i,pa=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function kr(S){return Object.prototype.toString.call(S)}function tr(S){return 10===S||13===S}function Es(S){return 9===S||32===S}function ar(S){return 9===S||32===S||10===S||13===S}function As(S){return 44===S||91===S||93===S||123===S||125===S}function Lo(S){var U;return 48<=S&&S<=57?S-48:97<=(U=32|S)&&U<=102?U-97+10:-1}function Cs(S){return 120===S?2:117===S?4:85===S?8:0}function hr(S){return 48<=S&&S<=57?S-48:-1}function Oa(S){return 48===S?"\0":97===S?"\x07":98===S?"\b":116===S||9===S?"\t":110===S?"\n":118===S?"\v":102===S?"\f":114===S?"\r":101===S?"\x1b":32===S?" ":34===S?'"':47===S?"/":92===S?"\\":78===S?"\x85":95===S?"\xa0":76===S?"\u2028":80===S?"\u2029":""}function Wa(S){return S<=65535?String.fromCharCode(S):String.fromCharCode(55296+(S-65536>>10),56320+(S-65536&1023))}for(var hs=new Array(256),Jr=new Array(256),ks=0;ks<256;ks++)hs[ks]=Oa(ks)?1:0,Jr[ks]=Oa(ks);function pl(S,U){this.input=S,this.filename=U.filename||null,this.schema=U.schema||ol,this.onWarning=U.onWarning||null,this.legacy=U.legacy||!1,this.json=U.json||!1,this.listener=U.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=S.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function No(S,U){var Y={name:S.filename,buffer:S.input.slice(0,-1),position:S.position,line:S.line,column:S.position-S.lineStart};return Y.snippet=function Vt(S,U){if(U=Object.create(U||null),!S.buffer)return null;U.maxLength||(U.maxLength=79),"number"!=typeof U.indent&&(U.indent=1),"number"!=typeof U.linesBefore&&(U.linesBefore=3),"number"!=typeof U.linesAfter&&(U.linesAfter=2);for(var zt,Y=/\r?\n|\r|\0/g,it=[0],pt=[],Yt=-1;zt=Y.exec(S.buffer);)pt.push(zt.index),it.push(zt.index+zt[0].length),S.position<=zt.index&&Yt<0&&(Yt=it.length-2);Yt<0&&(Yt=it.length-1);var Se,we,oe="",ii=Math.min(S.line+U.linesAfter,pt.length).toString().length,oi=U.maxLength-(U.indent+ii+3);for(Se=1;Se<=U.linesBefore&&!(Yt-Se<0);Se++)we=si(S.buffer,it[Yt-Se],pt[Yt-Se],S.position-(it[Yt]-it[Yt-Se]),oi),oe=yi.repeat(" ",U.indent)+Ce((S.line-Se+1).toString(),ii)+" | "+we.str+"\n"+oe;for(we=si(S.buffer,it[Yt],pt[Yt],S.position,oi),oe+=yi.repeat(" ",U.indent)+Ce((S.line+1).toString(),ii)+" | "+we.str+"\n",oe+=yi.repeat("-",U.indent+ii+3+we.pos)+"^\n",Se=1;Se<=U.linesAfter&&!(Yt+Se>=pt.length);Se++)we=si(S.buffer,it[Yt+Se],pt[Yt+Se],S.position-(it[Yt]-it[Yt+Se]),oi),oe+=yi.repeat(" ",U.indent)+Ce((S.line+Se+1).toString(),ii)+" | "+we.str+"\n";return oe.replace(/\n$/,"")}(Y),new mn(U,Y)}function Pn(S,U){throw No(S,U)}function fa(S,U){S.onWarning&&S.onWarning.call(null,No(S,U))}var kt={YAML:function(U,Y,it){var pt,zt,Yt;null!==U.version&&Pn(U,"duplication of %YAML directive"),1!==it.length&&Pn(U,"YAML directive accepts exactly one argument"),null===(pt=/^([0-9]+)\.([0-9]+)$/.exec(it[0]))&&Pn(U,"ill-formed argument of the YAML directive"),zt=parseInt(pt[1],10),Yt=parseInt(pt[2],10),1!==zt&&Pn(U,"unacceptable YAML version of the document"),U.version=it[0],U.checkLineBreaks=Yt<2,1!==Yt&&2!==Yt&&fa(U,"unsupported YAML version of the document")},TAG:function(U,Y,it){var pt,zt;2!==it.length&&Pn(U,"TAG directive accepts exactly two arguments"),zt=it[1],Br.test(pt=it[0])||Pn(U,"ill-formed tag handle (first argument) of the TAG directive"),Xs.call(U.tagMap,pt)&&Pn(U,'there is a previously declared suffix for "'+pt+'" tag handle'),pa.test(zt)||Pn(U,"ill-formed tag prefix (second argument) of the TAG directive");try{zt=decodeURIComponent(zt)}catch(Yt){Pn(U,"tag prefix is malformed: "+zt)}U.tagMap[pt]=zt}};function Q(S,U,Y,it){var pt,zt,Yt,oe;if(U<Y){if(oe=S.input.slice(U,Y),it)for(pt=0,zt=oe.length;pt<zt;pt+=1)9===(Yt=oe.charCodeAt(pt))||32<=Yt&&Yt<=1114111||Pn(S,"expected valid JSON character");else Ar.test(oe)&&Pn(S,"the stream contains non-printable characters");S.result+=oe}}function V(S,U,Y,it){var pt,zt,Yt,oe;for(yi.isObject(Y)||Pn(S,"cannot merge mappings; the provided source object is unacceptable"),Yt=0,oe=(pt=Object.keys(Y)).length;Yt<oe;Yt+=1)Xs.call(U,zt=pt[Yt])||(U[zt]=Y[zt],it[zt]=!0)}function j(S,U,Y,it,pt,zt,Yt,oe,Se){var we,ii;if(Array.isArray(pt))for(we=0,ii=(pt=Array.prototype.slice.call(pt)).length;we<ii;we+=1)Array.isArray(pt[we])&&Pn(S,"nested arrays are not supported inside keys"),"object"==typeof pt&&"[object Object]"===kr(pt[we])&&(pt[we]="[object Object]");if("object"==typeof pt&&"[object Object]"===kr(pt)&&(pt="[object Object]"),pt=String(pt),null===U&&(U={}),"tag:yaml.org,2002:merge"===it)if(Array.isArray(zt))for(we=0,ii=zt.length;we<ii;we+=1)V(S,U,zt[we],Y);else V(S,U,zt,Y);else!S.json&&!Xs.call(Y,pt)&&Xs.call(U,pt)&&(S.line=Yt||S.line,S.lineStart=oe||S.lineStart,S.position=Se||S.position,Pn(S,"duplicated mapping key")),"__proto__"===pt?Object.defineProperty(U,pt,{configurable:!0,enumerable:!0,writable:!0,value:zt}):U[pt]=zt,delete Y[pt];return U}function Ot(S){var U;10===(U=S.input.charCodeAt(S.position))?S.position++:13===U?(S.position++,10===S.input.charCodeAt(S.position)&&S.position++):Pn(S,"a line break is expected"),S.line+=1,S.lineStart=S.position,S.firstTabInLine=-1}function Be(S,U,Y){for(var it=0,pt=S.input.charCodeAt(S.position);0!==pt;){for(;Es(pt);)9===pt&&-1===S.firstTabInLine&&(S.firstTabInLine=S.position),pt=S.input.charCodeAt(++S.position);if(U&&35===pt)do{pt=S.input.charCodeAt(++S.position)}while(10!==pt&&13!==pt&&0!==pt);if(!tr(pt))break;for(Ot(S),pt=S.input.charCodeAt(S.position),it++,S.lineIndent=0;32===pt;)S.lineIndent++,pt=S.input.charCodeAt(++S.position)}return-1!==Y&&0!==it&&S.lineIndent<Y&&fa(S,"deficient indentation"),it}function bi(S){var Y,U=S.position;return!(45!==(Y=S.input.charCodeAt(U))&&46!==Y||Y!==S.input.charCodeAt(U+1)||Y!==S.input.charCodeAt(U+2)||(U+=3,Y=S.input.charCodeAt(U),0!==Y&&!ar(Y)))}function un(S,U){1===U?S.result+=" ":U>1&&(S.result+=yi.repeat("\n",U-1))}function fo(S,U){var Y,Se,it=S.tag,pt=S.anchor,zt=[],oe=!1;if(-1!==S.firstTabInLine)return!1;for(null!==S.anchor&&(S.anchorMap[S.anchor]=zt),Se=S.input.charCodeAt(S.position);0!==Se&&(-1!==S.firstTabInLine&&(S.position=S.firstTabInLine,Pn(S,"tab characters must not be used in indentation")),45===Se&&ar(S.input.charCodeAt(S.position+1)));)if(oe=!0,S.position++,Be(S,!0,-1)&&S.lineIndent<=U)zt.push(null),Se=S.input.charCodeAt(S.position);else if(Y=S.line,$r(S,U,3,!1,!0),zt.push(S.result),Be(S,!0,-1),Se=S.input.charCodeAt(S.position),(S.line===Y||S.lineIndent>U)&&0!==Se)Pn(S,"bad indentation of a sequence entry");else if(S.lineIndent<U)break;return!!oe&&(S.tag=it,S.anchor=pt,S.kind="sequence",S.result=zt,!0)}function Jn(S){var U,pt,zt,Yt,Y=!1,it=!1;if(33!==(Yt=S.input.charCodeAt(S.position)))return!1;if(null!==S.tag&&Pn(S,"duplication of a tag property"),60===(Yt=S.input.charCodeAt(++S.position))?(Y=!0,Yt=S.input.charCodeAt(++S.position)):33===Yt?(it=!0,pt="!!",Yt=S.input.charCodeAt(++S.position)):pt="!",U=S.position,Y){do{Yt=S.input.charCodeAt(++S.position)}while(0!==Yt&&62!==Yt);S.position<S.length?(zt=S.input.slice(U,S.position),Yt=S.input.charCodeAt(++S.position)):Pn(S,"unexpected end of the stream within a verbatim tag")}else{for(;0!==Yt&&!ar(Yt);)33===Yt&&(it?Pn(S,"tag suffix cannot contain exclamation marks"):(pt=S.input.slice(U-1,S.position+1),Br.test(pt)||Pn(S,"named tag handle cannot contain such characters"),it=!0,U=S.position+1)),Yt=S.input.charCodeAt(++S.position);zt=S.input.slice(U,S.position),oa.test(zt)&&Pn(S,"tag suffix cannot contain flow indicator characters")}zt&&!pa.test(zt)&&Pn(S,"tag name cannot contain such characters: "+zt);try{zt=decodeURIComponent(zt)}catch(oe){Pn(S,"tag name is malformed: "+zt)}return Y?S.tag=zt:Xs.call(S.tagMap,pt)?S.tag=S.tagMap[pt]+zt:"!"===pt?S.tag="!"+zt:"!!"===pt?S.tag="tag:yaml.org,2002:"+zt:Pn(S,'undeclared tag handle "'+pt+'"'),!0}function Ks(S){var U,Y;if(38!==(Y=S.input.charCodeAt(S.position)))return!1;for(null!==S.anchor&&Pn(S,"duplication of an anchor property"),Y=S.input.charCodeAt(++S.position),U=S.position;0!==Y&&!ar(Y)&&!As(Y);)Y=S.input.charCodeAt(++S.position);return S.position===U&&Pn(S,"name of an anchor node must contain at least one character"),S.anchor=S.input.slice(U,S.position),!0}function $r(S,U,Y,it,pt){var zt,Yt,oe,oi,fi,Si,zi,sn,cn,Se=1,we=!1,ii=!1;if(null!==S.listener&&S.listener("open",S),S.tag=null,S.anchor=null,S.kind=null,S.result=null,zt=Yt=oe=4===Y||3===Y,it&&Be(S,!0,-1)&&(we=!0,S.lineIndent>U?Se=1:S.lineIndent===U?Se=0:S.lineIndent<U&&(Se=-1)),1===Se)for(;Jn(S)||Ks(S);)Be(S,!0,-1)?(we=!0,oe=zt,S.lineIndent>U?Se=1:S.lineIndent===U?Se=0:S.lineIndent<U&&(Se=-1)):oe=!1;if(oe&&(oe=we||pt),(1===Se||4===Y)&&(sn=1===Y||2===Y?U:U+1,cn=S.position-S.lineStart,1===Se?oe&&(fo(S,cn)||function xr(S,U,Y){var it,pt,zt,Yt,oe,Se,en,we=S.tag,ii=S.anchor,oi={},fi=Object.create(null),Si=null,zi=null,sn=null,cn=!1,xn=!1;if(-1!==S.firstTabInLine)return!1;for(null!==S.anchor&&(S.anchorMap[S.anchor]=oi),en=S.input.charCodeAt(S.position);0!==en;){if(!cn&&-1!==S.firstTabInLine&&(S.position=S.firstTabInLine,Pn(S,"tab characters must not be used in indentation")),it=S.input.charCodeAt(S.position+1),zt=S.line,63!==en&&58!==en||!ar(it)){if(Yt=S.line,oe=S.lineStart,Se=S.position,!$r(S,Y,2,!1,!0))break;if(S.line===zt){for(en=S.input.charCodeAt(S.position);Es(en);)en=S.input.charCodeAt(++S.position);if(58===en)ar(en=S.input.charCodeAt(++S.position))||Pn(S,"a whitespace character is expected after the key-value separator within a block mapping"),cn&&(j(S,oi,fi,Si,zi,null,Yt,oe,Se),Si=zi=sn=null),xn=!0,cn=!1,pt=!1,Si=S.tag,zi=S.result;else{if(!xn)return S.tag=we,S.anchor=ii,!0;Pn(S,"can not read an implicit mapping pair; a colon is missed")}}else{if(!xn)return S.tag=we,S.anchor=ii,!0;Pn(S,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===en?(cn&&(j(S,oi,fi,Si,zi,null,Yt,oe,Se),Si=zi=sn=null),xn=!0,cn=!0,pt=!0):cn?(cn=!1,pt=!0):Pn(S,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),S.position+=1,en=it;if((S.line===zt||S.lineIndent>U)&&(cn&&(Yt=S.line,oe=S.lineStart,Se=S.position),$r(S,U,4,!0,pt)&&(cn?zi=S.result:sn=S.result),cn||(j(S,oi,fi,Si,zi,sn,Yt,oe,Se),Si=zi=sn=null),Be(S,!0,-1),en=S.input.charCodeAt(S.position)),(S.line===zt||S.lineIndent>U)&&0!==en)Pn(S,"bad indentation of a mapping entry");else if(S.lineIndent<U)break}return cn&&j(S,oi,fi,Si,zi,null,Yt,oe,Se),xn&&(S.tag=we,S.anchor=ii,S.kind="mapping",S.result=oi),xn}(S,cn,sn))||function Fo(S,U){var it,pt,zt,oe,ii,oi,fi,Si,sn,cn,xn,en,Y=!0,Yt=S.tag,Se=S.anchor,zi=Object.create(null);if(91===(en=S.input.charCodeAt(S.position)))ii=93,Si=!1,oe=[];else{if(123!==en)return!1;ii=125,Si=!0,oe={}}for(null!==S.anchor&&(S.anchorMap[S.anchor]=oe),en=S.input.charCodeAt(++S.position);0!==en;){if(Be(S,!0,U),(en=S.input.charCodeAt(S.position))===ii)return S.position++,S.tag=Yt,S.anchor=Se,S.kind=Si?"mapping":"sequence",S.result=oe,!0;Y?44===en&&Pn(S,"expected the node content, but found ','"):Pn(S,"missed comma between flow collection entries"),xn=null,oi=fi=!1,63===en&&ar(S.input.charCodeAt(S.position+1))&&(oi=fi=!0,S.position++,Be(S,!0,U)),it=S.line,pt=S.lineStart,zt=S.position,$r(S,U,1,!1,!0),cn=S.tag,sn=S.result,Be(S,!0,U),en=S.input.charCodeAt(S.position),(fi||S.line===it)&&58===en&&(oi=!0,en=S.input.charCodeAt(++S.position),Be(S,!0,U),$r(S,U,1,!1,!0),xn=S.result),Si?j(S,oe,zi,cn,sn,xn,it,pt,zt):oe.push(oi?j(S,null,zi,cn,sn,xn,it,pt,zt):sn),Be(S,!0,U),44===(en=S.input.charCodeAt(S.position))?(Y=!0,en=S.input.charCodeAt(++S.position)):Y=!1}Pn(S,"unexpected end of the stream within a flow collection")}(S,sn)?ii=!0:(Yt&&function er(S,U){var Y,it,ii,oi,pt=1,zt=!1,Yt=!1,oe=U,Se=0,we=!1;if(124===(oi=S.input.charCodeAt(S.position)))it=!1;else{if(62!==oi)return!1;it=!0}for(S.kind="scalar",S.result="";0!==oi;)if(43===(oi=S.input.charCodeAt(++S.position))||45===oi)1===pt?pt=43===oi?3:2:Pn(S,"repeat of a chomping mode identifier");else{if(!((ii=hr(oi))>=0))break;0===ii?Pn(S,"bad explicit indentation width of a block scalar; it cannot be less than one"):Yt?Pn(S,"repeat of an indentation width identifier"):(oe=U+ii-1,Yt=!0)}if(Es(oi)){do{oi=S.input.charCodeAt(++S.position)}while(Es(oi));if(35===oi)do{oi=S.input.charCodeAt(++S.position)}while(!tr(oi)&&0!==oi)}for(;0!==oi;){for(Ot(S),S.lineIndent=0,oi=S.input.charCodeAt(S.position);(!Yt||S.lineIndent<oe)&&32===oi;)S.lineIndent++,oi=S.input.charCodeAt(++S.position);if(!Yt&&S.lineIndent>oe&&(oe=S.lineIndent),tr(oi))Se++;else{if(S.lineIndent<oe){3===pt?S.result+=yi.repeat("\n",zt?1+Se:Se):1===pt&&zt&&(S.result+="\n");break}for(it?Es(oi)?(we=!0,S.result+=yi.repeat("\n",zt?1+Se:Se)):we?(we=!1,S.result+=yi.repeat("\n",Se+1)):0===Se?zt&&(S.result+=" "):S.result+=yi.repeat("\n",Se):S.result+=yi.repeat("\n",zt?1+Se:Se),zt=!0,Yt=!0,Se=0,Y=S.position;!tr(oi)&&0!==oi;)oi=S.input.charCodeAt(++S.position);Q(S,Y,S.position,!1)}}return!0}(S,sn)||function Po(S,U){var Y,it,pt;if(39!==(Y=S.input.charCodeAt(S.position)))return!1;for(S.kind="scalar",S.result="",S.position++,it=pt=S.position;0!==(Y=S.input.charCodeAt(S.position));)if(39===Y){if(Q(S,it,S.position,!0),39!==(Y=S.input.charCodeAt(++S.position)))return!0;it=S.position,S.position++,pt=S.position}else tr(Y)?(Q(S,it,pt,!0),un(S,Be(S,!1,U)),it=pt=S.position):S.position===S.lineStart&&bi(S)?Pn(S,"unexpected end of the document within a single quoted scalar"):(S.position++,pt=S.position);Pn(S,"unexpected end of the stream within a single quoted scalar")}(S,sn)||function Yo(S,U){var Y,it,pt,zt,Yt,oe;if(34!==(oe=S.input.charCodeAt(S.position)))return!1;for(S.kind="scalar",S.result="",S.position++,Y=it=S.position;0!==(oe=S.input.charCodeAt(S.position));){if(34===oe)return Q(S,Y,S.position,!0),S.position++,!0;if(92===oe){if(Q(S,Y,S.position,!0),tr(oe=S.input.charCodeAt(++S.position)))Be(S,!1,U);else if(oe<256&&hs[oe])S.result+=Jr[oe],S.position++;else if((Yt=Cs(oe))>0){for(pt=Yt,zt=0;pt>0;pt--)(Yt=Lo(oe=S.input.charCodeAt(++S.position)))>=0?zt=(zt<<4)+Yt:Pn(S,"expected hexadecimal character");S.result+=Wa(zt),S.position++}else Pn(S,"unknown escape sequence");Y=it=S.position}else tr(oe)?(Q(S,Y,it,!0),un(S,Be(S,!1,U)),Y=it=S.position):S.position===S.lineStart&&bi(S)?Pn(S,"unexpected end of the document within a double quoted scalar"):(S.position++,it=S.position)}Pn(S,"unexpected end of the stream within a double quoted scalar")}(S,sn)?ii=!0:function sl(S){var U,Y,it;if(42!==(it=S.input.charCodeAt(S.position)))return!1;for(it=S.input.charCodeAt(++S.position),U=S.position;0!==it&&!ar(it)&&!As(it);)it=S.input.charCodeAt(++S.position);return S.position===U&&Pn(S,"name of an alias node must contain at least one character"),Y=S.input.slice(U,S.position),Xs.call(S.anchorMap,Y)||Pn(S,'unidentified alias "'+Y+'"'),S.result=S.anchorMap[Y],Be(S,!0,-1),!0}(S)?(ii=!0,(null!==S.tag||null!==S.anchor)&&Pn(S,"alias node should not have any properties")):function Hn(S,U,Y){var pt,zt,Yt,oe,Se,we,ii,Si,oi=S.kind,fi=S.result;if(ar(Si=S.input.charCodeAt(S.position))||As(Si)||35===Si||38===Si||42===Si||33===Si||124===Si||62===Si||39===Si||34===Si||37===Si||64===Si||96===Si||(63===Si||45===Si)&&(ar(pt=S.input.charCodeAt(S.position+1))||Y&&As(pt)))return!1;for(S.kind="scalar",S.result="",zt=Yt=S.position,oe=!1;0!==Si;){if(58===Si){if(ar(pt=S.input.charCodeAt(S.position+1))||Y&&As(pt))break}else if(35===Si){if(ar(S.input.charCodeAt(S.position-1)))break}else{if(S.position===S.lineStart&&bi(S)||Y&&As(Si))break;if(tr(Si)){if(Se=S.line,we=S.lineStart,ii=S.lineIndent,Be(S,!1,-1),S.lineIndent>=U){oe=!0,Si=S.input.charCodeAt(S.position);continue}S.position=Yt,S.line=Se,S.lineStart=we,S.lineIndent=ii;break}}oe&&(Q(S,zt,Yt,!1),un(S,S.line-Se),zt=Yt=S.position,oe=!1),Es(Si)||(Yt=S.position+1),Si=S.input.charCodeAt(++S.position)}return Q(S,zt,Yt,!1),!!S.result||(S.kind=oi,S.result=fi,!1)}(S,sn,1===Y)&&(ii=!0,null===S.tag&&(S.tag="?")),null!==S.anchor&&(S.anchorMap[S.anchor]=S.result)):0===Se&&(ii=oe&&fo(S,cn))),null===S.tag)null!==S.anchor&&(S.anchorMap[S.anchor]=S.result);else if("?"===S.tag){for(null!==S.result&&"scalar"!==S.kind&&Pn(S,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+S.kind+'"'),oi=0,fi=S.implicitTypes.length;oi<fi;oi+=1)if((zi=S.implicitTypes[oi]).resolve(S.result)){S.result=zi.construct(S.result),S.tag=zi.tag,null!==S.anchor&&(S.anchorMap[S.anchor]=S.result);break}}else if("!"!==S.tag){if(Xs.call(S.typeMap[S.kind||"fallback"],S.tag))zi=S.typeMap[S.kind||"fallback"][S.tag];else for(zi=null,oi=0,fi=(Si=S.typeMap.multi[S.kind||"fallback"]).length;oi<fi;oi+=1)if(S.tag.slice(0,Si[oi].tag.length)===Si[oi].tag){zi=Si[oi];break}zi||Pn(S,"unknown tag !<"+S.tag+">"),null!==S.result&&zi.kind!==S.kind&&Pn(S,"unacceptable node kind for !<"+S.tag+'> tag; it should be "'+zi.kind+'", not "'+S.kind+'"'),zi.resolve(S.result,S.tag)?(S.result=zi.construct(S.result,S.tag),null!==S.anchor&&(S.anchorMap[S.anchor]=S.result)):Pn(S,"cannot resolve a node with !<"+S.tag+"> explicit tag")}return null!==S.listener&&S.listener("close",S),null!==S.tag||null!==S.anchor||ii}function za(S){var Y,it,pt,Yt,U=S.position,zt=!1;for(S.version=null,S.checkLineBreaks=S.legacy,S.tagMap=Object.create(null),S.anchorMap=Object.create(null);0!==(Yt=S.input.charCodeAt(S.position))&&(Be(S,!0,-1),Yt=S.input.charCodeAt(S.position),!(S.lineIndent>0||37!==Yt));){for(zt=!0,Yt=S.input.charCodeAt(++S.position),Y=S.position;0!==Yt&&!ar(Yt);)Yt=S.input.charCodeAt(++S.position);for(pt=[],(it=S.input.slice(Y,S.position)).length<1&&Pn(S,"directive name must not be less than one character in length");0!==Yt;){for(;Es(Yt);)Yt=S.input.charCodeAt(++S.position);if(35===Yt){do{Yt=S.input.charCodeAt(++S.position)}while(0!==Yt&&!tr(Yt));break}if(tr(Yt))break;for(Y=S.position;0!==Yt&&!ar(Yt);)Yt=S.input.charCodeAt(++S.position);pt.push(S.input.slice(Y,S.position))}0!==Yt&&Ot(S),Xs.call(kt,it)?kt[it](S,it,pt):fa(S,'unknown document directive "'+it+'"')}Be(S,!0,-1),0===S.lineIndent&&45===S.input.charCodeAt(S.position)&&45===S.input.charCodeAt(S.position+1)&&45===S.input.charCodeAt(S.position+2)?(S.position+=3,Be(S,!0,-1)):zt&&Pn(S,"directives end mark is expected"),$r(S,S.lineIndent-1,4,!1,!0),Be(S,!0,-1),S.checkLineBreaks&&zr.test(S.input.slice(U,S.position))&&fa(S,"non-ASCII line breaks are interpreted as content"),S.documents.push(S.result),S.position===S.lineStart&&bi(S)?46===S.input.charCodeAt(S.position)&&(S.position+=3,Be(S,!0,-1)):S.position<S.length-1&&Pn(S,"end of the stream or a document separator is expected")}function xs(S,U){U=U||{},0!==(S=String(S)).length&&(10!==S.charCodeAt(S.length-1)&&13!==S.charCodeAt(S.length-1)&&(S+="\n"),65279===S.charCodeAt(0)&&(S=S.slice(1)));var Y=new pl(S,U),it=S.indexOf("\0");for(-1!==it&&(Y.position=it,Pn(Y,"null byte is not allowed in input")),Y.input+="\0";32===Y.input.charCodeAt(Y.position);)Y.lineIndent+=1,Y.position+=1;for(;Y.position<Y.length-1;)za(Y);return Y.documents}var ie={loadAll:function Ta(S,U,Y){null!==U&&"object"==typeof U&&void 0===Y&&(Y=U,U=null);var it=xs(S,Y);if("function"!=typeof U)return it;for(var pt=0,zt=it.length;pt<zt;pt+=1)U(it[pt])},load:function yc(S,U){var Y=xs(S,U);if(0!==Y.length){if(1===Y.length)return Y[0];throw new mn("expected a single document in the stream, but found more")}}},z=Object.prototype.toString,J=Object.prototype.hasOwnProperty,ir={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},Qs=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],ja=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function Sn(S){var U,Y,it;if(U=S.toString(16).toUpperCase(),S<=255)Y="x",it=2;else if(S<=65535)Y="u",it=4;else{if(!(S<=4294967295))throw new mn("code point within a string may not be greater than 0xFFFFFFFF");Y="U",it=8}return"\\"+Y+yi.repeat("0",it-U.length)+U}function bo(S){this.schema=S.schema||ol,this.indent=Math.max(1,S.indent||2),this.noArrayIndent=S.noArrayIndent||!1,this.skipInvalid=S.skipInvalid||!1,this.flowLevel=yi.isNothing(S.flowLevel)?-1:S.flowLevel,this.styleMap=function ps(S,U){var Y,it,pt,zt,Yt,oe,Se;if(null===U)return{};for(Y={},pt=0,zt=(it=Object.keys(U)).length;pt<zt;pt+=1)Yt=it[pt],oe=String(U[Yt]),"!!"===Yt.slice(0,2)&&(Yt="tag:yaml.org,2002:"+Yt.slice(2)),(Se=S.compiledTypeMap.fallback[Yt])&&J.call(Se.styleAliases,oe)&&(oe=Se.styleAliases[oe]),Y[Yt]=oe;return Y}(this.schema,S.styles||null),this.sortKeys=S.sortKeys||!1,this.lineWidth=S.lineWidth||80,this.noRefs=S.noRefs||!1,this.noCompatMode=S.noCompatMode||!1,this.condenseFlow=S.condenseFlow||!1,this.quotingType='"'===S.quotingType?2:1,this.forceQuotes=S.forceQuotes||!1,this.replacer="function"==typeof S.replacer?S.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Eo(S,U){for(var Yt,Y=yi.repeat(" ",U),it=0,pt=-1,zt="",oe=S.length;it<oe;)-1===(pt=S.indexOf("\n",it))?(Yt=S.slice(it),it=oe):(Yt=S.slice(it,pt+1),it=pt+1),Yt.length&&"\n"!==Yt&&(zt+=Y),zt+=Yt;return zt}function Ns(S,U){return"\n"+yi.repeat(" ",S.indent*U)}function ra(S){return 32===S||9===S}function lr(S){return 32<=S&&S<=126||161<=S&&S<=55295&&8232!==S&&8233!==S||57344<=S&&S<=65533&&65279!==S||65536<=S&&S<=1114111}function Lr(S){return lr(S)&&65279!==S&&13!==S&&10!==S}function ns(S,U,Y){var it=Lr(S),pt=it&&!ra(S);return(Y?it:it&&44!==S&&91!==S&&93!==S&&123!==S&&125!==S)&&35!==S&&!(58===U&&!pt)||Lr(U)&&!ra(U)&&35===S||58===U&&pt}function jr(S,U){var it,Y=S.charCodeAt(U);return Y>=55296&&Y<=56319&&U+1<S.length&&(it=S.charCodeAt(U+1))>=56320&&it<=57343?1024*(Y-55296)+it-56320+65536:Y}function Fs(S){return/^\n* /.test(S)}function ka(S,U,Y,it,pt){S.dump=function(){if(0===U.length)return 2===S.quotingType?'""':"''";if(!S.noCompatMode&&(-1!==Qs.indexOf(U)||ja.test(U)))return 2===S.quotingType?'"'+U+'"':"'"+U+"'";var zt=S.indent*Math.max(1,Y),Yt=-1===S.lineWidth?-1:Math.max(Math.min(S.lineWidth,40),S.lineWidth-zt);switch(function Ya(S,U,Y,it,pt,zt,Yt,oe){var Se,we=0,ii=null,oi=!1,fi=!1,Si=-1!==it,zi=-1,sn=function Ss(S){return lr(S)&&65279!==S&&!ra(S)&&45!==S&&63!==S&&58!==S&&44!==S&&91!==S&&93!==S&&123!==S&&125!==S&&35!==S&&38!==S&&42!==S&&33!==S&&124!==S&&61!==S&&62!==S&&39!==S&&34!==S&&37!==S&&64!==S&&96!==S}(jr(S,0))&&function ba(S){return!ra(S)&&58!==S}(jr(S,S.length-1));if(U||Yt)for(Se=0;Se<S.length;we>=65536?Se+=2:Se++){if(!lr(we=jr(S,Se)))return 5;sn=sn&&ns(we,ii,oe),ii=we}else{for(Se=0;Se<S.length;we>=65536?Se+=2:Se++){if(10===(we=jr(S,Se)))oi=!0,Si&&(fi=fi||Se-zi-1>it&&" "!==S[zi+1],zi=Se);else if(!lr(we))return 5;sn=sn&&ns(we,ii,oe),ii=we}fi=fi||Si&&Se-zi-1>it&&" "!==S[zi+1]}return oi||fi?Y>9&&Fs(S)?5:Yt?2===zt?5:2:fi?4:3:!sn||Yt||pt(S)?2===zt?5:2:1}(U,it||S.flowLevel>-1&&Y>=S.flowLevel,S.indent,Yt,function Se(we){return function Ps(S,U){var Y,it;for(Y=0,it=S.implicitTypes.length;Y<it;Y+=1)if(S.implicitTypes[Y].resolve(U))return!0;return!1}(S,we)},S.quotingType,S.forceQuotes&&!it,pt)){case 1:return U;case 2:return"'"+U.replace(/'/g,"''")+"'";case 3:return"|"+Ql(U,S.indent)+ll(Eo(U,zt));case 4:return">"+Ql(U,S.indent)+ll(Eo(function Ul(S,U){for(var zt,Yt,Y=/(\n+)([^\n]*)/g,it=(we=void 0,we=S.indexOf("\n"),Y.lastIndex=we=-1!==we?we:S.length,cl(S.slice(0,we),U)),pt="\n"===S[0]||" "===S[0];Yt=Y.exec(S);){var Se=Yt[2];zt=" "===Se[0],it+=Yt[1]+(pt||zt||""===Se?"":"\n")+cl(Se,U),pt=zt}var we;return it}(U,Yt),zt));case 5:return'"'+function fl(S){for(var it,U="",Y=0,pt=0;pt<S.length;Y>=65536?pt+=2:pt++)Y=jr(S,pt),!(it=ir[Y])&&lr(Y)?(U+=S[pt],Y>=65536&&(U+=S[pt+1])):U+=it||Sn(Y);return U}(U)+'"';default:throw new mn("impossible error: invalid scalar style")}}()}function Ql(S,U){var Y=Fs(S)?String(U):"",it="\n"===S[S.length-1];return Y+(!it||"\n"!==S[S.length-2]&&"\n"!==S?it?"":"-":"+")+"\n"}function ll(S){return"\n"===S[S.length-1]?S.slice(0,-1):S}function cl(S,U){if(""===S||" "===S[0])return S;for(var it,zt,Y=/ [^ ]/g,pt=0,Yt=0,oe=0,Se="";it=Y.exec(S);)(oe=it.index)-pt>U&&(Se+="\n"+S.slice(pt,zt=Yt>pt?Yt:oe),pt=zt+1),Yt=oe;return Se+="\n",(Se+=S.length-pt>U&&Yt>pt?S.slice(pt,Yt)+"\n"+S.slice(Yt+1):S.slice(pt)).slice(1)}function Xa(S,U,Y){var it,pt,zt,Yt,oe,Se;for(zt=0,Yt=(pt=Y?S.explicitTypes:S.implicitTypes).length;zt<Yt;zt+=1)if(((oe=pt[zt]).instanceOf||oe.predicate)&&(!oe.instanceOf||"object"==typeof U&&U instanceof oe.instanceOf)&&(!oe.predicate||oe.predicate(U))){if(S.tag=Y?oe.multi&&oe.representName?oe.representName(U):oe.tag:"?",oe.represent){if(Se=S.styleMap[oe.tag]||oe.defaultStyle,"[object Function]"===z.call(oe.represent))it=oe.represent(U,Se);else{if(!J.call(oe.represent,Se))throw new mn("!<"+oe.tag+'> tag resolver accepts not "'+Se+'" style');it=oe.represent[Se](U,Se)}S.dump=it}return!0}return!1}function qs(S,U,Y,it,pt,zt,Yt){S.tag=null,S.dump=Y,Xa(S,Y,!1)||Xa(S,Y,!0);var we,oe=z.call(S.dump),Se=it;it&&(it=S.flowLevel<0||S.flowLevel>U);var oi,fi,ii="[object Object]"===oe||"[object Array]"===oe;if(ii&&(fi=-1!==(oi=S.duplicates.indexOf(Y))),(null!==S.tag&&"?"!==S.tag||fi||2!==S.indent&&U>0)&&(pt=!1),fi&&S.usedDuplicates[oi])S.dump="*ref_"+oi;else{if(ii&&fi&&!S.usedDuplicates[oi]&&(S.usedDuplicates[oi]=!0),"[object Object]"===oe)it&&0!==Object.keys(S.dump).length?(function ql(S,U,Y,it){var oe,Se,we,ii,oi,fi,pt="",zt=S.tag,Yt=Object.keys(Y);if(!0===S.sortKeys)Yt.sort();else if("function"==typeof S.sortKeys)Yt.sort(S.sortKeys);else if(S.sortKeys)throw new mn("sortKeys must be a boolean or a function");for(oe=0,Se=Yt.length;oe<Se;oe+=1)fi="",(!it||""!==pt)&&(fi+=Ns(S,U)),ii=Y[we=Yt[oe]],S.replacer&&(ii=S.replacer.call(Y,we,ii)),qs(S,U+1,we,!0,!0,!0)&&((oi=null!==S.tag&&"?"!==S.tag||S.dump&&S.dump.length>1024)&&(S.dump&&10===S.dump.charCodeAt(0)?fi+="?":fi+="? "),fi+=S.dump,oi&&(fi+=Ns(S,U)),qs(S,U+1,ii,!0,oi)&&(S.dump&&10===S.dump.charCodeAt(0)?fi+=":":fi+=": ",pt+=fi+=S.dump));S.tag=zt,S.dump=pt||"{}"}(S,U,S.dump,pt),fi&&(S.dump="&ref_"+oi+S.dump)):(function ga(S,U,Y){var Yt,oe,Se,we,ii,it="",pt=S.tag,zt=Object.keys(Y);for(Yt=0,oe=zt.length;Yt<oe;Yt+=1)ii="",""!==it&&(ii+=", "),S.condenseFlow&&(ii+='"'),we=Y[Se=zt[Yt]],S.replacer&&(we=S.replacer.call(Y,Se,we)),qs(S,U,Se,!1,!1)&&(S.dump.length>1024&&(ii+="? "),ii+=S.dump+(S.condenseFlow?'"':"")+":"+(S.condenseFlow?"":" "),qs(S,U,we,!1,!1)&&(it+=ii+=S.dump));S.tag=pt,S.dump="{"+it+"}"}(S,U,S.dump),fi&&(S.dump="&ref_"+oi+" "+S.dump));else if("[object Array]"===oe)it&&0!==S.dump.length?(function Fc(S,U,Y,it){var Yt,oe,Se,pt="",zt=S.tag;for(Yt=0,oe=Y.length;Yt<oe;Yt+=1)Se=Y[Yt],S.replacer&&(Se=S.replacer.call(Y,String(Yt),Se)),(qs(S,U+1,Se,!0,!0,!1,!0)||void 0===Se&&qs(S,U+1,null,!0,!0,!1,!0))&&((!it||""!==pt)&&(pt+=Ns(S,U)),S.dump&&10===S.dump.charCodeAt(0)?pt+="-":pt+="- ",pt+=S.dump);S.tag=zt,S.dump=pt||"[]"}(S,S.noArrayIndent&&!Yt&&U>0?U-1:U,S.dump,pt),fi&&(S.dump="&ref_"+oi+S.dump)):(function gl(S,U,Y){var zt,Yt,oe,it="",pt=S.tag;for(zt=0,Yt=Y.length;zt<Yt;zt+=1)oe=Y[zt],S.replacer&&(oe=S.replacer.call(Y,String(zt),oe)),(qs(S,U,oe,!1,!1)||void 0===oe&&qs(S,U,null,!1,!1))&&(""!==it&&(it+=","+(S.condenseFlow?"":" ")),it+=S.dump);S.tag=pt,S.dump="["+it+"]"}(S,U,S.dump),fi&&(S.dump="&ref_"+oi+" "+S.dump));else{if("[object String]"!==oe){if("[object Undefined]"===oe)return!1;if(S.skipInvalid)return!1;throw new mn("unacceptable kind of an object to dump "+oe)}"?"!==S.tag&&ka(S,S.dump,U,zt,Se)}null!==S.tag&&"?"!==S.tag&&(we=encodeURI("!"===S.tag[0]?S.tag.slice(1):S.tag).replace(/!/g,"%21"),we="!"===S.tag[0]?"!"+we:"tag:yaml.org,2002:"===we.slice(0,18)?"!!"+we.slice(18):"!<"+we+">",S.dump=we+" "+S.dump)}return!0}function xa(S,U){var pt,zt,Y=[],it=[];for(Hs(S,Y,it),pt=0,zt=it.length;pt<zt;pt+=1)U.duplicates.push(Y[it[pt]]);U.usedDuplicates=new Array(zt)}function Hs(S,U,Y){var it,pt,zt;if(null!==S&&"object"==typeof S)if(-1!==(pt=U.indexOf(S)))-1===Y.indexOf(pt)&&Y.push(pt);else if(U.push(S),Array.isArray(S))for(pt=0,zt=S.length;pt<zt;pt+=1)Hs(S[pt],U,Y);else for(pt=0,zt=(it=Object.keys(S)).length;pt<zt;pt+=1)Hs(S[it[pt]],U,Y)}function sc(S,U){return function(){throw new Error("Function yaml."+S+" is removed in js-yaml 4. Use yaml."+U+" instead, which is now safe by default.")}}const pr={Type:tn,Schema:Je,FAILSAFE_SCHEMA:gn,JSON_SCHEMA:Fe,CORE_SCHEMA:Mi,DEFAULT_SCHEMA:ol,load:ie.load,loadAll:ie.loadAll,dump:function Ea(S,U){var Y=new bo(U=U||{});Y.noRefs||xa(S,Y);var it=S;return Y.replacer&&(it=Y.replacer.call({"":it},"",it)),qs(Y,0,it,!0,!0)?Y.dump+"\n":""},YAMLException:mn,types:{binary:sr,float:ae,map:Oi,null:Zo,pairs:js,set:Ys,timestamp:Rn,bool:vo,int:yo,merge:_r,omap:ya,seq:hi,str:xe},safeLoad:sc("safeLoad","load"),safeLoadAll:sc("safeLoadAll","loadAll"),safeDump:sc("safeDump","dump")},Sl="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:window,{FormData:Us,Blob:fs,File:Vs}=Sl;function Ja(S){return function Ka(S){if(bt(S))return lt(S)}(S)||function os(S){if(void 0!==Jt&&null!=Ct(S)||null!=S["@@iterator"])return ft(S)}(S)||Ft(S)||function _l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var nu=_(63759),_a=_.n(nu),Vl=function(U){return":/?#[]@!$&'()*+,;=".indexOf(U)>-1},gs=function(U){return/^[a-z0-9\-._~]+$/i.test(U)};function Rr(S){var U,Y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},it=Y.escape,pt=arguments.length>2?arguments[2]:void 0;return"number"==typeof S&&(S=S.toString()),"string"==typeof S&&S.length&&it?pt?JSON.parse(S):Dt()(U=Ja(S)).call(U,function(zt){var Yt,oe;if(gs(zt)||Vl(zt)&&"unsafe"===it)return zt;var Se=new TextEncoder;return Dt()(Yt=Dt()(oe=Bt()(Se.encode(zt))).call(oe,function(ii){var oi;return _a()(oi="0".concat(ii.toString(16).toUpperCase())).call(oi,-2)})).call(Yt,function(ii){return"%".concat(ii)}).join("")}).join(""):S}function Dr(S){var U=S.value;return Array.isArray(U)?function nr(S){var U=S.key,Y=S.value,it=S.style,pt=S.explode,zt=S.escape,Yt=function(oi){return Rr(oi,{escape:zt})};if("simple"===it)return Dt()(Y).call(Y,function(ii){return Yt(ii)}).join(",");if("label"===it)return".".concat(Dt()(Y).call(Y,function(ii){return Yt(ii)}).join("."));if("matrix"===it)return Dt()(Y).call(Y,function(ii){return Yt(ii)}).reduce(function(ii,oi){var fi,Si,zi;return!ii||pt?Ee()(Si=Ee()(zi="".concat(ii||"",";")).call(zi,U,"=")).call(Si,oi):Ee()(fi="".concat(ii,",")).call(fi,oi)},"");if("form"===it){var oe=pt?"&".concat(U,"="):",";return Dt()(Y).call(Y,function(ii){return Yt(ii)}).join(oe)}if("spaceDelimited"===it){var Se=pt?"".concat(U,"="):"";return Dt()(Y).call(Y,function(ii){return Yt(ii)}).join(" ".concat(Se))}if("pipeDelimited"===it){var we=pt?"".concat(U,"="):"";return Dt()(Y).call(Y,function(ii){return Yt(ii)}).join("|".concat(we))}}(S):"object"===ct(U)?function Rl(S){var U=S.key,Y=S.value,it=S.style,pt=S.explode,zt=S.escape,Yt=function(we){return Rr(we,{escape:zt})},oe=je()(Y);return"simple"===it?oe.reduce(function(Se,we){var ii,oi,fi,Si=Yt(Y[we]),zi=pt?"=":",",sn=Se?"".concat(Se,","):"";return Ee()(ii=Ee()(oi=Ee()(fi="".concat(sn)).call(fi,we)).call(oi,zi)).call(ii,Si)},""):"label"===it?oe.reduce(function(Se,we){var ii,oi,fi,Si=Yt(Y[we]),zi=pt?"=":".",sn=Se?"".concat(Se,"."):".";return Ee()(ii=Ee()(oi=Ee()(fi="".concat(sn)).call(fi,we)).call(oi,zi)).call(ii,Si)},""):"matrix"===it&&pt?oe.reduce(function(Se,we){var ii,oi,fi=Yt(Y[we]),Si=Se?"".concat(Se,";"):";";return Ee()(ii=Ee()(oi="".concat(Si)).call(oi,we,"=")).call(ii,fi)},""):"matrix"===it?oe.reduce(function(Se,we){var ii,oi,fi=Yt(Y[we]),Si=Se?"".concat(Se,","):";".concat(U,"=");return Ee()(ii=Ee()(oi="".concat(Si)).call(oi,we,",")).call(ii,fi)},""):"form"===it?oe.reduce(function(Se,we){var ii,oi,fi,Si,zi=Yt(Y[we]),sn=Se?Ee()(ii="".concat(Se)).call(ii,pt?"&":","):"",cn=pt?"=":",";return Ee()(oi=Ee()(fi=Ee()(Si="".concat(sn)).call(Si,we)).call(fi,cn)).call(oi,zi)},""):void 0}(S):function ou(S){var Yt,U=S.key,Y=S.value,it=S.style,pt=S.escape,zt=function(Se){return Rr(Se,{escape:pt})};return"simple"===it?zt(Y):"label"===it?".".concat(zt(Y)):"matrix"===it?Ee()(Yt=";".concat(U,"=")).call(Yt,zt(Y)):"form"===it||"deepObject"===it?zt(Y):void 0}(S)}const th=function(U,Y){Y.body=U};var Fu={serializeRes:eh,mergeInQueryOrForm:La};function Cu(S){return bc.apply(this,arguments)}function bc(){return bc=ce(Ne().mark(function S(U){var Y,pt,zt,Yt,oe=arguments;return Ne().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(Y=oe.length>1&&void 0!==oe[1]?oe[1]:{},"object"===ct(U)&&(U=(Y=U).url),Y.headers=Y.headers||{},Fu.mergeInQueryOrForm(Y),Y.headers&&je()(Y.headers).forEach(function(ii){var oi=Y.headers[ii];"string"==typeof oi&&(Y.headers[ii]=oi.replace(/\n+/g," "))}),!Y.requestInterceptor){we.next=12;break}return we.next=8,Y.requestInterceptor(Y);case 8:if(we.t0=we.sent,we.t0){we.next=11;break}we.t0=Y;case 11:Y=we.t0;case 12:return/multipart\/form-data/i.test(Y.headers["content-type"]||Y.headers["Content-Type"])&&Y.body instanceof Us&&(delete Y.headers["content-type"],delete Y.headers["Content-Type"]),we.prev=14,we.next=17,(Y.userFetch||fetch)(Y.url,Y);case 17:return pt=we.sent,we.next=20,Fu.serializeRes(pt,U,Y);case 20:if(pt=we.sent,!Y.responseInterceptor){we.next=28;break}return we.next=24,Y.responseInterceptor(pt);case 24:if(we.t1=we.sent,we.t1){we.next=27;break}we.t1=pt;case 27:pt=we.t1;case 28:we.next=39;break;case 30:if(we.prev=30,we.t2=we.catch(14),pt){we.next=34;break}throw we.t2;case 34:throw(zt=new Error(pt.statusText||"response status is ".concat(pt.status))).status=pt.status,zt.statusCode=pt.status,zt.responseError=we.t2,zt;case 39:if(pt.ok){we.next=45;break}throw(Yt=new Error(pt.statusText||"response status is ".concat(pt.status))).status=pt.status,Yt.statusCode=pt.status,Yt.response=pt,Yt;case 45:return we.abrupt("return",pt);case 46:case"end":return we.stop()}},S,null,[[14,30]])})),bc.apply(this,arguments)}var Bu=function(){var U=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return/(json|xml|yaml|text)\b/.test(U)};function Su(S,U){return U&&(0===U.indexOf("application/json")||U.indexOf("+json")>0)?JSON.parse(S):pr.load(S)}function eh(S,U){var Y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},it=Y.loadSpec,pt=void 0!==it&&it,zt={ok:S.ok,url:S.url||U,status:S.status,statusText:S.statusText,headers:Ru(S.headers)},Yt=zt.headers["content-type"],oe=pt||Bu(Yt),Se=oe?S.text:S.blob||S.buffer;return Se.call(S).then(function(we){if(zt.text=we,zt.data=we,oe)try{var ii=Su(we,Yt);zt.body=ii,zt.obj=ii}catch(oi){zt.parseError=oi}return zt})}function ac(S){return Di()(S).call(S,", ")?S.split(", "):S}function Ru(){var S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"function"!=typeof Me()(S)?{}:Bt()(Me()(S).call(S)).reduce(function(U,Y){var it=Lt(Y,2);return U[it[0]]=ac(it[1]),U},{})}function Nr(S,U){return!U&&"undefined"!=typeof navigator&&(U=navigator),U&&"ReactNative"===U.product?!(!S||"object"!==ct(S)||"string"!=typeof S.uri):!!(void 0!==Vs&&S instanceof Vs||void 0!==fs&&S instanceof fs||ArrayBuffer.isView(S))||null!==S&&"object"===ct(S)&&"function"==typeof S.pipe}function Gl(S,U){return Array.isArray(S)&&S.some(function(Y){return Nr(Y,U)})}var ec={form:",",spaceDelimited:"%20",pipeDelimited:"|"},Rs={csv:",",ssv:"%20",tsv:"%09",pipes:"|"};function $a(S,U){var Y=arguments.length>2&&void 0!==arguments[2]&&arguments[2],it=U.collectionFormat,pt=U.allowEmptyValue,zt=U.serializationOption,Yt=U.encoding,oe="object"!==ct(U)||Array.isArray(U)?U:U.value,Se=Y?function(zi){return zi.toString()}:function(zi){return encodeURIComponent(zi)},we=Se(S);if(void 0===oe&&pt)return[[we,""]];if(Nr(oe)||Gl(oe))return[[we,oe]];if(zt)return Ca(S,oe,Y,zt);if(Yt){if([ct(Yt.style),ct(Yt.explode),ct(Yt.allowReserved)].some(function(zi){return"undefined"!==zi})){var ii=Yt.style,oi=Yt.explode,fi=Yt.allowReserved;return Ca(S,oe,Y,{style:ii,explode:oi,allowReserved:fi})}if(Yt.contentType){if("application/json"===Yt.contentType){var Si="string"==typeof oe?oe:Xt()(oe);return[[we,Se(Si)]]}return[[we,Se(oe.toString())]]}return"object"!==ct(oe)?[[we,Se(oe)]]:Array.isArray(oe)&&oe.every(function(zi){return"object"!==ct(zi)})?[[we,Dt()(oe).call(oe,Se).join(",")]]:[[we,Se(Xt()(oe))]]}return"object"!==ct(oe)?[[we,Se(oe)]]:Array.isArray(oe)?"multi"===it?[[we,Dt()(oe).call(oe,Se)]]:[[we,Dt()(oe).call(oe,Se).join(Rs[it||"csv"])]]:[[we,""]]}function Ca(S,U,Y,it){var pt,ii,oi,zt=it.style||"form",Yt=void 0===it.explode?"form"===zt:it.explode,oe=!Y&&(it&&it.allowReserved?"unsafe":"reserved"),Se=function(Si){return Rr(Si,{escape:oe})},we=Y?function(fi){return fi}:function(fi){return Rr(fi,{escape:oe})};return"object"!==ct(U)?[[we(S),Se(U)]]:Array.isArray(U)?Yt?[[we(S),Dt()(U).call(U,Se)]]:[[we(S),Dt()(U).call(U,Se).join(ec[zt])]]:"deepObject"===zt?Dt()(ii=je()(U)).call(ii,function(fi){var Si;return[we(Ee()(Si="".concat(S,"[")).call(Si,fi,"]")),Se(U[fi])]}):Yt?Dt()(oi=je()(U)).call(oi,function(fi){return[we(fi),Se(U[fi])]}):[[we(S),Dt()(pt=je()(U)).call(pt,function(fi){var Si;return[Ee()(Si="".concat(we(fi),",")).call(Si,Se(U[fi]))]}).join(",")]]}function aa(S){return ee()(S).reduce(function(U,Y){var oe,it=Lt(Y,2),Yt=Mt($a(it[0],it[1],!0));try{for(Yt.s();!(oe=Yt.n()).done;){var Se=Lt(oe.value,2),we=Se[0],ii=Se[1];if(Array.isArray(ii)){var fi,oi=Mt(ii);try{for(oi.s();!(fi=oi.n()).done;){var Si=fi.value;if(ArrayBuffer.isView(Si)){var zi=new fs([Si]);U.append(we,zi)}else U.append(we,Si)}}catch(cn){oi.e(cn)}finally{oi.f()}}else if(ArrayBuffer.isView(ii)){var sn=new fs([ii]);U.append(we,sn)}else U.append(we,ii)}}catch(cn){Yt.e(cn)}finally{Yt.f()}return U},new Us)}function Za(S){var U=je()(S).reduce(function(Y,it){var zt,pt=Mt($a(it,S[it]));try{for(pt.s();!(zt=pt.n()).done;){var Yt=Lt(zt.value,2);Y[Yt[0]]=Yt[1]}}catch(we){pt.e(we)}finally{pt.f()}return Y},{});return Kt().stringify(U,{encode:!1,indices:!1})||""}function La(){var S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},U=S.url,Y=void 0===U?"":U,it=S.query,pt=S.form,zt=function(){for(var en=arguments.length,go=new Array(en),ko=0;ko<en;ko++)go[ko]=arguments[ko];var Qr=le()(go).call(go,function(gr){return gr}).join("&");return Qr?"?".concat(Qr):""};if(pt){var Yt=je()(pt).some(function(xn){var en=pt[xn].value;return Nr(en)||Gl(en)}),oe=S.headers["content-type"]||S.headers["Content-Type"];if(Yt||/multipart\/form-data/i.test(oe)){var Se=aa(S.form);th(Se,S)}else S.body=Za(pt);delete S.form}if(it){var we=Y.split("?"),ii=Lt(we,2),oi=ii[0],fi=ii[1],Si="";if(fi){var zi=Kt().parse(fi),sn=je()(it);sn.forEach(function(xn){return delete zi[xn]}),Si=Kt().stringify(zi,{encode:!0})}var cn=zt(Si,Za(it));S.url=oi+cn,delete S.query}return S}function Hc(S,U){if(!(S instanceof U))throw new TypeError("Cannot call a class as a function")}function ma(S,U){for(var Y=0;Y<U.length;Y++){var it=U[Y];it.enumerable=it.enumerable||!1,it.configurable=!0,"value"in it&&(it.writable=!0),L(S,it.key,it)}}function Wo(S,U,Y){return U&&ma(S.prototype,U),Y&&ma(S,Y),L(S,"prototype",{writable:!1}),S}var S,Na=_(77464),Il=_.n(Na),Wl=_(78927),Is=_.n(Wl),Qa=_(67489),ic=_.n(Qa),ih=(S=function(U,Y){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(it,pt){it.__proto__=pt}||function(it,pt){for(var zt in pt)pt.hasOwnProperty(zt)&&(it[zt]=pt[zt])})(U,Y)},function(U,Y){function it(){this.constructor=U}S(U,Y),U.prototype=null===Y?Object.create(Y):(it.prototype=Y.prototype,new it)}),wl=Object.prototype.hasOwnProperty;function nc(S,U){return wl.call(S,U)}function Cc(S){if(Array.isArray(S)){for(var U=new Array(S.length),Y=0;Y<U.length;Y++)U[Y]=""+Y;return U}if(Object.keys)return Object.keys(S);var it=[];for(var pt in S)nc(S,pt)&&it.push(pt);return it}function _s(S){switch(typeof S){case"object":return JSON.parse(JSON.stringify(S));case"undefined":return null;default:return S}}function ml(S){for(var it,U=0,Y=S.length;U<Y;){if(!((it=S.charCodeAt(U))>=48&&it<=57))return!1;U++}return!0}function Ao(S){return-1===S.indexOf("/")&&-1===S.indexOf("~")?S:S.replace(/~/g,"~0").replace(/\//g,"~1")}function Uc(S){return S.replace(/~1/g,"/").replace(/~0/g,"~")}function Vc(S){if(void 0===S)return!0;if(S)if(Array.isArray(S)){for(var U=0,Y=S.length;U<Y;U++)if(Vc(S[U]))return!0}else if("object"==typeof S)for(var it=Cc(S),pt=it.length,zt=0;zt<pt;zt++)if(Vc(S[it[zt]]))return!0;return!1}function Dl(S,U){var Y=[S];for(var it in U){var pt="object"==typeof U[it]?JSON.stringify(U[it],null,2):U[it];void 0!==pt&&Y.push(it+": "+pt)}return Y.join("\n")}var Gc=function(S){function U(Y,it,pt,zt,Yt){var oe=this.constructor,Se=S.call(this,Dl(Y,{name:it,index:pt,operation:zt,tree:Yt}))||this;return Se.name=it,Se.index=pt,Se.operation=zt,Se.tree=Yt,Object.setPrototypeOf(Se,oe.prototype),Se.message=Dl(Y,{name:it,index:pt,operation:zt,tree:Yt}),Se}return ih(U,S),U}(Error),Mr=Gc,Iu=_s,cc={add:function(S,U,Y){return S[U]=this.value,{newDocument:Y}},remove:function(S,U,Y){var it=S[U];return delete S[U],{newDocument:Y,removed:it}},replace:function(S,U,Y){var it=S[U];return S[U]=this.value,{newDocument:Y,removed:it}},move:function(S,U,Y){var it=Ml(Y,this.path);it&&(it=_s(it));var pt=qa(Y,{op:"remove",path:this.from}).removed;return qa(Y,{op:"add",path:this.path,value:pt}),{newDocument:Y,removed:it}},copy:function(S,U,Y){var it=Ml(Y,this.from);return qa(Y,{op:"add",path:this.path,value:_s(it)}),{newDocument:Y}},test:function(S,U,Y){return{newDocument:Y,test:Ol(S[U],this.value)}},_get:function(S,U,Y){return this.value=S[U],{newDocument:Y}}},ru={add:function(S,U,Y){return ml(U)?S.splice(U,0,this.value):S[U]=this.value,{newDocument:Y,index:U}},remove:function(S,U,Y){return{newDocument:Y,removed:S.splice(U,1)[0]}},replace:function(S,U,Y){var it=S[U];return S[U]=this.value,{newDocument:Y,removed:it}},move:cc.move,copy:cc.copy,test:cc.test,_get:cc._get};function Ml(S,U){if(""==U)return S;var Y={op:"_get",path:U};return qa(S,Y),Y.value}function qa(S,U,Y,it,pt,zt){if(void 0===Y&&(Y=!1),void 0===it&&(it=!0),void 0===pt&&(pt=!0),void 0===zt&&(zt=0),Y&&("function"==typeof Y?Y(U,0,S,U.path):ul(U,0)),""===U.path){var Yt={newDocument:S};if("add"===U.op)return Yt.newDocument=U.value,Yt;if("replace"===U.op)return Yt.newDocument=U.value,Yt.removed=S,Yt;if("move"===U.op||"copy"===U.op)return Yt.newDocument=Ml(S,U.from),"move"===U.op&&(Yt.removed=S),Yt;if("test"===U.op){if(Yt.test=Ol(S,U.value),!1===Yt.test)throw new Mr("Test operation failed","TEST_OPERATION_FAILED",zt,U,S);return Yt.newDocument=S,Yt}if("remove"===U.op)return Yt.removed=S,Yt.newDocument=null,Yt;if("_get"===U.op)return U.value=S,Yt;if(Y)throw new Mr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",zt,U,S);return Yt}it||(S=_s(S));var Se=(U.path||"").split("/"),we=S,ii=1,oi=Se.length,fi=void 0,Si=void 0,zi=void 0;for(zi="function"==typeof Y?Y:ul;;){if((Si=Se[ii])&&-1!=Si.indexOf("~")&&(Si=Uc(Si)),pt&&("__proto__"==Si||"prototype"==Si&&ii>0&&"constructor"==Se[ii-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(Y&&void 0===fi&&(void 0===we[Si]?fi=Se.slice(0,ii).join("/"):ii==oi-1&&(fi=U.path),void 0!==fi&&zi(U,0,S,fi)),ii++,Array.isArray(we)){if("-"===Si)Si=we.length;else{if(Y&&!ml(Si))throw new Mr("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",zt,U,S);ml(Si)&&(Si=~~Si)}if(ii>=oi){if(Y&&"add"===U.op&&Si>we.length)throw new Mr("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",zt,U,S);if(!1===(Yt=ru[U.op].call(U,we,Si,S)).test)throw new Mr("Test operation failed","TEST_OPERATION_FAILED",zt,U,S);return Yt}}else if(ii>=oi){if(!1===(Yt=cc[U.op].call(U,we,Si,S)).test)throw new Mr("Test operation failed","TEST_OPERATION_FAILED",zt,U,S);return Yt}if(we=we[Si],Y&&ii<oi&&(!we||"object"!=typeof we))throw new Mr("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",zt,U,S)}}function ta(S,U,Y,it,pt){if(void 0===it&&(it=!0),void 0===pt&&(pt=!0),Y&&!Array.isArray(U))throw new Mr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");it||(S=_s(S));for(var zt=new Array(U.length),Yt=0,oe=U.length;Yt<oe;Yt++)zt[Yt]=qa(S,U[Yt],Y,!0,pt,Yt),S=zt[Yt].newDocument;return zt.newDocument=S,zt}function Wc(S,U,Y){var it=qa(S,U);if(!1===it.test)throw new Mr("Test operation failed","TEST_OPERATION_FAILED",Y,U,S);return it.newDocument}function ul(S,U,Y,it){if("object"!=typeof S||null===S||Array.isArray(S))throw new Mr("Operation is not an object","OPERATION_NOT_AN_OBJECT",U,S,Y);if(!cc[S.op])throw new Mr("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",U,S,Y);if("string"!=typeof S.path)throw new Mr("Operation `path` property is not a string","OPERATION_PATH_INVALID",U,S,Y);if(0!==S.path.indexOf("/")&&S.path.length>0)throw new Mr('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",U,S,Y);if(("move"===S.op||"copy"===S.op)&&"string"!=typeof S.from)throw new Mr("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",U,S,Y);if(("add"===S.op||"replace"===S.op||"test"===S.op)&&void 0===S.value)throw new Mr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",U,S,Y);if(("add"===S.op||"replace"===S.op||"test"===S.op)&&Vc(S.value))throw new Mr("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",U,S,Y);if(Y)if("add"==S.op){var pt=S.path.split("/").length,zt=it.split("/").length;if(pt!==zt+1&&pt!==zt)throw new Mr("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",U,S,Y)}else if("replace"===S.op||"remove"===S.op||"_get"===S.op){if(S.path!==it)throw new Mr("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",U,S,Y)}else if("move"===S.op||"copy"===S.op){var oe=Yr([{op:"_get",path:S.from,value:void 0}],Y);if(oe&&"OPERATION_PATH_UNRESOLVABLE"===oe.name)throw new Mr("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",U,S,Y)}}function Yr(S,U,Y){try{if(!Array.isArray(S))throw new Mr("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(U)ta(_s(U),_s(S),Y||!0);else{Y=Y||ul;for(var it=0;it<S.length;it++)Y(S[it],it,U,void 0)}}catch(pt){if(pt instanceof Mr)return pt;throw pt}}function Ol(S,U){if(S===U)return!0;if(S&&U&&"object"==typeof S&&"object"==typeof U){var pt,zt,Yt,Y=Array.isArray(S),it=Array.isArray(U);if(Y&&it){if((zt=S.length)!=U.length)return!1;for(pt=zt;0!=pt--;)if(!Ol(S[pt],U[pt]))return!1;return!0}if(Y!=it)return!1;var oe=Object.keys(S);if((zt=oe.length)!==Object.keys(U).length)return!1;for(pt=zt;0!=pt--;)if(!U.hasOwnProperty(oe[pt]))return!1;for(pt=zt;0!=pt--;)if(!Ol(S[Yt=oe[pt]],U[Yt]))return!1;return!0}return S!=S&&U!=U}var Sa=new WeakMap,oc=function S(U){this.observers=new Map,this.obj=U},Sc=function S(U,Y){this.callback=U,this.observer=Y};function Ra(S,U){U.unobserve()}function vl(S,U){var it,pt=function nh(S){return Sa.get(S)}(S);if(pt){var zt=function wu(S,U){return S.observers.get(U)}(pt,U);it=zt&&zt.observer}else pt=new oc(S),Sa.set(S,pt);if(it)return it;if(it={},pt.value=_s(S),U){it.callback=U,it.next=null;var Yt=function(){Rc(it)},oe=function(){clearTimeout(it.next),it.next=setTimeout(Yt)};"undefined"!=typeof window&&(window.addEventListener("mouseup",oe),window.addEventListener("keyup",oe),window.addEventListener("mousedown",oe),window.addEventListener("keydown",oe),window.addEventListener("change",oe))}return it.patches=[],it.object=S,it.unobserve=function(){Rc(it),clearTimeout(it.next),function ca(S,U){S.observers.delete(U.callback)}(pt,it),"undefined"!=typeof window&&(window.removeEventListener("mouseup",oe),window.removeEventListener("keyup",oe),window.removeEventListener("mousedown",oe),window.removeEventListener("keydown",oe),window.removeEventListener("change",oe))},pt.observers.set(U,new Sc(U,it)),it}function Rc(S,U){void 0===U&&(U=!1);var Y=Sa.get(S.object);Al(Y.value,S.object,S.patches,"",U),S.patches.length&&ta(Y.value,S.patches);var it=S.patches;return it.length>0&&(S.patches=[],S.callback&&S.callback(it)),it}function Al(S,U,Y,it,pt){if(U!==S){"function"==typeof U.toJSON&&(U=U.toJSON());for(var zt=Cc(U),Yt=Cc(S),Se=!1,we=Yt.length-1;we>=0;we--){var oi=S[ii=Yt[we]];if(!nc(U,ii)||void 0===U[ii]&&void 0!==oi&&!1===Array.isArray(U))Array.isArray(S)===Array.isArray(U)?(pt&&Y.push({op:"test",path:it+"/"+Ao(ii),value:_s(oi)}),Y.push({op:"remove",path:it+"/"+Ao(ii)}),Se=!0):(pt&&Y.push({op:"test",path:it,value:S}),Y.push({op:"replace",path:it,value:U}));else{var fi=U[ii];"object"==typeof oi&&null!=oi&&"object"==typeof fi&&null!=fi&&Array.isArray(oi)===Array.isArray(fi)?Al(oi,fi,Y,it+"/"+Ao(ii),pt):oi!==fi&&(pt&&Y.push({op:"test",path:it+"/"+Ao(ii),value:_s(oi)}),Y.push({op:"replace",path:it+"/"+Ao(ii),value:_s(fi)}))}}if(Se||zt.length!=Yt.length)for(we=0;we<zt.length;we++){var ii;!nc(S,ii=zt[we])&&void 0!==U[ii]&&Y.push({op:"add",path:it+"/"+Ao(ii),value:_s(U[ii])})}}}function zl(S,U,Y){void 0===Y&&(Y=!1);var it=[];return Al(S,U,it,"",Y),it}Object.assign({},C,m,{JsonPatchError:Gc,deepClone:_s,escapePathComponent:Ao,unescapePathComponent:Uc});var Ia=_(89986),jc=_.n(Ia),Ic=_(69380),uc=_.n(Ic);const cr={add:function wc(S,U){return{op:"add",path:S,value:U}},replace:Du,remove:function Yl(S){return{op:"remove",path:S}},merge:function Yc(S,U){return{type:"mutation",op:"merge",path:S,value:U}},mergeDeep:function rc(S,U){return{type:"mutation",op:"mergeDeep",path:S,value:U}},context:function su(S,U){return{type:"context",path:S,value:U}},getIn:function Hu(S,U){return U.reduce(function(Y,it){return void 0!==it&&Y?Y[it]:Y},S)},applyPatch:function jl(S,U,Y){if(Y=Y||{},"merge"===(U=et(et({},U),{},{path:U.path&&kl(U.path)})).op){var it=Ue(S,U.path);It()(it,U.value),ta(S,[Du(U.path,it)])}else if("mergeDeep"===U.op){var pt=Ue(S,U.path);for(var zt in U.value){var Yt=U.value[zt],oe=Array.isArray(Yt);if(oe){var Se=pt[zt]||[];pt[zt]=Ee()(Se).call(Se,Yt)}else if(va(Yt)&&!oe){var we=et({},pt[zt]);for(var ii in Yt){if(Object.prototype.hasOwnProperty.call(we,ii)){we=jc()(uc()(we),Yt);break}It()(we,W({},ii,Yt[ii]))}pt[zt]=we}else pt[zt]=Yt}}else if("add"===U.op&&""===U.path&&va(U.value)){ta(S,je()(U.value).reduce(function(cn,xn){return cn.push({op:"add",path:"/".concat(kl(xn)),value:U.value[xn]}),cn},[]))}else if("replace"===U.op&&""===U.path){var Si=U.value;Y.allowMetaPatches&&U.meta&&Rt(U)&&(Array.isArray(U.value)||va(U.value))&&(Si=et(et({},Si),U.meta)),S=Si}else if(ta(S,[U]),Y.allowMetaPatches&&U.meta&&Rt(U)&&(Array.isArray(U.value)||va(U.value))){var sn=et(et({},Ue(S,U.path)),U.meta);ta(S,[Du(U.path,sn)])}return S},parentPathMatch:function Kc(S,U){if(!Array.isArray(U))return!1;for(var Y=0,it=U.length;Y<it;Y+=1)if(U[Y]!==S[Y])return!1;return!0},flatten:hl,fullyNormalizeArray:function yl(S){return hc(hl(Tl(S)))},normalizeArray:Tl,isPromise:function au(S){return va(S)&&Nl(S.then)},forEachNew:function Dc(S,U){try{return xl(S,tl,U)}catch(Y){return Y}},forEachNewPrimitive:function Xc(S,U){try{return xl(S,Ll,U)}catch(Y){return Y}},isJsonPatch:ms,isContextPatch:function te(S){return Re(S)&&"context"===S.type},isPatch:Re,isMutation:mt,isAdditiveMutation:Rt,isGenerator:function Mc(S){return"[object GeneratorFunction]"===Object.prototype.toString.call(S)},isFunction:Nl,isObject:va,isError:function Uu(S){return S instanceof Error}};function kl(S){return Array.isArray(S)?S.length<1?"":"/".concat(Dt()(S).call(S,function(U){return(U+"").replace(/~/g,"~0").replace(/\//g,"~1")}).join("/")):S}function Du(S,U,Y){return{op:"replace",path:S,value:U,meta:Y}}function xl(S,U,Y){var it;return hc(hl(Dt()(it=le()(S).call(S,Rt)).call(it,function(oe){return U(oe.value,Y,oe.path)})||[]))}function Ll(S,U,Y){return Y=Y||[],Array.isArray(S)?Dt()(S).call(S,function(pt,zt){return Ll(pt,U,Ee()(Y).call(Y,zt))}):va(S)?Dt()(it=je()(S)).call(it,function(pt){return Ll(S[pt],U,Ee()(Y).call(Y,pt))}):U(S,Y[Y.length-1],Y);var it}function tl(S,U,Y){var it=[];if((Y=Y||[]).length>0){var pt=U(S,Y[Y.length-1],Y);pt&&(it=Ee()(it).call(it,pt))}if(Array.isArray(S)){var zt=Dt()(S).call(S,function(Se,we){return tl(Se,U,Ee()(Y).call(Y,we))});zt&&(it=Ee()(it).call(it,zt))}else if(va(S)){var Yt,oe=Dt()(Yt=je()(S)).call(Yt,function(Se){return tl(S[Se],U,Ee()(Y).call(Y,Se))});oe&&(it=Ee()(it).call(it,oe))}return hl(it)}function Tl(S){return Array.isArray(S)?S:[S]}function hl(S){var U;return Ee()(U=[]).apply(U,Ja(Dt()(S).call(S,function(Y){return Array.isArray(Y)?hl(Y):Y})))}function hc(S){return le()(S).call(S,function(U){return void 0!==U})}function va(S){return S&&"object"===ct(S)}function Nl(S){return S&&"function"==typeof S}function ms(S){if(Re(S)){var U=S.op;return"add"===U||"remove"===U||"replace"===U}return!1}function mt(S){return ms(S)||Re(S)&&"mutation"===S.type}function Rt(S){return mt(S)&&("add"===S.op||"replace"===S.op||"merge"===S.op||"mergeDeep"===S.op)}function Re(S){return S&&"object"===ct(S)}function Ue(S,U){try{return Ml(S,U)}catch(Y){return console.error(Y),{}}}var ci=_(74580),Ze=_.n(ci),ai=_(79921),ki=_.n(ai);function Ai(S,U){function Y(){Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack;for(var it=arguments.length,pt=new Array(it),zt=0;zt<it;zt++)pt[zt]=arguments[zt];this.message=pt[0],U&&U.apply(this,pt)}return(Y.prototype=new Error).name=S,Y.prototype.constructor=Y,Y}var Vi=_(3394),to=_.n(Vi),zn=["properties"],ho=["properties"],Ur=["definitions","parameters","responses","securityDefinitions","components/schemas","components/responses","components/parameters","components/securitySchemes"],br=["schema/example","items/example"];function $o(S){var U=S[S.length-1],Y=S[S.length-2],it=S.join("/");return zn.indexOf(U)>-1&&-1===ho.indexOf(Y)||Ur.indexOf(it)>-1||br.some(function(pt){return it.indexOf(pt)>-1})}function Xr(S,U){var Y,pt=Lt(S.split("#"),2),Yt=pt[1],oe=Ut.resolve(pt[0]||"",U||"");return Yt?Ee()(Y="".concat(oe,"#")).call(Y,Yt):oe}var mr="application/json, application/yaml",ua=new RegExp("^([a-z]+://|//)","i"),rs=Ai("JSONRefError",function(U,Y,it){this.originalError=it,It()(this,Y||{})}),ws={},bl=new(Ze()),lu=[function(S){return"paths"===S[0]&&"responses"===S[3]&&"examples"===S[5]},function(S){return"paths"===S[0]&&"responses"===S[3]&&"content"===S[5]&&"example"===S[7]},function(S){return"paths"===S[0]&&"responses"===S[3]&&"content"===S[5]&&"examples"===S[7]&&"value"===S[9]},function(S){return"paths"===S[0]&&"requestBody"===S[3]&&"content"===S[4]&&"example"===S[6]},function(S){return"paths"===S[0]&&"requestBody"===S[3]&&"content"===S[4]&&"examples"===S[6]&&"value"===S[8]},function(S){return"paths"===S[0]&&"parameters"===S[2]&&"example"===S[4]},function(S){return"paths"===S[0]&&"parameters"===S[3]&&"example"===S[5]},function(S){return"paths"===S[0]&&"parameters"===S[2]&&"examples"===S[4]&&"value"===S[6]},function(S){return"paths"===S[0]&&"parameters"===S[3]&&"examples"===S[5]&&"value"===S[7]},function(S){return"paths"===S[0]&&"parameters"===S[2]&&"content"===S[4]&&"example"===S[6]},function(S){return"paths"===S[0]&&"parameters"===S[2]&&"content"===S[4]&&"examples"===S[6]&&"value"===S[8]},function(S){return"paths"===S[0]&&"parameters"===S[3]&&"content"===S[4]&&"example"===S[7]},function(S){return"paths"===S[0]&&"parameters"===S[3]&&"content"===S[5]&&"examples"===S[7]&&"value"===S[9]}],Vu={key:"$ref",plugin:function(U,Y,it,pt){var zt=pt.getInstance(),Yt=_a()(it).call(it,0,-1);if(!$o(Yt)&&!function(U){return lu.some(function(Y){return Y(U)})}(Yt)){var Se=pt.getContext(it).baseDoc;if("string"!=typeof U)return new rs("$ref: must be a string (JSON-Ref)",{$ref:U,baseDoc:Se,fullPath:it});var fi,Si,zi,we=dc(U),ii=we[0],oi=we[1]||"";try{fi=Se||ii?Ac(ii,Se):null}catch(en){return Jc(en,{pointer:oi,$ref:U,basePath:fi,fullPath:it})}if(function ju(S,U,Y,it){var pt,zt,Yt=bl.get(it);Yt||bl.set(it,Yt={});var oe=function zu(S){return 0===S.length?"":"/".concat(Dt()(S).call(S,uu).join("/"))}(Y),Se=Ee()(pt="".concat(U||"<specmap-base>","#")).call(pt,S),we=oe.replace(/allOf\/\d+\/?/g,"");if(U===it.contextTree.get([]).baseDoc&&ss(we,S))return!0;var oi="",fi=Y.some(function(Si){var zi;return oi=Ee()(zi="".concat(oi,"/")).call(zi,uu(Si)),Yt[oi]&&Yt[oi].some(function(sn){return ss(sn,Se)||ss(Se,sn)})});if(fi)return!0;Yt[we]=Ee()(zt=Yt[we]||[]).call(zt,Se)}(oi,fi,Yt,pt)&&!zt.useCircularStructures){var sn=Xr(U,fi);return U===sn?null:cr.replace(it,sn)}if(null==fi?(zi=cu(oi),void 0===(Si=pt.get(zi))&&(Si=new rs("Could not resolve reference: ".concat(U),{pointer:oi,$ref:U,baseDoc:Se,fullPath:it}))):Si=null!=(Si=oh(fi,oi)).__value?Si.__value:Si.catch(function(en){throw Jc(en,{pointer:oi,$ref:U,baseDoc:Se,fullPath:it})}),Si instanceof Error)return[cr.remove(it),Si];var cn=Xr(U,fi),xn=cr.replace(Yt,Si,{$$ref:cn});if(fi&&fi!==Se)return[xn,cr.context(Yt,{baseDoc:fi})];try{if(!function hu(S,U){var Y=[S];return U.path.reduce(function(pt,zt){return Y.push(pt[zt]),pt[zt]},S),function it(pt){return cr.isObject(pt)&&(Y.indexOf(pt)>=0||je()(pt).some(function(zt){return it(pt[zt])}))}(U.value)}(pt.state,xn)||zt.useCircularStructures)return xn}catch(en){return null}}}},Oc=It()(Vu,{docCache:ws,absoluteify:Ac,clearCache:function Mu(S){void 0!==S?delete ws[S]:je()(ws).forEach(function(U){delete ws[U]})},JSONRefError:rs,wrapError:Jc,getDoc:rh,split:dc,extractFromDoc:oh,fetchJSON:function Wu(S){return fetch(S,{headers:{Accept:mr},loadSpec:!0}).then(function(U){return U.text()}).then(function(U){return pr.load(U)})},extract:sh,jsonPointerToArray:cu,unescapeJsonPointerToken:pc});const Gu=Oc;function Ac(S,U){if(!ua.test(S)){var Y;if(!U)throw new rs(Ee()(Y="Tried to resolve a relative URL, without having a basePath. path: '".concat(S,"' basePath: '")).call(Y,U,"'"));return Ut.resolve(U,S)}return S}function Jc(S,U){var Y,it;return Y=S&&S.response&&S.response.body?Ee()(it="".concat(S.response.body.code," ")).call(it,S.response.body.message):S.message,new rs("Could not resolve reference: ".concat(Y),U,S)}function dc(S){return(S+"").split("#")}function oh(S,U){var Y=ws[S];if(Y&&!cr.isPromise(Y))try{var it=sh(U,Y);return It()(Is().resolve(it),{__value:it})}catch(pt){return Is().reject(pt)}return rh(S).then(function(pt){return sh(U,pt)})}function rh(S){var U=ws[S];return U?cr.isPromise(U)?U:Is().resolve(U):(ws[S]=Oc.fetchJSON(S).then(function(Y){return ws[S]=Y,Y}),ws[S])}function sh(S,U){var Y=cu(S);if(Y.length<1)return U;var it=cr.getIn(U,Y);if(void 0===it)throw new rs("Could not resolve pointer: ".concat(S," does not exist in document"),{pointer:S});return it}function cu(S){var U;if("string"!=typeof S)throw new TypeError("Expected a string, got a ".concat(ct(S)));return"/"===S[0]&&(S=S.substr(1)),""===S?[]:Dt()(U=S.split("/")).call(U,pc)}function pc(S){return"string"!=typeof S?S:new(ki())("=".concat(S.replace(/~1/g,"/").replace(/~0/g,"~"))).get("")}function uu(S){var U,Y=new(ki())([["",S.replace(/~/g,"~0").replace(/\//g,"~1")]]);return _a()(U=Y.toString()).call(U,1)}function ss(S,U){if(function(U){return!U||"/"===U||"#"===U}(U))return!0;var Y=S.charAt(U.length),it=_a()(U).call(U,-1);return 0===S.indexOf(U)&&(!Y||"/"===Y||"#"===Y)&&"#"!==it}var $c=_(65359),Sh=_.n($c);const ah={key:"allOf",plugin:function(U,Y,it,pt,zt){if(!zt.meta||!zt.meta.$$ref){var Yt=_a()(it).call(it,0,-1);if(!$o(Yt)){if(!Array.isArray(U)){var oe=new TypeError("allOf must be an array");return oe.fullPath=it,oe}var Se=!1,we=zt.value;if(Yt.forEach(function(fi){!we||(we=we[fi])}),we=et({},we),!Sh()(we)){delete we.allOf;var oi,ii=[];return ii.push(pt.replace(Yt,{})),U.forEach(function(fi,Si){if(!pt.isObject(fi)){if(Se)return null;Se=!0;var zi=new TypeError("Elements in allOf must be objects");return zi.fullPath=it,ii.push(zi)}ii.push(pt.mergeDeep(Yt,fi));var cn=function fr(S,U){var Y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},it=Y.specmap,pt=Y.getBaseUrlForNodePath,zt=void 0===pt?function(we){var ii;return it.getContext(Ee()(ii=[]).call(ii,Ja(U),Ja(we))).baseDoc}:pt,Yt=Y.targetKeys,oe=void 0===Yt?["$ref","$$ref"]:Yt,Se=[];return to()(S).forEach(function(){if(Di()(oe).call(oe,this.key)&&"string"==typeof this.node){var ii=this.path,oi=Ee()(U).call(U,this.path),fi=Xr(this.node,zt(ii));Se.push(it.replace(oi,fi))}}),Se}(fi,_a()(it).call(it,0,-1),{getBaseUrlForNodePath:function(en){var go;return pt.getContext(Ee()(go=[]).call(go,Ja(it),[Si],Ja(en))).baseDoc},specmap:pt});ii.push.apply(ii,Ja(cn))}),ii.push(pt.mergeDeep(Yt,we)),we.$$ref||ii.push(pt.remove(Ee()(oi=[]).call(oi,Yt,"$$ref"))),ii}}}}},Rh={key:"parameters",plugin:function(U,Y,it,pt){if(Array.isArray(U)&&U.length){var zt=It()([],U),Yt=_a()(it).call(it,0,-1),oe=et({},cr.getIn(pt.spec,Yt));return U.forEach(function(Se,we){try{zt[we].default=pt.parameterMacro(oe,Se)}catch(oi){var ii=new Error(oi);return ii.fullPath=it,ii}}),cr.replace(it,zt)}return cr.replace(it,U)}},Ih={key:"properties",plugin:function(U,Y,it,pt){var zt=et({},U);for(var Yt in U)try{zt[Yt].default=pt.modelPropertyMacro(zt[Yt])}catch(we){var oe=new Error(we);return oe.fullPath=it,oe}return cr.replace(it,zt)}};var wh=function(){function S(U){Hc(this,S),this.root=Ou(U||{})}return Wo(S,[{key:"set",value:function(Y,it){var pt=this.getParent(Y,!0);if(pt){var zt=Y[Y.length-1],Yt=pt.children;Yt[zt]?Au(Yt[zt],it,pt):Yt[zt]=Ou(it,pt)}else Au(this.root,it,null)}},{key:"get",value:function(Y){if((Y=Y||[]).length<1)return this.root.value;for(var pt,zt,it=this.root,Yt=0;Yt<Y.length&&(pt=it.children)[zt=Y[Yt]];Yt+=1)it=pt[zt];return it&&it.protoValue}},{key:"getParent",value:function(Y,it){return!Y||Y.length<1?null:Y.length<2?this.root:_a()(Y).call(Y,0,-1).reduce(function(pt,zt){if(!pt)return pt;var Yt=pt.children;return!Yt[zt]&&it&&(Yt[zt]=Ou(null,pt)),Yt[zt]},this.root)}}]),S}();function Ou(S,U){return Au({children:{}},S,U)}function Au(S,U,Y){return S.value=U||{},S.protoValue=Y?et(et({},Y.protoValue),S.value):S.value,je()(S.children).forEach(function(it){var pt=S.children[it];S.children[it]=Au(pt,pt.value,S)}),S}var fc=function(){},wa=function(){function S(U){var it,pt,Y=this;Hc(this,S),It()(this,{spec:"",debugLevel:"info",plugins:[],pluginHistory:{},errors:[],mutations:[],promisedPatches:[],state:{},patches:[],context:{},contextTree:new wh,showDebug:!1,allPatches:[],pluginProp:"specMap",libMethods:It()(Object.create(this),cr,{getInstance:function(){return Y}}),allowMetaPatches:!1},U),this.get=this._get.bind(this),this.getContext=this._getContext.bind(this),this.hasRun=this._hasRun.bind(this),this.wrappedPlugins=le()(it=Dt()(pt=this.plugins).call(pt,this.wrapPlugin.bind(this))).call(it,cr.isFunction),this.patches.push(cr.add([],this.spec)),this.patches.push(cr.context([],this.context)),this.updatePatches(this.patches)}return Wo(S,[{key:"debug",value:function(Y){if(this.debugLevel===Y){for(var it,pt=arguments.length,zt=new Array(pt>1?pt-1:0),Yt=1;Yt<pt;Yt++)zt[Yt-1]=arguments[Yt];(it=console).log.apply(it,zt)}}},{key:"verbose",value:function(Y){if("verbose"===this.debugLevel){for(var it,pt,zt=arguments.length,Yt=new Array(zt>1?zt-1:0),oe=1;oe<zt;oe++)Yt[oe-1]=arguments[oe];(it=console).log.apply(it,Ee()(pt=["[".concat(Y,"]   ")]).call(pt,Yt))}}},{key:"wrapPlugin",value:function(Y,it){var Yt,pt=this.pathDiscriminator,zt=null;return Y[this.pluginProp]?(zt=Y,Yt=Y[this.pluginProp]):cr.isFunction(Y)?Yt=Y:cr.isObject(Y)&&(Yt=function oe(Se){var we=function(oi,fi){return!Array.isArray(oi)||oi.every(function(Si,zi){return Si===fi[zi]})};return Ne().mark(function ii(oi,fi){var Si,zi,sn,cn,xn,en;return Ne().wrap(function(ko){for(;;)switch(ko.prev=ko.next){case 0:en=function(gr,re,qr){var Ba,cs,Ms,jo,Gs,ea,_c,mc,Xu,Wh,od,Jl,rd;return Ne().wrap(function(Ha){for(;;)switch(Ha.prev=Ha.next){case 0:if(cr.isObject(gr)){Ha.next=6;break}if(Se.key!==re[re.length-1]){Ha.next=4;break}return Ha.next=4,Se.plugin(gr,Se.key,re,fi);case 4:Ha.next=30;break;case 6:cs=re[Ba=re.length-1],Ms=re.indexOf("properties"),jo="properties"===cs&&Ba===Ms,Gs=fi.allowMetaPatches&&zi[gr.$$ref],ea=0,_c=je()(gr);case 12:if(!(ea<_c.length)){Ha.next=30;break}if(Xu=gr[mc=_c[ea]],Wh=Ee()(re).call(re,mc),od=cr.isObject(Xu),Jl=gr.$$ref,Gs){Ha.next=22;break}if(!od){Ha.next=22;break}return fi.allowMetaPatches&&Jl&&(zi[Jl]=!0),Ha.delegateYield(en(Xu,Wh,qr),"t0",22);case 22:if(jo||mc!==Se.key){Ha.next=27;break}if(rd=we(pt,re),pt&&!rd){Ha.next=27;break}return Ha.next=27,Se.plugin(Xu,mc,Wh,fi,qr);case 27:ea++,Ha.next=12;break;case 30:case"end":return Ha.stop()}},Si)},Si=Ne().mark(en),zi={},sn=Mt(le()(oi).call(oi,cr.isAdditiveMutation)),ko.prev=4,sn.s();case 6:if((cn=sn.n()).done){ko.next=11;break}return ko.delegateYield(en((xn=cn.value).value,xn.path,xn),"t0",9);case 9:ko.next=6;break;case 11:ko.next=16;break;case 13:ko.prev=13,ko.t1=ko.catch(4),sn.e(ko.t1);case 16:return ko.prev=16,sn.f(),ko.finish(16);case 19:case"end":return ko.stop()}},ii,null,[[4,13,16,19]])})}(Y)),It()(Yt.bind(zt),{pluginName:Y.name||it,isGenerator:cr.isGenerator(Yt)})}},{key:"nextPlugin",value:function(){var Y,it=this;return Il()(Y=this.wrappedPlugins).call(Y,function(pt){return it.getMutationsForPlugin(pt).length>0})}},{key:"nextPromisedPatch",value:function(){var Y;if(this.promisedPatches.length>0)return Is().race(Dt()(Y=this.promisedPatches).call(Y,function(it){return it.value}))}},{key:"getPluginHistory",value:function(Y){var it=this.constructor.getPluginName(Y);return this.pluginHistory[it]||[]}},{key:"getPluginRunCount",value:function(Y){return this.getPluginHistory(Y).length}},{key:"getPluginHistoryTip",value:function(Y){var it=this.getPluginHistory(Y);return it&&it[it.length-1]||{}}},{key:"getPluginMutationIndex",value:function(Y){var it=this.getPluginHistoryTip(Y).mutationIndex;return"number"!=typeof it?-1:it}},{key:"updatePluginHistory",value:function(Y,it){var pt=this.constructor.getPluginName(Y);this.pluginHistory[pt]=this.pluginHistory[pt]||[],this.pluginHistory[pt].push(it)}},{key:"updatePatches",value:function(Y){var it=this;cr.normalizeArray(Y).forEach(function(pt){if(pt instanceof Error)it.errors.push(pt);else try{if(!cr.isObject(pt))return void it.debug("updatePatches","Got a non-object patch",pt);if(it.showDebug&&it.allPatches.push(pt),cr.isPromise(pt.value))return it.promisedPatches.push(pt),void it.promisedPatchThen(pt);if(cr.isContextPatch(pt))return void it.setContext(pt.path,pt.value);if(cr.isMutation(pt))return void it.updateMutations(pt)}catch(zt){console.error(zt),it.errors.push(zt)}})}},{key:"updateMutations",value:function(Y){"object"===ct(Y.value)&&!Array.isArray(Y.value)&&this.allowMetaPatches&&(Y.value=et({},Y.value));var it=cr.applyPatch(this.state,Y,{allowMetaPatches:this.allowMetaPatches});it&&(this.mutations.push(Y),this.state=it)}},{key:"removePromisedPatch",value:function(Y){var it,pt=this.promisedPatches.indexOf(Y);pt<0?this.debug("Tried to remove a promisedPatch that isn't there!"):ic()(it=this.promisedPatches).call(it,pt,1)}},{key:"promisedPatchThen",value:function(Y){var it=this;return Y.value=Y.value.then(function(pt){var zt=et(et({},Y),{},{value:pt});it.removePromisedPatch(Y),it.updatePatches(zt)}).catch(function(pt){it.removePromisedPatch(Y),it.updatePatches(pt)}),Y.value}},{key:"getMutations",value:function(Y,it){var pt;return Y=Y||0,"number"!=typeof it&&(it=this.mutations.length),_a()(pt=this.mutations).call(pt,Y,it)}},{key:"getCurrentMutations",value:function(){return this.getMutationsForPlugin(this.getCurrentPlugin())}},{key:"getMutationsForPlugin",value:function(Y){var it=this.getPluginMutationIndex(Y);return this.getMutations(it+1)}},{key:"getCurrentPlugin",value:function(){return this.currentPlugin}},{key:"getLib",value:function(){return this.libMethods}},{key:"_get",value:function(Y){return cr.getIn(this.state,Y)}},{key:"_getContext",value:function(Y){return this.contextTree.get(Y)}},{key:"setContext",value:function(Y,it){return this.contextTree.set(Y,it)}},{key:"_hasRun",value:function(Y){return this.getPluginRunCount(this.getCurrentPlugin())>(Y||0)}},{key:"dispatch",value:function(){var oe,Y=this,it=this,pt=this.nextPlugin();if(!pt){var zt=this.nextPromisedPatch();if(zt)return zt.then(function(){return Y.dispatch()}).catch(function(){return Y.dispatch()});var Yt={spec:this.state,errors:this.errors};return this.showDebug&&(Yt.patches=this.allPatches),Is().resolve(Yt)}if(it.pluginCount=it.pluginCount||{},it.pluginCount[pt]=(it.pluginCount[pt]||0)+1,it.pluginCount[pt]>100)return Is().resolve({spec:it.state,errors:Ee()(oe=it.errors).call(oe,new Error("We've reached a hard limit of ".concat(100," plugin runs")))});if(pt!==this.currentPlugin&&this.promisedPatches.length){var Se,we=Dt()(Se=this.promisedPatches).call(Se,function(fi){return fi.value});return Is().all(Dt()(we).call(we,function(fi){return fi.then(fc,fc)})).then(function(){return Y.dispatch()})}return function ii(){it.currentPlugin=pt;var fi=it.getCurrentMutations(),Si=it.mutations.length-1;try{if(pt.isGenerator){var sn,zi=Mt(pt(fi,it.getLib()));try{for(zi.s();!(sn=zi.n()).done;)oi(sn.value)}catch(en){zi.e(en)}finally{zi.f()}}else oi(pt(fi,it.getLib()))}catch(en){console.error(en),oi([It()(Object.create(en),{plugin:pt})])}finally{it.updatePluginHistory(pt,{mutationIndex:Si})}return it.dispatch()}();function oi(fi){fi&&(fi=cr.fullyNormalizeArray(fi),it.updatePatches(fi,pt))}}}],[{key:"getPluginName",value:function(Y){return Y.pluginName}},{key:"getPatchesOfType",value:function(Y,it){return le()(Y).call(Y,it)}}]),S}(),Xl={refs:Gu,allOf:ah,parameters:Rh,properties:Ih},lh=_(6264),ha=_.n(lh),Pl=function(U){return String.prototype.toLowerCase.call(U)},Qc=function(U){return U.replace(/[^\w]/gi,"_")};function du(S){var U=S.openapi;return!!U&&wt()(U).call(U,"3")}function kc(S,U){var Y=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",it=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},pt=it.v2OperationIdCompatibilityMode;if(!S||"object"!==ct(S))return null;var zt=(S.operationId||"").replace(/\s/g,"");return zt.length?Qc(S.operationId):ch(U,Y,{v2OperationIdCompatibilityMode:pt})}function ch(S,U){var Y,it=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},pt=it.v2OperationIdCompatibilityMode;if(pt){var zt,Yt,oe=Ee()(zt="".concat(U.toLowerCase(),"_")).call(zt,S).replace(/[\s!@#$%^&*()_+=[{\]};:<>|./?,\\'""-]/g,"_");return(oe=oe||Ee()(Yt="".concat(S.substring(1),"_")).call(Yt,U)).replace(/((_){2,})/g,"_").replace(/^(_)*/g,"").replace(/([_])*$/g,"")}return Ee()(Y="".concat(Pl(U))).call(Y,Qc(S))}function zo(S,U){var Y;return Ee()(Y="".concat(Pl(U),"-")).call(Y,S)}function xc(S,U,Y){if(!S||"object"!==ct(S)||!S.paths||"object"!==ct(S.paths))return null;var it=S.paths;for(var pt in it)for(var zt in it[pt])if("PARAMETERS"!==zt.toUpperCase()){var Yt=it[pt][zt];if(Yt&&"object"===ct(Yt)){var oe={spec:S,pathName:pt,method:zt.toUpperCase(),operation:Yt},Se=U(oe);if(Y&&Se)return oe}}}function El(S){var U=S.spec,Y=U.paths,it={};if(!Y||U.$$normalized)return S;for(var pt in Y){var zt=Y[pt];if(ha()(zt)){var Yt=zt.parameters,oe=function(oi){var fi=zt[oi];if(!ha()(fi))return"continue";var Si=kc(fi,pt,oi);if(Si){it[Si]?it[Si].push(fi):it[Si]=[fi];var zi=it[Si];if(zi.length>1)zi.forEach(function(cs,Ms){var jo;cs.__originalOperationId=cs.__originalOperationId||cs.operationId,cs.operationId=Ee()(jo="".concat(Si)).call(jo,Ms+1)});else if(void 0!==fi.operationId){var sn=zi[0];sn.__originalOperationId=sn.__originalOperationId||fi.operationId,sn.operationId=Si}}if("parameters"!==oi){var cn=[],xn={};for(var en in U)("produces"===en||"consumes"===en||"security"===en)&&(xn[en]=U[en],cn.push(xn));if(Yt&&(xn.parameters=Yt,cn.push(xn)),cn.length){var ko,go=Mt(cn);try{for(go.s();!(ko=go.n()).done;){var Qr=ko.value;for(var gr in Qr)if(fi[gr]){if("parameters"===gr){var qr,re=Mt(Qr[gr]);try{var Ba=function(){var Ms=qr.value;fi[gr].some(function(Gs){return Gs.name&&Gs.name===Ms.name||Gs.$ref&&Gs.$ref===Ms.$ref||Gs.$$ref&&Gs.$$ref===Ms.$$ref||Gs===Ms})||fi[gr].push(Ms)};for(re.s();!(qr=re.n()).done;)Ba()}catch(cs){re.e(cs)}finally{re.f()}}}else fi[gr]=Qr[gr]}}catch(cs){go.e(cs)}finally{go.f()}}}};for(var Se in zt)oe(Se)}}return U.$$normalized=!0,S}function Lc(S){var U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},Y=U.requestInterceptor,it=U.responseInterceptor,pt=S.withCredentials?"include":"same-origin";return function(zt){return S({url:zt,loadSpec:!0,requestInterceptor:Y,responseInterceptor:it,headers:{Accept:mr},credentials:pt}).then(function(Yt){return Yt.body})}}function ku(S){var Y=S.spec,pt=S.mode,zt=S.allowMetaPatches,Yt=void 0===zt||zt,oe=S.pathDiscriminator,Se=S.modelPropertyMacro,we=S.parameterMacro,ii=S.requestInterceptor,oi=S.responseInterceptor,fi=S.skipNormalization,Si=S.useCircularStructures,zi=S.http,sn=S.baseDoc;return sn=sn||S.url,zi=S.fetch||zi||Cu,Y?cn(Y):Lc(zi,{requestInterceptor:ii,responseInterceptor:oi})(sn).then(cn);function cn(xn){sn&&(Xl.refs.docCache[sn]=xn),Xl.refs.fetchJSON=Lc(zi,{requestInterceptor:ii,responseInterceptor:oi});var en=[Xl.refs];return"function"==typeof we&&en.push(Xl.parameters),"function"==typeof Se&&en.push(Xl.properties),"strict"!==pt&&en.push(Xl.allOf),function Zc(S){return new wa(S).dispatch()}({spec:xn,context:{baseDoc:sn},plugins:en,allowMetaPatches:Yt,pathDiscriminator:oe,parameterMacro:we,modelPropertyMacro:Se,useCircularStructures:Si}).then(fi?function(){var go=ce(Ne().mark(function ko(Qr){return Ne().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.abrupt("return",Qr);case 1:case"end":return re.stop()}},ko)}));return function(ko){return go.apply(this,arguments)}}():El)}}var uh=_(36817),Kl=_.n(uh);function qc(){return qc=ce(Ne().mark(function S(U,Y){var it,pt,oi,fi,Si,zi,sn=arguments;return Ne().wrap(function(xn){for(;;)switch(xn.prev=xn.next){case 0:return pt=(it=sn.length>2&&void 0!==sn[2]?sn[2]:{}).returnEntireTree,oi={pathDiscriminator:Y,baseDoc:it.baseDoc,requestInterceptor:it.requestInterceptor,responseInterceptor:it.responseInterceptor,parameterMacro:it.parameterMacro,modelPropertyMacro:it.modelPropertyMacro,useCircularStructures:it.useCircularStructures},fi=El({spec:U}),Si=fi.spec,xn.next=6,ku(et(et({},oi),{},{spec:Si,allowMetaPatches:!0,skipNormalization:!0}));case 6:return zi=xn.sent,!pt&&Array.isArray(Y)&&Y.length&&(zi.spec=Kl()(zi.spec,Y)||null),xn.abrupt("return",zi);case 9:case"end":return xn.stop()}},S)})),qc.apply(this,arguments)}var Yu=function(){return null},_u_mapTagOperations=function Pa(S){var U=S.spec,Y=S.cb,it=void 0===Y?Yu:Y,pt=S.defaultTag,zt=void 0===pt?"default":pt,Yt=S.v2OperationIdCompatibilityMode,oe={},Se={};return xc(U,function(we){var ii=we.pathName,oi=we.method,fi=we.operation,Si=fi.tags?function(U){return Array.isArray(U)?U:[U]}(fi.tags):[zt];Si.forEach(function(zi){if("string"==typeof zi){Se[zi]=Se[zi]||{};var en,sn=Se[zi],cn=kc(fi,ii,oi,{v2OperationIdCompatibilityMode:Yt}),xn=it({spec:U,pathName:ii,method:oi,operation:fi,operationId:cn});if(oe[cn])oe[cn]+=1,sn[Ee()(en="".concat(cn)).call(en,oe[cn])]=xn;else if(void 0!==sn[cn]){var go,ko,Qr=oe[cn]||1;oe[cn]=Qr+1,sn[Ee()(go="".concat(cn)).call(go,oe[cn])]=xn;var gr=sn[cn];delete sn[cn],sn[Ee()(ko="".concat(cn)).call(ko,Qr)]=gr}else sn[cn]=xn}})}),Se},_u_makeExecute=function ur(){var S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(U){var Y=U.pathName,it=U.method,pt=U.operationId;return function(zt){var Yt=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},oe=S.requestInterceptor,Se=S.responseInterceptor,we=S.userFetch;return S.execute(et({spec:S.spec,requestInterceptor:oe,responseInterceptor:Se,userFetch:we,pathName:Y,method:it,parameters:zt,operationId:pt},Yt))}}},Fl=_(25918);var vs=_(27935),dh=_.n(vs),ph=_(88941);const fh={body:function Lu(S){S.req.body=S.value},header:function E(S){var U=S.req,Y=S.parameter,it=S.value;U.headers=U.headers||{},void 0!==it&&(U.headers[Y.name]=it)},query:function D(S){var U=S.req,Y=S.value,it=S.parameter;if(U.query=U.query||{},!1===Y&&"boolean"===it.type&&(Y="false"),0===Y&&["number","integer"].indexOf(it.type)>-1&&(Y="0"),Y)U.query[it.name]={collectionFormat:it.collectionFormat,value:Y};else if(it.allowEmptyValue&&void 0!==Y){var pt=it.name;U.query[pt]=U.query[pt]||{},U.query[pt].allowEmptyValue=!0}},path:function M(S){var U=S.req,Y=S.value;U.url=U.url.split("{".concat(S.parameter.name,"}")).join(encodeURIComponent(Y))},formData:function f(S){var U=S.req,Y=S.value,it=S.parameter;(Y||it.allowEmptyValue)&&(U.form=U.form||{},U.form[it.name]={value:Y,allowEmptyValue:it.allowEmptyValue,collectionFormat:it.collectionFormat})}};function P(S,U){return Di()(U).call(U,"application/json")?"string"==typeof S?S:Xt()(S):S.toString()}function K(S){var U=S.req,Y=S.value,it=S.parameter,pt=it.name,zt=it.style,Yt=it.explode,oe=it.content;if(oe){var Se=je()(oe)[0];U.url=U.url.split("{".concat(pt,"}")).join(Rr(P(Y,Se),{escape:!0}))}else{var we=Dr({key:it.name,value:Y,style:zt||"simple",explode:Yt||!1,escape:!0});U.url=U.url.split("{".concat(pt,"}")).join(we)}}function ut(S){var U=S.req,Y=S.value,it=S.parameter;if(U.query=U.query||{},it.content){var pt=je()(it.content)[0];U.query[it.name]=P(Y,pt)}else if(!1===Y&&(Y="false"),0===Y&&(Y="0"),Y)U.query[it.name]={value:Y,serializationOption:{style:it.style,explode:it.explode,allowReserved:it.allowReserved}};else if(it.allowEmptyValue&&void 0!==Y){var Se=it.name;U.query[Se]=U.query[Se]||{},U.query[Se].allowEmptyValue=!0}}var St=["accept","authorization","content-type"];function Ht(S){var U=S.req,Y=S.parameter,it=S.value;if(U.headers=U.headers||{},!(St.indexOf(Y.name.toLowerCase())>-1)){if(Y.content){var pt=je()(Y.content)[0];return void(U.headers[Y.name]=P(it,pt))}void 0!==it&&(U.headers[Y.name]=Dr({key:Y.name,value:it,style:Y.style||"simple",explode:void 0!==Y.explode&&Y.explode,escape:!1}))}}function $t(S){var U=S.req,Y=S.parameter,it=S.value;U.headers=U.headers||{};var pt=ct(it);if(Y.content){var zt,Yt=je()(Y.content)[0];U.headers.Cookie=Ee()(zt="".concat(Y.name,"=")).call(zt,P(it,Yt))}else if("undefined"!==pt){var oe="object"===pt&&!Array.isArray(it)&&Y.explode?"":"".concat(Y.name,"=");U.headers.Cookie=oe+Dr({key:Y.name,value:it,escape:!1,style:Y.style||"form",explode:void 0!==Y.explode&&Y.explode})}}var ke=_(34686),ze=_.n(ke);var ln=["http","fetch","spec","operationId","pathName","method","parameters","securities"],vn=function(U){return Array.isArray(U)?U:[]},Dn=Ai("OperationNotFoundError",function(U,Y,it){this.originalError=it,It()(this,Y||{})}),eo={buildRequest:Ro};function Ro(S){var U,Y,it=S.spec,pt=S.operationId,zt=S.responseContentType,Yt=S.scheme,oe=S.requestInterceptor,Se=S.responseInterceptor,we=S.contextUrl,ii=S.userFetch,oi=S.server,fi=S.serverVariables,Si=S.http,zi=S.parameters,sn=S.parameterBuilders,cn=du(it);sn||(sn=cn?e:fh);var en={url:"",credentials:Si&&Si.withCredentials?"include":"same-origin",headers:{},cookies:{}};oe&&(en.requestInterceptor=oe),Se&&(en.responseInterceptor=Se),ii&&(en.userFetch=ii);var go=function Oh(S,U){return S&&S.paths?function pu(S,U){return xc(S,U,!0)||null}(S,function(Y){var it=Y.pathName,pt=Y.method,zt=Y.operation;if(!zt||"object"!==ct(zt))return!1;var Yt=zt.operationId;return[kc(zt,it,pt),zo(it,pt),Yt].some(function(we){return we&&we===U})}):null}(it,pt);if(!go)throw new Dn("Operation ".concat(pt," not found"));var ko=go.operation,Qr=void 0===ko?{}:ko,gr=go.method,re=go.pathName;if(en.url+=Ds({spec:it,scheme:Yt,contextUrl:we,server:oi,serverVariables:fi,pathName:re,method:gr}),!pt)return delete en.cookies,en;en.url+=re,en.method="".concat(gr).toUpperCase(),zi=zi||{};var qr=it.paths[re]||{};zt&&(en.headers.accept=zt);var Ba=function(U){var Y={};U.forEach(function(pt){Y[pt.in]||(Y[pt.in]={}),Y[pt.in][pt.name]=pt});var it=[];return je()(Y).forEach(function(pt){je()(Y[pt]).forEach(function(zt){it.push(Y[pt][zt])})}),it}(Ee()(U=Ee()(Y=[]).call(Y,vn(Qr.parameters))).call(U,vn(qr.parameters)));Ba.forEach(function(jo){var ea,_c,Gs=sn[jo.in];if("body"===jo.in&&jo.schema&&jo.schema.properties&&(ea=zi),void 0===(ea=jo&&jo.name&&zi[jo.name]))ea=jo&&jo.name&&zi[Ee()(_c="".concat(jo.in,".")).call(_c,jo.name)];else if(function(U,Y){return le()(Y).call(Y,function(it){return it.name===U})}(jo.name,Ba).length>1){var mc;console.warn(Ee()(mc="Parameter '".concat(jo.name,"' is ambiguous because the defined spec has more than one parameter with the name: '")).call(mc,jo.name,"' and the passed-in parameter values did not define an 'in' value."))}if(null!==ea){if(void 0!==jo.default&&void 0===ea&&(ea=jo.default),void 0===ea&&jo.required&&!jo.allowEmptyValue)throw new Error("Required parameter ".concat(jo.name," is not provided"));if(cn&&jo.schema&&"object"===jo.schema.type&&"string"==typeof ea)try{ea=JSON.parse(ea)}catch(Xu){throw new Error("Could not parse object parameter value string as JSON")}Gs&&Gs({req:en,parameter:jo,value:ea,operation:Qr,spec:it})}});var cs=et(et({},S),{},{operation:Qr});if((en=cn?function pi(S,U){var Y=S.operation,it=S.requestBody,Yt=S.attachContentTypeForEmptyPayload,oe=S.requestContentType;U=function ui(S){var U=S.request,Y=S.securities,it=void 0===Y?{}:Y,pt=S.operation,zt=void 0===pt?{}:pt,Yt=S.spec,oe=et({},U),Se=it.authorized,we=void 0===Se?{}:Se,ii=zt.security||Yt.security||[],oi=we&&!!je()(we).length,fi=Kl()(Yt,["components","securitySchemes"])||{};return oe.headers=oe.headers||{},oe.query=oe.query||{},je()(it).length&&oi&&ii&&(!Array.isArray(zt.security)||zt.security.length)?(ii.forEach(function(Si){je()(Si).forEach(function(zi){var sn=we[zi],cn=fi[zi];if(sn){var xn=sn.value||sn,en=cn.type;if(sn)if("apiKey"===en)"query"===cn.in&&(oe.query[cn.name]=xn),"header"===cn.in&&(oe.headers[cn.name]=xn),"cookie"===cn.in&&(oe.cookies[cn.name]=xn);else if("http"===en){if(/^basic$/i.test(cn.scheme)){var go,ko=xn.username||"",Qr=xn.password||"",gr=ze()(Ee()(go="".concat(ko,":")).call(go,Qr));oe.headers.Authorization="Basic ".concat(gr)}/^bearer$/i.test(cn.scheme)&&(oe.headers.Authorization="Bearer ".concat(xn))}else if("oauth2"===en||"openIdConnect"===en){var re,qr=sn.token||{},cs=qr[cn["x-tokenName"]||"access_token"],Ms=qr.token_type;(!Ms||"bearer"===Ms.toLowerCase())&&(Ms="Bearer"),oe.headers.Authorization=Ee()(re="".concat(Ms," ")).call(re,cs)}}})}),oe):U}({request:U,securities:S.securities,operation:Y,spec:S.spec});var Se=Y.requestBody||{},we=je()(Se.content||{}),ii=oe&&we.indexOf(oe)>-1;if(it||Yt){if(oe&&ii)U.headers["Content-Type"]=oe;else if(!oe){var oi=we[0];oi&&(U.headers["Content-Type"]=oi,oe=oi)}}else oe&&ii&&(U.headers["Content-Type"]=oe);if(!S.responseContentType&&Y.responses){var fi,Si=le()(fi=ee()(Y.responses)).call(fi,function(sn){var cn=Lt(sn,2),en=cn[1],go=parseInt(cn[0],10);return go>=200&&go<300&&dh()(en.content)}).reduce(function(sn,cn){var en=Lt(cn,2)[1];return Ee()(sn).call(sn,je()(en.content))},[]);Si.length>0&&(U.headers.accept=Si.join(", "))}if(it)if(oe){if(we.indexOf(oe)>-1)if("application/x-www-form-urlencoded"===oe||"multipart/form-data"===oe)if("object"===ct(it)){var zi=(Se.content[oe]||{}).encoding||{};U.form={},je()(it).forEach(function(sn){U.form[sn]={value:it[sn],encoding:zi[sn]||{}}})}else U.form=it;else U.body=it}else U.body=it;return U}(cs,en):function xi(S,U){var Se,we,Y=S.spec,it=S.operation,zt=S.requestContentType,Yt=S.responseContentType,oe=S.attachContentTypeForEmptyPayload;if(U=function ji(S){var U=S.request,Y=S.securities,it=void 0===Y?{}:Y,pt=S.operation,zt=void 0===pt?{}:pt,Yt=S.spec,oe=et({},U),Se=it.authorized,we=void 0===Se?{}:Se,ii=it.specSecurity,fi=zt.security||(void 0===ii?[]:ii),Si=we&&!!je()(we).length,zi=Yt.securityDefinitions;return oe.headers=oe.headers||{},oe.query=oe.query||{},je()(it).length&&Si&&fi&&(!Array.isArray(zt.security)||zt.security.length)?(fi.forEach(function(sn){je()(sn).forEach(function(cn){var xn=we[cn];if(xn){var en=xn.token,go=xn.value||xn,ko=zi[cn],Qr=ko.type,re=en&&en[ko["x-tokenName"]||"access_token"],qr=en&&en.token_type;if(xn)if("apiKey"===Qr){var Ba="query"===ko.in?"query":"headers";oe[Ba]=oe[Ba]||{},oe[Ba][ko.name]=go}else if("basic"===Qr)if(go.header)oe.headers.authorization=go.header;else{var cs,Ms=go.username||"",jo=go.password||"";go.base64=ze()(Ee()(cs="".concat(Ms,":")).call(cs,jo)),oe.headers.authorization="Basic ".concat(go.base64)}else if("oauth2"===Qr&&re){var Gs;qr=qr&&"bearer"!==qr.toLowerCase()?qr:"Bearer",oe.headers.authorization=Ee()(Gs="".concat(qr," ")).call(Gs,re)}}})}),oe):U}({request:U,securities:S.securities,operation:it,spec:Y}),U.body||U.form||oe)if(zt)U.headers["Content-Type"]=zt;else if(Array.isArray(it.consumes)){var ii=Lt(it.consumes,1);U.headers["Content-Type"]=ii[0]}else if(Array.isArray(Y.consumes)){var oi=Lt(Y.consumes,1);U.headers["Content-Type"]=oi[0]}else it.parameters&&le()(Se=it.parameters).call(Se,function(cn){return"file"===cn.type}).length?U.headers["Content-Type"]="multipart/form-data":it.parameters&&le()(we=it.parameters).call(we,function(cn){return"formData"===cn.in}).length&&(U.headers["Content-Type"]="application/x-www-form-urlencoded");else if(zt){var fi,Si,zi=it.parameters&&le()(fi=it.parameters).call(fi,function(cn){return"body"===cn.in}).length>0,sn=it.parameters&&le()(Si=it.parameters).call(Si,function(cn){return"formData"===cn.in}).length>0;(zi||sn)&&(U.headers["Content-Type"]=zt)}return!Yt&&Array.isArray(it.produces)&&it.produces.length>0&&(U.headers.accept=it.produces.join(", ")),U}(cs,en)).cookies&&je()(en.cookies).length){var Ms=je()(en.cookies).reduce(function(jo,Gs){return jo+(jo?"&":"")+ph.serialize(Gs,en.cookies[Gs])},"");en.headers.Cookie=Ms}return en.cookies&&delete en.cookies,La(en),en}var Er=function(U){return U?U.replace(/\W/g,""):null};function Ds(S){return du(S.spec)?function Vr(S){var U=S.spec,Y=S.pathName,it=S.method,pt=S.server,zt=S.contextUrl,Yt=S.serverVariables,oe=void 0===Yt?{}:Yt,Se=Kl()(U,["paths",Y,(it||"").toLowerCase(),"servers"])||Kl()(U,["paths",Y,"servers"])||Kl()(U,["servers"]),we="",ii=null;if(pt&&Se&&Se.length){var oi=Dt()(Se).call(Se,function(zi){return zi.url});oi.indexOf(pt)>-1&&(we=pt,ii=Se[oi.indexOf(pt)])}if(!we&&Se&&Se.length){we=Se[0].url;var fi=Lt(Se,1);ii=fi[0]}if(we.indexOf("{")>-1){var Si=function Fa(S){for(var it,U=[],Y=/{([^}]+)}/g;it=Y.exec(S);)U.push(it[1]);return U}(we);Si.forEach(function(zi){if(ii.variables&&ii.variables[zi]){var cn=oe[zi]||ii.variables[zi].default,xn=new RegExp("{".concat(zi,"}"),"g");we=we.replace(xn,cn)}})}return function Da(){var oe,Se,S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",U=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",Y=Ut.parse(S&&U?Ut.resolve(U,S):S),it=Ut.parse(U),pt=Er(Y.protocol)||Er(it.protocol)||"",zt=Y.host||it.host,Yt=Y.pathname||"";return"/"===(oe=pt&&zt?Ee()(Se="".concat(pt,"://")).call(Se,zt+Yt):Yt)[oe.length-1]?_a()(oe).call(oe,0,-1):oe}(we,zt)}(S):function ys(S){var ii,oi,U=S.spec,Y=S.scheme,it=S.contextUrl,zt=Ut.parse(void 0===it?"":it),Yt=Array.isArray(U.schemes)?U.schemes[0]:null,oe=Y||Yt||Er(zt.protocol)||"http",Se=U.host||zt.host||"",we=U.basePath||"";return"/"===(ii=oe&&Se?Ee()(oi="".concat(oe,"://")).call(oi,Se+we):we)[ii.length-1]?_a()(ii).call(ii,0,-1):ii}(S)}function Xo(S){var U=this,Y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof S?Y.url=S:Y=S,!(this instanceof Xo))return new Xo(Y);It()(this,Y);var it=this.resolve().then(function(){return U.disableInterfaces||It()(U,Xo.makeApisTagOperation(U)),U});return it.client=this,it}Xo.makeHttp=function Ec(S,U,Y){return Y=Y||function(it){return it},U=U||function(it){return it},function(it){return"string"==typeof it&&(it={url:it}),Fu.mergeInQueryOrForm(it),it=U(it),Y(S(it))}}.bind(null,Xo.http=Cu),Xo.resolve=ku,Xo.resolveSubtree=function gu(S,U){return qc.apply(this,arguments)},Xo.execute=function Zn(S){var U=S.http,Y=S.fetch,it=S.spec,pt=S.operationId,zt=S.pathName,Yt=S.method,oe=S.parameters,Se=S.securities,we=function hh(S,U){if(null==S)return{};var it,pt,Y=function xu(S,U){if(null==S)return{};var pt,zt,Y={},it=t(S);for(zt=0;zt<it.length;zt++)pt=it[zt],!(Fl(U).call(U,pt)>=0)&&(Y[pt]=S[pt]);return Y}(S,U);if(n){var zt=n(S);for(pt=0;pt<zt.length;pt++)it=zt[pt],!(Fl(U).call(U,it)>=0)&&(!Object.prototype.propertyIsEnumerable.call(S,it)||(Y[it]=S[it]))}return Y}(S,ln),ii=U||Y||Cu;zt&&Yt&&!pt&&(pt=zo(zt,Yt));var oi=eo.buildRequest(et({spec:it,operationId:pt,parameters:oe,securities:Se,http:ii},we));return oi.body&&(dh()(oi.body)||Array.isArray(oi.body))&&(oi.body=Xt()(oi.body)),ii(oi)},Xo.serializeRes=eh,Xo.serializeHeaders=Ru,Xo.clearCache=function fu(){Xl.refs.clearCache()},Xo.makeApisTagOperation=function mu(){var S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},U=_u_makeExecute(S);return{apis:_u_mapTagOperations({v2OperationIdCompatibilityMode:S.v2OperationIdCompatibilityMode,spec:S.spec,cb:U})}},Xo.buildRequest=Ro,Xo.helpers={opId:kc},Xo.getBaseUrl=Ds,(Xo.prototype={http:Cu,execute:function(U){return this.applyDefaults(),Xo.execute(et({spec:this.spec,http:this.http,securities:{authorized:this.authorizations},contextUrl:"string"==typeof this.url?this.url:void 0,requestInterceptor:this.requestInterceptor||null,responseInterceptor:this.responseInterceptor||null},U))},resolve:function(){var U=this,Y=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Xo.resolve(et({spec:this.spec,url:this.url,http:this.http||this.fetch,allowMetaPatches:this.allowMetaPatches,useCircularStructures:this.useCircularStructures,requestInterceptor:this.requestInterceptor||null,responseInterceptor:this.responseInterceptor||null,skipNormalization:this.skipNormalization||!1},Y)).then(function(it){return U.originalSpec=U.spec,U.spec=it.spec,U.errors=it.errors,U})}}).applyDefaults=function(){var U=this.spec,Y=this.url;if(Y&&wt()(Y).call(Y,"http")){var it=Ut.parse(Y);U.host||(U.host=it.host),U.schemes||(U.schemes=[it.protocol.replace(":","")]),U.basePath||(U.basePath="/")}};var as=Xo.helpers;const ls=Xo},31365:B=>{"use strict";var X=String.prototype.replace,_=/%20/g;B.exports={default:"RFC3986",formatters:{RFC1738:function(m){return X.call(m,_,"+")},RFC3986:function(m){return String(m)}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},7029:(B,X,_)=>{"use strict";var C=_(21333),m=_(62127),e=_(31365);B.exports={formats:e,parse:m,stringify:C}},62127:(B,X,_)=>{"use strict";var C=_(7260),m=Object.prototype.hasOwnProperty,e=Array.isArray,t={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:C.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},o=function(nt,et){return nt&&"string"==typeof nt&&et.comma&&nt.indexOf(",")>-1?nt.split(","):nt},L=function(et,Et,It,gt){if(et){var wt=It.allowDots?et.replace(/\.([^.[]+)/g,"[$1]"):et,Jt=/(\[[^[\]]*])/g,Ct=It.depth>0&&/(\[[^[\]]*])/.exec(wt),bt=Ct?wt.slice(0,Ct.index):wt,at=[];if(bt){if(!It.plainObjects&&m.call(Object.prototype,bt)&&!It.allowPrototypes)return;at.push(bt)}for(var ft=0;It.depth>0&&null!==(Ct=Jt.exec(wt))&&ft<It.depth;){if(ft+=1,!It.plainObjects&&m.call(Object.prototype,Ct[1].slice(1,-1))&&!It.allowPrototypes)return;at.push(Ct[1])}return Ct&&at.push("["+wt.slice(Ct.index)+"]"),function(nt,et,Et,It){for(var gt=It?et:o(et,Et),wt=nt.length-1;wt>=0;--wt){var Ut,Jt=nt[wt];if("[]"===Jt&&Et.parseArrays)Ut=[].concat(gt);else{Ut=Et.plainObjects?Object.create(null):{};var Ct="["===Jt.charAt(0)&&"]"===Jt.charAt(Jt.length-1)?Jt.slice(1,-1):Jt,bt=parseInt(Ct,10);Et.parseArrays||""!==Ct?!isNaN(bt)&&Jt!==Ct&&String(bt)===Ct&&bt>=0&&Et.parseArrays&&bt<=Et.arrayLimit?(Ut=[])[bt]=gt:"__proto__"!==Ct&&(Ut[Ct]=gt):Ut={0:gt}}gt=Ut}return gt}(at,Et,It,gt)}};B.exports=function(nt,et){var Et=function(et){if(!et)return t;if(null!=et.decoder&&"function"!=typeof et.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==et.charset&&"utf-8"!==et.charset&&"iso-8859-1"!==et.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");return{allowDots:void 0===et.allowDots?t.allowDots:!!et.allowDots,allowPrototypes:"boolean"==typeof et.allowPrototypes?et.allowPrototypes:t.allowPrototypes,allowSparse:"boolean"==typeof et.allowSparse?et.allowSparse:t.allowSparse,arrayLimit:"number"==typeof et.arrayLimit?et.arrayLimit:t.arrayLimit,charset:void 0===et.charset?t.charset:et.charset,charsetSentinel:"boolean"==typeof et.charsetSentinel?et.charsetSentinel:t.charsetSentinel,comma:"boolean"==typeof et.comma?et.comma:t.comma,decoder:"function"==typeof et.decoder?et.decoder:t.decoder,delimiter:"string"==typeof et.delimiter||C.isRegExp(et.delimiter)?et.delimiter:t.delimiter,depth:"number"==typeof et.depth||!1===et.depth?+et.depth:t.depth,ignoreQueryPrefix:!0===et.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof et.interpretNumericEntities?et.interpretNumericEntities:t.interpretNumericEntities,parameterLimit:"number"==typeof et.parameterLimit?et.parameterLimit:t.parameterLimit,parseArrays:!1!==et.parseArrays,plainObjects:"boolean"==typeof et.plainObjects?et.plainObjects:t.plainObjects,strictNullHandling:"boolean"==typeof et.strictNullHandling?et.strictNullHandling:t.strictNullHandling}}(et);if(""===nt||null==nt)return Et.plainObjects?Object.create(null):{};for(var It="string"==typeof nt?function(et,Et){var Ct,It={},Ut=(Et.ignoreQueryPrefix?et.replace(/^\?/,""):et).split(Et.delimiter,Et.parameterLimit===1/0?void 0:Et.parameterLimit),Jt=-1,bt=Et.charset;if(Et.charsetSentinel)for(Ct=0;Ct<Ut.length;++Ct)0===Ut[Ct].indexOf("utf8=")&&("utf8=%E2%9C%93"===Ut[Ct]?bt="utf-8":"utf8=%26%2310003%3B"===Ut[Ct]&&(bt="iso-8859-1"),Jt=Ct,Ct=Ut.length);for(Ct=0;Ct<Ut.length;++Ct)if(Ct!==Jt){var Ft,Mt,at=Ut[Ct],ft=at.indexOf("]="),lt=-1===ft?at.indexOf("="):ft+1;-1===lt?(Ft=Et.decoder(at,t.decoder,bt,"key"),Mt=Et.strictNullHandling?null:""):(Ft=Et.decoder(at.slice(0,lt),t.decoder,bt,"key"),Mt=C.maybeMap(o(at.slice(lt+1),Et),function(yt){return Et.decoder(yt,t.decoder,bt,"value")})),Mt&&Et.interpretNumericEntities&&"iso-8859-1"===bt&&(Mt=Mt.replace(/&#(\d+);/g,function(et,Et){return String.fromCharCode(parseInt(Et,10))})),at.indexOf("[]=")>-1&&(Mt=e(Mt)?[Mt]:Mt),It[Ft]=m.call(It,Ft)?C.combine(It[Ft],Mt):Mt}return It}(nt,Et):nt,gt=Et.plainObjects?Object.create(null):{},wt=Object.keys(It),Ut=0;Ut<wt.length;++Ut){var Jt=wt[Ut],Ct=L(Jt,It[Jt],Et,"string"==typeof nt);gt=C.merge(gt,Ct,Et)}return!0===Et.allowSparse?gt:C.compact(gt)}},21333:(B,X,_)=>{"use strict";var C=_(83030),m=_(7260),e=_(31365),t=Object.prototype.hasOwnProperty,n={brackets:function(wt){return wt+"[]"},comma:"comma",indices:function(wt,Ut){return wt+"["+Ut+"]"},repeat:function(wt){return wt}},o=Array.isArray,r=String.prototype.split,a=Array.prototype.push,h=function(gt,wt){a.apply(gt,o(wt)?wt:[wt])},R=Date.prototype.toISOString,L=e.default,W={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:m.encode,encodeValuesOnly:!1,format:L,formatter:e.formatters[L],indices:!1,serializeDate:function(wt){return R.call(wt)},skipNulls:!1,strictNullHandling:!1},et={},Et=function gt(wt,Ut,Jt,Ct,bt,at,ft,lt,Ft,Mt,yt,ct,rt,se,xt){for(var Lt=wt,de=xt,_e=0,ce=!1;void 0!==(de=de.get(et))&&!ce;){var Ae=de.get(wt);if(_e+=1,void 0!==Ae){if(Ae===_e)throw new RangeError("Cyclic object value");ce=!0}void 0===de.get(et)&&(_e=0)}if("function"==typeof ft?Lt=ft(Ut,Lt):Lt instanceof Date?Lt=Mt(Lt):"comma"===Jt&&o(Lt)&&(Lt=m.maybeMap(Lt,function(je){return je instanceof Date?Mt(je):je})),null===Lt){if(Ct)return at&&!rt?at(Ut,W.encoder,se,"key",yt):Ut;Lt=""}if(function(wt){return"string"==typeof wt||"number"==typeof wt||"boolean"==typeof wt||"symbol"==typeof wt||"bigint"==typeof wt}(Lt)||m.isBuffer(Lt)){if(at){var Ne=rt?Ut:at(Ut,W.encoder,se,"key",yt);if("comma"===Jt&&rt){for(var qe=r.call(String(Lt),","),Di="",ei=0;ei<qe.length;++ei)Di+=(0===ei?"":",")+ct(at(qe[ei],W.encoder,se,"value",yt));return[ct(Ne)+"="+Di]}return[ct(Ne)+"="+ct(at(Lt,W.encoder,se,"value",yt))]}return[ct(Ut)+"="+ct(String(Lt))]}var ri,Me=[];if(void 0===Lt)return Me;if("comma"===Jt&&o(Lt))ri=[{value:Lt.length>0?Lt.join(",")||null:void 0}];else if(o(ft))ri=ft;else{var Bt=Object.keys(Lt);ri=lt?Bt.sort(lt):Bt}for(var Ie=0;Ie<ri.length;++Ie){var Xt=ri[Ie],he="object"==typeof Xt&&void 0!==Xt.value?Xt.value:Lt[Xt];if(!bt||null!==he){var Dt=o(Lt)?"function"==typeof Jt?Jt(Ut,Xt):Ut:Ut+(Ft?"."+Xt:"["+Xt+"]");xt.set(wt,_e);var ve=C();ve.set(et,xt),h(Me,gt(he,Dt,Jt,Ct,bt,at,ft,lt,Ft,Mt,yt,ct,rt,se,ve))}}return Me};B.exports=function(gt,wt){var Ct,Ut=gt,Jt=function(wt){if(!wt)return W;if(null!=wt.encoder&&"function"!=typeof wt.encoder)throw new TypeError("Encoder has to be a function.");var Ut=wt.charset||W.charset;if(void 0!==wt.charset&&"utf-8"!==wt.charset&&"iso-8859-1"!==wt.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var Jt=e.default;if(void 0!==wt.format){if(!t.call(e.formatters,wt.format))throw new TypeError("Unknown format option provided.");Jt=wt.format}var Ct=e.formatters[Jt],bt=W.filter;return("function"==typeof wt.filter||o(wt.filter))&&(bt=wt.filter),{addQueryPrefix:"boolean"==typeof wt.addQueryPrefix?wt.addQueryPrefix:W.addQueryPrefix,allowDots:void 0===wt.allowDots?W.allowDots:!!wt.allowDots,charset:Ut,charsetSentinel:"boolean"==typeof wt.charsetSentinel?wt.charsetSentinel:W.charsetSentinel,delimiter:void 0===wt.delimiter?W.delimiter:wt.delimiter,encode:"boolean"==typeof wt.encode?wt.encode:W.encode,encoder:"function"==typeof wt.encoder?wt.encoder:W.encoder,encodeValuesOnly:"boolean"==typeof wt.encodeValuesOnly?wt.encodeValuesOnly:W.encodeValuesOnly,filter:bt,format:Jt,formatter:Ct,serializeDate:"function"==typeof wt.serializeDate?wt.serializeDate:W.serializeDate,skipNulls:"boolean"==typeof wt.skipNulls?wt.skipNulls:W.skipNulls,sort:"function"==typeof wt.sort?wt.sort:null,strictNullHandling:"boolean"==typeof wt.strictNullHandling?wt.strictNullHandling:W.strictNullHandling}}(wt);"function"==typeof Jt.filter?Ut=(0,Jt.filter)("",Ut):o(Jt.filter)&&(Ct=Jt.filter);var at=[];if("object"!=typeof Ut||null===Ut)return"";var lt=n[wt&&wt.arrayFormat in n?wt.arrayFormat:wt&&"indices"in wt?wt.indices?"indices":"repeat":"indices"];Ct||(Ct=Object.keys(Ut)),Jt.sort&&Ct.sort(Jt.sort);for(var Ft=C(),Mt=0;Mt<Ct.length;++Mt){var yt=Ct[Mt];Jt.skipNulls&&null===Ut[yt]||h(at,Et(Ut[yt],yt,lt,Jt.strictNullHandling,Jt.skipNulls,Jt.encode?Jt.encoder:null,Jt.filter,Jt.sort,Jt.allowDots,Jt.serializeDate,Jt.format,Jt.formatter,Jt.encodeValuesOnly,Jt.charset,Ft))}var ct=at.join(Jt.delimiter),rt=!0===Jt.addQueryPrefix?"?":"";return Jt.charsetSentinel&&(rt+="iso-8859-1"===Jt.charset?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),ct.length>0?rt+ct:""}},7260:(B,X,_)=>{"use strict";var C=_(31365),m=Object.prototype.hasOwnProperty,e=Array.isArray,t=function(){for(var It=[],gt=0;gt<256;++gt)It.push("%"+((gt<16?"0":"")+gt.toString(16)).toUpperCase());return It}(),o=function(gt,wt){for(var Ut=wt&&wt.plainObjects?Object.create(null):{},Jt=0;Jt<gt.length;++Jt)void 0!==gt[Jt]&&(Ut[Jt]=gt[Jt]);return Ut};B.exports={arrayToObject:o,assign:function(gt,wt){return Object.keys(wt).reduce(function(Ut,Jt){return Ut[Jt]=wt[Jt],Ut},gt)},combine:function(gt,wt){return[].concat(gt,wt)},compact:function(gt){for(var wt=[{obj:{o:gt},prop:"o"}],Ut=[],Jt=0;Jt<wt.length;++Jt)for(var Ct=wt[Jt],bt=Ct.obj[Ct.prop],at=Object.keys(bt),ft=0;ft<at.length;++ft){var lt=at[ft],Ft=bt[lt];"object"==typeof Ft&&null!==Ft&&-1===Ut.indexOf(Ft)&&(wt.push({obj:bt,prop:lt}),Ut.push(Ft))}return function(gt){for(;gt.length>1;){var wt=gt.pop(),Ut=wt.obj[wt.prop];if(e(Ut)){for(var Jt=[],Ct=0;Ct<Ut.length;++Ct)void 0!==Ut[Ct]&&Jt.push(Ut[Ct]);wt.obj[wt.prop]=Jt}}}(wt),gt},decode:function(It,gt,wt){var Ut=It.replace(/\+/g," ");if("iso-8859-1"===wt)return Ut.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(Ut)}catch(Jt){return Ut}},encode:function(gt,wt,Ut,Jt,Ct){if(0===gt.length)return gt;var bt=gt;if("symbol"==typeof gt?bt=Symbol.prototype.toString.call(gt):"string"!=typeof gt&&(bt=String(gt)),"iso-8859-1"===Ut)return escape(bt).replace(/%u[0-9a-f]{4}/gi,function(Ft){return"%26%23"+parseInt(Ft.slice(2),16)+"%3B"});for(var at="",ft=0;ft<bt.length;++ft){var lt=bt.charCodeAt(ft);45===lt||46===lt||95===lt||126===lt||lt>=48&&lt<=57||lt>=65&&lt<=90||lt>=97&&lt<=122||Ct===C.RFC1738&&(40===lt||41===lt)?at+=bt.charAt(ft):lt<128?at+=t[lt]:lt<2048?at+=t[192|lt>>6]+t[128|63&lt]:lt<55296||lt>=57344?at+=t[224|lt>>12]+t[128|lt>>6&63]+t[128|63&lt]:(lt=65536+((1023&lt)<<10|1023&bt.charCodeAt(ft+=1)),at+=t[240|lt>>18]+t[128|lt>>12&63]+t[128|lt>>6&63]+t[128|63&lt])}return at},isBuffer:function(gt){return!(!gt||"object"!=typeof gt||!(gt.constructor&&gt.constructor.isBuffer&&gt.constructor.isBuffer(gt)))},isRegExp:function(gt){return"[object RegExp]"===Object.prototype.toString.call(gt)},maybeMap:function(gt,wt){if(e(gt)){for(var Ut=[],Jt=0;Jt<gt.length;Jt+=1)Ut.push(wt(gt[Jt]));return Ut}return wt(gt)},merge:function It(gt,wt,Ut){if(!wt)return gt;if("object"!=typeof wt){if(e(gt))gt.push(wt);else{if(!gt||"object"!=typeof gt)return[gt,wt];(Ut&&(Ut.plainObjects||Ut.allowPrototypes)||!m.call(Object.prototype,wt))&&(gt[wt]=!0)}return gt}if(!gt||"object"!=typeof gt)return[gt].concat(wt);var Jt=gt;return e(gt)&&!e(wt)&&(Jt=o(gt,Ut)),e(gt)&&e(wt)?(wt.forEach(function(Ct,bt){if(m.call(gt,bt)){var at=gt[bt];at&&"object"==typeof at&&Ct&&"object"==typeof Ct?gt[bt]=It(at,Ct,Ut):gt.push(Ct)}else gt[bt]=Ct}),gt):Object.keys(wt).reduce(function(Ct,bt){var at=wt[bt];return Ct[bt]=m.call(Ct,bt)?It(Ct[bt],at,Ut):at,Ct},Jt)}}},3394:B=>{var X=B.exports=function(et){return new _(et)};function _(et){this.value=et}function C(et,Et,It){var gt=[],wt=[],Ut=!0;return function Jt(Ct){var bt=It?m(Ct):Ct,at={},ft=!0,lt={node:bt,node_:Ct,path:[].concat(gt),parent:wt[wt.length-1],parents:wt,key:gt.slice(-1)[0],isRoot:0===gt.length,level:gt.length,circular:null,update:function(yt,ct){lt.isRoot||(lt.parent.node[lt.key]=yt),lt.node=yt,ct&&(ft=!1)},delete:function(yt){delete lt.parent.node[lt.key],yt&&(ft=!1)},remove:function(yt){L(lt.parent.node)?lt.parent.node.splice(lt.key,1):delete lt.parent.node[lt.key],yt&&(ft=!1)},keys:null,before:function(yt){at.before=yt},after:function(yt){at.after=yt},pre:function(yt){at.pre=yt},post:function(yt){at.post=yt},stop:function(){Ut=!1},block:function(){ft=!1}};if(!Ut)return lt;function Ft(){if("object"==typeof lt.node&&null!==lt.node){(!lt.keys||lt.node_!==lt.node)&&(lt.keys=e(lt.node)),lt.isLeaf=0==lt.keys.length;for(var yt=0;yt<wt.length;yt++)if(wt[yt].node_===Ct){lt.circular=wt[yt];break}}else lt.isLeaf=!0,lt.keys=null;lt.notLeaf=!lt.isLeaf,lt.notRoot=!lt.isRoot}Ft();var Mt=Et.call(lt,lt.node);return void 0!==Mt&&lt.update&&lt.update(Mt),at.before&&at.before.call(lt,lt.node),ft&&("object"==typeof lt.node&&null!==lt.node&&!lt.circular&&(wt.push(lt),Ft(),W(lt.keys,function(yt,ct){gt.push(yt),at.pre&&at.pre.call(lt,lt.node[yt],yt);var rt=Jt(lt.node[yt]);It&&nt.call(lt.node,yt)&&(lt.node[yt]=rt.node),rt.isLast=ct==lt.keys.length-1,rt.isFirst=0==ct,at.post&&at.post.call(lt,rt),gt.pop()}),wt.pop()),at.after&&at.after.call(lt,lt.node)),lt}(et).node}function m(et){if("object"==typeof et&&null!==et){var Et;if(L(et))Et=[];else if(function n(et){return"[object Date]"===t(et)}(et))Et=new Date(et.getTime?et.getTime():et);else if(function o(et){return"[object RegExp]"===t(et)}(et))Et=new RegExp(et);else if(function r(et){return"[object Error]"===t(et)}(et))Et={message:et.message};else if(function a(et){return"[object Boolean]"===t(et)}(et))Et=new Boolean(et);else if(function h(et){return"[object Number]"===t(et)}(et))Et=new Number(et);else if(function R(et){return"[object String]"===t(et)}(et))Et=new String(et);else if(Object.create&&Object.getPrototypeOf)Et=Object.create(Object.getPrototypeOf(et));else if(et.constructor===Object)Et={};else{var gt=function(){};gt.prototype=et.constructor&&et.constructor.prototype||et.__proto__||{},Et=new gt}return W(e(et),function(wt){Et[wt]=et[wt]}),Et}return et}_.prototype.get=function(et){for(var Et=this.value,It=0;It<et.length;It++){var gt=et[It];if(!Et||!nt.call(Et,gt)){Et=void 0;break}Et=Et[gt]}return Et},_.prototype.has=function(et){for(var Et=this.value,It=0;It<et.length;It++){var gt=et[It];if(!Et||!nt.call(Et,gt))return!1;Et=Et[gt]}return!0},_.prototype.set=function(et,Et){for(var It=this.value,gt=0;gt<et.length-1;gt++){var wt=et[gt];nt.call(It,wt)||(It[wt]={}),It=It[wt]}return It[et[gt]]=Et,Et},_.prototype.map=function(et){return C(this.value,et,!0)},_.prototype.forEach=function(et){return this.value=C(this.value,et,!1),this.value},_.prototype.reduce=function(et,Et){var It=1===arguments.length,gt=It?this.value:Et;return this.forEach(function(wt){(!this.isRoot||!It)&&(gt=et.call(this,gt,wt))}),gt},_.prototype.paths=function(){var et=[];return this.forEach(function(Et){et.push(this.path)}),et},_.prototype.nodes=function(){var et=[];return this.forEach(function(Et){et.push(this.node)}),et},_.prototype.clone=function(){var et=[],Et=[];return function It(gt){for(var wt=0;wt<et.length;wt++)if(et[wt]===gt)return Et[wt];if("object"==typeof gt&&null!==gt){var Ut=m(gt);return et.push(gt),Et.push(Ut),W(e(gt),function(Jt){Ut[Jt]=It(gt[Jt])}),et.pop(),Et.pop(),Ut}return gt}(this.value)};var e=Object.keys||function(Et){var It=[];for(var gt in Et)It.push(gt);return It};function t(et){return Object.prototype.toString.call(et)}var L=Array.isArray||function(Et){return"[object Array]"===Object.prototype.toString.call(Et)},W=function(et,Et){if(et.forEach)return et.forEach(Et);for(var It=0;It<et.length;It++)Et(et[It],It,et)};W(e(_.prototype),function(et){X[et]=function(Et){var It=[].slice.call(arguments,1),gt=new _(Et);return gt[et].apply(gt,It)}});var nt=Object.hasOwnProperty||function(et,Et){return Et in et}},86370:function(B,X,_){var C;B=_.nmd(B),function(m){"object"==typeof global&&global;var o,r=2147483647,a=36,It=/^xn--/,gt=/[^\x20-\x7E]/,wt=/[\x2E\u3002\uFF0E\uFF61]/g,Ut={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Ct=Math.floor,bt=String.fromCharCode;function ft(ce){throw RangeError(Ut[ce])}function lt(ce,Ae){for(var Ne=ce.length,qe=[];Ne--;)qe[Ne]=Ae(ce[Ne]);return qe}function Ft(ce,Ae){var Ne=ce.split("@"),qe="";return Ne.length>1&&(qe=Ne[0]+"@",ce=Ne[1]),qe+lt((ce=ce.replace(wt,".")).split("."),Ae).join(".")}function Mt(ce){for(var Di,ei,Ae=[],Ne=0,qe=ce.length;Ne<qe;)(Di=ce.charCodeAt(Ne++))>=55296&&Di<=56319&&Ne<qe?56320==(64512&(ei=ce.charCodeAt(Ne++)))?Ae.push(((1023&Di)<<10)+(1023&ei)+65536):(Ae.push(Di),Ne--):Ae.push(Di);return Ae}function yt(ce){return lt(ce,function(Ae){var Ne="";return Ae>65535&&(Ne+=bt((Ae-=65536)>>>10&1023|55296),Ae=56320|1023&Ae),Ne+bt(Ae)}).join("")}function ct(ce){return ce-48<10?ce-22:ce-65<26?ce-65:ce-97<26?ce-97:a}function rt(ce,Ae){return ce+22+75*(ce<26)-((0!=Ae)<<5)}function se(ce,Ae,Ne){var qe=0;for(ce=Ne?Ct(ce/700):ce>>1,ce+=Ct(ce/Ae);ce>455;qe+=a)ce=Ct(ce/35);return Ct(qe+36*ce/(ce+38))}function xt(ce){var qe,ri,Bt,Ie,Xt,he,Dt,ve,je,gi,Ae=[],Ne=ce.length,Di=0,ei=128,Me=72;for((ri=ce.lastIndexOf("-"))<0&&(ri=0),Bt=0;Bt<ri;++Bt)ce.charCodeAt(Bt)>=128&&ft("not-basic"),Ae.push(ce.charCodeAt(Bt));for(Ie=ri>0?ri+1:0;Ie<Ne;){for(Xt=Di,he=1,Dt=a;Ie>=Ne&&ft("invalid-input"),((ve=ct(ce.charCodeAt(Ie++)))>=a||ve>Ct((r-Di)/he))&&ft("overflow"),Di+=ve*he,!(ve<(je=Dt<=Me?1:Dt>=Me+26?26:Dt-Me));Dt+=a)he>Ct(r/(gi=a-je))&&ft("overflow"),he*=gi;Me=se(Di-Xt,qe=Ae.length+1,0==Xt),Ct(Di/qe)>r-ei&&ft("overflow"),ei+=Ct(Di/qe),Di%=qe,Ae.splice(Di++,0,ei)}return yt(Ae)}function Lt(ce){var Ae,Ne,qe,Di,ei,Me,ri,Bt,Ie,Xt,he,ve,je,gi,Ee,Dt=[];for(ve=(ce=Mt(ce)).length,Ae=128,Ne=0,ei=72,Me=0;Me<ve;++Me)(he=ce[Me])<128&&Dt.push(bt(he));for(qe=Di=Dt.length,Di&&Dt.push("-");qe<ve;){for(ri=r,Me=0;Me<ve;++Me)(he=ce[Me])>=Ae&&he<ri&&(ri=he);for(ri-Ae>Ct((r-Ne)/(je=qe+1))&&ft("overflow"),Ne+=(ri-Ae)*je,Ae=ri,Me=0;Me<ve;++Me)if((he=ce[Me])<Ae&&++Ne>r&&ft("overflow"),he==Ae){for(Bt=Ne,Ie=a;!(Bt<(Xt=Ie<=ei?1:Ie>=ei+26?26:Ie-ei));Ie+=a)Dt.push(bt(rt(Xt+(Ee=Bt-Xt)%(gi=a-Xt),0))),Bt=Ct(Ee/gi);Dt.push(bt(rt(Bt,0))),ei=se(Ne,je,qe==Di),Ne=0,++qe}++Ne,++Ae}return Dt.join("")}o={version:"1.3.2",ucs2:{decode:Mt,encode:yt},decode:xt,encode:Lt,toASCII:function _e(ce){return Ft(ce,function(Ae){return gt.test(Ae)?"xn--"+Lt(Ae):Ae})},toUnicode:function de(ce){return Ft(ce,function(Ae){return It.test(Ae)?xt(Ae.slice(4).toLowerCase()):Ae})}},void 0!==(C=function(){return o}.call(X,_,X,B))&&(B.exports=C)}()},20434:(B,X,_)=>{"use strict";var C=_(86370),m=_(16906);function e(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}X.parse=Ut,X.resolve=function Ct(at,ft){return Ut(at,!1,!0).resolve(ft)},X.resolveObject=function bt(at,ft){return at?Ut(at,!1,!0).resolveObject(ft):ft},X.format=function Jt(at){return m.isString(at)&&(at=Ut(at)),at instanceof e?at.format():e.prototype.format.call(at)},X.Url=e;var t=/^([a-z0-9.+-]+:)/i,n=/:[0-9]*$/,o=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,a=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),h=["'"].concat(a),R=["%","/","?",";","#"].concat(h),L=["/","?","#"],nt=/^[+a-z0-9A-Z_-]{0,63}$/,et=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Et={javascript:!0,"javascript:":!0},It={javascript:!0,"javascript:":!0},gt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},wt=_(10569);function Ut(at,ft,lt){if(at&&m.isObject(at)&&at instanceof e)return at;var Ft=new e;return Ft.parse(at,ft,lt),Ft}e.prototype.parse=function(at,ft,lt){if(!m.isString(at))throw new TypeError("Parameter 'url' must be a string, not "+typeof at);var Ft=at.indexOf("?"),Mt=-1!==Ft&&Ft<at.indexOf("#")?"?":"#",yt=at.split(Mt);yt[0]=yt[0].replace(/\\/g,"/");var rt=at=yt.join(Mt);if(rt=rt.trim(),!lt&&1===at.split("#").length){var se=o.exec(rt);if(se)return this.path=rt,this.href=rt,this.pathname=se[1],se[2]?(this.search=se[2],this.query=ft?wt.parse(this.search.substr(1)):this.search.substr(1)):ft&&(this.search="",this.query={}),this}var xt=t.exec(rt);if(xt){var Lt=(xt=xt[0]).toLowerCase();this.protocol=Lt,rt=rt.substr(xt.length)}if(lt||xt||rt.match(/^\/\/[^@\/]+@[^@\/]+/)){var de="//"===rt.substr(0,2);de&&(!xt||!It[xt])&&(rt=rt.substr(2),this.slashes=!0)}if(!It[xt]&&(de||xt&&!gt[xt])){for(var _e=-1,ce=0;ce<L.length;ce++)-1!==(Ae=rt.indexOf(L[ce]))&&(-1===_e||Ae<_e)&&(_e=Ae);var Ne,qe;for(-1!==(qe=-1===_e?rt.lastIndexOf("@"):rt.lastIndexOf("@",_e))&&(Ne=rt.slice(0,qe),rt=rt.slice(qe+1),this.auth=decodeURIComponent(Ne)),_e=-1,ce=0;ce<R.length;ce++){var Ae;-1!==(Ae=rt.indexOf(R[ce]))&&(-1===_e||Ae<_e)&&(_e=Ae)}-1===_e&&(_e=rt.length),this.host=rt.slice(0,_e),rt=rt.slice(_e),this.parseHost(),this.hostname=this.hostname||"";var Di="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!Di)for(var ei=this.hostname.split(/\./),Me=(ce=0,ei.length);ce<Me;ce++){var ri=ei[ce];if(ri&&!ri.match(nt)){for(var Bt="",Ie=0,Xt=ri.length;Ie<Xt;Ie++)ri.charCodeAt(Ie)>127?Bt+="x":Bt+=ri[Ie];if(!Bt.match(nt)){var he=ei.slice(0,ce),Dt=ei.slice(ce+1),ve=ri.match(et);ve&&(he.push(ve[1]),Dt.unshift(ve[2])),Dt.length&&(rt="/"+Dt.join(".")+rt),this.hostname=he.join(".");break}}}this.hostname=this.hostname.length>255?"":this.hostname.toLowerCase(),Di||(this.hostname=C.toASCII(this.hostname)),this.host=(this.hostname||"")+(this.port?":"+this.port:""),this.href+=this.host,Di&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rt[0]&&(rt="/"+rt))}if(!Et[Lt])for(ce=0,Me=h.length;ce<Me;ce++){var Ee=h[ce];if(-1!==rt.indexOf(Ee)){var ne=encodeURIComponent(Ee);ne===Ee&&(ne=escape(Ee)),rt=rt.split(Ee).join(ne)}}var ee=rt.indexOf("#");-1!==ee&&(this.hash=rt.substr(ee),rt=rt.slice(0,ee));var Oe=rt.indexOf("?");return-1!==Oe?(this.search=rt.substr(Oe),this.query=rt.substr(Oe+1),ft&&(this.query=wt.parse(this.query)),rt=rt.slice(0,Oe)):ft&&(this.search="",this.query={}),rt&&(this.pathname=rt),gt[Lt]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(this.path=(this.pathname||"")+(this.search||"")),this.href=this.format(),this},e.prototype.format=function(){var at=this.auth||"";at&&(at=(at=encodeURIComponent(at)).replace(/%3A/i,":"),at+="@");var ft=this.protocol||"",lt=this.pathname||"",Ft=this.hash||"",Mt=!1,yt="";this.host?Mt=at+this.host:this.hostname&&(Mt=at+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(Mt+=":"+this.port)),this.query&&m.isObject(this.query)&&Object.keys(this.query).length&&(yt=wt.stringify(this.query));var ct=this.search||yt&&"?"+yt||"";return ft&&":"!==ft.substr(-1)&&(ft+=":"),this.slashes||(!ft||gt[ft])&&!1!==Mt?(Mt="//"+(Mt||""),lt&&"/"!==lt.charAt(0)&&(lt="/"+lt)):Mt||(Mt=""),Ft&&"#"!==Ft.charAt(0)&&(Ft="#"+Ft),ct&&"?"!==ct.charAt(0)&&(ct="?"+ct),ft+Mt+(lt=lt.replace(/[?#]/g,function(rt){return encodeURIComponent(rt)}))+(ct=ct.replace("#","%23"))+Ft},e.prototype.resolve=function(at){return this.resolveObject(Ut(at,!1,!0)).format()},e.prototype.resolveObject=function(at){if(m.isString(at)){var ft=new e;ft.parse(at,!1,!0),at=ft}for(var lt=new e,Ft=Object.keys(this),Mt=0;Mt<Ft.length;Mt++){var yt=Ft[Mt];lt[yt]=this[yt]}if(lt.hash=at.hash,""===at.href)return lt.href=lt.format(),lt;if(at.slashes&&!at.protocol){for(var ct=Object.keys(at),rt=0;rt<ct.length;rt++){var se=ct[rt];"protocol"!==se&&(lt[se]=at[se])}return gt[lt.protocol]&&lt.hostname&&!lt.pathname&&(lt.path=lt.pathname="/"),lt.href=lt.format(),lt}if(at.protocol&&at.protocol!==lt.protocol){if(!gt[at.protocol]){for(var xt=Object.keys(at),Lt=0;Lt<xt.length;Lt++){var de=xt[Lt];lt[de]=at[de]}return lt.href=lt.format(),lt}if(lt.protocol=at.protocol,at.host||It[at.protocol])lt.pathname=at.pathname;else{for(var Me=(at.pathname||"").split("/");Me.length&&!(at.host=Me.shift()););at.host||(at.host=""),at.hostname||(at.hostname=""),""!==Me[0]&&Me.unshift(""),Me.length<2&&Me.unshift(""),lt.pathname=Me.join("/")}return lt.search=at.search,lt.query=at.query,lt.host=at.host||"",lt.auth=at.auth,lt.hostname=at.hostname||at.host,lt.port=at.port,(lt.pathname||lt.search)&&(lt.path=(lt.pathname||"")+(lt.search||"")),lt.slashes=lt.slashes||at.slashes,lt.href=lt.format(),lt}var Ae=lt.pathname&&"/"===lt.pathname.charAt(0),Ne=at.host||at.pathname&&"/"===at.pathname.charAt(0),qe=Ne||Ae||lt.host&&at.pathname,Di=qe,ei=lt.pathname&&lt.pathname.split("/")||[],ri=(Me=at.pathname&&at.pathname.split("/")||[],lt.protocol&&!gt[lt.protocol]);if(ri&&(lt.hostname="",lt.port=null,lt.host&&(""===ei[0]?ei[0]=lt.host:ei.unshift(lt.host)),lt.host="",at.protocol&&(at.hostname=null,at.port=null,at.host&&(""===Me[0]?Me[0]=at.host:Me.unshift(at.host)),at.host=null),qe=qe&&(""===Me[0]||""===ei[0])),Ne)lt.host=at.host||""===at.host?at.host:lt.host,lt.hostname=at.hostname||""===at.hostname?at.hostname:lt.hostname,lt.search=at.search,lt.query=at.query,ei=Me;else if(Me.length)ei||(ei=[]),ei.pop(),ei=ei.concat(Me),lt.search=at.search,lt.query=at.query;else if(!m.isNullOrUndefined(at.search))return ri&&(lt.hostname=lt.host=ei.shift(),(Bt=!!(lt.host&&lt.host.indexOf("@")>0)&&lt.host.split("@"))&&(lt.auth=Bt.shift(),lt.host=lt.hostname=Bt.shift())),lt.search=at.search,lt.query=at.query,(!m.isNull(lt.pathname)||!m.isNull(lt.search))&&(lt.path=(lt.pathname?lt.pathname:"")+(lt.search?lt.search:"")),lt.href=lt.format(),lt;if(!ei.length)return lt.pathname=null,lt.path=lt.search?"/"+lt.search:null,lt.href=lt.format(),lt;for(var Ie=ei.slice(-1)[0],Xt=(lt.host||at.host||ei.length>1)&&("."===Ie||".."===Ie)||""===Ie,he=0,Dt=ei.length;Dt>=0;Dt--)"."===(Ie=ei[Dt])?ei.splice(Dt,1):".."===Ie?(ei.splice(Dt,1),he++):he&&(ei.splice(Dt,1),he--);if(!qe&&!Di)for(;he--;he)ei.unshift("..");qe&&""!==ei[0]&&(!ei[0]||"/"!==ei[0].charAt(0))&&ei.unshift(""),Xt&&"/"!==ei.join("/").substr(-1)&&ei.push("");var Bt,ve=""===ei[0]||ei[0]&&"/"===ei[0].charAt(0);return ri&&(lt.hostname=lt.host=ve?"":ei.length?ei.shift():"",(Bt=!!(lt.host&&lt.host.indexOf("@")>0)&&lt.host.split("@"))&&(lt.auth=Bt.shift(),lt.host=lt.hostname=Bt.shift())),(qe=qe||lt.host&&ei.length)&&!ve&&ei.unshift(""),ei.length?lt.pathname=ei.join("/"):(lt.pathname=null,lt.path=null),(!m.isNull(lt.pathname)||!m.isNull(lt.search))&&(lt.path=(lt.pathname?lt.pathname:"")+(lt.search?lt.search:"")),lt.auth=at.auth||lt.auth,lt.slashes=lt.slashes||at.slashes,lt.href=lt.format(),lt},e.prototype.parseHost=function(){var at=this.host,ft=n.exec(at);ft&&(":"!==(ft=ft[0])&&(this.port=ft.substr(1)),at=at.substr(0,at.length-ft.length)),at&&(this.hostname=at)}},16906:B=>{"use strict";B.exports={isString:function(X){return"string"==typeof X},isObject:function(X){return"object"==typeof X&&null!==X},isNull:function(X){return null===X},isNullOrUndefined:function(X){return null==X}}},35987:(B,X,_)=>{"use strict";function a(Mt,yt,ct,rt){return new(ct||(ct=Promise))(function(xt,Lt){function de(Ae){try{ce(rt.next(Ae))}catch(Ne){Lt(Ne)}}function _e(Ae){try{ce(rt.throw(Ae))}catch(Ne){Lt(Ne)}}function ce(Ae){Ae.done?xt(Ae.value):function se(xt){return xt instanceof ct?xt:new ct(function(Lt){Lt(xt)})}(Ae.value).then(de,_e)}ce((rt=rt.apply(Mt,yt||[])).next())})}function gt(Mt){return this instanceof gt?(this.v=Mt,this):new gt(Mt)}function wt(Mt,yt,ct){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var se,rt=ct.apply(Mt,yt||[]),xt=[];return se={},Lt("next"),Lt("throw"),Lt("return"),se[Symbol.asyncIterator]=function(){return this},se;function Lt(qe){rt[qe]&&(se[qe]=function(Di){return new Promise(function(ei,Me){xt.push([qe,Di,ei,Me])>1||de(qe,Di)})})}function de(qe,Di){try{!function _e(qe){qe.value instanceof gt?Promise.resolve(qe.value.v).then(ce,Ae):Ne(xt[0][2],qe)}(rt[qe](Di))}catch(ei){Ne(xt[0][3],ei)}}function ce(qe){de("next",qe)}function Ae(qe){de("throw",qe)}function Ne(qe,Di){qe(Di),xt.shift(),xt.length&&de(xt[0][0],xt[0][1])}}function Jt(Mt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ct,yt=Mt[Symbol.asyncIterator];return yt?yt.call(Mt):(Mt=function W(Mt){var yt="function"==typeof Symbol&&Symbol.iterator,ct=yt&&Mt[yt],rt=0;if(ct)return ct.call(Mt);if(Mt&&"number"==typeof Mt.length)return{next:function(){return Mt&&rt>=Mt.length&&(Mt=void 0),{value:Mt&&Mt[rt++],done:!Mt}}};throw new TypeError(yt?"Object is not iterable.":"Symbol.iterator is not defined.")}(Mt),ct={},rt("next"),rt("throw"),rt("return"),ct[Symbol.asyncIterator]=function(){return this},ct);function rt(xt){ct[xt]=Mt[xt]&&function(Lt){return new Promise(function(de,_e){!function se(xt,Lt,de,_e){Promise.resolve(_e).then(function(ce){xt({value:ce,done:de})},Lt)}(de,_e,(Lt=Mt[xt](Lt)).done,Lt.value)})}}}_.d(X,{mG:()=>a,qq:()=>gt,FC:()=>wt,KL:()=>Jt})},70433:(B,X,_)=>{B.exports=_(47471)},82476:(B,X,_)=>{B.exports=_(21049)},20036:(B,X,_)=>{B.exports=_(43175)},55672:(B,X,_)=>{B.exports=_(3352)},77464:(B,X,_)=>{B.exports=_(13566)},40750:(B,X,_)=>{B.exports=_(70201)},55742:(B,X,_)=>{B.exports=_(21570)},63759:(B,X,_)=>{B.exports=_(46726)},67489:(B,X,_)=>{B.exports=_(38366)},81836:(B,X,_)=>{B.exports=_(63317)},25710:(B,X,_)=>{B.exports=_(68687)},12782:(B,X,_)=>{B.exports=_(15256)},27733:(B,X,_)=>{B.exports=_(21929)},32472:(B,X,_)=>{B.exports=_(70977)},78927:(B,X,_)=>{B.exports=_(35019)},79921:(B,X,_)=>{B.exports=_(24733)},74580:(B,X,_)=>{B.exports=_(65623)},49067:(B,X,_)=>{B.exports=_(4517)},10278:(B,X,_)=>{B.exports=_(31584)},92909:(B,X,_)=>{B.exports=_(46025)},40715:(B,X,_)=>{B.exports=_(81613)},88577:(B,X,_)=>{B.exports=_(19775)},25918:(B,X,_)=>{B.exports=_(9483)},48735:(B,X,_)=>{B.exports=_(60061)},46188:(B,X,_)=>{B.exports=_(27254)},8797:(B,X,_)=>{B.exports=_(62691)},77901:(B,X,_)=>{B.exports=_(98244)},95942:(B,X,_)=>{B.exports=_(79668)},96915:(B,X,_)=>{B.exports=_(5797)},90986:(B,X,_)=>{B.exports=_(35248)},62917:(B,X,_)=>{B.exports=_(58316)},45698:(B,X,_)=>{B.exports=_(51479)},48972:(B,X,_)=>{B.exports=_(35392)},59680:(B,X,_)=>{B.exports=_(43510)},52175:()=>{},41777:(B,X,_)=>{"use strict";_.d(X,{l3:()=>e,_j:()=>C,LC:()=>m,ZN:()=>wt,jt:()=>n,pV:()=>nt,F4:()=>R,IO:()=>Et,vP:()=>r,SB:()=>h,oB:()=>a,eR:()=>L,X$:()=>t,ZE:()=>Ut,k1:()=>Jt});class C{}class m{}const e="*";function t(Ct,bt){return{type:7,name:Ct,definitions:bt,options:{}}}function n(Ct,bt=null){return{type:4,styles:bt,timings:Ct}}function r(Ct,bt=null){return{type:2,steps:Ct,options:bt}}function a(Ct){return{type:6,styles:Ct,offset:null}}function h(Ct,bt,at){return{type:0,name:Ct,styles:bt,options:at}}function R(Ct){return{type:5,steps:Ct}}function L(Ct,bt,at=null){return{type:1,expr:Ct,animation:bt,options:at}}function nt(Ct=null){return{type:9,options:Ct}}function Et(Ct,bt,at=null){return{type:11,selector:Ct,animation:bt,options:at}}function gt(Ct){Promise.resolve(null).then(Ct)}class wt{constructor(bt=0,at=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=bt+at}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(bt=>bt()),this._onDoneFns=[])}onStart(bt){this._onStartFns.push(bt)}onDone(bt){this._onDoneFns.push(bt)}onDestroy(bt){this._onDestroyFns.push(bt)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){gt(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(bt=>bt()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(bt=>bt()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(bt){this._position=this.totalTime?bt*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(bt){const at="start"==bt?this._onStartFns:this._onDoneFns;at.forEach(ft=>ft()),at.length=0}}class Ut{constructor(bt){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=bt;let at=0,ft=0,lt=0;const Ft=this.players.length;0==Ft?gt(()=>this._onFinish()):this.players.forEach(Mt=>{Mt.onDone(()=>{++at==Ft&&this._onFinish()}),Mt.onDestroy(()=>{++ft==Ft&&this._onDestroy()}),Mt.onStart(()=>{++lt==Ft&&this._onStart()})}),this.totalTime=this.players.reduce((Mt,yt)=>Math.max(Mt,yt.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(bt=>bt()),this._onDoneFns=[])}init(){this.players.forEach(bt=>bt.init())}onStart(bt){this._onStartFns.push(bt)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(bt=>bt()),this._onStartFns=[])}onDone(bt){this._onDoneFns.push(bt)}onDestroy(bt){this._onDestroyFns.push(bt)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(bt=>bt.play())}pause(){this.players.forEach(bt=>bt.pause())}restart(){this.players.forEach(bt=>bt.restart())}finish(){this._onFinish(),this.players.forEach(bt=>bt.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(bt=>bt.destroy()),this._onDestroyFns.forEach(bt=>bt()),this._onDestroyFns=[])}reset(){this.players.forEach(bt=>bt.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(bt){const at=bt*this.totalTime;this.players.forEach(ft=>{const lt=ft.totalTime?Math.min(1,at/ft.totalTime):1;ft.setPosition(lt)})}getPosition(){const bt=this.players.reduce((at,ft)=>null===at||ft.totalTime>at.totalTime?ft:at,null);return null!=bt?bt.getPosition():0}beforeDestroy(){this.players.forEach(bt=>{bt.beforeDestroy&&bt.beforeDestroy()})}triggerCallback(bt){const at="start"==bt?this._onStartFns:this._onDoneFns;at.forEach(ft=>ft()),at.length=0}}const Jt="!"},15664:(B,X,_)=>{"use strict";_.d(X,{rt:()=>Ce,s1:()=>Lt,kH:()=>yi,Em:()=>de,tE:()=>_i,qV:()=>je,qm:()=>si,ic:()=>ce,Kd:()=>Ri,X6:()=>me,yG:()=>ye});var C=_(69808),m=_(5e3),e=_(77579),t=_(50727),n=_(61135),o=_(39646),r=_(91159),a=_(18505),h=_(78372),R=_(39300),L=_(54004),W=_(95698),nt=_(35684),et=_(71884),Et=_(82722),It=_(63191),gt=_(70925),wt=_(17144);class xt{constructor(vt){this._items=vt,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new e.x,this._typeaheadSubscription=t.w0.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=Gt=>Gt.disabled,this._pressedLetters=[],this.tabOut=new e.x,this.change=new e.x,vt instanceof m.n_E&&vt.changes.subscribe(Gt=>{if(this._activeItem){const He=Gt.toArray().indexOf(this._activeItem);He>-1&&He!==this._activeItemIndex&&(this._activeItemIndex=He)}})}skipPredicate(vt){return this._skipPredicateFn=vt,this}withWrap(vt=!0){return this._wrap=vt,this}withVerticalOrientation(vt=!0){return this._vertical=vt,this}withHorizontalOrientation(vt){return this._horizontal=vt,this}withAllowedModifierKeys(vt){return this._allowedModifierKeys=vt,this}withTypeAhead(vt=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe((0,a.b)(Gt=>this._pressedLetters.push(Gt)),(0,h.b)(vt),(0,R.h)(()=>this._pressedLetters.length>0),(0,L.U)(()=>this._pressedLetters.join(""))).subscribe(Gt=>{const fe=this._getItemsArray();for(let He=1;He<fe.length+1;He++){const $i=(this._activeItemIndex+He)%fe.length,tn=fe[$i];if(!this._skipPredicateFn(tn)&&0===tn.getLabel().toUpperCase().trim().indexOf(Gt)){this.setActiveItem($i);break}}this._pressedLetters=[]}),this}withHomeAndEnd(vt=!0){return this._homeAndEnd=vt,this}setActiveItem(vt){const Gt=this._activeItem;this.updateActiveItem(vt),this._activeItem!==Gt&&this.change.next(this._activeItemIndex)}onKeydown(vt){const Gt=vt.keyCode,He=["altKey","ctrlKey","metaKey","shiftKey"].every($i=>!vt[$i]||this._allowedModifierKeys.indexOf($i)>-1);switch(Gt){case r.Mf:return void this.tabOut.next();case r.JH:if(this._vertical&&He){this.setNextItemActive();break}return;case r.LH:if(this._vertical&&He){this.setPreviousItemActive();break}return;case r.SV:if(this._horizontal&&He){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case r.oh:if(this._horizontal&&He){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case r.Sd:if(this._homeAndEnd&&He){this.setFirstItemActive();break}return;case r.uR:if(this._homeAndEnd&&He){this.setLastItemActive();break}return;default:return void((He||(0,r.Vb)(vt,"shiftKey"))&&(vt.key&&1===vt.key.length?this._letterKeyStream.next(vt.key.toLocaleUpperCase()):(Gt>=r.A&&Gt<=r.Z||Gt>=r.xE&&Gt<=r.aO)&&this._letterKeyStream.next(String.fromCharCode(Gt))))}this._pressedLetters=[],vt.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(vt){const Gt=this._getItemsArray(),fe="number"==typeof vt?vt:Gt.indexOf(vt),He=Gt[fe];this._activeItem=null==He?null:He,this._activeItemIndex=fe}_setActiveItemByDelta(vt){this._wrap?this._setActiveInWrapMode(vt):this._setActiveInDefaultMode(vt)}_setActiveInWrapMode(vt){const Gt=this._getItemsArray();for(let fe=1;fe<=Gt.length;fe++){const He=(this._activeItemIndex+vt*fe+Gt.length)%Gt.length;if(!this._skipPredicateFn(Gt[He]))return void this.setActiveItem(He)}}_setActiveInDefaultMode(vt){this._setActiveItemByIndex(this._activeItemIndex+vt,vt)}_setActiveItemByIndex(vt,Gt){const fe=this._getItemsArray();if(fe[vt]){for(;this._skipPredicateFn(fe[vt]);)if(!fe[vt+=Gt])return;this.setActiveItem(vt)}}_getItemsArray(){return this._items instanceof m.n_E?this._items.toArray():this._items}}class Lt extends xt{setActiveItem(vt){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(vt),this.activeItem&&this.activeItem.setActiveStyles()}}class de extends xt{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(vt){return this._origin=vt,this}setActiveItem(vt){super.setActiveItem(vt),this.activeItem&&this.activeItem.focus(this._origin)}}let ce=(()=>{class Vt{constructor(Gt){this._platform=Gt}isDisabled(Gt){return Gt.hasAttribute("disabled")}isVisible(Gt){return function Ne(Vt){return!!(Vt.offsetWidth||Vt.offsetHeight||"function"==typeof Vt.getClientRects&&Vt.getClientRects().length)}(Gt)&&"visible"===getComputedStyle(Gt).visibility}isTabbable(Gt){if(!this._platform.isBrowser)return!1;const fe=function Ae(Vt){try{return Vt.frameElement}catch(vt){return null}}(function Dt(Vt){return Vt.ownerDocument&&Vt.ownerDocument.defaultView||window}(Gt));if(fe&&(-1===Ie(fe)||!this.isVisible(fe)))return!1;let He=Gt.nodeName.toLowerCase(),$i=Ie(Gt);return Gt.hasAttribute("contenteditable")?-1!==$i:!("iframe"===He||"object"===He||this._platform.WEBKIT&&this._platform.IOS&&!function Xt(Vt){let vt=Vt.nodeName.toLowerCase(),Gt="input"===vt&&Vt.type;return"text"===Gt||"password"===Gt||"select"===vt||"textarea"===vt}(Gt))&&("audio"===He?!!Gt.hasAttribute("controls")&&-1!==$i:"video"===He?-1!==$i&&(null!==$i||this._platform.FIREFOX||Gt.hasAttribute("controls")):Gt.tabIndex>=0)}isFocusable(Gt,fe){return function he(Vt){return!function Di(Vt){return function Me(Vt){return"input"==Vt.nodeName.toLowerCase()}(Vt)&&"hidden"==Vt.type}(Vt)&&(function qe(Vt){let vt=Vt.nodeName.toLowerCase();return"input"===vt||"select"===vt||"button"===vt||"textarea"===vt}(Vt)||function ei(Vt){return function ri(Vt){return"a"==Vt.nodeName.toLowerCase()}(Vt)&&Vt.hasAttribute("href")}(Vt)||Vt.hasAttribute("contenteditable")||Bt(Vt))}(Gt)&&!this.isDisabled(Gt)&&((null==fe?void 0:fe.ignoreVisibility)||this.isVisible(Gt))}}return Vt.\u0275fac=function(Gt){return new(Gt||Vt)(m.LFG(gt.t4))},Vt.\u0275prov=m.Yz7({token:Vt,factory:Vt.\u0275fac,providedIn:"root"}),Vt})();function Bt(Vt){if(!Vt.hasAttribute("tabindex")||void 0===Vt.tabIndex)return!1;let vt=Vt.getAttribute("tabindex");return!(!vt||isNaN(parseInt(vt,10)))}function Ie(Vt){if(!Bt(Vt))return null;const vt=parseInt(Vt.getAttribute("tabindex")||"",10);return isNaN(vt)?-1:vt}class ve{constructor(vt,Gt,fe,He,$i=!1){this._element=vt,this._checker=Gt,this._ngZone=fe,this._document=He,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,$i||this.attachAnchors()}get enabled(){return this._enabled}set enabled(vt){this._enabled=vt,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(vt,this._startAnchor),this._toggleAnchorTabIndex(vt,this._endAnchor))}destroy(){const vt=this._startAnchor,Gt=this._endAnchor;vt&&(vt.removeEventListener("focus",this.startAnchorListener),vt.remove()),Gt&&(Gt.removeEventListener("focus",this.endAnchorListener),Gt.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(vt){return new Promise(Gt=>{this._executeOnStable(()=>Gt(this.focusInitialElement(vt)))})}focusFirstTabbableElementWhenReady(vt){return new Promise(Gt=>{this._executeOnStable(()=>Gt(this.focusFirstTabbableElement(vt)))})}focusLastTabbableElementWhenReady(vt){return new Promise(Gt=>{this._executeOnStable(()=>Gt(this.focusLastTabbableElement(vt)))})}_getRegionBoundary(vt){const Gt=this._element.querySelectorAll(`[cdk-focus-region-${vt}], [cdkFocusRegion${vt}], [cdk-focus-${vt}]`);return"start"==vt?Gt.length?Gt[0]:this._getFirstTabbableElement(this._element):Gt.length?Gt[Gt.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(vt){const Gt=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(Gt){if(!this._checker.isFocusable(Gt)){const fe=this._getFirstTabbableElement(Gt);return null==fe||fe.focus(vt),!!fe}return Gt.focus(vt),!0}return this.focusFirstTabbableElement(vt)}focusFirstTabbableElement(vt){const Gt=this._getRegionBoundary("start");return Gt&&Gt.focus(vt),!!Gt}focusLastTabbableElement(vt){const Gt=this._getRegionBoundary("end");return Gt&&Gt.focus(vt),!!Gt}hasAttached(){return this._hasAttached}_getFirstTabbableElement(vt){if(this._checker.isFocusable(vt)&&this._checker.isTabbable(vt))return vt;const Gt=vt.children;for(let fe=0;fe<Gt.length;fe++){const He=Gt[fe].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(Gt[fe]):null;if(He)return He}return null}_getLastTabbableElement(vt){if(this._checker.isFocusable(vt)&&this._checker.isTabbable(vt))return vt;const Gt=vt.children;for(let fe=Gt.length-1;fe>=0;fe--){const He=Gt[fe].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(Gt[fe]):null;if(He)return He}return null}_createAnchor(){const vt=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,vt),vt.classList.add("cdk-visually-hidden"),vt.classList.add("cdk-focus-trap-anchor"),vt.setAttribute("aria-hidden","true"),vt}_toggleAnchorTabIndex(vt,Gt){vt?Gt.setAttribute("tabindex","0"):Gt.removeAttribute("tabindex")}toggleAnchors(vt){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(vt,this._startAnchor),this._toggleAnchorTabIndex(vt,this._endAnchor))}_executeOnStable(vt){this._ngZone.isStable?vt():this._ngZone.onStable.pipe((0,W.q)(1)).subscribe(vt)}}let je=(()=>{class Vt{constructor(Gt,fe,He){this._checker=Gt,this._ngZone=fe,this._document=He}create(Gt,fe=!1){return new ve(Gt,this._checker,this._ngZone,this._document,fe)}}return Vt.\u0275fac=function(Gt){return new(Gt||Vt)(m.LFG(ce),m.LFG(m.R0b),m.LFG(C.K0))},Vt.\u0275prov=m.Yz7({token:Vt,factory:Vt.\u0275fac,providedIn:"root"}),Vt})();function me(Vt){return 0===Vt.offsetX&&0===Vt.offsetY}function ye(Vt){const vt=Vt.touches&&Vt.touches[0]||Vt.changedTouches&&Vt.changedTouches[0];return!(!vt||-1!==vt.identifier||null!=vt.radiusX&&1!==vt.radiusX||null!=vt.radiusY&&1!==vt.radiusY)}const Kt=new m.OlP("cdk-input-modality-detector-options"),Zt={ignoreKeys:[r.zL,r.jx,r.b2,r.MW,r.JU]},$e=(0,gt.i$)({passive:!0,capture:!0});let Ti=(()=>{class Vt{constructor(Gt,fe,He,$i){this._platform=Gt,this._mostRecentTarget=null,this._modality=new n.X(null),this._lastTouchMs=0,this._onKeydown=tn=>{var In,no;(null===(no=null===(In=this._options)||void 0===In?void 0:In.ignoreKeys)||void 0===no?void 0:no.some(li=>li===tn.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=(0,gt.sA)(tn))},this._onMousedown=tn=>{Date.now()-this._lastTouchMs<650||(this._modality.next(me(tn)?"keyboard":"mouse"),this._mostRecentTarget=(0,gt.sA)(tn))},this._onTouchstart=tn=>{ye(tn)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=(0,gt.sA)(tn))},this._options=Object.assign(Object.assign({},Zt),$i),this.modalityDetected=this._modality.pipe((0,nt.T)(1)),this.modalityChanged=this.modalityDetected.pipe((0,et.x)()),Gt.isBrowser&&fe.runOutsideAngular(()=>{He.addEventListener("keydown",this._onKeydown,$e),He.addEventListener("mousedown",this._onMousedown,$e),He.addEventListener("touchstart",this._onTouchstart,$e)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,$e),document.removeEventListener("mousedown",this._onMousedown,$e),document.removeEventListener("touchstart",this._onTouchstart,$e))}}return Vt.\u0275fac=function(Gt){return new(Gt||Vt)(m.LFG(gt.t4),m.LFG(m.R0b),m.LFG(C.K0),m.LFG(Kt,8))},Vt.\u0275prov=m.Yz7({token:Vt,factory:Vt.\u0275fac,providedIn:"root"}),Vt})();const vi=new m.OlP("liveAnnouncerElement",{providedIn:"root",factory:function di(){return null}}),Gi=new m.OlP("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let Ri=(()=>{class Vt{constructor(Gt,fe,He,$i){this._ngZone=fe,this._defaultOptions=$i,this._document=He,this._liveElement=Gt||this._createLiveElement()}announce(Gt,...fe){const He=this._defaultOptions;let $i,tn;return 1===fe.length&&"number"==typeof fe[0]?tn=fe[0]:[$i,tn]=fe,this.clear(),clearTimeout(this._previousTimeout),$i||($i=He&&He.politeness?He.politeness:"polite"),null==tn&&He&&(tn=He.duration),this._liveElement.setAttribute("aria-live",$i),this._ngZone.runOutsideAngular(()=>new Promise(In=>{clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=Gt,In(),"number"==typeof tn&&(this._previousTimeout=setTimeout(()=>this.clear(),tn))},100)}))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){var Gt;clearTimeout(this._previousTimeout),null===(Gt=this._liveElement)||void 0===Gt||Gt.remove(),this._liveElement=null}_createLiveElement(){const Gt="cdk-live-announcer-element",fe=this._document.getElementsByClassName(Gt),He=this._document.createElement("div");for(let $i=0;$i<fe.length;$i++)fe[$i].remove();return He.classList.add(Gt),He.classList.add("cdk-visually-hidden"),He.setAttribute("aria-atomic","true"),He.setAttribute("aria-live","polite"),this._document.body.appendChild(He),He}}return Vt.\u0275fac=function(Gt){return new(Gt||Vt)(m.LFG(vi,8),m.LFG(m.R0b),m.LFG(C.K0),m.LFG(Gi,8))},Vt.\u0275prov=m.Yz7({token:Vt,factory:Vt.\u0275fac,providedIn:"root"}),Vt})();const ge=new m.OlP("cdk-focus-monitor-default-options"),De=(0,gt.i$)({passive:!0,capture:!0});let _i=(()=>{class Vt{constructor(Gt,fe,He,$i,tn){this._ngZone=Gt,this._platform=fe,this._inputModalityDetector=He,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new e.x,this._rootNodeFocusAndBlurListener=In=>{const no=(0,gt.sA)(In),li="focus"===In.type?this._onFocus:this._onBlur;for(let Je=no;Je;Je=Je.parentElement)li.call(this,In,Je)},this._document=$i,this._detectionMode=(null==tn?void 0:tn.detectionMode)||0}monitor(Gt,fe=!1){const He=(0,It.fI)(Gt);if(!this._platform.isBrowser||1!==He.nodeType)return(0,o.of)(null);const $i=(0,gt.kV)(He)||this._getDocument(),tn=this._elementInfo.get(He);if(tn)return fe&&(tn.checkChildren=!0),tn.subject;const In={checkChildren:fe,subject:new e.x,rootNode:$i};return this._elementInfo.set(He,In),this._registerGlobalListeners(In),In.subject}stopMonitoring(Gt){const fe=(0,It.fI)(Gt),He=this._elementInfo.get(fe);He&&(He.subject.complete(),this._setClasses(fe),this._elementInfo.delete(fe),this._removeGlobalListeners(He))}focusVia(Gt,fe,He){const $i=(0,It.fI)(Gt);$i===this._getDocument().activeElement?this._getClosestElementsInfo($i).forEach(([In,no])=>this._originChanged(In,fe,no)):(this._setOrigin(fe),"function"==typeof $i.focus&&$i.focus(He))}ngOnDestroy(){this._elementInfo.forEach((Gt,fe)=>this.stopMonitoring(fe))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(Gt){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(Gt)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(Gt){return 1===this._detectionMode||!!(null==Gt?void 0:Gt.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(Gt,fe){Gt.classList.toggle("cdk-focused",!!fe),Gt.classList.toggle("cdk-touch-focused","touch"===fe),Gt.classList.toggle("cdk-keyboard-focused","keyboard"===fe),Gt.classList.toggle("cdk-mouse-focused","mouse"===fe),Gt.classList.toggle("cdk-program-focused","program"===fe)}_setOrigin(Gt,fe=!1){this._ngZone.runOutsideAngular(()=>{this._origin=Gt,this._originFromTouchInteraction="touch"===Gt&&fe,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(Gt,fe){const He=this._elementInfo.get(fe),$i=(0,gt.sA)(Gt);!He||!He.checkChildren&&fe!==$i||this._originChanged(fe,this._getFocusOrigin($i),He)}_onBlur(Gt,fe){const He=this._elementInfo.get(fe);!He||He.checkChildren&&Gt.relatedTarget instanceof Node&&fe.contains(Gt.relatedTarget)||(this._setClasses(fe),this._emitOrigin(He.subject,null))}_emitOrigin(Gt,fe){this._ngZone.run(()=>Gt.next(fe))}_registerGlobalListeners(Gt){if(!this._platform.isBrowser)return;const fe=Gt.rootNode,He=this._rootNodeFocusListenerCount.get(fe)||0;He||this._ngZone.runOutsideAngular(()=>{fe.addEventListener("focus",this._rootNodeFocusAndBlurListener,De),fe.addEventListener("blur",this._rootNodeFocusAndBlurListener,De)}),this._rootNodeFocusListenerCount.set(fe,He+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe((0,Et.R)(this._stopInputModalityDetector)).subscribe($i=>{this._setOrigin($i,!0)}))}_removeGlobalListeners(Gt){const fe=Gt.rootNode;if(this._rootNodeFocusListenerCount.has(fe)){const He=this._rootNodeFocusListenerCount.get(fe);He>1?this._rootNodeFocusListenerCount.set(fe,He-1):(fe.removeEventListener("focus",this._rootNodeFocusAndBlurListener,De),fe.removeEventListener("blur",this._rootNodeFocusAndBlurListener,De),this._rootNodeFocusListenerCount.delete(fe))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(Gt,fe,He){this._setClasses(Gt,fe),this._emitOrigin(He.subject,fe),this._lastFocusOrigin=fe}_getClosestElementsInfo(Gt){const fe=[];return this._elementInfo.forEach((He,$i)=>{($i===Gt||He.checkChildren&&$i.contains(Gt))&&fe.push([$i,He])}),fe}}return Vt.\u0275fac=function(Gt){return new(Gt||Vt)(m.LFG(m.R0b),m.LFG(gt.t4),m.LFG(Ti),m.LFG(C.K0,8),m.LFG(ge,8))},Vt.\u0275prov=m.Yz7({token:Vt,factory:Vt.\u0275fac,providedIn:"root"}),Vt})(),yi=(()=>{class Vt{constructor(Gt,fe){this._elementRef=Gt,this._focusMonitor=fe,this.cdkFocusChange=new m.vpe}ngAfterViewInit(){const Gt=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(Gt,1===Gt.nodeType&&Gt.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(fe=>this.cdkFocusChange.emit(fe))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return Vt.\u0275fac=function(Gt){return new(Gt||Vt)(m.Y36(m.SBq),m.Y36(_i))},Vt.\u0275dir=m.lG2({type:Vt,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"}}),Vt})();const Fi="cdk-high-contrast-black-on-white",Ni="cdk-high-contrast-white-on-black",mn="cdk-high-contrast-active";let si=(()=>{class Vt{constructor(Gt,fe){this._platform=Gt,this._document=fe}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const Gt=this._document.createElement("div");Gt.style.backgroundColor="rgb(1,2,3)",Gt.style.position="absolute",this._document.body.appendChild(Gt);const fe=this._document.defaultView||window,He=fe&&fe.getComputedStyle?fe.getComputedStyle(Gt):null,$i=(He&&He.backgroundColor||"").replace(/ /g,"");switch(Gt.remove(),$i){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const Gt=this._document.body.classList;Gt.remove(mn),Gt.remove(Fi),Gt.remove(Ni),this._hasCheckedHighContrastMode=!0;const fe=this.getHighContrastMode();1===fe?(Gt.add(mn),Gt.add(Fi)):2===fe&&(Gt.add(mn),Gt.add(Ni))}}}return Vt.\u0275fac=function(Gt){return new(Gt||Vt)(m.LFG(gt.t4),m.LFG(C.K0))},Vt.\u0275prov=m.Yz7({token:Vt,factory:Vt.\u0275fac,providedIn:"root"}),Vt})(),Ce=(()=>{class Vt{constructor(Gt){Gt._applyBodyHighContrastModeCssClasses()}}return Vt.\u0275fac=function(Gt){return new(Gt||Vt)(m.LFG(si))},Vt.\u0275mod=m.oAB({type:Vt}),Vt.\u0275inj=m.cJS({imports:[[gt.ud,wt.Q8]]}),Vt})()},50226:(B,X,_)=>{"use strict";_.d(X,{vT:()=>h,Is:()=>r});var C=_(5e3),m=_(69808);const e=new C.OlP("cdk-dir-doc",{providedIn:"root",factory:function t(){return(0,C.f3M)(m.K0)}}),n=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let r=(()=>{class R{constructor(W){if(this.value="ltr",this.change=new C.vpe,W){const et=W.documentElement?W.documentElement.dir:null;this.value=function o(R){const L=(null==R?void 0:R.toLowerCase())||"";return"auto"===L&&"undefined"!=typeof navigator&&(null==navigator?void 0:navigator.language)?n.test(navigator.language)?"rtl":"ltr":"rtl"===L?"rtl":"ltr"}((W.body?W.body.dir:null)||et||"ltr")}}ngOnDestroy(){this.change.complete()}}return R.\u0275fac=function(W){return new(W||R)(C.LFG(e,8))},R.\u0275prov=C.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})(),h=(()=>{class R{}return R.\u0275fac=function(W){return new(W||R)},R.\u0275mod=C.oAB({type:R}),R.\u0275inj=C.cJS({}),R})()},63191:(B,X,_)=>{"use strict";_.d(X,{Eq:()=>n,Ig:()=>m,HM:()=>o,fI:()=>r,su:()=>e,du:()=>a});var C=_(5e3);function m(h){return null!=h&&"false"!=`${h}`}function e(h,R=0){return function t(h){return!isNaN(parseFloat(h))&&!isNaN(Number(h))}(h)?Number(h):R}function n(h){return Array.isArray(h)?h:[h]}function o(h){return null==h?"":"string"==typeof h?h:`${h}px`}function r(h){return h instanceof C.SBq?h.nativeElement:h}function a(h,R=/\s+/){const L=[];if(null!=h){const W=Array.isArray(h)?h:`${h}`.split(R);for(const nt of W){const et=`${nt}`.trim();et&&L.push(et)}}return L}},91159:(B,X,_)=>{"use strict";_.d(X,{A:()=>qe,zL:()=>a,ZH:()=>m,jx:()=>r,yY:()=>ft,JH:()=>Jt,uR:()=>Et,K5:()=>n,hY:()=>L,Sd:()=>It,oh:()=>gt,b2:()=>qn,MW:()=>di,aO:()=>de,VM:()=>et,Ku:()=>nt,SV:()=>Ut,JU:()=>o,L_:()=>W,Mf:()=>e,LH:()=>wt,Z:()=>vi,xE:()=>lt,Vb:()=>ao});const m=8,e=9,n=13,o=16,r=17,a=18,L=27,W=32,nt=33,et=34,Et=35,It=36,gt=37,wt=38,Ut=39,Jt=40,ft=46,lt=48,de=57,qe=65,vi=90,di=91,qn=224;function ao(lo,...Rn){return Rn.length?Rn.some(Kr=>lo[Kr]):lo.altKey||lo.shiftKey||lo.ctrlKey||lo.metaKey}},95113:(B,X,_)=>{"use strict";_.d(X,{Yg:()=>Jt,u3:()=>bt});var C=_(5e3),m=_(63191),e=_(77579),t=_(39841),n=_(97272),o=_(68306),r=_(95698),a=_(35684),h=_(78372),R=_(54004),L=_(68675),W=_(82722),nt=_(70925);const Et=new Set;let It,gt=(()=>{class at{constructor(lt){this._platform=lt,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Ut}matchMedia(lt){return(this._platform.WEBKIT||this._platform.BLINK)&&function wt(at){if(!Et.has(at))try{It||(It=document.createElement("style"),It.setAttribute("type","text/css"),document.head.appendChild(It)),It.sheet&&(It.sheet.insertRule(`@media ${at} {body{ }}`,0),Et.add(at))}catch(ft){console.error(ft)}}(lt),this._matchMedia(lt)}}return at.\u0275fac=function(lt){return new(lt||at)(C.LFG(nt.t4))},at.\u0275prov=C.Yz7({token:at,factory:at.\u0275fac,providedIn:"root"}),at})();function Ut(at){return{matches:"all"===at||""===at,media:at,addListener:()=>{},removeListener:()=>{}}}let Jt=(()=>{class at{constructor(lt,Ft){this._mediaMatcher=lt,this._zone=Ft,this._queries=new Map,this._destroySubject=new e.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(lt){return Ct((0,m.Eq)(lt)).some(Mt=>this._registerQuery(Mt).mql.matches)}observe(lt){const Mt=Ct((0,m.Eq)(lt)).map(ct=>this._registerQuery(ct).observable);let yt=(0,t.a)(Mt);return yt=(0,n.z)(yt.pipe((0,r.q)(1)),yt.pipe((0,a.T)(1),(0,h.b)(0))),yt.pipe((0,R.U)(ct=>{const rt={matches:!1,breakpoints:{}};return ct.forEach(({matches:se,query:xt})=>{rt.matches=rt.matches||se,rt.breakpoints[xt]=se}),rt}))}_registerQuery(lt){if(this._queries.has(lt))return this._queries.get(lt);const Ft=this._mediaMatcher.matchMedia(lt),yt={observable:new o.y(ct=>{const rt=se=>this._zone.run(()=>ct.next(se));return Ft.addListener(rt),()=>{Ft.removeListener(rt)}}).pipe((0,L.O)(Ft),(0,R.U)(({matches:ct})=>({query:lt,matches:ct})),(0,W.R)(this._destroySubject)),mql:Ft};return this._queries.set(lt,yt),yt}}return at.\u0275fac=function(lt){return new(lt||at)(C.LFG(gt),C.LFG(C.R0b))},at.\u0275prov=C.Yz7({token:at,factory:at.\u0275fac,providedIn:"root"}),at})();function Ct(at){return at.map(ft=>ft.split(",")).reduce((ft,lt)=>ft.concat(lt)).map(ft=>ft.trim())}const bt={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"}},17144:(B,X,_)=>{"use strict";_.d(X,{wD:()=>a,Q8:()=>h});var C=_(63191),m=_(5e3),e=_(68306),t=_(77579),n=_(78372);let o=(()=>{class R{create(W){return"undefined"==typeof MutationObserver?null:new MutationObserver(W)}}return R.\u0275fac=function(W){return new(W||R)},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})(),r=(()=>{class R{constructor(W){this._mutationObserverFactory=W,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((W,nt)=>this._cleanupObserver(nt))}observe(W){const nt=(0,C.fI)(W);return new e.y(et=>{const It=this._observeElement(nt).subscribe(et);return()=>{It.unsubscribe(),this._unobserveElement(nt)}})}_observeElement(W){if(this._observedElements.has(W))this._observedElements.get(W).count++;else{const nt=new t.x,et=this._mutationObserverFactory.create(Et=>nt.next(Et));et&&et.observe(W,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(W,{observer:et,stream:nt,count:1})}return this._observedElements.get(W).stream}_unobserveElement(W){this._observedElements.has(W)&&(this._observedElements.get(W).count--,this._observedElements.get(W).count||this._cleanupObserver(W))}_cleanupObserver(W){if(this._observedElements.has(W)){const{observer:nt,stream:et}=this._observedElements.get(W);nt&&nt.disconnect(),et.complete(),this._observedElements.delete(W)}}}return R.\u0275fac=function(W){return new(W||R)(m.LFG(o))},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})(),a=(()=>{class R{constructor(W,nt,et){this._contentObserver=W,this._elementRef=nt,this._ngZone=et,this.event=new m.vpe,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(W){this._disabled=(0,C.Ig)(W),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(W){this._debounce=(0,C.su)(W),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const W=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?W.pipe((0,n.b)(this.debounce)):W).subscribe(this.event)})}_unsubscribe(){var W;null===(W=this._currentSubscription)||void 0===W||W.unsubscribe()}}return R.\u0275fac=function(W){return new(W||R)(m.Y36(r),m.Y36(m.SBq),m.Y36(m.R0b))},R.\u0275dir=m.lG2({type:R,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),R})(),h=(()=>{class R{}return R.\u0275fac=function(W){return new(W||R)},R.\u0275mod=m.oAB({type:R}),R.\u0275inj=m.cJS({providers:[o]}),R})()},91314:(B,X,_)=>{"use strict";_.d(X,{aV:()=>ri,X_:()=>bt,Xj:()=>ct,U8:()=>je});var C=_(30495),m=_(69808),e=_(5e3),t=_(63191),n=_(70925),o=_(50226),r=_(47429),a=_(77579),h=_(50727),R=_(56451),L=_(95698),W=_(82722);const nt=(0,n.Mq)();class et{constructor(ne,ee){this._viewportRuler=ne,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=ee}attach(){}enable(){if(this._canBeEnabled()){const ne=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=ne.style.left||"",this._previousHTMLStyles.top=ne.style.top||"",ne.style.left=(0,t.HM)(-this._previousScrollPosition.left),ne.style.top=(0,t.HM)(-this._previousScrollPosition.top),ne.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const ne=this._document.documentElement,Oe=ne.style,le=this._document.body.style,me=Oe.scrollBehavior||"",ye=le.scrollBehavior||"";this._isEnabled=!1,Oe.left=this._previousHTMLStyles.left,Oe.top=this._previousHTMLStyles.top,ne.classList.remove("cdk-global-scrollblock"),nt&&(Oe.scrollBehavior=le.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),nt&&(Oe.scrollBehavior=me,le.scrollBehavior=ye)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const ee=this._document.body,Oe=this._viewportRuler.getViewportSize();return ee.scrollHeight>Oe.height||ee.scrollWidth>Oe.width}}class It{constructor(ne,ee,Oe,le){this._scrollDispatcher=ne,this._ngZone=ee,this._viewportRuler=Oe,this._config=le,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(ne){this._overlayRef=ne}enable(){if(this._scrollSubscription)return;const ne=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=ne.subscribe(()=>{const ee=this._viewportRuler.getViewportScrollPosition().top;Math.abs(ee-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=ne.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class gt{enable(){}disable(){}attach(){}}function wt(Ee,ne){return ne.some(ee=>Ee.bottom<ee.top||Ee.top>ee.bottom||Ee.right<ee.left||Ee.left>ee.right)}function Ut(Ee,ne){return ne.some(ee=>Ee.top<ee.top||Ee.bottom>ee.bottom||Ee.left<ee.left||Ee.right>ee.right)}class Jt{constructor(ne,ee,Oe,le){this._scrollDispatcher=ne,this._viewportRuler=ee,this._ngZone=Oe,this._config=le,this._scrollSubscription=null}attach(ne){this._overlayRef=ne}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const ee=this._overlayRef.overlayElement.getBoundingClientRect(),{width:Oe,height:le}=this._viewportRuler.getViewportSize();wt(ee,[{width:Oe,height:le,bottom:le,right:Oe,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Ct=(()=>{class Ee{constructor(ee,Oe,le,me){this._scrollDispatcher=ee,this._viewportRuler=Oe,this._ngZone=le,this.noop=()=>new gt,this.close=ye=>new It(this._scrollDispatcher,this._ngZone,this._viewportRuler,ye),this.block=()=>new et(this._viewportRuler,this._document),this.reposition=ye=>new Jt(this._scrollDispatcher,this._viewportRuler,this._ngZone,ye),this._document=me}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(e.LFG(C.mF),e.LFG(C.rL),e.LFG(e.R0b),e.LFG(m.K0))},Ee.\u0275prov=e.Yz7({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee})();class bt{constructor(ne){if(this.scrollStrategy=new gt,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,ne){const ee=Object.keys(ne);for(const Oe of ee)void 0!==ne[Oe]&&(this[Oe]=ne[Oe])}}}class lt{constructor(ne,ee){this.connectionPair=ne,this.scrollableViewProperties=ee}}class yt{constructor(ne,ee,Oe,le,me,ye,Kt,Zt,We){this._portalOutlet=ne,this._host=ee,this._pane=Oe,this._config=le,this._ngZone=me,this._keyboardDispatcher=ye,this._document=Kt,this._location=Zt,this._outsideClickDispatcher=We,this._backdropElement=null,this._backdropClick=new a.x,this._attachments=new a.x,this._detachments=new a.x,this._locationChanges=h.w0.EMPTY,this._backdropClickHandler=$e=>this._backdropClick.next($e),this._keydownEvents=new a.x,this._outsidePointerEvents=new a.x,le.scrollStrategy&&(this._scrollStrategy=le.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=le.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(ne){let ee=this._portalOutlet.attach(ne);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe((0,L.q)(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),ee}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const ne=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),ne}dispose(){var ne;const ee=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),null===(ne=this._host)||void 0===ne||ne.remove(),this._previousHostParent=this._pane=this._host=null,ee&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(ne){ne!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=ne,this.hasAttached()&&(ne.attach(this),this.updatePosition()))}updateSize(ne){this._config=Object.assign(Object.assign({},this._config),ne),this._updateElementSize()}setDirection(ne){this._config=Object.assign(Object.assign({},this._config),{direction:ne}),this._updateElementDirection()}addPanelClass(ne){this._pane&&this._toggleClasses(this._pane,ne,!0)}removePanelClass(ne){this._pane&&this._toggleClasses(this._pane,ne,!1)}getDirection(){const ne=this._config.direction;return ne?"string"==typeof ne?ne:ne.value:"ltr"}updateScrollStrategy(ne){ne!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=ne,this.hasAttached()&&(ne.attach(this),ne.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const ne=this._pane.style;ne.width=(0,t.HM)(this._config.width),ne.height=(0,t.HM)(this._config.height),ne.minWidth=(0,t.HM)(this._config.minWidth),ne.minHeight=(0,t.HM)(this._config.minHeight),ne.maxWidth=(0,t.HM)(this._config.maxWidth),ne.maxHeight=(0,t.HM)(this._config.maxHeight)}_togglePointerEvents(ne){this._pane.style.pointerEvents=ne?"":"none"}_attachBackdrop(){const ne="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(ne)})}):this._backdropElement.classList.add(ne)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const ne=this._backdropElement;if(!ne)return;let ee;const Oe=()=>{ne&&(ne.removeEventListener("click",this._backdropClickHandler),ne.removeEventListener("transitionend",Oe),this._disposeBackdrop(ne)),this._config.backdropClass&&this._toggleClasses(ne,this._config.backdropClass,!1),clearTimeout(ee)};ne.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{ne.addEventListener("transitionend",Oe)}),ne.style.pointerEvents="none",ee=this._ngZone.runOutsideAngular(()=>setTimeout(Oe,500))}_toggleClasses(ne,ee,Oe){const le=(0,t.Eq)(ee||[]).filter(me=>!!me);le.length&&(Oe?ne.classList.add(...le):ne.classList.remove(...le))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const ne=this._ngZone.onStable.pipe((0,W.R)((0,R.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),ne.unsubscribe())})})}_disposeScrollStrategy(){const ne=this._scrollStrategy;ne&&(ne.disable(),ne.detach&&ne.detach())}_disposeBackdrop(ne){ne&&(ne.remove(),this._backdropElement===ne&&(this._backdropElement=null))}}let ct=(()=>{class Ee{constructor(ee,Oe){this._platform=Oe,this._document=ee}ngOnDestroy(){var ee;null===(ee=this._containerElement)||void 0===ee||ee.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const ee="cdk-overlay-container";if(this._platform.isBrowser||(0,n.Oy)()){const le=this._document.querySelectorAll(`.${ee}[platform="server"], .${ee}[platform="test"]`);for(let me=0;me<le.length;me++)le[me].remove()}const Oe=this._document.createElement("div");Oe.classList.add(ee),(0,n.Oy)()?Oe.setAttribute("platform","test"):this._platform.isBrowser||Oe.setAttribute("platform","server"),this._document.body.appendChild(Oe),this._containerElement=Oe}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(e.LFG(m.K0),e.LFG(n.t4))},Ee.\u0275prov=e.Yz7({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee})();const rt="cdk-overlay-connected-position-bounding-box",se=/([A-Za-z%]+)$/;class xt{constructor(ne,ee,Oe,le,me){this._viewportRuler=ee,this._document=Oe,this._platform=le,this._overlayContainer=me,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new a.x,this._resizeSubscription=h.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(ne)}get positions(){return this._preferredPositions}attach(ne){this._validatePositions(),ne.hostElement.classList.add(rt),this._overlayRef=ne,this._boundingBox=ne.hostElement,this._pane=ne.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const ne=this._originRect,ee=this._overlayRect,Oe=this._viewportRect,le=[];let me;for(let ye of this._preferredPositions){let Kt=this._getOriginPoint(ne,ye),Zt=this._getOverlayPoint(Kt,ee,ye),We=this._getOverlayFit(Zt,ee,Oe,ye);if(We.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(ye,Kt);this._canFitWithFlexibleDimensions(We,Zt,Oe)?le.push({position:ye,origin:Kt,overlayRect:ee,boundingBoxRect:this._calculateBoundingBoxRect(Kt,ye)}):(!me||me.overlayFit.visibleArea<We.visibleArea)&&(me={overlayFit:We,overlayPoint:Zt,originPoint:Kt,position:ye,overlayRect:ee})}if(le.length){let ye=null,Kt=-1;for(const Zt of le){const We=Zt.boundingBoxRect.width*Zt.boundingBoxRect.height*(Zt.position.weight||1);We>Kt&&(Kt=We,ye=Zt)}return this._isPushed=!1,void this._applyPosition(ye.position,ye.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(me.position,me.originPoint);this._applyPosition(me.position,me.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Lt(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(rt),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const ne=this._lastPosition||this._preferredPositions[0],ee=this._getOriginPoint(this._originRect,ne);this._applyPosition(ne,ee)}}withScrollableContainers(ne){return this._scrollables=ne,this}withPositions(ne){return this._preferredPositions=ne,-1===ne.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(ne){return this._viewportMargin=ne,this}withFlexibleDimensions(ne=!0){return this._hasFlexibleDimensions=ne,this}withGrowAfterOpen(ne=!0){return this._growAfterOpen=ne,this}withPush(ne=!0){return this._canPush=ne,this}withLockedPosition(ne=!0){return this._positionLocked=ne,this}setOrigin(ne){return this._origin=ne,this}withDefaultOffsetX(ne){return this._offsetX=ne,this}withDefaultOffsetY(ne){return this._offsetY=ne,this}withTransformOriginOn(ne){return this._transformOriginSelector=ne,this}_getOriginPoint(ne,ee){let Oe,le;if("center"==ee.originX)Oe=ne.left+ne.width/2;else{const me=this._isRtl()?ne.right:ne.left,ye=this._isRtl()?ne.left:ne.right;Oe="start"==ee.originX?me:ye}return le="center"==ee.originY?ne.top+ne.height/2:"top"==ee.originY?ne.top:ne.bottom,{x:Oe,y:le}}_getOverlayPoint(ne,ee,Oe){let le,me;return le="center"==Oe.overlayX?-ee.width/2:"start"===Oe.overlayX?this._isRtl()?-ee.width:0:this._isRtl()?0:-ee.width,me="center"==Oe.overlayY?-ee.height/2:"top"==Oe.overlayY?0:-ee.height,{x:ne.x+le,y:ne.y+me}}_getOverlayFit(ne,ee,Oe,le){const me=_e(ee);let{x:ye,y:Kt}=ne,Zt=this._getOffset(le,"x"),We=this._getOffset(le,"y");Zt&&(ye+=Zt),We&&(Kt+=We);let vi=0-Kt,di=Kt+me.height-Oe.height,Gi=this._subtractOverflows(me.width,0-ye,ye+me.width-Oe.width),Ri=this._subtractOverflows(me.height,vi,di),rn=Gi*Ri;return{visibleArea:rn,isCompletelyWithinViewport:me.width*me.height===rn,fitsInViewportVertically:Ri===me.height,fitsInViewportHorizontally:Gi==me.width}}_canFitWithFlexibleDimensions(ne,ee,Oe){if(this._hasFlexibleDimensions){const le=Oe.bottom-ee.y,me=Oe.right-ee.x,ye=de(this._overlayRef.getConfig().minHeight),Kt=de(this._overlayRef.getConfig().minWidth),We=ne.fitsInViewportHorizontally||null!=Kt&&Kt<=me;return(ne.fitsInViewportVertically||null!=ye&&ye<=le)&&We}return!1}_pushOverlayOnScreen(ne,ee,Oe){if(this._previousPushAmount&&this._positionLocked)return{x:ne.x+this._previousPushAmount.x,y:ne.y+this._previousPushAmount.y};const le=_e(ee),me=this._viewportRect,ye=Math.max(ne.x+le.width-me.width,0),Kt=Math.max(ne.y+le.height-me.height,0),Zt=Math.max(me.top-Oe.top-ne.y,0),We=Math.max(me.left-Oe.left-ne.x,0);let $e=0,Ti=0;return $e=le.width<=me.width?We||-ye:ne.x<this._viewportMargin?me.left-Oe.left-ne.x:0,Ti=le.height<=me.height?Zt||-Kt:ne.y<this._viewportMargin?me.top-Oe.top-ne.y:0,this._previousPushAmount={x:$e,y:Ti},{x:ne.x+$e,y:ne.y+Ti}}_applyPosition(ne,ee){if(this._setTransformOrigin(ne),this._setOverlayElementStyles(ee,ne),this._setBoundingBoxStyles(ee,ne),ne.panelClass&&this._addPanelClasses(ne.panelClass),this._lastPosition=ne,this._positionChanges.observers.length){const Oe=this._getScrollVisibility(),le=new lt(ne,Oe);this._positionChanges.next(le)}this._isInitialRender=!1}_setTransformOrigin(ne){if(!this._transformOriginSelector)return;const ee=this._boundingBox.querySelectorAll(this._transformOriginSelector);let Oe,le=ne.overlayY;Oe="center"===ne.overlayX?"center":this._isRtl()?"start"===ne.overlayX?"right":"left":"start"===ne.overlayX?"left":"right";for(let me=0;me<ee.length;me++)ee[me].style.transformOrigin=`${Oe} ${le}`}_calculateBoundingBoxRect(ne,ee){const Oe=this._viewportRect,le=this._isRtl();let me,ye,Kt,$e,Ti,vi;if("top"===ee.overlayY)ye=ne.y,me=Oe.height-ye+this._viewportMargin;else if("bottom"===ee.overlayY)Kt=Oe.height-ne.y+2*this._viewportMargin,me=Oe.height-Kt+this._viewportMargin;else{const di=Math.min(Oe.bottom-ne.y+Oe.top,ne.y),Gi=this._lastBoundingBoxSize.height;me=2*di,ye=ne.y-di,me>Gi&&!this._isInitialRender&&!this._growAfterOpen&&(ye=ne.y-Gi/2)}if("end"===ee.overlayX&&!le||"start"===ee.overlayX&&le)vi=Oe.width-ne.x+this._viewportMargin,$e=ne.x-this._viewportMargin;else if("start"===ee.overlayX&&!le||"end"===ee.overlayX&&le)Ti=ne.x,$e=Oe.right-ne.x;else{const di=Math.min(Oe.right-ne.x+Oe.left,ne.x),Gi=this._lastBoundingBoxSize.width;$e=2*di,Ti=ne.x-di,$e>Gi&&!this._isInitialRender&&!this._growAfterOpen&&(Ti=ne.x-Gi/2)}return{top:ye,left:Ti,bottom:Kt,right:vi,width:$e,height:me}}_setBoundingBoxStyles(ne,ee){const Oe=this._calculateBoundingBoxRect(ne,ee);!this._isInitialRender&&!this._growAfterOpen&&(Oe.height=Math.min(Oe.height,this._lastBoundingBoxSize.height),Oe.width=Math.min(Oe.width,this._lastBoundingBoxSize.width));const le={};if(this._hasExactPosition())le.top=le.left="0",le.bottom=le.right=le.maxHeight=le.maxWidth="",le.width=le.height="100%";else{const me=this._overlayRef.getConfig().maxHeight,ye=this._overlayRef.getConfig().maxWidth;le.height=(0,t.HM)(Oe.height),le.top=(0,t.HM)(Oe.top),le.bottom=(0,t.HM)(Oe.bottom),le.width=(0,t.HM)(Oe.width),le.left=(0,t.HM)(Oe.left),le.right=(0,t.HM)(Oe.right),le.alignItems="center"===ee.overlayX?"center":"end"===ee.overlayX?"flex-end":"flex-start",le.justifyContent="center"===ee.overlayY?"center":"bottom"===ee.overlayY?"flex-end":"flex-start",me&&(le.maxHeight=(0,t.HM)(me)),ye&&(le.maxWidth=(0,t.HM)(ye))}this._lastBoundingBoxSize=Oe,Lt(this._boundingBox.style,le)}_resetBoundingBoxStyles(){Lt(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Lt(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(ne,ee){const Oe={},le=this._hasExactPosition(),me=this._hasFlexibleDimensions,ye=this._overlayRef.getConfig();if(le){const $e=this._viewportRuler.getViewportScrollPosition();Lt(Oe,this._getExactOverlayY(ee,ne,$e)),Lt(Oe,this._getExactOverlayX(ee,ne,$e))}else Oe.position="static";let Kt="",Zt=this._getOffset(ee,"x"),We=this._getOffset(ee,"y");Zt&&(Kt+=`translateX(${Zt}px) `),We&&(Kt+=`translateY(${We}px)`),Oe.transform=Kt.trim(),ye.maxHeight&&(le?Oe.maxHeight=(0,t.HM)(ye.maxHeight):me&&(Oe.maxHeight="")),ye.maxWidth&&(le?Oe.maxWidth=(0,t.HM)(ye.maxWidth):me&&(Oe.maxWidth="")),Lt(this._pane.style,Oe)}_getExactOverlayY(ne,ee,Oe){let le={top:"",bottom:""},me=this._getOverlayPoint(ee,this._overlayRect,ne);this._isPushed&&(me=this._pushOverlayOnScreen(me,this._overlayRect,Oe));let ye=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return me.y-=ye,"bottom"===ne.overlayY?le.bottom=this._document.documentElement.clientHeight-(me.y+this._overlayRect.height)+"px":le.top=(0,t.HM)(me.y),le}_getExactOverlayX(ne,ee,Oe){let ye,le={left:"",right:""},me=this._getOverlayPoint(ee,this._overlayRect,ne);return this._isPushed&&(me=this._pushOverlayOnScreen(me,this._overlayRect,Oe)),ye=this._isRtl()?"end"===ne.overlayX?"left":"right":"end"===ne.overlayX?"right":"left","right"===ye?le.right=this._document.documentElement.clientWidth-(me.x+this._overlayRect.width)+"px":le.left=(0,t.HM)(me.x),le}_getScrollVisibility(){const ne=this._getOriginRect(),ee=this._pane.getBoundingClientRect(),Oe=this._scrollables.map(le=>le.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Ut(ne,Oe),isOriginOutsideView:wt(ne,Oe),isOverlayClipped:Ut(ee,Oe),isOverlayOutsideView:wt(ee,Oe)}}_subtractOverflows(ne,...ee){return ee.reduce((Oe,le)=>Oe-Math.max(le,0),ne)}_getNarrowedViewportRect(){const ne=this._document.documentElement.clientWidth,ee=this._document.documentElement.clientHeight,Oe=this._viewportRuler.getViewportScrollPosition();return{top:Oe.top+this._viewportMargin,left:Oe.left+this._viewportMargin,right:Oe.left+ne-this._viewportMargin,bottom:Oe.top+ee-this._viewportMargin,width:ne-2*this._viewportMargin,height:ee-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(ne,ee){return"x"===ee?null==ne.offsetX?this._offsetX:ne.offsetX:null==ne.offsetY?this._offsetY:ne.offsetY}_validatePositions(){}_addPanelClasses(ne){this._pane&&(0,t.Eq)(ne).forEach(ee=>{""!==ee&&-1===this._appliedPanelClasses.indexOf(ee)&&(this._appliedPanelClasses.push(ee),this._pane.classList.add(ee))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(ne=>{this._pane.classList.remove(ne)}),this._appliedPanelClasses=[])}_getOriginRect(){const ne=this._origin;if(ne instanceof e.SBq)return ne.nativeElement.getBoundingClientRect();if(ne instanceof Element)return ne.getBoundingClientRect();const ee=ne.width||0,Oe=ne.height||0;return{top:ne.y,bottom:ne.y+Oe,left:ne.x,right:ne.x+ee,height:Oe,width:ee}}}function Lt(Ee,ne){for(let ee in ne)ne.hasOwnProperty(ee)&&(Ee[ee]=ne[ee]);return Ee}function de(Ee){if("number"!=typeof Ee&&null!=Ee){const[ne,ee]=Ee.split(se);return ee&&"px"!==ee?null:parseFloat(ne)}return Ee||null}function _e(Ee){return{top:Math.floor(Ee.top),right:Math.floor(Ee.right),bottom:Math.floor(Ee.bottom),left:Math.floor(Ee.left),width:Math.floor(Ee.width),height:Math.floor(Ee.height)}}const ce="cdk-global-overlay-wrapper";class Ae{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(ne){const ee=ne.getConfig();this._overlayRef=ne,this._width&&!ee.width&&ne.updateSize({width:this._width}),this._height&&!ee.height&&ne.updateSize({height:this._height}),ne.hostElement.classList.add(ce),this._isDisposed=!1}top(ne=""){return this._bottomOffset="",this._topOffset=ne,this._alignItems="flex-start",this}left(ne=""){return this._rightOffset="",this._leftOffset=ne,this._justifyContent="flex-start",this}bottom(ne=""){return this._topOffset="",this._bottomOffset=ne,this._alignItems="flex-end",this}right(ne=""){return this._leftOffset="",this._rightOffset=ne,this._justifyContent="flex-end",this}width(ne=""){return this._overlayRef?this._overlayRef.updateSize({width:ne}):this._width=ne,this}height(ne=""){return this._overlayRef?this._overlayRef.updateSize({height:ne}):this._height=ne,this}centerHorizontally(ne=""){return this.left(ne),this._justifyContent="center",this}centerVertically(ne=""){return this.top(ne),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const ne=this._overlayRef.overlayElement.style,ee=this._overlayRef.hostElement.style,Oe=this._overlayRef.getConfig(),{width:le,height:me,maxWidth:ye,maxHeight:Kt}=Oe,Zt=!("100%"!==le&&"100vw"!==le||ye&&"100%"!==ye&&"100vw"!==ye),We=!("100%"!==me&&"100vh"!==me||Kt&&"100%"!==Kt&&"100vh"!==Kt);ne.position=this._cssPosition,ne.marginLeft=Zt?"0":this._leftOffset,ne.marginTop=We?"0":this._topOffset,ne.marginBottom=this._bottomOffset,ne.marginRight=this._rightOffset,Zt?ee.justifyContent="flex-start":"center"===this._justifyContent?ee.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?ee.justifyContent="flex-end":"flex-end"===this._justifyContent&&(ee.justifyContent="flex-start"):ee.justifyContent=this._justifyContent,ee.alignItems=We?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const ne=this._overlayRef.overlayElement.style,ee=this._overlayRef.hostElement,Oe=ee.style;ee.classList.remove(ce),Oe.justifyContent=Oe.alignItems=ne.marginTop=ne.marginBottom=ne.marginLeft=ne.marginRight=ne.position="",this._overlayRef=null,this._isDisposed=!0}}let Ne=(()=>{class Ee{constructor(ee,Oe,le,me){this._viewportRuler=ee,this._document=Oe,this._platform=le,this._overlayContainer=me}global(){return new Ae}flexibleConnectedTo(ee){return new xt(ee,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(e.LFG(C.rL),e.LFG(m.K0),e.LFG(n.t4),e.LFG(ct))},Ee.\u0275prov=e.Yz7({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee})(),qe=(()=>{class Ee{constructor(ee){this._attachedOverlays=[],this._document=ee}ngOnDestroy(){this.detach()}add(ee){this.remove(ee),this._attachedOverlays.push(ee)}remove(ee){const Oe=this._attachedOverlays.indexOf(ee);Oe>-1&&this._attachedOverlays.splice(Oe,1),0===this._attachedOverlays.length&&this.detach()}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(e.LFG(m.K0))},Ee.\u0275prov=e.Yz7({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee})(),Di=(()=>{class Ee extends qe{constructor(ee){super(ee),this._keydownListener=Oe=>{const le=this._attachedOverlays;for(let me=le.length-1;me>-1;me--)if(le[me]._keydownEvents.observers.length>0){le[me]._keydownEvents.next(Oe);break}}}add(ee){super.add(ee),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(e.LFG(m.K0))},Ee.\u0275prov=e.Yz7({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee})(),ei=(()=>{class Ee extends qe{constructor(ee,Oe){super(ee),this._platform=Oe,this._cursorStyleIsSet=!1,this._pointerDownListener=le=>{this._pointerDownEventTarget=(0,n.sA)(le)},this._clickListener=le=>{const me=(0,n.sA)(le),ye="click"===le.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:me;this._pointerDownEventTarget=null;const Kt=this._attachedOverlays.slice();for(let Zt=Kt.length-1;Zt>-1;Zt--){const We=Kt[Zt];if(!(We._outsidePointerEvents.observers.length<1)&&We.hasAttached()){if(We.overlayElement.contains(me)||We.overlayElement.contains(ye))break;We._outsidePointerEvents.next(le)}}}}add(ee){if(super.add(ee),!this._isAttached){const Oe=this._document.body;Oe.addEventListener("pointerdown",this._pointerDownListener,!0),Oe.addEventListener("click",this._clickListener,!0),Oe.addEventListener("auxclick",this._clickListener,!0),Oe.addEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=Oe.style.cursor,Oe.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const ee=this._document.body;ee.removeEventListener("pointerdown",this._pointerDownListener,!0),ee.removeEventListener("click",this._clickListener,!0),ee.removeEventListener("auxclick",this._clickListener,!0),ee.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(ee.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(e.LFG(m.K0),e.LFG(n.t4))},Ee.\u0275prov=e.Yz7({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee})(),Me=0,ri=(()=>{class Ee{constructor(ee,Oe,le,me,ye,Kt,Zt,We,$e,Ti,vi){this.scrollStrategies=ee,this._overlayContainer=Oe,this._componentFactoryResolver=le,this._positionBuilder=me,this._keyboardDispatcher=ye,this._injector=Kt,this._ngZone=Zt,this._document=We,this._directionality=$e,this._location=Ti,this._outsideClickDispatcher=vi}create(ee){const Oe=this._createHostElement(),le=this._createPaneElement(Oe),me=this._createPortalOutlet(le),ye=new bt(ee);return ye.direction=ye.direction||this._directionality.value,new yt(me,Oe,le,ye,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(ee){const Oe=this._document.createElement("div");return Oe.id="cdk-overlay-"+Me++,Oe.classList.add("cdk-overlay-pane"),ee.appendChild(Oe),Oe}_createHostElement(){const ee=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(ee),ee}_createPortalOutlet(ee){return this._appRef||(this._appRef=this._injector.get(e.z2F)),new r.u0(ee,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(e.LFG(Ct),e.LFG(ct),e.LFG(e._Vd),e.LFG(Ne),e.LFG(Di),e.LFG(e.zs3),e.LFG(e.R0b),e.LFG(m.K0),e.LFG(o.Is),e.LFG(m.Ye),e.LFG(ei))},Ee.\u0275prov=e.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();const ve={provide:new e.OlP("cdk-connected-overlay-scroll-strategy"),deps:[ri],useFactory:function Dt(Ee){return()=>Ee.scrollStrategies.reposition()}};let je=(()=>{class Ee{}return Ee.\u0275fac=function(ee){return new(ee||Ee)},Ee.\u0275mod=e.oAB({type:Ee}),Ee.\u0275inj=e.cJS({providers:[ri,ve],imports:[[o.vT,r.eL,C.Cl],C.Cl]}),Ee})()},70925:(B,X,_)=>{"use strict";_.d(X,{t4:()=>t,ud:()=>n,sA:()=>Jt,ht:()=>Ut,kV:()=>wt,Oy:()=>Ct,_i:()=>Et,qK:()=>a,i$:()=>L,Mq:()=>et});var C=_(5e3),m=_(69808);let e;try{e="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(bt){e=!1}let o,t=(()=>{class bt{constructor(ft){this._platformId=ft,this.isBrowser=this._platformId?(0,m.NF)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!e)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return bt.\u0275fac=function(ft){return new(ft||bt)(C.LFG(C.Lbi))},bt.\u0275prov=C.Yz7({token:bt,factory:bt.\u0275fac,providedIn:"root"}),bt})(),n=(()=>{class bt{}return bt.\u0275fac=function(ft){return new(ft||bt)},bt.\u0275mod=C.oAB({type:bt}),bt.\u0275inj=C.cJS({}),bt})();const r=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function a(){if(o)return o;if("object"!=typeof document||!document)return o=new Set(r),o;let bt=document.createElement("input");return o=new Set(r.filter(at=>(bt.setAttribute("type",at),bt.type===at))),o}let h,W,nt,It;function L(bt){return function R(){if(null==h&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>h=!0}))}finally{h=h||!1}return h}()?bt:!!bt.capture}function et(){if(null==nt){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return nt=!1,nt;if("scrollBehavior"in document.documentElement.style)nt=!0;else{const bt=Element.prototype.scrollTo;nt=!!bt&&!/\{\s*\[native code\]\s*\}/.test(bt.toString())}}return nt}function Et(){if("object"!=typeof document||!document)return 0;if(null==W){const bt=document.createElement("div"),at=bt.style;bt.dir="rtl",at.width="1px",at.overflow="auto",at.visibility="hidden",at.pointerEvents="none",at.position="absolute";const ft=document.createElement("div"),lt=ft.style;lt.width="2px",lt.height="1px",bt.appendChild(ft),document.body.appendChild(bt),W=0,0===bt.scrollLeft&&(bt.scrollLeft=1,W=0===bt.scrollLeft?1:2),bt.remove()}return W}function wt(bt){if(function gt(){if(null==It){const bt="undefined"!=typeof document?document.head:null;It=!(!bt||!bt.createShadowRoot&&!bt.attachShadow)}return It}()){const at=bt.getRootNode?bt.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&at instanceof ShadowRoot)return at}return null}function Ut(){let bt="undefined"!=typeof document&&document?document.activeElement:null;for(;bt&&bt.shadowRoot;){const at=bt.shadowRoot.activeElement;if(at===bt)break;bt=at}return bt}function Jt(bt){return bt.composedPath?bt.composedPath()[0]:bt.target}function Ct(){return"undefined"!=typeof __karma__&&!!__karma__||"undefined"!=typeof jasmine&&!!jasmine||"undefined"!=typeof jest&&!!jest||"undefined"!=typeof Mocha&&!!Mocha}},47429:(B,X,_)=>{"use strict";_.d(X,{en:()=>nt,ig:()=>gt,Pl:()=>Ut,C5:()=>R,u0:()=>Et,eL:()=>Ct,UE:()=>L});var C=_(5e3),m=_(69808);class h{attach(ft){return this._attachedHost=ft,ft.attach(this)}detach(){let ft=this._attachedHost;null!=ft&&(this._attachedHost=null,ft.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(ft){this._attachedHost=ft}}class R extends h{constructor(ft,lt,Ft,Mt){super(),this.component=ft,this.viewContainerRef=lt,this.injector=Ft,this.componentFactoryResolver=Mt}}class L extends h{constructor(ft,lt,Ft){super(),this.templateRef=ft,this.viewContainerRef=lt,this.context=Ft}get origin(){return this.templateRef.elementRef}attach(ft,lt=this.context){return this.context=lt,super.attach(ft)}detach(){return this.context=void 0,super.detach()}}class W extends h{constructor(ft){super(),this.element=ft instanceof C.SBq?ft.nativeElement:ft}}class nt{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(ft){return ft instanceof R?(this._attachedPortal=ft,this.attachComponentPortal(ft)):ft instanceof L?(this._attachedPortal=ft,this.attachTemplatePortal(ft)):this.attachDomPortal&&ft instanceof W?(this._attachedPortal=ft,this.attachDomPortal(ft)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(ft){this._disposeFn=ft}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Et extends nt{constructor(ft,lt,Ft,Mt,yt){super(),this.outletElement=ft,this._componentFactoryResolver=lt,this._appRef=Ft,this._defaultInjector=Mt,this.attachDomPortal=ct=>{const rt=ct.element,se=this._document.createComment("dom-portal");rt.parentNode.insertBefore(se,rt),this.outletElement.appendChild(rt),this._attachedPortal=ct,super.setDisposeFn(()=>{se.parentNode&&se.parentNode.replaceChild(rt,se)})},this._document=yt}attachComponentPortal(ft){const Ft=(ft.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(ft.component);let Mt;return ft.viewContainerRef?(Mt=ft.viewContainerRef.createComponent(Ft,ft.viewContainerRef.length,ft.injector||ft.viewContainerRef.injector),this.setDisposeFn(()=>Mt.destroy())):(Mt=Ft.create(ft.injector||this._defaultInjector),this._appRef.attachView(Mt.hostView),this.setDisposeFn(()=>{this._appRef.detachView(Mt.hostView),Mt.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(Mt)),this._attachedPortal=ft,Mt}attachTemplatePortal(ft){let lt=ft.viewContainerRef,Ft=lt.createEmbeddedView(ft.templateRef,ft.context);return Ft.rootNodes.forEach(Mt=>this.outletElement.appendChild(Mt)),Ft.detectChanges(),this.setDisposeFn(()=>{let Mt=lt.indexOf(Ft);-1!==Mt&&lt.remove(Mt)}),this._attachedPortal=ft,Ft}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(ft){return ft.hostView.rootNodes[0]}}let gt=(()=>{class at extends L{constructor(lt,Ft){super(lt,Ft)}}return at.\u0275fac=function(lt){return new(lt||at)(C.Y36(C.Rgc),C.Y36(C.s_b))},at.\u0275dir=C.lG2({type:at,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],features:[C.qOj]}),at})(),Ut=(()=>{class at extends nt{constructor(lt,Ft,Mt){super(),this._componentFactoryResolver=lt,this._viewContainerRef=Ft,this._isInitialized=!1,this.attached=new C.vpe,this.attachDomPortal=yt=>{const ct=yt.element,rt=this._document.createComment("dom-portal");yt.setAttachedHost(this),ct.parentNode.insertBefore(rt,ct),this._getRootNode().appendChild(ct),this._attachedPortal=yt,super.setDisposeFn(()=>{rt.parentNode&&rt.parentNode.replaceChild(ct,rt)})},this._document=Mt}get portal(){return this._attachedPortal}set portal(lt){this.hasAttached()&&!lt&&!this._isInitialized||(this.hasAttached()&&super.detach(),lt&&super.attach(lt),this._attachedPortal=lt)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(lt){lt.setAttachedHost(this);const Ft=null!=lt.viewContainerRef?lt.viewContainerRef:this._viewContainerRef,yt=(lt.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(lt.component),ct=Ft.createComponent(yt,Ft.length,lt.injector||Ft.injector);return Ft!==this._viewContainerRef&&this._getRootNode().appendChild(ct.hostView.rootNodes[0]),super.setDisposeFn(()=>ct.destroy()),this._attachedPortal=lt,this._attachedRef=ct,this.attached.emit(ct),ct}attachTemplatePortal(lt){lt.setAttachedHost(this);const Ft=this._viewContainerRef.createEmbeddedView(lt.templateRef,lt.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=lt,this._attachedRef=Ft,this.attached.emit(Ft),Ft}_getRootNode(){const lt=this._viewContainerRef.element.nativeElement;return lt.nodeType===lt.ELEMENT_NODE?lt:lt.parentNode}}return at.\u0275fac=function(lt){return new(lt||at)(C.Y36(C._Vd),C.Y36(C.s_b),C.Y36(m.K0))},at.\u0275dir=C.lG2({type:at,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[C.qOj]}),at})(),Ct=(()=>{class at{}return at.\u0275fac=function(lt){return new(lt||at)},at.\u0275mod=C.oAB({type:at}),at.\u0275inj=C.cJS({}),at})()},30495:(B,X,_)=>{"use strict";_.d(X,{PQ:()=>ce,ZD:()=>Bt,mF:()=>_e,Cl:()=>Ie,rL:()=>Ne});var C=_(63191),m=_(5e3),e=_(84408),t=_(50727);const n={schedule(Xt){let he=requestAnimationFrame,Dt=cancelAnimationFrame;const{delegate:ve}=n;ve&&(he=ve.requestAnimationFrame,Dt=ve.cancelAnimationFrame);const je=he(gi=>{Dt=void 0,Xt(gi)});return new t.w0(()=>null==Dt?void 0:Dt(je))},requestAnimationFrame(...Xt){const{delegate:he}=n;return((null==he?void 0:he.requestAnimationFrame)||requestAnimationFrame)(...Xt)},cancelAnimationFrame(...Xt){const{delegate:he}=n;return((null==he?void 0:he.cancelAnimationFrame)||cancelAnimationFrame)(...Xt)},delegate:void 0};var r=_(97565);new class a extends r.v{flush(he){this._active=!0,this._scheduled=void 0;const{actions:Dt}=this;let ve,je=-1;he=he||Dt.shift();const gi=Dt.length;do{if(ve=he.execute(he.state,he.delay))break}while(++je<gi&&(he=Dt.shift()));if(this._active=!1,ve){for(;++je<gi&&(he=Dt.shift());)he.unsubscribe();throw ve}}}(class o extends e.o{constructor(he,Dt){super(he,Dt),this.scheduler=he,this.work=Dt}requestAsyncId(he,Dt,ve=0){return null!==ve&&ve>0?super.requestAsyncId(he,Dt,ve):(he.actions.push(this),he._scheduled||(he._scheduled=n.requestAnimationFrame(()=>he.flush(void 0))))}recycleAsyncId(he,Dt,ve=0){if(null!=ve&&ve>0||null==ve&&this.delay>0)return super.recycleAsyncId(he,Dt,ve);0===he.actions.length&&(n.cancelAnimationFrame(Dt),he._scheduled=void 0)}});var L=_(77579),W=_(39646),nt=_(68306),et=_(54968),It=(_(53101),_(34986)),gt=_(54482),wt=_(38421),Ut=_(25403),Ct=_(5963);function bt(Xt,he=It.P){return function Jt(Xt){return(0,gt.e)((he,Dt)=>{let ve=!1,je=null,gi=null,Ee=!1;const ne=()=>{if(null==gi||gi.unsubscribe(),gi=null,ve){ve=!1;const Oe=je;je=null,Dt.next(Oe)}Ee&&Dt.complete()},ee=()=>{gi=null,Ee&&Dt.complete()};he.subscribe(new Ut.Q(Dt,Oe=>{ve=!0,je=Oe,gi||(0,wt.Xf)(Xt(Oe)).subscribe(gi=new Ut.Q(Dt,ne,ee))},()=>{Ee=!0,(!ve||!gi||gi.closed)&&Dt.complete()}))})}(()=>(0,Ct.H)(Xt,he))}var at=_(39300),ft=_(82722),lt=_(69808),Ft=_(70925),Mt=_(50226);let _e=(()=>{class Xt{constructor(Dt,ve,je){this._ngZone=Dt,this._platform=ve,this._scrolled=new L.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=je}register(Dt){this.scrollContainers.has(Dt)||this.scrollContainers.set(Dt,Dt.elementScrolled().subscribe(()=>this._scrolled.next(Dt)))}deregister(Dt){const ve=this.scrollContainers.get(Dt);ve&&(ve.unsubscribe(),this.scrollContainers.delete(Dt))}scrolled(Dt=20){return this._platform.isBrowser?new nt.y(ve=>{this._globalSubscription||this._addGlobalListener();const je=Dt>0?this._scrolled.pipe(bt(Dt)).subscribe(ve):this._scrolled.subscribe(ve);return this._scrolledCount++,()=>{je.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,W.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((Dt,ve)=>this.deregister(ve)),this._scrolled.complete()}ancestorScrolled(Dt,ve){const je=this.getAncestorScrollContainers(Dt);return this.scrolled(ve).pipe((0,at.h)(gi=>!gi||je.indexOf(gi)>-1))}getAncestorScrollContainers(Dt){const ve=[];return this.scrollContainers.forEach((je,gi)=>{this._scrollableContainsElement(gi,Dt)&&ve.push(gi)}),ve}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(Dt,ve){let je=(0,C.fI)(ve),gi=Dt.getElementRef().nativeElement;do{if(je==gi)return!0}while(je=je.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{const Dt=this._getWindow();return(0,et.R)(Dt.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return Xt.\u0275fac=function(Dt){return new(Dt||Xt)(m.LFG(m.R0b),m.LFG(Ft.t4),m.LFG(lt.K0,8))},Xt.\u0275prov=m.Yz7({token:Xt,factory:Xt.\u0275fac,providedIn:"root"}),Xt})(),ce=(()=>{class Xt{constructor(Dt,ve,je,gi){this.elementRef=Dt,this.scrollDispatcher=ve,this.ngZone=je,this.dir=gi,this._destroyed=new L.x,this._elementScrolled=new nt.y(Ee=>this.ngZone.runOutsideAngular(()=>(0,et.R)(this.elementRef.nativeElement,"scroll").pipe((0,ft.R)(this._destroyed)).subscribe(Ee)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(Dt){const ve=this.elementRef.nativeElement,je=this.dir&&"rtl"==this.dir.value;null==Dt.left&&(Dt.left=je?Dt.end:Dt.start),null==Dt.right&&(Dt.right=je?Dt.start:Dt.end),null!=Dt.bottom&&(Dt.top=ve.scrollHeight-ve.clientHeight-Dt.bottom),je&&0!=(0,Ft._i)()?(null!=Dt.left&&(Dt.right=ve.scrollWidth-ve.clientWidth-Dt.left),2==(0,Ft._i)()?Dt.left=Dt.right:1==(0,Ft._i)()&&(Dt.left=Dt.right?-Dt.right:Dt.right)):null!=Dt.right&&(Dt.left=ve.scrollWidth-ve.clientWidth-Dt.right),this._applyScrollToOptions(Dt)}_applyScrollToOptions(Dt){const ve=this.elementRef.nativeElement;(0,Ft.Mq)()?ve.scrollTo(Dt):(null!=Dt.top&&(ve.scrollTop=Dt.top),null!=Dt.left&&(ve.scrollLeft=Dt.left))}measureScrollOffset(Dt){const ve="left",gi=this.elementRef.nativeElement;if("top"==Dt)return gi.scrollTop;if("bottom"==Dt)return gi.scrollHeight-gi.clientHeight-gi.scrollTop;const Ee=this.dir&&"rtl"==this.dir.value;return"start"==Dt?Dt=Ee?"right":ve:"end"==Dt&&(Dt=Ee?ve:"right"),Ee&&2==(0,Ft._i)()?Dt==ve?gi.scrollWidth-gi.clientWidth-gi.scrollLeft:gi.scrollLeft:Ee&&1==(0,Ft._i)()?Dt==ve?gi.scrollLeft+gi.scrollWidth-gi.clientWidth:-gi.scrollLeft:Dt==ve?gi.scrollLeft:gi.scrollWidth-gi.clientWidth-gi.scrollLeft}}return Xt.\u0275fac=function(Dt){return new(Dt||Xt)(m.Y36(m.SBq),m.Y36(_e),m.Y36(m.R0b),m.Y36(Mt.Is,8))},Xt.\u0275dir=m.lG2({type:Xt,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),Xt})(),Ne=(()=>{class Xt{constructor(Dt,ve,je){this._platform=Dt,this._change=new L.x,this._changeListener=gi=>{this._change.next(gi)},this._document=je,ve.runOutsideAngular(()=>{if(Dt.isBrowser){const gi=this._getWindow();gi.addEventListener("resize",this._changeListener),gi.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const Dt=this._getWindow();Dt.removeEventListener("resize",this._changeListener),Dt.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const Dt={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),Dt}getViewportRect(){const Dt=this.getViewportScrollPosition(),{width:ve,height:je}=this.getViewportSize();return{top:Dt.top,left:Dt.left,bottom:Dt.top+je,right:Dt.left+ve,height:je,width:ve}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const Dt=this._document,ve=this._getWindow(),je=Dt.documentElement,gi=je.getBoundingClientRect();return{top:-gi.top||Dt.body.scrollTop||ve.scrollY||je.scrollTop||0,left:-gi.left||Dt.body.scrollLeft||ve.scrollX||je.scrollLeft||0}}change(Dt=20){return Dt>0?this._change.pipe(bt(Dt)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const Dt=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:Dt.innerWidth,height:Dt.innerHeight}:{width:0,height:0}}}return Xt.\u0275fac=function(Dt){return new(Dt||Xt)(m.LFG(Ft.t4),m.LFG(m.R0b),m.LFG(lt.K0,8))},Xt.\u0275prov=m.Yz7({token:Xt,factory:Xt.\u0275fac,providedIn:"root"}),Xt})(),Bt=(()=>{class Xt{}return Xt.\u0275fac=function(Dt){return new(Dt||Xt)},Xt.\u0275mod=m.oAB({type:Xt}),Xt.\u0275inj=m.cJS({}),Xt})(),Ie=(()=>{class Xt{}return Xt.\u0275fac=function(Dt){return new(Dt||Xt)},Xt.\u0275mod=m.oAB({type:Xt}),Xt.\u0275inj=m.cJS({imports:[[Mt.vT,Ft.ud,Bt],Mt.vT,Bt]}),Xt})()},69808:(B,X,_)=>{"use strict";_.d(X,{mr:()=>Ut,Ov:()=>dl,ez:()=>tr,K0:()=>r,Do:()=>Ct,V_:()=>R,Ye:()=>bt,S$:()=>gt,mk:()=>ae,sg:()=>Yi,O5:()=>ao,PC:()=>sr,RF:()=>_r,n9:()=>rr,b0:()=>Jt,lw:()=>a,EM:()=>Jr,JF:()=>fa,NF:()=>Cs,w_:()=>o,bD:()=>Es,q:()=>e,Mx:()=>Wn,HT:()=>n});var C=_(5e3);let m=null;function e(){return m}function n(kt){m||(m=kt)}class o{}const r=new C.OlP("DocumentToken");let a=(()=>{class kt{historyGo(V){throw new Error("Not implemented")}}return kt.\u0275fac=function(V){return new(V||kt)},kt.\u0275prov=C.Yz7({token:kt,factory:function(){return function h(){return(0,C.LFG)(L)}()},providedIn:"platform"}),kt})();const R=new C.OlP("Location Initialized");let L=(()=>{class kt extends a{constructor(V){super(),this._doc=V,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return e().getBaseHref(this._doc)}onPopState(V){const j=e().getGlobalEventTarget(this._doc,"window");return j.addEventListener("popstate",V,!1),()=>j.removeEventListener("popstate",V)}onHashChange(V){const j=e().getGlobalEventTarget(this._doc,"window");return j.addEventListener("hashchange",V,!1),()=>j.removeEventListener("hashchange",V)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(V){this.location.pathname=V}pushState(V,j,Ot){W()?this._history.pushState(V,j,Ot):this.location.hash=Ot}replaceState(V,j,Ot){W()?this._history.replaceState(V,j,Ot):this.location.hash=Ot}forward(){this._history.forward()}back(){this._history.back()}historyGo(V=0){this._history.go(V)}getState(){return this._history.state}}return kt.\u0275fac=function(V){return new(V||kt)(C.LFG(r))},kt.\u0275prov=C.Yz7({token:kt,factory:function(){return function nt(){return new L((0,C.LFG)(r))}()},providedIn:"platform"}),kt})();function W(){return!!window.history.pushState}function et(kt,Q){if(0==kt.length)return Q;if(0==Q.length)return kt;let V=0;return kt.endsWith("/")&&V++,Q.startsWith("/")&&V++,2==V?kt+Q.substring(1):1==V?kt+Q:kt+"/"+Q}function Et(kt){const Q=kt.match(/#|\?|$/),V=Q&&Q.index||kt.length;return kt.slice(0,V-("/"===kt[V-1]?1:0))+kt.slice(V)}function It(kt){return kt&&"?"!==kt[0]?"?"+kt:kt}let gt=(()=>{class kt{historyGo(V){throw new Error("Not implemented")}}return kt.\u0275fac=function(V){return new(V||kt)},kt.\u0275prov=C.Yz7({token:kt,factory:function(){return function wt(kt){const Q=(0,C.LFG)(r).location;return new Jt((0,C.LFG)(a),Q&&Q.origin||"")}()},providedIn:"root"}),kt})();const Ut=new C.OlP("appBaseHref");let Jt=(()=>{class kt extends gt{constructor(V,j){if(super(),this._platformLocation=V,this._removeListenerFns=[],null==j&&(j=this._platformLocation.getBaseHrefFromDOM()),null==j)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=j}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(V){this._removeListenerFns.push(this._platformLocation.onPopState(V),this._platformLocation.onHashChange(V))}getBaseHref(){return this._baseHref}prepareExternalUrl(V){return et(this._baseHref,V)}path(V=!1){const j=this._platformLocation.pathname+It(this._platformLocation.search),Ot=this._platformLocation.hash;return Ot&&V?`${j}${Ot}`:j}pushState(V,j,Ot,Be){const bi=this.prepareExternalUrl(Ot+It(Be));this._platformLocation.pushState(V,j,bi)}replaceState(V,j,Ot,Be){const bi=this.prepareExternalUrl(Ot+It(Be));this._platformLocation.replaceState(V,j,bi)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(V=0){var j,Ot;null===(Ot=(j=this._platformLocation).historyGo)||void 0===Ot||Ot.call(j,V)}}return kt.\u0275fac=function(V){return new(V||kt)(C.LFG(a),C.LFG(Ut,8))},kt.\u0275prov=C.Yz7({token:kt,factory:kt.\u0275fac}),kt})(),Ct=(()=>{class kt extends gt{constructor(V,j){super(),this._platformLocation=V,this._baseHref="",this._removeListenerFns=[],null!=j&&(this._baseHref=j)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(V){this._removeListenerFns.push(this._platformLocation.onPopState(V),this._platformLocation.onHashChange(V))}getBaseHref(){return this._baseHref}path(V=!1){let j=this._platformLocation.hash;return null==j&&(j="#"),j.length>0?j.substring(1):j}prepareExternalUrl(V){const j=et(this._baseHref,V);return j.length>0?"#"+j:j}pushState(V,j,Ot,Be){let bi=this.prepareExternalUrl(Ot+It(Be));0==bi.length&&(bi=this._platformLocation.pathname),this._platformLocation.pushState(V,j,bi)}replaceState(V,j,Ot,Be){let bi=this.prepareExternalUrl(Ot+It(Be));0==bi.length&&(bi=this._platformLocation.pathname),this._platformLocation.replaceState(V,j,bi)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(V=0){var j,Ot;null===(Ot=(j=this._platformLocation).historyGo)||void 0===Ot||Ot.call(j,V)}}return kt.\u0275fac=function(V){return new(V||kt)(C.LFG(a),C.LFG(Ut,8))},kt.\u0275prov=C.Yz7({token:kt,factory:kt.\u0275fac}),kt})(),bt=(()=>{class kt{constructor(V,j){this._subject=new C.vpe,this._urlChangeListeners=[],this._platformStrategy=V;const Ot=this._platformStrategy.getBaseHref();this._platformLocation=j,this._baseHref=Et(lt(Ot)),this._platformStrategy.onPopState(Be=>{this._subject.emit({url:this.path(!0),pop:!0,state:Be.state,type:Be.type})})}path(V=!1){return this.normalize(this._platformStrategy.path(V))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(V,j=""){return this.path()==this.normalize(V+It(j))}normalize(V){return kt.stripTrailingSlash(function ft(kt,Q){return kt&&Q.startsWith(kt)?Q.substring(kt.length):Q}(this._baseHref,lt(V)))}prepareExternalUrl(V){return V&&"/"!==V[0]&&(V="/"+V),this._platformStrategy.prepareExternalUrl(V)}go(V,j="",Ot=null){this._platformStrategy.pushState(Ot,"",V,j),this._notifyUrlChangeListeners(this.prepareExternalUrl(V+It(j)),Ot)}replaceState(V,j="",Ot=null){this._platformStrategy.replaceState(Ot,"",V,j),this._notifyUrlChangeListeners(this.prepareExternalUrl(V+It(j)),Ot)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(V=0){var j,Ot;null===(Ot=(j=this._platformStrategy).historyGo)||void 0===Ot||Ot.call(j,V)}onUrlChange(V){this._urlChangeListeners.push(V),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(j=>{this._notifyUrlChangeListeners(j.url,j.state)}))}_notifyUrlChangeListeners(V="",j){this._urlChangeListeners.forEach(Ot=>Ot(V,j))}subscribe(V,j,Ot){return this._subject.subscribe({next:V,error:j,complete:Ot})}}return kt.normalizeQueryParams=It,kt.joinWithSlash=et,kt.stripTrailingSlash=Et,kt.\u0275fac=function(V){return new(V||kt)(C.LFG(gt),C.LFG(a))},kt.\u0275prov=C.Yz7({token:kt,factory:function(){return function at(){return new bt((0,C.LFG)(gt),(0,C.LFG)(a))}()},providedIn:"root"}),kt})();function lt(kt){return kt.replace(/\/index.html$/,"")}var yt=(()=>((yt=yt||{})[yt.Zero=0]="Zero",yt[yt.One=1]="One",yt[yt.Two=2]="Two",yt[yt.Few=3]="Few",yt[yt.Many=4]="Many",yt[yt.Other=5]="Other",yt))();const je=C.kL8;class Qo{}let Bi=(()=>{class kt extends Qo{constructor(V){super(),this.locale=V}getPluralCategory(V,j){switch(je(j||this.locale)(V)){case yt.Zero:return"zero";case yt.One:return"one";case yt.Two:return"two";case yt.Few:return"few";case yt.Many:return"many";default:return"other"}}}return kt.\u0275fac=function(V){return new(V||kt)(C.LFG(C.soG))},kt.\u0275prov=C.Yz7({token:kt,factory:kt.\u0275fac}),kt})();function Wn(kt,Q){Q=encodeURIComponent(Q);for(const V of kt.split(";")){const j=V.indexOf("="),[Ot,Be]=-1==j?[V,""]:[V.slice(0,j),V.slice(j+1)];if(Ot.trim()===Q)return decodeURIComponent(Be)}return null}let ae=(()=>{class kt{constructor(V,j,Ot,Be){this._iterableDiffers=V,this._keyValueDiffers=j,this._ngEl=Ot,this._renderer=Be,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(V){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof V?V.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(V){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof V?V.split(/\s+/):V,this._rawClass&&((0,C.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const V=this._iterableDiffer.diff(this._rawClass);V&&this._applyIterableChanges(V)}else if(this._keyValueDiffer){const V=this._keyValueDiffer.diff(this._rawClass);V&&this._applyKeyValueChanges(V)}}_applyKeyValueChanges(V){V.forEachAddedItem(j=>this._toggleClass(j.key,j.currentValue)),V.forEachChangedItem(j=>this._toggleClass(j.key,j.currentValue)),V.forEachRemovedItem(j=>{j.previousValue&&this._toggleClass(j.key,!1)})}_applyIterableChanges(V){V.forEachAddedItem(j=>{if("string"!=typeof j.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,C.AaK)(j.item)}`);this._toggleClass(j.item,!0)}),V.forEachRemovedItem(j=>this._toggleClass(j.item,!1))}_applyClasses(V){V&&(Array.isArray(V)||V instanceof Set?V.forEach(j=>this._toggleClass(j,!0)):Object.keys(V).forEach(j=>this._toggleClass(j,!!V[j])))}_removeClasses(V){V&&(Array.isArray(V)||V instanceof Set?V.forEach(j=>this._toggleClass(j,!1)):Object.keys(V).forEach(j=>this._toggleClass(j,!1)))}_toggleClass(V,j){(V=V.trim())&&V.split(/\s+/g).forEach(Ot=>{j?this._renderer.addClass(this._ngEl.nativeElement,Ot):this._renderer.removeClass(this._ngEl.nativeElement,Ot)})}}return kt.\u0275fac=function(V){return new(V||kt)(C.Y36(C.ZZ4),C.Y36(C.aQg),C.Y36(C.SBq),C.Y36(C.Qsj))},kt.\u0275dir=C.lG2({type:kt,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),kt})();class Mi{constructor(Q,V,j,Ot){this.$implicit=Q,this.ngForOf=V,this.index=j,this.count=Ot}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Yi=(()=>{class kt{constructor(V,j,Ot){this._viewContainer=V,this._template=j,this._differs=Ot,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(V){this._ngForOf=V,this._ngForOfDirty=!0}set ngForTrackBy(V){this._trackByFn=V}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(V){V&&(this._template=V)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const V=this._ngForOf;!this._differ&&V&&(this._differ=this._differs.find(V).create(this.ngForTrackBy))}if(this._differ){const V=this._differ.diff(this._ngForOf);V&&this._applyChanges(V)}}_applyChanges(V){const j=this._viewContainer;V.forEachOperation((Ot,Be,bi)=>{if(null==Ot.previousIndex)j.createEmbeddedView(this._template,new Mi(Ot.item,this._ngForOf,-1,-1),null===bi?void 0:bi);else if(null==bi)j.remove(null===Be?void 0:Be);else if(null!==Be){const un=j.get(Be);j.move(un,bi),Ki(un,Ot)}});for(let Ot=0,Be=j.length;Ot<Be;Ot++){const un=j.get(Ot).context;un.index=Ot,un.count=Be,un.ngForOf=this._ngForOf}V.forEachIdentityChange(Ot=>{Ki(j.get(Ot.currentIndex),Ot)})}static ngTemplateContextGuard(V,j){return!0}}return kt.\u0275fac=function(V){return new(V||kt)(C.Y36(C.s_b),C.Y36(C.Rgc),C.Y36(C.ZZ4))},kt.\u0275dir=C.lG2({type:kt,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),kt})();function Ki(kt,Q){kt.context.$implicit=Q.item}let ao=(()=>{class kt{constructor(V,j){this._viewContainer=V,this._context=new lo,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=j}set ngIf(V){this._context.$implicit=this._context.ngIf=V,this._updateView()}set ngIfThen(V){Rn("ngIfThen",V),this._thenTemplateRef=V,this._thenViewRef=null,this._updateView()}set ngIfElse(V){Rn("ngIfElse",V),this._elseTemplateRef=V,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(V,j){return!0}}return kt.\u0275fac=function(V){return new(V||kt)(C.Y36(C.s_b),C.Y36(C.Rgc))},kt.\u0275dir=C.lG2({type:kt,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),kt})();class lo{constructor(){this.$implicit=null,this.ngIf=null}}function Rn(kt,Q){if(Q&&!Q.createEmbeddedView)throw new Error(`${kt} must be a TemplateRef, but received '${(0,C.AaK)(Q)}'.`)}class Kr{constructor(Q,V){this._viewContainerRef=Q,this._templateRef=V,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(Q){Q&&!this._created?this.create():!Q&&this._created&&this.destroy()}}let _r=(()=>{class kt{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(V){this._ngSwitch=V,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(V){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(V)}_matchCase(V){const j=V==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||j,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),j}_updateDefaultCases(V){if(this._defaultViews&&V!==this._defaultUsed){this._defaultUsed=V;for(let j=0;j<this._defaultViews.length;j++)this._defaultViews[j].enforceState(V)}}}return kt.\u0275fac=function(V){return new(V||kt)},kt.\u0275dir=C.lG2({type:kt,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),kt})(),rr=(()=>{class kt{constructor(V,j,Ot){this.ngSwitch=Ot,Ot._addCase(),this._view=new Kr(V,j)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return kt.\u0275fac=function(V){return new(V||kt)(C.Y36(C.s_b),C.Y36(C.Rgc),C.Y36(_r,9))},kt.\u0275dir=C.lG2({type:kt,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),kt})(),sr=(()=>{class kt{constructor(V,j,Ot){this._ngEl=V,this._differs=j,this._renderer=Ot,this._ngStyle=null,this._differ=null}set ngStyle(V){this._ngStyle=V,!this._differ&&V&&(this._differ=this._differs.find(V).create())}ngDoCheck(){if(this._differ){const V=this._differ.diff(this._ngStyle);V&&this._applyChanges(V)}}_setStyle(V,j){const[Ot,Be]=V.split(".");null!=(j=null!=j&&Be?`${j}${Be}`:j)?this._renderer.setStyle(this._ngEl.nativeElement,Ot,j):this._renderer.removeStyle(this._ngEl.nativeElement,Ot)}_applyChanges(V){V.forEachRemovedItem(j=>this._setStyle(j.key,null)),V.forEachAddedItem(j=>this._setStyle(j.key,j.currentValue)),V.forEachChangedItem(j=>this._setStyle(j.key,j.currentValue))}}return kt.\u0275fac=function(V){return new(V||kt)(C.Y36(C.SBq),C.Y36(C.aQg),C.Y36(C.Qsj))},kt.\u0275dir=C.lG2({type:kt,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),kt})();class us{createSubscription(Q,V){return Q.subscribe({next:V,error:j=>{throw j}})}dispose(Q){Q.unsubscribe()}onDestroy(Q){Q.unsubscribe()}}class ya{createSubscription(Q,V){return Q.then(V,j=>{throw j})}dispose(Q){}onDestroy(Q){}}const Vo=new ya,Ma=new us;let dl=(()=>{class kt{constructor(V){this._ref=V,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}ngOnDestroy(){this._subscription&&this._dispose()}transform(V){return this._obj?V!==this._obj?(this._dispose(),this.transform(V)):this._latestValue:(V&&this._subscribe(V),this._latestValue)}_subscribe(V){this._obj=V,this._strategy=this._selectStrategy(V),this._subscription=this._strategy.createSubscription(V,j=>this._updateLatestValue(V,j))}_selectStrategy(V){if((0,C.QGY)(V))return Vo;if((0,C.F4k)(V))return Ma;throw function Cr(kt,Q){return Error(`InvalidPipeArgument: '${Q}' for pipe '${(0,C.AaK)(kt)}'`)}(kt,V)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(V,j){V===this._obj&&(this._latestValue=j,this._ref.markForCheck())}}return kt.\u0275fac=function(V){return new(V||kt)(C.Y36(C.sBO,16))},kt.\u0275pipe=C.Yjl({name:"async",type:kt,pure:!1}),kt})(),tr=(()=>{class kt{}return kt.\u0275fac=function(V){return new(V||kt)},kt.\u0275mod=C.oAB({type:kt}),kt.\u0275inj=C.cJS({providers:[{provide:Qo,useClass:Bi}]}),kt})();const Es="browser";function Cs(kt){return kt===Es}let Jr=(()=>{class kt{}return kt.\u0275prov=(0,C.Yz7)({token:kt,providedIn:"root",factory:()=>new ks((0,C.LFG)(r),window)}),kt})();class ks{constructor(Q,V){this.document=Q,this.window=V,this.offset=()=>[0,0]}setOffset(Q){this.offset=Array.isArray(Q)?()=>Q:Q}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(Q){this.supportsScrolling()&&this.window.scrollTo(Q[0],Q[1])}scrollToAnchor(Q){if(!this.supportsScrolling())return;const V=function No(kt,Q){const V=kt.getElementById(Q)||kt.getElementsByName(Q)[0];if(V)return V;if("function"==typeof kt.createTreeWalker&&kt.body&&(kt.body.createShadowRoot||kt.body.attachShadow)){const j=kt.createTreeWalker(kt.body,NodeFilter.SHOW_ELEMENT);let Ot=j.currentNode;for(;Ot;){const Be=Ot.shadowRoot;if(Be){const bi=Be.getElementById(Q)||Be.querySelector(`[name="${Q}"]`);if(bi)return bi}Ot=j.nextNode()}}return null}(this.document,Q);V&&(this.scrollToElement(V),this.attemptFocus(V))}setHistoryScrollRestoration(Q){if(this.supportScrollRestoration()){const V=this.window.history;V&&V.scrollRestoration&&(V.scrollRestoration=Q)}}scrollToElement(Q){const V=Q.getBoundingClientRect(),j=V.left+this.window.pageXOffset,Ot=V.top+this.window.pageYOffset,Be=this.offset();this.window.scrollTo(j-Be[0],Ot-Be[1])}attemptFocus(Q){return Q.focus(),this.document.activeElement===Q}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const Q=pl(this.window.history)||pl(Object.getPrototypeOf(this.window.history));return!(!Q||!Q.writable&&!Q.set)}catch(Q){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(Q){return!1}}}function pl(kt){return Object.getOwnPropertyDescriptor(kt,"scrollRestoration")}class fa{}},40520:(B,X,_)=>{"use strict";_.d(X,{eN:()=>xt,JF:()=>Oe});var C=_(69808),m=_(5e3),e=_(39646),t=_(68306),n=_(24351),o=_(39300),r=_(54004);class a{}class h{}class R{constructor(Kt){this.normalizedNames=new Map,this.lazyUpdate=null,Kt?this.lazyInit="string"==typeof Kt?()=>{this.headers=new Map,Kt.split("\n").forEach(Zt=>{const We=Zt.indexOf(":");if(We>0){const $e=Zt.slice(0,We),Ti=$e.toLowerCase(),vi=Zt.slice(We+1).trim();this.maybeSetNormalizedName($e,Ti),this.headers.has(Ti)?this.headers.get(Ti).push(vi):this.headers.set(Ti,[vi])}})}:()=>{this.headers=new Map,Object.keys(Kt).forEach(Zt=>{let We=Kt[Zt];const $e=Zt.toLowerCase();"string"==typeof We&&(We=[We]),We.length>0&&(this.headers.set($e,We),this.maybeSetNormalizedName(Zt,$e))})}:this.headers=new Map}has(Kt){return this.init(),this.headers.has(Kt.toLowerCase())}get(Kt){this.init();const Zt=this.headers.get(Kt.toLowerCase());return Zt&&Zt.length>0?Zt[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(Kt){return this.init(),this.headers.get(Kt.toLowerCase())||null}append(Kt,Zt){return this.clone({name:Kt,value:Zt,op:"a"})}set(Kt,Zt){return this.clone({name:Kt,value:Zt,op:"s"})}delete(Kt,Zt){return this.clone({name:Kt,value:Zt,op:"d"})}maybeSetNormalizedName(Kt,Zt){this.normalizedNames.has(Zt)||this.normalizedNames.set(Zt,Kt)}init(){this.lazyInit&&(this.lazyInit instanceof R?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(Kt=>this.applyUpdate(Kt)),this.lazyUpdate=null))}copyFrom(Kt){Kt.init(),Array.from(Kt.headers.keys()).forEach(Zt=>{this.headers.set(Zt,Kt.headers.get(Zt)),this.normalizedNames.set(Zt,Kt.normalizedNames.get(Zt))})}clone(Kt){const Zt=new R;return Zt.lazyInit=this.lazyInit&&this.lazyInit instanceof R?this.lazyInit:this,Zt.lazyUpdate=(this.lazyUpdate||[]).concat([Kt]),Zt}applyUpdate(Kt){const Zt=Kt.name.toLowerCase();switch(Kt.op){case"a":case"s":let We=Kt.value;if("string"==typeof We&&(We=[We]),0===We.length)return;this.maybeSetNormalizedName(Kt.name,Zt);const $e=("a"===Kt.op?this.headers.get(Zt):void 0)||[];$e.push(...We),this.headers.set(Zt,$e);break;case"d":const Ti=Kt.value;if(Ti){let vi=this.headers.get(Zt);if(!vi)return;vi=vi.filter(di=>-1===Ti.indexOf(di)),0===vi.length?(this.headers.delete(Zt),this.normalizedNames.delete(Zt)):this.headers.set(Zt,vi)}else this.headers.delete(Zt),this.normalizedNames.delete(Zt)}}forEach(Kt){this.init(),Array.from(this.normalizedNames.keys()).forEach(Zt=>Kt(this.normalizedNames.get(Zt),this.headers.get(Zt)))}}class L{encodeKey(Kt){return Et(Kt)}encodeValue(Kt){return Et(Kt)}decodeKey(Kt){return decodeURIComponent(Kt)}decodeValue(Kt){return decodeURIComponent(Kt)}}const nt=/%(\d[a-f0-9])/gi,et={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function Et(ye){return encodeURIComponent(ye).replace(nt,(Kt,Zt)=>{var We;return null!==(We=et[Zt])&&void 0!==We?We:Kt})}function It(ye){return`${ye}`}class gt{constructor(Kt={}){if(this.updates=null,this.cloneFrom=null,this.encoder=Kt.encoder||new L,Kt.fromString){if(Kt.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function W(ye,Kt){const Zt=new Map;return ye.length>0&&ye.replace(/^\?/,"").split("&").forEach($e=>{const Ti=$e.indexOf("="),[vi,di]=-1==Ti?[Kt.decodeKey($e),""]:[Kt.decodeKey($e.slice(0,Ti)),Kt.decodeValue($e.slice(Ti+1))],Gi=Zt.get(vi)||[];Gi.push(di),Zt.set(vi,Gi)}),Zt}(Kt.fromString,this.encoder)}else Kt.fromObject?(this.map=new Map,Object.keys(Kt.fromObject).forEach(Zt=>{const We=Kt.fromObject[Zt];this.map.set(Zt,Array.isArray(We)?We:[We])})):this.map=null}has(Kt){return this.init(),this.map.has(Kt)}get(Kt){this.init();const Zt=this.map.get(Kt);return Zt?Zt[0]:null}getAll(Kt){return this.init(),this.map.get(Kt)||null}keys(){return this.init(),Array.from(this.map.keys())}append(Kt,Zt){return this.clone({param:Kt,value:Zt,op:"a"})}appendAll(Kt){const Zt=[];return Object.keys(Kt).forEach(We=>{const $e=Kt[We];Array.isArray($e)?$e.forEach(Ti=>{Zt.push({param:We,value:Ti,op:"a"})}):Zt.push({param:We,value:$e,op:"a"})}),this.clone(Zt)}set(Kt,Zt){return this.clone({param:Kt,value:Zt,op:"s"})}delete(Kt,Zt){return this.clone({param:Kt,value:Zt,op:"d"})}toString(){return this.init(),this.keys().map(Kt=>{const Zt=this.encoder.encodeKey(Kt);return this.map.get(Kt).map(We=>Zt+"="+this.encoder.encodeValue(We)).join("&")}).filter(Kt=>""!==Kt).join("&")}clone(Kt){const Zt=new gt({encoder:this.encoder});return Zt.cloneFrom=this.cloneFrom||this,Zt.updates=(this.updates||[]).concat(Kt),Zt}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(Kt=>this.map.set(Kt,this.cloneFrom.map.get(Kt))),this.updates.forEach(Kt=>{switch(Kt.op){case"a":case"s":const Zt=("a"===Kt.op?this.map.get(Kt.param):void 0)||[];Zt.push(It(Kt.value)),this.map.set(Kt.param,Zt);break;case"d":if(void 0===Kt.value){this.map.delete(Kt.param);break}{let We=this.map.get(Kt.param)||[];const $e=We.indexOf(It(Kt.value));-1!==$e&&We.splice($e,1),We.length>0?this.map.set(Kt.param,We):this.map.delete(Kt.param)}}}),this.cloneFrom=this.updates=null)}}class Ut{constructor(){this.map=new Map}set(Kt,Zt){return this.map.set(Kt,Zt),this}get(Kt){return this.map.has(Kt)||this.map.set(Kt,Kt.defaultValue()),this.map.get(Kt)}delete(Kt){return this.map.delete(Kt),this}has(Kt){return this.map.has(Kt)}keys(){return this.map.keys()}}function Ct(ye){return"undefined"!=typeof ArrayBuffer&&ye instanceof ArrayBuffer}function bt(ye){return"undefined"!=typeof Blob&&ye instanceof Blob}function at(ye){return"undefined"!=typeof FormData&&ye instanceof FormData}class lt{constructor(Kt,Zt,We,$e){let Ti;if(this.url=Zt,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=Kt.toUpperCase(),function Jt(ye){switch(ye){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||$e?(this.body=void 0!==We?We:null,Ti=$e):Ti=We,Ti&&(this.reportProgress=!!Ti.reportProgress,this.withCredentials=!!Ti.withCredentials,Ti.responseType&&(this.responseType=Ti.responseType),Ti.headers&&(this.headers=Ti.headers),Ti.context&&(this.context=Ti.context),Ti.params&&(this.params=Ti.params)),this.headers||(this.headers=new R),this.context||(this.context=new Ut),this.params){const vi=this.params.toString();if(0===vi.length)this.urlWithParams=Zt;else{const di=Zt.indexOf("?");this.urlWithParams=Zt+(-1===di?"?":di<Zt.length-1?"&":"")+vi}}else this.params=new gt,this.urlWithParams=Zt}serializeBody(){return null===this.body?null:Ct(this.body)||bt(this.body)||at(this.body)||function ft(ye){return"undefined"!=typeof URLSearchParams&&ye instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof gt?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||at(this.body)?null:bt(this.body)?this.body.type||null:Ct(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof gt?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(Kt={}){var Zt;const We=Kt.method||this.method,$e=Kt.url||this.url,Ti=Kt.responseType||this.responseType,vi=void 0!==Kt.body?Kt.body:this.body,di=void 0!==Kt.withCredentials?Kt.withCredentials:this.withCredentials,Gi=void 0!==Kt.reportProgress?Kt.reportProgress:this.reportProgress;let Ri=Kt.headers||this.headers,rn=Kt.params||this.params;const ge=null!==(Zt=Kt.context)&&void 0!==Zt?Zt:this.context;return void 0!==Kt.setHeaders&&(Ri=Object.keys(Kt.setHeaders).reduce((De,_i)=>De.set(_i,Kt.setHeaders[_i]),Ri)),Kt.setParams&&(rn=Object.keys(Kt.setParams).reduce((De,_i)=>De.set(_i,Kt.setParams[_i]),rn)),new lt(We,$e,vi,{params:rn,headers:Ri,context:ge,reportProgress:Gi,responseType:Ti,withCredentials:di})}}var Ft=(()=>((Ft=Ft||{})[Ft.Sent=0]="Sent",Ft[Ft.UploadProgress=1]="UploadProgress",Ft[Ft.ResponseHeader=2]="ResponseHeader",Ft[Ft.DownloadProgress=3]="DownloadProgress",Ft[Ft.Response=4]="Response",Ft[Ft.User=5]="User",Ft))();class Mt{constructor(Kt,Zt=200,We="OK"){this.headers=Kt.headers||new R,this.status=void 0!==Kt.status?Kt.status:Zt,this.statusText=Kt.statusText||We,this.url=Kt.url||null,this.ok=this.status>=200&&this.status<300}}class yt extends Mt{constructor(Kt={}){super(Kt),this.type=Ft.ResponseHeader}clone(Kt={}){return new yt({headers:Kt.headers||this.headers,status:void 0!==Kt.status?Kt.status:this.status,statusText:Kt.statusText||this.statusText,url:Kt.url||this.url||void 0})}}class ct extends Mt{constructor(Kt={}){super(Kt),this.type=Ft.Response,this.body=void 0!==Kt.body?Kt.body:null}clone(Kt={}){return new ct({body:void 0!==Kt.body?Kt.body:this.body,headers:Kt.headers||this.headers,status:void 0!==Kt.status?Kt.status:this.status,statusText:Kt.statusText||this.statusText,url:Kt.url||this.url||void 0})}}class rt extends Mt{constructor(Kt){super(Kt,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${Kt.url||"(unknown url)"}`:`Http failure response for ${Kt.url||"(unknown url)"}: ${Kt.status} ${Kt.statusText}`,this.error=Kt.error||null}}function se(ye,Kt){return{body:Kt,headers:ye.headers,context:ye.context,observe:ye.observe,params:ye.params,reportProgress:ye.reportProgress,responseType:ye.responseType,withCredentials:ye.withCredentials}}let xt=(()=>{class ye{constructor(Zt){this.handler=Zt}request(Zt,We,$e={}){let Ti;if(Zt instanceof lt)Ti=Zt;else{let Gi,Ri;Gi=$e.headers instanceof R?$e.headers:new R($e.headers),$e.params&&(Ri=$e.params instanceof gt?$e.params:new gt({fromObject:$e.params})),Ti=new lt(Zt,We,void 0!==$e.body?$e.body:null,{headers:Gi,context:$e.context,params:Ri,reportProgress:$e.reportProgress,responseType:$e.responseType||"json",withCredentials:$e.withCredentials})}const vi=(0,e.of)(Ti).pipe((0,n.b)(Gi=>this.handler.handle(Gi)));if(Zt instanceof lt||"events"===$e.observe)return vi;const di=vi.pipe((0,o.h)(Gi=>Gi instanceof ct));switch($e.observe||"body"){case"body":switch(Ti.responseType){case"arraybuffer":return di.pipe((0,r.U)(Gi=>{if(null!==Gi.body&&!(Gi.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return Gi.body}));case"blob":return di.pipe((0,r.U)(Gi=>{if(null!==Gi.body&&!(Gi.body instanceof Blob))throw new Error("Response is not a Blob.");return Gi.body}));case"text":return di.pipe((0,r.U)(Gi=>{if(null!==Gi.body&&"string"!=typeof Gi.body)throw new Error("Response is not a string.");return Gi.body}));default:return di.pipe((0,r.U)(Gi=>Gi.body))}case"response":return di;default:throw new Error(`Unreachable: unhandled observe type ${$e.observe}}`)}}delete(Zt,We={}){return this.request("DELETE",Zt,We)}get(Zt,We={}){return this.request("GET",Zt,We)}head(Zt,We={}){return this.request("HEAD",Zt,We)}jsonp(Zt,We){return this.request("JSONP",Zt,{params:(new gt).append(We,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Zt,We={}){return this.request("OPTIONS",Zt,We)}patch(Zt,We,$e={}){return this.request("PATCH",Zt,se($e,We))}post(Zt,We,$e={}){return this.request("POST",Zt,se($e,We))}put(Zt,We,$e={}){return this.request("PUT",Zt,se($e,We))}}return ye.\u0275fac=function(Zt){return new(Zt||ye)(m.LFG(a))},ye.\u0275prov=m.Yz7({token:ye,factory:ye.\u0275fac}),ye})();class Lt{constructor(Kt,Zt){this.next=Kt,this.interceptor=Zt}handle(Kt){return this.interceptor.intercept(Kt,this.next)}}const de=new m.OlP("HTTP_INTERCEPTORS");let _e=(()=>{class ye{intercept(Zt,We){return We.handle(Zt)}}return ye.\u0275fac=function(Zt){return new(Zt||ye)},ye.\u0275prov=m.Yz7({token:ye,factory:ye.\u0275fac}),ye})();const ri=/^\)\]\}',?\n/;let Ie=(()=>{class ye{constructor(Zt){this.xhrFactory=Zt}handle(Zt){if("JSONP"===Zt.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new t.y(We=>{const $e=this.xhrFactory.build();if($e.open(Zt.method,Zt.urlWithParams),Zt.withCredentials&&($e.withCredentials=!0),Zt.headers.forEach((_i,yi)=>$e.setRequestHeader(_i,yi.join(","))),Zt.headers.has("Accept")||$e.setRequestHeader("Accept","application/json, text/plain, */*"),!Zt.headers.has("Content-Type")){const _i=Zt.detectContentTypeHeader();null!==_i&&$e.setRequestHeader("Content-Type",_i)}if(Zt.responseType){const _i=Zt.responseType.toLowerCase();$e.responseType="json"!==_i?_i:"text"}const Ti=Zt.serializeBody();let vi=null;const di=()=>{if(null!==vi)return vi;const _i=1223===$e.status?204:$e.status,yi=$e.statusText||"OK",Fi=new R($e.getAllResponseHeaders()),Ni=function Bt(ye){return"responseURL"in ye&&ye.responseURL?ye.responseURL:/^X-Request-URL:/m.test(ye.getAllResponseHeaders())?ye.getResponseHeader("X-Request-URL"):null}($e)||Zt.url;return vi=new yt({headers:Fi,status:_i,statusText:yi,url:Ni}),vi},Gi=()=>{let{headers:_i,status:yi,statusText:Fi,url:Ni}=di(),mn=null;204!==yi&&(mn=void 0===$e.response?$e.responseText:$e.response),0===yi&&(yi=mn?200:0);let si=yi>=200&&yi<300;if("json"===Zt.responseType&&"string"==typeof mn){const Ce=mn;mn=mn.replace(ri,"");try{mn=""!==mn?JSON.parse(mn):null}catch(Vt){mn=Ce,si&&(si=!1,mn={error:Vt,text:mn})}}si?(We.next(new ct({body:mn,headers:_i,status:yi,statusText:Fi,url:Ni||void 0})),We.complete()):We.error(new rt({error:mn,headers:_i,status:yi,statusText:Fi,url:Ni||void 0}))},Ri=_i=>{const{url:yi}=di(),Fi=new rt({error:_i,status:$e.status||0,statusText:$e.statusText||"Unknown Error",url:yi||void 0});We.error(Fi)};let rn=!1;const ge=_i=>{rn||(We.next(di()),rn=!0);let yi={type:Ft.DownloadProgress,loaded:_i.loaded};_i.lengthComputable&&(yi.total=_i.total),"text"===Zt.responseType&&!!$e.responseText&&(yi.partialText=$e.responseText),We.next(yi)},De=_i=>{let yi={type:Ft.UploadProgress,loaded:_i.loaded};_i.lengthComputable&&(yi.total=_i.total),We.next(yi)};return $e.addEventListener("load",Gi),$e.addEventListener("error",Ri),$e.addEventListener("timeout",Ri),$e.addEventListener("abort",Ri),Zt.reportProgress&&($e.addEventListener("progress",ge),null!==Ti&&$e.upload&&$e.upload.addEventListener("progress",De)),$e.send(Ti),We.next({type:Ft.Sent}),()=>{$e.removeEventListener("error",Ri),$e.removeEventListener("abort",Ri),$e.removeEventListener("load",Gi),$e.removeEventListener("timeout",Ri),Zt.reportProgress&&($e.removeEventListener("progress",ge),null!==Ti&&$e.upload&&$e.upload.removeEventListener("progress",De)),$e.readyState!==$e.DONE&&$e.abort()}})}}return ye.\u0275fac=function(Zt){return new(Zt||ye)(m.LFG(C.JF))},ye.\u0275prov=m.Yz7({token:ye,factory:ye.\u0275fac}),ye})();const Xt=new m.OlP("XSRF_COOKIE_NAME"),he=new m.OlP("XSRF_HEADER_NAME");class Dt{}let ve=(()=>{class ye{constructor(Zt,We,$e){this.doc=Zt,this.platform=We,this.cookieName=$e,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Zt=this.doc.cookie||"";return Zt!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,C.Mx)(Zt,this.cookieName),this.lastCookieString=Zt),this.lastToken}}return ye.\u0275fac=function(Zt){return new(Zt||ye)(m.LFG(C.K0),m.LFG(m.Lbi),m.LFG(Xt))},ye.\u0275prov=m.Yz7({token:ye,factory:ye.\u0275fac}),ye})(),je=(()=>{class ye{constructor(Zt,We){this.tokenService=Zt,this.headerName=We}intercept(Zt,We){const $e=Zt.url.toLowerCase();if("GET"===Zt.method||"HEAD"===Zt.method||$e.startsWith("http://")||$e.startsWith("https://"))return We.handle(Zt);const Ti=this.tokenService.getToken();return null!==Ti&&!Zt.headers.has(this.headerName)&&(Zt=Zt.clone({headers:Zt.headers.set(this.headerName,Ti)})),We.handle(Zt)}}return ye.\u0275fac=function(Zt){return new(Zt||ye)(m.LFG(Dt),m.LFG(he))},ye.\u0275prov=m.Yz7({token:ye,factory:ye.\u0275fac}),ye})(),gi=(()=>{class ye{constructor(Zt,We){this.backend=Zt,this.injector=We,this.chain=null}handle(Zt){if(null===this.chain){const We=this.injector.get(de,[]);this.chain=We.reduceRight(($e,Ti)=>new Lt($e,Ti),this.backend)}return this.chain.handle(Zt)}}return ye.\u0275fac=function(Zt){return new(Zt||ye)(m.LFG(h),m.LFG(m.zs3))},ye.\u0275prov=m.Yz7({token:ye,factory:ye.\u0275fac}),ye})(),ee=(()=>{class ye{static disable(){return{ngModule:ye,providers:[{provide:je,useClass:_e}]}}static withOptions(Zt={}){return{ngModule:ye,providers:[Zt.cookieName?{provide:Xt,useValue:Zt.cookieName}:[],Zt.headerName?{provide:he,useValue:Zt.headerName}:[]]}}}return ye.\u0275fac=function(Zt){return new(Zt||ye)},ye.\u0275mod=m.oAB({type:ye}),ye.\u0275inj=m.cJS({providers:[je,{provide:de,useExisting:je,multi:!0},{provide:Dt,useClass:ve},{provide:Xt,useValue:"XSRF-TOKEN"},{provide:he,useValue:"X-XSRF-TOKEN"}]}),ye})(),Oe=(()=>{class ye{}return ye.\u0275fac=function(Zt){return new(Zt||ye)},ye.\u0275mod=m.oAB({type:ye}),ye.\u0275inj=m.cJS({providers:[xt,{provide:a,useClass:gi},Ie,{provide:h,useExisting:Ie}],imports:[[ee.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),ye})()},5e3:(B,X,_)=>{"use strict";_.d(X,{deG:()=>th,tb:()=>by,AFp:()=>vy,ip1:()=>d_,CZH:()=>Qd,hGG:()=>tS,z2F:()=>Bp,sBO:()=>MC,Sil:()=>f_,_Vd:()=>Ap,EJc:()=>Cy,SBq:()=>kp,qLn:()=>gc,vpe:()=>Eh,tBr:()=>Ra,XFs:()=>ee,OlP:()=>Tr,zs3:()=>iu,ZZ4:()=>Hf,aQg:()=>Uf,soG:()=>Ff,YKP:()=>Mv,h0i:()=>Jd,PXZ:()=>EC,R0b:()=>bu,FiY:()=>vl,Lbi:()=>Ty,g9A:()=>yy,n_E:()=>Af,Qsj:()=>sE,FYo:()=>Rv,JOm:()=>St,q3G:()=>ss,tp0:()=>Al,Rgc:()=>Pp,dDg:()=>Iy,GfV:()=>Iv,s_b:()=>xf,ifc:()=>vi,eFA:()=>My,G48:()=>DC,Gpc:()=>L,f3M:()=>Sa,_c5:()=>XC,VLi:()=>yC,c2e:()=>Ey,zSh:()=>Ud,wAp:()=>Io,vHH:()=>Et,EiD:()=>uu,mCW:()=>fr,qzn:()=>Re,JVY:()=>ci,pB0:()=>Ai,eBb:()=>ai,L6k:()=>Ze,LAX:()=>ki,cg1:()=>zg,kL8:()=>Jm,yhl:()=>Ue,dqk:()=>ge,sIi:()=>be,CqO:()=>rm,QGY:()=>Og,F4k:()=>om,RDi:()=>Jr,AaK:()=>a,z3N:()=>te,qOj:()=>s,TTD:()=>Br,_Bn:()=>Ev,xp6:()=>xh,uIk:()=>An,Gre:()=>Hm,ekj:()=>Fg,Suo:()=>$v,Xpm:()=>fe,lG2:()=>xe,Yz7:()=>Me,cJS:()=>Bt,oAB:()=>no,Yjl:()=>hi,Y36:()=>Rp,_UZ:()=>em,GkF:()=>im,BQk:()=>Mg,ynx:()=>Dg,qZA:()=>wg,TgZ:()=>Ig,EpF:()=>nm,n5z:()=>_l,Ikx:()=>Gg,LFG:()=>Yr,$8M:()=>nu,$Z:()=>tm,NdJ:()=>Ag,CRH:()=>Zv,kcU:()=>ra,O4$:()=>Ns,oxw:()=>lm,ALo:()=>Vv,lcZ:()=>Gv,Hsn:()=>um,F$t:()=>cm,Q6J:()=>Sg,s9C:()=>Lg,DdM:()=>xv,VKq:()=>Lv,WLB:()=>Nv,iGM:()=>Kv,MAs:()=>bf,CHM:()=>ie,LSH:()=>$c,Udp:()=>Pg,WFA:()=>kg,d8E:()=>Wg,YNc:()=>$l,W1O:()=>ey,_uU:()=>km,Oqu:()=>Hg,hij:()=>Sf,AsE:()=>Ug,lnq:()=>Vg,Gf:()=>Jv});var C=_(77579),m=_(50727),e=_(68306),t=_(56451),n=_(13099);function o(d){for(let p in d)if(d[p]===o)return p;throw Error("Could not find renamed property on target object.")}function r(d,p){for(const y in p)p.hasOwnProperty(y)&&!d.hasOwnProperty(y)&&(d[y]=p[y])}function a(d){if("string"==typeof d)return d;if(Array.isArray(d))return"["+d.map(a).join(", ")+"]";if(null==d)return""+d;if(d.overriddenName)return`${d.overriddenName}`;if(d.name)return`${d.name}`;const p=d.toString();if(null==p)return""+p;const y=p.indexOf("\n");return-1===y?p:p.substring(0,y)}function h(d,p){return null==d||""===d?null===p?"":p:null==p||""===p?d:d+" "+p}const R=o({__forward_ref__:o});function L(d){return d.__forward_ref__=L,d.toString=function(){return a(this())},d}function W(d){return nt(d)?d():d}function nt(d){return"function"==typeof d&&d.hasOwnProperty(R)&&d.__forward_ref__===L}class Et extends Error{constructor(p,y){super(function gt(d,p){return`${d?`NG0${d}: `:""}${p}`}(p,y)),this.code=p}}function wt(d){return"string"==typeof d?d:null==d?"":String(d)}function Ut(d){return"function"==typeof d?d.name||d.toString():"object"==typeof d&&null!=d&&"function"==typeof d.type?d.type.name||d.type.toString():wt(d)}function at(d,p){const y=p?` in ${p}`:"";throw new Et("201",`No provider for ${Ut(d)} found${y}`)}function Ae(d,p){null==d&&function Ne(d,p,y,I){throw new Error(`ASSERTION ERROR: ${d}`+(null==I?"":` [Expected=> ${y} ${I} ${p} <=Actual]`))}(p,d,null,"!=")}function Me(d){return{token:d.token,providedIn:d.providedIn||null,factory:d.factory,value:void 0}}function Bt(d){return{providers:d.providers||[],imports:d.imports||[]}}function Ie(d){return Xt(d,je)||Xt(d,Ee)}function Xt(d,p){return d.hasOwnProperty(p)?d[p]:null}function ve(d){return d&&(d.hasOwnProperty(gi)||d.hasOwnProperty(ne))?d[gi]:null}const je=o({\u0275prov:o}),gi=o({\u0275inj:o}),Ee=o({ngInjectableDef:o}),ne=o({ngInjectorDef:o});var ee=(()=>((ee=ee||{})[ee.Default=0]="Default",ee[ee.Host=1]="Host",ee[ee.Self=2]="Self",ee[ee.SkipSelf=4]="SkipSelf",ee[ee.Optional=8]="Optional",ee))();let Oe;function me(d){const p=Oe;return Oe=d,p}function ye(d,p,y){const I=Ie(d);return I&&"root"==I.providedIn?void 0===I.value?I.value=I.factory():I.value:y&ee.Optional?null:void 0!==p?p:void at(a(d),"Injector")}function Zt(d){return{toString:d}.toString()}var We=(()=>((We=We||{})[We.OnPush=0]="OnPush",We[We.Default=1]="Default",We))(),vi=(()=>{return(d=vi||(vi={}))[d.Emulated=0]="Emulated",d[d.None=2]="None",d[d.ShadowDom=3]="ShadowDom",vi;var d})();const di="undefined"!=typeof globalThis&&globalThis,Gi="undefined"!=typeof window&&window,Ri="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ge=di||"undefined"!=typeof global&&global||Gi||Ri,yi={},Fi=[],Ni=o({\u0275cmp:o}),mn=o({\u0275dir:o}),si=o({\u0275pipe:o}),Ce=o({\u0275mod:o}),Vt=o({\u0275fac:o}),vt=o({__NG_ELEMENT_ID__:o});let Gt=0;function fe(d){return Zt(()=>{const y={},I={type:d.type,providersResolver:null,decls:d.decls,vars:d.vars,factory:null,template:d.template||null,consts:d.consts||null,ngContentSelectors:d.ngContentSelectors,hostBindings:d.hostBindings||null,hostVars:d.hostVars||0,hostAttrs:d.hostAttrs||null,contentQueries:d.contentQueries||null,declaredInputs:y,inputs:null,outputs:null,exportAs:d.exportAs||null,onPush:d.changeDetection===We.OnPush,directiveDefs:null,pipeDefs:null,selectors:d.selectors||Fi,viewQuery:d.viewQuery||null,features:d.features||null,data:d.data||{},encapsulation:d.encapsulation||vi.Emulated,id:"c",styles:d.styles||Fi,_:null,setInput:null,schemas:d.schemas||null,tView:null},O=d.directives,F=d.features,$=d.pipes;return I.id+=Gt++,I.inputs=Je(d.inputs,y),I.outputs=Je(d.outputs),F&&F.forEach(st=>st(I)),I.directiveDefs=O?()=>("function"==typeof O?O():O).map($i):null,I.pipeDefs=$?()=>("function"==typeof $?$():$).map(tn):null,I})}function $i(d){return Oi(d)||function gn(d){return d[mn]||null}(d)}function tn(d){return function kn(d){return d[si]||null}(d)}const In={};function no(d){return Zt(()=>{const p={type:d.type,bootstrap:d.bootstrap||Fi,declarations:d.declarations||Fi,imports:d.imports||Fi,exports:d.exports||Fi,transitiveCompileScopes:null,schemas:d.schemas||null,id:d.id||null};return null!=d.id&&(In[d.id]=d.type),p})}function Je(d,p){if(null==d)return yi;const y={};for(const I in d)if(d.hasOwnProperty(I)){let O=d[I],F=O;Array.isArray(O)&&(F=O[1],O=O[0]),y[O]=I,p&&(p[O]=F)}return y}const xe=fe;function hi(d){return{type:d.type,name:d.name,factory:null,pure:!1!==d.pure,onDestroy:d.type.prototype.ngOnDestroy||null}}function Oi(d){return d[Ni]||null}function so(d,p){const y=d[Ce]||null;if(!y&&!0===p)throw new Error(`Type ${a(d)} does not have '\u0275mod' property.`);return y}function rr(d){return Array.isArray(d)&&"object"==typeof d[1]}function Or(d){return Array.isArray(d)&&!0===d[1]}function uo(d){return 0!=(8&d.flags)}function Os(d){return 2==(2&d.flags)}function Wr(d){return 1==(1&d.flags)}function sr(d){return null!==d.template}function wr(d){return 0!=(512&d[2])}function zr(d,p){return d.hasOwnProperty(Vt)?d[Vt]:null}class oa{constructor(p,y,I){this.previousValue=p,this.currentValue=y,this.firstChange=I}isFirstChange(){return this.firstChange}}function Br(){return pa}function pa(d){return d.type.prototype.ngOnChanges&&(d.setInput=tr),kr}function kr(){const d=ar(this),p=null==d?void 0:d.current;if(p){const y=d.previous;if(y===yi)d.previous=p;else for(let I in p)y[I]=p[I];d.current=null,this.ngOnChanges(p)}}function tr(d,p,y,I){const O=ar(d)||function As(d,p){return d[Es]=p}(d,{previous:yi,current:null}),F=O.current||(O.current={}),$=O.previous,st=this.declaredInputs[y],Tt=$[st];F[st]=new oa(Tt&&Tt.currentValue,p,$===yi),d[I]=p}Br.ngInherit=!0;const Es="__ngSimpleChanges__";function ar(d){return d[Es]||null}const Oa="http://www.w3.org/2000/svg";let hs;function Jr(d){hs=d}function No(d){return!!d.listen}const Pn={createRenderer:(d,p)=>function ks(){return void 0!==hs?hs:"undefined"!=typeof document?document:void 0}()};function kt(d){for(;Array.isArray(d);)d=d[0];return d}function j(d,p){return kt(p[d])}function Ot(d,p){return kt(p[d.index])}function bi(d,p){return d.data[p]}function un(d,p){return d[p]}function Hn(d,p){const y=p[d];return rr(y)?y:y[0]}function Po(d){return 4==(4&d[2])}function Yo(d){return 128==(128&d[2])}function er(d,p){return null==p?null:d[p]}function fo(d){d[18]=0}function xr(d,p){d[5]+=p;let y=d,I=d[3];for(;null!==I&&(1===p&&1===y[5]||-1===p&&0===y[5]);)I[5]+=p,y=I,I=I[3]}const Jn={lFrame:ir(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function xs(){return Jn.bindingsEnabled}function Xi(){return Jn.lFrame.lView}function Ho(){return Jn.lFrame.tView}function ie(d){return Jn.lFrame.contextLView=d,d[8]}function z(){let d=J();for(;null!==d&&64===d.type;)d=d.parent;return d}function J(){return Jn.lFrame.currentTNode}function Qt(d,p){const y=Jn.lFrame;y.currentTNode=d,y.isParent=p}function Te(){return Jn.lFrame.isParent}function Ye(){Jn.lFrame.isParent=!1}function Ui(){return Jn.isInCheckNoChangesMode}function hn(d){Jn.isInCheckNoChangesMode=d}function Tn(){const d=Jn.lFrame;let p=d.bindingRootIndex;return-1===p&&(p=d.bindingRootIndex=d.tView.bindingStartIndex),p}function $n(){return Jn.lFrame.bindingIndex}function Un(){return Jn.lFrame.bindingIndex++}function jn(d){const p=Jn.lFrame,y=p.bindingIndex;return p.bindingIndex=p.bindingIndex+d,y}function dr(d,p){const y=Jn.lFrame;y.bindingIndex=y.bindingRootIndex=d,Hr(p)}function Hr(d){Jn.lFrame.currentDirectiveIndex=d}function Ls(d){const p=Jn.lFrame.currentDirectiveIndex;return-1===p?null:d[p]}function ds(){return Jn.lFrame.currentQueryIndex}function Sr(d){Jn.lFrame.currentQueryIndex=d}function Js(d){const p=d[1];return 2===p.type?p.declTNode:1===p.type?d[6]:null}function $s(d,p,y){if(y&ee.SkipSelf){let O=p,F=d;for(;!(O=O.parent,null!==O||y&ee.Host||(O=Js(F),null===O||(F=F[15],10&O.type))););if(null===O)return!1;p=O,d=F}const I=Jn.lFrame=Aa();return I.currentTNode=p,I.lView=d,!0}function Zs(d){const p=Aa(),y=d[1];Jn.lFrame=p,p.currentTNode=y.firstChild,p.lView=d,p.tView=y,p.contextLView=d,p.bindingIndex=y.bindingStartIndex,p.inI18n=!1}function Aa(){const d=Jn.lFrame,p=null===d?null:d.child;return null===p?ir(d):p}function ir(d){const p={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:d,child:null,inI18n:!1};return null!==d&&(d.child=p),p}function Qs(){const d=Jn.lFrame;return Jn.lFrame=d.parent,d.currentTNode=null,d.lView=null,d}const ja=Qs;function ps(){const d=Qs();d.isParent=!0,d.tView=null,d.selectedIndex=-1,d.contextLView=null,d.elementDepthCount=0,d.currentDirectiveIndex=-1,d.currentNamespace=null,d.bindingRootIndex=-1,d.bindingIndex=-1,d.currentQueryIndex=0}function Nn(){return Jn.lFrame.selectedIndex}function bo(d){Jn.lFrame.selectedIndex=d}function Eo(){const d=Jn.lFrame;return bi(d.tView,d.selectedIndex)}function Ns(){Jn.lFrame.currentNamespace=Oa}function ra(){!function lr(){Jn.lFrame.currentNamespace=null}()}function Ss(d,p){for(let y=p.directiveStart,I=p.directiveEnd;y<I;y++){const F=d.data[y].type.prototype,{ngAfterContentInit:$,ngAfterContentChecked:st,ngAfterViewInit:Tt,ngAfterViewChecked:jt,ngOnDestroy:ue}=F;$&&(d.contentHooks||(d.contentHooks=[])).push(-y,$),st&&((d.contentHooks||(d.contentHooks=[])).push(y,st),(d.contentCheckHooks||(d.contentCheckHooks=[])).push(y,st)),Tt&&(d.viewHooks||(d.viewHooks=[])).push(-y,Tt),jt&&((d.viewHooks||(d.viewHooks=[])).push(y,jt),(d.viewCheckHooks||(d.viewCheckHooks=[])).push(y,jt)),null!=ue&&(d.destroyHooks||(d.destroyHooks=[])).push(y,ue)}}function ba(d,p,y){Zl(d,p,3,y)}function jr(d,p,y,I){(3&d[2])===y&&Zl(d,p,y,I)}function Fs(d,p){let y=d[2];(3&y)===p&&(y&=2047,y+=1,d[2]=y)}function Zl(d,p,y,I){const F=null!=I?I:-1,$=p.length-1;let st=0;for(let Tt=void 0!==I?65535&d[18]:0;Tt<$;Tt++)if("number"==typeof p[Tt+1]){if(st=p[Tt],null!=I&&st>=I)break}else p[Tt]<0&&(d[18]+=65536),(st<F||-1==F)&&(al(d,y,p,Tt),d[18]=(4294901760&d[18])+Tt+2),Tt++}function al(d,p,y,I){const O=y[I]<0,F=y[I+1],st=d[O?-y[I]:y[I]];if(O){if(d[2]>>11<d[18]>>16&&(3&d[2])===p){d[2]+=2048;try{F.call(st)}finally{}}}else try{F.call(st)}finally{}}class Zr{constructor(p,y,I){this.factory=p,this.resolving=!1,this.canSeeViewProviders=y,this.injectImpl=I}}function gl(d,p,y){const I=No(d);let O=0;for(;O<y.length;){const F=y[O];if("number"==typeof F){if(0!==F)break;O++;const $=y[O++],st=y[O++],Tt=y[O++];I?d.setAttribute(p,st,Tt,$):p.setAttributeNS($,st,Tt)}else{const $=F,st=y[++O];ga($)?I&&d.setProperty(p,$,st):I?d.setAttribute(p,$,st):p.setAttribute($,st),O++}}return O}function Fc(d){return 3===d||4===d||6===d}function ga(d){return 64===d.charCodeAt(0)}function ql(d,p){if(null!==p&&0!==p.length)if(null===d||0===d.length)d=p.slice();else{let y=-1;for(let I=0;I<p.length;I++){const O=p[I];"number"==typeof O?y=O:0===y||Xa(d,y,O,null,-1===y||2===y?p[++I]:null)}}return d}function Xa(d,p,y,I,O){let F=0,$=d.length;if(-1===p)$=-1;else for(;F<d.length;){const st=d[F++];if("number"==typeof st){if(st===p){$=-1;break}if(st>p){$=F-1;break}}}for(;F<d.length;){const st=d[F];if("number"==typeof st)break;if(st===y){if(null===I)return void(null!==O&&(d[F+1]=O));if(I===d[F+1])return void(d[F+2]=O)}F++,null!==I&&F++,null!==O&&F++}-1!==$&&(d.splice($,0,p),F=$+1),d.splice(F++,0,y),null!==I&&d.splice(F++,0,I),null!==O&&d.splice(F++,0,O)}function qs(d){return-1!==d}function xa(d){return 32767&d}function Ea(d,p){let y=function Hs(d){return d>>16}(d),I=p;for(;y>0;)I=I[15],y--;return I}let Cl=!0;function tc(d){const p=Cl;return Cl=d,p}let dt=0;function q(d,p){const y=Wt(d,p);if(-1!==y)return y;const I=p[1];I.firstCreatePass&&(d.injectorIndex=p.length,At(I.data,d),At(p,null),At(I.blueprint,null));const O=pe(d,p),F=d.injectorIndex;if(qs(O)){const $=xa(O),st=Ea(O,p),Tt=st[1].data;for(let jt=0;jt<8;jt++)p[F+jt]=st[$+jt]|Tt[$+jt]}return p[F+8]=O,F}function At(d,p){d.push(0,0,0,0,0,0,0,0,p)}function Wt(d,p){return-1===d.injectorIndex||d.parent&&d.parent.injectorIndex===d.injectorIndex||null===p[d.injectorIndex+8]?-1:d.injectorIndex}function pe(d,p){if(d.parent&&-1!==d.parent.injectorIndex)return d.parent.injectorIndex;let y=0,I=null,O=p;for(;null!==O;){const F=O[1],$=F.type;if(I=2===$?F.declTNode:1===$?O[6]:null,null===I)return-1;if(y++,O=O[15],-1!==I.injectorIndex)return I.injectorIndex|y<<16}return-1}function Ve(d,p,y){!function ot(d,p,y){let I;"string"==typeof y?I=y.charCodeAt(0)||0:y.hasOwnProperty(vt)&&(I=y[vt]),null==I&&(I=y[vt]=dt++);const O=255&I;p.data[d+(O>>5)]|=1<<O}(d,p,y)}function Li(d,p,y){if(y&ee.Optional)return d;at(p,"NodeInjector")}function wn(d,p,y,I){if(y&ee.Optional&&void 0===I&&(I=null),0==(y&(ee.Self|ee.Host))){const O=d[9],F=me(void 0);try{return O?O.get(p,I,y&ee.Optional):ye(p,I,y&ee.Optional)}finally{me(F)}}return Li(I,p,y)}function Co(d,p,y,I=ee.Default,O){if(null!==d){const F=function fs(d){if("string"==typeof d)return d.charCodeAt(0)||0;const p=d.hasOwnProperty(vt)?d[vt]:void 0;return"number"==typeof p?p>=0?255&p:Jo:p}(y);if("function"==typeof F){if(!$s(p,d,I))return I&ee.Host?Li(O,y,I):wn(p,y,I,O);try{const $=F(I);if(null!=$||I&ee.Optional)return $;at(y)}finally{ja()}}else if("number"==typeof F){let $=null,st=Wt(d,p),Tt=-1,jt=I&ee.Host?p[16][6]:null;for((-1===st||I&ee.SkipSelf)&&(Tt=-1===st?pe(d,p):p[st+8],-1!==Tt&&Ka(I,!1)?($=p[1],st=xa(Tt),p=Ea(Tt,p)):st=-1);-1!==st;){const ue=p[1];if(Vs(F,st,ue.data)){const Pe=pr(st,p,y,$,I,jt);if(Pe!==Kn)return Pe}Tt=p[st+8],-1!==Tt&&Ka(I,p[1].data[st+8]===jt)&&Vs(F,st,p)?($=ue,st=xa(Tt),p=Ea(Tt,p)):st=-1}}}return wn(p,y,I,O)}const Kn={};function Jo(){return new os(z(),Xi())}function pr(d,p,y,I,O,F){const $=p[1],st=$.data[d+8],ue=Sl(st,$,y,null==I?Os(st)&&Cl:I!=$&&0!=(3&st.type),O&ee.Host&&F===st);return null!==ue?Us(p,$,ue,st):Kn}function Sl(d,p,y,I,O){const F=d.providerIndexes,$=p.data,st=1048575&F,Tt=d.directiveStart,ue=F>>20,ni=O?st+ue:d.directiveEnd;for(let Ci=I?st:st+ue;Ci<ni;Ci++){const Ji=$[Ci];if(Ci<Tt&&y===Ji||Ci>=Tt&&Ji.type===y)return Ci}if(O){const Ci=$[Tt];if(Ci&&sr(Ci)&&Ci.type===y)return Tt}return null}function Us(d,p,y,I){let O=d[y];const F=p.data;if(function sa(d){return d instanceof Zr}(O)){const $=O;$.resolving&&function Jt(d,p){const y=p?`. Dependency path: ${p.join(" > ")} > ${d}`:"";throw new Et("200",`Circular dependency in DI detected for ${d}${y}`)}(Ut(F[y]));const st=tc($.canSeeViewProviders);$.resolving=!0;const Tt=$.injectImpl?me($.injectImpl):null;$s(d,I,ee.Default);try{O=d[y]=$.factory(void 0,F,d,I),p.firstCreatePass&&y>=I.directiveStart&&function ns(d,p,y){const{ngOnChanges:I,ngOnInit:O,ngDoCheck:F}=p.type.prototype;if(I){const $=pa(p);(y.preOrderHooks||(y.preOrderHooks=[])).push(d,$),(y.preOrderCheckHooks||(y.preOrderCheckHooks=[])).push(d,$)}O&&(y.preOrderHooks||(y.preOrderHooks=[])).push(0-d,O),F&&((y.preOrderHooks||(y.preOrderHooks=[])).push(d,F),(y.preOrderCheckHooks||(y.preOrderCheckHooks=[])).push(d,F))}(y,F[y],p)}finally{null!==Tt&&me(Tt),tc(st),$.resolving=!1,ja()}}return O}function Vs(d,p,y){return!!(y[p+(d>>5)]&1<<d)}function Ka(d,p){return!(d&ee.Self||d&ee.Host&&p)}class os{constructor(p,y){this._tNode=p,this._lView=y}get(p,y,I){return Co(this._tNode,this._lView,p,I,y)}}function _l(d){return Zt(()=>{const p=d.prototype.constructor,y=p[Vt]||Ja(p),I=Object.prototype;let O=Object.getPrototypeOf(d.prototype).constructor;for(;O&&O!==I;){const F=O[Vt]||Ja(O);if(F&&F!==y)return F;O=Object.getPrototypeOf(O)}return F=>new F})}function Ja(d){return nt(d)?()=>{const p=Ja(W(d));return p&&p()}:zr(d)}function nu(d){return function ti(d,p){if("class"===p)return d.classes;if("style"===p)return d.styles;const y=d.attrs;if(y){const I=y.length;let O=0;for(;O<I;){const F=y[O];if(Fc(F))break;if(0===F)O+=2;else if("number"==typeof F)for(O++;O<I&&"string"==typeof y[O];)O++;else{if(F===p)return y[O+1];O+=2}}}return null}(z(),d)}const Vl="__parameters__";function nr(d,p,y){return Zt(()=>{const I=function Dr(d){return function(...y){if(d){const I=d(...y);for(const O in I)this[O]=I[O]}}}(p);function O(...F){if(this instanceof O)return I.apply(this,F),this;const $=new O(...F);return st.annotation=$,st;function st(Tt,jt,ue){const Pe=Tt.hasOwnProperty(Vl)?Tt[Vl]:Object.defineProperty(Tt,Vl,{value:[]})[Vl];for(;Pe.length<=ue;)Pe.push(null);return(Pe[ue]=Pe[ue]||[]).push($),Tt}}return y&&(O.prototype=Object.create(y.prototype)),O.prototype.ngMetadataName=d,O.annotationCls=O,O})}class Tr{constructor(p,y){this._desc=p,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof y?this.__NG_ELEMENT_ID__=y:void 0!==y&&(this.\u0275prov=Me({token:this,providedIn:y.providedIn||"root",factory:y.factory}))}toString(){return`InjectionToken ${this._desc}`}}const th=new Tr("AnalyzeForEntryComponents");function Ca(d,p){void 0===p&&(p=d);for(let y=0;y<d.length;y++){let I=d[y];Array.isArray(I)?(p===d&&(p=d.slice(0,y)),Ca(I,p)):p!==d&&p.push(I)}return p}function aa(d,p){d.forEach(y=>Array.isArray(y)?aa(y,p):p(y))}function Za(d,p,y){p>=d.length?d.push(y):d.splice(p,0,y)}function La(d,p){return p>=d.length-1?d.pop():d.splice(p,1)[0]}function Ec(d,p){const y=[];for(let I=0;I<d;I++)y.push(p);return y}function Is(d,p,y){let I=ic(d,p);return I>=0?d[1|I]=y:(I=~I,function Wo(d,p,y,I){let O=d.length;if(O==p)d.push(y,I);else if(1===O)d.push(I,d[0]),d[0]=y;else{for(O--,d.push(d[O-1],d[O]);O>p;)d[O]=d[O-2],O--;d[p]=y,d[p+1]=I}}(d,I,p,y)),I}function Qa(d,p){const y=ic(d,p);if(y>=0)return d[1|y]}function ic(d,p){return function wl(d,p,y){let I=0,O=d.length>>y;for(;O!==I;){const F=I+(O-I>>1),$=d[F<<y];if(p===$)return F<<y;$>p?O=F:I=F+1}return~(O<<y)}(d,p,1)}const Dl={},Gc="__NG_DI_FLAG__",Mr="ngTempTokenPath",cc=/\n/gm,Ml="__source",qa=o({provide:String,useValue:o});let ta;function Wc(d){const p=ta;return ta=d,p}function ul(d,p=ee.Default){if(void 0===ta)throw new Error("inject() must be called from an injection context");return null===ta?ye(d,void 0,p):ta.get(d,p&ee.Optional?null:void 0,p)}function Yr(d,p=ee.Default){return(function le(){return Oe}()||ul)(W(d),p)}const Sa=Yr;function oc(d){const p=[];for(let y=0;y<d.length;y++){const I=W(d[y]);if(Array.isArray(I)){if(0===I.length)throw new Error("Arguments array must have arguments.");let O,F=ee.Default;for(let $=0;$<I.length;$++){const st=I[$],Tt=nh(st);"number"==typeof Tt?-1===Tt?O=st.token:F|=Tt:O=st}p.push(Yr(O,F))}else p.push(Yr(I))}return p}function Sc(d,p){return d[Gc]=p,d.prototype[Gc]=p,d}function nh(d){return d[Gc]}const Ra=Sc(nr("Inject",d=>({token:d})),-1),vl=Sc(nr("Optional"),8),Al=Sc(nr("SkipSelf"),4);let xl;function tl(d){var p;return(null===(p=function Ll(){if(void 0===xl&&(xl=null,ge.trustedTypes))try{xl=ge.trustedTypes.createPolicy("angular",{createHTML:d=>d,createScript:d=>d,createScriptURL:d=>d})}catch(d){}return xl}())||void 0===p?void 0:p.createHTML(d))||d}class Nl{constructor(p){this.changingThisBreaksApplicationSecurity=p}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Uu extends Nl{getTypeName(){return"HTML"}}class ms extends Nl{getTypeName(){return"Style"}}class Mc extends Nl{getTypeName(){return"Script"}}class mt extends Nl{getTypeName(){return"URL"}}class Rt extends Nl{getTypeName(){return"ResourceURL"}}function te(d){return d instanceof Nl?d.changingThisBreaksApplicationSecurity:d}function Re(d,p){const y=Ue(d);if(null!=y&&y!==p){if("ResourceURL"===y&&"URL"===p)return!0;throw new Error(`Required a safe ${p}, got a ${y} (see https://g.co/ng/security#xss)`)}return y===p}function Ue(d){return d instanceof Nl&&d.getTypeName()||null}function ci(d){return new Uu(d)}function Ze(d){return new ms(d)}function ai(d){return new Mc(d)}function ki(d){return new mt(d)}function Ai(d){return new Rt(d)}class to{constructor(p){this.inertDocumentHelper=p}getInertBodyElement(p){p="<body><remove></remove>"+p;try{const y=(new window.DOMParser).parseFromString(tl(p),"text/html").body;return null===y?this.inertDocumentHelper.getInertBodyElement(p):(y.removeChild(y.firstChild),y)}catch(y){return null}}}class zn{constructor(p){if(this.defaultDoc=p,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const y=this.inertDocument.createElement("html");this.inertDocument.appendChild(y);const I=this.inertDocument.createElement("body");y.appendChild(I)}}getInertBodyElement(p){const y=this.inertDocument.createElement("template");if("content"in y)return y.innerHTML=tl(p),y;const I=this.inertDocument.createElement("body");return I.innerHTML=tl(p),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(I),I}stripCustomNsAttrs(p){const y=p.attributes;for(let O=y.length-1;0<O;O--){const $=y.item(O).name;("xmlns:ns1"===$||0===$.indexOf("ns1:"))&&p.removeAttribute($)}let I=p.firstChild;for(;I;)I.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(I),I=I.nextSibling}}const Ur=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,$o=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function fr(d){return(d=String(d)).match(Ur)||d.match($o)?d:"unsafe:"+d}function mr(d){const p={};for(const y of d.split(","))p[y]=!0;return p}function ua(...d){const p={};for(const y of d)for(const I in y)y.hasOwnProperty(I)&&(p[I]=!0);return p}const rs=mr("area,br,col,hr,img,wbr"),ws=mr("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),bl=mr("rp,rt"),Oc=ua(rs,ua(ws,mr("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ua(bl,mr("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ua(bl,ws)),Gu=mr("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Ac=mr("srcset"),oh=ua(Gu,Ac,mr("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),mr("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Mu=mr("script,style,template");class rh{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(p){let y=p.firstChild,I=!0;for(;y;)if(y.nodeType===Node.ELEMENT_NODE?I=this.startElement(y):y.nodeType===Node.TEXT_NODE?this.chars(y.nodeValue):this.sanitizedSomething=!0,I&&y.firstChild)y=y.firstChild;else for(;y;){y.nodeType===Node.ELEMENT_NODE&&this.endElement(y);let O=this.checkClobberedElement(y,y.nextSibling);if(O){y=O;break}y=this.checkClobberedElement(y,y.parentNode)}return this.buf.join("")}startElement(p){const y=p.nodeName.toLowerCase();if(!Oc.hasOwnProperty(y))return this.sanitizedSomething=!0,!Mu.hasOwnProperty(y);this.buf.push("<"),this.buf.push(y);const I=p.attributes;for(let O=0;O<I.length;O++){const F=I.item(O),$=F.name,st=$.toLowerCase();if(!oh.hasOwnProperty(st)){this.sanitizedSomething=!0;continue}let Tt=F.value;Gu[st]&&(Tt=fr(Tt)),Ac[st]&&(d=Tt,Tt=(d=String(d)).split(",").map(p=>fr(p.trim())).join(", ")),this.buf.push(" ",$,'="',cu(Tt),'"')}var d;return this.buf.push(">"),!0}endElement(p){const y=p.nodeName.toLowerCase();Oc.hasOwnProperty(y)&&!rs.hasOwnProperty(y)&&(this.buf.push("</"),this.buf.push(y),this.buf.push(">"))}chars(p){this.buf.push(cu(p))}checkClobberedElement(p,y){if(y&&(p.compareDocumentPosition(y)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${p.outerHTML}`);return y}}const Wu=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,sh=/([^\#-~ |!])/g;function cu(d){return d.replace(/&/g,"&amp;").replace(Wu,function(p){return"&#"+(1024*(p.charCodeAt(0)-55296)+(p.charCodeAt(1)-56320)+65536)+";"}).replace(sh,function(p){return"&#"+p.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let pc;function uu(d,p){let y=null;try{pc=pc||function Vi(d){const p=new zn(d);return function ho(){try{return!!(new window.DOMParser).parseFromString(tl(""),"text/html")}catch(d){return!1}}()?new to(p):p}(d);let I=p?String(p):"";y=pc.getInertBodyElement(I);let O=5,F=I;do{if(0===O)throw new Error("Failed to sanitize html because the input is unstable");O--,I=F,F=y.innerHTML,y=pc.getInertBodyElement(I)}while(I!==F);return tl((new rh).sanitizeChildren(zu(y)||y))}finally{if(y){const I=zu(y)||y;for(;I.firstChild;)I.removeChild(I.firstChild)}}}function zu(d){return"content"in d&&function Ch(d){return d.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===d.nodeName}(d)?d.content:null}var ss=(()=>((ss=ss||{})[ss.NONE=0]="NONE",ss[ss.HTML=1]="HTML",ss[ss.STYLE=2]="STYLE",ss[ss.SCRIPT=3]="SCRIPT",ss[ss.URL=4]="URL",ss[ss.RESOURCE_URL=5]="RESOURCE_URL",ss))();function $c(d){const p=function fc(){const d=Xi();return d&&d[12]}();return p?p.sanitize(ss.URL,d)||"":Re(d,"URL")?te(d):fr(wt(d))}const lh="__ngContext__";function ha(d,p){d[lh]=p}function Qc(d){const p=function Pl(d){return d[lh]||null}(d);return p?Array.isArray(p)?p:p.lView:null}function gu(d){return d.ngOriginalError}function Yu(d,...p){d.error(...p)}class gc{constructor(){this._console=console}handleError(p){const y=this._findOriginalError(p),I=function qc(d){return d&&d.ngErrorLogger||Yu}(p);I(this._console,"ERROR",p),y&&I(this._console,"ORIGINAL ERROR",y)}_findOriginalError(p){let y=p&&gu(p);for(;y&&gu(y);)y=gu(y);return y||null}}const ph=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ge))();function M(d){return d instanceof Function?d():d}var St=(()=>((St=St||{})[St.Important=1]="Important",St[St.DashCase=2]="DashCase",St))();function $t(d,p){return undefined(d,p)}function pi(d){const p=d[3];return Or(p)?p[3]:p}function ji(d){return vn(d[13])}function ln(d){return vn(d[4])}function vn(d){for(;null!==d&&!Or(d);)d=d[4];return d}function pn(d,p,y,I,O){if(null!=I){let F,$=!1;Or(I)?F=I:rr(I)&&($=!0,I=I[0]);const st=kt(I);0===d&&null!==y?null==O?Yt(p,y,st):zt(p,y,st,O||null,!0):1===d&&null!==y?zt(p,y,st,O||null,!0):2===d?function ko(d,p,y){const I=we(d,p);I&&function Se(d,p,y,I){No(d)?d.removeChild(p,y,I):p.removeChild(y)}(d,I,p,y)}(p,st,$):3===d&&p.destroyNode(st),null!=F&&function Ba(d,p,y,I,O){const F=y[7];F!==kt(y)&&pn(p,d,I,F,O);for(let st=10;st<y.length;st++){const Tt=y[st];gr(Tt[1],Tt,d,p,I,F)}}(p,d,F,y,O)}}function Ro(d,p,y){return No(d)?d.createElement(p,y):null===y?d.createElement(p):d.createElementNS(y,p)}function Xo(d,p){const y=d[9],I=y.indexOf(p),O=p[3];1024&p[2]&&(p[2]&=-1025,xr(O,-1)),y.splice(I,1)}function as(d,p){if(d.length<=10)return;const y=10+p,I=d[y];if(I){const O=I[17];null!==O&&O!==d&&Xo(O,I),p>0&&(d[y-1][4]=I[4]);const F=La(d,10+p);!function Er(d,p){gr(d,p,p[11],2,null,null),p[0]=null,p[6]=null}(I[1],I);const $=F[19];null!==$&&$.detachView(F[1]),I[3]=null,I[4]=null,I[2]&=-129}return I}function ls(d,p){if(!(256&p[2])){const y=p[11];No(y)&&y.destroyNode&&gr(d,p,y,3,null,null),function Da(d){let p=d[13];if(!p)return S(d[1],d);for(;p;){let y=null;if(rr(p))y=p[13];else{const I=p[10];I&&(y=I)}if(!y){for(;p&&!p[4]&&p!==d;)rr(p)&&S(p[1],p),p=p[3];null===p&&(p=d),rr(p)&&S(p[1],p),y=p&&p[4]}p=y}}(p)}}function S(d,p){if(!(256&p[2])){p[2]&=-129,p[2]|=256,function Y(d,p){let y;if(null!=d&&null!=(y=d.destroyHooks))for(let I=0;I<y.length;I+=2){const O=p[y[I]];if(!(O instanceof Zr)){const F=y[I+1];if(Array.isArray(F))for(let $=0;$<F.length;$+=2){const st=O[F[$]],Tt=F[$+1];try{Tt.call(st)}finally{}}else try{F.call(O)}finally{}}}}(d,p),function U(d,p){const y=d.cleanup,I=p[7];let O=-1;if(null!==y)for(let F=0;F<y.length-1;F+=2)if("string"==typeof y[F]){const $=y[F+1],st="function"==typeof $?$(p):kt(p[$]),Tt=I[O=y[F+2]],jt=y[F+3];"boolean"==typeof jt?st.removeEventListener(y[F],Tt,jt):jt>=0?I[O=jt]():I[O=-jt].unsubscribe(),F+=2}else{const $=I[O=y[F+1]];y[F].call($)}if(null!==I){for(let F=O+1;F<I.length;F++)I[F]();p[7]=null}}(d,p),1===p[1].type&&No(p[11])&&p[11].destroy();const y=p[17];if(null!==y&&Or(p[3])){y!==p[3]&&Xo(y,p);const I=p[19];null!==I&&I.detachView(d)}}}function it(d,p,y){return function pt(d,p,y){let I=p;for(;null!==I&&40&I.type;)I=(p=I).parent;if(null===I)return y[0];if(2&I.flags){const O=d.data[I.directiveStart].encapsulation;if(O===vi.None||O===vi.Emulated)return null}return Ot(I,y)}(d,p.parent,y)}function zt(d,p,y,I,O){No(d)?d.insertBefore(p,y,I,O):p.insertBefore(y,I,O)}function Yt(d,p,y){No(d)?d.appendChild(p,y):p.appendChild(y)}function oe(d,p,y,I,O){null!==I?zt(d,p,y,I,O):Yt(d,p,y)}function we(d,p){return No(d)?d.parentNode(p):p.parentNode}function oi(d,p,y){return Si(d,p,y)}let Si=function fi(d,p,y){return 40&d.type?Ot(d,y):null};function cn(d,p,y,I){const O=it(d,I,p),F=p[11],st=oi(I.parent||p[6],I,p);if(null!=O)if(Array.isArray(y))for(let Tt=0;Tt<y.length;Tt++)oe(F,O,y[Tt],st,!1);else oe(F,O,y,st,!1)}function xn(d,p){if(null!==p){const y=p.type;if(3&y)return Ot(p,d);if(4&y)return go(-1,d[p.index]);if(8&y){const I=p.child;if(null!==I)return xn(d,I);{const O=d[p.index];return Or(O)?go(-1,O):kt(O)}}if(32&y)return $t(p,d)()||kt(d[p.index]);{const I=en(d,p);return null!==I?Array.isArray(I)?I[0]:xn(pi(d[16]),I):xn(d,p.next)}}return null}function en(d,p){return null!==p?d[16][6].projection[p.projection]:null}function go(d,p){const y=10+d+1;if(y<p.length){const I=p[y],O=I[1].firstChild;if(null!==O)return xn(I,O)}return p[7]}function Qr(d,p,y,I,O,F,$){for(;null!=y;){const st=I[y.index],Tt=y.type;if($&&0===p&&(st&&ha(kt(st),I),y.flags|=4),64!=(64&y.flags))if(8&Tt)Qr(d,p,y.child,I,O,F,!1),pn(p,d,O,st,F);else if(32&Tt){const jt=$t(y,I);let ue;for(;ue=jt();)pn(p,d,O,ue,F);pn(p,d,O,st,F)}else 16&Tt?qr(d,p,I,y,O,F):pn(p,d,O,st,F);y=$?y.projectionNext:y.next}}function gr(d,p,y,I,O,F){Qr(y,I,d.firstChild,p,O,F,!1)}function qr(d,p,y,I,O,F){const $=y[16],Tt=$[6].projection[I.projection];if(Array.isArray(Tt))for(let jt=0;jt<Tt.length;jt++)pn(p,d,O,Tt[jt],F);else Qr(d,p,Tt,$[3],O,F,!0)}function Ms(d,p,y){No(d)?d.setAttribute(p,"style",y):p.style.cssText=y}function jo(d,p,y){No(d)?""===y?d.removeAttribute(p,"class"):d.setAttribute(p,"class",y):p.className=y}function Gs(d,p,y){let I=d.length;for(;;){const O=d.indexOf(p,y);if(-1===O)return O;if(0===O||d.charCodeAt(O-1)<=32){const F=p.length;if(O+F===I||d.charCodeAt(O+F)<=32)return O}y=O+1}}const _c="ng-template";function mc(d,p,y){let I=0;for(;I<d.length;){let O=d[I++];if(y&&"class"===O){if(O=d[I],-1!==Gs(O.toLowerCase(),p,0))return!0}else if(1===O){for(;I<d.length&&"string"==typeof(O=d[I++]);)if(O.toLowerCase()===p)return!0;return!1}}return!1}function Xu(d){return 4===d.type&&d.value!==_c}function Wh(d,p,y){return p===(4!==d.type||y?d.value:_c)}function od(d,p,y){let I=4;const O=d.attrs||[],F=function Ts(d){for(let p=0;p<d.length;p++)if(Fc(d[p]))return p;return d.length}(O);let $=!1;for(let st=0;st<p.length;st++){const Tt=p[st];if("number"!=typeof Tt){if(!$)if(4&I){if(I=2|1&I,""!==Tt&&!Wh(d,Tt,y)||""===Tt&&1===p.length){if(Jl(I))return!1;$=!0}}else{const jt=8&I?Tt:p[++st];if(8&I&&null!==d.attrs){if(!mc(d.attrs,jt,y)){if(Jl(I))return!1;$=!0}continue}const Pe=rd(8&I?"class":Tt,O,Xu(d),y);if(-1===Pe){if(Jl(I))return!1;$=!0;continue}if(""!==jt){let ni;ni=Pe>F?"":O[Pe+1].toLowerCase();const Ci=8&I?ni:null;if(Ci&&-1!==Gs(Ci,jt,0)||2&I&&jt!==ni){if(Jl(I))return!1;$=!0}}}}else{if(!$&&!Jl(I)&&!Jl(Tt))return!1;if($&&Jl(Tt))continue;$=!1,I=Tt|1&I}}return Jl(I)||$}function Jl(d){return 0==(1&d)}function rd(d,p,y,I){if(null===p)return-1;let O=0;if(I||!y){let F=!1;for(;O<p.length;){const $=p[O];if($===d)return O;if(3===$||6===$)F=!0;else{if(1===$||2===$){let st=p[++O];for(;"string"==typeof st;)st=p[++O];continue}if(4===$)break;if(0===$){O+=4;continue}}O+=F?1:2}return-1}return function zh(d,p){let y=d.indexOf(4);if(y>-1)for(y++;y<d.length;){const I=d[y];if("number"==typeof I)return-1;if(I===p)return y;y++}return-1}(p,d)}function Id(d,p,y=!1){for(let I=0;I<p.length;I++)if(od(d,p[I],y))return!0;return!1}function jh(d,p){t:for(let y=0;y<p.length;y++){const I=p[y];if(d.length===I.length){for(let O=0;O<d.length;O++)if(d[O]!==I[O])continue t;return!0}}return!1}function kh(d,p){return d?":not("+p.trim()+")":p}function Yh(d){let p=d[0],y=1,I=2,O="",F=!1;for(;y<d.length;){let $=d[y];if("string"==typeof $)if(2&I){const st=d[++y];O+="["+$+(st.length>0?'="'+st+'"':"")+"]"}else 8&I?O+="."+$:4&I&&(O+=" "+$);else""!==O&&!Jl($)&&(p+=kh(F,O),O=""),I=$,F=F||!Jl(I);y++}return""!==O&&(p+=kh(F,O)),p}const wo={};function xh(d){sd(Ho(),Xi(),Nn()+d,Ui())}function sd(d,p,y,I){if(!I)if(3==(3&p[2])){const F=d.preOrderCheckHooks;null!==F&&ba(p,F,y)}else{const F=d.preOrderHooks;null!==F&&jr(p,F,0,y)}bo(y)}function Xh(d,p){return d<<17|p<<2}function Nc(d){return d>>17&32767}function ad(d){return 2|d}function vu(d){return(131068&d)>>2}function ld(d,p){return-131069&d|p<<2}function Kh(d){return 1|d}function xd(d,p){const y=d.contentQueries;if(null!==y)for(let I=0;I<y.length;I+=2){const O=y[I],F=y[I+1];if(-1!==F){const $=d.data[F];Sr(O),$.contentQueries(2,p[F],F)}}}function Nh(d,p,y,I,O,F,$,st,Tt,jt){const ue=p.blueprint.slice();return ue[0]=O,ue[2]=140|I,fo(ue),ue[3]=ue[15]=d,ue[8]=y,ue[10]=$||d&&d[10],ue[11]=st||d&&d[11],ue[12]=Tt||d&&d[12]||null,ue[9]=jt||d&&d[9]||null,ue[6]=F,ue[16]=2==p.type?d[16]:ue,ue}function Ph(d,p,y,I,O){let F=d.data[p];if(null===F)F=function Td(d,p,y,I,O){const F=J(),$=Te(),Tt=d.data[p]=function wi(d,p,y,I,O,F){return{type:y,index:I,insertBeforeIndex:null,injectorIndex:p?p.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:O,attrs:F,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:p,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,$?F:F&&F.parent,y,p,I,O);return null===d.firstChild&&(d.firstChild=Tt),null!==F&&($?null==F.child&&null!==Tt.parent&&(F.child=Tt):null===F.next&&(F.next=Tt)),Tt}(d,p,y,I,O),function oo(){return Jn.lFrame.inI18n}()&&(F.flags|=64);else if(64&F.type){F.type=y,F.value=I,F.attrs=O;const $=function _t(){const d=Jn.lFrame,p=d.currentTNode;return d.isParent?p:p.parent}();F.injectorIndex=null===$?-1:$.injectorIndex}return Qt(F,!0),F}function Fh(d,p,y,I){if(0===y)return-1;const O=p.length;for(let F=0;F<y;F++)p.push(I),d.blueprint.push(I),d.data.push(null);return O}function td(d,p,y){Zs(p);try{const I=d.viewQuery;null!==I&&mp(1,I,y);const O=d.template;null!==O&&bd(d,p,O,1,y),d.firstCreatePass&&(d.firstCreatePass=!1),d.staticContentQueries&&xd(d,p),d.staticViewQueries&&mp(2,d.viewQuery,y);const F=d.components;null!==F&&function up(d,p){for(let y=0;y<p.length;y++)qf(d,p[y])}(p,F)}catch(I){throw d.firstCreatePass&&(d.incompleteFirstPass=!0,d.firstCreatePass=!1),I}finally{p[2]&=-5,ps()}}function Bh(d,p,y,I){const O=p[2];if(256==(256&O))return;Zs(p);const F=Ui();try{fo(p),function po(d){return Jn.lFrame.bindingIndex=d}(d.bindingStartIndex),null!==y&&bd(d,p,y,2,I);const $=3==(3&O);if(!F)if($){const jt=d.preOrderCheckHooks;null!==jt&&ba(p,jt,null)}else{const jt=d.preOrderHooks;null!==jt&&jr(p,jt,0,null),Fs(p,0)}if(function Zf(d){for(let p=ji(d);null!==p;p=ln(p)){if(!p[2])continue;const y=p[9];for(let I=0;I<y.length;I++){const O=y[I],F=O[3];0==(1024&O[2])&&xr(F,1),O[2]|=1024}}}(p),function Fd(d){for(let p=ji(d);null!==p;p=ln(p))for(let y=10;y<p.length;y++){const I=p[y],O=I[1];Yo(I)&&Bh(O,I,O.template,I[8])}}(p),null!==d.contentQueries&&xd(d,p),!F)if($){const jt=d.contentCheckHooks;null!==jt&&ba(p,jt)}else{const jt=d.contentHooks;null!==jt&&jr(p,jt,1),Fs(p,1)}!function cp(d,p){const y=d.hostBindingOpCodes;if(null!==y)try{for(let I=0;I<y.length;I++){const O=y[I];if(O<0)bo(~O);else{const F=O,$=y[++I],st=y[++I];dr($,F),st(2,p[F])}}}finally{bo(-1)}}(d,p);const st=d.components;null!==st&&function yd(d,p){for(let y=0;y<p.length;y++)Qf(d,p[y])}(p,st);const Tt=d.viewQuery;if(null!==Tt&&mp(2,Tt,I),!F)if($){const jt=d.viewCheckHooks;null!==jt&&ba(p,jt)}else{const jt=d.viewHooks;null!==jt&&jr(p,jt,2),Fs(p,2)}!0===d.firstUpdatePass&&(d.firstUpdatePass=!1),F||(p[2]&=-73),1024&p[2]&&(p[2]&=-1025,xr(p[3],-1))}finally{ps()}}function hp(d,p,y,I){const O=p[10],F=!Ui(),$=Po(p);try{F&&!$&&O.begin&&O.begin(),$&&td(d,p,I),Bh(d,p,y,I)}finally{F&&!$&&O.end&&O.end()}}function bd(d,p,y,I,O){const F=Nn(),$=2&I;try{bo(-1),$&&p.length>20&&sd(d,p,20,Ui()),y(I,O)}finally{bo(F)}}function ed(d,p,y){if(uo(p)){const O=p.directiveEnd;for(let F=p.directiveStart;F<O;F++){const $=d.data[F];$.contentQueries&&$.contentQueries(1,y[F],F)}}}function Ed(d,p,y){!xs()||(function Xp(d,p,y,I){const O=y.directiveStart,F=y.directiveEnd;d.firstCreatePass||q(y,p),ha(I,p);const $=y.initialInputs;for(let st=O;st<F;st++){const Tt=d.data[st],jt=sr(Tt);jt&&Kf(p,y,Tt);const ue=Us(p,d,st,y);ha(ue,p),null!==$&&Jf(0,st-O,ue,Tt,0,$),jt&&(Hn(y.index,p)[8]=ue)}}(d,p,y,Ot(y,p)),128==(128&y.flags)&&function zf(d,p,y){const I=y.directiveStart,O=y.directiveEnd,$=y.index,st=function is(){return Jn.lFrame.currentDirectiveIndex}();try{bo($);for(let Tt=I;Tt<O;Tt++){const jt=d.data[Tt],ue=p[Tt];Hr(Tt),(null!==jt.hostBindings||0!==jt.hostVars||null!==jt.hostAttrs)&&Kp(jt,ue)}}finally{bo(-1),Hr(st)}}(d,p,y))}function Ld(d,p,y=Ot){const I=p.localNames;if(null!==I){let O=p.index+1;for(let F=0;F<I.length;F+=2){const $=I[F+1],st=-1===$?y(p,d):d[$];d[O++]=st}}}function N(d){const p=d.tView;return null===p||p.incompleteFirstPass?d.tView=G(1,null,d.template,d.decls,d.vars,d.directiveDefs,d.pipeDefs,d.viewQuery,d.schemas,d.consts):p}function G(d,p,y,I,O,F,$,st,Tt,jt){const ue=20+I,Pe=ue+O,ni=function T(d,p){const y=[];for(let I=0;I<p;I++)y.push(I<d?null:wo);return y}(ue,Pe),Ci="function"==typeof jt?jt():jt;return ni[1]={type:d,blueprint:ni,template:y,queries:null,viewQuery:st,declTNode:p,data:ni.slice().fill(null,ue),bindingStartIndex:ue,expandoStartIndex:Pe,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof F?F():F,pipeRegistry:"function"==typeof $?$():$,firstChild:null,schemas:Tt,consts:Ci,incompleteFirstPass:!1}}function Ke(d,p,y,I){const O=tf(p);null===y?O.push(I):(O.push(y),d.firstCreatePass&&ef(d).push(I,O.length-1))}function qi(d,p,y){for(let I in d)if(d.hasOwnProperty(I)){const O=d[I];(y=null===y?{}:y).hasOwnProperty(I)?y[I].push(p,O):y[I]=[p,O]}return y}function _o(d,p,y,I,O,F,$,st){const Tt=Ot(p,y);let ue,jt=p.inputs;!st&&null!=jt&&(ue=jt[I])?(sf(d,y,ue,I,O),Os(p)&&function or(d,p){const y=Hn(p,d);16&y[2]||(y[2]|=64)}(y,p.index)):3&p.type&&(I=function dn(d){return"class"===d?"className":"for"===d?"htmlFor":"formaction"===d?"formAction":"innerHtml"===d?"innerHTML":"readonly"===d?"readOnly":"tabindex"===d?"tabIndex":d}(I),O=null!=$?$(O,p.value||"",I):O,No(F)?F.setProperty(Tt,I,O):ga(I)||(Tt.setProperty?Tt.setProperty(I,O):Tt[I]=O))}function Hh(d,p,y,I){let O=!1;if(xs()){const F=function jf(d,p,y){const I=d.directiveRegistry;let O=null;if(I)for(let F=0;F<I.length;F++){const $=I[F];Id(y,$.selectors,!1)&&(O||(O=[]),Ve(q(y,p),d,$.type),sr($)?(Uh(d,y),O.unshift($)):O.push($))}return O}(d,p,y),$=null===I?null:{"":-1};if(null!==F){O=!0,Jp(y,d.data.length,F.length);for(let ue=0;ue<F.length;ue++){const Pe=F[ue];Pe.providersResolver&&Pe.providersResolver(Pe)}let st=!1,Tt=!1,jt=Fh(d,p,F.length,null);for(let ue=0;ue<F.length;ue++){const Pe=F[ue];y.mergedAttrs=ql(y.mergedAttrs,Pe.hostAttrs),$p(d,y,p,jt,Pe),Xf(jt,Pe,$),null!==Pe.contentQueries&&(y.flags|=8),(null!==Pe.hostBindings||null!==Pe.hostAttrs||0!==Pe.hostVars)&&(y.flags|=128);const ni=Pe.type.prototype;!st&&(ni.ngOnChanges||ni.ngOnInit||ni.ngDoCheck)&&((d.preOrderHooks||(d.preOrderHooks=[])).push(y.index),st=!0),!Tt&&(ni.ngOnChanges||ni.ngDoCheck)&&((d.preOrderCheckHooks||(d.preOrderCheckHooks=[])).push(y.index),Tt=!0),jt++}!function Fn(d,p){const I=p.directiveEnd,O=d.data,F=p.attrs,$=[];let st=null,Tt=null;for(let jt=p.directiveStart;jt<I;jt++){const ue=O[jt],Pe=ue.inputs,ni=null===F||Xu(p)?null:$f(Pe,F);$.push(ni),st=qi(Pe,jt,st),Tt=qi(ue.outputs,jt,Tt)}null!==st&&(st.hasOwnProperty("class")&&(p.flags|=16),st.hasOwnProperty("style")&&(p.flags|=32)),p.initialInputs=$,p.inputs=st,p.outputs=Tt}(d,y)}$&&function Yf(d,p,y){if(p){const I=d.localNames=[];for(let O=0;O<p.length;O+=2){const F=y[p[O+1]];if(null==F)throw new Et("301",`Export of name '${p[O+1]}' not found!`);I.push(p[O],F)}}}(y,I,$)}return y.mergedAttrs=ql(y.mergedAttrs,y.attrs),O}function Pd(d,p,y,I,O,F){const $=F.hostBindings;if($){let st=d.hostBindingOpCodes;null===st&&(st=d.hostBindingOpCodes=[]);const Tt=~p.index;(function Wf(d){let p=d.length;for(;p>0;){const y=d[--p];if("number"==typeof y&&y<0)return y}return 0})(st)!=Tt&&st.push(Tt),st.push(I,O,$)}}function Kp(d,p){null!==d.hostBindings&&d.hostBindings(1,p)}function Uh(d,p){p.flags|=2,(d.components||(d.components=[])).push(p.index)}function Xf(d,p,y){if(y){if(p.exportAs)for(let I=0;I<p.exportAs.length;I++)y[p.exportAs[I]]=d;sr(p)&&(y[""]=d)}}function Jp(d,p,y){d.flags|=1,d.directiveStart=p,d.directiveEnd=p+y,d.providerIndexes=p}function $p(d,p,y,I,O){d.data[I]=O;const F=O.factory||(O.factory=zr(O.type)),$=new Zr(F,sr(O),null);d.blueprint[I]=$,y[I]=$,Pd(d,p,0,I,Fh(d,y,O.hostVars,wo),O)}function Kf(d,p,y){const I=Ot(p,d),O=N(y),F=d[10],$=Bd(d,Nh(d,O,null,y.onPush?64:16,I,p,F,F.createRenderer(I,y),null,null));d[p.index]=$}function Pu(d,p,y,I,O,F){const $=Ot(d,p);!function dp(d,p,y,I,O,F,$){if(null==F)No(d)?d.removeAttribute(p,O,y):p.removeAttribute(O);else{const st=null==$?wt(F):$(F,I||"",O);No(d)?d.setAttribute(p,O,st,y):y?p.setAttributeNS(y,O,st):p.setAttribute(O,st)}}(p[11],$,F,d.value,y,I,O)}function Jf(d,p,y,I,O,F){const $=F[p];if(null!==$){const st=I.setInput;for(let Tt=0;Tt<$.length;){const jt=$[Tt++],ue=$[Tt++],Pe=$[Tt++];null!==st?I.setInput(y,Pe,jt,ue):y[ue]=Pe}}}function $f(d,p){let y=null,I=0;for(;I<p.length;){const O=p[I];if(0!==O)if(5!==O){if("number"==typeof O)break;d.hasOwnProperty(O)&&(null===y&&(y=[]),y.push(O,d[O],p[I+1])),I+=2}else I+=2;else I+=4}return y}function Zp(d,p,y,I){return new Array(d,!0,!1,p,null,0,I,y,null,null)}function Qf(d,p){const y=Hn(p,d);if(Yo(y)){const I=y[1];80&y[2]?Bh(I,y,I.template,y[8]):y[5]>0&&pp(y)}}function pp(d){for(let I=ji(d);null!==I;I=ln(I))for(let O=10;O<I.length;O++){const F=I[O];if(1024&F[2]){const $=F[1];Bh($,F,$.template,F[8])}else F[5]>0&&pp(F)}const y=d[1].components;if(null!==y)for(let I=0;I<y.length;I++){const O=Hn(y[I],d);Yo(O)&&O[5]>0&&pp(O)}}function qf(d,p){const y=Hn(p,d),I=y[1];(function tg(d,p){for(let y=p.length;y<d.blueprint.length;y++)p.push(d.blueprint[y])})(I,y),td(I,y,y[8])}function Bd(d,p){return d[13]?d[14][4]=p:d[13]=p,d[14]=p,p}function fp(d){for(;d;){d[2]|=64;const p=pi(d);if(wr(d)&&!p)return d;d=p}return null}function _p(d,p,y){const I=p[10];I.begin&&I.begin();try{Bh(d,p,d.template,y)}catch(O){throw rf(p,O),O}finally{I.end&&I.end()}}function Qp(d){!function gp(d){for(let p=0;p<d.components.length;p++){const y=d.components[p],I=Qc(y),O=I[1];hp(O,I,O.template,y)}}(d[8])}function mp(d,p,y){Sr(0),p(d,y)}const vp=(()=>Promise.resolve(null))();function tf(d){return d[7]||(d[7]=[])}function ef(d){return d.cleanup||(d.cleanup=[])}function nf(d,p,y){return(null===d||sr(d))&&(y=function Q(d){for(;Array.isArray(d);){if("object"==typeof d[1])return d;d=d[0]}return null}(y[p.index])),y[11]}function rf(d,p){const y=d[9],I=y?y.get(gc,null):null;I&&I.handleError(p)}function sf(d,p,y,I,O){for(let F=0;F<y.length;){const $=y[F++],st=y[F++],Tt=p[$],jt=d.data[$];null!==jt.setInput?jt.setInput(Tt,O,I,st):Tt[st]=O}}function Ju(d,p,y){const I=j(p,d);!function eo(d,p,y){No(d)?d.setValue(p,y):p.textContent=y}(d[11],I,y)}function Hd(d,p,y){let I=y?d.styles:null,O=y?d.classes:null,F=0;if(null!==p)for(let $=0;$<p.length;$++){const st=p[$];"number"==typeof st?F=st:1==F?O=h(O,st):2==F&&(I=h(I,st+": "+p[++$]+";"))}y?d.styles=I:d.stylesWithoutHost=I,y?d.classes=O:d.classesWithoutHost=O}const yp=new Tr("INJECTOR",-1);class af{get(p,y=Dl){if(y===Dl){const I=new Error(`NullInjectorError: No provider for ${a(p)}!`);throw I.name="NullInjectorError",I}return y}}const Ud=new Tr("Set Injector scope."),mh={},rg={};let Tp;function lf(){return void 0===Tp&&(Tp=new af),Tp}function cf(d,p=null,y=null,I){const O=uf(d,p,y,I);return O._resolveInjectorDefTypes(),O}function uf(d,p=null,y=null,I){return new sg(d,y,p||lf(),I)}class sg{constructor(p,y,I,O=null){this.parent=I,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const F=[];y&&aa(y,st=>this.processProvider(st,p,y)),aa([p],st=>this.processInjectorType(st,[],F)),this.records.set(yp,nd(void 0,this));const $=this.records.get(Ud);this.scope=null!=$?$.value:null,this.source=O||("object"==typeof p?null:a(p))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(p=>p.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(p,y=Dl,I=ee.Default){this.assertNotDestroyed();const O=Wc(this),F=me(void 0);try{if(!(I&ee.SkipSelf)){let st=this.records.get(p);if(void 0===st){const Tt=function pg(d){return"function"==typeof d||"object"==typeof d&&d instanceof Tr}(p)&&Ie(p);st=Tt&&this.injectableDefInScope(Tt)?nd(bp(p),mh):null,this.records.set(p,st)}if(null!=st)return this.hydrate(p,st)}return(I&ee.Self?lf():this.parent).get(p,y=I&ee.Optional&&y===Dl?null:y)}catch($){if("NullInjectorError"===$.name){if(($[Mr]=$[Mr]||[]).unshift(a(p)),O)throw $;return function wu(d,p,y,I){const O=d[Mr];throw p[Ml]&&O.unshift(p[Ml]),d.message=function ca(d,p,y,I=null){d=d&&"\n"===d.charAt(0)&&"\u0275"==d.charAt(1)?d.substr(2):d;let O=a(p);if(Array.isArray(p))O=p.map(a).join(" -> ");else if("object"==typeof p){let F=[];for(let $ in p)if(p.hasOwnProperty($)){let st=p[$];F.push($+":"+("string"==typeof st?JSON.stringify(st):a(st)))}O=`{${F.join(", ")}}`}return`${y}${I?"("+I+")":""}[${O}]: ${d.replace(cc,"\n  ")}`}("\n"+d.message,O,y,I),d.ngTokenPath=O,d[Mr]=null,d}($,p,"R3InjectorError",this.source)}throw $}finally{me(F),Wc(O)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(p=>this.get(p))}toString(){const p=[];return this.records.forEach((I,O)=>p.push(a(O))),`R3Injector[${p.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(p,y,I){if(!(p=W(p)))return!1;let O=ve(p);const F=null==O&&p.ngModule||void 0,$=void 0===F?p:F,st=-1!==I.indexOf($);if(void 0!==F&&(O=ve(F)),null==O)return!1;if(null!=O.imports&&!st){let ue;I.push($);try{aa(O.imports,Pe=>{this.processInjectorType(Pe,y,I)&&(void 0===ue&&(ue=[]),ue.push(Pe))})}finally{}if(void 0!==ue)for(let Pe=0;Pe<ue.length;Pe++){const{ngModule:ni,providers:Ci}=ue[Pe];aa(Ci,Ji=>this.processProvider(Ji,ni,Ci||Fi))}}this.injectorDefTypes.add($);const Tt=zr($)||(()=>new $);this.records.set($,nd(Tt,mh));const jt=O.providers;if(null!=jt&&!st){const ue=p;aa(jt,Pe=>this.processProvider(Pe,ue,jt))}return void 0!==F&&void 0!==p.providers}processProvider(p,y,I){let O=Vh(p=W(p))?p:W(p&&p.provide);const F=function lg(d,p,y){return df(d)?nd(void 0,d.useValue):nd(hf(d),mh)}(p);if(Vh(p)||!0!==p.multi)this.records.get(O);else{let $=this.records.get(O);$||($=nd(void 0,mh,!0),$.factory=()=>oc($.multi),this.records.set(O,$)),O=p,$.multi.push(p)}this.records.set(O,F)}hydrate(p,y){return y.value===mh&&(y.value=rg,y.value=y.factory()),"object"==typeof y.value&&y.value&&function dg(d){return null!==d&&"object"==typeof d&&"function"==typeof d.ngOnDestroy}(y.value)&&this.onDestroy.add(y.value),y.value}injectableDefInScope(p){if(!p.providedIn)return!1;const y=W(p.providedIn);return"string"==typeof y?"any"===y||y===this.scope:this.injectorDefTypes.has(y)}}function bp(d){const p=Ie(d),y=null!==p?p.factory:zr(d);if(null!==y)return y;if(d instanceof Tr)throw new Error(`Token ${a(d)} is missing a \u0275prov definition.`);if(d instanceof Function)return function ag(d){const p=d.length;if(p>0){const I=Ec(p,"?");throw new Error(`Can't resolve all parameters for ${a(d)}: (${I.join(", ")}).`)}const y=function he(d){const p=d&&(d[je]||d[Ee]);if(p){const y=function Dt(d){if(d.hasOwnProperty("name"))return d.name;const p=(""+d).match(/^function\s*([^\s(]+)/);return null===p?"":p[1]}(d);return console.warn(`DEPRECATED: DI is instantiating a token "${y}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${y}" class.`),p}return null}(d);return null!==y?()=>y.factory(d):()=>new d}(d);throw new Error("unreachable")}function hf(d,p,y){let I;if(Vh(d)){const O=W(d);return zr(O)||bp(O)}if(df(d))I=()=>W(d.useValue);else if(function cg(d){return!(!d||!d.useFactory)}(d))I=()=>d.useFactory(...oc(d.deps||[]));else if(function Vd(d){return!(!d||!d.useExisting)}(d))I=()=>Yr(W(d.useExisting));else{const O=W(d&&(d.useClass||d.provide));if(!function hg(d){return!!d.deps}(d))return zr(O)||bp(O);I=()=>new O(...oc(d.deps))}return I}function nd(d,p,y=!1){return{factory:d,value:p,multi:y?[]:void 0}}function df(d){return null!==d&&"object"==typeof d&&qa in d}function Vh(d){return"function"==typeof d}let iu=(()=>{class d{static create(y,I){var O;if(Array.isArray(y))return cf({name:""},I,y,"");{const F=null!==(O=y.name)&&void 0!==O?O:"";return cf({name:F},y.parent,y.providers,F)}}}return d.THROW_IF_NOT_FOUND=Dl,d.NULL=new af,d.\u0275prov=Me({token:d,providedIn:"any",factory:()=>Yr(yp)}),d.__NG_ELEMENT_ID__=-1,d})();function yg(d,p){Ss(Qc(d)[1],z())}function s(d){let p=function c(d){return Object.getPrototypeOf(d.prototype).constructor}(d.type),y=!0;const I=[d];for(;p;){let O;if(sr(d))O=p.\u0275cmp||p.\u0275dir;else{if(p.\u0275cmp)throw new Error("Directives cannot inherit Components");O=p.\u0275dir}if(O){if(y){I.push(O);const $=d;$.inputs=u(d.inputs),$.declaredInputs=u(d.declaredInputs),$.outputs=u(d.outputs);const st=O.hostBindings;st&&w(d,st);const Tt=O.viewQuery,jt=O.contentQueries;if(Tt&&g(d,Tt),jt&&b(d,jt),r(d.inputs,O.inputs),r(d.declaredInputs,O.declaredInputs),r(d.outputs,O.outputs),sr(O)&&O.data.animation){const ue=d.data;ue.animation=(ue.animation||[]).concat(O.data.animation)}}const F=O.features;if(F)for(let $=0;$<F.length;$++){const st=F[$];st&&st.ngInherit&&st(d),st===s&&(y=!1)}}p=Object.getPrototypeOf(p)}!function l(d){let p=0,y=null;for(let I=d.length-1;I>=0;I--){const O=d[I];O.hostVars=p+=O.hostVars,O.hostAttrs=ql(O.hostAttrs,y=ql(y,O.hostAttrs))}}(I)}function u(d){return d===yi?{}:d===Fi?[]:d}function g(d,p){const y=d.viewQuery;d.viewQuery=y?(I,O)=>{p(I,O),y(I,O)}:p}function b(d,p){const y=d.contentQueries;d.contentQueries=y?(I,O,F)=>{p(I,O,F),y(I,O,F)}:p}function w(d,p){const y=d.hostBindings;d.hostBindings=y?(I,O)=>{p(I,O),y(I,O)}:p}let ht=null;function Pt(){if(!ht){const d=ge.Symbol;if(d&&d.iterator)ht=d.iterator;else{const p=Object.getOwnPropertyNames(Map.prototype);for(let y=0;y<p.length;++y){const I=p[y];"entries"!==I&&"size"!==I&&Map.prototype[I]===Map.prototype.entries&&(ht=I)}}}return ht}function be(d){return!!Xe(d)&&(Array.isArray(d)||!(d instanceof Map)&&Pt()in d)}function Xe(d){return null!==d&&("function"==typeof d||"object"==typeof d)}function Ei(d,p,y){return d[p]=y}function Hi(d,p,y){return!Object.is(d[p],y)&&(d[p]=y,!0)}function Wi(d,p,y,I){const O=Hi(d,p,y);return Hi(d,p+1,I)||O}function An(d,p,y,I){const O=Xi();return Hi(O,Un(),p)&&(Ho(),Pu(Eo(),O,d,p,y,I)),An}function Cn(d,p,y,I){return Hi(d,Un(),y)?p+wt(y)+I:wo}function Vn(d,p,y,I,O,F,$,st){const jt=function yn(d,p,y,I,O){const F=Wi(d,p,y,I);return Hi(d,p+2,O)||F}(d,$n(),y,O,$);return jn(3),jt?p+wt(y)+I+wt(O)+F+wt($)+st:wo}function $l(d,p,y,I,O,F,$,st){const Tt=Xi(),jt=Ho(),ue=d+20,Pe=jt.firstCreatePass?function Wd(d,p,y,I,O,F,$,st,Tt){const jt=p.consts,ue=Ph(p,d,4,$||null,er(jt,st));Hh(p,y,ue,er(jt,Tt)),Ss(p,ue);const Pe=ue.tViews=G(2,ue,I,O,F,p.directiveRegistry,p.pipeRegistry,null,p.schemas,jt);return null!==p.queries&&(p.queries.template(p,ue),Pe.queries=p.queries.embeddedTView(ue)),ue}(ue,jt,Tt,p,y,I,O,F,$):jt.data[ue];Qt(Pe,!1);const ni=Tt[11].createComment("");cn(jt,Tt,ni,Pe),ha(ni,Tt),Bd(Tt,Tt[ue]=Zp(ni,Tt,ni,Pe)),Wr(Pe)&&Ed(jt,Tt,Pe),null!=$&&Ld(Tt,Pe,st)}function bf(d){return un(function mi(){return Jn.lFrame.contextLView}(),20+d)}function Rp(d,p=ee.Default){const y=Xi();return null===y?Yr(d,p):Co(z(),y,W(d),p)}function tm(){throw new Error("invalid")}function Sg(d,p,y){const I=Xi();return Hi(I,Un(),p)&&_o(Ho(),Eo(),I,d,p,I[11],y,!1),Sg}function Rg(d,p,y,I,O){const $=O?"class":"style";sf(d,y,p.inputs[$],$,I)}function Ig(d,p,y,I){const O=Xi(),F=Ho(),$=20+d,st=O[11],Tt=O[$]=Ro(st,p,function Lr(){return Jn.lFrame.currentNamespace}()),jt=F.firstCreatePass?function gT(d,p,y,I,O,F,$){const st=p.consts,jt=Ph(p,d,2,O,er(st,F));return Hh(p,y,jt,er(st,$)),null!==jt.attrs&&Hd(jt,jt.attrs,!1),null!==jt.mergedAttrs&&Hd(jt,jt.mergedAttrs,!0),null!==p.queries&&p.queries.elementStart(p,jt),jt}($,F,O,0,p,y,I):F.data[$];Qt(jt,!0);const ue=jt.mergedAttrs;null!==ue&&gl(st,Tt,ue);const Pe=jt.classes;null!==Pe&&jo(st,Tt,Pe);const ni=jt.styles;null!==ni&&Ms(st,Tt,ni),64!=(64&jt.flags)&&cn(F,O,Tt,jt),0===function sl(){return Jn.lFrame.elementDepthCount}()&&ha(Tt,O),function $r(){Jn.lFrame.elementDepthCount++}(),Wr(jt)&&(Ed(F,O,jt),ed(F,jt,O)),null!==I&&Ld(O,jt)}function wg(){let d=z();Te()?Ye():(d=d.parent,Qt(d,!1));const p=d;!function za(){Jn.lFrame.elementDepthCount--}();const y=Ho();y.firstCreatePass&&(Ss(y,d),uo(d)&&y.queries.elementEnd(d)),null!=p.classesWithoutHost&&function ll(d){return 0!=(16&d.flags)}(p)&&Rg(y,p,Xi(),p.classesWithoutHost,!0),null!=p.stylesWithoutHost&&function Ul(d){return 0!=(32&d.flags)}(p)&&Rg(y,p,Xi(),p.stylesWithoutHost,!1)}function em(d,p,y,I){Ig(d,p,y,I),wg()}function Dg(d,p,y){const I=Xi(),O=Ho(),F=d+20,$=O.firstCreatePass?function _T(d,p,y,I,O){const F=p.consts,$=er(F,I),st=Ph(p,d,8,"ng-container",$);return null!==$&&Hd(st,$,!0),Hh(p,y,st,er(F,O)),null!==p.queries&&p.queries.elementStart(p,st),st}(F,O,I,p,y):O.data[F];Qt($,!0);const st=I[F]=I[11].createComment("");cn(O,I,st,$),ha(st,I),Wr($)&&(Ed(O,I,$),ed(O,$,I)),null!=y&&Ld(I,$)}function Mg(){let d=z();const p=Ho();Te()?Ye():(d=d.parent,Qt(d,!1)),p.firstCreatePass&&(Ss(p,d),uo(d)&&p.queries.elementEnd(d))}function im(d,p,y){Dg(d,p,y),Mg()}function nm(){return Xi()}function Og(d){return!!d&&"function"==typeof d.then}function om(d){return!!d&&"function"==typeof d.subscribe}const rm=om;function Ag(d,p,y,I){const O=Xi(),F=Ho(),$=z();return sm(F,O,O[11],$,d,p,!!y,I),Ag}function kg(d,p){const y=z(),I=Xi(),O=Ho();return sm(O,I,nf(Ls(O.data),y,I),y,d,p,!1),kg}function sm(d,p,y,I,O,F,$,st){const Tt=Wr(I),ue=d.firstCreatePass&&ef(d),Pe=p[8],ni=tf(p);let Ci=!0;if(3&I.type||st){const Ln=Ot(I,p),io=st?st(Ln):Ln,on=ni.length,So=st?Ir=>st(kt(Ir[I.index])):I.index;if(No(y)){let Ir=null;if(!st&&Tt&&(Ir=function mT(d,p,y,I){const O=d.cleanup;if(null!=O)for(let F=0;F<O.length-1;F+=2){const $=O[F];if($===y&&O[F+1]===I){const st=p[7],Tt=O[F+2];return st.length>Tt?st[Tt]:null}"string"==typeof $&&(F+=2)}return null}(d,p,O,I.index)),null!==Ir)(Ir.__ngLastListenerFn__||Ir).__ngNextListenerFn__=F,Ir.__ngLastListenerFn__=F,Ci=!1;else{F=xg(I,p,Pe,F,!1);const bs=y.listen(io,O,F);ni.push(F,bs),ue&&ue.push(O,So,on,on+1)}}else F=xg(I,p,Pe,F,!0),io.addEventListener(O,F,$),ni.push(F),ue&&ue.push(O,So,on,$)}else F=xg(I,p,Pe,F,!1);const Ji=I.outputs;let En;if(Ci&&null!==Ji&&(En=Ji[O])){const Ln=En.length;if(Ln)for(let io=0;io<Ln;io+=2){const Eu=p[En[io]][En[io+1]].subscribe(F),Rd=ni.length;ni.push(F,Eu),ue&&ue.push(O,I.index,Rd,-(Rd+1))}}}function am(d,p,y,I){try{return!1!==y(I)}catch(O){return rf(d,O),!1}}function xg(d,p,y,I,O){return function F($){if($===Function)return I;const st=2&d.flags?Hn(d.index,p):p;0==(32&p[2])&&fp(st);let Tt=am(p,0,I,$),jt=F.__ngNextListenerFn__;for(;jt;)Tt=am(p,0,jt,$)&&Tt,jt=jt.__ngNextListenerFn__;return O&&!1===Tt&&($.preventDefault(),$.returnValue=!1),Tt}}function lm(d=1){return function Sn(d){return(Jn.lFrame.contextLView=function Xn(d,p){for(;d>0;)p=p[15],d--;return p}(d,Jn.lFrame.contextLView))[8]}(d)}function vT(d,p){let y=null;const I=function Ha(d){const p=d.attrs;if(null!=p){const y=p.indexOf(5);if(0==(1&y))return p[y+1]}return null}(d);for(let O=0;O<p.length;O++){const F=p[O];if("*"!==F){if(null===I?Id(d,F,!0):jh(I,F))return O}else y=O}return y}function cm(d){const p=Xi()[16][6];if(!p.projection){const I=p.projection=Ec(d?d.length:1,null),O=I.slice();let F=p.child;for(;null!==F;){const $=d?vT(F,d):0;null!==$&&(O[$]?O[$].projectionNext=F:I[$]=F,O[$]=F),F=F.next}}}function um(d,p=0,y){const I=Xi(),O=Ho(),F=Ph(O,20+d,16,null,y||null);null===F.projection&&(F.projection=p),Ye(),64!=(64&F.flags)&&function re(d,p,y){qr(p[11],0,p,y,it(d,y,p),oi(y.parent||p[6],y,p))}(O,I,F)}function Lg(d,p,y){return Ng(d,"",p,"",y),Lg}function Ng(d,p,y,I,O){const F=Xi(),$=Cn(F,p,y,I);return $!==wo&&_o(Ho(),Eo(),F,d,$,F[11],O,!1),Ng}function ym(d,p,y,I,O){const F=d[y+1],$=null===p;let st=I?Nc(F):vu(F),Tt=!1;for(;0!==st&&(!1===Tt||$);){const ue=d[st+1];bT(d[st],p)&&(Tt=!0,d[st+1]=I?Kh(ue):ad(ue)),st=I?Nc(ue):vu(ue)}Tt&&(d[y+1]=I?ad(F):Kh(F))}function bT(d,p){return null===d||null==p||(Array.isArray(d)?d[1]:d)===p||!(!Array.isArray(d)||"string"!=typeof p)&&ic(d,p)>=0}const Hl={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Tm(d){return d.substring(Hl.key,Hl.keyEnd)}function bm(d,p){const y=Hl.textEnd;return y===p?-1:(p=Hl.keyEnd=function RT(d,p,y){for(;p<y&&d.charCodeAt(p)>32;)p++;return p}(d,Hl.key=p,y),jd(d,p,y))}function jd(d,p,y){for(;p<y&&d.charCodeAt(p)<=32;)p++;return p}function Pg(d,p,y){return Zu(d,p,y,!1),Pg}function Fg(d,p){return Zu(d,p,null,!0),Fg}function bh(d,p){for(let y=function CT(d){return function Cm(d){Hl.key=0,Hl.keyEnd=0,Hl.value=0,Hl.valueEnd=0,Hl.textEnd=d.length}(d),bm(d,jd(d,0,Hl.textEnd))}(p);y>=0;y=bm(p,y))Is(d,Tm(p),!0)}function Zu(d,p,y,I){const O=Xi(),F=Ho(),$=jn(2);F.firstUpdatePass&&wm(F,d,$,I),p!==wo&&Hi(O,$,p)&&Mm(F,F.data[Nn()],O,O[11],d,O[$+1]=function PT(d,p){return null==d||("string"==typeof p?d+=p:"object"==typeof d&&(d=a(te(d)))),d}(p,y),I,$)}function Im(d,p){return p>=d.expandoStartIndex}function wm(d,p,y,I){const O=d.data;if(null===O[y+1]){const F=O[Nn()],$=Im(d,y);Am(F,I)&&null===p&&!$&&(p=!1),p=function OT(d,p,y,I){const O=Ls(d);let F=I?p.residualClasses:p.residualStyles;if(null===O)0===(I?p.classBindings:p.styleBindings)&&(y=Ip(y=Bg(null,d,p,y,I),p.attrs,I),F=null);else{const $=p.directiveStylingLast;if(-1===$||d[$]!==O)if(y=Bg(O,d,p,y,I),null===F){let Tt=function AT(d,p,y){const I=y?p.classBindings:p.styleBindings;if(0!==vu(I))return d[Nc(I)]}(d,p,I);void 0!==Tt&&Array.isArray(Tt)&&(Tt=Bg(null,d,p,Tt[1],I),Tt=Ip(Tt,p.attrs,I),function kT(d,p,y,I){d[Nc(y?p.classBindings:p.styleBindings)]=I}(d,p,I,Tt))}else F=function xT(d,p,y){let I;const O=p.directiveEnd;for(let F=1+p.directiveStylingLast;F<O;F++)I=Ip(I,d[F].hostAttrs,y);return Ip(I,p.attrs,y)}(d,p,I)}return void 0!==F&&(I?p.residualClasses=F:p.residualStyles=F),y}(O,F,p,I),function yT(d,p,y,I,O,F){let $=F?p.classBindings:p.styleBindings,st=Nc($),Tt=vu($);d[I]=y;let ue,jt=!1;if(Array.isArray(y)){const Pe=y;ue=Pe[1],(null===ue||ic(Pe,ue)>0)&&(jt=!0)}else ue=y;if(O)if(0!==Tt){const ni=Nc(d[st+1]);d[I+1]=Xh(ni,st),0!==ni&&(d[ni+1]=ld(d[ni+1],I)),d[st+1]=function tp(d,p){return 131071&d|p<<17}(d[st+1],I)}else d[I+1]=Xh(st,0),0!==st&&(d[st+1]=ld(d[st+1],I)),st=I;else d[I+1]=Xh(Tt,0),0===st?st=I:d[Tt+1]=ld(d[Tt+1],I),Tt=I;jt&&(d[I+1]=ad(d[I+1])),ym(d,ue,I,!0),ym(d,ue,I,!1),function TT(d,p,y,I,O){const F=O?d.residualClasses:d.residualStyles;null!=F&&"string"==typeof p&&ic(F,p)>=0&&(y[I+1]=Kh(y[I+1]))}(p,ue,d,I,F),$=Xh(st,Tt),F?p.classBindings=$:p.styleBindings=$}(O,F,p,y,$,I)}}function Bg(d,p,y,I,O){let F=null;const $=y.directiveEnd;let st=y.directiveStylingLast;for(-1===st?st=y.directiveStart:st++;st<$&&(F=p[st],I=Ip(I,F.hostAttrs,O),F!==d);)st++;return null!==d&&(y.directiveStylingLast=st),I}function Ip(d,p,y){const I=y?1:2;let O=-1;if(null!==p)for(let F=0;F<p.length;F++){const $=p[F];"number"==typeof $?O=$:O===I&&(Array.isArray(d)||(d=void 0===d?[]:["",d]),Is(d,$,!!y||p[++F]))}return void 0===d?null:d}function Mm(d,p,y,I,O,F,$,st){if(!(3&p.type))return;const Tt=d.data,jt=Tt[st+1];Cf(function cd(d){return 1==(1&d)}(jt)?Om(Tt,p,y,O,vu(jt),$):void 0)||(Cf(F)||function wd(d){return 2==(2&d)}(jt)&&(F=Om(Tt,null,y,O,st,$)),function cs(d,p,y,I,O){const F=No(d);if(p)O?F?d.addClass(y,I):y.classList.add(I):F?d.removeClass(y,I):y.classList.remove(I);else{let $=-1===I.indexOf("-")?void 0:St.DashCase;if(null==O)F?d.removeStyle(y,I,$):y.style.removeProperty(I);else{const st="string"==typeof O&&O.endsWith("!important");st&&(O=O.slice(0,-10),$|=St.Important),F?d.setStyle(y,I,O,$):y.style.setProperty(I,O,st?"important":"")}}}(I,$,j(Nn(),y),O,F))}function Om(d,p,y,I,O,F){const $=null===p;let st;for(;O>0;){const Tt=d[O],jt=Array.isArray(Tt),ue=jt?Tt[1]:Tt,Pe=null===ue;let ni=y[O+1];ni===wo&&(ni=Pe?Fi:void 0);let Ci=Pe?Qa(ni,I):ue===I?ni:void 0;if(jt&&!Cf(Ci)&&(Ci=Qa(Tt,I)),Cf(Ci)&&(st=Ci,$))return st;const Ji=d[O+1];O=$?Nc(Ji):vu(Ji)}if(null!==p){let Tt=F?p.residualClasses:p.residualStyles;null!=Tt&&(st=Qa(Tt,I))}return st}function Cf(d){return void 0!==d}function Am(d,p){return 0!=(d.flags&(p?16:32))}function km(d,p=""){const y=Xi(),I=Ho(),O=d+20,F=I.firstCreatePass?Ph(I,O,1,p,null):I.data[O],$=y[O]=function Mn(d,p){return No(d)?d.createText(p):d.createTextNode(p)}(y[11],p);cn(I,y,$,F),Qt(F,!1)}function Hg(d){return Sf("",d,""),Hg}function Sf(d,p,y){const I=Xi(),O=Cn(I,d,p,y);return O!==wo&&Ju(I,Nn(),O),Sf}function Ug(d,p,y,I,O){const F=Xi(),$=function Qi(d,p,y,I,O,F){const st=Wi(d,$n(),y,O);return jn(2),st?p+wt(y)+I+wt(O)+F:wo}(F,d,p,y,I,O);return $!==wo&&Ju(F,Nn(),$),Ug}function Vg(d,p,y,I,O,F,$){const st=Xi(),Tt=Vn(st,d,p,y,I,O,F,$);return Tt!==wo&&Ju(st,Nn(),Tt),Vg}function Hm(d,p,y){!function Qu(d,p,y,I){const O=Ho(),F=jn(2);O.firstUpdatePass&&wm(O,null,F,I);const $=Xi();if(y!==wo&&Hi($,F,y)){const st=O.data[Nn()];if(Am(st,I)&&!Im(O,F)){let Tt=I?st.classesWithoutHost:st.stylesWithoutHost;null!==Tt&&(y=h(Tt,y||"")),Rg(O,st,$,y,I)}else!function NT(d,p,y,I,O,F,$,st){O===wo&&(O=Fi);let Tt=0,jt=0,ue=0<O.length?O[0]:null,Pe=0<F.length?F[0]:null;for(;null!==ue||null!==Pe;){const ni=Tt<O.length?O[Tt+1]:void 0,Ci=jt<F.length?F[jt+1]:void 0;let En,Ji=null;ue===Pe?(Tt+=2,jt+=2,ni!==Ci&&(Ji=Pe,En=Ci)):null===Pe||null!==ue&&ue<Pe?(Tt+=2,Ji=ue):(jt+=2,Ji=Pe,En=Ci),null!==Ji&&Mm(d,p,y,I,Ji,En,$,st),ue=Tt<O.length?O[Tt]:null,Pe=jt<F.length?F[jt]:null}}(O,st,$,$[11],$[F+1],$[F+1]=function LT(d,p,y){if(null==y||""===y)return Fi;const I=[],O=te(y);if(Array.isArray(O))for(let F=0;F<O.length;F++)d(I,O[F],!0);else if("object"==typeof O)for(const F in O)O.hasOwnProperty(F)&&d(I,F,O[F]);else"string"==typeof O&&p(I,O);return I}(d,p,y),I,F)}}(Is,bh,Cn(Xi(),d,p,y),!0)}function Gg(d,p,y){const I=Xi();return Hi(I,Un(),p)&&_o(Ho(),Eo(),I,d,p,I[11],y,!0),Gg}function Wg(d,p,y){const I=Xi();if(Hi(I,Un(),p)){const F=Ho(),$=Eo();_o(F,$,I,d,p,nf(Ls(F.data),$,I),y,!0)}return Wg}const Cd=void 0;var eb=["en",[["a","p"],["AM","PM"],Cd],[["AM","PM"],Cd,Cd],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Cd,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Cd,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Cd,"{1} 'at' {0}",Cd],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function tb(d){const y=Math.floor(Math.abs(d)),I=d.toString().replace(/^[^.]*\.?/,"").length;return 1===y&&0===I?1:5}];let Yd={};function zg(d){const p=function ib(d){return d.toLowerCase().replace(/_/g,"-")}(d);let y=$m(p);if(y)return y;const I=p.split("-")[0];if(y=$m(I),y)return y;if("en"===I)return eb;throw new Error(`Missing locale data for the locale "${d}".`)}function Jm(d){return zg(d)[Io.PluralCase]}function $m(d){return d in Yd||(Yd[d]=ge.ng&&ge.ng.common&&ge.ng.common.locales&&ge.ng.common.locales[d]),Yd[d]}var Io=(()=>((Io=Io||{})[Io.LocaleId=0]="LocaleId",Io[Io.DayPeriodsFormat=1]="DayPeriodsFormat",Io[Io.DayPeriodsStandalone=2]="DayPeriodsStandalone",Io[Io.DaysFormat=3]="DaysFormat",Io[Io.DaysStandalone=4]="DaysStandalone",Io[Io.MonthsFormat=5]="MonthsFormat",Io[Io.MonthsStandalone=6]="MonthsStandalone",Io[Io.Eras=7]="Eras",Io[Io.FirstDayOfWeek=8]="FirstDayOfWeek",Io[Io.WeekendRange=9]="WeekendRange",Io[Io.DateFormat=10]="DateFormat",Io[Io.TimeFormat=11]="TimeFormat",Io[Io.DateTimeFormat=12]="DateTimeFormat",Io[Io.NumberSymbols=13]="NumberSymbols",Io[Io.NumberFormats=14]="NumberFormats",Io[Io.CurrencyCode=15]="CurrencyCode",Io[Io.CurrencySymbol=16]="CurrencySymbol",Io[Io.CurrencyName=17]="CurrencyName",Io[Io.Currencies=18]="Currencies",Io[Io.Directionality=19]="Directionality",Io[Io.PluralCase=20]="PluralCase",Io[Io.ExtraData=21]="ExtraData",Io))();const Rf="en-US";let Zm=Rf;function Xg(d,p,y,I,O){if(d=W(d),Array.isArray(d))for(let F=0;F<d.length;F++)Xg(d[F],p,y,I,O);else{const F=Ho(),$=Xi();let st=Vh(d)?d:W(d.provide),Tt=hf(d);const jt=z(),ue=1048575&jt.providerIndexes,Pe=jt.directiveStart,ni=jt.providerIndexes>>20;if(Vh(d)||!d.multi){const Ci=new Zr(Tt,O,Rp),Ji=Jg(st,p,O?ue:ue+ni,Pe);-1===Ji?(Ve(q(jt,$),F,st),Kg(F,d,p.length),p.push(st),jt.directiveStart++,jt.directiveEnd++,O&&(jt.providerIndexes+=1048576),y.push(Ci),$.push(Ci)):(y[Ji]=Ci,$[Ji]=Ci)}else{const Ci=Jg(st,p,ue+ni,Pe),Ji=Jg(st,p,ue,ue+ni),En=Ci>=0&&y[Ci],Ln=Ji>=0&&y[Ji];if(O&&!Ln||!O&&!En){Ve(q(jt,$),F,st);const io=function tE(d,p,y,I,O){const F=new Zr(d,y,Rp);return F.multi=[],F.index=p,F.componentProviders=0,bv(F,O,I&&!y),F}(O?qb:Qb,y.length,O,I,Tt);!O&&Ln&&(y[Ji].providerFactory=io),Kg(F,d,p.length,0),p.push(st),jt.directiveStart++,jt.directiveEnd++,O&&(jt.providerIndexes+=1048576),y.push(io),$.push(io)}else Kg(F,d,Ci>-1?Ci:Ji,bv(y[O?Ji:Ci],Tt,!O&&I));!O&&I&&Ln&&y[Ji].componentProviders++}}}function Kg(d,p,y,I){const O=Vh(p),F=function ug(d){return!!d.useClass}(p);if(O||F){const Tt=(F?W(p.useClass):p).prototype.ngOnDestroy;if(Tt){const jt=d.destroyHooks||(d.destroyHooks=[]);if(!O&&p.multi){const ue=jt.indexOf(y);-1===ue?jt.push(y,[I,Tt]):jt[ue+1].push(I,Tt)}else jt.push(y,Tt)}}}function bv(d,p,y){return y&&d.componentProviders++,d.multi.push(p)-1}function Jg(d,p,y,I){for(let O=y;O<I;O++)if(p[O]===d)return O;return-1}function Qb(d,p,y,I){return $g(this.multi,[])}function qb(d,p,y,I){const O=this.multi;let F;if(this.providerFactory){const $=this.providerFactory.componentProviders,st=Us(y,y[1],this.providerFactory.index,I);F=st.slice(0,$),$g(O,F);for(let Tt=$;Tt<st.length;Tt++)F.push(st[Tt])}else F=[],$g(O,F);return F}function $g(d,p){for(let y=0;y<d.length;y++)p.push((0,d[y])());return p}function Ev(d,p=[]){return y=>{y.providersResolver=(I,O)=>function Zb(d,p,y){const I=Ho();if(I.firstCreatePass){const O=sr(d);Xg(y,I.data,I.blueprint,O,!0),Xg(p,I.data,I.blueprint,O,!1)}}(I,O?O(d):d,p)}}class Cv{}class nE{resolveComponentFactory(p){throw function iE(d){const p=Error(`No component factory found for ${a(d)}. Did you add it to @NgModule.entryComponents?`);return p.ngComponent=d,p}(p)}}let Ap=(()=>{class d{}return d.NULL=new nE,d})();function oE(){return Kd(z(),Xi())}function Kd(d,p){return new kp(Ot(d,p))}let kp=(()=>{class d{constructor(y){this.nativeElement=y}}return d.__NG_ELEMENT_ID__=oE,d})();function rE(d){return d instanceof kp?d.nativeElement:d}class Rv{}let sE=(()=>{class d{}return d.__NG_ELEMENT_ID__=()=>function lE(){const d=Xi(),y=Hn(z().index,d);return function aE(d){return d[11]}(rr(y)?y:d)}(),d})(),cE=(()=>{class d{}return d.\u0275prov=Me({token:d,providedIn:"root",factory:()=>null}),d})();class Iv{constructor(p){this.full=p,this.major=p.split(".")[0],this.minor=p.split(".")[1],this.patch=p.split(".").slice(2).join(".")}}const uE=new Iv("13.1.0"),Zg={};function Of(d,p,y,I,O=!1){for(;null!==y;){const F=p[y.index];if(null!==F&&I.push(kt(F)),Or(F))for(let st=10;st<F.length;st++){const Tt=F[st],jt=Tt[1].firstChild;null!==jt&&Of(Tt[1],Tt,jt,I)}const $=y.type;if(8&$)Of(d,p,y.child,I);else if(32&$){const st=$t(y,p);let Tt;for(;Tt=st();)I.push(Tt)}else if(16&$){const st=en(p,y);if(Array.isArray(st))I.push(...st);else{const Tt=pi(p[16]);Of(Tt[1],Tt,st,I,!0)}}y=O?y.projectionNext:y.next}return I}class xp{constructor(p,y){this._lView=p,this._cdRefInjectingView=y,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const p=this._lView,y=p[1];return Of(y,p,y.firstChild,[])}get context(){return this._lView[8]}set context(p){this._lView[8]=p}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const p=this._lView[3];if(Or(p)){const y=p[8],I=y?y.indexOf(this):-1;I>-1&&(as(p,I),La(y,I))}this._attachedToViewContainer=!1}ls(this._lView[1],this._lView)}onDestroy(p){Ke(this._lView[1],this._lView,null,p)}markForCheck(){fp(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){_p(this._lView[1],this._lView,this.context)}checkNoChanges(){!function ig(d,p,y){hn(!0);try{_p(d,p,y)}finally{hn(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Vr(d,p){gr(d,p,p[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(p){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=p}}class hE extends xp{constructor(p){super(p),this._view=p}detectChanges(){Qp(this._view)}checkNoChanges(){!function qp(d){hn(!0);try{Qp(d)}finally{hn(!1)}}(this._view)}get context(){return null}}class wv extends Ap{constructor(p){super(),this.ngModule=p}resolveComponentFactory(p){const y=Oi(p);return new Qg(y,this.ngModule)}}function Dv(d){const p=[];for(let y in d)d.hasOwnProperty(y)&&p.push({propName:d[y],templateName:y});return p}const pE=new Tr("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>ph});class Qg extends Cv{constructor(p,y){super(),this.componentDef=p,this.ngModule=y,this.componentType=p.type,this.selector=function Hp(d){return d.map(Yh).join(",")}(p.selectors),this.ngContentSelectors=p.ngContentSelectors?p.ngContentSelectors:[],this.isBoundToModule=!!y}get inputs(){return Dv(this.componentDef.inputs)}get outputs(){return Dv(this.componentDef.outputs)}create(p,y,I,O){const F=(O=O||this.ngModule)?function fE(d,p){return{get:(y,I,O)=>{const F=d.get(y,Zg,O);return F!==Zg||I===Zg?F:p.get(y,I,O)}}}(p,O.injector):p,$=F.get(Rv,Pn),st=F.get(cE,null),Tt=$.createRenderer(null,this.componentDef),jt=this.componentDef.selectors[0][0]||"div",ue=I?function Nt(d,p,y){if(No(d))return d.selectRootElement(p,y===vi.ShadowDom);let I="string"==typeof p?d.querySelector(p):p;return I.textContent="",I}(Tt,I,this.componentDef.encapsulation):Ro($.createRenderer(null,this.componentDef),jt,function dE(d){const p=d.toLowerCase();return"svg"===p?Oa:"math"===p?"http://www.w3.org/1998/MathML/":null}(jt)),Pe=this.componentDef.onPush?576:528,ni=function vc(d,p){return{components:[],scheduler:d||ph,clean:vp,playerHandler:p||null,flags:0}}(),Ci=G(0,null,null,1,0,null,null,null,null,null),Ji=Nh(null,Ci,ni,Pe,null,null,$,Tt,st,F);let En,Ln;Zs(Ji);try{const io=function yf(d,p,y,I,O,F){const $=y[1];y[20]=d;const Tt=Ph($,20,2,"#host",null),jt=Tt.mergedAttrs=p.hostAttrs;null!==jt&&(Hd(Tt,jt,!0),null!==d&&(gl(O,d,jt),null!==Tt.classes&&jo(O,d,Tt.classes),null!==Tt.styles&&Ms(O,d,Tt.styles)));const ue=I.createRenderer(d,p),Pe=Nh(y,N(p),null,p.onPush?64:16,y[20],Tt,I,ue,F||null,null);return $.firstCreatePass&&(Ve(q(Tt,y),$,p.type),Uh($,Tt),Jp(Tt,y.length,1)),Bd(y,Pe),y[20]=Pe}(ue,this.componentDef,Ji,$,Tt);if(ue)if(I)gl(Tt,ue,["ng-version",uE.full]);else{const{attrs:on,classes:So}=function Up(d){const p=[],y=[];let I=1,O=2;for(;I<d.length;){let F=d[I];if("string"==typeof F)2===O?""!==F&&p.push(F,d[++I]):8===O&&y.push(F);else{if(!Jl(O))break;O=F}I++}return{attrs:p,classes:y}}(this.componentDef.selectors[0]);on&&gl(Tt,ue,on),So&&So.length>0&&jo(Tt,ue,So.join(" "))}if(Ln=bi(Ci,20),void 0!==y){const on=Ln.projection=[];for(let So=0;So<this.ngContentSelectors.length;So++){const Ir=y[So];on.push(null!=Ir?Array.from(Ir):null)}}En=function Tf(d,p,y,I,O){const F=y[1],$=function Yp(d,p,y){const I=z();d.firstCreatePass&&(y.providersResolver&&y.providersResolver(y),$p(d,I,p,Fh(d,p,1,null),y));const O=Us(p,d,I.directiveStart,I);ha(O,p);const F=Ot(I,p);return F&&ha(F,p),O}(F,y,p);if(I.components.push($),d[8]=$,O&&O.forEach(Tt=>Tt($,p)),p.contentQueries){const Tt=z();p.contentQueries(1,$,Tt.directiveStart)}const st=z();return!F.firstCreatePass||null===p.hostBindings&&null===p.hostAttrs||(bo(st.index),Pd(y[1],st,0,st.directiveStart,st.directiveEnd,p),Kp(p,$)),$}(io,this.componentDef,Ji,ni,[yg]),td(Ci,Ji,null)}finally{ps()}return new _E(this.componentType,En,Kd(Ln,Ji),Ji,Ln)}}class _E extends class eE{}{constructor(p,y,I,O,F){super(),this.location=I,this._rootLView=O,this._tNode=F,this.instance=y,this.hostView=this.changeDetectorRef=new hE(O),this.componentType=p}get injector(){return new os(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(p){this.hostView.onDestroy(p)}}class Jd{}class Mv{}const $d=new Map;class kv extends Jd{constructor(p,y){super(),this._parent=y,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new wv(this);const I=so(p);this._bootstrapComponents=M(I.bootstrap),this._r3Injector=uf(p,y,[{provide:Jd,useValue:this},{provide:Ap,useValue:this.componentFactoryResolver}],a(p)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(p)}get(p,y=iu.THROW_IF_NOT_FOUND,I=ee.Default){return p===iu||p===Jd||p===yp?this:this._r3Injector.get(p,y,I)}destroy(){const p=this._r3Injector;!p.destroyed&&p.destroy(),this.destroyCbs.forEach(y=>y()),this.destroyCbs=null}onDestroy(p){this.destroyCbs.push(p)}}class qg extends Mv{constructor(p){super(),this.moduleType=p,null!==so(p)&&function vE(d){const p=new Set;!function y(I){const O=so(I,!0),F=O.id;null!==F&&(function Ov(d,p,y){if(p&&p!==y)throw new Error(`Duplicate module registered for ${d} - ${a(p)} vs ${a(p.name)}`)}(F,$d.get(F),I),$d.set(F,I));const $=M(O.imports);for(const st of $)p.has(st)||(p.add(st),y(st))}(d)}(p)}create(p){return new kv(this.moduleType,p)}}function xv(d,p,y){const I=Tn()+d,O=Xi();return O[I]===wo?Ei(O,I,y?p.call(y):p()):function an(d,p){return d[p]}(O,I)}function Lv(d,p,y,I){return Pv(Xi(),Tn(),d,p,y,I)}function Nv(d,p,y,I,O){return function Fv(d,p,y,I,O,F,$){const st=p+y;return Wi(d,st,O,F)?Ei(d,st+2,$?I.call($,O,F):I(O,F)):Lp(d,st+2)}(Xi(),Tn(),d,p,y,I,O)}function Lp(d,p){const y=d[p];return y===wo?void 0:y}function Pv(d,p,y,I,O,F){const $=p+y;return Hi(d,$,O)?Ei(d,$+1,F?I.call(F,O):I(O)):Lp(d,$+1)}function Vv(d,p){const y=Ho();let I;const O=d+20;y.firstCreatePass?(I=function IE(d,p){if(p)for(let y=p.length-1;y>=0;y--){const I=p[y];if(d===I.name)return I}}(p,y.pipeRegistry),y.data[O]=I,I.onDestroy&&(y.destroyHooks||(y.destroyHooks=[])).push(O,I.onDestroy)):I=y.data[O];const F=I.factory||(I.factory=zr(I.type)),$=me(Rp);try{const st=tc(!1),Tt=F();return tc(st),function da(d,p,y,I){y>=d.data.length&&(d.data[y]=null,d.blueprint[y]=null),p[y]=I}(y,Xi(),O,Tt),Tt}finally{me($)}}function Gv(d,p,y){const I=d+20,O=Xi(),F=un(O,I);return function Np(d,p){return d[1].data[p].pure}(O,I)?Pv(O,Tn(),p,F.transform,y,F):F.transform(y)}function t_(d){return p=>{setTimeout(d,void 0,p)}}const Eh=class AE extends C.x{constructor(p=!1){super(),this.__isAsync=p}emit(p){super.next(p)}subscribe(p,y,I){var O,F,$;let st=p,Tt=y||(()=>null),jt=I;if(p&&"object"==typeof p){const Pe=p;st=null===(O=Pe.next)||void 0===O?void 0:O.bind(Pe),Tt=null===(F=Pe.error)||void 0===F?void 0:F.bind(Pe),jt=null===($=Pe.complete)||void 0===$?void 0:$.bind(Pe)}this.__isAsync&&(Tt=t_(Tt),st&&(st=t_(st)),jt&&(jt=t_(jt)));const ue=super.subscribe({next:st,error:Tt,complete:jt});return p instanceof m.w0&&p.add(ue),ue}};function kE(){return this._results[Pt()]()}class Af{constructor(p=!1){this._emitDistinctChangesOnly=p,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const y=Pt(),I=Af.prototype;I[y]||(I[y]=kE)}get changes(){return this._changes||(this._changes=new Eh)}get(p){return this._results[p]}map(p){return this._results.map(p)}filter(p){return this._results.filter(p)}find(p){return this._results.find(p)}reduce(p,y){return this._results.reduce(p,y)}forEach(p){this._results.forEach(p)}some(p){return this._results.some(p)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(p,y){const I=this;I.dirty=!1;const O=Ca(p);(this._changesDetected=!function $a(d,p,y){if(d.length!==p.length)return!1;for(let I=0;I<d.length;I++){let O=d[I],F=p[I];if(y&&(O=y(O),F=y(F)),F!==O)return!1}return!0}(I._results,O,y))&&(I._results=O,I.length=O.length,I.last=O[this.length-1],I.first=O[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Pp=(()=>{class d{}return d.__NG_ELEMENT_ID__=NE,d})();const xE=Pp,LE=class extends xE{constructor(p,y,I){super(),this._declarationLView=p,this._declarationTContainer=y,this.elementRef=I}createEmbeddedView(p){const y=this._declarationTContainer.tViews,I=Nh(this._declarationLView,y,p,16,null,y.declTNode,null,null,null,null);I[17]=this._declarationLView[this._declarationTContainer.index];const F=this._declarationLView[19];return null!==F&&(I[19]=F.createEmbeddedView(y)),td(y,I,p),new xp(I)}};function NE(){return kf(z(),Xi())}function kf(d,p){return 4&d.type?new LE(p,d,Kd(d,p)):null}let xf=(()=>{class d{}return d.__NG_ELEMENT_ID__=PE,d})();function PE(){return jv(z(),Xi())}const FE=xf,Wv=class extends FE{constructor(p,y,I){super(),this._lContainer=p,this._hostTNode=y,this._hostLView=I}get element(){return Kd(this._hostTNode,this._hostLView)}get injector(){return new os(this._hostTNode,this._hostLView)}get parentInjector(){const p=pe(this._hostTNode,this._hostLView);if(qs(p)){const y=Ea(p,this._hostLView),I=xa(p);return new os(y[1].data[I+8],y)}return new os(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(p){const y=zv(this._lContainer);return null!==y&&y[p]||null}get length(){return this._lContainer.length-10}createEmbeddedView(p,y,I){const O=p.createEmbeddedView(y||{});return this.insert(O,I),O}createComponent(p,y,I,O,F){const $=p&&!function ec(d){return"function"==typeof d}(p);let st;if($)st=y;else{const Pe=y||{};st=Pe.index,I=Pe.injector,O=Pe.projectableNodes,F=Pe.ngModuleRef}const Tt=$?p:new Qg(Oi(p)),jt=I||this.parentInjector;if(!F&&null==Tt.ngModule&&jt){const Pe=jt.get(Jd,null);Pe&&(F=Pe)}const ue=Tt.create(jt,O,void 0,F);return this.insert(ue.hostView,st),ue}insert(p,y){const I=p._lView,O=I[1];if(function Fo(d){return Or(d[3])}(I)){const ue=this.indexOf(p);if(-1!==ue)this.detach(ue);else{const Pe=I[3],ni=new Wv(Pe,Pe[6],Pe[3]);ni.detach(ni.indexOf(p))}}const F=this._adjustIndex(y),$=this._lContainer;!function Fa(d,p,y,I){const O=10+I,F=y.length;I>0&&(y[O-1][4]=p),I<F-10?(p[4]=y[O],Za(y,10+I,p)):(y.push(p),p[4]=null),p[3]=y;const $=p[17];null!==$&&y!==$&&function ys(d,p){const y=d[9];p[16]!==p[3][3][16]&&(d[2]=!0),null===y?d[9]=[p]:y.push(p)}($,p);const st=p[19];null!==st&&st.insertView(d),p[2]|=128}(O,I,$,F);const st=go(F,$),Tt=I[11],jt=we(Tt,$[7]);return null!==jt&&function Ds(d,p,y,I,O,F){I[0]=O,I[6]=p,gr(d,I,y,1,O,F)}(O,$[6],Tt,I,jt,st),p.attachToViewContainerRef(),Za(e_($),F,p),p}move(p,y){return this.insert(p,y)}indexOf(p){const y=zv(this._lContainer);return null!==y?y.indexOf(p):-1}remove(p){const y=this._adjustIndex(p,-1),I=as(this._lContainer,y);I&&(La(e_(this._lContainer),y),ls(I[1],I))}detach(p){const y=this._adjustIndex(p,-1),I=as(this._lContainer,y);return I&&null!=La(e_(this._lContainer),y)?new xp(I):null}_adjustIndex(p,y=0){return null==p?this.length+y:p}};function zv(d){return d[8]}function e_(d){return d[8]||(d[8]=[])}function jv(d,p){let y;const I=p[d.index];if(Or(I))y=I;else{let O;if(8&d.type)O=kt(I);else{const F=p[11];O=F.createComment("");const $=Ot(d,p);zt(F,we(F,$),O,function ii(d,p){return No(d)?d.nextSibling(p):p.nextSibling}(F,$),!1)}p[d.index]=y=Zp(I,p,O,d),Bd(p,y)}return new Wv(y,d,p)}class i_{constructor(p){this.queryList=p,this.matches=null}clone(){return new i_(this.queryList)}setDirty(){this.queryList.setDirty()}}class n_{constructor(p=[]){this.queries=p}createEmbeddedView(p){const y=p.queries;if(null!==y){const I=null!==p.contentQueries?p.contentQueries[0]:y.length,O=[];for(let F=0;F<I;F++){const $=y.getByIndex(F);O.push(this.queries[$.indexInDeclarationView].clone())}return new n_(O)}return null}insertView(p){this.dirtyQueriesWithMatches(p)}detachView(p){this.dirtyQueriesWithMatches(p)}dirtyQueriesWithMatches(p){for(let y=0;y<this.queries.length;y++)null!==ty(p,y).matches&&this.queries[y].setDirty()}}class Yv{constructor(p,y,I=null){this.predicate=p,this.flags=y,this.read=I}}class o_{constructor(p=[]){this.queries=p}elementStart(p,y){for(let I=0;I<this.queries.length;I++)this.queries[I].elementStart(p,y)}elementEnd(p){for(let y=0;y<this.queries.length;y++)this.queries[y].elementEnd(p)}embeddedTView(p){let y=null;for(let I=0;I<this.length;I++){const O=null!==y?y.length:0,F=this.getByIndex(I).embeddedTView(p,O);F&&(F.indexInDeclarationView=I,null!==y?y.push(F):y=[F])}return null!==y?new o_(y):null}template(p,y){for(let I=0;I<this.queries.length;I++)this.queries[I].template(p,y)}getByIndex(p){return this.queries[p]}get length(){return this.queries.length}track(p){this.queries.push(p)}}class r_{constructor(p,y=-1){this.metadata=p,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=y}elementStart(p,y){this.isApplyingToNode(y)&&this.matchTNode(p,y)}elementEnd(p){this._declarationNodeIndex===p.index&&(this._appliesToNextNode=!1)}template(p,y){this.elementStart(p,y)}embeddedTView(p,y){return this.isApplyingToNode(p)?(this.crossesNgTemplate=!0,this.addMatch(-p.index,y),new r_(this.metadata)):null}isApplyingToNode(p){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const y=this._declarationNodeIndex;let I=p.parent;for(;null!==I&&8&I.type&&I.index!==y;)I=I.parent;return y===(null!==I?I.index:-1)}return this._appliesToNextNode}matchTNode(p,y){const I=this.metadata.predicate;if(Array.isArray(I))for(let O=0;O<I.length;O++){const F=I[O];this.matchTNodeWithReadOption(p,y,UE(y,F)),this.matchTNodeWithReadOption(p,y,Sl(y,p,F,!1,!1))}else I===Pp?4&y.type&&this.matchTNodeWithReadOption(p,y,-1):this.matchTNodeWithReadOption(p,y,Sl(y,p,I,!1,!1))}matchTNodeWithReadOption(p,y,I){if(null!==I){const O=this.metadata.read;if(null!==O)if(O===kp||O===xf||O===Pp&&4&y.type)this.addMatch(y.index,-2);else{const F=Sl(y,p,O,!1,!1);null!==F&&this.addMatch(y.index,F)}else this.addMatch(y.index,I)}}addMatch(p,y){null===this.matches?this.matches=[p,y]:this.matches.push(p,y)}}function UE(d,p){const y=d.localNames;if(null!==y)for(let I=0;I<y.length;I+=2)if(y[I]===p)return y[I+1];return null}function GE(d,p,y,I){return-1===y?function VE(d,p){return 11&d.type?Kd(d,p):4&d.type?kf(d,p):null}(p,d):-2===y?function WE(d,p,y){return y===kp?Kd(p,d):y===Pp?kf(p,d):y===xf?jv(p,d):void 0}(d,p,I):Us(d,d[1],y,p)}function Xv(d,p,y,I){const O=p[19].queries[I];if(null===O.matches){const F=d.data,$=y.matches,st=[];for(let Tt=0;Tt<$.length;Tt+=2){const jt=$[Tt];st.push(jt<0?null:GE(p,F[jt],$[Tt+1],y.metadata.read))}O.matches=st}return O.matches}function s_(d,p,y,I){const O=d.queries.getByIndex(y),F=O.matches;if(null!==F){const $=Xv(d,p,O,y);for(let st=0;st<F.length;st+=2){const Tt=F[st];if(Tt>0)I.push($[st/2]);else{const jt=F[st+1],ue=p[-Tt];for(let Pe=10;Pe<ue.length;Pe++){const ni=ue[Pe];ni[17]===ni[3]&&s_(ni[1],ni,jt,I)}if(null!==ue[9]){const Pe=ue[9];for(let ni=0;ni<Pe.length;ni++){const Ci=Pe[ni];s_(Ci[1],Ci,jt,I)}}}}}return I}function Kv(d){const p=Xi(),y=Ho(),I=ds();Sr(I+1);const O=ty(y,I);if(d.dirty&&Po(p)===(2==(2&O.metadata.flags))){if(null===O.matches)d.reset([]);else{const F=O.crossesNgTemplate?s_(y,p,I,[]):Xv(y,p,O,I);d.reset(F,rE),d.notifyOnChanges()}return!0}return!1}function Jv(d,p,y){const I=Ho();I.firstCreatePass&&(qv(I,new Yv(d,p,y),-1),2==(2&p)&&(I.staticViewQueries=!0)),Qv(I,Xi(),p)}function $v(d,p,y,I){const O=Ho();if(O.firstCreatePass){const F=z();qv(O,new Yv(p,y,I),F.index),function jE(d,p){const y=d.contentQueries||(d.contentQueries=[]);p!==(y.length?y[y.length-1]:-1)&&y.push(d.queries.length-1,p)}(O,d),2==(2&y)&&(O.staticContentQueries=!0)}Qv(O,Xi(),y)}function Zv(){return function zE(d,p){return d[19].queries[p].queryList}(Xi(),ds())}function Qv(d,p,y){const I=new Af(4==(4&y));Ke(d,p,I,I.destroy),null===p[19]&&(p[19]=new n_),p[19].queries.push(new i_(I))}function qv(d,p,y){null===d.queries&&(d.queries=new o_),d.queries.track(new r_(p,y))}function ty(d,p){return d.queries.getByIndex(p)}function ey(d,p){return kf(d,p)}function Pf(...d){}const d_=new Tr("Application Initializer");let Qd=(()=>{class d{constructor(y){this.appInits=y,this.resolve=Pf,this.reject=Pf,this.initialized=!1,this.done=!1,this.donePromise=new Promise((I,O)=>{this.resolve=I,this.reject=O})}runInitializers(){if(this.initialized)return;const y=[],I=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let O=0;O<this.appInits.length;O++){const F=this.appInits[O]();if(Og(F))y.push(F);else if(rm(F)){const $=new Promise((st,Tt)=>{F.subscribe({complete:st,error:Tt})});y.push($)}}Promise.all(y).then(()=>{I()}).catch(O=>{this.reject(O)}),0===y.length&&I(),this.initialized=!0}}return d.\u0275fac=function(y){return new(y||d)(Yr(d_,8))},d.\u0275prov=Me({token:d,factory:d.\u0275fac}),d})();const vy=new Tr("AppId"),cC={provide:vy,useFactory:function lC(){return`${p_()}${p_()}${p_()}`},deps:[]};function p_(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const yy=new Tr("Platform Initializer"),Ty=new Tr("Platform ID"),by=new Tr("appBootstrapListener");let Ey=(()=>{class d{log(y){console.log(y)}warn(y){console.warn(y)}}return d.\u0275fac=function(y){return new(y||d)},d.\u0275prov=Me({token:d,factory:d.\u0275fac}),d})();const Ff=new Tr("LocaleId"),Cy=new Tr("DefaultCurrencyCode");class uC{constructor(p,y){this.ngModuleFactory=p,this.componentFactories=y}}let f_=(()=>{class d{compileModuleSync(y){return new qg(y)}compileModuleAsync(y){return Promise.resolve(this.compileModuleSync(y))}compileModuleAndAllComponentsSync(y){const I=this.compileModuleSync(y),F=M(so(y).declarations).reduce(($,st)=>{const Tt=Oi(st);return Tt&&$.push(new Qg(Tt)),$},[]);return new uC(I,F)}compileModuleAndAllComponentsAsync(y){return Promise.resolve(this.compileModuleAndAllComponentsSync(y))}clearCache(){}clearCacheFor(y){}getModuleId(y){}}return d.\u0275fac=function(y){return new(y||d)},d.\u0275prov=Me({token:d,factory:d.\u0275fac}),d})();const dC=(()=>Promise.resolve(0))();function g_(d){"undefined"==typeof Zone?dC.then(()=>{d&&d.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",d)}class bu{constructor({enableLongStackTrace:p=!1,shouldCoalesceEventChangeDetection:y=!1,shouldCoalesceRunChangeDetection:I=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Eh(!1),this.onMicrotaskEmpty=new Eh(!1),this.onStable=new Eh(!1),this.onError=new Eh(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const O=this;O._nesting=0,O._outer=O._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(O._inner=O._inner.fork(new Zone.TaskTrackingZoneSpec)),p&&Zone.longStackTraceZoneSpec&&(O._inner=O._inner.fork(Zone.longStackTraceZoneSpec)),O.shouldCoalesceEventChangeDetection=!I&&y,O.shouldCoalesceRunChangeDetection=I,O.lastRequestAnimationFrameId=-1,O.nativeRequestAnimationFrame=function pC(){let d=ge.requestAnimationFrame,p=ge.cancelAnimationFrame;if("undefined"!=typeof Zone&&d&&p){const y=d[Zone.__symbol__("OriginalDelegate")];y&&(d=y);const I=p[Zone.__symbol__("OriginalDelegate")];I&&(p=I)}return{nativeRequestAnimationFrame:d,nativeCancelAnimationFrame:p}}().nativeRequestAnimationFrame,function _C(d){const p=()=>{!function gC(d){d.isCheckStableRunning||-1!==d.lastRequestAnimationFrameId||(d.lastRequestAnimationFrameId=d.nativeRequestAnimationFrame.call(ge,()=>{d.fakeTopEventTask||(d.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{d.lastRequestAnimationFrameId=-1,m_(d),d.isCheckStableRunning=!0,__(d),d.isCheckStableRunning=!1},void 0,()=>{},()=>{})),d.fakeTopEventTask.invoke()}),m_(d))}(d)};d._inner=d._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(y,I,O,F,$,st)=>{try{return Sy(d),y.invokeTask(O,F,$,st)}finally{(d.shouldCoalesceEventChangeDetection&&"eventTask"===F.type||d.shouldCoalesceRunChangeDetection)&&p(),Ry(d)}},onInvoke:(y,I,O,F,$,st,Tt)=>{try{return Sy(d),y.invoke(O,F,$,st,Tt)}finally{d.shouldCoalesceRunChangeDetection&&p(),Ry(d)}},onHasTask:(y,I,O,F)=>{y.hasTask(O,F),I===O&&("microTask"==F.change?(d._hasPendingMicrotasks=F.microTask,m_(d),__(d)):"macroTask"==F.change&&(d.hasPendingMacrotasks=F.macroTask))},onHandleError:(y,I,O,F)=>(y.handleError(O,F),d.runOutsideAngular(()=>d.onError.emit(F)),!1)})}(O)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!bu.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(bu.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(p,y,I){return this._inner.run(p,y,I)}runTask(p,y,I,O){const F=this._inner,$=F.scheduleEventTask("NgZoneEvent: "+O,p,fC,Pf,Pf);try{return F.runTask($,y,I)}finally{F.cancelTask($)}}runGuarded(p,y,I){return this._inner.runGuarded(p,y,I)}runOutsideAngular(p){return this._outer.run(p)}}const fC={};function __(d){if(0==d._nesting&&!d.hasPendingMicrotasks&&!d.isStable)try{d._nesting++,d.onMicrotaskEmpty.emit(null)}finally{if(d._nesting--,!d.hasPendingMicrotasks)try{d.runOutsideAngular(()=>d.onStable.emit(null))}finally{d.isStable=!0}}}function m_(d){d.hasPendingMicrotasks=!!(d._hasPendingMicrotasks||(d.shouldCoalesceEventChangeDetection||d.shouldCoalesceRunChangeDetection)&&-1!==d.lastRequestAnimationFrameId)}function Sy(d){d._nesting++,d.isStable&&(d.isStable=!1,d.onUnstable.emit(null))}function Ry(d){d._nesting--,__(d)}class mC{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Eh,this.onMicrotaskEmpty=new Eh,this.onStable=new Eh,this.onError=new Eh}run(p,y,I){return p.apply(y,I)}runGuarded(p,y,I){return p.apply(y,I)}runOutsideAngular(p){return p()}runTask(p,y,I,O){return p.apply(y,I)}}let Iy=(()=>{class d{constructor(y){this._ngZone=y,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),y.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{bu.assertNotInAngularZone(),g_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())g_(()=>{for(;0!==this._callbacks.length;){let y=this._callbacks.pop();clearTimeout(y.timeoutId),y.doneCb(this._didWork)}this._didWork=!1});else{let y=this.getPendingTasks();this._callbacks=this._callbacks.filter(I=>!I.updateCb||!I.updateCb(y)||(clearTimeout(I.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(y=>({source:y.source,creationLocation:y.creationLocation,data:y.data})):[]}addCallback(y,I,O){let F=-1;I&&I>0&&(F=setTimeout(()=>{this._callbacks=this._callbacks.filter($=>$.timeoutId!==F),y(this._didWork,this.getPendingTasks())},I)),this._callbacks.push({doneCb:y,timeoutId:F,updateCb:O})}whenStable(y,I,O){if(O&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(y,I,O),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(y,I,O){return[]}}return d.\u0275fac=function(y){return new(y||d)(Yr(bu))},d.\u0275prov=Me({token:d,factory:d.\u0275fac}),d})(),wy=(()=>{class d{constructor(){this._applications=new Map,v_.addToWindow(this)}registerApplication(y,I){this._applications.set(y,I)}unregisterApplication(y){this._applications.delete(y)}unregisterAllApplications(){this._applications.clear()}getTestability(y){return this._applications.get(y)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(y,I=!0){return v_.findTestabilityInTree(this,y,I)}}return d.\u0275fac=function(y){return new(y||d)},d.\u0275prov=Me({token:d,factory:d.\u0275fac}),d})();class vC{addToWindow(p){}findTestabilityInTree(p,y,I){return null}}function yC(d){v_=d}let qu,v_=new vC;const Dy=new Tr("AllowMultipleToken");class EC{constructor(p,y){this.name=p,this.token=y}}function My(d,p,y=[]){const I=`Platform: ${p}`,O=new Tr(I);return(F=[])=>{let $=Oy();if(!$||$.injector.get(Dy,!1))if(d)d(y.concat(F).concat({provide:O,useValue:!0}));else{const st=y.concat(F).concat({provide:O,useValue:!0},{provide:Ud,useValue:"platform"});!function CC(d){if(qu&&!qu.destroyed&&!qu.injector.get(Dy,!1))throw new Et("400","");qu=d.get(Ay);const p=d.get(yy,null);p&&p.forEach(y=>y())}(iu.create({providers:st,name:I}))}return function SC(d){const p=Oy();if(!p)throw new Et("401","");return p}()}}function Oy(){return qu&&!qu.destroyed?qu:null}let Ay=(()=>{class d{constructor(y){this._injector=y,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(y,I){const st=function RC(d,p){let y;return y="noop"===d?new mC:("zone.js"===d?void 0:d)||new bu({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==p?void 0:p.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==p?void 0:p.ngZoneRunCoalescing)}),y}(I?I.ngZone:void 0,{ngZoneEventCoalescing:I&&I.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:I&&I.ngZoneRunCoalescing||!1}),Tt=[{provide:bu,useValue:st}];return st.run(()=>{const jt=iu.create({providers:Tt,parent:this.injector,name:y.moduleType.name}),ue=y.create(jt),Pe=ue.injector.get(gc,null);if(!Pe)throw new Et("402","");return st.runOutsideAngular(()=>{const ni=st.onError.subscribe({next:Ci=>{Pe.handleError(Ci)}});ue.onDestroy(()=>{y_(this._modules,ue),ni.unsubscribe()})}),function IC(d,p,y){try{const I=y();return Og(I)?I.catch(O=>{throw p.runOutsideAngular(()=>d.handleError(O)),O}):I}catch(I){throw p.runOutsideAngular(()=>d.handleError(I)),I}}(Pe,st,()=>{const ni=ue.injector.get(Qd);return ni.runInitializers(),ni.donePromise.then(()=>(function sb(d){Ae(d,"Expected localeId to be defined"),"string"==typeof d&&(Zm=d.toLowerCase().replace(/_/g,"-"))}(ue.injector.get(Ff,Rf)||Rf),this._moduleDoBootstrap(ue),ue))})})}bootstrapModule(y,I=[]){const O=ky({},I);return function TC(d,p,y){const I=new qg(y);return Promise.resolve(I)}(0,0,y).then(F=>this.bootstrapModuleFactory(F,O))}_moduleDoBootstrap(y){const I=y.injector.get(Bp);if(y._bootstrapComponents.length>0)y._bootstrapComponents.forEach(O=>I.bootstrap(O));else{if(!y.instance.ngDoBootstrap)throw new Et("403","");y.instance.ngDoBootstrap(I)}this._modules.push(y)}onDestroy(y){this._destroyListeners.push(y)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Et("404","");this._modules.slice().forEach(y=>y.destroy()),this._destroyListeners.forEach(y=>y()),this._destroyed=!0}get destroyed(){return this._destroyed}}return d.\u0275fac=function(y){return new(y||d)(Yr(iu))},d.\u0275prov=Me({token:d,factory:d.\u0275fac}),d})();function ky(d,p){return Array.isArray(p)?p.reduce(ky,d):Object.assign(Object.assign({},d),p)}let Bp=(()=>{class d{constructor(y,I,O,F,$){this._zone=y,this._injector=I,this._exceptionHandler=O,this._componentFactoryResolver=F,this._initStatus=$,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const st=new e.y(jt=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{jt.next(this._stable),jt.complete()})}),Tt=new e.y(jt=>{let ue;this._zone.runOutsideAngular(()=>{ue=this._zone.onStable.subscribe(()=>{bu.assertNotInAngularZone(),g_(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,jt.next(!0))})})});const Pe=this._zone.onUnstable.subscribe(()=>{bu.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{jt.next(!1)}))});return()=>{ue.unsubscribe(),Pe.unsubscribe()}});this.isStable=(0,t.T)(st,Tt.pipe((0,n.B)()))}bootstrap(y,I){if(!this._initStatus.done)throw new Et("405","");let O;O=y instanceof Cv?y:this._componentFactoryResolver.resolveComponentFactory(y),this.componentTypes.push(O.componentType);const F=function bC(d){return d.isBoundToModule}(O)?void 0:this._injector.get(Jd),st=O.create(iu.NULL,[],I||O.selector,F),Tt=st.location.nativeElement,jt=st.injector.get(Iy,null),ue=jt&&st.injector.get(wy);return jt&&ue&&ue.registerApplication(Tt,jt),st.onDestroy(()=>{this.detachView(st.hostView),y_(this.components,st),ue&&ue.unregisterApplication(Tt)}),this._loadComponent(st),st}tick(){if(this._runningTick)throw new Et("101","");try{this._runningTick=!0;for(let y of this._views)y.detectChanges()}catch(y){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(y))}finally{this._runningTick=!1}}attachView(y){const I=y;this._views.push(I),I.attachToAppRef(this)}detachView(y){const I=y;y_(this._views,I),I.detachFromAppRef()}_loadComponent(y){this.attachView(y.hostView),this.tick(),this.components.push(y),this._injector.get(by,[]).concat(this._bootstrapListeners).forEach(O=>O(y))}ngOnDestroy(){this._views.slice().forEach(y=>y.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return d.\u0275fac=function(y){return new(y||d)(Yr(bu),Yr(iu),Yr(gc),Yr(Ap),Yr(Qd))},d.\u0275prov=Me({token:d,factory:d.\u0275fac}),d})();function y_(d,p){const y=d.indexOf(p);y>-1&&d.splice(y,1)}let Ly=!0;function DC(){Ly=!1}let MC=(()=>{class d{}return d.__NG_ELEMENT_ID__=OC,d})();function OC(d){return function AC(d,p,y){if(Os(d)&&!y){const I=Hn(d.index,p);return new xp(I,I)}return 47&d.type?new xp(p[16],p):null}(z(),Xi(),16==(16&d))}class Vy{constructor(){}supports(p){return be(p)}create(p){return new FC(p)}}const PC=(d,p)=>p;class FC{constructor(p){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=p||PC}forEachItem(p){let y;for(y=this._itHead;null!==y;y=y._next)p(y)}forEachOperation(p){let y=this._itHead,I=this._removalsHead,O=0,F=null;for(;y||I;){const $=!I||y&&y.currentIndex<Wy(I,O,F)?y:I,st=Wy($,O,F),Tt=$.currentIndex;if($===I)O--,I=I._nextRemoved;else if(y=y._next,null==$.previousIndex)O++;else{F||(F=[]);const jt=st-O,ue=Tt-O;if(jt!=ue){for(let ni=0;ni<jt;ni++){const Ci=ni<F.length?F[ni]:F[ni]=0,Ji=Ci+ni;ue<=Ji&&Ji<jt&&(F[ni]=Ci+1)}F[$.previousIndex]=ue-jt}}st!==Tt&&p($,st,Tt)}}forEachPreviousItem(p){let y;for(y=this._previousItHead;null!==y;y=y._nextPrevious)p(y)}forEachAddedItem(p){let y;for(y=this._additionsHead;null!==y;y=y._nextAdded)p(y)}forEachMovedItem(p){let y;for(y=this._movesHead;null!==y;y=y._nextMoved)p(y)}forEachRemovedItem(p){let y;for(y=this._removalsHead;null!==y;y=y._nextRemoved)p(y)}forEachIdentityChange(p){let y;for(y=this._identityChangesHead;null!==y;y=y._nextIdentityChange)p(y)}diff(p){if(null==p&&(p=[]),!be(p))throw new Error(`Error trying to diff '${a(p)}'. Only arrays and iterables are allowed`);return this.check(p)?this:null}onDestroy(){}check(p){this._reset();let O,F,$,y=this._itHead,I=!1;if(Array.isArray(p)){this.length=p.length;for(let st=0;st<this.length;st++)F=p[st],$=this._trackByFn(st,F),null!==y&&Object.is(y.trackById,$)?(I&&(y=this._verifyReinsertion(y,F,$,st)),Object.is(y.item,F)||this._addIdentityChange(y,F)):(y=this._mismatch(y,F,$,st),I=!0),y=y._next}else O=0,function Ge(d,p){if(Array.isArray(d))for(let y=0;y<d.length;y++)p(d[y]);else{const y=d[Pt()]();let I;for(;!(I=y.next()).done;)p(I.value)}}(p,st=>{$=this._trackByFn(O,st),null!==y&&Object.is(y.trackById,$)?(I&&(y=this._verifyReinsertion(y,st,$,O)),Object.is(y.item,st)||this._addIdentityChange(y,st)):(y=this._mismatch(y,st,$,O),I=!0),y=y._next,O++}),this.length=O;return this._truncate(y),this.collection=p,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let p;for(p=this._previousItHead=this._itHead;null!==p;p=p._next)p._nextPrevious=p._next;for(p=this._additionsHead;null!==p;p=p._nextAdded)p.previousIndex=p.currentIndex;for(this._additionsHead=this._additionsTail=null,p=this._movesHead;null!==p;p=p._nextMoved)p.previousIndex=p.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(p,y,I,O){let F;return null===p?F=this._itTail:(F=p._prev,this._remove(p)),null!==(p=null===this._unlinkedRecords?null:this._unlinkedRecords.get(I,null))?(Object.is(p.item,y)||this._addIdentityChange(p,y),this._reinsertAfter(p,F,O)):null!==(p=null===this._linkedRecords?null:this._linkedRecords.get(I,O))?(Object.is(p.item,y)||this._addIdentityChange(p,y),this._moveAfter(p,F,O)):p=this._addAfter(new BC(y,I),F,O),p}_verifyReinsertion(p,y,I,O){let F=null===this._unlinkedRecords?null:this._unlinkedRecords.get(I,null);return null!==F?p=this._reinsertAfter(F,p._prev,O):p.currentIndex!=O&&(p.currentIndex=O,this._addToMoves(p,O)),p}_truncate(p){for(;null!==p;){const y=p._next;this._addToRemovals(this._unlink(p)),p=y}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(p,y,I){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(p);const O=p._prevRemoved,F=p._nextRemoved;return null===O?this._removalsHead=F:O._nextRemoved=F,null===F?this._removalsTail=O:F._prevRemoved=O,this._insertAfter(p,y,I),this._addToMoves(p,I),p}_moveAfter(p,y,I){return this._unlink(p),this._insertAfter(p,y,I),this._addToMoves(p,I),p}_addAfter(p,y,I){return this._insertAfter(p,y,I),this._additionsTail=null===this._additionsTail?this._additionsHead=p:this._additionsTail._nextAdded=p,p}_insertAfter(p,y,I){const O=null===y?this._itHead:y._next;return p._next=O,p._prev=y,null===O?this._itTail=p:O._prev=p,null===y?this._itHead=p:y._next=p,null===this._linkedRecords&&(this._linkedRecords=new Gy),this._linkedRecords.put(p),p.currentIndex=I,p}_remove(p){return this._addToRemovals(this._unlink(p))}_unlink(p){null!==this._linkedRecords&&this._linkedRecords.remove(p);const y=p._prev,I=p._next;return null===y?this._itHead=I:y._next=I,null===I?this._itTail=y:I._prev=y,p}_addToMoves(p,y){return p.previousIndex===y||(this._movesTail=null===this._movesTail?this._movesHead=p:this._movesTail._nextMoved=p),p}_addToRemovals(p){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Gy),this._unlinkedRecords.put(p),p.currentIndex=null,p._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=p,p._prevRemoved=null):(p._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=p),p}_addIdentityChange(p,y){return p.item=y,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=p:this._identityChangesTail._nextIdentityChange=p,p}}class BC{constructor(p,y){this.item=p,this.trackById=y,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class HC{constructor(){this._head=null,this._tail=null}add(p){null===this._head?(this._head=this._tail=p,p._nextDup=null,p._prevDup=null):(this._tail._nextDup=p,p._prevDup=this._tail,p._nextDup=null,this._tail=p)}get(p,y){let I;for(I=this._head;null!==I;I=I._nextDup)if((null===y||y<=I.currentIndex)&&Object.is(I.trackById,p))return I;return null}remove(p){const y=p._prevDup,I=p._nextDup;return null===y?this._head=I:y._nextDup=I,null===I?this._tail=y:I._prevDup=y,null===this._head}}class Gy{constructor(){this.map=new Map}put(p){const y=p.trackById;let I=this.map.get(y);I||(I=new HC,this.map.set(y,I)),I.add(p)}get(p,y){const O=this.map.get(p);return O?O.get(p,y):null}remove(p){const y=p.trackById;return this.map.get(y).remove(p)&&this.map.delete(y),p}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Wy(d,p,y){const I=d.previousIndex;if(null===I)return I;let O=0;return y&&I<y.length&&(O=y[I]),I+p+O}class zy{constructor(){}supports(p){return p instanceof Map||Xe(p)}create(){return new UC}}class UC{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(p){let y;for(y=this._mapHead;null!==y;y=y._next)p(y)}forEachPreviousItem(p){let y;for(y=this._previousMapHead;null!==y;y=y._nextPrevious)p(y)}forEachChangedItem(p){let y;for(y=this._changesHead;null!==y;y=y._nextChanged)p(y)}forEachAddedItem(p){let y;for(y=this._additionsHead;null!==y;y=y._nextAdded)p(y)}forEachRemovedItem(p){let y;for(y=this._removalsHead;null!==y;y=y._nextRemoved)p(y)}diff(p){if(p){if(!(p instanceof Map||Xe(p)))throw new Error(`Error trying to diff '${a(p)}'. Only maps and objects are allowed`)}else p=new Map;return this.check(p)?this:null}onDestroy(){}check(p){this._reset();let y=this._mapHead;if(this._appendAfter=null,this._forEach(p,(I,O)=>{if(y&&y.key===O)this._maybeAddToChanges(y,I),this._appendAfter=y,y=y._next;else{const F=this._getOrCreateRecordForKey(O,I);y=this._insertBeforeOrAppend(y,F)}}),y){y._prev&&(y._prev._next=null),this._removalsHead=y;for(let I=y;null!==I;I=I._nextRemoved)I===this._mapHead&&(this._mapHead=null),this._records.delete(I.key),I._nextRemoved=I._next,I.previousValue=I.currentValue,I.currentValue=null,I._prev=null,I._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(p,y){if(p){const I=p._prev;return y._next=p,y._prev=I,p._prev=y,I&&(I._next=y),p===this._mapHead&&(this._mapHead=y),this._appendAfter=p,p}return this._appendAfter?(this._appendAfter._next=y,y._prev=this._appendAfter):this._mapHead=y,this._appendAfter=y,null}_getOrCreateRecordForKey(p,y){if(this._records.has(p)){const O=this._records.get(p);this._maybeAddToChanges(O,y);const F=O._prev,$=O._next;return F&&(F._next=$),$&&($._prev=F),O._next=null,O._prev=null,O}const I=new VC(p);return this._records.set(p,I),I.currentValue=y,this._addToAdditions(I),I}_reset(){if(this.isDirty){let p;for(this._previousMapHead=this._mapHead,p=this._previousMapHead;null!==p;p=p._next)p._nextPrevious=p._next;for(p=this._changesHead;null!==p;p=p._nextChanged)p.previousValue=p.currentValue;for(p=this._additionsHead;null!=p;p=p._nextAdded)p.previousValue=p.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(p,y){Object.is(y,p.currentValue)||(p.previousValue=p.currentValue,p.currentValue=y,this._addToChanges(p))}_addToAdditions(p){null===this._additionsHead?this._additionsHead=this._additionsTail=p:(this._additionsTail._nextAdded=p,this._additionsTail=p)}_addToChanges(p){null===this._changesHead?this._changesHead=this._changesTail=p:(this._changesTail._nextChanged=p,this._changesTail=p)}_forEach(p,y){p instanceof Map?p.forEach(y):Object.keys(p).forEach(I=>y(p[I],I))}}class VC{constructor(p){this.key=p,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function jy(){return new Hf([new Vy])}let Hf=(()=>{class d{constructor(y){this.factories=y}static create(y,I){if(null!=I){const O=I.factories.slice();y=y.concat(O)}return new d(y)}static extend(y){return{provide:d,useFactory:I=>d.create(y,I||jy()),deps:[[d,new Al,new vl]]}}find(y){const I=this.factories.find(O=>O.supports(y));if(null!=I)return I;throw new Error(`Cannot find a differ supporting object '${y}' of type '${function GC(d){return d.name||typeof d}(y)}'`)}}return d.\u0275prov=Me({token:d,providedIn:"root",factory:jy}),d})();function Yy(){return new Uf([new zy])}let Uf=(()=>{class d{constructor(y){this.factories=y}static create(y,I){if(I){const O=I.factories.slice();y=y.concat(O)}return new d(y)}static extend(y){return{provide:d,useFactory:I=>d.create(y,I||Yy()),deps:[[d,new Al,new vl]]}}find(y){const I=this.factories.find(O=>O.supports(y));if(I)return I;throw new Error(`Cannot find a differ supporting object '${y}'`)}}return d.\u0275prov=Me({token:d,providedIn:"root",factory:Yy}),d})();const WC=[new zy],jC=new Hf([new Vy]),YC=new Uf(WC),XC=My(null,"core",[{provide:Ty,useValue:"unknown"},{provide:Ay,deps:[iu]},{provide:wy,deps:[]},{provide:Ey,deps:[]}]),QC=[{provide:Bp,useClass:Bp,deps:[bu,iu,gc,Ap,Qd]},{provide:pE,deps:[bu],useFactory:function qC(d){let p=[];return d.onStable.subscribe(()=>{for(;p.length;)p.pop()()}),function(y){p.push(y)}}},{provide:Qd,useClass:Qd,deps:[[new vl,d_]]},{provide:f_,useClass:f_,deps:[]},cC,{provide:Hf,useFactory:function KC(){return jC},deps:[]},{provide:Uf,useFactory:function JC(){return YC},deps:[]},{provide:Ff,useFactory:function $C(d){return d||function ZC(){return"undefined"!=typeof $localize&&$localize.locale||Rf}()},deps:[[new Ra(Ff),new vl,new Al]]},{provide:Cy,useValue:"USD"}];let tS=(()=>{class d{constructor(y){}}return d.\u0275fac=function(y){return new(y||d)(Yr(Bp))},d.\u0275mod=no({type:d}),d.\u0275inj=Bt({providers:QC}),d})()},93075:(B,X,_)=>{"use strict";_.d(X,{Zs:()=>kr,Fj:()=>et,NI:()=>xo,oH:()=>uo,sg:()=>Wr,u5:()=>pl,Cf:()=>gt,JU:()=>a,a5:()=>Dt,JJ:()=>ne,JL:()=>ee,F:()=>Gn,On:()=>ae,UX:()=>No,kI:()=>Jt,_Y:()=>Fe});var C=_(5e3),m=_(69808),e=_(32076),t=_(4128),n=_(54004);let o=(()=>{class Q{constructor(j,Ot){this._renderer=j,this._elementRef=Ot,this.onChange=Be=>{},this.onTouched=()=>{}}setProperty(j,Ot){this._renderer.setProperty(this._elementRef.nativeElement,j,Ot)}registerOnTouched(j){this.onTouched=j}registerOnChange(j){this.onChange=j}setDisabledState(j){this.setProperty("disabled",j)}}return Q.\u0275fac=function(j){return new(j||Q)(C.Y36(C.Qsj),C.Y36(C.SBq))},Q.\u0275dir=C.lG2({type:Q}),Q})(),r=(()=>{class Q extends o{}return Q.\u0275fac=function(){let V;return function(Ot){return(V||(V=C.n5z(Q)))(Ot||Q)}}(),Q.\u0275dir=C.lG2({type:Q,features:[C.qOj]}),Q})();const a=new C.OlP("NgValueAccessor"),L={provide:a,useExisting:(0,C.Gpc)(()=>et),multi:!0},nt=new C.OlP("CompositionEventMode");let et=(()=>{class Q extends o{constructor(j,Ot,Be){super(j,Ot),this._compositionMode=Be,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function W(){const Q=(0,m.q)()?(0,m.q)().getUserAgent():"";return/android (\d+)/.test(Q.toLowerCase())}())}writeValue(j){this.setProperty("value",null==j?"":j)}_handleInput(j){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(j)}_compositionStart(){this._composing=!0}_compositionEnd(j){this._composing=!1,this._compositionMode&&this.onChange(j)}}return Q.\u0275fac=function(j){return new(j||Q)(C.Y36(C.Qsj),C.Y36(C.SBq),C.Y36(nt,8))},Q.\u0275dir=C.lG2({type:Q,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(j,Ot){1&j&&C.NdJ("input",function(bi){return Ot._handleInput(bi.target.value)})("blur",function(){return Ot.onTouched()})("compositionstart",function(){return Ot._compositionStart()})("compositionend",function(bi){return Ot._compositionEnd(bi.target.value)})},features:[C._Bn([L]),C.qOj]}),Q})();function Et(Q){return null==Q||0===Q.length}function It(Q){return null!=Q&&"number"==typeof Q.length}const gt=new C.OlP("NgValidators"),wt=new C.OlP("NgAsyncValidators"),Ut=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Jt{static min(V){return function Ct(Q){return V=>{if(Et(V.value)||Et(Q))return null;const j=parseFloat(V.value);return!isNaN(j)&&j<Q?{min:{min:Q,actual:V.value}}:null}}(V)}static max(V){return function bt(Q){return V=>{if(Et(V.value)||Et(Q))return null;const j=parseFloat(V.value);return!isNaN(j)&&j>Q?{max:{max:Q,actual:V.value}}:null}}(V)}static required(V){return at(V)}static requiredTrue(V){return ft(V)}static email(V){return function lt(Q){return Et(Q.value)||Ut.test(Q.value)?null:{email:!0}}(V)}static minLength(V){return function Ft(Q){return V=>Et(V.value)||!It(V.value)?null:V.value.length<Q?{minlength:{requiredLength:Q,actualLength:V.value.length}}:null}(V)}static maxLength(V){return function Mt(Q){return V=>It(V.value)&&V.value.length>Q?{maxlength:{requiredLength:Q,actualLength:V.value.length}}:null}(V)}static pattern(V){return function yt(Q){if(!Q)return ct;let V,j;return"string"==typeof Q?(j="","^"!==Q.charAt(0)&&(j+="^"),j+=Q,"$"!==Q.charAt(Q.length-1)&&(j+="$"),V=new RegExp(j)):(j=Q.toString(),V=Q),Ot=>{if(Et(Ot.value))return null;const Be=Ot.value;return V.test(Be)?null:{pattern:{requiredPattern:j,actualValue:Be}}}}(V)}static nullValidator(V){return null}static compose(V){return ce(V)}static composeAsync(V){return Ne(V)}}function at(Q){return Et(Q.value)?{required:!0}:null}function ft(Q){return!0===Q.value?null:{required:!0}}function ct(Q){return null}function rt(Q){return null!=Q}function se(Q){const V=(0,C.QGY)(Q)?(0,e.D)(Q):Q;return(0,C.CqO)(V),V}function xt(Q){let V={};return Q.forEach(j=>{V=null!=j?Object.assign(Object.assign({},V),j):V}),0===Object.keys(V).length?null:V}function Lt(Q,V){return V.map(j=>j(Q))}function _e(Q){return Q.map(V=>function de(Q){return!Q.validate}(V)?V:j=>V.validate(j))}function ce(Q){if(!Q)return null;const V=Q.filter(rt);return 0==V.length?null:function(j){return xt(Lt(j,V))}}function Ae(Q){return null!=Q?ce(_e(Q)):null}function Ne(Q){if(!Q)return null;const V=Q.filter(rt);return 0==V.length?null:function(j){const Ot=Lt(j,V).map(se);return(0,t.D)(Ot).pipe((0,n.U)(xt))}}function qe(Q){return null!=Q?Ne(_e(Q)):null}function Di(Q,V){return null===Q?[V]:Array.isArray(Q)?[...Q,V]:[Q,V]}function ei(Q){return Q._rawValidators}function Me(Q){return Q._rawAsyncValidators}function ri(Q){return Q?Array.isArray(Q)?Q:[Q]:[]}function Bt(Q,V){return Array.isArray(Q)?Q.includes(V):Q===V}function Ie(Q,V){const j=ri(V);return ri(Q).forEach(Be=>{Bt(j,Be)||j.push(Be)}),j}function Xt(Q,V){return ri(V).filter(j=>!Bt(Q,j))}class he{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(V){this._rawValidators=V||[],this._composedValidatorFn=Ae(this._rawValidators)}_setAsyncValidators(V){this._rawAsyncValidators=V||[],this._composedAsyncValidatorFn=qe(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(V){this._onDestroyCallbacks.push(V)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(V=>V()),this._onDestroyCallbacks=[]}reset(V){this.control&&this.control.reset(V)}hasError(V,j){return!!this.control&&this.control.hasError(V,j)}getError(V,j){return this.control?this.control.getError(V,j):null}}class Dt extends he{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class ve extends he{get formDirective(){return null}get path(){return null}}class je{constructor(V){this._cd=V}is(V){var j,Ot,Be;return"submitted"===V?!!(null===(j=this._cd)||void 0===j?void 0:j.submitted):!!(null===(Be=null===(Ot=this._cd)||void 0===Ot?void 0:Ot.control)||void 0===Be?void 0:Be[V])}}let ne=(()=>{class Q extends je{constructor(j){super(j)}}return Q.\u0275fac=function(j){return new(j||Q)(C.Y36(Dt,2))},Q.\u0275dir=C.lG2({type:Q,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(j,Ot){2&j&&C.ekj("ng-untouched",Ot.is("untouched"))("ng-touched",Ot.is("touched"))("ng-pristine",Ot.is("pristine"))("ng-dirty",Ot.is("dirty"))("ng-valid",Ot.is("valid"))("ng-invalid",Ot.is("invalid"))("ng-pending",Ot.is("pending"))},features:[C.qOj]}),Q})(),ee=(()=>{class Q extends je{constructor(j){super(j)}}return Q.\u0275fac=function(j){return new(j||Q)(C.Y36(ve,10))},Q.\u0275dir=C.lG2({type:Q,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(j,Ot){2&j&&C.ekj("ng-untouched",Ot.is("untouched"))("ng-touched",Ot.is("touched"))("ng-pristine",Ot.is("pristine"))("ng-dirty",Ot.is("dirty"))("ng-valid",Ot.is("valid"))("ng-invalid",Ot.is("invalid"))("ng-pending",Ot.is("pending"))("ng-submitted",Ot.is("submitted"))},features:[C.qOj]}),Q})();function rn(Q,V){yi(Q,V),V.valueAccessor.writeValue(Q.value),function Ni(Q,V){V.valueAccessor.registerOnChange(j=>{Q._pendingValue=j,Q._pendingChange=!0,Q._pendingDirty=!0,"change"===Q.updateOn&&si(Q,V)})}(Q,V),function Ce(Q,V){const j=(Ot,Be)=>{V.valueAccessor.writeValue(Ot),Be&&V.viewToModelUpdate(Ot)};Q.registerOnChange(j),V._registerOnDestroy(()=>{Q._unregisterOnChange(j)})}(Q,V),function mn(Q,V){V.valueAccessor.registerOnTouched(()=>{Q._pendingTouched=!0,"blur"===Q.updateOn&&Q._pendingChange&&si(Q,V),"submit"!==Q.updateOn&&Q.markAsTouched()})}(Q,V),function _i(Q,V){if(V.valueAccessor.setDisabledState){const j=Ot=>{V.valueAccessor.setDisabledState(Ot)};Q.registerOnDisabledChange(j),V._registerOnDestroy(()=>{Q._unregisterOnDisabledChange(j)})}}(Q,V)}function ge(Q,V,j=!0){const Ot=()=>{};V.valueAccessor&&(V.valueAccessor.registerOnChange(Ot),V.valueAccessor.registerOnTouched(Ot)),Fi(Q,V),Q&&(V._invokeOnDestroyCallbacks(),Q._registerOnCollectionChange(()=>{}))}function De(Q,V){Q.forEach(j=>{j.registerOnValidatorChange&&j.registerOnValidatorChange(V)})}function yi(Q,V){const j=ei(Q);null!==V.validator?Q.setValidators(Di(j,V.validator)):"function"==typeof j&&Q.setValidators([j]);const Ot=Me(Q);null!==V.asyncValidator?Q.setAsyncValidators(Di(Ot,V.asyncValidator)):"function"==typeof Ot&&Q.setAsyncValidators([Ot]);const Be=()=>Q.updateValueAndValidity();De(V._rawValidators,Be),De(V._rawAsyncValidators,Be)}function Fi(Q,V){let j=!1;if(null!==Q){if(null!==V.validator){const Be=ei(Q);if(Array.isArray(Be)&&Be.length>0){const bi=Be.filter(un=>un!==V.validator);bi.length!==Be.length&&(j=!0,Q.setValidators(bi))}}if(null!==V.asyncValidator){const Be=Me(Q);if(Array.isArray(Be)&&Be.length>0){const bi=Be.filter(un=>un!==V.asyncValidator);bi.length!==Be.length&&(j=!0,Q.setAsyncValidators(bi))}}}const Ot=()=>{};return De(V._rawValidators,Ot),De(V._rawAsyncValidators,Ot),j}function si(Q,V){Q._pendingDirty&&Q.markAsDirty(),Q.setValue(Q._pendingValue,{emitModelToViewChange:!1}),V.viewToModelUpdate(Q._pendingValue),Q._pendingChange=!1}function Vt(Q,V){yi(Q,V)}function He(Q,V){if(!Q.hasOwnProperty("model"))return!1;const j=Q.model;return!!j.isFirstChange()||!Object.is(V,j.currentValue)}function tn(Q,V){Q._syncPendingControls(),V.forEach(j=>{const Ot=j.control;"submit"===Ot.updateOn&&Ot._pendingChange&&(j.viewToModelUpdate(Ot._pendingValue),Ot._pendingChange=!1)})}function In(Q,V){if(!V)return null;let j,Ot,Be;return Array.isArray(V),V.forEach(bi=>{bi.constructor===et?j=bi:function $i(Q){return Object.getPrototypeOf(Q.constructor)===r}(bi)?Ot=bi:Be=bi}),Be||Ot||j||null}function no(Q,V){const j=Q.indexOf(V);j>-1&&Q.splice(j,1)}const Je="VALID",xe="INVALID",hi="PENDING",Oi="DISABLED";function kn(Q){return(qo(Q)?Q.validators:Q)||null}function so(Q){return Array.isArray(Q)?Ae(Q):Q||null}function Do(Q,V){return(qo(V)?V.asyncValidators:Q)||null}function Zo(Q){return Array.isArray(Q)?qe(Q):Q||null}function qo(Q){return null!=Q&&!Array.isArray(Q)&&"object"==typeof Q}class yr{constructor(V,j){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=V,this._rawAsyncValidators=j,this._composedValidatorFn=so(this._rawValidators),this._composedAsyncValidatorFn=Zo(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(V){this._rawValidators=this._composedValidatorFn=V}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(V){this._rawAsyncValidators=this._composedAsyncValidatorFn=V}get parent(){return this._parent}get valid(){return this.status===Je}get invalid(){return this.status===xe}get pending(){return this.status==hi}get disabled(){return this.status===Oi}get enabled(){return this.status!==Oi}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(V){this._rawValidators=V,this._composedValidatorFn=so(V)}setAsyncValidators(V){this._rawAsyncValidators=V,this._composedAsyncValidatorFn=Zo(V)}addValidators(V){this.setValidators(Ie(V,this._rawValidators))}addAsyncValidators(V){this.setAsyncValidators(Ie(V,this._rawAsyncValidators))}removeValidators(V){this.setValidators(Xt(V,this._rawValidators))}removeAsyncValidators(V){this.setAsyncValidators(Xt(V,this._rawAsyncValidators))}hasValidator(V){return Bt(this._rawValidators,V)}hasAsyncValidator(V){return Bt(this._rawAsyncValidators,V)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(V={}){this.touched=!0,this._parent&&!V.onlySelf&&this._parent.markAsTouched(V)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(V=>V.markAllAsTouched())}markAsUntouched(V={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(j=>{j.markAsUntouched({onlySelf:!0})}),this._parent&&!V.onlySelf&&this._parent._updateTouched(V)}markAsDirty(V={}){this.pristine=!1,this._parent&&!V.onlySelf&&this._parent.markAsDirty(V)}markAsPristine(V={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(j=>{j.markAsPristine({onlySelf:!0})}),this._parent&&!V.onlySelf&&this._parent._updatePristine(V)}markAsPending(V={}){this.status=hi,!1!==V.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!V.onlySelf&&this._parent.markAsPending(V)}disable(V={}){const j=this._parentMarkedDirty(V.onlySelf);this.status=Oi,this.errors=null,this._forEachChild(Ot=>{Ot.disable(Object.assign(Object.assign({},V),{onlySelf:!0}))}),this._updateValue(),!1!==V.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},V),{skipPristineCheck:j})),this._onDisabledChange.forEach(Ot=>Ot(!0))}enable(V={}){const j=this._parentMarkedDirty(V.onlySelf);this.status=Je,this._forEachChild(Ot=>{Ot.enable(Object.assign(Object.assign({},V),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:V.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},V),{skipPristineCheck:j})),this._onDisabledChange.forEach(Ot=>Ot(!1))}_updateAncestors(V){this._parent&&!V.onlySelf&&(this._parent.updateValueAndValidity(V),V.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(V){this._parent=V}updateValueAndValidity(V={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Je||this.status===hi)&&this._runAsyncValidator(V.emitEvent)),!1!==V.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!V.onlySelf&&this._parent.updateValueAndValidity(V)}_updateTreeValidity(V={emitEvent:!0}){this._forEachChild(j=>j._updateTreeValidity(V)),this.updateValueAndValidity({onlySelf:!0,emitEvent:V.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Oi:Je}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(V){if(this.asyncValidator){this.status=hi,this._hasOwnPendingAsyncValidator=!0;const j=se(this.asyncValidator(this));this._asyncValidationSubscription=j.subscribe(Ot=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Ot,{emitEvent:V})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(V,j={}){this.errors=V,this._updateControlsErrors(!1!==j.emitEvent)}get(V){return function gn(Q,V,j){if(null==V||(Array.isArray(V)||(V=V.split(j)),Array.isArray(V)&&0===V.length))return null;let Ot=Q;return V.forEach(Be=>{Ot=Ot instanceof vo?Ot.controls.hasOwnProperty(Be)?Ot.controls[Be]:null:Ot instanceof Fr&&Ot.at(Be)||null}),Ot}(this,V,".")}getError(V,j){const Ot=j?this.get(j):this;return Ot&&Ot.errors?Ot.errors[V]:null}hasError(V,j){return!!this.getError(V,j)}get root(){let V=this;for(;V._parent;)V=V._parent;return V}_updateControlsErrors(V){this.status=this._calculateStatus(),V&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(V)}_initObservables(){this.valueChanges=new C.vpe,this.statusChanges=new C.vpe}_calculateStatus(){return this._allControlsDisabled()?Oi:this.errors?xe:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(hi)?hi:this._anyControlsHaveStatus(xe)?xe:Je}_anyControlsHaveStatus(V){return this._anyControls(j=>j.status===V)}_anyControlsDirty(){return this._anyControls(V=>V.dirty)}_anyControlsTouched(){return this._anyControls(V=>V.touched)}_updatePristine(V={}){this.pristine=!this._anyControlsDirty(),this._parent&&!V.onlySelf&&this._parent._updatePristine(V)}_updateTouched(V={}){this.touched=this._anyControlsTouched(),this._parent&&!V.onlySelf&&this._parent._updateTouched(V)}_isBoxedValue(V){return"object"==typeof V&&null!==V&&2===Object.keys(V).length&&"value"in V&&"disabled"in V}_registerOnCollectionChange(V){this._onCollectionChange=V}_setUpdateStrategy(V){qo(V)&&null!=V.updateOn&&(this._updateOn=V.updateOn)}_parentMarkedDirty(V){return!V&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class xo extends yr{constructor(V=null,j,Ot){super(kn(j),Do(Ot,j)),this._onChange=[],this._applyFormState(V),this._setUpdateStrategy(j),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(V,j={}){this.value=this._pendingValue=V,this._onChange.length&&!1!==j.emitModelToViewChange&&this._onChange.forEach(Ot=>Ot(this.value,!1!==j.emitViewToModelChange)),this.updateValueAndValidity(j)}patchValue(V,j={}){this.setValue(V,j)}reset(V=null,j={}){this._applyFormState(V),this.markAsPristine(j),this.markAsUntouched(j),this.setValue(this.value,j),this._pendingChange=!1}_updateValue(){}_anyControls(V){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(V){this._onChange.push(V)}_unregisterOnChange(V){no(this._onChange,V)}registerOnDisabledChange(V){this._onDisabledChange.push(V)}_unregisterOnDisabledChange(V){no(this._onDisabledChange,V)}_forEachChild(V){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(V){this._isBoxedValue(V)?(this.value=this._pendingValue=V.value,V.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=V}}class vo extends yr{constructor(V,j,Ot){super(kn(j),Do(Ot,j)),this.controls=V,this._initObservables(),this._setUpdateStrategy(j),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(V,j){return this.controls[V]?this.controls[V]:(this.controls[V]=j,j.setParent(this),j._registerOnCollectionChange(this._onCollectionChange),j)}addControl(V,j,Ot={}){this.registerControl(V,j),this.updateValueAndValidity({emitEvent:Ot.emitEvent}),this._onCollectionChange()}removeControl(V,j={}){this.controls[V]&&this.controls[V]._registerOnCollectionChange(()=>{}),delete this.controls[V],this.updateValueAndValidity({emitEvent:j.emitEvent}),this._onCollectionChange()}setControl(V,j,Ot={}){this.controls[V]&&this.controls[V]._registerOnCollectionChange(()=>{}),delete this.controls[V],j&&this.registerControl(V,j),this.updateValueAndValidity({emitEvent:Ot.emitEvent}),this._onCollectionChange()}contains(V){return this.controls.hasOwnProperty(V)&&this.controls[V].enabled}setValue(V,j={}){this._checkAllValuesPresent(V),Object.keys(V).forEach(Ot=>{this._throwIfControlMissing(Ot),this.controls[Ot].setValue(V[Ot],{onlySelf:!0,emitEvent:j.emitEvent})}),this.updateValueAndValidity(j)}patchValue(V,j={}){null!=V&&(Object.keys(V).forEach(Ot=>{this.controls[Ot]&&this.controls[Ot].patchValue(V[Ot],{onlySelf:!0,emitEvent:j.emitEvent})}),this.updateValueAndValidity(j))}reset(V={},j={}){this._forEachChild((Ot,Be)=>{Ot.reset(V[Be],{onlySelf:!0,emitEvent:j.emitEvent})}),this._updatePristine(j),this._updateTouched(j),this.updateValueAndValidity(j)}getRawValue(){return this._reduceChildren({},(V,j,Ot)=>(V[Ot]=j instanceof xo?j.value:j.getRawValue(),V))}_syncPendingControls(){let V=this._reduceChildren(!1,(j,Ot)=>!!Ot._syncPendingControls()||j);return V&&this.updateValueAndValidity({onlySelf:!0}),V}_throwIfControlMissing(V){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[V])throw new Error(`Cannot find form control with name: ${V}.`)}_forEachChild(V){Object.keys(this.controls).forEach(j=>{const Ot=this.controls[j];Ot&&V(Ot,j)})}_setUpControls(){this._forEachChild(V=>{V.setParent(this),V._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(V){for(const j of Object.keys(this.controls)){const Ot=this.controls[j];if(this.contains(j)&&V(Ot))return!0}return!1}_reduceValue(){return this._reduceChildren({},(V,j,Ot)=>((j.enabled||this.disabled)&&(V[Ot]=j.value),V))}_reduceChildren(V,j){let Ot=V;return this._forEachChild((Be,bi)=>{Ot=j(Ot,Be,bi)}),Ot}_allControlsDisabled(){for(const V of Object.keys(this.controls))if(this.controls[V].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(V){this._forEachChild((j,Ot)=>{if(void 0===V[Ot])throw new Error(`Must supply a value for form control with name: '${Ot}'.`)})}}class Fr extends yr{constructor(V,j,Ot){super(kn(j),Do(Ot,j)),this.controls=V,this._initObservables(),this._setUpdateStrategy(j),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(V){return this.controls[V]}push(V,j={}){this.controls.push(V),this._registerControl(V),this.updateValueAndValidity({emitEvent:j.emitEvent}),this._onCollectionChange()}insert(V,j,Ot={}){this.controls.splice(V,0,j),this._registerControl(j),this.updateValueAndValidity({emitEvent:Ot.emitEvent})}removeAt(V,j={}){this.controls[V]&&this.controls[V]._registerOnCollectionChange(()=>{}),this.controls.splice(V,1),this.updateValueAndValidity({emitEvent:j.emitEvent})}setControl(V,j,Ot={}){this.controls[V]&&this.controls[V]._registerOnCollectionChange(()=>{}),this.controls.splice(V,1),j&&(this.controls.splice(V,0,j),this._registerControl(j)),this.updateValueAndValidity({emitEvent:Ot.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(V,j={}){this._checkAllValuesPresent(V),V.forEach((Ot,Be)=>{this._throwIfControlMissing(Be),this.at(Be).setValue(Ot,{onlySelf:!0,emitEvent:j.emitEvent})}),this.updateValueAndValidity(j)}patchValue(V,j={}){null!=V&&(V.forEach((Ot,Be)=>{this.at(Be)&&this.at(Be).patchValue(Ot,{onlySelf:!0,emitEvent:j.emitEvent})}),this.updateValueAndValidity(j))}reset(V=[],j={}){this._forEachChild((Ot,Be)=>{Ot.reset(V[Be],{onlySelf:!0,emitEvent:j.emitEvent})}),this._updatePristine(j),this._updateTouched(j),this.updateValueAndValidity(j)}getRawValue(){return this.controls.map(V=>V instanceof xo?V.value:V.getRawValue())}clear(V={}){this.controls.length<1||(this._forEachChild(j=>j._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:V.emitEvent}))}_syncPendingControls(){let V=this.controls.reduce((j,Ot)=>!!Ot._syncPendingControls()||j,!1);return V&&this.updateValueAndValidity({onlySelf:!0}),V}_throwIfControlMissing(V){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(V))throw new Error(`Cannot find form control at index ${V}`)}_forEachChild(V){this.controls.forEach((j,Ot)=>{V(j,Ot)})}_updateValue(){this.value=this.controls.filter(V=>V.enabled||this.disabled).map(V=>V.value)}_anyControls(V){return this.controls.some(j=>j.enabled&&V(j))}_setUpControls(){this._forEachChild(V=>this._registerControl(V))}_checkAllValuesPresent(V){this._forEachChild((j,Ot)=>{if(void 0===V[Ot])throw new Error(`Must supply a value for form control at index: ${Ot}.`)})}_allControlsDisabled(){for(const V of this.controls)if(V.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(V){V.setParent(this),V._registerOnCollectionChange(this._onCollectionChange)}}const co={provide:ve,useExisting:(0,C.Gpc)(()=>Gn)},Ii=(()=>Promise.resolve(null))();let Gn=(()=>{class Q extends ve{constructor(j,Ot){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new C.vpe,this.form=new vo({},Ae(j),qe(Ot))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(j){Ii.then(()=>{const Ot=this._findContainer(j.path);j.control=Ot.registerControl(j.name,j.control),rn(j.control,j),j.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(j)})}getControl(j){return this.form.get(j.path)}removeControl(j){Ii.then(()=>{const Ot=this._findContainer(j.path);Ot&&Ot.removeControl(j.name),no(this._directives,j)})}addFormGroup(j){Ii.then(()=>{const Ot=this._findContainer(j.path),Be=new vo({});Vt(Be,j),Ot.registerControl(j.name,Be),Be.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(j){Ii.then(()=>{const Ot=this._findContainer(j.path);Ot&&Ot.removeControl(j.name)})}getFormGroup(j){return this.form.get(j.path)}updateModel(j,Ot){Ii.then(()=>{this.form.get(j.path).setValue(Ot)})}setValue(j){this.control.setValue(j)}onSubmit(j){return this.submitted=!0,tn(this.form,this._directives),this.ngSubmit.emit(j),!1}onReset(){this.resetForm()}resetForm(j){this.form.reset(j),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(j){return j.pop(),j.length?this.form.get(j):this.form}}return Q.\u0275fac=function(j){return new(j||Q)(C.Y36(gt,10),C.Y36(wt,10))},Q.\u0275dir=C.lG2({type:Q,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(j,Ot){1&j&&C.NdJ("submit",function(bi){return Ot.onSubmit(bi)})("reset",function(){return Ot.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[C._Bn([co]),C.qOj]}),Q})();const On={provide:Dt,useExisting:(0,C.Gpc)(()=>ae)},Wn=(()=>Promise.resolve(null))();let ae=(()=>{class Q extends Dt{constructor(j,Ot,Be,bi){super(),this.control=new xo,this._registered=!1,this.update=new C.vpe,this._parent=j,this._setValidators(Ot),this._setAsyncValidators(Be),this.valueAccessor=In(0,bi)}ngOnChanges(j){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in j&&this._updateDisabled(j),He(j,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function Ri(Q,V){return[...V.path,Q]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(j){this.viewModel=j,this.update.emit(j)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){rn(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(j){Wn.then(()=>{this.control.setValue(j,{emitViewToModelChange:!1})})}_updateDisabled(j){const Ot=j.isDisabled.currentValue,Be=""===Ot||Ot&&"false"!==Ot;Wn.then(()=>{Be&&!this.control.disabled?this.control.disable():!Be&&this.control.disabled&&this.control.enable()})}}return Q.\u0275fac=function(j){return new(j||Q)(C.Y36(ve,9),C.Y36(gt,10),C.Y36(wt,10),C.Y36(a,10))},Q.\u0275dir=C.lG2({type:Q,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[C._Bn([On]),C.qOj,C.TTD]}),Q})(),Fe=(()=>{class Q{}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275dir=C.lG2({type:Q,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),Q})(),ao=(()=>{class Q{}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275mod=C.oAB({type:Q}),Q.\u0275inj=C.cJS({}),Q})();const rr=new C.OlP("NgModelWithFormControlWarning"),Or={provide:Dt,useExisting:(0,C.Gpc)(()=>uo)};let uo=(()=>{class Q extends Dt{constructor(j,Ot,Be,bi){super(),this._ngModelWarningConfig=bi,this.update=new C.vpe,this._ngModelWarningSent=!1,this._setValidators(j),this._setAsyncValidators(Ot),this.valueAccessor=In(0,Be)}set isDisabled(j){}ngOnChanges(j){if(this._isControlChanged(j)){const Ot=j.form.previousValue;Ot&&ge(Ot,this,!1),rn(this.form,this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this.form.updateValueAndValidity({emitEvent:!1})}He(j,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&ge(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(j){this.viewModel=j,this.update.emit(j)}_isControlChanged(j){return j.hasOwnProperty("form")}}return Q._ngModelWarningSentOnce=!1,Q.\u0275fac=function(j){return new(j||Q)(C.Y36(gt,10),C.Y36(wt,10),C.Y36(a,10),C.Y36(rr,8))},Q.\u0275dir=C.lG2({type:Q,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[C._Bn([Or]),C.qOj,C.TTD]}),Q})();const Os={provide:ve,useExisting:(0,C.Gpc)(()=>Wr)};let Wr=(()=>{class Q extends ve{constructor(j,Ot){super(),this.validators=j,this.asyncValidators=Ot,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new C.vpe,this._setValidators(j),this._setAsyncValidators(Ot)}ngOnChanges(j){this._checkFormPresent(),j.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Fi(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(j){const Ot=this.form.get(j.path);return rn(Ot,j),Ot.updateValueAndValidity({emitEvent:!1}),this.directives.push(j),Ot}getControl(j){return this.form.get(j.path)}removeControl(j){ge(j.control||null,j,!1),no(this.directives,j)}addFormGroup(j){this._setUpFormContainer(j)}removeFormGroup(j){this._cleanUpFormContainer(j)}getFormGroup(j){return this.form.get(j.path)}addFormArray(j){this._setUpFormContainer(j)}removeFormArray(j){this._cleanUpFormContainer(j)}getFormArray(j){return this.form.get(j.path)}updateModel(j,Ot){this.form.get(j.path).setValue(Ot)}onSubmit(j){return this.submitted=!0,tn(this.form,this.directives),this.ngSubmit.emit(j),!1}onReset(){this.resetForm()}resetForm(j){this.form.reset(j),this.submitted=!1}_updateDomValue(){this.directives.forEach(j=>{const Ot=j.control,Be=this.form.get(j.path);Ot!==Be&&(ge(Ot||null,j),Be instanceof xo&&(rn(Be,j),j.control=Be))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(j){const Ot=this.form.get(j.path);Vt(Ot,j),Ot.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(j){if(this.form){const Ot=this.form.get(j.path);Ot&&function vt(Q,V){return Fi(Q,V)}(Ot,j)&&Ot.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){yi(this.form,this),this._oldForm&&Fi(this._oldForm,this)}_checkFormPresent(){}}return Q.\u0275fac=function(j){return new(j||Q)(C.Y36(gt,10),C.Y36(wt,10))},Q.\u0275dir=C.lG2({type:Q,selectors:[["","formGroup",""]],hostBindings:function(j,Ot){1&j&&C.NdJ("submit",function(bi){return Ot.onSubmit(bi)})("reset",function(){return Ot.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[C._Bn([Os]),C.qOj,C.TTD]}),Q})();const oa={provide:gt,useExisting:(0,C.Gpc)(()=>pa),multi:!0},Br={provide:gt,useExisting:(0,C.Gpc)(()=>kr),multi:!0};let pa=(()=>{class Q{constructor(){this._required=!1}get required(){return this._required}set required(j){this._required=null!=j&&!1!==j&&"false"!=`${j}`,this._onChange&&this._onChange()}validate(j){return this.required?at(j):null}registerOnValidatorChange(j){this._onChange=j}}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275dir=C.lG2({type:Q,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(j,Ot){2&j&&C.uIk("required",Ot.required?"":null)},inputs:{required:"required"},features:[C._Bn([oa])]}),Q})(),kr=(()=>{class Q extends pa{validate(j){return this.required?ft(j):null}}return Q.\u0275fac=function(){let V;return function(Ot){return(V||(V=C.n5z(Q)))(Ot||Q)}}(),Q.\u0275dir=C.lG2({type:Q,selectors:[["input","type","checkbox","required","","formControlName",""],["input","type","checkbox","required","","formControl",""],["input","type","checkbox","required","","ngModel",""]],hostVars:1,hostBindings:function(j,Ot){2&j&&C.uIk("required",Ot.required?"":null)},features:[C._Bn([Br]),C.qOj]}),Q})(),ks=(()=>{class Q{}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275mod=C.oAB({type:Q}),Q.\u0275inj=C.cJS({imports:[[ao]]}),Q})(),pl=(()=>{class Q{}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275mod=C.oAB({type:Q}),Q.\u0275inj=C.cJS({imports:[ks]}),Q})(),No=(()=>{class Q{static withConfig(j){return{ngModule:Q,providers:[{provide:rr,useValue:j.warnOnNgModelWithFormControl}]}}}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275mod=C.oAB({type:Q}),Q.\u0275inj=C.cJS({imports:[ks]}),Q})()},91079:(B,X,_)=>{"use strict";_.d(X,{XC:()=>_e,Bb:()=>Ie,ZL:()=>Me});var C=_(15664),m=_(63191),e=_(5e3),t=_(90508),n=_(50727),o=_(77579),r=_(49770),a=_(56451),h=_(39646),R=_(54968),L=_(70925),W=_(69808),nt=_(91314),et=_(30495),Et=_(91159),It=_(47429),gt=_(93075),wt=_(67322),Ut=_(95698),Jt=_(63900),Ct=_(39300),bt=_(54004),at=_(18505),ft=_(91005),lt=_(50226);const Ft=["panel"];function Mt(Xt,he){if(1&Xt&&(e.TgZ(0,"div",0,1),e.Hsn(2),e.qZA()),2&Xt){const Dt=he.id,ve=e.oxw();e.Q6J("id",ve.id)("ngClass",ve._classList),e.uIk("aria-label",ve.ariaLabel||null)("aria-labelledby",ve._getPanelAriaLabelledby(Dt))}}const yt=["*"];let ct=0;class rt{constructor(he,Dt){this.source=he,this.option=Dt}}const se=(0,t.Kr)(class{}),xt=new e.OlP("mat-autocomplete-default-options",{providedIn:"root",factory:function Lt(){return{autoActiveFirstOption:!1}}});let de=(()=>{class Xt extends se{constructor(Dt,ve,je,gi){super(),this._changeDetectorRef=Dt,this._elementRef=ve,this._activeOptionChanges=n.w0.EMPTY,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new e.vpe,this.opened=new e.vpe,this.closed=new e.vpe,this.optionActivated=new e.vpe,this._classList={},this.id="mat-autocomplete-"+ct++,this.inertGroups=(null==gi?void 0:gi.SAFARI)||!1,this._autoActiveFirstOption=!!je.autoActiveFirstOption}get isOpen(){return this._isOpen&&this.showPanel}get autoActiveFirstOption(){return this._autoActiveFirstOption}set autoActiveFirstOption(Dt){this._autoActiveFirstOption=(0,m.Ig)(Dt)}set classList(Dt){this._classList=Dt&&Dt.length?(0,m.du)(Dt).reduce((ve,je)=>(ve[je]=!0,ve),{}):{},this._setVisibilityClasses(this._classList),this._elementRef.nativeElement.className=""}ngAfterContentInit(){this._keyManager=new C.s1(this.options).withWrap(),this._activeOptionChanges=this._keyManager.change.subscribe(Dt=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[Dt]||null})}),this._setVisibility()}ngOnDestroy(){this._activeOptionChanges.unsubscribe()}_setScrollTop(Dt){this.panel&&(this.panel.nativeElement.scrollTop=Dt)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(Dt){const ve=new rt(this,Dt);this.optionSelected.emit(ve)}_getPanelAriaLabelledby(Dt){return this.ariaLabel?null:this.ariaLabelledby?(Dt?Dt+" ":"")+this.ariaLabelledby:Dt}_setVisibilityClasses(Dt){Dt[this._visibleClass]=this.showPanel,Dt[this._hiddenClass]=!this.showPanel}}return Xt.\u0275fac=function(Dt){return new(Dt||Xt)(e.Y36(e.sBO),e.Y36(e.SBq),e.Y36(xt),e.Y36(L.t4))},Xt.\u0275dir=e.lG2({type:Xt,viewQuery:function(Dt,ve){if(1&Dt&&(e.Gf(e.Rgc,7),e.Gf(Ft,5)),2&Dt){let je;e.iGM(je=e.CRH())&&(ve.template=je.first),e.iGM(je=e.CRH())&&(ve.panel=je.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[e.qOj]}),Xt})(),_e=(()=>{class Xt extends de{constructor(){super(...arguments),this._visibleClass="mat-autocomplete-visible",this._hiddenClass="mat-autocomplete-hidden"}}return Xt.\u0275fac=function(){let he;return function(ve){return(he||(he=e.n5z(Xt)))(ve||Xt)}}(),Xt.\u0275cmp=e.Xpm({type:Xt,selectors:[["mat-autocomplete"]],contentQueries:function(Dt,ve,je){if(1&Dt&&(e.Suo(je,t.K7,5),e.Suo(je,t.ey,5)),2&Dt){let gi;e.iGM(gi=e.CRH())&&(ve.optionGroups=gi),e.iGM(gi=e.CRH())&&(ve.options=gi)}},hostAttrs:[1,"mat-autocomplete"],inputs:{disableRipple:"disableRipple"},exportAs:["matAutocomplete"],features:[e._Bn([{provide:t.HF,useExisting:Xt}]),e.qOj],ngContentSelectors:yt,decls:1,vars:0,consts:[["role","listbox",1,"mat-autocomplete-panel",3,"id","ngClass"],["panel",""]],template:function(Dt,ve){1&Dt&&(e.F$t(),e.YNc(0,Mt,3,4,"ng-template"))},directives:[W.mk],styles:[".mat-autocomplete-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;visibility:hidden;max-width:none;max-height:256px;position:relative;width:100%;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.mat-autocomplete-panel.mat-autocomplete-visible{visibility:visible}.mat-autocomplete-panel.mat-autocomplete-hidden{visibility:hidden}.mat-autocomplete-panel-above .mat-autocomplete-panel{border-radius:0;border-top-left-radius:4px;border-top-right-radius:4px}.mat-autocomplete-panel .mat-divider-horizontal{margin-top:-1px}.cdk-high-contrast-active .mat-autocomplete-panel{outline:solid 1px}mat-autocomplete{display:none}\n"],encapsulation:2,changeDetection:0}),Xt})();const ce=new e.OlP("mat-autocomplete-scroll-strategy"),Ne={provide:ce,deps:[nt.aV],useFactory:function Ae(Xt){return()=>Xt.scrollStrategies.reposition()}},qe={provide:gt.JU,useExisting:(0,e.Gpc)(()=>Me),multi:!0};let ei=(()=>{class Xt{constructor(Dt,ve,je,gi,Ee,ne,ee,Oe,le,me,ye){this._element=Dt,this._overlay=ve,this._viewContainerRef=je,this._zone=gi,this._changeDetectorRef=Ee,this._dir=ee,this._formField=Oe,this._document=le,this._viewportRuler=me,this._defaults=ye,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=n.w0.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new o.x,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=(0,r.P)(()=>this.autocomplete&&this.autocomplete.options?(0,a.T)(...this.autocomplete.options.map(Kt=>Kt.onSelectionChange)):this._zone.onStable.pipe((0,Ut.q)(1),(0,Jt.w)(()=>this.optionSelections))),this._scrollStrategy=ne}get autocompleteDisabled(){return this._autocompleteDisabled}set autocompleteDisabled(Dt){this._autocompleteDisabled=(0,m.Ig)(Dt)}ngAfterViewInit(){const Dt=this._getWindow();void 0!==Dt&&this._zone.runOutsideAngular(()=>Dt.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(Dt){Dt.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const Dt=this._getWindow();void 0!==Dt&&Dt.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._attachOverlay(),this._floatLabel()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this.autocomplete.closed.emit(),this.autocomplete._isOpen=this._overlayAttached=!1,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._componentDestroyed||this._changeDetectorRef.detectChanges())}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return(0,a.T)(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe((0,Ct.h)(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe((0,Ct.h)(()=>this._overlayAttached)):(0,h.of)()).pipe((0,bt.U)(Dt=>Dt instanceof t.rN?Dt:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return(0,a.T)((0,R.R)(this._document,"click"),(0,R.R)(this._document,"auxclick"),(0,R.R)(this._document,"touchend")).pipe((0,Ct.h)(Dt=>{const ve=(0,L.sA)(Dt),je=this._formField?this._formField._elementRef.nativeElement:null,gi=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&ve!==this._element.nativeElement&&(!je||!je.contains(ve))&&(!gi||!gi.contains(ve))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(ve)}))}writeValue(Dt){Promise.resolve(null).then(()=>this._setTriggerValue(Dt))}registerOnChange(Dt){this._onChange=Dt}registerOnTouched(Dt){this._onTouched=Dt}setDisabledState(Dt){this._element.nativeElement.disabled=Dt}_handleKeydown(Dt){const ve=Dt.keyCode;if(ve===Et.hY&&!(0,Et.Vb)(Dt)&&Dt.preventDefault(),this.activeOption&&ve===Et.K5&&this.panelOpen)this.activeOption._selectViaInteraction(),this._resetActiveItem(),Dt.preventDefault();else if(this.autocomplete){const je=this.autocomplete._keyManager.activeItem,gi=ve===Et.LH||ve===Et.JH;this.panelOpen||ve===Et.Mf?this.autocomplete._keyManager.onKeydown(Dt):gi&&this._canOpen()&&this.openPanel(),(gi||this.autocomplete._keyManager.activeItem!==je)&&this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0)}}_handleInput(Dt){let ve=Dt.target,je=ve.value;"number"===ve.type&&(je=""==je?null:parseFloat(je)),this._previousValue!==je&&(this._previousValue=je,this._onChange(je),this._canOpen()&&this._document.activeElement===Dt.target&&this.openPanel())}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_floatLabel(Dt=!1){this._formField&&"auto"===this._formField.floatLabel&&(Dt?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField.floatLabel="auto",this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){const Dt=this._zone.onStable.pipe((0,Ut.q)(1)),ve=this.autocomplete.options.changes.pipe((0,at.b)(()=>this._positionStrategy.reapplyLastPosition()),(0,ft.g)(0));return(0,a.T)(Dt,ve).pipe((0,Jt.w)(()=>{const je=this.panelOpen;return this._resetActiveItem(),this.autocomplete._setVisibility(),this.panelOpen&&(this._overlayRef.updatePosition(),je!==this.panelOpen&&this.autocomplete.opened.emit()),this.panelClosingActions}),(0,Ut.q)(1)).subscribe(je=>this._setValueAndClose(je))}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_setTriggerValue(Dt){const ve=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(Dt):Dt,je=null!=ve?ve:"";this._formField?this._formField._control.value=je:this._element.nativeElement.value=je,this._previousValue=je}_setValueAndClose(Dt){Dt&&Dt.source&&(this._clearPreviousSelectedOption(Dt.source),this._setTriggerValue(Dt.source.value),this._onChange(Dt.source.value),this._element.nativeElement.focus(),this.autocomplete._emitSelectEvent(Dt.source)),this.closePanel()}_clearPreviousSelectedOption(Dt){this.autocomplete.options.forEach(ve=>{ve!==Dt&&ve.selected&&ve.deselect()})}_attachOverlay(){var Dt;let ve=this._overlayRef;ve?(this._positionStrategy.setOrigin(this._getConnectedElement()),ve.updateSize({width:this._getPanelWidth()})):(this._portal=new It.UE(this.autocomplete.template,this._viewContainerRef,{id:null===(Dt=this._formField)||void 0===Dt?void 0:Dt.getLabelId()}),ve=this._overlay.create(this._getOverlayConfig()),this._overlayRef=ve,ve.keydownEvents().subscribe(gi=>{(gi.keyCode===Et.hY&&!(0,Et.Vb)(gi)||gi.keyCode===Et.LH&&(0,Et.Vb)(gi,"altKey"))&&(this._closeKeyEventStream.next(),this._resetActiveItem(),gi.stopPropagation(),gi.preventDefault())}),this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&ve&&ve.updateSize({width:this._getPanelWidth()})})),ve&&!ve.hasAttached()&&(ve.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());const je=this.panelOpen;this.autocomplete._setVisibility(),this.autocomplete._isOpen=this._overlayAttached=!0,this.panelOpen&&je!==this.panelOpen&&this.autocomplete.opened.emit()}_getOverlayConfig(){var Dt;return new nt.X_({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir,panelClass:null===(Dt=this._defaults)||void 0===Dt?void 0:Dt.overlayPanelClass})}_getOverlayPosition(){const Dt=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(Dt),this._positionStrategy=Dt,Dt}_setStrategyPositions(Dt){const ve=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],je=this._aboveClass,gi=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:je},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:je}];let Ee;Ee="above"===this.position?gi:"below"===this.position?ve:[...ve,...gi],Dt.withPositions(Ee)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){const Dt=this.autocomplete;Dt.autoActiveFirstOption?Dt._keyManager.setFirstItemActive():Dt._keyManager.setActiveItem(-1)}_canOpen(){const Dt=this._element.nativeElement;return!Dt.readOnly&&!Dt.disabled&&!this._autocompleteDisabled}_getWindow(){var Dt;return(null===(Dt=this._document)||void 0===Dt?void 0:Dt.defaultView)||window}_scrollToOption(Dt){const ve=this.autocomplete,je=(0,t.CB)(Dt,ve.options,ve.optionGroups);if(0===Dt&&1===je)ve._setScrollTop(0);else if(ve.panel){const gi=ve.options.toArray()[Dt];if(gi){const Ee=gi._getHostElement(),ne=(0,t.jH)(Ee.offsetTop,Ee.offsetHeight,ve._getScrollTop(),ve.panel.nativeElement.offsetHeight);ve._setScrollTop(ne)}}}}return Xt.\u0275fac=function(Dt){return new(Dt||Xt)(e.Y36(e.SBq),e.Y36(nt.aV),e.Y36(e.s_b),e.Y36(e.R0b),e.Y36(e.sBO),e.Y36(ce),e.Y36(lt.Is,8),e.Y36(wt.G_,9),e.Y36(W.K0,8),e.Y36(et.rL),e.Y36(xt,8))},Xt.\u0275dir=e.lG2({type:Xt,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[e.TTD]}),Xt})(),Me=(()=>{class Xt extends ei{constructor(){super(...arguments),this._aboveClass="mat-autocomplete-panel-above"}}return Xt.\u0275fac=function(){let he;return function(ve){return(he||(he=e.n5z(Xt)))(ve||Xt)}}(),Xt.\u0275dir=e.lG2({type:Xt,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-autocomplete-trigger"],hostVars:7,hostBindings:function(Dt,ve){1&Dt&&e.NdJ("focusin",function(){return ve._handleFocus()})("blur",function(){return ve._onTouched()})("input",function(gi){return ve._handleInput(gi)})("keydown",function(gi){return ve._handleKeydown(gi)}),2&Dt&&e.uIk("autocomplete",ve.autocompleteAttribute)("role",ve.autocompleteDisabled?null:"combobox")("aria-autocomplete",ve.autocompleteDisabled?null:"list")("aria-activedescendant",ve.panelOpen&&ve.activeOption?ve.activeOption.id:null)("aria-expanded",ve.autocompleteDisabled?null:ve.panelOpen.toString())("aria-owns",ve.autocompleteDisabled||!ve.panelOpen||null==ve.autocomplete?null:ve.autocomplete.id)("aria-haspopup",!ve.autocompleteDisabled)},exportAs:["matAutocompleteTrigger"],features:[e._Bn([qe]),e.qOj]}),Xt})(),Ie=(()=>{class Xt{}return Xt.\u0275fac=function(Dt){return new(Dt||Xt)},Xt.\u0275mod=e.oAB({type:Xt}),Xt.\u0275inj=e.cJS({providers:[Ne],imports:[[nt.U8,t.Ng,t.BQ,W.ez],et.ZD,t.Ng,t.BQ]}),Xt})()},47423:(B,X,_)=>{"use strict";_.d(X,{zs:()=>W,lW:()=>L,ot:()=>nt});var C=_(5e3),m=_(90508),e=_(76360),t=_(15664);const n=["mat-button",""],o=["*"],h=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],R=(0,m.pj)((0,m.Id)((0,m.Kr)(class{constructor(et){this._elementRef=et}})));let L=(()=>{class et extends R{constructor(It,gt,wt){super(It),this._focusMonitor=gt,this._animationMode=wt,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const Ut of h)this._hasHostAttributes(Ut)&&this._getHostElement().classList.add(Ut);It.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(It,gt){It?this._focusMonitor.focusVia(this._getHostElement(),It,gt):this._getHostElement().focus(gt)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...It){return It.some(gt=>this._getHostElement().hasAttribute(gt))}}return et.\u0275fac=function(It){return new(It||et)(C.Y36(C.SBq),C.Y36(t.tE),C.Y36(e.Qb,8))},et.\u0275cmp=C.Xpm({type:et,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(It,gt){if(1&It&&C.Gf(m.wG,5),2&It){let wt;C.iGM(wt=C.CRH())&&(gt.ripple=wt.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(It,gt){2&It&&(C.uIk("disabled",gt.disabled||null),C.ekj("_mat-animation-noopable","NoopAnimations"===gt._animationMode)("mat-button-disabled",gt.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[C.qOj],attrs:n,ngContentSelectors:o,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(It,gt){1&It&&(C.F$t(),C.TgZ(0,"span",0),C.Hsn(1),C.qZA(),C._UZ(2,"span",1),C._UZ(3,"span",2)),2&It&&(C.xp6(2),C.ekj("mat-button-ripple-round",gt.isRoundButton||gt.isIconButton),C.Q6J("matRippleDisabled",gt._isRippleDisabled())("matRippleCentered",gt.isIconButton)("matRippleTrigger",gt._getHostElement()))},directives:[m.wG],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),et})(),W=(()=>{class et extends L{constructor(It,gt,wt){super(gt,It,wt)}_haltDisabledEvents(It){this.disabled&&(It.preventDefault(),It.stopImmediatePropagation())}}return et.\u0275fac=function(It){return new(It||et)(C.Y36(t.tE),C.Y36(C.SBq),C.Y36(e.Qb,8))},et.\u0275cmp=C.Xpm({type:et,selectors:[["a","mat-button",""],["a","mat-raised-button",""],["a","mat-icon-button",""],["a","mat-fab",""],["a","mat-mini-fab",""],["a","mat-stroked-button",""],["a","mat-flat-button",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:7,hostBindings:function(It,gt){1&It&&C.NdJ("click",function(Ut){return gt._haltDisabledEvents(Ut)}),2&It&&(C.uIk("tabindex",gt.disabled?-1:gt.tabIndex||0)("disabled",gt.disabled||null)("aria-disabled",gt.disabled.toString()),C.ekj("_mat-animation-noopable","NoopAnimations"===gt._animationMode)("mat-button-disabled",gt.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[C.qOj],attrs:n,ngContentSelectors:o,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(It,gt){1&It&&(C.F$t(),C.TgZ(0,"span",0),C.Hsn(1),C.qZA(),C._UZ(2,"span",1),C._UZ(3,"span",2)),2&It&&(C.xp6(2),C.ekj("mat-button-ripple-round",gt.isRoundButton||gt.isIconButton),C.Q6J("matRippleDisabled",gt._isRippleDisabled())("matRippleCentered",gt.isIconButton)("matRippleTrigger",gt._getHostElement()))},directives:[m.wG],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),et})(),nt=(()=>{class et{}return et.\u0275fac=function(It){return new(It||et)},et.\u0275mod=C.oAB({type:et}),et.\u0275inj=C.cJS({imports:[[m.si,m.BQ],m.BQ]}),et})()},90508:(B,X,_)=>{"use strict";_.d(X,{yN:()=>wt,mZ:()=>Ut,_A:()=>_e,rD:()=>Bt,sG:()=>ce,K7:()=>Ri,HF:()=>Ti,Y2:()=>ye,BQ:()=>at,X2:()=>Ie,uc:()=>Dt,XK:()=>Me,ey:()=>yi,Ng:()=>mn,rN:()=>De,nP:()=>We,us:()=>$e,wG:()=>Kt,si:()=>Zt,IR:()=>Oe,CB:()=>Fi,jH:()=>Ni,pj:()=>yt,Kr:()=>ct,Id:()=>Mt,FD:()=>se,sb:()=>rt,E0:()=>Xt});var C=_(5e3),m=_(50226),t=_(69808),n=_(70925),o=_(15664),r=_(63191),a=_(77579),h=_(68675),R=_(76360),L=_(91159);function et(si,Ce){if(1&si&&C._UZ(0,"mat-pseudo-checkbox",4),2&si){const Vt=C.oxw();C.Q6J("state",Vt.selected?"checked":"unchecked")("disabled",Vt.disabled)}}function Et(si,Ce){if(1&si&&(C.TgZ(0,"span",5),C._uU(1),C.qZA()),2&si){const Vt=C.oxw();C.xp6(1),C.hij("(",Vt.group.label,")")}}const It=["*"];let wt=(()=>{class si{}return si.STANDARD_CURVE="cubic-bezier(0.4,0.0,0.2,1)",si.DECELERATION_CURVE="cubic-bezier(0.0,0.0,0.2,1)",si.ACCELERATION_CURVE="cubic-bezier(0.4,0.0,1,1)",si.SHARP_CURVE="cubic-bezier(0.4,0.0,0.6,1)",si})(),Ut=(()=>{class si{}return si.COMPLEX="375ms",si.ENTERING="225ms",si.EXITING="195ms",si})();const bt=new C.OlP("mat-sanity-checks",{providedIn:"root",factory:function Ct(){return!0}});let at=(()=>{class si{constructor(Vt,vt,Gt){this._sanityChecks=vt,this._document=Gt,this._hasDoneGlobalChecks=!1,Vt._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(Vt){return!(0,n.Oy)()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[Vt])}}return si.\u0275fac=function(Vt){return new(Vt||si)(C.LFG(o.qm),C.LFG(bt,8),C.LFG(t.K0))},si.\u0275mod=C.oAB({type:si}),si.\u0275inj=C.cJS({imports:[[m.vT],m.vT]}),si})();function Mt(si){return class extends si{constructor(...Ce){super(...Ce),this._disabled=!1}get disabled(){return this._disabled}set disabled(Ce){this._disabled=(0,r.Ig)(Ce)}}}function yt(si,Ce){return class extends si{constructor(...Vt){super(...Vt),this.defaultColor=Ce,this.color=Ce}get color(){return this._color}set color(Vt){const vt=Vt||this.defaultColor;vt!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),vt&&this._elementRef.nativeElement.classList.add(`mat-${vt}`),this._color=vt)}}}function ct(si){return class extends si{constructor(...Ce){super(...Ce),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(Ce){this._disableRipple=(0,r.Ig)(Ce)}}}function rt(si,Ce=0){return class extends si{constructor(...Vt){super(...Vt),this._tabIndex=Ce,this.defaultTabIndex=Ce}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(Vt){this._tabIndex=null!=Vt?(0,r.su)(Vt):this.defaultTabIndex}}}function se(si){return class extends si{constructor(...Ce){super(...Ce),this.stateChanges=new a.x,this.errorState=!1}updateErrorState(){const Ce=this.errorState,fe=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);fe!==Ce&&(this.errorState=fe,this.stateChanges.next())}}}const Lt=new C.OlP("MAT_DATE_LOCALE",{providedIn:"root",factory:function de(){return(0,C.f3M)(C.soG)}});class _e{constructor(){this._localeChanges=new a.x,this.localeChanges=this._localeChanges}getValidDateOrNull(Ce){return this.isDateInstance(Ce)&&this.isValid(Ce)?Ce:null}deserialize(Ce){return null==Ce||this.isDateInstance(Ce)&&this.isValid(Ce)?Ce:this.invalid()}setLocale(Ce){this.locale=Ce,this._localeChanges.next()}compareDate(Ce,Vt){return this.getYear(Ce)-this.getYear(Vt)||this.getMonth(Ce)-this.getMonth(Vt)||this.getDate(Ce)-this.getDate(Vt)}sameDate(Ce,Vt){if(Ce&&Vt){let vt=this.isValid(Ce),Gt=this.isValid(Vt);return vt&&Gt?!this.compareDate(Ce,Vt):vt==Gt}return Ce==Vt}clampDate(Ce,Vt,vt){return Vt&&this.compareDate(Ce,Vt)<0?Vt:vt&&this.compareDate(Ce,vt)>0?vt:Ce}}const ce=new C.OlP("mat-date-formats"),Ae=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function Ne(si,Ce){const Vt=Array(si);for(let vt=0;vt<si;vt++)Vt[vt]=Ce(vt);return Vt}let qe=(()=>{class si extends _e{constructor(Vt,vt){super(),this.useUtcForDisplay=!1,super.setLocale(Vt)}getYear(Vt){return Vt.getFullYear()}getMonth(Vt){return Vt.getMonth()}getDate(Vt){return Vt.getDate()}getDayOfWeek(Vt){return Vt.getDay()}getMonthNames(Vt){const vt=new Intl.DateTimeFormat(this.locale,{month:Vt,timeZone:"utc"});return Ne(12,Gt=>this._format(vt,new Date(2017,Gt,1)))}getDateNames(){const Vt=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return Ne(31,vt=>this._format(Vt,new Date(2017,0,vt+1)))}getDayOfWeekNames(Vt){const vt=new Intl.DateTimeFormat(this.locale,{weekday:Vt,timeZone:"utc"});return Ne(7,Gt=>this._format(vt,new Date(2017,0,Gt+1)))}getYearName(Vt){const vt=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(vt,Vt)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(Vt){return this.getDate(this._createDateWithOverflow(this.getYear(Vt),this.getMonth(Vt)+1,0))}clone(Vt){return new Date(Vt.getTime())}createDate(Vt,vt,Gt){let fe=this._createDateWithOverflow(Vt,vt,Gt);return fe.getMonth(),fe}today(){return new Date}parse(Vt){return"number"==typeof Vt?new Date(Vt):Vt?new Date(Date.parse(Vt)):null}format(Vt,vt){if(!this.isValid(Vt))throw Error("NativeDateAdapter: Cannot format invalid date.");const Gt=new Intl.DateTimeFormat(this.locale,Object.assign(Object.assign({},vt),{timeZone:"utc"}));return this._format(Gt,Vt)}addCalendarYears(Vt,vt){return this.addCalendarMonths(Vt,12*vt)}addCalendarMonths(Vt,vt){let Gt=this._createDateWithOverflow(this.getYear(Vt),this.getMonth(Vt)+vt,this.getDate(Vt));return this.getMonth(Gt)!=((this.getMonth(Vt)+vt)%12+12)%12&&(Gt=this._createDateWithOverflow(this.getYear(Gt),this.getMonth(Gt),0)),Gt}addCalendarDays(Vt,vt){return this._createDateWithOverflow(this.getYear(Vt),this.getMonth(Vt),this.getDate(Vt)+vt)}toIso8601(Vt){return[Vt.getUTCFullYear(),this._2digit(Vt.getUTCMonth()+1),this._2digit(Vt.getUTCDate())].join("-")}deserialize(Vt){if("string"==typeof Vt){if(!Vt)return null;if(Ae.test(Vt)){let vt=new Date(Vt);if(this.isValid(vt))return vt}}return super.deserialize(Vt)}isDateInstance(Vt){return Vt instanceof Date}isValid(Vt){return!isNaN(Vt.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(Vt,vt,Gt){const fe=new Date;return fe.setFullYear(Vt,vt,Gt),fe.setHours(0,0,0,0),fe}_2digit(Vt){return("00"+Vt).slice(-2)}_format(Vt,vt){const Gt=new Date;return Gt.setUTCFullYear(vt.getFullYear(),vt.getMonth(),vt.getDate()),Gt.setUTCHours(vt.getHours(),vt.getMinutes(),vt.getSeconds(),vt.getMilliseconds()),Vt.format(Gt)}}return si.\u0275fac=function(Vt){return new(Vt||si)(C.LFG(Lt,8),C.LFG(n.t4))},si.\u0275prov=C.Yz7({token:si,factory:si.\u0275fac}),si})();const Di={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let ei=(()=>{class si{}return si.\u0275fac=function(Vt){return new(Vt||si)},si.\u0275mod=C.oAB({type:si}),si.\u0275inj=C.cJS({providers:[{provide:_e,useClass:qe}],imports:[[n.ud]]}),si})(),Me=(()=>{class si{}return si.\u0275fac=function(Vt){return new(Vt||si)},si.\u0275mod=C.oAB({type:si}),si.\u0275inj=C.cJS({providers:[{provide:ce,useValue:Di}],imports:[[ei]]}),si})(),Bt=(()=>{class si{isErrorState(Vt,vt){return!!(Vt&&Vt.invalid&&(Vt.touched||vt&&vt.submitted))}}return si.\u0275fac=function(Vt){return new(Vt||si)},si.\u0275prov=C.Yz7({token:si,factory:si.\u0275fac,providedIn:"root"}),si})(),Ie=(()=>{class si{}return si.\u0275fac=function(Vt){return new(Vt||si)},si.\u0275dir=C.lG2({type:si,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),si})();function Xt(si,Ce,Vt="mat"){si.changes.pipe((0,h.O)(si)).subscribe(({length:vt})=>{he(Ce,`${Vt}-2-line`,!1),he(Ce,`${Vt}-3-line`,!1),he(Ce,`${Vt}-multi-line`,!1),2===vt||3===vt?he(Ce,`${Vt}-${vt}-line`,!0):vt>3&&he(Ce,`${Vt}-multi-line`,!0)})}function he(si,Ce,Vt){si.nativeElement.classList.toggle(Ce,Vt)}let Dt=(()=>{class si{}return si.\u0275fac=function(Vt){return new(Vt||si)},si.\u0275mod=C.oAB({type:si}),si.\u0275inj=C.cJS({imports:[[at],at]}),si})();class ve{constructor(Ce,Vt,vt){this._renderer=Ce,this.element=Vt,this.config=vt,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const je={enterDuration:225,exitDuration:150},Ee=(0,n.i$)({passive:!0}),ne=["mousedown","touchstart"],ee=["mouseup","mouseleave","touchend","touchcancel"];class Oe{constructor(Ce,Vt,vt,Gt){this._target=Ce,this._ngZone=Vt,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,Gt.isBrowser&&(this._containerElement=(0,r.fI)(vt))}fadeInRipple(Ce,Vt,vt={}){const Gt=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),fe=Object.assign(Object.assign({},je),vt.animation);vt.centered&&(Ce=Gt.left+Gt.width/2,Vt=Gt.top+Gt.height/2);const He=vt.radius||function me(si,Ce,Vt){const vt=Math.max(Math.abs(si-Vt.left),Math.abs(si-Vt.right)),Gt=Math.max(Math.abs(Ce-Vt.top),Math.abs(Ce-Vt.bottom));return Math.sqrt(vt*vt+Gt*Gt)}(Ce,Vt,Gt),$i=Ce-Gt.left,tn=Vt-Gt.top,In=fe.enterDuration,no=document.createElement("div");no.classList.add("mat-ripple-element"),no.style.left=$i-He+"px",no.style.top=tn-He+"px",no.style.height=2*He+"px",no.style.width=2*He+"px",null!=vt.color&&(no.style.backgroundColor=vt.color),no.style.transitionDuration=`${In}ms`,this._containerElement.appendChild(no),function le(si){window.getComputedStyle(si).getPropertyValue("opacity")}(no),no.style.transform="scale(1)";const li=new ve(this,no,vt);return li.state=0,this._activeRipples.add(li),vt.persistent||(this._mostRecentTransientRipple=li),this._runTimeoutOutsideZone(()=>{const Je=li===this._mostRecentTransientRipple;li.state=1,!vt.persistent&&(!Je||!this._isPointerDown)&&li.fadeOut()},In),li}fadeOutRipple(Ce){const Vt=this._activeRipples.delete(Ce);if(Ce===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!Vt)return;const vt=Ce.element,Gt=Object.assign(Object.assign({},je),Ce.config.animation);vt.style.transitionDuration=`${Gt.exitDuration}ms`,vt.style.opacity="0",Ce.state=2,this._runTimeoutOutsideZone(()=>{Ce.state=3,vt.remove()},Gt.exitDuration)}fadeOutAll(){this._activeRipples.forEach(Ce=>Ce.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(Ce=>{Ce.config.persistent||Ce.fadeOut()})}setupTriggerEvents(Ce){const Vt=(0,r.fI)(Ce);!Vt||Vt===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=Vt,this._registerEvents(ne))}handleEvent(Ce){"mousedown"===Ce.type?this._onMousedown(Ce):"touchstart"===Ce.type?this._onTouchStart(Ce):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(ee),this._pointerUpEventsRegistered=!0)}_onMousedown(Ce){const Vt=(0,o.X6)(Ce),vt=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!Vt&&!vt&&(this._isPointerDown=!0,this.fadeInRipple(Ce.clientX,Ce.clientY,this._target.rippleConfig))}_onTouchStart(Ce){if(!this._target.rippleDisabled&&!(0,o.yG)(Ce)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const Vt=Ce.changedTouches;for(let vt=0;vt<Vt.length;vt++)this.fadeInRipple(Vt[vt].clientX,Vt[vt].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(Ce=>{!Ce.config.persistent&&(1===Ce.state||Ce.config.terminateOnPointerUp&&0===Ce.state)&&Ce.fadeOut()}))}_runTimeoutOutsideZone(Ce,Vt=0){this._ngZone.runOutsideAngular(()=>setTimeout(Ce,Vt))}_registerEvents(Ce){this._ngZone.runOutsideAngular(()=>{Ce.forEach(Vt=>{this._triggerElement.addEventListener(Vt,this,Ee)})})}_removeTriggerEvents(){this._triggerElement&&(ne.forEach(Ce=>{this._triggerElement.removeEventListener(Ce,this,Ee)}),this._pointerUpEventsRegistered&&ee.forEach(Ce=>{this._triggerElement.removeEventListener(Ce,this,Ee)}))}}const ye=new C.OlP("mat-ripple-global-options");let Kt=(()=>{class si{constructor(Vt,vt,Gt,fe,He){this._elementRef=Vt,this._animationMode=He,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=fe||{},this._rippleRenderer=new Oe(this,vt,Vt,Gt)}get disabled(){return this._disabled}set disabled(Vt){Vt&&this.fadeOutAllNonPersistent(),this._disabled=Vt,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(Vt){this._trigger=Vt,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(Vt,vt=0,Gt){return"number"==typeof Vt?this._rippleRenderer.fadeInRipple(Vt,vt,Object.assign(Object.assign({},this.rippleConfig),Gt)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),Vt))}}return si.\u0275fac=function(Vt){return new(Vt||si)(C.Y36(C.SBq),C.Y36(C.R0b),C.Y36(n.t4),C.Y36(ye,8),C.Y36(R.Qb,8))},si.\u0275dir=C.lG2({type:si,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(Vt,vt){2&Vt&&C.ekj("mat-ripple-unbounded",vt.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),si})(),Zt=(()=>{class si{}return si.\u0275fac=function(Vt){return new(Vt||si)},si.\u0275mod=C.oAB({type:si}),si.\u0275inj=C.cJS({imports:[[at,n.ud],at]}),si})(),We=(()=>{class si{constructor(Vt){this._animationMode=Vt,this.state="unchecked",this.disabled=!1}}return si.\u0275fac=function(Vt){return new(Vt||si)(C.Y36(R.Qb,8))},si.\u0275cmp=C.Xpm({type:si,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(Vt,vt){2&Vt&&C.ekj("mat-pseudo-checkbox-indeterminate","indeterminate"===vt.state)("mat-pseudo-checkbox-checked","checked"===vt.state)("mat-pseudo-checkbox-disabled",vt.disabled)("_mat-animation-noopable","NoopAnimations"===vt._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(Vt,vt){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:transparent}._mat-animation-noopable.mat-pseudo-checkbox{transition:none;animation:none}._mat-animation-noopable.mat-pseudo-checkbox::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}\n'],encapsulation:2,changeDetection:0}),si})(),$e=(()=>{class si{}return si.\u0275fac=function(Vt){return new(Vt||si)},si.\u0275mod=C.oAB({type:si}),si.\u0275inj=C.cJS({imports:[[at]]}),si})();const Ti=new C.OlP("MAT_OPTION_PARENT_COMPONENT"),Ri=new C.OlP("MatOptgroup");let ge=0;class De{constructor(Ce,Vt=!1){this.source=Ce,this.isUserInput=Vt}}let _i=(()=>{class si{constructor(Vt,vt,Gt,fe){this._element=Vt,this._changeDetectorRef=vt,this._parent=Gt,this.group=fe,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+ge++,this.onSelectionChange=new C.vpe,this._stateChanges=new a.x}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(Vt){this._disabled=(0,r.Ig)(Vt)}get disableRipple(){return this._parent&&this._parent.disableRipple}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(Vt,vt){const Gt=this._getHostElement();"function"==typeof Gt.focus&&Gt.focus(vt)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(Vt){(Vt.keyCode===L.K5||Vt.keyCode===L.L_)&&!(0,L.Vb)(Vt)&&(this._selectViaInteraction(),Vt.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const Vt=this.viewValue;Vt!==this._mostRecentViewValue&&(this._mostRecentViewValue=Vt,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(Vt=!1){this.onSelectionChange.emit(new De(this,Vt))}}return si.\u0275fac=function(Vt){C.$Z()},si.\u0275dir=C.lG2({type:si,inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),si})(),yi=(()=>{class si extends _i{constructor(Vt,vt,Gt,fe){super(Vt,vt,Gt,fe)}}return si.\u0275fac=function(Vt){return new(Vt||si)(C.Y36(C.SBq),C.Y36(C.sBO),C.Y36(Ti,8),C.Y36(Ri,8))},si.\u0275cmp=C.Xpm({type:si,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(Vt,vt){1&Vt&&C.NdJ("click",function(){return vt._selectViaInteraction()})("keydown",function(fe){return vt._handleKeydown(fe)}),2&Vt&&(C.Ikx("id",vt.id),C.uIk("tabindex",vt._getTabIndex())("aria-selected",vt._getAriaSelected())("aria-disabled",vt.disabled.toString()),C.ekj("mat-selected",vt.selected)("mat-option-multiple",vt.multiple)("mat-active",vt.active)("mat-option-disabled",vt.disabled))},exportAs:["matOption"],features:[C.qOj],ngContentSelectors:It,decls:5,vars:4,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"],[1,"cdk-visually-hidden"]],template:function(Vt,vt){1&Vt&&(C.F$t(),C.YNc(0,et,1,2,"mat-pseudo-checkbox",0),C.TgZ(1,"span",1),C.Hsn(2),C.qZA(),C.YNc(3,Et,2,1,"span",2),C._UZ(4,"div",3)),2&Vt&&(C.Q6J("ngIf",vt.multiple),C.xp6(3),C.Q6J("ngIf",vt.group&&vt.group._inert),C.xp6(1),C.Q6J("matRippleTrigger",vt._getHostElement())("matRippleDisabled",vt.disabled||vt.disableRipple))},directives:[t.O5,Kt,We],styles:[".mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:transparent}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.cdk-high-contrast-active .mat-option{margin:0 1px}.cdk-high-contrast-active .mat-option.mat-active{border:solid 1px currentColor;margin:0}.cdk-high-contrast-active .mat-option[aria-disabled=true]{opacity:.5}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),si})();function Fi(si,Ce,Vt){if(Vt.length){let vt=Ce.toArray(),Gt=Vt.toArray(),fe=0;for(let He=0;He<si+1;He++)vt[He].group&&vt[He].group===Gt[fe]&&fe++;return fe}return 0}function Ni(si,Ce,Vt,vt){return si<Vt?si:si+Ce>Vt+vt?Math.max(0,si-vt+Ce):Vt}let mn=(()=>{class si{}return si.\u0275fac=function(Vt){return new(Vt||si)},si.\u0275mod=C.oAB({type:si}),si.\u0275inj=C.cJS({imports:[[Zt,t.ez,at,$e]]}),si})()},48966:(B,X,_)=>{"use strict";_.d(X,{uw:()=>_e,Is:()=>ri,so:()=>Ft});var C=_(91314),m=_(47429),e=_(5e3),t=_(90508),n=_(50226),o=_(77579),r=_(49770),a=_(50727),h=_(39646),R=_(39300),L=_(95698),W=_(68675),nt=_(70925),et=_(69808),Et=_(41777),It=_(15664),gt=_(91159),wt=_(76360);function Ut(Bt,Ie){}class Jt{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0}}const Ct={dialogContainer:(0,Et.X$)("dialogContainer",[(0,Et.SB)("void, exit",(0,Et.oB)({opacity:0,transform:"scale(0.7)"})),(0,Et.SB)("enter",(0,Et.oB)({transform:"none"})),(0,Et.eR)("* => enter",(0,Et.jt)("150ms cubic-bezier(0, 0, 0.2, 1)",(0,Et.oB)({transform:"none",opacity:1}))),(0,Et.eR)("* => void, * => exit",(0,Et.jt)("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",(0,Et.oB)({opacity:0})))])};let at=(()=>{class Bt extends m.en{constructor(Xt,he,Dt,ve,je,gi,Ee,ne){super(),this._elementRef=Xt,this._focusTrapFactory=he,this._changeDetectorRef=Dt,this._config=je,this._interactivityChecker=gi,this._ngZone=Ee,this._focusMonitor=ne,this._animationStateChanged=new e.vpe,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=ee=>(this._portalOutlet.hasAttached(),this._portalOutlet.attachDomPortal(ee)),this._ariaLabelledBy=je.ariaLabelledBy||null,this._document=ve}_initializeWithAttachedContent(){this._setupFocusTrap(),this._capturePreviouslyFocusedElement()}attachComponentPortal(Xt){return this._portalOutlet.hasAttached(),this._portalOutlet.attachComponentPortal(Xt)}attachTemplatePortal(Xt){return this._portalOutlet.hasAttached(),this._portalOutlet.attachTemplatePortal(Xt)}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(Xt,he){this._interactivityChecker.isFocusable(Xt)||(Xt.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{Xt.addEventListener("blur",()=>Xt.removeAttribute("tabindex")),Xt.addEventListener("mousedown",()=>Xt.removeAttribute("tabindex"))})),Xt.focus(he)}_focusByCssSelector(Xt,he){let Dt=this._elementRef.nativeElement.querySelector(Xt);Dt&&this._forceFocus(Dt,he)}_trapFocus(){const Xt=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||Xt.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(he=>{he||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const Xt=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&Xt&&"function"==typeof Xt.focus){const he=(0,nt.ht)(),Dt=this._elementRef.nativeElement;(!he||he===this._document.body||he===Dt||Dt.contains(he))&&(this._focusMonitor?(this._focusMonitor.focusVia(Xt,this._closeInteractionType),this._closeInteractionType=null):Xt.focus())}this._focusTrap&&this._focusTrap.destroy()}_setupFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)}_capturePreviouslyFocusedElement(){this._document&&(this._elementFocusedBeforeDialogWasOpened=(0,nt.ht)())}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const Xt=this._elementRef.nativeElement,he=(0,nt.ht)();return Xt===he||Xt.contains(he)}}return Bt.\u0275fac=function(Xt){return new(Xt||Bt)(e.Y36(e.SBq),e.Y36(It.qV),e.Y36(e.sBO),e.Y36(et.K0,8),e.Y36(Jt),e.Y36(It.ic),e.Y36(e.R0b),e.Y36(It.tE))},Bt.\u0275dir=e.lG2({type:Bt,viewQuery:function(Xt,he){if(1&Xt&&e.Gf(m.Pl,7),2&Xt){let Dt;e.iGM(Dt=e.CRH())&&(he._portalOutlet=Dt.first)}},features:[e.qOj]}),Bt})(),ft=(()=>{class Bt extends at{constructor(){super(...arguments),this._state="enter"}_onAnimationDone({toState:Xt,totalTime:he}){"enter"===Xt?(this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:he})):"exit"===Xt&&(this._restoreFocus(),this._animationStateChanged.next({state:"closed",totalTime:he}))}_onAnimationStart({toState:Xt,totalTime:he}){"enter"===Xt?this._animationStateChanged.next({state:"opening",totalTime:he}):("exit"===Xt||"void"===Xt)&&this._animationStateChanged.next({state:"closing",totalTime:he})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}}return Bt.\u0275fac=function(){let Ie;return function(he){return(Ie||(Ie=e.n5z(Bt)))(he||Bt)}}(),Bt.\u0275cmp=e.Xpm({type:Bt,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(Xt,he){1&Xt&&e.WFA("@dialogContainer.start",function(ve){return he._onAnimationStart(ve)})("@dialogContainer.done",function(ve){return he._onAnimationDone(ve)}),2&Xt&&(e.Ikx("id",he._id),e.uIk("role",he._config.role)("aria-labelledby",he._config.ariaLabel?null:he._ariaLabelledBy)("aria-label",he._config.ariaLabel)("aria-describedby",he._config.ariaDescribedBy||null),e.d8E("@dialogContainer",he._state))},features:[e.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(Xt,he){1&Xt&&e.YNc(0,Ut,0,0,"ng-template",0)},directives:[m.Pl],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[Ct.dialogContainer]}}),Bt})(),lt=0;class Ft{constructor(Ie,Xt,he="mat-dialog-"+lt++){this._overlayRef=Ie,this._containerInstance=Xt,this.id=he,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new o.x,this._afterClosed=new o.x,this._beforeClosed=new o.x,this._state=0,Xt._id=he,Xt._animationStateChanged.pipe((0,R.h)(Dt=>"opened"===Dt.state),(0,L.q)(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),Xt._animationStateChanged.pipe((0,R.h)(Dt=>"closed"===Dt.state),(0,L.q)(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),Ie.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),Ie.keydownEvents().pipe((0,R.h)(Dt=>Dt.keyCode===gt.hY&&!this.disableClose&&!(0,gt.Vb)(Dt))).subscribe(Dt=>{Dt.preventDefault(),Mt(this,"keyboard")}),Ie.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():Mt(this,"mouse")})}close(Ie){this._result=Ie,this._containerInstance._animationStateChanged.pipe((0,R.h)(Xt=>"closing"===Xt.state),(0,L.q)(1)).subscribe(Xt=>{this._beforeClosed.next(Ie),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),Xt.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._afterClosed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(Ie){let Xt=this._getPositionStrategy();return Ie&&(Ie.left||Ie.right)?Ie.left?Xt.left(Ie.left):Xt.right(Ie.right):Xt.centerHorizontally(),Ie&&(Ie.top||Ie.bottom)?Ie.top?Xt.top(Ie.top):Xt.bottom(Ie.bottom):Xt.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(Ie="",Xt=""){return this._overlayRef.updateSize({width:Ie,height:Xt}),this._overlayRef.updatePosition(),this}addPanelClass(Ie){return this._overlayRef.addPanelClass(Ie),this}removePanelClass(Ie){return this._overlayRef.removePanelClass(Ie),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function Mt(Bt,Ie,Xt){return void 0!==Bt._containerInstance&&(Bt._containerInstance._closeInteractionType=Ie),Bt.close(Xt)}const yt=new e.OlP("MatDialogData"),ct=new e.OlP("mat-dialog-default-options"),rt=new e.OlP("mat-dialog-scroll-strategy"),Lt={provide:rt,deps:[C.aV],useFactory:function xt(Bt){return()=>Bt.scrollStrategies.block()}};let de=(()=>{class Bt{constructor(Xt,he,Dt,ve,je,gi,Ee,ne,ee,Oe){this._overlay=Xt,this._injector=he,this._defaultOptions=Dt,this._parentDialog=ve,this._overlayContainer=je,this._dialogRefConstructor=Ee,this._dialogContainerType=ne,this._dialogDataToken=ee,this._animationMode=Oe,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new o.x,this._afterOpenedAtThisLevel=new o.x,this._ariaHiddenElements=new Map,this._dialogAnimatingOpen=!1,this.afterAllClosed=(0,r.P)(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe((0,W.O)(void 0))),this._scrollStrategy=gi}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const Xt=this._parentDialog;return Xt?Xt._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(Xt,he){if(he=function ce(Bt,Ie){return Object.assign(Object.assign({},Ie),Bt)}(he,this._defaultOptions||new Jt),he.id&&this.getDialogById(he.id),this._dialogAnimatingOpen)return this._lastDialogRef;const Dt=this._createOverlay(he),ve=this._attachDialogContainer(Dt,he);if("NoopAnimations"!==this._animationMode){const gi=ve._animationStateChanged.subscribe(Ee=>{"opening"===Ee.state&&(this._dialogAnimatingOpen=!0),"opened"===Ee.state&&(this._dialogAnimatingOpen=!1,gi.unsubscribe())});this._animationStateSubscriptions||(this._animationStateSubscriptions=new a.w0),this._animationStateSubscriptions.add(gi)}const je=this._attachDialogContent(Xt,ve,Dt,he);return this._lastDialogRef=je,this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(je),je.afterClosed().subscribe(()=>this._removeOpenDialog(je)),this.afterOpened.next(je),ve._initializeWithAttachedContent(),je}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(Xt){return this.openDialogs.find(he=>he.id===Xt)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._animationStateSubscriptions&&this._animationStateSubscriptions.unsubscribe()}_createOverlay(Xt){const he=this._getOverlayConfig(Xt);return this._overlay.create(he)}_getOverlayConfig(Xt){const he=new C.X_({positionStrategy:this._overlay.position().global(),scrollStrategy:Xt.scrollStrategy||this._scrollStrategy(),panelClass:Xt.panelClass,hasBackdrop:Xt.hasBackdrop,direction:Xt.direction,minWidth:Xt.minWidth,minHeight:Xt.minHeight,maxWidth:Xt.maxWidth,maxHeight:Xt.maxHeight,disposeOnNavigation:Xt.closeOnNavigation});return Xt.backdropClass&&(he.backdropClass=Xt.backdropClass),he}_attachDialogContainer(Xt,he){const ve=e.zs3.create({parent:he&&he.viewContainerRef&&he.viewContainerRef.injector||this._injector,providers:[{provide:Jt,useValue:he}]}),je=new m.C5(this._dialogContainerType,he.viewContainerRef,ve,he.componentFactoryResolver);return Xt.attach(je).instance}_attachDialogContent(Xt,he,Dt,ve){const je=new this._dialogRefConstructor(Dt,he,ve.id);if(Xt instanceof e.Rgc)he.attachTemplatePortal(new m.UE(Xt,null,{$implicit:ve.data,dialogRef:je}));else{const gi=this._createInjector(ve,je,he),Ee=he.attachComponentPortal(new m.C5(Xt,ve.viewContainerRef,gi));je.componentInstance=Ee.instance}return je.updateSize(ve.width,ve.height).updatePosition(ve.position),je}_createInjector(Xt,he,Dt){const ve=Xt&&Xt.viewContainerRef&&Xt.viewContainerRef.injector,je=[{provide:this._dialogContainerType,useValue:Dt},{provide:this._dialogDataToken,useValue:Xt.data},{provide:this._dialogRefConstructor,useValue:he}];return Xt.direction&&(!ve||!ve.get(n.Is,null,e.XFs.Optional))&&je.push({provide:n.Is,useValue:{value:Xt.direction,change:(0,h.of)()}}),e.zs3.create({parent:ve||this._injector,providers:je})}_removeOpenDialog(Xt){const he=this.openDialogs.indexOf(Xt);he>-1&&(this.openDialogs.splice(he,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((Dt,ve)=>{Dt?ve.setAttribute("aria-hidden",Dt):ve.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const Xt=this._overlayContainer.getContainerElement();if(Xt.parentElement){const he=Xt.parentElement.children;for(let Dt=he.length-1;Dt>-1;Dt--){let ve=he[Dt];ve!==Xt&&"SCRIPT"!==ve.nodeName&&"STYLE"!==ve.nodeName&&!ve.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(ve,ve.getAttribute("aria-hidden")),ve.setAttribute("aria-hidden","true"))}}}_closeDialogs(Xt){let he=Xt.length;for(;he--;)Xt[he].close()}}return Bt.\u0275fac=function(Xt){e.$Z()},Bt.\u0275dir=e.lG2({type:Bt}),Bt})(),_e=(()=>{class Bt extends de{constructor(Xt,he,Dt,ve,je,gi,Ee,ne){super(Xt,he,ve,gi,Ee,je,Ft,ft,yt,ne)}}return Bt.\u0275fac=function(Xt){return new(Xt||Bt)(e.LFG(C.aV),e.LFG(e.zs3),e.LFG(et.Ye,8),e.LFG(ct,8),e.LFG(rt),e.LFG(Bt,12),e.LFG(C.Xj),e.LFG(wt.Qb,8))},Bt.\u0275prov=e.Yz7({token:Bt,factory:Bt.\u0275fac}),Bt})(),ri=(()=>{class Bt{}return Bt.\u0275fac=function(Xt){return new(Xt||Bt)},Bt.\u0275mod=e.oAB({type:Bt}),Bt.\u0275inj=e.cJS({providers:[_e,Lt],imports:[[C.U8,m.eL,t.BQ],t.BQ]}),Bt})()},4834:(B,X,_)=>{"use strict";_.d(X,{d:()=>t,t:()=>n});var C=_(5e3),m=_(63191),e=_(90508);let t=(()=>{class o{constructor(){this._vertical=!1,this._inset=!1}get vertical(){return this._vertical}set vertical(a){this._vertical=(0,m.Ig)(a)}get inset(){return this._inset}set inset(a){this._inset=(0,m.Ig)(a)}}return o.\u0275fac=function(a){return new(a||o)},o.\u0275cmp=C.Xpm({type:o,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(a,h){2&a&&(C.uIk("aria-orientation",h.vertical?"vertical":"horizontal"),C.ekj("mat-divider-vertical",h.vertical)("mat-divider-horizontal",!h.vertical)("mat-divider-inset",h.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(a,h){},styles:[".mat-divider{display:block;margin:0;border-top-width:1px;border-top-style:solid}.mat-divider.mat-divider-vertical{border-top:0;border-right-width:1px;border-right-style:solid}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}\n"],encapsulation:2,changeDetection:0}),o})(),n=(()=>{class o{}return o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=C.oAB({type:o}),o.\u0275inj=C.cJS({imports:[[e.BQ],e.BQ]}),o})()},67322:(B,X,_)=>{"use strict";_.d(X,{G_:()=>ee,KE:()=>Oe,Eo:()=>ce,lN:()=>le,hX:()=>ri});var C=_(17144),m=_(69808),e=_(5e3),t=_(90508),n=_(63191),o=_(77579),r=_(56451),a=_(54968),h=_(68675),R=_(82722),L=_(95698),W=_(41777),nt=_(76360),et=_(50226),Et=_(70925);const It=["connectionContainer"],gt=["inputContainer"],wt=["label"];function Ut(me,ye){1&me&&(e.ynx(0),e.TgZ(1,"div",14),e._UZ(2,"div",15),e._UZ(3,"div",16),e._UZ(4,"div",17),e.qZA(),e.TgZ(5,"div",18),e._UZ(6,"div",15),e._UZ(7,"div",16),e._UZ(8,"div",17),e.qZA(),e.BQk())}function Jt(me,ye){if(1&me){const Kt=e.EpF();e.TgZ(0,"div",19),e.NdJ("cdkObserveContent",function(){return e.CHM(Kt),e.oxw().updateOutlineGap()}),e.Hsn(1,1),e.qZA()}if(2&me){const Kt=e.oxw();e.Q6J("cdkObserveContentDisabled","outline"!=Kt.appearance)}}function Ct(me,ye){if(1&me&&(e.ynx(0),e.Hsn(1,2),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.BQk()),2&me){const Kt=e.oxw(2);e.xp6(3),e.Oqu(Kt._control.placeholder)}}function bt(me,ye){1&me&&e.Hsn(0,3,["*ngSwitchCase","true"])}function at(me,ye){1&me&&(e.TgZ(0,"span",23),e._uU(1," *"),e.qZA())}function ft(me,ye){if(1&me){const Kt=e.EpF();e.TgZ(0,"label",20,21),e.NdJ("cdkObserveContent",function(){return e.CHM(Kt),e.oxw().updateOutlineGap()}),e.YNc(2,Ct,4,1,"ng-container",12),e.YNc(3,bt,1,0,"ng-content",12),e.YNc(4,at,2,0,"span",22),e.qZA()}if(2&me){const Kt=e.oxw();e.ekj("mat-empty",Kt._control.empty&&!Kt._shouldAlwaysFloat())("mat-form-field-empty",Kt._control.empty&&!Kt._shouldAlwaysFloat())("mat-accent","accent"==Kt.color)("mat-warn","warn"==Kt.color),e.Q6J("cdkObserveContentDisabled","outline"!=Kt.appearance)("id",Kt._labelId)("ngSwitch",Kt._hasLabel()),e.uIk("for",Kt._control.id)("aria-owns",Kt._control.id),e.xp6(2),e.Q6J("ngSwitchCase",!1),e.xp6(1),e.Q6J("ngSwitchCase",!0),e.xp6(1),e.Q6J("ngIf",!Kt.hideRequiredMarker&&Kt._control.required&&!Kt._control.disabled)}}function lt(me,ye){1&me&&(e.TgZ(0,"div",24),e.Hsn(1,4),e.qZA())}function Ft(me,ye){if(1&me&&(e.TgZ(0,"div",25),e._UZ(1,"span",26),e.qZA()),2&me){const Kt=e.oxw();e.xp6(1),e.ekj("mat-accent","accent"==Kt.color)("mat-warn","warn"==Kt.color)}}function Mt(me,ye){if(1&me&&(e.TgZ(0,"div"),e.Hsn(1,5),e.qZA()),2&me){const Kt=e.oxw();e.Q6J("@transitionMessages",Kt._subscriptAnimationState)}}function yt(me,ye){if(1&me&&(e.TgZ(0,"div",30),e._uU(1),e.qZA()),2&me){const Kt=e.oxw(2);e.Q6J("id",Kt._hintLabelId),e.xp6(1),e.Oqu(Kt.hintLabel)}}function ct(me,ye){if(1&me&&(e.TgZ(0,"div",27),e.YNc(1,yt,2,2,"div",28),e.Hsn(2,6),e._UZ(3,"div",29),e.Hsn(4,7),e.qZA()),2&me){const Kt=e.oxw();e.Q6J("@transitionMessages",Kt._subscriptAnimationState),e.xp6(1),e.Q6J("ngIf",Kt.hintLabel)}}const rt=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],se=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],Lt=new e.OlP("MatError"),_e={transitionMessages:(0,W.X$)("transitionMessages",[(0,W.SB)("enter",(0,W.oB)({opacity:1,transform:"translateY(0%)"})),(0,W.eR)("void => enter",[(0,W.oB)({opacity:0,transform:"translateY(-5px)"}),(0,W.jt)("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let ce=(()=>{class me{}return me.\u0275fac=function(Kt){return new(Kt||me)},me.\u0275dir=e.lG2({type:me}),me})();const ei=new e.OlP("MatHint");let ri=(()=>{class me{}return me.\u0275fac=function(Kt){return new(Kt||me)},me.\u0275dir=e.lG2({type:me,selectors:[["mat-label"]]}),me})(),Bt=(()=>{class me{}return me.\u0275fac=function(Kt){return new(Kt||me)},me.\u0275dir=e.lG2({type:me,selectors:[["mat-placeholder"]]}),me})();const Ie=new e.OlP("MatPrefix"),he=new e.OlP("MatSuffix");let ve=0;const Ee=(0,t.pj)(class{constructor(me){this._elementRef=me}},"primary"),ne=new e.OlP("MAT_FORM_FIELD_DEFAULT_OPTIONS"),ee=new e.OlP("MatFormField");let Oe=(()=>{class me extends Ee{constructor(Kt,Zt,We,$e,Ti,vi,di){super(Kt),this._changeDetectorRef=Zt,this._dir=We,this._defaults=$e,this._platform=Ti,this._ngZone=vi,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new o.x,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+ve++,this._labelId="mat-form-field-label-"+ve++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==di,this.appearance=$e&&$e.appearance?$e.appearance:"legacy",this._hideRequiredMarker=!(!$e||null==$e.hideRequiredMarker)&&$e.hideRequiredMarker}get appearance(){return this._appearance}set appearance(Kt){const Zt=this._appearance;this._appearance=Kt||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&Zt!==Kt&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(Kt){this._hideRequiredMarker=(0,n.Ig)(Kt)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(Kt){this._hintLabel=Kt,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(Kt){Kt!==this._floatLabel&&(this._floatLabel=Kt||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(Kt){this._explicitFormFieldControl=Kt}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const Kt=this._control;Kt.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${Kt.controlType}`),Kt.stateChanges.pipe((0,h.O)(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),Kt.ngControl&&Kt.ngControl.valueChanges&&Kt.ngControl.valueChanges.pipe((0,R.R)(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,R.R)(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),(0,r.T)(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe((0,h.O)(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe((0,h.O)(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe((0,R.R)(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(Kt){const Zt=this._control?this._control.ngControl:null;return Zt&&Zt[Kt]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,(0,a.R)(this._label.nativeElement,"transitionend").pipe((0,L.q)(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let Kt=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&Kt.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const Zt=this._hintChildren?this._hintChildren.find($e=>"start"===$e.align):null,We=this._hintChildren?this._hintChildren.find($e=>"end"===$e.align):null;Zt?Kt.push(Zt.id):this._hintLabel&&Kt.push(this._hintLabelId),We&&Kt.push(We.id)}else this._errorChildren&&Kt.push(...this._errorChildren.map(Zt=>Zt.id));this._control.setDescribedByIds(Kt)}}_validateControlChild(){}updateOutlineGap(){const Kt=this._label?this._label.nativeElement:null;if(!("outline"===this.appearance&&Kt&&Kt.children.length&&Kt.textContent.trim()&&this._platform.isBrowser))return;if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let Zt=0,We=0;const $e=this._connectionContainerRef.nativeElement,Ti=$e.querySelectorAll(".mat-form-field-outline-start"),vi=$e.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){const di=$e.getBoundingClientRect();if(0===di.width&&0===di.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const Gi=this._getStartEnd(di),Ri=Kt.children,rn=this._getStartEnd(Ri[0].getBoundingClientRect());let ge=0;for(let De=0;De<Ri.length;De++)ge+=Ri[De].offsetWidth;Zt=Math.abs(rn-Gi)-5,We=ge>0?.75*ge+10:0}for(let di=0;di<Ti.length;di++)Ti[di].style.width=`${Zt}px`;for(let di=0;di<vi.length;di++)vi[di].style.width=`${We}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(Kt){return this._dir&&"rtl"===this._dir.value?Kt.right:Kt.left}_isAttachedToDOM(){const Kt=this._elementRef.nativeElement;if(Kt.getRootNode){const Zt=Kt.getRootNode();return Zt&&Zt!==Kt}return document.documentElement.contains(Kt)}}return me.\u0275fac=function(Kt){return new(Kt||me)(e.Y36(e.SBq),e.Y36(e.sBO),e.Y36(et.Is,8),e.Y36(ne,8),e.Y36(Et.t4),e.Y36(e.R0b),e.Y36(nt.Qb,8))},me.\u0275cmp=e.Xpm({type:me,selectors:[["mat-form-field"]],contentQueries:function(Kt,Zt,We){if(1&Kt&&(e.Suo(We,ce,5),e.Suo(We,ce,7),e.Suo(We,ri,5),e.Suo(We,ri,7),e.Suo(We,Bt,5),e.Suo(We,Lt,5),e.Suo(We,ei,5),e.Suo(We,Ie,5),e.Suo(We,he,5)),2&Kt){let $e;e.iGM($e=e.CRH())&&(Zt._controlNonStatic=$e.first),e.iGM($e=e.CRH())&&(Zt._controlStatic=$e.first),e.iGM($e=e.CRH())&&(Zt._labelChildNonStatic=$e.first),e.iGM($e=e.CRH())&&(Zt._labelChildStatic=$e.first),e.iGM($e=e.CRH())&&(Zt._placeholderChild=$e.first),e.iGM($e=e.CRH())&&(Zt._errorChildren=$e),e.iGM($e=e.CRH())&&(Zt._hintChildren=$e),e.iGM($e=e.CRH())&&(Zt._prefixChildren=$e),e.iGM($e=e.CRH())&&(Zt._suffixChildren=$e)}},viewQuery:function(Kt,Zt){if(1&Kt&&(e.Gf(It,7),e.Gf(gt,5),e.Gf(wt,5)),2&Kt){let We;e.iGM(We=e.CRH())&&(Zt._connectionContainerRef=We.first),e.iGM(We=e.CRH())&&(Zt._inputContainerRef=We.first),e.iGM(We=e.CRH())&&(Zt._label=We.first)}},hostAttrs:[1,"mat-form-field"],hostVars:40,hostBindings:function(Kt,Zt){2&Kt&&e.ekj("mat-form-field-appearance-standard","standard"==Zt.appearance)("mat-form-field-appearance-fill","fill"==Zt.appearance)("mat-form-field-appearance-outline","outline"==Zt.appearance)("mat-form-field-appearance-legacy","legacy"==Zt.appearance)("mat-form-field-invalid",Zt._control.errorState)("mat-form-field-can-float",Zt._canLabelFloat())("mat-form-field-should-float",Zt._shouldLabelFloat())("mat-form-field-has-label",Zt._hasFloatingLabel())("mat-form-field-hide-placeholder",Zt._hideControlPlaceholder())("mat-form-field-disabled",Zt._control.disabled)("mat-form-field-autofilled",Zt._control.autofilled)("mat-focused",Zt._control.focused)("ng-untouched",Zt._shouldForward("untouched"))("ng-touched",Zt._shouldForward("touched"))("ng-pristine",Zt._shouldForward("pristine"))("ng-dirty",Zt._shouldForward("dirty"))("ng-valid",Zt._shouldForward("valid"))("ng-invalid",Zt._shouldForward("invalid"))("ng-pending",Zt._shouldForward("pending"))("_mat-animation-noopable",!Zt._animationsEnabled)},inputs:{color:"color",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel",floatLabel:"floatLabel"},exportAs:["matFormField"],features:[e._Bn([{provide:ee,useExisting:me}]),e.qOj],ngContentSelectors:se,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(Kt,Zt){1&Kt&&(e.F$t(rt),e.TgZ(0,"div",0),e.TgZ(1,"div",1,2),e.NdJ("click",function($e){return Zt._control.onContainerClick&&Zt._control.onContainerClick($e)}),e.YNc(3,Ut,9,0,"ng-container",3),e.YNc(4,Jt,2,1,"div",4),e.TgZ(5,"div",5,6),e.Hsn(7),e.TgZ(8,"span",7),e.YNc(9,ft,5,16,"label",8),e.qZA(),e.qZA(),e.YNc(10,lt,2,0,"div",9),e.qZA(),e.YNc(11,Ft,2,4,"div",10),e.TgZ(12,"div",11),e.YNc(13,Mt,2,1,"div",12),e.YNc(14,ct,5,2,"div",13),e.qZA(),e.qZA()),2&Kt&&(e.xp6(3),e.Q6J("ngIf","outline"==Zt.appearance),e.xp6(1),e.Q6J("ngIf",Zt._prefixChildren.length),e.xp6(5),e.Q6J("ngIf",Zt._hasFloatingLabel()),e.xp6(1),e.Q6J("ngIf",Zt._suffixChildren.length),e.xp6(1),e.Q6J("ngIf","outline"!=Zt.appearance),e.xp6(1),e.Q6J("ngSwitch",Zt._getDisplayedMessages()),e.xp6(1),e.Q6J("ngSwitchCase","error"),e.xp6(1),e.Q6J("ngSwitchCase","hint"))},directives:[m.O5,m.RF,m.n9,C.wD],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:none;transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-form-field-flex{outline:dashed 3px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit;box-sizing:content-box}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element:not([type=password])::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{opacity:0}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px)}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border:3px dashed}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[_e.transitionMessages]},changeDetection:0}),me})(),le=(()=>{class me{}return me.\u0275fac=function(Kt){return new(Kt||me)},me.\u0275mod=e.oAB({type:me}),me.\u0275inj=e.cJS({imports:[[m.ez,t.BQ,C.Q8],t.BQ]}),me})()},43954:(B,X,_)=>{"use strict";_.d(X,{Il:()=>lt,N6:()=>Ft,DX:()=>W,jo:()=>Et,$H:()=>nt});var C=_(5e3),m=_(90508),e=_(63191),t=_(50226);const n=["*"],o=[[["","mat-grid-avatar",""],["","matGridAvatar",""]],[["","mat-line",""],["","matLine",""]],"*"],r=["[mat-grid-avatar], [matGridAvatar]","[mat-line], [matLine]","*"];class h{constructor(){this.columnIndex=0,this.rowIndex=0}get rowCount(){return this.rowIndex+1}get rowspan(){const ct=Math.max(...this.tracker);return ct>1?this.rowCount+ct-1:this.rowCount}update(ct,rt){this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(ct),this.tracker.fill(0,0,this.tracker.length),this.positions=rt.map(se=>this._trackTile(se))}_trackTile(ct){const rt=this._findMatchingGap(ct.colspan);return this._markTilePosition(rt,ct),this.columnIndex=rt+ct.colspan,new R(this.rowIndex,rt)}_findMatchingGap(ct){let rt=-1,se=-1;do{this.columnIndex+ct>this.tracker.length?(this._nextRow(),rt=this.tracker.indexOf(0,this.columnIndex),se=this._findGapEndIndex(rt)):(rt=this.tracker.indexOf(0,this.columnIndex),-1!=rt?(se=this._findGapEndIndex(rt),this.columnIndex=rt+1):(this._nextRow(),rt=this.tracker.indexOf(0,this.columnIndex),se=this._findGapEndIndex(rt)))}while(se-rt<ct||0==se);return Math.max(rt,0)}_nextRow(){this.columnIndex=0,this.rowIndex++;for(let ct=0;ct<this.tracker.length;ct++)this.tracker[ct]=Math.max(0,this.tracker[ct]-1)}_findGapEndIndex(ct){for(let rt=ct+1;rt<this.tracker.length;rt++)if(0!=this.tracker[rt])return rt;return this.tracker.length}_markTilePosition(ct,rt){for(let se=0;se<rt.colspan;se++)this.tracker[ct+se]=rt.rowspan}}class R{constructor(ct,rt){this.row=ct,this.col=rt}}const L=new C.OlP("MAT_GRID_LIST");let W=(()=>{class yt{constructor(rt,se){this._element=rt,this._gridList=se,this._rowspan=1,this._colspan=1}get rowspan(){return this._rowspan}set rowspan(rt){this._rowspan=Math.round((0,e.su)(rt))}get colspan(){return this._colspan}set colspan(rt){this._colspan=Math.round((0,e.su)(rt))}_setStyle(rt,se){this._element.nativeElement.style[rt]=se}}return yt.\u0275fac=function(rt){return new(rt||yt)(C.Y36(C.SBq),C.Y36(L,8))},yt.\u0275cmp=C.Xpm({type:yt,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(rt,se){2&rt&&C.uIk("rowspan",se.rowspan)("colspan",se.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],ngContentSelectors:n,decls:2,vars:0,consts:[[1,"mat-grid-tile-content"]],template:function(rt,se){1&rt&&(C.F$t(),C.TgZ(0,"div",0),C.Hsn(1),C.qZA())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}\n"],encapsulation:2,changeDetection:0}),yt})(),nt=(()=>{class yt{constructor(rt){this._element=rt}ngAfterContentInit(){(0,m.E0)(this._lines,this._element)}}return yt.\u0275fac=function(rt){return new(rt||yt)(C.Y36(C.SBq))},yt.\u0275cmp=C.Xpm({type:yt,selectors:[["mat-grid-tile-header"],["mat-grid-tile-footer"]],contentQueries:function(rt,se,xt){if(1&rt&&C.Suo(xt,m.X2,5),2&rt){let Lt;C.iGM(Lt=C.CRH())&&(se._lines=Lt)}},ngContentSelectors:r,decls:4,vars:0,consts:[[1,"mat-grid-list-text"]],template:function(rt,se){1&rt&&(C.F$t(o),C.Hsn(0),C.TgZ(1,"div",0),C.Hsn(2,1),C.qZA(),C.Hsn(3,2))},encapsulation:2,changeDetection:0}),yt})(),Et=(()=>{class yt{}return yt.\u0275fac=function(rt){return new(rt||yt)},yt.\u0275dir=C.lG2({type:yt,selectors:[["mat-grid-tile-header"]],hostAttrs:[1,"mat-grid-tile-header"]}),yt})();const gt=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/;class wt{constructor(){this._rows=0,this._rowspan=0}init(ct,rt,se,xt){this._gutterSize=at(ct),this._rows=rt.rowCount,this._rowspan=rt.rowspan,this._cols=se,this._direction=xt}getBaseTileSize(ct,rt){return`(${ct}% - (${this._gutterSize} * ${rt}))`}getTilePosition(ct,rt){return 0===rt?"0":bt(`(${ct} + ${this._gutterSize}) * ${rt}`)}getTileSize(ct,rt){return`(${ct} * ${rt}) + (${rt-1} * ${this._gutterSize})`}setStyle(ct,rt,se){let xt=100/this._cols,Lt=(this._cols-1)/this._cols;this.setColStyles(ct,se,xt,Lt),this.setRowStyles(ct,rt,xt,Lt)}setColStyles(ct,rt,se,xt){let Lt=this.getBaseTileSize(se,xt);ct._setStyle("rtl"===this._direction?"right":"left",this.getTilePosition(Lt,rt)),ct._setStyle("width",bt(this.getTileSize(Lt,ct.colspan)))}getGutterSpan(){return`${this._gutterSize} * (${this._rowspan} - 1)`}getTileSpan(ct){return`${this._rowspan} * ${this.getTileSize(ct,1)}`}getComputedHeight(){return null}}class Ut extends wt{constructor(ct){super(),this.fixedRowHeight=ct}init(ct,rt,se,xt){super.init(ct,rt,se,xt),this.fixedRowHeight=at(this.fixedRowHeight),gt.test(this.fixedRowHeight)}setRowStyles(ct,rt){ct._setStyle("top",this.getTilePosition(this.fixedRowHeight,rt)),ct._setStyle("height",bt(this.getTileSize(this.fixedRowHeight,ct.rowspan)))}getComputedHeight(){return["height",bt(`${this.getTileSpan(this.fixedRowHeight)} + ${this.getGutterSpan()}`)]}reset(ct){ct._setListStyle(["height",null]),ct._tiles&&ct._tiles.forEach(rt=>{rt._setStyle("top",null),rt._setStyle("height",null)})}}class Jt extends wt{constructor(ct){super(),this._parseRatio(ct)}setRowStyles(ct,rt,se,xt){this.baseTileHeight=this.getBaseTileSize(se/this.rowHeightRatio,xt),ct._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,rt)),ct._setStyle("paddingTop",bt(this.getTileSize(this.baseTileHeight,ct.rowspan)))}getComputedHeight(){return["paddingBottom",bt(`${this.getTileSpan(this.baseTileHeight)} + ${this.getGutterSpan()}`)]}reset(ct){ct._setListStyle(["paddingBottom",null]),ct._tiles.forEach(rt=>{rt._setStyle("marginTop",null),rt._setStyle("paddingTop",null)})}_parseRatio(ct){const rt=ct.split(":");this.rowHeightRatio=parseFloat(rt[0])/parseFloat(rt[1])}}class Ct extends wt{setRowStyles(ct,rt){let Lt=this.getBaseTileSize(100/this._rowspan,(this._rows-1)/this._rows);ct._setStyle("top",this.getTilePosition(Lt,rt)),ct._setStyle("height",bt(this.getTileSize(Lt,ct.rowspan)))}reset(ct){ct._tiles&&ct._tiles.forEach(rt=>{rt._setStyle("top",null),rt._setStyle("height",null)})}}function bt(yt){return`calc(${yt})`}function at(yt){return yt.match(/([A-Za-z%]+)$/)?yt:`${yt}px`}let lt=(()=>{class yt{constructor(rt,se){this._element=rt,this._dir=se,this._gutter="1px"}get cols(){return this._cols}set cols(rt){this._cols=Math.max(1,Math.round((0,e.su)(rt)))}get gutterSize(){return this._gutter}set gutterSize(rt){this._gutter=`${null==rt?"":rt}`}get rowHeight(){return this._rowHeight}set rowHeight(rt){const se=`${null==rt?"":rt}`;se!==this._rowHeight&&(this._rowHeight=se,this._setTileStyler(this._rowHeight))}ngOnInit(){this._checkCols(),this._checkRowHeight()}ngAfterContentChecked(){this._layoutTiles()}_checkCols(){}_checkRowHeight(){this._rowHeight||this._setTileStyler("1:1")}_setTileStyler(rt){this._tileStyler&&this._tileStyler.reset(this),this._tileStyler="fit"===rt?new Ct:rt&&rt.indexOf(":")>-1?new Jt(rt):new Ut(rt)}_layoutTiles(){this._tileCoordinator||(this._tileCoordinator=new h);const rt=this._tileCoordinator,se=this._tiles.filter(Lt=>!Lt._gridList||Lt._gridList===this),xt=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,se),this._tileStyler.init(this.gutterSize,rt,this.cols,xt),se.forEach((Lt,de)=>{const _e=rt.positions[de];this._tileStyler.setStyle(Lt,_e.row,_e.col)}),this._setListStyle(this._tileStyler.getComputedHeight())}_setListStyle(rt){rt&&(this._element.nativeElement.style[rt[0]]=rt[1])}}return yt.\u0275fac=function(rt){return new(rt||yt)(C.Y36(C.SBq),C.Y36(t.Is,8))},yt.\u0275cmp=C.Xpm({type:yt,selectors:[["mat-grid-list"]],contentQueries:function(rt,se,xt){if(1&rt&&C.Suo(xt,W,5),2&rt){let Lt;C.iGM(Lt=C.CRH())&&(se._tiles=Lt)}},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(rt,se){2&rt&&C.uIk("cols",se.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],features:[C._Bn([{provide:L,useExisting:yt}])],ngContentSelectors:n,decls:2,vars:0,template:function(rt,se){1&rt&&(C.F$t(),C.TgZ(0,"div"),C.Hsn(1),C.qZA())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}\n"],encapsulation:2,changeDetection:0}),yt})(),Ft=(()=>{class yt{}return yt.\u0275fac=function(rt){return new(rt||yt)},yt.\u0275mod=C.oAB({type:yt}),yt.\u0275inj=C.cJS({imports:[[m.uc,m.BQ],m.uc,m.BQ]}),yt})()},63874:(B,X,_)=>{"use strict";_.d(X,{Hw:()=>Di,Ps:()=>ei});var C=_(5e3),m=_(90508),e=_(63191),t=_(69808),n=_(68306),o=_(30576),a=_(39646),h=_(4128),R=_(50727),L=_(18505),W=_(54004),nt=_(70262),et=_(28746),Et=_(13099),It=_(95698),gt=_(40520),wt=_(22313);const Ut=["*"];let Jt;function bt(Me){var ri;return(null===(ri=function Ct(){if(void 0===Jt&&(Jt=null,"undefined"!=typeof window)){const Me=window;void 0!==Me.trustedTypes&&(Jt=Me.trustedTypes.createPolicy("angular#components",{createHTML:ri=>ri}))}return Jt}())||void 0===ri?void 0:ri.createHTML(Me))||Me}function at(Me){return Error(`Unable to find icon with the name "${Me}"`)}function lt(Me){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${Me}".`)}function Ft(Me){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${Me}".`)}class Mt{constructor(ri,Bt,Ie){this.url=ri,this.svgText=Bt,this.options=Ie}}let yt=(()=>{class Me{constructor(Bt,Ie,Xt,he){this._httpClient=Bt,this._sanitizer=Ie,this._errorHandler=he,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass="material-icons",this._document=Xt}addSvgIcon(Bt,Ie,Xt){return this.addSvgIconInNamespace("",Bt,Ie,Xt)}addSvgIconLiteral(Bt,Ie,Xt){return this.addSvgIconLiteralInNamespace("",Bt,Ie,Xt)}addSvgIconInNamespace(Bt,Ie,Xt,he){return this._addSvgIconConfig(Bt,Ie,new Mt(Xt,null,he))}addSvgIconResolver(Bt){return this._resolvers.push(Bt),this}addSvgIconLiteralInNamespace(Bt,Ie,Xt,he){const Dt=this._sanitizer.sanitize(C.q3G.HTML,Xt);if(!Dt)throw Ft(Xt);const ve=bt(Dt);return this._addSvgIconConfig(Bt,Ie,new Mt("",ve,he))}addSvgIconSet(Bt,Ie){return this.addSvgIconSetInNamespace("",Bt,Ie)}addSvgIconSetLiteral(Bt,Ie){return this.addSvgIconSetLiteralInNamespace("",Bt,Ie)}addSvgIconSetInNamespace(Bt,Ie,Xt){return this._addSvgIconSetConfig(Bt,new Mt(Ie,null,Xt))}addSvgIconSetLiteralInNamespace(Bt,Ie,Xt){const he=this._sanitizer.sanitize(C.q3G.HTML,Ie);if(!he)throw Ft(Ie);const Dt=bt(he);return this._addSvgIconSetConfig(Bt,new Mt("",Dt,Xt))}registerFontClassAlias(Bt,Ie=Bt){return this._fontCssClassesByAlias.set(Bt,Ie),this}classNameForFontAlias(Bt){return this._fontCssClassesByAlias.get(Bt)||Bt}setDefaultFontSetClass(Bt){return this._defaultFontSetClass=Bt,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(Bt){const Ie=this._sanitizer.sanitize(C.q3G.RESOURCE_URL,Bt);if(!Ie)throw lt(Bt);const Xt=this._cachedIconsByUrl.get(Ie);return Xt?(0,a.of)(se(Xt)):this._loadSvgIconFromConfig(new Mt(Bt,null)).pipe((0,L.b)(he=>this._cachedIconsByUrl.set(Ie,he)),(0,W.U)(he=>se(he)))}getNamedSvgIcon(Bt,Ie=""){const Xt=xt(Ie,Bt);let he=this._svgIconConfigs.get(Xt);if(he)return this._getSvgFromConfig(he);if(he=this._getIconConfigFromResolvers(Ie,Bt),he)return this._svgIconConfigs.set(Xt,he),this._getSvgFromConfig(he);const Dt=this._iconSetConfigs.get(Ie);return Dt?this._getSvgFromIconSetConfigs(Bt,Dt):function r(Me,ri){const Bt=(0,o.m)(Me)?Me:()=>Me,Ie=Xt=>Xt.error(Bt());return new n.y(ri?Xt=>ri.schedule(Ie,0,Xt):Ie)}(at(Xt))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(Bt){return Bt.svgText?(0,a.of)(se(this._svgElementFromConfig(Bt))):this._loadSvgIconFromConfig(Bt).pipe((0,W.U)(Ie=>se(Ie)))}_getSvgFromIconSetConfigs(Bt,Ie){const Xt=this._extractIconWithNameFromAnySet(Bt,Ie);if(Xt)return(0,a.of)(Xt);const he=Ie.filter(Dt=>!Dt.svgText).map(Dt=>this._loadSvgIconSetFromConfig(Dt).pipe((0,nt.K)(ve=>{const gi=`Loading icon set URL: ${this._sanitizer.sanitize(C.q3G.RESOURCE_URL,Dt.url)} failed: ${ve.message}`;return this._errorHandler.handleError(new Error(gi)),(0,a.of)(null)})));return(0,h.D)(he).pipe((0,W.U)(()=>{const Dt=this._extractIconWithNameFromAnySet(Bt,Ie);if(!Dt)throw at(Bt);return Dt}))}_extractIconWithNameFromAnySet(Bt,Ie){for(let Xt=Ie.length-1;Xt>=0;Xt--){const he=Ie[Xt];if(he.svgText&&he.svgText.toString().indexOf(Bt)>-1){const Dt=this._svgElementFromConfig(he),ve=this._extractSvgIconFromSet(Dt,Bt,he.options);if(ve)return ve}}return null}_loadSvgIconFromConfig(Bt){return this._fetchIcon(Bt).pipe((0,L.b)(Ie=>Bt.svgText=Ie),(0,W.U)(()=>this._svgElementFromConfig(Bt)))}_loadSvgIconSetFromConfig(Bt){return Bt.svgText?(0,a.of)(null):this._fetchIcon(Bt).pipe((0,L.b)(Ie=>Bt.svgText=Ie))}_extractSvgIconFromSet(Bt,Ie,Xt){const he=Bt.querySelector(`[id="${Ie}"]`);if(!he)return null;const Dt=he.cloneNode(!0);if(Dt.removeAttribute("id"),"svg"===Dt.nodeName.toLowerCase())return this._setSvgAttributes(Dt,Xt);if("symbol"===Dt.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(Dt),Xt);const ve=this._svgElementFromString(bt("<svg></svg>"));return ve.appendChild(Dt),this._setSvgAttributes(ve,Xt)}_svgElementFromString(Bt){const Ie=this._document.createElement("DIV");Ie.innerHTML=Bt;const Xt=Ie.querySelector("svg");if(!Xt)throw Error("<svg> tag not found");return Xt}_toSvgElement(Bt){const Ie=this._svgElementFromString(bt("<svg></svg>")),Xt=Bt.attributes;for(let he=0;he<Xt.length;he++){const{name:Dt,value:ve}=Xt[he];"id"!==Dt&&Ie.setAttribute(Dt,ve)}for(let he=0;he<Bt.childNodes.length;he++)Bt.childNodes[he].nodeType===this._document.ELEMENT_NODE&&Ie.appendChild(Bt.childNodes[he].cloneNode(!0));return Ie}_setSvgAttributes(Bt,Ie){return Bt.setAttribute("fit",""),Bt.setAttribute("height","100%"),Bt.setAttribute("width","100%"),Bt.setAttribute("preserveAspectRatio","xMidYMid meet"),Bt.setAttribute("focusable","false"),Ie&&Ie.viewBox&&Bt.setAttribute("viewBox",Ie.viewBox),Bt}_fetchIcon(Bt){var Ie;const{url:Xt,options:he}=Bt,Dt=null!==(Ie=null==he?void 0:he.withCredentials)&&void 0!==Ie&&Ie;if(!this._httpClient)throw function ft(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==Xt)throw Error(`Cannot fetch icon from URL "${Xt}".`);const ve=this._sanitizer.sanitize(C.q3G.RESOURCE_URL,Xt);if(!ve)throw lt(Xt);const je=this._inProgressUrlFetches.get(ve);if(je)return je;const gi=this._httpClient.get(ve,{responseType:"text",withCredentials:Dt}).pipe((0,W.U)(Ee=>bt(Ee)),(0,et.x)(()=>this._inProgressUrlFetches.delete(ve)),(0,Et.B)());return this._inProgressUrlFetches.set(ve,gi),gi}_addSvgIconConfig(Bt,Ie,Xt){return this._svgIconConfigs.set(xt(Bt,Ie),Xt),this}_addSvgIconSetConfig(Bt,Ie){const Xt=this._iconSetConfigs.get(Bt);return Xt?Xt.push(Ie):this._iconSetConfigs.set(Bt,[Ie]),this}_svgElementFromConfig(Bt){if(!Bt.svgElement){const Ie=this._svgElementFromString(Bt.svgText);this._setSvgAttributes(Ie,Bt.options),Bt.svgElement=Ie}return Bt.svgElement}_getIconConfigFromResolvers(Bt,Ie){for(let Xt=0;Xt<this._resolvers.length;Xt++){const he=this._resolvers[Xt](Ie,Bt);if(he)return Lt(he)?new Mt(he.url,null,he.options):new Mt(he,null)}}}return Me.\u0275fac=function(Bt){return new(Bt||Me)(C.LFG(gt.eN,8),C.LFG(wt.H7),C.LFG(t.K0,8),C.LFG(C.qLn))},Me.\u0275prov=C.Yz7({token:Me,factory:Me.\u0275fac,providedIn:"root"}),Me})();function se(Me){return Me.cloneNode(!0)}function xt(Me,ri){return Me+":"+ri}function Lt(Me){return!(!Me.url||!Me.options)}const de=(0,m.pj)(class{constructor(Me){this._elementRef=Me}}),_e=new C.OlP("mat-icon-location",{providedIn:"root",factory:function ce(){const Me=(0,C.f3M)(t.K0),ri=Me?Me.location:null;return{getPathname:()=>ri?ri.pathname+ri.search:""}}}),Ae=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Ne=Ae.map(Me=>`[${Me}]`).join(", "),qe=/^url\(['"]?#(.*?)['"]?\)$/;let Di=(()=>{class Me extends de{constructor(Bt,Ie,Xt,he,Dt){super(Bt),this._iconRegistry=Ie,this._location=he,this._errorHandler=Dt,this._inline=!1,this._currentIconFetch=R.w0.EMPTY,Xt||Bt.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(Bt){this._inline=(0,e.Ig)(Bt)}get svgIcon(){return this._svgIcon}set svgIcon(Bt){Bt!==this._svgIcon&&(Bt?this._updateSvgIcon(Bt):this._svgIcon&&this._clearSvgElement(),this._svgIcon=Bt)}get fontSet(){return this._fontSet}set fontSet(Bt){const Ie=this._cleanupFontValue(Bt);Ie!==this._fontSet&&(this._fontSet=Ie,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(Bt){const Ie=this._cleanupFontValue(Bt);Ie!==this._fontIcon&&(this._fontIcon=Ie,this._updateFontIconClasses())}_splitIconName(Bt){if(!Bt)return["",""];const Ie=Bt.split(":");switch(Ie.length){case 1:return["",Ie[0]];case 2:return Ie;default:throw Error(`Invalid icon name: "${Bt}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const Bt=this._elementsWithExternalReferences;if(Bt&&Bt.size){const Ie=this._location.getPathname();Ie!==this._previousPath&&(this._previousPath=Ie,this._prependPathToReferences(Ie))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(Bt){this._clearSvgElement();const Ie=Bt.querySelectorAll("style");for(let he=0;he<Ie.length;he++)Ie[he].textContent+=" ";const Xt=this._location.getPathname();this._previousPath=Xt,this._cacheChildrenWithExternalReferences(Bt),this._prependPathToReferences(Xt),this._elementRef.nativeElement.appendChild(Bt)}_clearSvgElement(){const Bt=this._elementRef.nativeElement;let Ie=Bt.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();Ie--;){const Xt=Bt.childNodes[Ie];(1!==Xt.nodeType||"svg"===Xt.nodeName.toLowerCase())&&Xt.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const Bt=this._elementRef.nativeElement,Ie=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();Ie!=this._previousFontSetClass&&(this._previousFontSetClass&&Bt.classList.remove(this._previousFontSetClass),Ie&&Bt.classList.add(Ie),this._previousFontSetClass=Ie),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&Bt.classList.remove(this._previousFontIconClass),this.fontIcon&&Bt.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(Bt){return"string"==typeof Bt?Bt.trim().split(" ")[0]:Bt}_prependPathToReferences(Bt){const Ie=this._elementsWithExternalReferences;Ie&&Ie.forEach((Xt,he)=>{Xt.forEach(Dt=>{he.setAttribute(Dt.name,`url('${Bt}#${Dt.value}')`)})})}_cacheChildrenWithExternalReferences(Bt){const Ie=Bt.querySelectorAll(Ne),Xt=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let he=0;he<Ie.length;he++)Ae.forEach(Dt=>{const ve=Ie[he],je=ve.getAttribute(Dt),gi=je?je.match(qe):null;if(gi){let Ee=Xt.get(ve);Ee||(Ee=[],Xt.set(ve,Ee)),Ee.push({name:Dt,value:gi[1]})}})}_updateSvgIcon(Bt){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),Bt){const[Ie,Xt]=this._splitIconName(Bt);Ie&&(this._svgNamespace=Ie),Xt&&(this._svgName=Xt),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(Xt,Ie).pipe((0,It.q)(1)).subscribe(he=>this._setSvgElement(he),he=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${Ie}:${Xt}! ${he.message}`))})}}}return Me.\u0275fac=function(Bt){return new(Bt||Me)(C.Y36(C.SBq),C.Y36(yt),C.$8M("aria-hidden"),C.Y36(_e),C.Y36(C.qLn))},Me.\u0275cmp=C.Xpm({type:Me,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(Bt,Ie){2&Bt&&(C.uIk("data-mat-icon-type",Ie._usingFontIcon()?"font":"svg")("data-mat-icon-name",Ie._svgName||Ie.fontIcon)("data-mat-icon-namespace",Ie._svgNamespace||Ie.fontSet),C.ekj("mat-icon-inline",Ie.inline)("mat-icon-no-color","primary"!==Ie.color&&"accent"!==Ie.color&&"warn"!==Ie.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[C.qOj],ngContentSelectors:Ut,decls:1,vars:0,template:function(Bt,Ie){1&Bt&&(C.F$t(),C.Hsn(0))},styles:[".mat-icon{-webkit-user-select:none;-moz-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),Me})(),ei=(()=>{class Me{}return Me.\u0275fac=function(Bt){return new(Bt||Me)},Me.\u0275mod=C.oAB({type:Me}),Me.\u0275inj=C.cJS({imports:[[m.BQ],m.BQ]}),Me})()},77531:(B,X,_)=>{"use strict";_.d(X,{Jk:()=>Et,Nt:()=>Ut,c:()=>Jt});var C=_(63191),m=_(70925),e=_(5e3),t=_(93075),n=_(90508),o=_(67322),r=_(77579),a=_(60515);const h=(0,m.i$)({passive:!0});let R=(()=>{class Ct{constructor(at,ft){this._platform=at,this._ngZone=ft,this._monitoredElements=new Map}monitor(at){if(!this._platform.isBrowser)return a.E;const ft=(0,C.fI)(at),lt=this._monitoredElements.get(ft);if(lt)return lt.subject;const Ft=new r.x,Mt="cdk-text-field-autofilled",yt=ct=>{"cdk-text-field-autofill-start"!==ct.animationName||ft.classList.contains(Mt)?"cdk-text-field-autofill-end"===ct.animationName&&ft.classList.contains(Mt)&&(ft.classList.remove(Mt),this._ngZone.run(()=>Ft.next({target:ct.target,isAutofilled:!1}))):(ft.classList.add(Mt),this._ngZone.run(()=>Ft.next({target:ct.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{ft.addEventListener("animationstart",yt,h),ft.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(ft,{subject:Ft,unlisten:()=>{ft.removeEventListener("animationstart",yt,h)}}),Ft}stopMonitoring(at){const ft=(0,C.fI)(at),lt=this._monitoredElements.get(ft);lt&&(lt.unlisten(),lt.subject.complete(),ft.classList.remove("cdk-text-field-autofill-monitored"),ft.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(ft))}ngOnDestroy(){this._monitoredElements.forEach((at,ft)=>this.stopMonitoring(ft))}}return Ct.\u0275fac=function(at){return new(at||Ct)(e.LFG(m.t4),e.LFG(e.R0b))},Ct.\u0275prov=e.Yz7({token:Ct,factory:Ct.\u0275fac,providedIn:"root"}),Ct})(),nt=(()=>{class Ct{}return Ct.\u0275fac=function(at){return new(at||Ct)},Ct.\u0275mod=e.oAB({type:Ct}),Ct.\u0275inj=e.cJS({imports:[[m.ud]]}),Ct})();const Et=new e.OlP("MAT_INPUT_VALUE_ACCESSOR"),It=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let gt=0;const wt=(0,n.FD)(class{constructor(Ct,bt,at,ft){this._defaultErrorStateMatcher=Ct,this._parentForm=bt,this._parentFormGroup=at,this.ngControl=ft}});let Ut=(()=>{class Ct extends wt{constructor(at,ft,lt,Ft,Mt,yt,ct,rt,se,xt){super(yt,Ft,Mt,lt),this._elementRef=at,this._platform=ft,this._autofillMonitor=rt,this._formField=xt,this._uid="mat-input-"+gt++,this.focused=!1,this.stateChanges=new r.x,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(_e=>(0,m.qK)().has(_e));const Lt=this._elementRef.nativeElement,de=Lt.nodeName.toLowerCase();this._inputValueAccessor=ct||Lt,this._previousNativeValue=this.value,this.id=this.id,ft.IOS&&se.runOutsideAngular(()=>{at.nativeElement.addEventListener("keyup",_e=>{const ce=_e.target;!ce.value&&0===ce.selectionStart&&0===ce.selectionEnd&&(ce.setSelectionRange(1,1),ce.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===de,this._isTextarea="textarea"===de,this._isInFormField=!!xt,this._isNativeSelect&&(this.controlType=Lt.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(at){this._disabled=(0,C.Ig)(at),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(at){this._id=at||this._uid}get required(){var at,ft,lt,Ft;return null!==(Ft=null!==(at=this._required)&&void 0!==at?at:null===(lt=null===(ft=this.ngControl)||void 0===ft?void 0:ft.control)||void 0===lt?void 0:lt.hasValidator(t.kI.required))&&void 0!==Ft&&Ft}set required(at){this._required=(0,C.Ig)(at)}get type(){return this._type}set type(at){this._type=at||"text",this._validateType(),!this._isTextarea&&(0,m.qK)().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(at){at!==this.value&&(this._inputValueAccessor.value=at,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(at){this._readonly=(0,C.Ig)(at)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(at=>{this.autofilled=at.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(at){this._elementRef.nativeElement.focus(at)}_focusChanged(at){at!==this.focused&&(this.focused=at,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){var at,ft;const lt=(null===(ft=null===(at=this._formField)||void 0===at?void 0:at._hideControlPlaceholder)||void 0===ft?void 0:ft.call(at))?null:this.placeholder;if(lt!==this._previousPlaceholder){const Ft=this._elementRef.nativeElement;this._previousPlaceholder=lt,lt?Ft.setAttribute("placeholder",lt):Ft.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const at=this._elementRef.nativeElement.value;this._previousNativeValue!==at&&(this._previousNativeValue=at,this.stateChanges.next())}_validateType(){It.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let at=this._elementRef.nativeElement.validity;return at&&at.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const at=this._elementRef.nativeElement,ft=at.options[0];return this.focused||at.multiple||!this.empty||!!(at.selectedIndex>-1&&ft&&ft.label)}return this.focused||!this.empty}setDescribedByIds(at){at.length?this._elementRef.nativeElement.setAttribute("aria-describedby",at.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const at=this._elementRef.nativeElement;return this._isNativeSelect&&(at.multiple||at.size>1)}}return Ct.\u0275fac=function(at){return new(at||Ct)(e.Y36(e.SBq),e.Y36(m.t4),e.Y36(t.a5,10),e.Y36(t.F,8),e.Y36(t.sg,8),e.Y36(n.rD),e.Y36(Et,10),e.Y36(R),e.Y36(e.R0b),e.Y36(o.G_,8))},Ct.\u0275dir=e.lG2({type:Ct,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:11,hostBindings:function(at,ft){1&at&&e.NdJ("focus",function(){return ft._focusChanged(!0)})("blur",function(){return ft._focusChanged(!1)})("input",function(){return ft._onInput()}),2&at&&(e.Ikx("disabled",ft.disabled)("required",ft.required),e.uIk("id",ft.id)("data-placeholder",ft.placeholder)("readonly",ft.readonly&&!ft._isNativeSelect||null)("aria-invalid",ft.empty&&ft.required?null:ft.errorState)("aria-required",ft.required),e.ekj("mat-input-server",ft._isServer)("mat-native-select-inline",ft._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[e._Bn([{provide:o.Eo,useExisting:Ct}]),e.qOj,e.TTD]}),Ct})(),Jt=(()=>{class Ct{}return Ct.\u0275fac=function(at){return new(at||Ct)},Ct.\u0275mod=e.oAB({type:Ct}),Ct.\u0275inj=e.cJS({providers:[n.rD],imports:[[nt,o.lN,n.BQ],nt,o.lN]}),Ct})()},92181:(B,X,_)=>{"use strict";_.d(X,{VK:()=>Ie,Tx:()=>ne,p6:()=>Ee});var C=_(15664),m=_(63191),e=_(91159),t=_(5e3),n=_(77579),o=_(50727),r=_(56451),a=_(39646),h=_(53101),R=_(68675),L=_(63900),W=_(95698),nt=_(39300),et=_(82722),Et=_(91005),It=_(41777),gt=_(47429),wt=_(69808),Ut=_(90508),Jt=_(91314),Ct=_(70925),bt=_(50226),at=_(30495);const ft=["mat-menu-item",""];function lt(ee,Oe){1&ee&&(t.O4$(),t.TgZ(0,"svg",2),t._UZ(1,"polygon",3),t.qZA())}const Ft=["*"];function Mt(ee,Oe){if(1&ee){const le=t.EpF();t.TgZ(0,"div",0),t.NdJ("keydown",function(ye){return t.CHM(le),t.oxw()._handleKeydown(ye)})("click",function(){return t.CHM(le),t.oxw().closed.emit("click")})("@transformMenu.start",function(ye){return t.CHM(le),t.oxw()._onAnimationStart(ye)})("@transformMenu.done",function(ye){return t.CHM(le),t.oxw()._onAnimationDone(ye)}),t.TgZ(1,"div",1),t.Hsn(2),t.qZA(),t.qZA()}if(2&ee){const le=t.oxw();t.Q6J("id",le.panelId)("ngClass",le._classList)("@transformMenu",le._panelAnimationState),t.uIk("aria-label",le.ariaLabel||null)("aria-labelledby",le.ariaLabelledby||null)("aria-describedby",le.ariaDescribedby||null)}}const yt={transformMenu:(0,It.X$)("transformMenu",[(0,It.SB)("void",(0,It.oB)({opacity:0,transform:"scale(0.8)"})),(0,It.eR)("void => enter",(0,It.jt)("120ms cubic-bezier(0, 0, 0.2, 1)",(0,It.oB)({opacity:1,transform:"scale(1)"}))),(0,It.eR)("* => void",(0,It.jt)("100ms 25ms linear",(0,It.oB)({opacity:0})))]),fadeInItems:(0,It.X$)("fadeInItems",[(0,It.SB)("showing",(0,It.oB)({opacity:1})),(0,It.eR)("void => *",[(0,It.oB)({opacity:0}),(0,It.jt)("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},se=new t.OlP("MatMenuContent"),Ne=new t.OlP("MAT_MENU_PANEL"),qe=(0,Ut.Kr)((0,Ut.Id)(class{}));let Di=(()=>{class ee extends qe{constructor(le,me,ye,Kt,Zt){super(),this._elementRef=le,this._focusMonitor=ye,this._parentMenu=Kt,this._changeDetectorRef=Zt,this.role="menuitem",this._hovered=new n.x,this._focused=new n.x,this._highlighted=!1,this._triggersSubmenu=!1,Kt&&Kt.addItem&&Kt.addItem(this)}focus(le,me){this._focusMonitor&&le?this._focusMonitor.focusVia(this._getHostElement(),le,me):this._getHostElement().focus(me),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(le){this.disabled&&(le.preventDefault(),le.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){var le;const me=this._elementRef.nativeElement.cloneNode(!0),ye=me.querySelectorAll("mat-icon, .material-icons");for(let Kt=0;Kt<ye.length;Kt++)ye[Kt].remove();return(null===(le=me.textContent)||void 0===le?void 0:le.trim())||""}_setHighlighted(le){var me;this._highlighted=le,null===(me=this._changeDetectorRef)||void 0===me||me.markForCheck()}}return ee.\u0275fac=function(le){return new(le||ee)(t.Y36(t.SBq),t.Y36(wt.K0),t.Y36(C.tE),t.Y36(Ne,8),t.Y36(t.sBO))},ee.\u0275cmp=t.Xpm({type:ee,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:10,hostBindings:function(le,me){1&le&&t.NdJ("click",function(Kt){return me._checkDisabled(Kt)})("mouseenter",function(){return me._handleMouseEnter()}),2&le&&(t.uIk("role",me.role)("tabindex",me._getTabIndex())("aria-disabled",me.disabled.toString())("disabled",me.disabled||null),t.ekj("mat-menu-item",!0)("mat-menu-item-highlighted",me._highlighted)("mat-menu-item-submenu-trigger",me._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[t.qOj],attrs:ft,ngContentSelectors:Ft,decls:3,vars:3,consts:[["matRipple","",1,"mat-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-menu-submenu-icon","viewBox","0 0 5 10","focusable","false",4,"ngIf"],["viewBox","0 0 5 10","focusable","false",1,"mat-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(le,me){1&le&&(t.F$t(),t.Hsn(0),t._UZ(1,"div",0),t.YNc(2,lt,2,0,"svg",1)),2&le&&(t.xp6(1),t.Q6J("matRippleDisabled",me.disableRipple||me.disabled)("matRippleTrigger",me._getHostElement()),t.xp6(1),t.Q6J("ngIf",me._triggersSubmenu))},directives:[Ut.wG,wt.O5],encapsulation:2,changeDetection:0}),ee})();const ei=new t.OlP("mat-menu-default-options",{providedIn:"root",factory:function Me(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let ri=0,Bt=(()=>{class ee{constructor(le,me,ye){this._elementRef=le,this._ngZone=me,this._defaultOptions=ye,this._xPosition=this._defaultOptions.xPosition,this._yPosition=this._defaultOptions.yPosition,this._directDescendantItems=new t.n_E,this._tabSubscription=o.w0.EMPTY,this._classList={},this._panelAnimationState="void",this._animationDone=new n.x,this.overlayPanelClass=this._defaultOptions.overlayPanelClass||"",this.backdropClass=this._defaultOptions.backdropClass,this._overlapTrigger=this._defaultOptions.overlapTrigger,this._hasBackdrop=this._defaultOptions.hasBackdrop,this.closed=new t.vpe,this.close=this.closed,this.panelId="mat-menu-panel-"+ri++}get xPosition(){return this._xPosition}set xPosition(le){this._xPosition=le,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(le){this._yPosition=le,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(le){this._overlapTrigger=(0,m.Ig)(le)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(le){this._hasBackdrop=(0,m.Ig)(le)}set panelClass(le){const me=this._previousPanelClass;me&&me.length&&me.split(" ").forEach(ye=>{this._classList[ye]=!1}),this._previousPanelClass=le,le&&le.length&&(le.split(" ").forEach(ye=>{this._classList[ye]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(le){this.panelClass=le}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new C.Em(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._tabSubscription=this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe((0,R.O)(this._directDescendantItems),(0,L.w)(le=>(0,r.T)(...le.map(me=>me._focused)))).subscribe(le=>this._keyManager.updateActiveItem(le))}ngOnDestroy(){this._directDescendantItems.destroy(),this._tabSubscription.unsubscribe(),this.closed.complete()}_hovered(){return this._directDescendantItems.changes.pipe((0,R.O)(this._directDescendantItems),(0,L.w)(me=>(0,r.T)(...me.map(ye=>ye._hovered))))}addItem(le){}removeItem(le){}_handleKeydown(le){const me=le.keyCode,ye=this._keyManager;switch(me){case e.hY:(0,e.Vb)(le)||(le.preventDefault(),this.closed.emit("keydown"));break;case e.oh:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case e.SV:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:(me===e.LH||me===e.JH)&&ye.setFocusOrigin("keyboard"),ye.onKeydown(le)}}focusFirstItem(le="program"){this.lazyContent?this._ngZone.onStable.pipe((0,W.q)(1)).subscribe(()=>this._focusFirstItem(le)):this._focusFirstItem(le)}_focusFirstItem(le){const me=this._keyManager;if(me.setFocusOrigin(le).setFirstItemActive(),!me.activeItem&&this._directDescendantItems.length){let ye=this._directDescendantItems.first._getHostElement().parentElement;for(;ye;){if("menu"===ye.getAttribute("role")){ye.focus();break}ye=ye.parentElement}}}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(le){const me=Math.min(this._baseElevation+le,24),ye=`${this._elevationPrefix}${me}`,Kt=Object.keys(this._classList).find(Zt=>Zt.startsWith(this._elevationPrefix));(!Kt||Kt===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[ye]=!0,this._previousElevation=ye)}setPositionClasses(le=this.xPosition,me=this.yPosition){const ye=this._classList;ye["mat-menu-before"]="before"===le,ye["mat-menu-after"]="after"===le,ye["mat-menu-above"]="above"===me,ye["mat-menu-below"]="below"===me}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(le){this._animationDone.next(le),this._isAnimating=!1}_onAnimationStart(le){this._isAnimating=!0,"enter"===le.toState&&0===this._keyManager.activeItemIndex&&(le.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe((0,R.O)(this._allItems)).subscribe(le=>{this._directDescendantItems.reset(le.filter(me=>me._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}}return ee.\u0275fac=function(le){return new(le||ee)(t.Y36(t.SBq),t.Y36(t.R0b),t.Y36(ei))},ee.\u0275dir=t.lG2({type:ee,contentQueries:function(le,me,ye){if(1&le&&(t.Suo(ye,se,5),t.Suo(ye,Di,5),t.Suo(ye,Di,4)),2&le){let Kt;t.iGM(Kt=t.CRH())&&(me.lazyContent=Kt.first),t.iGM(Kt=t.CRH())&&(me._allItems=Kt),t.iGM(Kt=t.CRH())&&(me.items=Kt)}},viewQuery:function(le,me){if(1&le&&t.Gf(t.Rgc,5),2&le){let ye;t.iGM(ye=t.CRH())&&(me.templateRef=ye.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}}),ee})(),Ie=(()=>{class ee extends Bt{constructor(le,me,ye){super(le,me,ye),this._elevationPrefix="mat-elevation-z",this._baseElevation=4}}return ee.\u0275fac=function(le){return new(le||ee)(t.Y36(t.SBq),t.Y36(t.R0b),t.Y36(ei))},ee.\u0275cmp=t.Xpm({type:ee,selectors:[["mat-menu"]],hostVars:3,hostBindings:function(le,me){2&le&&t.uIk("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[t._Bn([{provide:Ne,useExisting:ee}]),t.qOj],ngContentSelectors:Ft,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-menu-panel",3,"id","ngClass","keydown","click"],[1,"mat-menu-content"]],template:function(le,me){1&le&&(t.F$t(),t.YNc(0,Mt,3,6,"ng-template"))},directives:[wt.mk],styles:["mat-menu{display:none}.mat-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;max-height:calc(100vh - 48px);border-radius:4px;outline:0;min-height:64px}.mat-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-menu-panel{outline:solid 1px}.mat-menu-content:not(:empty){padding-top:8px;padding-bottom:8px}.mat-menu-item{-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative}.mat-menu-item::-moz-focus-inner{border:0}.mat-menu-item[disabled]{cursor:default}[dir=rtl] .mat-menu-item{text-align:right}.mat-menu-item .mat-icon{margin-right:16px;vertical-align:middle}.mat-menu-item .mat-icon svg{vertical-align:top}[dir=rtl] .mat-menu-item .mat-icon{margin-left:16px;margin-right:0}.mat-menu-item[disabled]{pointer-events:none}.cdk-high-contrast-active .mat-menu-item{margin-top:1px}.cdk-high-contrast-active .mat-menu-item.cdk-program-focused,.cdk-high-contrast-active .mat-menu-item.cdk-keyboard-focused,.cdk-high-contrast-active .mat-menu-item-highlighted{outline:dotted 1px}.mat-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.mat-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-menu-submenu-icon{fill:CanvasText}button.mat-menu-item{width:100%}.mat-menu-item .mat-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}\n"],encapsulation:2,data:{animation:[yt.transformMenu,yt.fadeInItems]},changeDetection:0}),ee})();const Xt=new t.OlP("mat-menu-scroll-strategy"),Dt={provide:Xt,deps:[Jt.aV],useFactory:function he(ee){return()=>ee.scrollStrategies.reposition()}},je=(0,Ct.i$)({passive:!0});let gi=(()=>{class ee{constructor(le,me,ye,Kt,Zt,We,$e,Ti){this._overlay=le,this._element=me,this._viewContainerRef=ye,this._menuItemInstance=We,this._dir=$e,this._focusMonitor=Ti,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=o.w0.EMPTY,this._hoverSubscription=o.w0.EMPTY,this._menuCloseSubscription=o.w0.EMPTY,this._handleTouchStart=vi=>{(0,C.yG)(vi)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new t.vpe,this.onMenuOpen=this.menuOpened,this.menuClosed=new t.vpe,this.onMenuClose=this.menuClosed,this._scrollStrategy=Kt,this._parentMaterialMenu=Zt instanceof Bt?Zt:void 0,me.nativeElement.addEventListener("touchstart",this._handleTouchStart,je),We&&(We._triggersSubmenu=this.triggersSubmenu())}get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(le){this.menu=le}get menu(){return this._menu}set menu(le){le!==this._menu&&(this._menu=le,this._menuCloseSubscription.unsubscribe(),le&&(this._menuCloseSubscription=le.close.subscribe(me=>{this._destroyMenu(me),("click"===me||"tab"===me)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(me)})))}ngAfterContentInit(){this._checkMenu(),this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,je),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!(!this._menuItemInstance||!this._parentMaterialMenu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){if(this._menuOpen)return;this._checkMenu();const le=this._createOverlay(),me=le.getConfig();this._setPosition(me.positionStrategy),me.hasBackdrop=null==this.menu.hasBackdrop?!this.triggersSubmenu():this.menu.hasBackdrop,le.attach(this._getPortal()),this.menu.lazyContent&&this.menu.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(),this.menu instanceof Bt&&this.menu._startAnimation()}closeMenu(){this.menu.close.emit()}focus(le,me){this._focusMonitor&&le?this._focusMonitor.focusVia(this._element,le,me):this._element.nativeElement.focus(me)}updatePosition(){var le;null===(le=this._overlayRef)||void 0===le||le.updatePosition()}_destroyMenu(le){if(!this._overlayRef||!this.menuOpen)return;const me=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===le||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,me instanceof Bt?(me._resetAnimation(),me.lazyContent?me._animationDone.pipe((0,nt.h)(ye=>"void"===ye.toState),(0,W.q)(1),(0,et.R)(me.lazyContent._attached)).subscribe({next:()=>me.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),me.lazyContent&&me.lazyContent.detach())}_initMenu(){this.menu.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,this.menu.direction=this.dir,this._setMenuElevation(),this.menu.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(){if(this.menu.setElevation){let le=0,me=this.menu.parentMenu;for(;me;)le++,me=me.parentMenu;this.menu.setElevation(le)}}_setIsMenuOpen(le){this._menuOpen=le,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(le)}_checkMenu(){}_createOverlay(){if(!this._overlayRef){const le=this._getOverlayConfig();this._subscribeToPositions(le.positionStrategy),this._overlayRef=this._overlay.create(le),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(){return new Jt.X_({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:this.menu.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:this.menu.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(le){this.menu.setPositionClasses&&le.positionChanges.subscribe(me=>{this.menu.setPositionClasses("start"===me.connectionPair.overlayX?"after":"before","top"===me.connectionPair.overlayY?"below":"above")})}_setPosition(le){let[me,ye]="before"===this.menu.xPosition?["end","start"]:["start","end"],[Kt,Zt]="above"===this.menu.yPosition?["bottom","top"]:["top","bottom"],[We,$e]=[Kt,Zt],[Ti,vi]=[me,ye],di=0;this.triggersSubmenu()?(vi=me="before"===this.menu.xPosition?"start":"end",ye=Ti="end"===me?"start":"end",di="bottom"===Kt?8:-8):this.menu.overlapTrigger||(We="top"===Kt?"bottom":"top",$e="top"===Zt?"bottom":"top"),le.withPositions([{originX:me,originY:We,overlayX:Ti,overlayY:Kt,offsetY:di},{originX:ye,originY:We,overlayX:vi,overlayY:Kt,offsetY:di},{originX:me,originY:$e,overlayX:Ti,overlayY:Zt,offsetY:-di},{originX:ye,originY:$e,overlayX:vi,overlayY:Zt,offsetY:-di}])}_menuClosingActions(){const le=this._overlayRef.backdropClick(),me=this._overlayRef.detachments(),ye=this._parentMaterialMenu?this._parentMaterialMenu.closed:(0,a.of)(),Kt=this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe((0,nt.h)(Zt=>Zt!==this._menuItemInstance),(0,nt.h)(()=>this._menuOpen)):(0,a.of)();return(0,r.T)(le,ye,Kt,me)}_handleMousedown(le){(0,C.X6)(le)||(this._openedBy=0===le.button?"mouse":void 0,this.triggersSubmenu()&&le.preventDefault())}_handleKeydown(le){const me=le.keyCode;(me===e.K5||me===e.L_)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(me===e.SV&&"ltr"===this.dir||me===e.oh&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(le){this.triggersSubmenu()?(le.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe((0,nt.h)(le=>le===this._menuItemInstance&&!le.disabled),(0,Et.g)(0,h.E)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof Bt&&this.menu._isAnimating?this.menu._animationDone.pipe((0,W.q)(1),(0,Et.g)(0,h.E),(0,et.R)(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(){return(!this._portal||this._portal.templateRef!==this.menu.templateRef)&&(this._portal=new gt.UE(this.menu.templateRef,this._viewContainerRef)),this._portal}}return ee.\u0275fac=function(le){return new(le||ee)(t.Y36(Jt.aV),t.Y36(t.SBq),t.Y36(t.s_b),t.Y36(Xt),t.Y36(Ne,8),t.Y36(Di,10),t.Y36(bt.Is,8),t.Y36(C.tE))},ee.\u0275dir=t.lG2({type:ee,hostAttrs:["aria-haspopup","true"],hostVars:2,hostBindings:function(le,me){1&le&&t.NdJ("click",function(Kt){return me._handleClick(Kt)})("mousedown",function(Kt){return me._handleMousedown(Kt)})("keydown",function(Kt){return me._handleKeydown(Kt)}),2&le&&t.uIk("aria-expanded",me.menuOpen||null)("aria-controls",me.menuOpen?me.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}}),ee})(),Ee=(()=>{class ee extends gi{}return ee.\u0275fac=function(){let Oe;return function(me){return(Oe||(Oe=t.n5z(ee)))(me||ee)}}(),ee.\u0275dir=t.lG2({type:ee,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-menu-trigger"],exportAs:["matMenuTrigger"],features:[t.qOj]}),ee})(),ne=(()=>{class ee{}return ee.\u0275fac=function(le){return new(le||ee)},ee.\u0275mod=t.oAB({type:ee}),ee.\u0275inj=t.cJS({providers:[Dt],imports:[[wt.ez,Ut.BQ,Ut.si,Jt.U8],at.ZD,Ut.BQ]}),ee})()},20773:(B,X,_)=>{"use strict";_.d(X,{Cq:()=>Jt,$g:()=>Ut});var C=_(5e3),m=_(69808),e=_(90508),t=_(63191),n=_(70925),o=_(76360);function r(Ct,bt){if(1&Ct&&(C.O4$(),C._UZ(0,"circle",3)),2&Ct){const at=C.oxw();C.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+at._spinnerAnimationLabel)("stroke-dashoffset",at._getStrokeDashOffset(),"px")("stroke-dasharray",at._getStrokeCircumference(),"px")("stroke-width",at._getCircleStrokeWidth(),"%"),C.uIk("r",at._getCircleRadius())}}function a(Ct,bt){if(1&Ct&&(C.O4$(),C._UZ(0,"circle",3)),2&Ct){const at=C.oxw();C.Udp("stroke-dashoffset",at._getStrokeDashOffset(),"px")("stroke-dasharray",at._getStrokeCircumference(),"px")("stroke-width",at._getCircleStrokeWidth(),"%"),C.uIk("r",at._getCircleRadius())}}function h(Ct,bt){if(1&Ct&&(C.O4$(),C._UZ(0,"circle",3)),2&Ct){const at=C.oxw();C.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+at._spinnerAnimationLabel)("stroke-dashoffset",at._getStrokeDashOffset(),"px")("stroke-dasharray",at._getStrokeCircumference(),"px")("stroke-width",at._getCircleStrokeWidth(),"%"),C.uIk("r",at._getCircleRadius())}}function R(Ct,bt){if(1&Ct&&(C.O4$(),C._UZ(0,"circle",3)),2&Ct){const at=C.oxw();C.Udp("stroke-dashoffset",at._getStrokeDashOffset(),"px")("stroke-dasharray",at._getStrokeCircumference(),"px")("stroke-width",at._getCircleStrokeWidth(),"%"),C.uIk("r",at._getCircleRadius())}}const et=(0,e.pj)(class{constructor(Ct){this._elementRef=Ct}},"primary"),Et=new C.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function It(){return{diameter:100}}});class wt extends et{constructor(bt,at,ft,lt,Ft){super(bt),this._document=ft,this._diameter=100,this._value=0,this.mode="determinate";const Mt=wt._diameters;this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),Mt.has(ft.head)||Mt.set(ft.head,new Set([100])),this._noopAnimations="NoopAnimations"===lt&&!!Ft&&!Ft._forceAnimations,Ft&&(Ft.diameter&&(this.diameter=Ft.diameter),Ft.strokeWidth&&(this.strokeWidth=Ft.strokeWidth))}get diameter(){return this._diameter}set diameter(bt){this._diameter=(0,t.su)(bt),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(bt){this._strokeWidth=(0,t.su)(bt)}get value(){return"determinate"===this.mode?this._value:0}set value(bt){this._value=Math.max(0,Math.min(100,(0,t.su)(bt)))}ngOnInit(){const bt=this._elementRef.nativeElement;this._styleRoot=(0,n.kV)(bt)||this._document.head,this._attachStyleNode(),bt.classList.add("mat-progress-spinner-indeterminate-animation")}_getCircleRadius(){return(this.diameter-10)/2}_getViewBox(){const bt=2*this._getCircleRadius()+this.strokeWidth;return`0 0 ${bt} ${bt}`}_getStrokeCircumference(){return 2*Math.PI*this._getCircleRadius()}_getStrokeDashOffset(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:null}_getCircleStrokeWidth(){return this.strokeWidth/this.diameter*100}_attachStyleNode(){const bt=this._styleRoot,at=this._diameter,ft=wt._diameters;let lt=ft.get(bt);if(!lt||!lt.has(at)){const Ft=this._document.createElement("style");Ft.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),Ft.textContent=this._getAnimationText(),bt.appendChild(Ft),lt||(lt=new Set,ft.set(bt,lt)),lt.add(at)}}_getAnimationText(){const bt=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*bt).replace(/END_VALUE/g,""+.2*bt).replace(/DIAMETER/g,`${this._spinnerAnimationLabel}`)}_getSpinnerAnimationLabel(){return this.diameter.toString().replace(".","_")}}wt._diameters=new WeakMap,wt.\u0275fac=function(bt){return new(bt||wt)(C.Y36(C.SBq),C.Y36(n.t4),C.Y36(m.K0,8),C.Y36(o.Qb,8),C.Y36(Et))},wt.\u0275cmp=C.Xpm({type:wt,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(bt,at){2&bt&&(C.uIk("aria-valuemin","determinate"===at.mode?0:null)("aria-valuemax","determinate"===at.mode?100:null)("aria-valuenow","determinate"===at.mode?at.value:null)("mode",at.mode),C.Udp("width",at.diameter,"px")("height",at.diameter,"px"),C.ekj("_mat-animation-noopable",at._noopAnimations))},inputs:{color:"color",diameter:"diameter",strokeWidth:"strokeWidth",mode:"mode",value:"value"},exportAs:["matProgressSpinner"],features:[C.qOj],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(bt,at){1&bt&&(C.O4$(),C.TgZ(0,"svg",0),C.YNc(1,r,1,9,"circle",1),C.YNc(2,a,1,7,"circle",2),C.qZA()),2&bt&&(C.Udp("width",at.diameter,"px")("height",at.diameter,"px"),C.Q6J("ngSwitch","indeterminate"===at.mode),C.uIk("viewBox",at._getViewBox()),C.xp6(1),C.Q6J("ngSwitchCase",!0),C.xp6(1),C.Q6J("ngSwitchCase",!1))},directives:[m.RF,m.n9],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}\n"],encapsulation:2,changeDetection:0});let Ut=(()=>{class Ct extends wt{constructor(at,ft,lt,Ft,Mt){super(at,ft,lt,Ft,Mt),this.mode="indeterminate"}}return Ct.\u0275fac=function(at){return new(at||Ct)(C.Y36(C.SBq),C.Y36(n.t4),C.Y36(m.K0,8),C.Y36(o.Qb,8),C.Y36(Et))},Ct.\u0275cmp=C.Xpm({type:Ct,selectors:[["mat-spinner"]],hostAttrs:["role","progressbar","mode","indeterminate",1,"mat-spinner","mat-progress-spinner"],hostVars:6,hostBindings:function(at,ft){2&at&&(C.Udp("width",ft.diameter,"px")("height",ft.diameter,"px"),C.ekj("_mat-animation-noopable",ft._noopAnimations))},inputs:{color:"color"},features:[C.qOj],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(at,ft){1&at&&(C.O4$(),C.TgZ(0,"svg",0),C.YNc(1,h,1,9,"circle",1),C.YNc(2,R,1,7,"circle",2),C.qZA()),2&at&&(C.Udp("width",ft.diameter,"px")("height",ft.diameter,"px"),C.Q6J("ngSwitch","indeterminate"===ft.mode),C.uIk("viewBox",ft._getViewBox()),C.xp6(1),C.Q6J("ngSwitchCase",!0),C.xp6(1),C.Q6J("ngSwitchCase",!1))},directives:[m.RF,m.n9],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}\n"],encapsulation:2,changeDetection:0}),Ct})(),Jt=(()=>{class Ct{}return Ct.\u0275fac=function(at){return new(at||Ct)},Ct.\u0275mod=C.oAB({type:Ct}),Ct.\u0275inj=C.cJS({imports:[[e.BQ,m.ez],e.BQ]}),Ct})()},57261:(B,X,_)=>{"use strict";_.d(X,{ux:()=>Ft,ZX:()=>at});var C=_(91314),m=_(47429),e=_(69808),t=_(5e3),n=_(90508),o=_(47423),r=_(77579),a=_(95698),h=_(82722),R=_(41777),L=_(70925),W=_(95113),nt=_(15664);function et(Mt,yt){if(1&Mt){const ct=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"button",2),t.NdJ("click",function(){return t.CHM(ct),t.oxw().action()}),t._uU(2),t.qZA(),t.qZA()}if(2&Mt){const ct=t.oxw();t.xp6(2),t.Oqu(ct.data.action)}}function Et(Mt,yt){}const It=new t.OlP("MatSnackBarData");class gt{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}const wt=Math.pow(2,31)-1;class Ut{constructor(yt,ct){this._overlayRef=ct,this._afterDismissed=new r.x,this._afterOpened=new r.x,this._onAction=new r.x,this._dismissedByAction=!1,this.containerInstance=yt,this.onAction().subscribe(()=>this.dismiss()),yt._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(yt){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(yt,wt))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}let Jt=(()=>{class Mt{constructor(ct,rt){this.snackBarRef=ct,this.data=rt}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return Mt.\u0275fac=function(ct){return new(ct||Mt)(t.Y36(Ut),t.Y36(It))},Mt.\u0275cmp=t.Xpm({type:Mt,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(ct,rt){1&ct&&(t.TgZ(0,"span"),t._uU(1),t.qZA(),t.YNc(2,et,3,1,"div",0)),2&ct&&(t.xp6(1),t.Oqu(rt.data.message),t.xp6(1),t.Q6J("ngIf",rt.hasAction))},directives:[e.O5,o.lW],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}\n"],encapsulation:2,changeDetection:0}),Mt})();const Ct={snackBarState:(0,R.X$)("state",[(0,R.SB)("void, hidden",(0,R.oB)({transform:"scale(0.8)",opacity:0})),(0,R.SB)("visible",(0,R.oB)({transform:"scale(1)",opacity:1})),(0,R.eR)("* => visible",(0,R.jt)("150ms cubic-bezier(0, 0, 0.2, 1)")),(0,R.eR)("* => void, * => hidden",(0,R.jt)("75ms cubic-bezier(0.4, 0.0, 1, 1)",(0,R.oB)({opacity:0})))])};let bt=(()=>{class Mt extends m.en{constructor(ct,rt,se,xt,Lt){super(),this._ngZone=ct,this._elementRef=rt,this._changeDetectorRef=se,this._platform=xt,this.snackBarConfig=Lt,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new r.x,this._onExit=new r.x,this._onEnter=new r.x,this._animationState="void",this.attachDomPortal=de=>(this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachDomPortal(de)),this._live="assertive"!==Lt.politeness||Lt.announcementMessage?"off"===Lt.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(ct){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(ct)}attachTemplatePortal(ct){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(ct)}onAnimationEnd(ct){const{fromState:rt,toState:se}=ct;if(("void"===se&&"void"!==rt||"hidden"===se)&&this._completeExit(),"visible"===se){const xt=this._onEnter;this._ngZone.run(()=>{xt.next(),xt.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe((0,a.q)(1)).subscribe(()=>{this._onExit.next(),this._onExit.complete()})}_applySnackBarClasses(){const ct=this._elementRef.nativeElement,rt=this.snackBarConfig.panelClass;rt&&(Array.isArray(rt)?rt.forEach(se=>ct.classList.add(se)):ct.classList.add(rt)),"center"===this.snackBarConfig.horizontalPosition&&ct.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&ct.classList.add("mat-snack-bar-top")}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const ct=this._elementRef.nativeElement.querySelector("[aria-hidden]"),rt=this._elementRef.nativeElement.querySelector("[aria-live]");if(ct&&rt){let se=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&ct.contains(document.activeElement)&&(se=document.activeElement),ct.removeAttribute("aria-hidden"),rt.appendChild(ct),null==se||se.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}}return Mt.\u0275fac=function(ct){return new(ct||Mt)(t.Y36(t.R0b),t.Y36(t.SBq),t.Y36(t.sBO),t.Y36(L.t4),t.Y36(gt))},Mt.\u0275cmp=t.Xpm({type:Mt,selectors:[["snack-bar-container"]],viewQuery:function(ct,rt){if(1&ct&&t.Gf(m.Pl,7),2&ct){let se;t.iGM(se=t.CRH())&&(rt._portalOutlet=se.first)}},hostAttrs:[1,"mat-snack-bar-container"],hostVars:1,hostBindings:function(ct,rt){1&ct&&t.WFA("@state.done",function(xt){return rt.onAnimationEnd(xt)}),2&ct&&t.d8E("@state",rt._animationState)},features:[t.qOj],decls:3,vars:2,consts:[["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(ct,rt){1&ct&&(t.TgZ(0,"div",0),t.YNc(1,Et,0,0,"ng-template",1),t.qZA(),t._UZ(2,"div")),2&ct&&(t.xp6(2),t.uIk("aria-live",rt._live)("role",rt._role))},directives:[m.Pl],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}\n"],encapsulation:2,data:{animation:[Ct.snackBarState]}}),Mt})(),at=(()=>{class Mt{}return Mt.\u0275fac=function(ct){return new(ct||Mt)},Mt.\u0275mod=t.oAB({type:Mt}),Mt.\u0275inj=t.cJS({imports:[[C.U8,m.eL,e.ez,o.ot,n.BQ],n.BQ]}),Mt})();const ft=new t.OlP("mat-snack-bar-default-options",{providedIn:"root",factory:function lt(){return new gt}});let Ft=(()=>{class Mt{constructor(ct,rt,se,xt,Lt,de){this._overlay=ct,this._live=rt,this._injector=se,this._breakpointObserver=xt,this._parentSnackBar=Lt,this._defaultConfig=de,this._snackBarRefAtThisLevel=null,this.simpleSnackBarComponent=Jt,this.snackBarContainerComponent=bt,this.handsetCssClass="mat-snack-bar-handset"}get _openedSnackBarRef(){const ct=this._parentSnackBar;return ct?ct._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(ct){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=ct:this._snackBarRefAtThisLevel=ct}openFromComponent(ct,rt){return this._attach(ct,rt)}openFromTemplate(ct,rt){return this._attach(ct,rt)}open(ct,rt="",se){const xt=Object.assign(Object.assign({},this._defaultConfig),se);return xt.data={message:ct,action:rt},xt.announcementMessage===ct&&(xt.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,xt)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(ct,rt){const xt=t.zs3.create({parent:rt&&rt.viewContainerRef&&rt.viewContainerRef.injector||this._injector,providers:[{provide:gt,useValue:rt}]}),Lt=new m.C5(this.snackBarContainerComponent,rt.viewContainerRef,xt),de=ct.attach(Lt);return de.instance.snackBarConfig=rt,de.instance}_attach(ct,rt){const se=Object.assign(Object.assign(Object.assign({},new gt),this._defaultConfig),rt),xt=this._createOverlay(se),Lt=this._attachSnackBarContainer(xt,se),de=new Ut(Lt,xt);if(ct instanceof t.Rgc){const _e=new m.UE(ct,null,{$implicit:se.data,snackBarRef:de});de.instance=Lt.attachTemplatePortal(_e)}else{const _e=this._createInjector(se,de),ce=new m.C5(ct,void 0,_e),Ae=Lt.attachComponentPortal(ce);de.instance=Ae.instance}return this._breakpointObserver.observe(W.u3.HandsetPortrait).pipe((0,h.R)(xt.detachments())).subscribe(_e=>{xt.overlayElement.classList.toggle(this.handsetCssClass,_e.matches)}),se.announcementMessage&&Lt._onAnnounce.subscribe(()=>{this._live.announce(se.announcementMessage,se.politeness)}),this._animateSnackBar(de,se),this._openedSnackBarRef=de,this._openedSnackBarRef}_animateSnackBar(ct,rt){ct.afterDismissed().subscribe(()=>{this._openedSnackBarRef==ct&&(this._openedSnackBarRef=null),rt.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{ct.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):ct.containerInstance.enter(),rt.duration&&rt.duration>0&&ct.afterOpened().subscribe(()=>ct._dismissAfter(rt.duration))}_createOverlay(ct){const rt=new C.X_;rt.direction=ct.direction;let se=this._overlay.position().global();const xt="rtl"===ct.direction,Lt="left"===ct.horizontalPosition||"start"===ct.horizontalPosition&&!xt||"end"===ct.horizontalPosition&&xt,de=!Lt&&"center"!==ct.horizontalPosition;return Lt?se.left("0"):de?se.right("0"):se.centerHorizontally(),"top"===ct.verticalPosition?se.top("0"):se.bottom("0"),rt.positionStrategy=se,this._overlay.create(rt)}_createInjector(ct,rt){return t.zs3.create({parent:ct&&ct.viewContainerRef&&ct.viewContainerRef.injector||this._injector,providers:[{provide:Ut,useValue:rt},{provide:It,useValue:ct.data}]})}}return Mt.\u0275fac=function(ct){return new(ct||Mt)(t.LFG(C.aV),t.LFG(nt.Kd),t.LFG(t.zs3),t.LFG(W.Yg),t.LFG(Mt,12),t.LFG(ft))},Mt.\u0275prov=t.Yz7({token:Mt,factory:Mt.\u0275fac,providedIn:at}),Mt})()},53251:(B,X,_)=>{"use strict";_.d(X,{uX:()=>gi,SP:()=>De,uD:()=>Dt,Nh:()=>si});var C=_(15664),m=_(17144),e=_(47429),t=_(69808),n=_(5e3),o=_(90508),r=_(76360),a=_(77579),h=_(50727),R=_(54968),L=_(39646),W=_(56451),nt=_(5963),et=_(41777),Et=_(68675),It=_(71884),gt=_(82722),wt=_(50226),Ut=_(63191),Jt=_(91159),Ct=_(70925),bt=_(30495);function at(Ce,Vt){1&Ce&&n.Hsn(0)}const ft=["*"];function lt(Ce,Vt){}const Ft=function(Ce){return{animationDuration:Ce}},Mt=function(Ce,Vt){return{value:Ce,params:Vt}},yt=["tabListContainer"],ct=["tabList"],rt=["tabListInner"],se=["nextPaginator"],xt=["previousPaginator"],Lt=["tabBodyWrapper"],de=["tabHeader"];function _e(Ce,Vt){}function ce(Ce,Vt){if(1&Ce&&n.YNc(0,_e,0,0,"ng-template",9),2&Ce){const vt=n.oxw().$implicit;n.Q6J("cdkPortalOutlet",vt.templateLabel)}}function Ae(Ce,Vt){if(1&Ce&&n._uU(0),2&Ce){const vt=n.oxw().$implicit;n.Oqu(vt.textLabel)}}function Ne(Ce,Vt){if(1&Ce){const vt=n.EpF();n.TgZ(0,"div",6),n.NdJ("click",function(){const fe=n.CHM(vt),He=fe.$implicit,$i=fe.index,tn=n.oxw(),In=n.MAs(1);return tn._handleClick(He,In,$i)})("cdkFocusChange",function(fe){const $i=n.CHM(vt).index;return n.oxw()._tabFocusChanged(fe,$i)}),n.TgZ(1,"div",7),n.YNc(2,ce,1,1,"ng-template",8),n.YNc(3,Ae,1,1,"ng-template",8),n.qZA(),n.qZA()}if(2&Ce){const vt=Vt.$implicit,Gt=Vt.index,fe=n.oxw();n.ekj("mat-tab-label-active",fe.selectedIndex==Gt),n.Q6J("id",fe._getTabLabelId(Gt))("disabled",vt.disabled)("matRippleDisabled",vt.disabled||fe.disableRipple),n.uIk("tabIndex",fe._getTabIndex(vt,Gt))("aria-posinset",Gt+1)("aria-setsize",fe._tabs.length)("aria-controls",fe._getTabContentId(Gt))("aria-selected",fe.selectedIndex==Gt)("aria-label",vt.ariaLabel||null)("aria-labelledby",!vt.ariaLabel&&vt.ariaLabelledby?vt.ariaLabelledby:null),n.xp6(2),n.Q6J("ngIf",vt.templateLabel),n.xp6(1),n.Q6J("ngIf",!vt.templateLabel)}}function qe(Ce,Vt){if(1&Ce){const vt=n.EpF();n.TgZ(0,"mat-tab-body",10),n.NdJ("_onCentered",function(){return n.CHM(vt),n.oxw()._removeTabBodyWrapperHeight()})("_onCentering",function(fe){return n.CHM(vt),n.oxw()._setTabBodyWrapperHeight(fe)}),n.qZA()}if(2&Ce){const vt=Vt.$implicit,Gt=Vt.index,fe=n.oxw();n.ekj("mat-tab-body-active",fe.selectedIndex===Gt),n.Q6J("id",fe._getTabContentId(Gt))("content",vt.content)("position",vt.position)("origin",vt.origin)("animationDuration",fe.animationDuration),n.uIk("tabindex",null!=fe.contentTabIndex&&fe.selectedIndex===Gt?fe.contentTabIndex:null)("aria-labelledby",fe._getTabLabelId(Gt))}}const ei=new n.OlP("MatInkBarPositioner",{providedIn:"root",factory:function Me(){return Vt=>({left:Vt?(Vt.offsetLeft||0)+"px":"0",width:Vt?(Vt.offsetWidth||0)+"px":"0"})}});let ri=(()=>{class Ce{constructor(vt,Gt,fe,He){this._elementRef=vt,this._ngZone=Gt,this._inkBarPositioner=fe,this._animationMode=He}alignToElement(vt){this.show(),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._setStyles(vt))}):this._setStyles(vt)}show(){this._elementRef.nativeElement.style.visibility="visible"}hide(){this._elementRef.nativeElement.style.visibility="hidden"}_setStyles(vt){const Gt=this._inkBarPositioner(vt),fe=this._elementRef.nativeElement;fe.style.left=Gt.left,fe.style.width=Gt.width}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.SBq),n.Y36(n.R0b),n.Y36(ei),n.Y36(r.Qb,8))},Ce.\u0275dir=n.lG2({type:Ce,selectors:[["mat-ink-bar"]],hostAttrs:[1,"mat-ink-bar"],hostVars:2,hostBindings:function(vt,Gt){2&vt&&n.ekj("_mat-animation-noopable","NoopAnimations"===Gt._animationMode)}}),Ce})();const Bt=new n.OlP("MatTabContent"),Xt=new n.OlP("MatTabLabel"),he=new n.OlP("MAT_TAB");let Dt=(()=>{class Ce extends e.ig{constructor(vt,Gt,fe){super(vt,Gt),this._closestTab=fe}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.Rgc),n.Y36(n.s_b),n.Y36(he,8))},Ce.\u0275dir=n.lG2({type:Ce,selectors:[["","mat-tab-label",""],["","matTabLabel",""]],features:[n._Bn([{provide:Xt,useExisting:Ce}]),n.qOj]}),Ce})();const ve=(0,o.Id)(class{}),je=new n.OlP("MAT_TAB_GROUP");let gi=(()=>{class Ce extends ve{constructor(vt,Gt){super(),this._viewContainerRef=vt,this._closestTabGroup=Gt,this.textLabel="",this._contentPortal=null,this._stateChanges=new a.x,this.position=null,this.origin=null,this.isActive=!1}get templateLabel(){return this._templateLabel}set templateLabel(vt){this._setTemplateLabelInput(vt)}get content(){return this._contentPortal}ngOnChanges(vt){(vt.hasOwnProperty("textLabel")||vt.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new e.UE(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(vt){vt&&vt._closestTab===this&&(this._templateLabel=vt)}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.s_b),n.Y36(je,8))},Ce.\u0275cmp=n.Xpm({type:Ce,selectors:[["mat-tab"]],contentQueries:function(vt,Gt,fe){if(1&vt&&(n.Suo(fe,Xt,5),n.Suo(fe,Bt,7,n.Rgc)),2&vt){let He;n.iGM(He=n.CRH())&&(Gt.templateLabel=He.first),n.iGM(He=n.CRH())&&(Gt._explicitContent=He.first)}},viewQuery:function(vt,Gt){if(1&vt&&n.Gf(n.Rgc,7),2&vt){let fe;n.iGM(fe=n.CRH())&&(Gt._implicitContent=fe.first)}},inputs:{disabled:"disabled",textLabel:["label","textLabel"],ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"]},exportAs:["matTab"],features:[n._Bn([{provide:he,useExisting:Ce}]),n.qOj,n.TTD],ngContentSelectors:ft,decls:1,vars:0,template:function(vt,Gt){1&vt&&(n.F$t(),n.YNc(0,at,1,0,"ng-template"))},encapsulation:2}),Ce})();const Ee={translateTab:(0,et.X$)("translateTab",[(0,et.SB)("center, void, left-origin-center, right-origin-center",(0,et.oB)({transform:"none"})),(0,et.SB)("left",(0,et.oB)({transform:"translate3d(-100%, 0, 0)",minHeight:"1px"})),(0,et.SB)("right",(0,et.oB)({transform:"translate3d(100%, 0, 0)",minHeight:"1px"})),(0,et.eR)("* => left, * => right, left => center, right => center",(0,et.jt)("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")),(0,et.eR)("void => left-origin-center",[(0,et.oB)({transform:"translate3d(-100%, 0, 0)"}),(0,et.jt)("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")]),(0,et.eR)("void => right-origin-center",[(0,et.oB)({transform:"translate3d(100%, 0, 0)"}),(0,et.jt)("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)")])])};let ne=(()=>{class Ce extends e.Pl{constructor(vt,Gt,fe,He){super(vt,Gt,He),this._host=fe,this._centeringSub=h.w0.EMPTY,this._leavingSub=h.w0.EMPTY}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe((0,Et.O)(this._host._isCenterPosition(this._host._position))).subscribe(vt=>{vt&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n._Vd),n.Y36(n.s_b),n.Y36((0,n.Gpc)(()=>Oe)),n.Y36(t.K0))},Ce.\u0275dir=n.lG2({type:Ce,selectors:[["","matTabBodyHost",""]],features:[n.qOj]}),Ce})(),ee=(()=>{class Ce{constructor(vt,Gt,fe){this._elementRef=vt,this._dir=Gt,this._dirChangeSubscription=h.w0.EMPTY,this._translateTabComplete=new a.x,this._onCentering=new n.vpe,this._beforeCentering=new n.vpe,this._afterLeavingCenter=new n.vpe,this._onCentered=new n.vpe(!0),this.animationDuration="500ms",Gt&&(this._dirChangeSubscription=Gt.change.subscribe(He=>{this._computePositionAnimationState(He),fe.markForCheck()})),this._translateTabComplete.pipe((0,It.x)((He,$i)=>He.fromState===$i.fromState&&He.toState===$i.toState)).subscribe(He=>{this._isCenterPosition(He.toState)&&this._isCenterPosition(this._position)&&this._onCentered.emit(),this._isCenterPosition(He.fromState)&&!this._isCenterPosition(this._position)&&this._afterLeavingCenter.emit()})}set position(vt){this._positionIndex=vt,this._computePositionAnimationState()}ngOnInit(){"center"==this._position&&null!=this.origin&&(this._position=this._computePositionFromOrigin(this.origin))}ngOnDestroy(){this._dirChangeSubscription.unsubscribe(),this._translateTabComplete.complete()}_onTranslateTabStarted(vt){const Gt=this._isCenterPosition(vt.toState);this._beforeCentering.emit(Gt),Gt&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_isCenterPosition(vt){return"center"==vt||"left-origin-center"==vt||"right-origin-center"==vt}_computePositionAnimationState(vt=this._getLayoutDirection()){this._position=this._positionIndex<0?"ltr"==vt?"left":"right":this._positionIndex>0?"ltr"==vt?"right":"left":"center"}_computePositionFromOrigin(vt){const Gt=this._getLayoutDirection();return"ltr"==Gt&&vt<=0||"rtl"==Gt&&vt>0?"left-origin-center":"right-origin-center"}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.SBq),n.Y36(wt.Is,8),n.Y36(n.sBO))},Ce.\u0275dir=n.lG2({type:Ce,inputs:{_content:["content","_content"],origin:"origin",animationDuration:"animationDuration",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_afterLeavingCenter:"_afterLeavingCenter",_onCentered:"_onCentered"}}),Ce})(),Oe=(()=>{class Ce extends ee{constructor(vt,Gt,fe){super(vt,Gt,fe)}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.SBq),n.Y36(wt.Is,8),n.Y36(n.sBO))},Ce.\u0275cmp=n.Xpm({type:Ce,selectors:[["mat-tab-body"]],viewQuery:function(vt,Gt){if(1&vt&&n.Gf(e.Pl,5),2&vt){let fe;n.iGM(fe=n.CRH())&&(Gt._portalHost=fe.first)}},hostAttrs:[1,"mat-tab-body"],features:[n.qOj],decls:3,vars:6,consts:[["cdkScrollable","",1,"mat-tab-body-content"],["content",""],["matTabBodyHost",""]],template:function(vt,Gt){1&vt&&(n.TgZ(0,"div",0,1),n.NdJ("@translateTab.start",function(He){return Gt._onTranslateTabStarted(He)})("@translateTab.done",function(He){return Gt._translateTabComplete.next(He)}),n.YNc(2,lt,0,0,"ng-template",2),n.qZA()),2&vt&&n.Q6J("@translateTab",n.WLB(3,Mt,Gt._position,n.VKq(1,Ft,Gt.animationDuration)))},directives:[ne],styles:[".mat-tab-body-content{height:100%;overflow:auto}.mat-tab-group-dynamic-height .mat-tab-body-content{overflow:hidden}\n"],encapsulation:2,data:{animation:[Ee.translateTab]}}),Ce})();const le=new n.OlP("MAT_TABS_CONFIG"),me=(0,o.Id)(class{});let ye=(()=>{class Ce extends me{constructor(vt){super(),this.elementRef=vt}focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.SBq))},Ce.\u0275dir=n.lG2({type:Ce,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(vt,Gt){2&vt&&(n.uIk("aria-disabled",!!Gt.disabled),n.ekj("mat-tab-disabled",Gt.disabled))},inputs:{disabled:"disabled"},features:[n.qOj]}),Ce})();const Kt=(0,Ct.i$)({passive:!0});let Ti=(()=>{class Ce{constructor(vt,Gt,fe,He,$i,tn,In){this._elementRef=vt,this._changeDetectorRef=Gt,this._viewportRuler=fe,this._dir=He,this._ngZone=$i,this._platform=tn,this._animationMode=In,this._scrollDistance=0,this._selectedIndexChanged=!1,this._destroyed=new a.x,this._showPaginationControls=!1,this._disableScrollAfter=!0,this._disableScrollBefore=!0,this._stopScrolling=new a.x,this.disablePagination=!1,this._selectedIndex=0,this.selectFocusedIndex=new n.vpe,this.indexFocused=new n.vpe,$i.runOutsideAngular(()=>{(0,R.R)(vt.nativeElement,"mouseleave").pipe((0,gt.R)(this._destroyed)).subscribe(()=>{this._stopInterval()})})}get selectedIndex(){return this._selectedIndex}set selectedIndex(vt){vt=(0,Ut.su)(vt),this._selectedIndex!=vt&&(this._selectedIndexChanged=!0,this._selectedIndex=vt,this._keyManager&&this._keyManager.updateActiveItem(vt))}ngAfterViewInit(){(0,R.R)(this._previousPaginator.nativeElement,"touchstart",Kt).pipe((0,gt.R)(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("before")}),(0,R.R)(this._nextPaginator.nativeElement,"touchstart",Kt).pipe((0,gt.R)(this._destroyed)).subscribe(()=>{this._handlePaginatorPress("after")})}ngAfterContentInit(){const vt=this._dir?this._dir.change:(0,L.of)("ltr"),Gt=this._viewportRuler.change(150),fe=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new C.Em(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap(),this._keyManager.updateActiveItem(this._selectedIndex),"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(fe):fe(),(0,W.T)(vt,Gt,this._items.changes).pipe((0,gt.R)(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>Promise.resolve().then(fe)),this._keyManager.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.pipe((0,gt.R)(this._destroyed)).subscribe(He=>{this.indexFocused.emit(He),this._setTabFocus(He)})}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(vt){if(!(0,Jt.Vb)(vt))switch(vt.keyCode){case Jt.K5:case Jt.L_:this.focusIndex!==this.selectedIndex&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(vt));break;default:this._keyManager.onKeydown(vt)}}_onContentChanges(){const vt=this._elementRef.nativeElement.textContent;vt!==this._currentTextContent&&(this._currentTextContent=vt||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(vt){!this._isValidIndex(vt)||this.focusIndex===vt||!this._keyManager||this._keyManager.setActiveItem(vt)}_isValidIndex(vt){if(!this._items)return!0;const Gt=this._items?this._items.toArray()[vt]:null;return!!Gt&&!Gt.disabled}_setTabFocus(vt){if(this._showPaginationControls&&this._scrollToLabel(vt),this._items&&this._items.length){this._items.toArray()[vt].focus();const Gt=this._tabListContainer.nativeElement;Gt.scrollLeft="ltr"==this._getLayoutDirection()?0:Gt.scrollWidth-Gt.offsetWidth}}_getLayoutDirection(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;const vt=this.scrollDistance,Gt="ltr"===this._getLayoutDirection()?-vt:vt;this._tabList.nativeElement.style.transform=`translateX(${Math.round(Gt)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(vt){this._scrollTo(vt)}_scrollHeader(vt){return this._scrollTo(this._scrollDistance+("before"==vt?-1:1)*this._tabListContainer.nativeElement.offsetWidth/3)}_handlePaginatorClick(vt){this._stopInterval(),this._scrollHeader(vt)}_scrollToLabel(vt){if(this.disablePagination)return;const Gt=this._items?this._items.toArray()[vt]:null;if(!Gt)return;const fe=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:He,offsetWidth:$i}=Gt.elementRef.nativeElement;let tn,In;"ltr"==this._getLayoutDirection()?(tn=He,In=tn+$i):(In=this._tabListInner.nativeElement.offsetWidth-He,tn=In-$i);const no=this.scrollDistance,li=this.scrollDistance+fe;tn<no?this.scrollDistance-=no-tn+60:In>li&&(this.scrollDistance+=In-li+60)}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{const vt=this._tabListInner.nativeElement.scrollWidth>this._elementRef.nativeElement.offsetWidth;vt||(this.scrollDistance=0),vt!==this._showPaginationControls&&this._changeDetectorRef.markForCheck(),this._showPaginationControls=vt}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=0==this.scrollDistance,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){return this._tabListInner.nativeElement.scrollWidth-this._tabListContainer.nativeElement.offsetWidth||0}_alignInkBarToSelectedTab(){const vt=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,Gt=vt?vt.elementRef.nativeElement:null;Gt?this._inkBar.alignToElement(Gt):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(vt,Gt){Gt&&null!=Gt.button&&0!==Gt.button||(this._stopInterval(),(0,nt.H)(650,100).pipe((0,gt.R)((0,W.T)(this._stopScrolling,this._destroyed))).subscribe(()=>{const{maxScrollDistance:fe,distance:He}=this._scrollHeader(vt);(0===He||He>=fe)&&this._stopInterval()}))}_scrollTo(vt){if(this.disablePagination)return{maxScrollDistance:0,distance:0};const Gt=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(Gt,vt)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:Gt,distance:this._scrollDistance}}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.SBq),n.Y36(n.sBO),n.Y36(bt.rL),n.Y36(wt.Is,8),n.Y36(n.R0b),n.Y36(Ct.t4),n.Y36(r.Qb,8))},Ce.\u0275dir=n.lG2({type:Ce,inputs:{disablePagination:"disablePagination"}}),Ce})(),vi=(()=>{class Ce extends Ti{constructor(vt,Gt,fe,He,$i,tn,In){super(vt,Gt,fe,He,$i,tn,In),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(vt){this._disableRipple=(0,Ut.Ig)(vt)}_itemSelected(vt){vt.preventDefault()}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.SBq),n.Y36(n.sBO),n.Y36(bt.rL),n.Y36(wt.Is,8),n.Y36(n.R0b),n.Y36(Ct.t4),n.Y36(r.Qb,8))},Ce.\u0275dir=n.lG2({type:Ce,inputs:{disableRipple:"disableRipple"},features:[n.qOj]}),Ce})(),di=(()=>{class Ce extends vi{constructor(vt,Gt,fe,He,$i,tn,In){super(vt,Gt,fe,He,$i,tn,In)}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.SBq),n.Y36(n.sBO),n.Y36(bt.rL),n.Y36(wt.Is,8),n.Y36(n.R0b),n.Y36(Ct.t4),n.Y36(r.Qb,8))},Ce.\u0275cmp=n.Xpm({type:Ce,selectors:[["mat-tab-header"]],contentQueries:function(vt,Gt,fe){if(1&vt&&n.Suo(fe,ye,4),2&vt){let He;n.iGM(He=n.CRH())&&(Gt._items=He)}},viewQuery:function(vt,Gt){if(1&vt&&(n.Gf(ri,7),n.Gf(yt,7),n.Gf(ct,7),n.Gf(rt,7),n.Gf(se,5),n.Gf(xt,5)),2&vt){let fe;n.iGM(fe=n.CRH())&&(Gt._inkBar=fe.first),n.iGM(fe=n.CRH())&&(Gt._tabListContainer=fe.first),n.iGM(fe=n.CRH())&&(Gt._tabList=fe.first),n.iGM(fe=n.CRH())&&(Gt._tabListInner=fe.first),n.iGM(fe=n.CRH())&&(Gt._nextPaginator=fe.first),n.iGM(fe=n.CRH())&&(Gt._previousPaginator=fe.first)}},hostAttrs:[1,"mat-tab-header"],hostVars:4,hostBindings:function(vt,Gt){2&vt&&n.ekj("mat-tab-header-pagination-controls-enabled",Gt._showPaginationControls)("mat-tab-header-rtl","rtl"==Gt._getLayoutDirection())},inputs:{selectedIndex:"selectedIndex"},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"},features:[n.qOj],ngContentSelectors:ft,decls:14,vars:8,consts:[["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-before","mat-elevation-z4",3,"matRippleDisabled","click","mousedown","touchend"],["previousPaginator",""],[1,"mat-tab-header-pagination-chevron"],[1,"mat-tab-label-container",3,"keydown"],["tabListContainer",""],["role","tablist",1,"mat-tab-list",3,"cdkObserveContent"],["tabList",""],[1,"mat-tab-labels"],["tabListInner",""],["aria-hidden","true","mat-ripple","",1,"mat-tab-header-pagination","mat-tab-header-pagination-after","mat-elevation-z4",3,"matRippleDisabled","mousedown","click","touchend"],["nextPaginator",""]],template:function(vt,Gt){1&vt&&(n.F$t(),n.TgZ(0,"div",0,1),n.NdJ("click",function(){return Gt._handlePaginatorClick("before")})("mousedown",function(He){return Gt._handlePaginatorPress("before",He)})("touchend",function(){return Gt._stopInterval()}),n._UZ(2,"div",2),n.qZA(),n.TgZ(3,"div",3,4),n.NdJ("keydown",function(He){return Gt._handleKeydown(He)}),n.TgZ(5,"div",5,6),n.NdJ("cdkObserveContent",function(){return Gt._onContentChanges()}),n.TgZ(7,"div",7,8),n.Hsn(9),n.qZA(),n._UZ(10,"mat-ink-bar"),n.qZA(),n.qZA(),n.TgZ(11,"div",9,10),n.NdJ("mousedown",function(He){return Gt._handlePaginatorPress("after",He)})("click",function(){return Gt._handlePaginatorClick("after")})("touchend",function(){return Gt._stopInterval()}),n._UZ(13,"div",2),n.qZA()),2&vt&&(n.ekj("mat-tab-header-pagination-disabled",Gt._disableScrollBefore),n.Q6J("matRippleDisabled",Gt._disableScrollBefore||Gt.disableRipple),n.xp6(5),n.ekj("_mat-animation-noopable","NoopAnimations"===Gt._animationMode),n.xp6(6),n.ekj("mat-tab-header-pagination-disabled",Gt._disableScrollAfter),n.Q6J("matRippleDisabled",Gt._disableScrollAfter||Gt.disableRipple))},directives:[o.wG,m.wD,ri],styles:['.mat-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mat-tab-header-pagination{-webkit-user-select:none;-moz-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:transparent;touch-action:none}.mat-tab-header-pagination-controls-enabled .mat-tab-header-pagination{display:flex}.mat-tab-header-pagination-before,.mat-tab-header-rtl .mat-tab-header-pagination-after{padding-left:4px}.mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-rtl .mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-tab-header-rtl .mat-tab-header-pagination-before,.mat-tab-header-pagination-after{padding-right:4px}.mat-tab-header-rtl .mat-tab-header-pagination-before .mat-tab-header-pagination-chevron,.mat-tab-header-pagination-after .mat-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;content:"";height:8px;width:8px}.mat-tab-header-pagination-disabled{box-shadow:none;cursor:default}.mat-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-ink-bar{position:absolute;bottom:0;height:2px;transition:500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-ink-bar{transition:none;animation:none}.mat-tab-group-inverted-header .mat-ink-bar{bottom:auto;top:0}.cdk-high-contrast-active .mat-ink-bar{outline:solid 2px;height:0}.mat-tab-labels{display:flex}[mat-align-tabs=center]>.mat-tab-header .mat-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-tab-header .mat-tab-labels{justify-content:flex-end}.mat-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1}._mat-animation-noopable.mat-tab-list{transition:none;animation:none}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{min-width:72px}}\n'],encapsulation:2}),Ce})(),Gi=0;class Ri{}const rn=(0,o.pj)((0,o.Kr)(class{constructor(Ce){this._elementRef=Ce}}),"primary");let ge=(()=>{class Ce extends rn{constructor(vt,Gt,fe,He){var $i;super(vt),this._changeDetectorRef=Gt,this._animationMode=He,this._tabs=new n.n_E,this._indexToSelect=0,this._tabBodyWrapperHeight=0,this._tabsSubscription=h.w0.EMPTY,this._tabLabelSubscription=h.w0.EMPTY,this._selectedIndex=null,this.headerPosition="above",this.selectedIndexChange=new n.vpe,this.focusChange=new n.vpe,this.animationDone=new n.vpe,this.selectedTabChange=new n.vpe(!0),this._groupId=Gi++,this.animationDuration=fe&&fe.animationDuration?fe.animationDuration:"500ms",this.disablePagination=!(!fe||null==fe.disablePagination)&&fe.disablePagination,this.dynamicHeight=!(!fe||null==fe.dynamicHeight)&&fe.dynamicHeight,this.contentTabIndex=null!==($i=null==fe?void 0:fe.contentTabIndex)&&void 0!==$i?$i:null}get dynamicHeight(){return this._dynamicHeight}set dynamicHeight(vt){this._dynamicHeight=(0,Ut.Ig)(vt)}get selectedIndex(){return this._selectedIndex}set selectedIndex(vt){this._indexToSelect=(0,Ut.su)(vt,null)}get animationDuration(){return this._animationDuration}set animationDuration(vt){this._animationDuration=/^\d+$/.test(vt)?vt+"ms":vt}get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(vt){this._contentTabIndex=(0,Ut.su)(vt,null)}get backgroundColor(){return this._backgroundColor}set backgroundColor(vt){const Gt=this._elementRef.nativeElement;Gt.classList.remove(`mat-background-${this.backgroundColor}`),vt&&Gt.classList.add(`mat-background-${vt}`),this._backgroundColor=vt}ngAfterContentChecked(){const vt=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=vt){const Gt=null==this._selectedIndex;if(!Gt){this.selectedTabChange.emit(this._createChangeEvent(vt));const fe=this._tabBodyWrapper.nativeElement;fe.style.minHeight=fe.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((fe,He)=>fe.isActive=He===vt),Gt||(this.selectedIndexChange.emit(vt),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((Gt,fe)=>{Gt.position=fe-vt,null!=this._selectedIndex&&0==Gt.position&&!Gt.origin&&(Gt.origin=vt-this._selectedIndex)}),this._selectedIndex!==vt&&(this._selectedIndex=vt,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{if(this._clampTabIndex(this._indexToSelect)===this._selectedIndex){const Gt=this._tabs.toArray();for(let fe=0;fe<Gt.length;fe++)if(Gt[fe].isActive){this._indexToSelect=this._selectedIndex=fe;break}}this._changeDetectorRef.markForCheck()})}_subscribeToAllTabChanges(){this._allTabs.changes.pipe((0,Et.O)(this._allTabs)).subscribe(vt=>{this._tabs.reset(vt.filter(Gt=>Gt._closestTabGroup===this||!Gt._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}focusTab(vt){const Gt=this._tabHeader;Gt&&(Gt.focusIndex=vt)}_focusChanged(vt){this.focusChange.emit(this._createChangeEvent(vt))}_createChangeEvent(vt){const Gt=new Ri;return Gt.index=vt,this._tabs&&this._tabs.length&&(Gt.tab=this._tabs.toArray()[vt]),Gt}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=(0,W.T)(...this._tabs.map(vt=>vt._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(vt){return Math.min(this._tabs.length-1,Math.max(vt||0,0))}_getTabLabelId(vt){return`mat-tab-label-${this._groupId}-${vt}`}_getTabContentId(vt){return`mat-tab-content-${this._groupId}-${vt}`}_setTabBodyWrapperHeight(vt){if(!this._dynamicHeight||!this._tabBodyWrapperHeight)return;const Gt=this._tabBodyWrapper.nativeElement;Gt.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(Gt.style.height=vt+"px")}_removeTabBodyWrapperHeight(){const vt=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=vt.clientHeight,vt.style.height="",this.animationDone.emit()}_handleClick(vt,Gt,fe){vt.disabled||(this.selectedIndex=Gt.focusIndex=fe)}_getTabIndex(vt,Gt){return vt.disabled?null:this.selectedIndex===Gt?0:-1}_tabFocusChanged(vt,Gt){vt&&"mouse"!==vt&&"touch"!==vt&&(this._tabHeader.focusIndex=Gt)}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.SBq),n.Y36(n.sBO),n.Y36(le,8),n.Y36(r.Qb,8))},Ce.\u0275dir=n.lG2({type:Ce,inputs:{dynamicHeight:"dynamicHeight",selectedIndex:"selectedIndex",headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:"contentTabIndex",disablePagination:"disablePagination",backgroundColor:"backgroundColor"},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},features:[n.qOj]}),Ce})(),De=(()=>{class Ce extends ge{constructor(vt,Gt,fe,He){super(vt,Gt,fe,He)}}return Ce.\u0275fac=function(vt){return new(vt||Ce)(n.Y36(n.SBq),n.Y36(n.sBO),n.Y36(le,8),n.Y36(r.Qb,8))},Ce.\u0275cmp=n.Xpm({type:Ce,selectors:[["mat-tab-group"]],contentQueries:function(vt,Gt,fe){if(1&vt&&n.Suo(fe,gi,5),2&vt){let He;n.iGM(He=n.CRH())&&(Gt._allTabs=He)}},viewQuery:function(vt,Gt){if(1&vt&&(n.Gf(Lt,5),n.Gf(de,5)),2&vt){let fe;n.iGM(fe=n.CRH())&&(Gt._tabBodyWrapper=fe.first),n.iGM(fe=n.CRH())&&(Gt._tabHeader=fe.first)}},hostAttrs:[1,"mat-tab-group"],hostVars:4,hostBindings:function(vt,Gt){2&vt&&n.ekj("mat-tab-group-dynamic-height",Gt.dynamicHeight)("mat-tab-group-inverted-header","below"===Gt.headerPosition)},inputs:{color:"color",disableRipple:"disableRipple"},exportAs:["matTabGroup"],features:[n._Bn([{provide:je,useExisting:Ce}]),n.qOj],decls:6,vars:7,consts:[[3,"selectedIndex","disableRipple","disablePagination","indexFocused","selectFocusedIndex"],["tabHeader",""],["class","mat-tab-label mat-focus-indicator","role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",3,"id","mat-tab-label-active","disabled","matRippleDisabled","click","cdkFocusChange",4,"ngFor","ngForOf"],[1,"mat-tab-body-wrapper"],["tabBodyWrapper",""],["role","tabpanel",3,"id","mat-tab-body-active","content","position","origin","animationDuration","_onCentered","_onCentering",4,"ngFor","ngForOf"],["role","tab","matTabLabelWrapper","","mat-ripple","","cdkMonitorElementFocus","",1,"mat-tab-label","mat-focus-indicator",3,"id","disabled","matRippleDisabled","click","cdkFocusChange"],[1,"mat-tab-label-content"],[3,"ngIf"],[3,"cdkPortalOutlet"],["role","tabpanel",3,"id","content","position","origin","animationDuration","_onCentered","_onCentering"]],template:function(vt,Gt){1&vt&&(n.TgZ(0,"mat-tab-header",0,1),n.NdJ("indexFocused",function(He){return Gt._focusChanged(He)})("selectFocusedIndex",function(He){return Gt.selectedIndex=He}),n.YNc(2,Ne,4,14,"div",2),n.qZA(),n.TgZ(3,"div",3,4),n.YNc(5,qe,1,9,"mat-tab-body",5),n.qZA()),2&vt&&(n.Q6J("selectedIndex",Gt.selectedIndex||0)("disableRipple",Gt.disableRipple)("disablePagination",Gt.disablePagination),n.xp6(2),n.Q6J("ngForOf",Gt._tabs),n.xp6(1),n.ekj("_mat-animation-noopable","NoopAnimations"===Gt._animationMode),n.xp6(2),n.Q6J("ngForOf",Gt._tabs))},directives:[di,t.sg,ye,o.wG,C.kH,t.O5,e.Pl,Oe],styles:[".mat-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-tab-group.mat-tab-group-inverted-header{flex-direction:column-reverse}.mat-tab-label{height:48px;padding:0 24px;cursor:pointer;box-sizing:border-box;opacity:.6;min-width:160px;text-align:center;display:inline-flex;justify-content:center;align-items:center;white-space:nowrap;position:relative}.mat-tab-label:focus{outline:none}.mat-tab-label:focus:not(.mat-tab-disabled){opacity:1}.cdk-high-contrast-active .mat-tab-label:focus{outline:dotted 2px;outline-offset:-2px}.mat-tab-label.mat-tab-disabled{cursor:default}.cdk-high-contrast-active .mat-tab-label.mat-tab-disabled{opacity:.5}.mat-tab-label .mat-tab-label-content{display:inline-flex;justify-content:center;align-items:center;white-space:nowrap}.cdk-high-contrast-active .mat-tab-label{opacity:1}@media(max-width: 599px){.mat-tab-label{padding:0 12px}}@media(max-width: 959px){.mat-tab-label{padding:0 12px}}.mat-tab-group[mat-stretch-tabs]>.mat-tab-header .mat-tab-label{flex-basis:0;flex-grow:1}.mat-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable.mat-tab-body-wrapper{transition:none;animation:none}.mat-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-tab-body.mat-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-tab-group.mat-tab-group-dynamic-height .mat-tab-body.mat-tab-body-active{overflow-y:hidden}\n"],encapsulation:2}),Ce})(),si=(()=>{class Ce{}return Ce.\u0275fac=function(vt){return new(vt||Ce)},Ce.\u0275mod=n.oAB({type:Ce}),Ce.\u0275inj=n.cJS({imports:[[t.ez,o.BQ,e.eL,o.si,m.Q8,C.rt],o.BQ]}),Ce})()},76360:(B,X,_)=>{"use strict";_.d(X,{Qb:()=>za,PW:()=>Xi});var C=_(5e3),m=_(22313),e=_(41777);function t(){return"undefined"!=typeof window&&void 0!==window.document}function n(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function o(ie){switch(ie.length){case 0:return new e.ZN;case 1:return ie[0];default:return new e.ZE(ie)}}function r(ie,z,J,_t,Qt={},Te={}){const Ye=[],Qe=[];let mi=-1,Ui=null;if(_t.forEach(hn=>{const Tn=hn.offset,$n=Tn==mi,po=$n&&Ui||{};Object.keys(hn).forEach(Un=>{let jn=Un,oo=hn[Un];if("offset"!==Un)switch(jn=z.normalizePropertyName(jn,Ye),oo){case e.k1:oo=Qt[Un];break;case e.l3:oo=Te[Un];break;default:oo=z.normalizeStyleValue(Un,jn,oo,Ye)}po[jn]=oo}),$n||Qe.push(po),Ui=po,mi=Tn}),Ye.length){const hn="\n - ";throw new Error(`Unable to animate due to the following errors:${hn}${Ye.join(hn)}`)}return Qe}function a(ie,z,J,_t){switch(z){case"start":ie.onStart(()=>_t(J&&h(J,"start",ie)));break;case"done":ie.onDone(()=>_t(J&&h(J,"done",ie)));break;case"destroy":ie.onDestroy(()=>_t(J&&h(J,"destroy",ie)))}}function h(ie,z,J){const _t=J.totalTime,Te=R(ie.element,ie.triggerName,ie.fromState,ie.toState,z||ie.phaseName,null==_t?ie.totalTime:_t,!!J.disabled),Ye=ie._data;return null!=Ye&&(Te._data=Ye),Te}function R(ie,z,J,_t,Qt="",Te=0,Ye){return{element:ie,triggerName:z,fromState:J,toState:_t,phaseName:Qt,totalTime:Te,disabled:!!Ye}}function L(ie,z,J){let _t;return ie instanceof Map?(_t=ie.get(z),_t||ie.set(z,_t=J)):(_t=ie[z],_t||(_t=ie[z]=J)),_t}function W(ie){const z=ie.indexOf(":");return[ie.substring(1,z),ie.substr(z+1)]}let nt=(ie,z)=>!1,et=(ie,z,J)=>[];(n()||"undefined"!=typeof Element)&&(nt=t()?(ie,z)=>{for(;z&&z!==document.documentElement;){if(z===ie)return!0;z=z.parentNode||z.host}return!1}:(ie,z)=>ie.contains(z),et=(ie,z,J)=>{let _t=[];if(J){const Qt=ie.querySelectorAll(z);for(let Te=0;Te<Qt.length;Te++)_t.push(Qt[Te])}else{const Qt=ie.querySelector(z);Qt&&_t.push(Qt)}return _t});let gt=null,wt=!1;function Ut(ie){gt||(gt=function Jt(){return"undefined"!=typeof document?document.body:null}()||{},wt=!!gt.style&&"WebkitAppearance"in gt.style);let z=!0;return gt.style&&!function It(ie){return"ebkit"==ie.substring(1,6)}(ie)&&(z=ie in gt.style,!z&&wt&&(z="Webkit"+ie.charAt(0).toUpperCase()+ie.substr(1)in gt.style)),z}const Ct=nt,bt=et;function at(ie){const z={};return Object.keys(ie).forEach(J=>{const _t=J.replace(/([a-z])([A-Z])/g,"$1-$2");z[_t]=ie[J]}),z}let ft=(()=>{class ie{validateStyleProperty(J){return Ut(J)}matchesElement(J,_t){return!1}containsElement(J,_t){return Ct(J,_t)}query(J,_t,Qt){return bt(J,_t,Qt)}computeStyle(J,_t,Qt){return Qt||""}animate(J,_t,Qt,Te,Ye,Qe=[],mi){return new e.ZN(Qt,Te)}}return ie.\u0275fac=function(J){return new(J||ie)},ie.\u0275prov=C.Yz7({token:ie,factory:ie.\u0275fac}),ie})(),lt=(()=>{class ie{}return ie.NOOP=new ft,ie})();const ct="ng-enter",rt="ng-leave",Lt="ng-trigger",de=".ng-trigger",_e="ng-animating",ce=".ng-animating";function Ae(ie){if("number"==typeof ie)return ie;const z=ie.match(/^(-?[\.\d]+)(m?s)/);return!z||z.length<2?0:Ne(parseFloat(z[1]),z[2])}function Ne(ie,z){return"s"===z?1e3*ie:ie}function qe(ie,z,J){return ie.hasOwnProperty("duration")?ie:function Di(ie,z,J){let Qt,Te=0,Ye="";if("string"==typeof ie){const Qe=ie.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===Qe)return z.push(`The provided timing value "${ie}" is invalid.`),{duration:0,delay:0,easing:""};Qt=Ne(parseFloat(Qe[1]),Qe[2]);const mi=Qe[3];null!=mi&&(Te=Ne(parseFloat(mi),Qe[4]));const Ui=Qe[5];Ui&&(Ye=Ui)}else Qt=ie;if(!J){let Qe=!1,mi=z.length;Qt<0&&(z.push("Duration values below 0 are not allowed for this animation step."),Qe=!0),Te<0&&(z.push("Delay values below 0 are not allowed for this animation step."),Qe=!0),Qe&&z.splice(mi,0,`The provided timing value "${ie}" is invalid.`)}return{duration:Qt,delay:Te,easing:Ye}}(ie,z,J)}function ei(ie,z={}){return Object.keys(ie).forEach(J=>{z[J]=ie[J]}),z}function ri(ie,z,J={}){if(z)for(let _t in ie)J[_t]=ie[_t];else ei(ie,J);return J}function Bt(ie,z,J){return J?z+":"+J+";":""}function Ie(ie){let z="";for(let J=0;J<ie.style.length;J++){const _t=ie.style.item(J);z+=Bt(0,_t,ie.style.getPropertyValue(_t))}for(const J in ie.style)ie.style.hasOwnProperty(J)&&!J.startsWith("_")&&(z+=Bt(0,le(J),ie.style[J]));ie.setAttribute("style",z)}function Xt(ie,z,J){ie.style&&(Object.keys(z).forEach(_t=>{const Qt=Oe(_t);J&&!J.hasOwnProperty(_t)&&(J[_t]=ie.style[Qt]),ie.style[Qt]=z[_t]}),n()&&Ie(ie))}function he(ie,z){ie.style&&(Object.keys(z).forEach(J=>{const _t=Oe(J);ie.style[_t]=""}),n()&&Ie(ie))}function Dt(ie){return Array.isArray(ie)?1==ie.length?ie[0]:(0,e.vP)(ie):ie}const je=new RegExp("{{\\s*(.+?)\\s*}}","g");function gi(ie){let z=[];if("string"==typeof ie){let J;for(;J=je.exec(ie);)z.push(J[1]);je.lastIndex=0}return z}function Ee(ie,z,J){const _t=ie.toString(),Qt=_t.replace(je,(Te,Ye)=>{let Qe=z[Ye];return z.hasOwnProperty(Ye)||(J.push(`Please provide a value for the animation param ${Ye}`),Qe=""),Qe.toString()});return Qt==_t?ie:Qt}function ne(ie){const z=[];let J=ie.next();for(;!J.done;)z.push(J.value),J=ie.next();return z}const ee=/-+([a-z0-9])/g;function Oe(ie){return ie.replace(ee,(...z)=>z[1].toUpperCase())}function le(ie){return ie.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function me(ie,z){return 0===ie||0===z}function ye(ie,z,J){const _t=Object.keys(J);if(_t.length&&z.length){let Te=z[0],Ye=[];if(_t.forEach(Qe=>{Te.hasOwnProperty(Qe)||Ye.push(Qe),Te[Qe]=J[Qe]}),Ye.length)for(var Qt=1;Qt<z.length;Qt++){let Qe=z[Qt];Ye.forEach(function(mi){Qe[mi]=Zt(ie,mi)})}}return z}function Kt(ie,z,J){switch(z.type){case 7:return ie.visitTrigger(z,J);case 0:return ie.visitState(z,J);case 1:return ie.visitTransition(z,J);case 2:return ie.visitSequence(z,J);case 3:return ie.visitGroup(z,J);case 4:return ie.visitAnimate(z,J);case 5:return ie.visitKeyframes(z,J);case 6:return ie.visitStyle(z,J);case 8:return ie.visitReference(z,J);case 9:return ie.visitAnimateChild(z,J);case 10:return ie.visitAnimateRef(z,J);case 11:return ie.visitQuery(z,J);case 12:return ie.visitStagger(z,J);default:throw new Error(`Unable to resolve animation metadata node #${z.type}`)}}function Zt(ie,z){return window.getComputedStyle(ie)[z]}function $e(ie,z){const J=[];return"string"==typeof ie?ie.split(/\s*,\s*/).forEach(_t=>function Ti(ie,z,J){if(":"==ie[0]){const mi=function vi(ie,z){switch(ie){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(J,_t)=>parseFloat(_t)>parseFloat(J);case":decrement":return(J,_t)=>parseFloat(_t)<parseFloat(J);default:return z.push(`The transition alias value "${ie}" is not supported`),"* => *"}}(ie,J);if("function"==typeof mi)return void z.push(mi);ie=mi}const _t=ie.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==_t||_t.length<4)return J.push(`The provided transition expression "${ie}" is not supported`),z;const Qt=_t[1],Te=_t[2],Ye=_t[3];z.push(Ri(Qt,Ye));"<"==Te[0]&&!("*"==Qt&&"*"==Ye)&&z.push(Ri(Ye,Qt))}(_t,J,z)):J.push(ie),J}const di=new Set(["true","1"]),Gi=new Set(["false","0"]);function Ri(ie,z){const J=di.has(ie)||Gi.has(ie),_t=di.has(z)||Gi.has(z);return(Qt,Te)=>{let Ye="*"==ie||ie==Qt,Qe="*"==z||z==Te;return!Ye&&J&&"boolean"==typeof Qt&&(Ye=Qt?di.has(ie):Gi.has(ie)),!Qe&&_t&&"boolean"==typeof Te&&(Qe=Te?di.has(z):Gi.has(z)),Ye&&Qe}}const ge=new RegExp("s*:selfs*,?","g");function De(ie,z,J){return new yi(ie).build(z,J)}class yi{constructor(z){this._driver=z}build(z,J){const _t=new mn(J);return this._resetContextStyleTimingState(_t),Kt(this,Dt(z),_t)}_resetContextStyleTimingState(z){z.currentQuerySelector="",z.collectedStyles={},z.collectedStyles[""]={},z.currentTime=0}visitTrigger(z,J){let _t=J.queryCount=0,Qt=J.depCount=0;const Te=[],Ye=[];return"@"==z.name.charAt(0)&&J.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),z.definitions.forEach(Qe=>{if(this._resetContextStyleTimingState(J),0==Qe.type){const mi=Qe,Ui=mi.name;Ui.toString().split(/\s*,\s*/).forEach(hn=>{mi.name=hn,Te.push(this.visitState(mi,J))}),mi.name=Ui}else if(1==Qe.type){const mi=this.visitTransition(Qe,J);_t+=mi.queryCount,Qt+=mi.depCount,Ye.push(mi)}else J.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:z.name,states:Te,transitions:Ye,queryCount:_t,depCount:Qt,options:null}}visitState(z,J){const _t=this.visitStyle(z.styles,J),Qt=z.options&&z.options.params||null;if(_t.containsDynamicStyles){const Te=new Set,Ye=Qt||{};if(_t.styles.forEach(Qe=>{if(Ce(Qe)){const mi=Qe;Object.keys(mi).forEach(Ui=>{gi(mi[Ui]).forEach(hn=>{Ye.hasOwnProperty(hn)||Te.add(hn)})})}}),Te.size){const Qe=ne(Te.values());J.errors.push(`state("${z.name}", ...) must define default values for all the following style substitutions: ${Qe.join(", ")}`)}}return{type:0,name:z.name,style:_t,options:Qt?{params:Qt}:null}}visitTransition(z,J){J.queryCount=0,J.depCount=0;const _t=Kt(this,Dt(z.animation),J);return{type:1,matchers:$e(z.expr,J.errors),animation:_t,queryCount:J.queryCount,depCount:J.depCount,options:vt(z.options)}}visitSequence(z,J){return{type:2,steps:z.steps.map(_t=>Kt(this,_t,J)),options:vt(z.options)}}visitGroup(z,J){const _t=J.currentTime;let Qt=0;const Te=z.steps.map(Ye=>{J.currentTime=_t;const Qe=Kt(this,Ye,J);return Qt=Math.max(Qt,J.currentTime),Qe});return J.currentTime=Qt,{type:3,steps:Te,options:vt(z.options)}}visitAnimate(z,J){const _t=function Vt(ie,z){let J=null;if(ie.hasOwnProperty("duration"))J=ie;else if("number"==typeof ie)return Gt(qe(ie,z).duration,0,"");const _t=ie;if(_t.split(/\s+/).some(Te=>"{"==Te.charAt(0)&&"{"==Te.charAt(1))){const Te=Gt(0,0,"");return Te.dynamic=!0,Te.strValue=_t,Te}return J=J||qe(_t,z),Gt(J.duration,J.delay,J.easing)}(z.timings,J.errors);J.currentAnimateTimings=_t;let Qt,Te=z.styles?z.styles:(0,e.oB)({});if(5==Te.type)Qt=this.visitKeyframes(Te,J);else{let Ye=z.styles,Qe=!1;if(!Ye){Qe=!0;const Ui={};_t.easing&&(Ui.easing=_t.easing),Ye=(0,e.oB)(Ui)}J.currentTime+=_t.duration+_t.delay;const mi=this.visitStyle(Ye,J);mi.isEmptyStep=Qe,Qt=mi}return J.currentAnimateTimings=null,{type:4,timings:_t,style:Qt,options:null}}visitStyle(z,J){const _t=this._makeStyleAst(z,J);return this._validateStyleAst(_t,J),_t}_makeStyleAst(z,J){const _t=[];Array.isArray(z.styles)?z.styles.forEach(Ye=>{"string"==typeof Ye?Ye==e.l3?_t.push(Ye):J.errors.push(`The provided style string value ${Ye} is not allowed.`):_t.push(Ye)}):_t.push(z.styles);let Qt=!1,Te=null;return _t.forEach(Ye=>{if(Ce(Ye)){const Qe=Ye,mi=Qe.easing;if(mi&&(Te=mi,delete Qe.easing),!Qt)for(let Ui in Qe)if(Qe[Ui].toString().indexOf("{{")>=0){Qt=!0;break}}}),{type:6,styles:_t,easing:Te,offset:z.offset,containsDynamicStyles:Qt,options:null}}_validateStyleAst(z,J){const _t=J.currentAnimateTimings;let Qt=J.currentTime,Te=J.currentTime;_t&&Te>0&&(Te-=_t.duration+_t.delay),z.styles.forEach(Ye=>{"string"!=typeof Ye&&Object.keys(Ye).forEach(Qe=>{if(!this._driver.validateStyleProperty(Qe))return void J.errors.push(`The provided animation property "${Qe}" is not a supported CSS property for animations`);const mi=J.collectedStyles[J.currentQuerySelector],Ui=mi[Qe];let hn=!0;Ui&&(Te!=Qt&&Te>=Ui.startTime&&Qt<=Ui.endTime&&(J.errors.push(`The CSS property "${Qe}" that exists between the times of "${Ui.startTime}ms" and "${Ui.endTime}ms" is also being animated in a parallel animation between the times of "${Te}ms" and "${Qt}ms"`),hn=!1),Te=Ui.startTime),hn&&(mi[Qe]={startTime:Te,endTime:Qt}),J.options&&function ve(ie,z,J){const _t=z.params||{},Qt=gi(ie);Qt.length&&Qt.forEach(Te=>{_t.hasOwnProperty(Te)||J.push(`Unable to resolve the local animation param ${Te} in the given list of values`)})}(Ye[Qe],J.options,J.errors)})})}visitKeyframes(z,J){const _t={type:5,styles:[],options:null};if(!J.currentAnimateTimings)return J.errors.push("keyframes() must be placed inside of a call to animate()"),_t;let Te=0;const Ye=[];let Qe=!1,mi=!1,Ui=0;const hn=z.steps.map(Ko=>{const dr=this._makeStyleAst(Ko,J);let is=null!=dr.offset?dr.offset:function si(ie){if("string"==typeof ie)return null;let z=null;if(Array.isArray(ie))ie.forEach(J=>{if(Ce(J)&&J.hasOwnProperty("offset")){const _t=J;z=parseFloat(_t.offset),delete _t.offset}});else if(Ce(ie)&&ie.hasOwnProperty("offset")){const J=ie;z=parseFloat(J.offset),delete J.offset}return z}(dr.styles),Hr=0;return null!=is&&(Te++,Hr=dr.offset=is),mi=mi||Hr<0||Hr>1,Qe=Qe||Hr<Ui,Ui=Hr,Ye.push(Hr),dr});mi&&J.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),Qe&&J.errors.push("Please ensure that all keyframe offsets are in order");const Tn=z.steps.length;let $n=0;Te>0&&Te<Tn?J.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==Te&&($n=1/(Tn-1));const po=Tn-1,Un=J.currentTime,jn=J.currentAnimateTimings,oo=jn.duration;return hn.forEach((Ko,dr)=>{const is=$n>0?dr==po?1:$n*dr:Ye[dr],Hr=is*oo;J.currentTime=Un+jn.delay+Hr,jn.duration=Hr,this._validateStyleAst(Ko,J),Ko.offset=is,_t.styles.push(Ko)}),_t}visitReference(z,J){return{type:8,animation:Kt(this,Dt(z.animation),J),options:vt(z.options)}}visitAnimateChild(z,J){return J.depCount++,{type:9,options:vt(z.options)}}visitAnimateRef(z,J){return{type:10,animation:this.visitReference(z.animation,J),options:vt(z.options)}}visitQuery(z,J){const _t=J.currentQuerySelector,Qt=z.options||{};J.queryCount++,J.currentQuery=z;const[Te,Ye]=function Fi(ie){const z=!!ie.split(/\s*,\s*/).find(J=>":self"==J);return z&&(ie=ie.replace(ge,"")),ie=ie.replace(/@\*/g,de).replace(/@\w+/g,J=>de+"-"+J.substr(1)).replace(/:animating/g,ce),[ie,z]}(z.selector);J.currentQuerySelector=_t.length?_t+" "+Te:Te,L(J.collectedStyles,J.currentQuerySelector,{});const Qe=Kt(this,Dt(z.animation),J);return J.currentQuery=null,J.currentQuerySelector=_t,{type:11,selector:Te,limit:Qt.limit||0,optional:!!Qt.optional,includeSelf:Ye,animation:Qe,originalSelector:z.selector,options:vt(z.options)}}visitStagger(z,J){J.currentQuery||J.errors.push("stagger() can only be used inside of query()");const _t="full"===z.timings?{duration:0,delay:0,easing:"full"}:qe(z.timings,J.errors,!0);return{type:12,animation:Kt(this,Dt(z.animation),J),timings:_t,options:null}}}class mn{constructor(z){this.errors=z,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function Ce(ie){return!Array.isArray(ie)&&"object"==typeof ie}function vt(ie){return ie?(ie=ei(ie)).params&&(ie.params=function Ni(ie){return ie?ei(ie):null}(ie.params)):ie={},ie}function Gt(ie,z,J){return{duration:ie,delay:z,easing:J}}function fe(ie,z,J,_t,Qt,Te,Ye=null,Qe=!1){return{type:1,element:ie,keyframes:z,preStyleProps:J,postStyleProps:_t,duration:Qt,delay:Te,totalTime:Qt+Te,easing:Ye,subTimeline:Qe}}class He{constructor(){this._map=new Map}consume(z){let J=this._map.get(z);return J?this._map.delete(z):J=[],J}append(z,J){let _t=this._map.get(z);_t||this._map.set(z,_t=[]),_t.push(...J)}has(z){return this._map.has(z)}clear(){this._map.clear()}}const In=new RegExp(":enter","g"),li=new RegExp(":leave","g");function Je(ie,z,J,_t,Qt,Te={},Ye={},Qe,mi,Ui=[]){return(new xe).buildKeyframes(ie,z,J,_t,Qt,Te,Ye,Qe,mi,Ui)}class xe{buildKeyframes(z,J,_t,Qt,Te,Ye,Qe,mi,Ui,hn=[]){Ui=Ui||new He;const Tn=new Oi(z,J,Ui,Qt,Te,hn,[]);Tn.options=mi,Tn.currentTimeline.setStyles([Ye],null,Tn.errors,mi),Kt(this,_t,Tn);const $n=Tn.timelines.filter(po=>po.containsAnimation());if($n.length&&Object.keys(Qe).length){const po=$n[$n.length-1];po.allowOnlyTimelineStyles()||po.setStyles([Qe],null,Tn.errors,mi)}return $n.length?$n.map(po=>po.buildKeyframes()):[fe(J,[],[],[],0,0,"",!1)]}visitTrigger(z,J){}visitState(z,J){}visitTransition(z,J){}visitAnimateChild(z,J){const _t=J.subInstructions.consume(J.element);if(_t){const Qt=J.createSubContext(z.options),Te=J.currentTimeline.currentTime,Ye=this._visitSubInstructions(_t,Qt,Qt.options);Te!=Ye&&J.transformIntoNewTimeline(Ye)}J.previousNode=z}visitAnimateRef(z,J){const _t=J.createSubContext(z.options);_t.transformIntoNewTimeline(),this.visitReference(z.animation,_t),J.transformIntoNewTimeline(_t.currentTimeline.currentTime),J.previousNode=z}_visitSubInstructions(z,J,_t){let Te=J.currentTimeline.currentTime;const Ye=null!=_t.duration?Ae(_t.duration):null,Qe=null!=_t.delay?Ae(_t.delay):null;return 0!==Ye&&z.forEach(mi=>{const Ui=J.appendInstructionToTimeline(mi,Ye,Qe);Te=Math.max(Te,Ui.duration+Ui.delay)}),Te}visitReference(z,J){J.updateOptions(z.options,!0),Kt(this,z.animation,J),J.previousNode=z}visitSequence(z,J){const _t=J.subContextCount;let Qt=J;const Te=z.options;if(Te&&(Te.params||Te.delay)&&(Qt=J.createSubContext(Te),Qt.transformIntoNewTimeline(),null!=Te.delay)){6==Qt.previousNode.type&&(Qt.currentTimeline.snapshotCurrentStyles(),Qt.previousNode=hi);const Ye=Ae(Te.delay);Qt.delayNextStep(Ye)}z.steps.length&&(z.steps.forEach(Ye=>Kt(this,Ye,Qt)),Qt.currentTimeline.applyStylesToKeyframe(),Qt.subContextCount>_t&&Qt.transformIntoNewTimeline()),J.previousNode=z}visitGroup(z,J){const _t=[];let Qt=J.currentTimeline.currentTime;const Te=z.options&&z.options.delay?Ae(z.options.delay):0;z.steps.forEach(Ye=>{const Qe=J.createSubContext(z.options);Te&&Qe.delayNextStep(Te),Kt(this,Ye,Qe),Qt=Math.max(Qt,Qe.currentTimeline.currentTime),_t.push(Qe.currentTimeline)}),_t.forEach(Ye=>J.currentTimeline.mergeTimelineCollectedStyles(Ye)),J.transformIntoNewTimeline(Qt),J.previousNode=z}_visitTiming(z,J){if(z.dynamic){const _t=z.strValue;return qe(J.params?Ee(_t,J.params,J.errors):_t,J.errors)}return{duration:z.duration,delay:z.delay,easing:z.easing}}visitAnimate(z,J){const _t=J.currentAnimateTimings=this._visitTiming(z.timings,J),Qt=J.currentTimeline;_t.delay&&(J.incrementTime(_t.delay),Qt.snapshotCurrentStyles());const Te=z.style;5==Te.type?this.visitKeyframes(Te,J):(J.incrementTime(_t.duration),this.visitStyle(Te,J),Qt.applyStylesToKeyframe()),J.currentAnimateTimings=null,J.previousNode=z}visitStyle(z,J){const _t=J.currentTimeline,Qt=J.currentAnimateTimings;!Qt&&_t.getCurrentStyleProperties().length&&_t.forwardFrame();const Te=Qt&&Qt.easing||z.easing;z.isEmptyStep?_t.applyEmptyStep(Te):_t.setStyles(z.styles,Te,J.errors,J.options),J.previousNode=z}visitKeyframes(z,J){const _t=J.currentAnimateTimings,Qt=J.currentTimeline.duration,Te=_t.duration,Qe=J.createSubContext().currentTimeline;Qe.easing=_t.easing,z.styles.forEach(mi=>{Qe.forwardTime((mi.offset||0)*Te),Qe.setStyles(mi.styles,mi.easing,J.errors,J.options),Qe.applyStylesToKeyframe()}),J.currentTimeline.mergeTimelineCollectedStyles(Qe),J.transformIntoNewTimeline(Qt+Te),J.previousNode=z}visitQuery(z,J){const _t=J.currentTimeline.currentTime,Qt=z.options||{},Te=Qt.delay?Ae(Qt.delay):0;Te&&(6===J.previousNode.type||0==_t&&J.currentTimeline.getCurrentStyleProperties().length)&&(J.currentTimeline.snapshotCurrentStyles(),J.previousNode=hi);let Ye=_t;const Qe=J.invokeQuery(z.selector,z.originalSelector,z.limit,z.includeSelf,!!Qt.optional,J.errors);J.currentQueryTotal=Qe.length;let mi=null;Qe.forEach((Ui,hn)=>{J.currentQueryIndex=hn;const Tn=J.createSubContext(z.options,Ui);Te&&Tn.delayNextStep(Te),Ui===J.element&&(mi=Tn.currentTimeline),Kt(this,z.animation,Tn),Tn.currentTimeline.applyStylesToKeyframe(),Ye=Math.max(Ye,Tn.currentTimeline.currentTime)}),J.currentQueryIndex=0,J.currentQueryTotal=0,J.transformIntoNewTimeline(Ye),mi&&(J.currentTimeline.mergeTimelineCollectedStyles(mi),J.currentTimeline.snapshotCurrentStyles()),J.previousNode=z}visitStagger(z,J){const _t=J.parentContext,Qt=J.currentTimeline,Te=z.timings,Ye=Math.abs(Te.duration),Qe=Ye*(J.currentQueryTotal-1);let mi=Ye*J.currentQueryIndex;switch(Te.duration<0?"reverse":Te.easing){case"reverse":mi=Qe-mi;break;case"full":mi=_t.currentStaggerTime}const hn=J.currentTimeline;mi&&hn.delayNextStep(mi);const Tn=hn.currentTime;Kt(this,z.animation,J),J.previousNode=z,_t.currentStaggerTime=Qt.currentTime-Tn+(Qt.startTime-_t.currentTimeline.startTime)}}const hi={};class Oi{constructor(z,J,_t,Qt,Te,Ye,Qe,mi){this._driver=z,this.element=J,this.subInstructions=_t,this._enterClassName=Qt,this._leaveClassName=Te,this.errors=Ye,this.timelines=Qe,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=hi,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=mi||new gn(this._driver,J,0),Qe.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(z,J){if(!z)return;const _t=z;let Qt=this.options;null!=_t.duration&&(Qt.duration=Ae(_t.duration)),null!=_t.delay&&(Qt.delay=Ae(_t.delay));const Te=_t.params;if(Te){let Ye=Qt.params;Ye||(Ye=this.options.params={}),Object.keys(Te).forEach(Qe=>{(!J||!Ye.hasOwnProperty(Qe))&&(Ye[Qe]=Ee(Te[Qe],Ye,this.errors))})}}_copyOptions(){const z={};if(this.options){const J=this.options.params;if(J){const _t=z.params={};Object.keys(J).forEach(Qt=>{_t[Qt]=J[Qt]})}}return z}createSubContext(z=null,J,_t){const Qt=J||this.element,Te=new Oi(this._driver,Qt,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(Qt,_t||0));return Te.previousNode=this.previousNode,Te.currentAnimateTimings=this.currentAnimateTimings,Te.options=this._copyOptions(),Te.updateOptions(z),Te.currentQueryIndex=this.currentQueryIndex,Te.currentQueryTotal=this.currentQueryTotal,Te.parentContext=this,this.subContextCount++,Te}transformIntoNewTimeline(z){return this.previousNode=hi,this.currentTimeline=this.currentTimeline.fork(this.element,z),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(z,J,_t){const Qt={duration:null!=J?J:z.duration,delay:this.currentTimeline.currentTime+(null!=_t?_t:0)+z.delay,easing:""},Te=new kn(this._driver,z.element,z.keyframes,z.preStyleProps,z.postStyleProps,Qt,z.stretchStartingKeyframe);return this.timelines.push(Te),Qt}incrementTime(z){this.currentTimeline.forwardTime(this.currentTimeline.duration+z)}delayNextStep(z){z>0&&this.currentTimeline.delayNextStep(z)}invokeQuery(z,J,_t,Qt,Te,Ye){let Qe=[];if(Qt&&Qe.push(this.element),z.length>0){z=(z=z.replace(In,"."+this._enterClassName)).replace(li,"."+this._leaveClassName);let Ui=this._driver.query(this.element,z,1!=_t);0!==_t&&(Ui=_t<0?Ui.slice(Ui.length+_t,Ui.length):Ui.slice(0,_t)),Qe.push(...Ui)}return!Te&&0==Qe.length&&Ye.push(`\`query("${J}")\` returned zero elements. (Use \`query("${J}", { optional: true })\` if you wish to allow this.)`),Qe}}class gn{constructor(z,J,_t,Qt){this._driver=z,this.element=J,this.startTime=_t,this._elementTimelineStylesLookup=Qt,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(J),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(J,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(z){const J=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||J?(this.forwardTime(this.currentTime+z),J&&this.snapshotCurrentStyles()):this.startTime+=z}fork(z,J){return this.applyStylesToKeyframe(),new gn(this._driver,z,J||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(z){this.applyStylesToKeyframe(),this.duration=z,this._loadKeyframe()}_updateStyle(z,J){this._localTimelineStyles[z]=J,this._globalTimelineStyles[z]=J,this._styleSummary[z]={time:this.currentTime,value:J}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(z){z&&(this._previousKeyframe.easing=z),Object.keys(this._globalTimelineStyles).forEach(J=>{this._backFill[J]=this._globalTimelineStyles[J]||e.l3,this._currentKeyframe[J]=e.l3}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(z,J,_t,Qt){J&&(this._previousKeyframe.easing=J);const Te=Qt&&Qt.params||{},Ye=function Do(ie,z){const J={};let _t;return ie.forEach(Qt=>{"*"===Qt?(_t=_t||Object.keys(z),_t.forEach(Te=>{J[Te]=e.l3})):ri(Qt,!1,J)}),J}(z,this._globalTimelineStyles);Object.keys(Ye).forEach(Qe=>{const mi=Ee(Ye[Qe],Te,_t);this._pendingStyles[Qe]=mi,this._localTimelineStyles.hasOwnProperty(Qe)||(this._backFill[Qe]=this._globalTimelineStyles.hasOwnProperty(Qe)?this._globalTimelineStyles[Qe]:e.l3),this._updateStyle(Qe,mi)})}applyStylesToKeyframe(){const z=this._pendingStyles,J=Object.keys(z);0!=J.length&&(this._pendingStyles={},J.forEach(_t=>{this._currentKeyframe[_t]=z[_t]}),Object.keys(this._localTimelineStyles).forEach(_t=>{this._currentKeyframe.hasOwnProperty(_t)||(this._currentKeyframe[_t]=this._localTimelineStyles[_t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(z=>{const J=this._localTimelineStyles[z];this._pendingStyles[z]=J,this._updateStyle(z,J)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const z=[];for(let J in this._currentKeyframe)z.push(J);return z}mergeTimelineCollectedStyles(z){Object.keys(z._styleSummary).forEach(J=>{const _t=this._styleSummary[J],Qt=z._styleSummary[J];(!_t||Qt.time>_t.time)&&this._updateStyle(J,Qt.value)})}buildKeyframes(){this.applyStylesToKeyframe();const z=new Set,J=new Set,_t=1===this._keyframes.size&&0===this.duration;let Qt=[];this._keyframes.forEach((Qe,mi)=>{const Ui=ri(Qe,!0);Object.keys(Ui).forEach(hn=>{const Tn=Ui[hn];Tn==e.k1?z.add(hn):Tn==e.l3&&J.add(hn)}),_t||(Ui.offset=mi/this.duration),Qt.push(Ui)});const Te=z.size?ne(z.values()):[],Ye=J.size?ne(J.values()):[];if(_t){const Qe=Qt[0],mi=ei(Qe);Qe.offset=0,mi.offset=1,Qt=[Qe,mi]}return fe(this.element,Qt,Te,Ye,this.duration,this.startTime,this.easing,!1)}}class kn extends gn{constructor(z,J,_t,Qt,Te,Ye,Qe=!1){super(z,J,Ye.delay),this.keyframes=_t,this.preStyleProps=Qt,this.postStyleProps=Te,this._stretchStartingKeyframe=Qe,this.timings={duration:Ye.duration,delay:Ye.delay,easing:Ye.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let z=this.keyframes,{delay:J,duration:_t,easing:Qt}=this.timings;if(this._stretchStartingKeyframe&&J){const Te=[],Ye=_t+J,Qe=J/Ye,mi=ri(z[0],!1);mi.offset=0,Te.push(mi);const Ui=ri(z[0],!1);Ui.offset=so(Qe),Te.push(Ui);const hn=z.length-1;for(let Tn=1;Tn<=hn;Tn++){let $n=ri(z[Tn],!1);$n.offset=so((J+$n.offset*_t)/Ye),Te.push($n)}_t=Ye,J=0,Qt="",z=Te}return fe(this.element,z,this.preStyleProps,this.postStyleProps,_t,J,Qt,!0)}}function so(ie,z=3){const J=Math.pow(10,z-1);return Math.round(ie*J)/J}class qo{}class xo extends qo{normalizePropertyName(z,J){return Oe(z)}normalizeStyleValue(z,J,_t,Qt){let Te="";const Ye=_t.toString().trim();if(vo[J]&&0!==_t&&"0"!==_t)if("number"==typeof _t)Te="px";else{const Qe=_t.match(/^[+-]?[\d\.]+([a-z]*)$/);Qe&&0==Qe[1].length&&Qt.push(`Please provide a CSS unit value for ${z}:${_t}`)}return Ye+Te}}const vo=(()=>function Fr(ie){const z={};return ie.forEach(J=>z[J]=!0),z}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function co(ie,z,J,_t,Qt,Te,Ye,Qe,mi,Ui,hn,Tn,$n){return{type:0,element:ie,triggerName:z,isRemovalTransition:Qt,fromState:J,fromStyles:Te,toState:_t,toStyles:Ye,timelines:Qe,queriedElements:mi,preStyleProps:Ui,postStyleProps:hn,totalTime:Tn,errors:$n}}const Ii={};class Gn{constructor(z,J,_t){this._triggerName=z,this.ast=J,this._stateStyles=_t}match(z,J,_t,Qt){return function To(ie,z,J,_t,Qt){return ie.some(Te=>Te(z,J,_t,Qt))}(this.ast.matchers,z,J,_t,Qt)}buildStyles(z,J,_t){const Qt=this._stateStyles["*"],Te=this._stateStyles[z],Ye=Qt?Qt.buildStyles(J,_t):{};return Te?Te.buildStyles(J,_t):Ye}build(z,J,_t,Qt,Te,Ye,Qe,mi,Ui,hn){const Tn=[],$n=this.ast.options&&this.ast.options.params||Ii,Un=this.buildStyles(_t,Qe&&Qe.params||Ii,Tn),jn=mi&&mi.params||Ii,oo=this.buildStyles(Qt,jn,Tn),Ko=new Set,dr=new Map,is=new Map,Hr="void"===Qt,Ls={params:Object.assign(Object.assign({},$n),jn)},ds=hn?[]:Je(z,J,this.ast.animation,Te,Ye,Un,oo,Ls,Ui,Tn);let Sr=0;if(ds.forEach($s=>{Sr=Math.max($s.duration+$s.delay,Sr)}),Tn.length)return co(J,this._triggerName,_t,Qt,Hr,Un,oo,[],[],dr,is,Sr,Tn);ds.forEach($s=>{const Zs=$s.element,Aa=L(dr,Zs,{});$s.preStyleProps.forEach(Qs=>Aa[Qs]=!0);const ir=L(is,Zs,{});$s.postStyleProps.forEach(Qs=>ir[Qs]=!0),Zs!==J&&Ko.add(Zs)});const Js=ne(Ko.values());return co(J,this._triggerName,_t,Qt,Hr,Un,oo,ds,Js,dr,is,Sr)}}class Uo{constructor(z,J,_t){this.styles=z,this.defaultParams=J,this.normalizer=_t}buildStyles(z,J){const _t={},Qt=ei(this.defaultParams);return Object.keys(z).forEach(Te=>{const Ye=z[Te];null!=Ye&&(Qt[Te]=Ye)}),this.styles.styles.forEach(Te=>{if("string"!=typeof Te){const Ye=Te;Object.keys(Ye).forEach(Qe=>{let mi=Ye[Qe];mi.length>1&&(mi=Ee(mi,Qt,J));const Ui=this.normalizer.normalizePropertyName(Qe,J);mi=this.normalizer.normalizeStyleValue(Qe,Ui,mi,J),_t[Ui]=mi})}}),_t}}class Mo{constructor(z,J,_t){this.name=z,this.ast=J,this._normalizer=_t,this.transitionFactories=[],this.states={},J.states.forEach(Qt=>{this.states[Qt.name]=new Uo(Qt.style,Qt.options&&Qt.options.params||{},_t)}),Oo(this.states,"true","1"),Oo(this.states,"false","0"),J.transitions.forEach(Qt=>{this.transitionFactories.push(new Gn(z,Qt,this.states))}),this.fallbackTransition=function Qo(ie,z,J){return new Gn(ie,{type:1,animation:{type:2,steps:[],options:null},matchers:[(Ye,Qe)=>!0],options:null,queryCount:0,depCount:0},z)}(z,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(z,J,_t,Qt){return this.transitionFactories.find(Ye=>Ye.match(z,J,_t,Qt))||null}matchStyles(z,J,_t){return this.fallbackTransition.buildStyles(z,J,_t)}}function Oo(ie,z,J){ie.hasOwnProperty(z)?ie.hasOwnProperty(J)||(ie[J]=ie[z]):ie.hasOwnProperty(J)&&(ie[z]=ie[J])}const Bi=new He;class On{constructor(z,J,_t){this.bodyNode=z,this._driver=J,this._normalizer=_t,this._animations={},this._playersById={},this.players=[]}register(z,J){const _t=[],Qt=De(this._driver,J,_t);if(_t.length)throw new Error(`Unable to build the animation due to the following errors: ${_t.join("\n")}`);this._animations[z]=Qt}_buildPlayer(z,J,_t){const Qt=z.element,Te=r(0,this._normalizer,0,z.keyframes,J,_t);return this._driver.animate(Qt,Te,z.duration,z.delay,z.easing,[],!0)}create(z,J,_t={}){const Qt=[],Te=this._animations[z];let Ye;const Qe=new Map;if(Te?(Ye=Je(this._driver,J,Te,ct,rt,{},{},_t,Bi,Qt),Ye.forEach(hn=>{const Tn=L(Qe,hn.element,{});hn.postStyleProps.forEach($n=>Tn[$n]=null)})):(Qt.push("The requested animation doesn't exist or has already been destroyed"),Ye=[]),Qt.length)throw new Error(`Unable to create the animation due to the following errors: ${Qt.join("\n")}`);Qe.forEach((hn,Tn)=>{Object.keys(hn).forEach($n=>{hn[$n]=this._driver.computeStyle(Tn,$n,e.l3)})});const Ui=o(Ye.map(hn=>{const Tn=Qe.get(hn.element);return this._buildPlayer(hn,{},Tn)}));return this._playersById[z]=Ui,Ui.onDestroy(()=>this.destroy(z)),this.players.push(Ui),Ui}destroy(z){const J=this._getPlayer(z);J.destroy(),delete this._playersById[z];const _t=this.players.indexOf(J);_t>=0&&this.players.splice(_t,1)}_getPlayer(z){const J=this._playersById[z];if(!J)throw new Error(`Unable to find the timeline player referenced by ${z}`);return J}listen(z,J,_t,Qt){const Te=R(J,"","","");return a(this._getPlayer(z),_t,Te,Qt),()=>{}}command(z,J,_t,Qt){if("register"==_t)return void this.register(z,Qt[0]);if("create"==_t)return void this.create(z,J,Qt[0]||{});const Te=this._getPlayer(z);switch(_t){case"play":Te.play();break;case"pause":Te.pause();break;case"reset":Te.reset();break;case"restart":Te.restart();break;case"finish":Te.finish();break;case"init":Te.init();break;case"setPosition":Te.setPosition(parseFloat(Qt[0]));break;case"destroy":this.destroy(z)}}}const Wn="ng-animate-queued",Fe="ng-animate-disabled",qn=[],ao={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},lo={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Rn="__ng_removed";class Kr{constructor(z,J=""){this.namespaceId=J;const _t=z&&z.hasOwnProperty("value");if(this.value=function sr(ie){return null!=ie?ie:null}(_t?z.value:z),_t){const Te=ei(z);delete Te.value,this.options=Te}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(z){const J=z.params;if(J){const _t=this.options.params;Object.keys(J).forEach(Qt=>{null==_t[Qt]&&(_t[Qt]=J[Qt])})}}}const _r="void",rr=new Kr(_r);class Or{constructor(z,J,_t){this.id=z,this.hostElement=J,this._engine=_t,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+z,Vo(J,this._hostClassName)}listen(z,J,_t,Qt){if(!this._triggers.hasOwnProperty(J))throw new Error(`Unable to listen on the animation trigger event "${_t}" because the animation trigger "${J}" doesn't exist!`);if(null==_t||0==_t.length)throw new Error(`Unable to listen on the animation trigger "${J}" because the provided event is undefined!`);if(!function Ua(ie){return"start"==ie||"done"==ie}(_t))throw new Error(`The provided animation trigger event "${_t}" for the animation trigger "${J}" is not supported!`);const Te=L(this._elementListeners,z,[]),Ye={name:J,phase:_t,callback:Qt};Te.push(Ye);const Qe=L(this._engine.statesByElement,z,{});return Qe.hasOwnProperty(J)||(Vo(z,Lt),Vo(z,Lt+"-"+J),Qe[J]=rr),()=>{this._engine.afterFlush(()=>{const mi=Te.indexOf(Ye);mi>=0&&Te.splice(mi,1),this._triggers[J]||delete Qe[J]})}}register(z,J){return!this._triggers[z]&&(this._triggers[z]=J,!0)}_getTrigger(z){const J=this._triggers[z];if(!J)throw new Error(`The provided animation trigger "${z}" has not been registered!`);return J}trigger(z,J,_t,Qt=!0){const Te=this._getTrigger(J),Ye=new Os(this.id,J,z);let Qe=this._engine.statesByElement.get(z);Qe||(Vo(z,Lt),Vo(z,Lt+"-"+J),this._engine.statesByElement.set(z,Qe={}));let mi=Qe[J];const Ui=new Kr(_t,this.id);if(!(_t&&_t.hasOwnProperty("value"))&&mi&&Ui.absorbOptions(mi.options),Qe[J]=Ui,mi||(mi=rr),Ui.value!==_r&&mi.value===Ui.value){if(!function nl(ie,z){const J=Object.keys(ie),_t=Object.keys(z);if(J.length!=_t.length)return!1;for(let Qt=0;Qt<J.length;Qt++){const Te=J[Qt];if(!z.hasOwnProperty(Te)||ie[Te]!==z[Te])return!1}return!0}(mi.params,Ui.params)){const jn=[],oo=Te.matchStyles(mi.value,mi.params,jn),Ko=Te.matchStyles(Ui.value,Ui.params,jn);jn.length?this._engine.reportError(jn):this._engine.afterFlush(()=>{he(z,oo),Xt(z,Ko)})}return}const $n=L(this._engine.playersByElement,z,[]);$n.forEach(jn=>{jn.namespaceId==this.id&&jn.triggerName==J&&jn.queued&&jn.destroy()});let po=Te.matchTransition(mi.value,Ui.value,z,Ui.params),Un=!1;if(!po){if(!Qt)return;po=Te.fallbackTransition,Un=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:z,triggerName:J,transition:po,fromState:mi,toState:Ui,player:Ye,isFallbackTransition:Un}),Un||(Vo(z,Wn),Ye.onStart(()=>{Ma(z,Wn)})),Ye.onDone(()=>{let jn=this.players.indexOf(Ye);jn>=0&&this.players.splice(jn,1);const oo=this._engine.playersByElement.get(z);if(oo){let Ko=oo.indexOf(Ye);Ko>=0&&oo.splice(Ko,1)}}),this.players.push(Ye),$n.push(Ye),Ye}deregister(z){delete this._triggers[z],this._engine.statesByElement.forEach((J,_t)=>{delete J[z]}),this._elementListeners.forEach((J,_t)=>{this._elementListeners.set(_t,J.filter(Qt=>Qt.name!=z))})}clearElementCache(z){this._engine.statesByElement.delete(z),this._elementListeners.delete(z);const J=this._engine.playersByElement.get(z);J&&(J.forEach(_t=>_t.destroy()),this._engine.playersByElement.delete(z))}_signalRemovalForInnerTriggers(z,J){const _t=this._engine.driver.query(z,de,!0);_t.forEach(Qt=>{if(Qt[Rn])return;const Te=this._engine.fetchNamespacesByElement(Qt);Te.size?Te.forEach(Ye=>Ye.triggerLeaveAnimation(Qt,J,!1,!0)):this.clearElementCache(Qt)}),this._engine.afterFlushAnimationsDone(()=>_t.forEach(Qt=>this.clearElementCache(Qt)))}triggerLeaveAnimation(z,J,_t,Qt){const Te=this._engine.statesByElement.get(z);if(Te){const Ye=[];if(Object.keys(Te).forEach(Qe=>{if(this._triggers[Qe]){const mi=this.trigger(z,Qe,_r,Qt);mi&&Ye.push(mi)}}),Ye.length)return this._engine.markElementAsRemoved(this.id,z,!0,J),_t&&o(Ye).onDone(()=>this._engine.processLeaveNode(z)),!0}return!1}prepareLeaveAnimationListeners(z){const J=this._elementListeners.get(z),_t=this._engine.statesByElement.get(z);if(J&&_t){const Qt=new Set;J.forEach(Te=>{const Ye=Te.name;if(Qt.has(Ye))return;Qt.add(Ye);const mi=this._triggers[Ye].fallbackTransition,Ui=_t[Ye]||rr,hn=new Kr(_r),Tn=new Os(this.id,Ye,z);this._engine.totalQueuedPlayers++,this._queue.push({element:z,triggerName:Ye,transition:mi,fromState:Ui,toState:hn,player:Tn,isFallbackTransition:!0})})}}removeNode(z,J){const _t=this._engine;if(z.childElementCount&&this._signalRemovalForInnerTriggers(z,J),this.triggerLeaveAnimation(z,J,!0))return;let Qt=!1;if(_t.totalAnimations){const Te=_t.players.length?_t.playersByQueriedElement.get(z):[];if(Te&&Te.length)Qt=!0;else{let Ye=z;for(;Ye=Ye.parentNode;)if(_t.statesByElement.get(Ye)){Qt=!0;break}}}if(this.prepareLeaveAnimationListeners(z),Qt)_t.markElementAsRemoved(this.id,z,!1,J);else{const Te=z[Rn];(!Te||Te===ao)&&(_t.afterFlush(()=>this.clearElementCache(z)),_t.destroyInnerAnimations(z),_t._onRemovalComplete(z,J))}}insertNode(z,J){Vo(z,this._hostClassName)}drainQueuedTransitions(z){const J=[];return this._queue.forEach(_t=>{const Qt=_t.player;if(Qt.destroyed)return;const Te=_t.element,Ye=this._elementListeners.get(Te);Ye&&Ye.forEach(Qe=>{if(Qe.name==_t.triggerName){const mi=R(Te,_t.triggerName,_t.fromState.value,_t.toState.value);mi._data=z,a(_t.player,Qe.phase,mi,Qe.callback)}}),Qt.markedForDestroy?this._engine.afterFlush(()=>{Qt.destroy()}):J.push(_t)}),this._queue=[],J.sort((_t,Qt)=>{const Te=_t.transition.ast.depCount,Ye=Qt.transition.ast.depCount;return 0==Te||0==Ye?Te-Ye:this._engine.driver.containsElement(_t.element,Qt.element)?1:-1})}destroy(z){this.players.forEach(J=>J.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,z)}elementContainsData(z){let J=!1;return this._elementListeners.has(z)&&(J=!0),J=!!this._queue.find(_t=>_t.element===z)||J,J}}class uo{constructor(z,J,_t){this.bodyNode=z,this.driver=J,this._normalizer=_t,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(Qt,Te)=>{}}_onRemovalComplete(z,J){this.onRemovalComplete(z,J)}get queuedPlayers(){const z=[];return this._namespaceList.forEach(J=>{J.players.forEach(_t=>{_t.queued&&z.push(_t)})}),z}createNamespace(z,J){const _t=new Or(z,J,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,J)?this._balanceNamespaceList(_t,J):(this.newHostElements.set(J,_t),this.collectEnterElement(J)),this._namespaceLookup[z]=_t}_balanceNamespaceList(z,J){const _t=this._namespaceList.length-1;if(_t>=0){let Qt=!1;for(let Te=_t;Te>=0;Te--)if(this.driver.containsElement(this._namespaceList[Te].hostElement,J)){this._namespaceList.splice(Te+1,0,z),Qt=!0;break}Qt||this._namespaceList.splice(0,0,z)}else this._namespaceList.push(z);return this.namespacesByHostElement.set(J,z),z}register(z,J){let _t=this._namespaceLookup[z];return _t||(_t=this.createNamespace(z,J)),_t}registerTrigger(z,J,_t){let Qt=this._namespaceLookup[z];Qt&&Qt.register(J,_t)&&this.totalAnimations++}destroy(z,J){if(!z)return;const _t=this._fetchNamespace(z);this.afterFlush(()=>{this.namespacesByHostElement.delete(_t.hostElement),delete this._namespaceLookup[z];const Qt=this._namespaceList.indexOf(_t);Qt>=0&&this._namespaceList.splice(Qt,1)}),this.afterFlushAnimationsDone(()=>_t.destroy(J))}_fetchNamespace(z){return this._namespaceLookup[z]}fetchNamespacesByElement(z){const J=new Set,_t=this.statesByElement.get(z);if(_t){const Qt=Object.keys(_t);for(let Te=0;Te<Qt.length;Te++){const Ye=_t[Qt[Te]].namespaceId;if(Ye){const Qe=this._fetchNamespace(Ye);Qe&&J.add(Qe)}}}return J}trigger(z,J,_t,Qt){if(wr(J)){const Te=this._fetchNamespace(z);if(Te)return Te.trigger(J,_t,Qt),!0}return!1}insertNode(z,J,_t,Qt){if(!wr(J))return;const Te=J[Rn];if(Te&&Te.setForRemoval){Te.setForRemoval=!1,Te.setForMove=!0;const Ye=this.collectedLeaveElements.indexOf(J);Ye>=0&&this.collectedLeaveElements.splice(Ye,1)}if(z){const Ye=this._fetchNamespace(z);Ye&&Ye.insertNode(J,_t)}Qt&&this.collectEnterElement(J)}collectEnterElement(z){this.collectedEnterElements.push(z)}markElementAsDisabled(z,J){J?this.disabledNodes.has(z)||(this.disabledNodes.add(z),Vo(z,Fe)):this.disabledNodes.has(z)&&(this.disabledNodes.delete(z),Ma(z,Fe))}removeNode(z,J,_t,Qt){if(wr(J)){const Te=z?this._fetchNamespace(z):null;if(Te?Te.removeNode(J,Qt):this.markElementAsRemoved(z,J,!1,Qt),_t){const Ye=this.namespacesByHostElement.get(J);Ye&&Ye.id!==z&&Ye.removeNode(J,Qt)}}else this._onRemovalComplete(J,Qt)}markElementAsRemoved(z,J,_t,Qt){this.collectedLeaveElements.push(J),J[Rn]={namespaceId:z,setForRemoval:Qt,hasAnimation:_t,removedBeforeQueried:!1}}listen(z,J,_t,Qt,Te){return wr(J)?this._fetchNamespace(z).listen(J,_t,Qt,Te):()=>{}}_buildInstruction(z,J,_t,Qt,Te){return z.transition.build(this.driver,z.element,z.fromState.value,z.toState.value,_t,Qt,z.fromState.options,z.toState.options,J,Te)}destroyInnerAnimations(z){let J=this.driver.query(z,de,!0);J.forEach(_t=>this.destroyActiveAnimationsForElement(_t)),0!=this.playersByQueriedElement.size&&(J=this.driver.query(z,ce,!0),J.forEach(_t=>this.finishActiveQueriedAnimationOnElement(_t)))}destroyActiveAnimationsForElement(z){const J=this.playersByElement.get(z);J&&J.forEach(_t=>{_t.queued?_t.markedForDestroy=!0:_t.destroy()})}finishActiveQueriedAnimationOnElement(z){const J=this.playersByQueriedElement.get(z);J&&J.forEach(_t=>_t.finish())}whenRenderingDone(){return new Promise(z=>{if(this.players.length)return o(this.players).onDone(()=>z());z()})}processLeaveNode(z){var J;const _t=z[Rn];if(_t&&_t.setForRemoval){if(z[Rn]=ao,_t.namespaceId){this.destroyInnerAnimations(z);const Qt=this._fetchNamespace(_t.namespaceId);Qt&&Qt.clearElementCache(z)}this._onRemovalComplete(z,_t.setForRemoval)}(null===(J=z.classList)||void 0===J?void 0:J.contains(Fe))&&this.markElementAsDisabled(z,!1),this.driver.query(z,".ng-animate-disabled",!0).forEach(Qt=>{this.markElementAsDisabled(Qt,!1)})}flush(z=-1){let J=[];if(this.newHostElements.size&&(this.newHostElements.forEach((_t,Qt)=>this._balanceNamespaceList(_t,Qt)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let _t=0;_t<this.collectedEnterElements.length;_t++)Vo(this.collectedEnterElements[_t],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const _t=[];try{J=this._flushAnimations(_t,z)}finally{for(let Qt=0;Qt<_t.length;Qt++)_t[Qt]()}}else for(let _t=0;_t<this.collectedLeaveElements.length;_t++)this.processLeaveNode(this.collectedLeaveElements[_t]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(_t=>_t()),this._flushFns=[],this._whenQuietFns.length){const _t=this._whenQuietFns;this._whenQuietFns=[],J.length?o(J).onDone(()=>{_t.forEach(Qt=>Qt())}):_t.forEach(Qt=>Qt())}}reportError(z){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${z.join("\n")}`)}_flushAnimations(z,J){const _t=new He,Qt=[],Te=new Map,Ye=[],Qe=new Map,mi=new Map,Ui=new Map,hn=new Set;this.disabledNodes.forEach(Sn=>{hn.add(Sn);const Xn=this.driver.query(Sn,".ng-animate-queued",!0);for(let Nn=0;Nn<Xn.length;Nn++)hn.add(Xn[Nn])});const Tn=this.bodyNode,$n=Array.from(this.statesByElement.keys()),po=ya($n,this.collectedEnterElements),Un=new Map;let jn=0;po.forEach((Sn,Xn)=>{const Nn=ct+jn++;Un.set(Xn,Nn),Sn.forEach(bo=>Vo(bo,Nn))});const oo=[],Ko=new Set,dr=new Set;for(let Sn=0;Sn<this.collectedLeaveElements.length;Sn++){const Xn=this.collectedLeaveElements[Sn],Nn=Xn[Rn];Nn&&Nn.setForRemoval&&(oo.push(Xn),Ko.add(Xn),Nn.hasAnimation?this.driver.query(Xn,".ng-star-inserted",!0).forEach(bo=>Ko.add(bo)):dr.add(Xn))}const is=new Map,Hr=ya($n,Array.from(Ko));Hr.forEach((Sn,Xn)=>{const Nn=rt+jn++;is.set(Xn,Nn),Sn.forEach(bo=>Vo(bo,Nn))}),z.push(()=>{po.forEach((Sn,Xn)=>{const Nn=Un.get(Xn);Sn.forEach(bo=>Ma(bo,Nn))}),Hr.forEach((Sn,Xn)=>{const Nn=is.get(Xn);Sn.forEach(bo=>Ma(bo,Nn))}),oo.forEach(Sn=>{this.processLeaveNode(Sn)})});const Ls=[],ds=[];for(let Sn=this._namespaceList.length-1;Sn>=0;Sn--)this._namespaceList[Sn].drainQueuedTransitions(J).forEach(Nn=>{const bo=Nn.player,Eo=Nn.element;if(Ls.push(bo),this.collectedEnterElements.length){const ns=Eo[Rn];if(ns&&ns.setForMove)return void bo.destroy()}const Ns=!Tn||!this.driver.containsElement(Tn,Eo),Ps=is.get(Eo),ra=Un.get(Eo),lr=this._buildInstruction(Nn,_t,ra,Ps,Ns);if(lr.errors&&lr.errors.length)ds.push(lr);else{if(Ns)return bo.onStart(()=>he(Eo,lr.fromStyles)),bo.onDestroy(()=>Xt(Eo,lr.toStyles)),void Qt.push(bo);if(Nn.isFallbackTransition)return bo.onStart(()=>he(Eo,lr.fromStyles)),bo.onDestroy(()=>Xt(Eo,lr.toStyles)),void Qt.push(bo);lr.timelines.forEach(ns=>ns.stretchStartingKeyframe=!0),_t.append(Eo,lr.timelines),Ye.push({instruction:lr,player:bo,element:Eo}),lr.queriedElements.forEach(ns=>L(Qe,ns,[]).push(bo)),lr.preStyleProps.forEach((ns,Ss)=>{const ba=Object.keys(ns);if(ba.length){let jr=mi.get(Ss);jr||mi.set(Ss,jr=new Set),ba.forEach(Fs=>jr.add(Fs))}}),lr.postStyleProps.forEach((ns,Ss)=>{const ba=Object.keys(ns);let jr=Ui.get(Ss);jr||Ui.set(Ss,jr=new Set),ba.forEach(Fs=>jr.add(Fs))})}});if(ds.length){const Sn=[];ds.forEach(Xn=>{Sn.push(`@${Xn.triggerName} has failed due to:\n`),Xn.errors.forEach(Nn=>Sn.push(`- ${Nn}\n`))}),Ls.forEach(Xn=>Xn.destroy()),this.reportError(Sn)}const Sr=new Map,Js=new Map;Ye.forEach(Sn=>{const Xn=Sn.element;_t.has(Xn)&&(Js.set(Xn,Xn),this._beforeAnimationBuild(Sn.player.namespaceId,Sn.instruction,Sr))}),Qt.forEach(Sn=>{const Xn=Sn.element;this._getPreviousPlayers(Xn,!1,Sn.namespaceId,Sn.triggerName,null).forEach(bo=>{L(Sr,Xn,[]).push(bo),bo.destroy()})});const $s=oo.filter(Sn=>Va(Sn,mi,Ui)),Zs=new Map;us(Zs,this.driver,dr,Ui,e.l3).forEach(Sn=>{Va(Sn,mi,Ui)&&$s.push(Sn)});const ir=new Map;po.forEach((Sn,Xn)=>{us(ir,this.driver,new Set(Sn),mi,e.k1)}),$s.forEach(Sn=>{const Xn=Zs.get(Sn),Nn=ir.get(Sn);Zs.set(Sn,Object.assign(Object.assign({},Xn),Nn))});const Qs=[],ja=[],ps={};Ye.forEach(Sn=>{const{element:Xn,player:Nn,instruction:bo}=Sn;if(_t.has(Xn)){if(hn.has(Xn))return Nn.onDestroy(()=>Xt(Xn,bo.toStyles)),Nn.disabled=!0,Nn.overrideTotalTime(bo.totalTime),void Qt.push(Nn);let Eo=ps;if(Js.size>1){let Ps=Xn;const ra=[];for(;Ps=Ps.parentNode;){const lr=Js.get(Ps);if(lr){Eo=lr;break}ra.push(Ps)}ra.forEach(lr=>Js.set(lr,Eo))}const Ns=this._buildAnimation(Nn.namespaceId,bo,Sr,Te,ir,Zs);if(Nn.setRealPlayer(Ns),Eo===ps)Qs.push(Nn);else{const Ps=this.playersByElement.get(Eo);Ps&&Ps.length&&(Nn.parentPlayer=o(Ps)),Qt.push(Nn)}}else he(Xn,bo.fromStyles),Nn.onDestroy(()=>Xt(Xn,bo.toStyles)),ja.push(Nn),hn.has(Xn)&&Qt.push(Nn)}),ja.forEach(Sn=>{const Xn=Te.get(Sn.element);if(Xn&&Xn.length){const Nn=o(Xn);Sn.setRealPlayer(Nn)}}),Qt.forEach(Sn=>{Sn.parentPlayer?Sn.syncPlayerEvents(Sn.parentPlayer):Sn.destroy()});for(let Sn=0;Sn<oo.length;Sn++){const Xn=oo[Sn],Nn=Xn[Rn];if(Ma(Xn,rt),Nn&&Nn.hasAnimation)continue;let bo=[];if(Qe.size){let Ns=Qe.get(Xn);Ns&&Ns.length&&bo.push(...Ns);let Ps=this.driver.query(Xn,ce,!0);for(let ra=0;ra<Ps.length;ra++){let lr=Qe.get(Ps[ra]);lr&&lr.length&&bo.push(...lr)}}const Eo=bo.filter(Ns=>!Ns.destroyed);Eo.length?dl(this,Xn,Eo):this.processLeaveNode(Xn)}return oo.length=0,Qs.forEach(Sn=>{this.players.push(Sn),Sn.onDone(()=>{Sn.destroy();const Xn=this.players.indexOf(Sn);this.players.splice(Xn,1)}),Sn.play()}),Qs}elementContainsData(z,J){let _t=!1;const Qt=J[Rn];return Qt&&Qt.setForRemoval&&(_t=!0),this.playersByElement.has(J)&&(_t=!0),this.playersByQueriedElement.has(J)&&(_t=!0),this.statesByElement.has(J)&&(_t=!0),this._fetchNamespace(z).elementContainsData(J)||_t}afterFlush(z){this._flushFns.push(z)}afterFlushAnimationsDone(z){this._whenQuietFns.push(z)}_getPreviousPlayers(z,J,_t,Qt,Te){let Ye=[];if(J){const Qe=this.playersByQueriedElement.get(z);Qe&&(Ye=Qe)}else{const Qe=this.playersByElement.get(z);if(Qe){const mi=!Te||Te==_r;Qe.forEach(Ui=>{Ui.queued||!mi&&Ui.triggerName!=Qt||Ye.push(Ui)})}}return(_t||Qt)&&(Ye=Ye.filter(Qe=>!(_t&&_t!=Qe.namespaceId||Qt&&Qt!=Qe.triggerName))),Ye}_beforeAnimationBuild(z,J,_t){const Te=J.element,Ye=J.isRemovalTransition?void 0:z,Qe=J.isRemovalTransition?void 0:J.triggerName;for(const mi of J.timelines){const Ui=mi.element,hn=Ui!==Te,Tn=L(_t,Ui,[]);this._getPreviousPlayers(Ui,hn,Ye,Qe,J.toState).forEach(po=>{const Un=po.getRealPlayer();Un.beforeDestroy&&Un.beforeDestroy(),po.destroy(),Tn.push(po)})}he(Te,J.fromStyles)}_buildAnimation(z,J,_t,Qt,Te,Ye){const Qe=J.triggerName,mi=J.element,Ui=[],hn=new Set,Tn=new Set,$n=J.timelines.map(Un=>{const jn=Un.element;hn.add(jn);const oo=jn[Rn];if(oo&&oo.removedBeforeQueried)return new e.ZN(Un.duration,Un.delay);const Ko=jn!==mi,dr=function js(ie){const z=[];return ia(ie,z),z}((_t.get(jn)||qn).map(Sr=>Sr.getRealPlayer())).filter(Sr=>!!Sr.element&&Sr.element===jn),is=Te.get(jn),Hr=Ye.get(jn),Ls=r(0,this._normalizer,0,Un.keyframes,is,Hr),ds=this._buildPlayer(Un,Ls,dr);if(Un.subTimeline&&Qt&&Tn.add(jn),Ko){const Sr=new Os(z,Qe,jn);Sr.setRealPlayer(ds),Ui.push(Sr)}return ds});Ui.forEach(Un=>{L(this.playersByQueriedElement,Un.element,[]).push(Un),Un.onDone(()=>function Wr(ie,z,J){let _t;if(ie instanceof Map){if(_t=ie.get(z),_t){if(_t.length){const Qt=_t.indexOf(J);_t.splice(Qt,1)}0==_t.length&&ie.delete(z)}}else if(_t=ie[z],_t){if(_t.length){const Qt=_t.indexOf(J);_t.splice(Qt,1)}0==_t.length&&delete ie[z]}return _t}(this.playersByQueriedElement,Un.element,Un))}),hn.forEach(Un=>Vo(Un,_e));const po=o($n);return po.onDestroy(()=>{hn.forEach(Un=>Ma(Un,_e)),Xt(mi,J.toStyles)}),Tn.forEach(Un=>{L(Qt,Un,[]).push(po)}),po}_buildPlayer(z,J,_t){return J.length>0?this.driver.animate(z.element,J,z.duration,z.delay,z.easing,_t):new e.ZN(z.duration,z.delay)}}class Os{constructor(z,J,_t){this.namespaceId=z,this.triggerName=J,this.element=_t,this._player=new e.ZN,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(z){this._containsRealPlayer||(this._player=z,Object.keys(this._queuedCallbacks).forEach(J=>{this._queuedCallbacks[J].forEach(_t=>a(z,J,void 0,_t))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(z.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(z){this.totalTime=z}syncPlayerEvents(z){const J=this._player;J.triggerCallback&&z.onStart(()=>J.triggerCallback("start")),z.onDone(()=>this.finish()),z.onDestroy(()=>this.destroy())}_queueEvent(z,J){L(this._queuedCallbacks,z,[]).push(J)}onDone(z){this.queued&&this._queueEvent("done",z),this._player.onDone(z)}onStart(z){this.queued&&this._queueEvent("start",z),this._player.onStart(z)}onDestroy(z){this.queued&&this._queueEvent("destroy",z),this._player.onDestroy(z)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(z){this.queued||this._player.setPosition(z)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(z){const J=this._player;J.triggerCallback&&J.triggerCallback(z)}}function wr(ie){return ie&&1===ie.nodeType}function Cr(ie,z){const J=ie.style.display;return ie.style.display=null!=z?z:"none",J}function us(ie,z,J,_t,Qt){const Te=[];J.forEach(mi=>Te.push(Cr(mi)));const Ye=[];_t.forEach((mi,Ui)=>{const hn={};mi.forEach(Tn=>{const $n=hn[Tn]=z.computeStyle(Ui,Tn,Qt);(!$n||0==$n.length)&&(Ui[Rn]=lo,Ye.push(Ui))}),ie.set(Ui,hn)});let Qe=0;return J.forEach(mi=>Cr(mi,Te[Qe++])),Ye}function ya(ie,z){const J=new Map;if(ie.forEach(Qe=>J.set(Qe,[])),0==z.length)return J;const Qt=new Set(z),Te=new Map;function Ye(Qe){if(!Qe)return 1;let mi=Te.get(Qe);if(mi)return mi;const Ui=Qe.parentNode;return mi=J.has(Ui)?Ui:Qt.has(Ui)?1:Ye(Ui),Te.set(Qe,mi),mi}return z.forEach(Qe=>{const mi=Ye(Qe);1!==mi&&J.get(mi).push(Qe)}),J}function Vo(ie,z){var J;null===(J=ie.classList)||void 0===J||J.add(z)}function Ma(ie,z){var J;null===(J=ie.classList)||void 0===J||J.remove(z)}function dl(ie,z,J){o(J).onDone(()=>ie.processLeaveNode(z))}function ia(ie,z){for(let J=0;J<ie.length;J++){const _t=ie[J];_t instanceof e.ZE?ia(_t.players,z):z.push(_t)}}function Va(ie,z,J){const _t=J.get(ie);if(!_t)return!1;let Qt=z.get(ie);return Qt?_t.forEach(Te=>Qt.add(Te)):z.set(ie,_t),J.delete(ie),!0}class Ys{constructor(z,J,_t){this.bodyNode=z,this._driver=J,this._normalizer=_t,this._triggerCache={},this.onRemovalComplete=(Qt,Te)=>{},this._transitionEngine=new uo(z,J,_t),this._timelineEngine=new On(z,J,_t),this._transitionEngine.onRemovalComplete=(Qt,Te)=>this.onRemovalComplete(Qt,Te)}registerTrigger(z,J,_t,Qt,Te){const Ye=z+"-"+Qt;let Qe=this._triggerCache[Ye];if(!Qe){const mi=[],Ui=De(this._driver,Te,mi);if(mi.length)throw new Error(`The animation trigger "${Qt}" has failed to build due to the following errors:\n - ${mi.join("\n - ")}`);Qe=function yo(ie,z,J){return new Mo(ie,z,J)}(Qt,Ui,this._normalizer),this._triggerCache[Ye]=Qe}this._transitionEngine.registerTrigger(J,Qt,Qe)}register(z,J){this._transitionEngine.register(z,J)}destroy(z,J){this._transitionEngine.destroy(z,J)}onInsert(z,J,_t,Qt){this._transitionEngine.insertNode(z,J,_t,Qt)}onRemove(z,J,_t,Qt){this._transitionEngine.removeNode(z,J,Qt||!1,_t)}disableAnimations(z,J){this._transitionEngine.markElementAsDisabled(z,J)}process(z,J,_t,Qt){if("@"==_t.charAt(0)){const[Te,Ye]=W(_t);this._timelineEngine.command(Te,J,Ye,Qt)}else this._transitionEngine.trigger(z,J,_t,Qt)}listen(z,J,_t,Qt,Te){if("@"==_t.charAt(0)){const[Ye,Qe]=W(_t);return this._timelineEngine.listen(Ye,J,Qe,Te)}return this._transitionEngine.listen(z,J,_t,Qt,Te)}flush(z=-1){this._transitionEngine.flush(z)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function ol(ie,z){let J=null,_t=null;return Array.isArray(z)&&z.length?(J=ts(z[0]),z.length>1&&(_t=ts(z[z.length-1]))):z&&(J=ts(z)),J||_t?new Xs(ie,J,_t):null}let Xs=(()=>{class ie{constructor(J,_t,Qt){this._element=J,this._startStyles=_t,this._endStyles=Qt,this._state=0;let Te=ie.initialStylesByElement.get(J);Te||ie.initialStylesByElement.set(J,Te={}),this._initialStyles=Te}start(){this._state<1&&(this._startStyles&&Xt(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Xt(this._element,this._initialStyles),this._endStyles&&(Xt(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(ie.initialStylesByElement.delete(this._element),this._startStyles&&(he(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(he(this._element,this._endStyles),this._endStyles=null),Xt(this._element,this._initialStyles),this._state=3)}}return ie.initialStylesByElement=new WeakMap,ie})();function ts(ie){let z=null;const J=Object.keys(ie);for(let _t=0;_t<J.length;_t++){const Qt=J[_t];rl(Qt)&&(z=z||{},z[Qt]=ie[Qt])}return z}function rl(ie){return"display"===ie||"position"===ie}const es="animation",Go="animationend";class na{constructor(z,J,_t,Qt,Te,Ye,Qe){this._element=z,this._name=J,this._duration=_t,this._delay=Qt,this._easing=Te,this._fillMode=Ye,this._onDoneFn=Qe,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=mi=>this._handleCallback(mi)}apply(){(function zr(ie,z){const J=Es(ie,"").trim();let _t=0;J.length&&(_t=function ar(ie,z){let J=0;for(let _t=0;_t<ie.length;_t++)ie.charAt(_t)===z&&J++;return J}(J,",")+1,z=`${J}, ${z}`),tr(ie,"",z)})(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),kr(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){Ar(this._element,this._name,"paused")}resume(){Ar(this._element,this._name,"running")}setPosition(z){const J=Br(this._element,this._name);this._position=z*this._duration,tr(this._element,"Delay",`-${this._position}ms`,J)}getPosition(){return this._position}_handleCallback(z){const J=z._ngTestManualTimestamp||Date.now(),_t=1e3*parseFloat(z.elapsedTime.toFixed(3));z.animationName==this._name&&Math.max(J-this._startTime,0)>=this._delay&&_t>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),kr(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function oa(ie,z){const _t=Es(ie,"").split(","),Qt=pa(_t,z);Qt>=0&&(_t.splice(Qt,1),tr(ie,"",_t.join(",")))}(this._element,this._name))}}function Ar(ie,z,J){tr(ie,"PlayState",J,Br(ie,z))}function Br(ie,z){const J=Es(ie,"");return J.indexOf(",")>0?pa(J.split(","),z):pa([J],z)}function pa(ie,z){for(let J=0;J<ie.length;J++)if(ie[J].indexOf(z)>=0)return J;return-1}function kr(ie,z,J){J?ie.removeEventListener(Go,z):ie.addEventListener(Go,z)}function tr(ie,z,J,_t){const Qt=es+z;if(null!=_t){const Te=ie.style[Qt];if(Te.length){const Ye=Te.split(",");Ye[_t]=J,J=Ye.join(",")}}ie.style[Qt]=J}function Es(ie,z){return ie.style[es+z]||""}class Cs{constructor(z,J,_t,Qt,Te,Ye,Qe,mi){this.element=z,this.keyframes=J,this.animationName=_t,this._duration=Qt,this._delay=Te,this._finalStyles=Qe,this._specialStyles=mi,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=Ye||"linear",this.totalTime=Qt+Te,this._buildStyler()}onStart(z){this._onStartFns.push(z)}onDone(z){this._onDoneFns.push(z)}onDestroy(z){this._onDestroyFns.push(z)}destroy(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(z=>z()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(z=>z()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(z=>z()),this._onStartFns=[]}finish(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(z){this._styler.setPosition(z)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new na(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(z){const J="start"==z?this._onStartFns:this._onDoneFns;J.forEach(_t=>_t()),J.length=0}beforeDestroy(){this.init();const z={};if(this.hasStarted()){const J=this._state>=3;Object.keys(this._finalStyles).forEach(_t=>{"offset"!=_t&&(z[_t]=J?this._finalStyles[_t]:Zt(this.element,_t))})}this.currentSnapshot=z}}class hr extends e.ZN{constructor(z,J){super(),this.element=z,this._startingStyles={},this.__initialized=!1,this._styles=at(J)}init(){this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(z=>{this._startingStyles[z]=this.element.style[z]}),super.init())}play(){!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(z=>this.element.style.setProperty(z,this._styles[z])),super.play())}destroy(){!this._startingStyles||(Object.keys(this._startingStyles).forEach(z=>{const J=this._startingStyles[z];J?this.element.style.setProperty(z,J):this.element.style.removeProperty(z)}),this._startingStyles=null,super.destroy())}}class hs{constructor(){this._count=0}validateStyleProperty(z){return Ut(z)}matchesElement(z,J){return!1}containsElement(z,J){return Ct(z,J)}query(z,J,_t){return bt(z,J,_t)}computeStyle(z,J,_t){return window.getComputedStyle(z)[J]}buildKeyframeElement(z,J,_t){_t=_t.map(Qe=>at(Qe));let Qt=`@keyframes ${J} {\n`,Te="";_t.forEach(Qe=>{Te=" ";const mi=parseFloat(Qe.offset);Qt+=`${Te}${100*mi}% {\n`,Te+=" ",Object.keys(Qe).forEach(Ui=>{const hn=Qe[Ui];switch(Ui){case"offset":return;case"easing":return void(hn&&(Qt+=`${Te}animation-timing-function: ${hn};\n`));default:return void(Qt+=`${Te}${Ui}: ${hn};\n`)}}),Qt+=`${Te}}\n`}),Qt+="}\n";const Ye=document.createElement("style");return Ye.textContent=Qt,Ye}animate(z,J,_t,Qt,Te,Ye=[],Qe){const mi=Ye.filter(oo=>oo instanceof Cs),Ui={};me(_t,Qt)&&mi.forEach(oo=>{let Ko=oo.currentSnapshot;Object.keys(Ko).forEach(dr=>Ui[dr]=Ko[dr])});const hn=function ks(ie){let z={};return ie&&(Array.isArray(ie)?ie:[ie]).forEach(_t=>{Object.keys(_t).forEach(Qt=>{"offset"==Qt||"easing"==Qt||(z[Qt]=_t[Qt])})}),z}(J=ye(z,J,Ui));if(0==_t)return new hr(z,hn);const Tn="gen_css_kf_"+this._count++,$n=this.buildKeyframeElement(z,Tn,J);(function Jr(ie){var z;const J=null===(z=ie.getRootNode)||void 0===z?void 0:z.call(ie);return"undefined"!=typeof ShadowRoot&&J instanceof ShadowRoot?J:document.head})(z).appendChild($n);const Un=ol(z,J),jn=new Cs(z,J,Tn,_t,Qt,Te,hn,Un);return jn.onDestroy(()=>function pl(ie){ie.parentNode.removeChild(ie)}($n)),jn}}class fa{constructor(z,J,_t,Qt){this.element=z,this.keyframes=J,this.options=_t,this._specialStyles=Qt,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=_t.duration,this._delay=_t.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(z=>z()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const z=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,z,this.options),this._finalKeyframe=z.length?z[z.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(z,J,_t){return z.animate(J,_t)}onStart(z){this._onStartFns.push(z)}onDone(z){this._onDoneFns.push(z)}onDestroy(z){this._onDestroyFns.push(z)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(z=>z()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(z=>z()),this._onDestroyFns=[])}setPosition(z){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=z*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const z={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(J=>{"offset"!=J&&(z[J]=this._finished?this._finalKeyframe[J]:Zt(this.element,J))}),this.currentSnapshot=z}triggerCallback(z){const J="start"==z?this._onStartFns:this._onDoneFns;J.forEach(_t=>_t()),J.length=0}}class kt{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(V().toString()),this._cssKeyframesDriver=new hs}validateStyleProperty(z){return Ut(z)}matchesElement(z,J){return!1}containsElement(z,J){return Ct(z,J)}query(z,J,_t){return bt(z,J,_t)}computeStyle(z,J,_t){return window.getComputedStyle(z)[J]}overrideWebAnimationsSupport(z){this._isNativeImpl=z}animate(z,J,_t,Qt,Te,Ye=[],Qe){if(!Qe&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(z,J,_t,Qt,Te,Ye);const hn={duration:_t,delay:Qt,fill:0==Qt?"both":"forwards"};Te&&(hn.easing=Te);const Tn={},$n=Ye.filter(Un=>Un instanceof fa);me(_t,Qt)&&$n.forEach(Un=>{let jn=Un.currentSnapshot;Object.keys(jn).forEach(oo=>Tn[oo]=jn[oo])});const po=ol(z,J=ye(z,J=J.map(Un=>ri(Un,!1)),Tn));return new fa(z,J,hn,po)}}function V(){return t()&&Element.prototype.animate||{}}var j=_(69808);let Ot=(()=>{class ie extends e._j{constructor(J,_t){super(),this._nextAnimationId=0,this._renderer=J.createRenderer(_t.body,{id:"0",encapsulation:C.ifc.None,styles:[],data:{animation:[]}})}build(J){const _t=this._nextAnimationId.toString();this._nextAnimationId++;const Qt=Array.isArray(J)?(0,e.vP)(J):J;return un(this._renderer,null,_t,"register",[Qt]),new Be(_t,this._renderer)}}return ie.\u0275fac=function(J){return new(J||ie)(C.LFG(C.FYo),C.LFG(j.K0))},ie.\u0275prov=C.Yz7({token:ie,factory:ie.\u0275fac}),ie})();class Be extends e.LC{constructor(z,J){super(),this._id=z,this._renderer=J}create(z,J){return new bi(this._id,z,J||{},this._renderer)}}class bi{constructor(z,J,_t,Qt){this.id=z,this.element=J,this._renderer=Qt,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",_t)}_listen(z,J){return this._renderer.listen(this.element,`@@${this.id}:${z}`,J)}_command(z,...J){return un(this._renderer,this.element,this.id,z,J)}onDone(z){this._listen("done",z)}onStart(z){this._listen("start",z)}onDestroy(z){this._listen("destroy",z)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(z){this._command("setPosition",z)}getPosition(){var z,J;return null!==(J=null===(z=this._renderer.engine.players[+this.id])||void 0===z?void 0:z.getPosition())&&void 0!==J?J:0}}function un(ie,z,J,_t,Qt){return ie.setProperty(z,`@@${J}:${_t}`,Qt)}const Po="@.disabled";let Yo=(()=>{class ie{constructor(J,_t,Qt){this.delegate=J,this.engine=_t,this._zone=Qt,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),_t.onRemovalComplete=(Te,Ye)=>{const Qe=null==Ye?void 0:Ye.parentNode(Te);Qe&&Ye.removeChild(Qe,Te)}}createRenderer(J,_t){const Te=this.delegate.createRenderer(J,_t);if(!(J&&_t&&_t.data&&_t.data.animation)){let hn=this._rendererCache.get(Te);return hn||(hn=new Fo("",Te,this.engine),this._rendererCache.set(Te,hn)),hn}const Ye=_t.id,Qe=_t.id+"-"+this._currentId;this._currentId++,this.engine.register(Qe,J);const mi=hn=>{Array.isArray(hn)?hn.forEach(mi):this.engine.registerTrigger(Ye,Qe,J,hn.name,hn)};return _t.data.animation.forEach(mi),new er(this,Qe,Te,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(J,_t,Qt){J>=0&&J<this._microtaskId?this._zone.run(()=>_t(Qt)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(Te=>{const[Ye,Qe]=Te;Ye(Qe)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([_t,Qt]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return ie.\u0275fac=function(J){return new(J||ie)(C.LFG(C.FYo),C.LFG(Ys),C.LFG(C.R0b))},ie.\u0275prov=C.Yz7({token:ie,factory:ie.\u0275fac}),ie})();class Fo{constructor(z,J,_t){this.namespaceId=z,this.delegate=J,this.engine=_t,this.destroyNode=this.delegate.destroyNode?Qt=>J.destroyNode(Qt):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(z,J){return this.delegate.createElement(z,J)}createComment(z){return this.delegate.createComment(z)}createText(z){return this.delegate.createText(z)}appendChild(z,J){this.delegate.appendChild(z,J),this.engine.onInsert(this.namespaceId,J,z,!1)}insertBefore(z,J,_t,Qt=!0){this.delegate.insertBefore(z,J,_t),this.engine.onInsert(this.namespaceId,J,z,Qt)}removeChild(z,J,_t){this.engine.onRemove(this.namespaceId,J,this.delegate,_t)}selectRootElement(z,J){return this.delegate.selectRootElement(z,J)}parentNode(z){return this.delegate.parentNode(z)}nextSibling(z){return this.delegate.nextSibling(z)}setAttribute(z,J,_t,Qt){this.delegate.setAttribute(z,J,_t,Qt)}removeAttribute(z,J,_t){this.delegate.removeAttribute(z,J,_t)}addClass(z,J){this.delegate.addClass(z,J)}removeClass(z,J){this.delegate.removeClass(z,J)}setStyle(z,J,_t,Qt){this.delegate.setStyle(z,J,_t,Qt)}removeStyle(z,J,_t){this.delegate.removeStyle(z,J,_t)}setProperty(z,J,_t){"@"==J.charAt(0)&&J==Po?this.disableAnimations(z,!!_t):this.delegate.setProperty(z,J,_t)}setValue(z,J){this.delegate.setValue(z,J)}listen(z,J,_t){return this.delegate.listen(z,J,_t)}disableAnimations(z,J){this.engine.disableAnimations(z,J)}}class er extends Fo{constructor(z,J,_t,Qt){super(J,_t,Qt),this.factory=z,this.namespaceId=J}setProperty(z,J,_t){"@"==J.charAt(0)?"."==J.charAt(1)&&J==Po?this.disableAnimations(z,_t=void 0===_t||!!_t):this.engine.process(this.namespaceId,z,J.substr(1),_t):this.delegate.setProperty(z,J,_t)}listen(z,J,_t){if("@"==J.charAt(0)){const Qt=function fo(ie){switch(ie){case"body":return document.body;case"document":return document;case"window":return window;default:return ie}}(z);let Te=J.substr(1),Ye="";return"@"!=Te.charAt(0)&&([Te,Ye]=function xr(ie){const z=ie.indexOf(".");return[ie.substring(0,z),ie.substr(z+1)]}(Te)),this.engine.listen(this.namespaceId,Qt,Te,Ye,Qe=>{this.factory.scheduleListenerCallback(Qe._data||-1,_t,Qe)})}return this.delegate.listen(z,J,_t)}}let Jn=(()=>{class ie extends Ys{constructor(J,_t,Qt){super(J.body,_t,Qt)}ngOnDestroy(){this.flush()}}return ie.\u0275fac=function(J){return new(J||ie)(C.LFG(j.K0),C.LFG(lt),C.LFG(qo))},ie.\u0275prov=C.Yz7({token:ie,factory:ie.\u0275fac}),ie})();const za=new C.OlP("AnimationModuleType"),xs=[{provide:e._j,useClass:Ot},{provide:qo,useFactory:function sl(){return new xo}},{provide:Ys,useClass:Jn},{provide:C.FYo,useFactory:function $r(ie,z,J){return new Yo(ie,z,J)},deps:[m.se,Ys,C.R0b]}],Ta=[{provide:lt,useFactory:function Ks(){return function Q(){return"function"==typeof V()}()?new kt:new hs}},{provide:za,useValue:"BrowserAnimations"},...xs],yc=[{provide:lt,useClass:ft},{provide:za,useValue:"NoopAnimations"},...xs];let Xi=(()=>{class ie{static withConfig(J){return{ngModule:ie,providers:J.disableAnimations?yc:Ta}}}return ie.\u0275fac=function(J){return new(J||ie)},ie.\u0275mod=C.oAB({type:ie}),ie.\u0275inj=C.cJS({providers:Ta,imports:[m.b2]}),ie})()},22313:(B,X,_)=>{"use strict";_.d(X,{b2:()=>gi,H7:()=>$i,Dx:()=>le,q6:()=>ve,se:()=>se});var C=_(69808),m=_(5e3);class e extends C.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class t extends e{static makeCurrent(){(0,C.HT)(new t)}onAndCancel(Je,xe,hi){return Je.addEventListener(xe,hi,!1),()=>{Je.removeEventListener(xe,hi,!1)}}dispatchEvent(Je,xe){Je.dispatchEvent(xe)}remove(Je){Je.parentNode&&Je.parentNode.removeChild(Je)}createElement(Je,xe){return(xe=xe||this.getDefaultDocument()).createElement(Je)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(Je){return Je.nodeType===Node.ELEMENT_NODE}isShadowRoot(Je){return Je instanceof DocumentFragment}getGlobalEventTarget(Je,xe){return"window"===xe?window:"document"===xe?Je:"body"===xe?Je.body:null}getBaseHref(Je){const xe=function o(){return n=n||document.querySelector("base"),n?n.getAttribute("href"):null}();return null==xe?null:function a(li){r=r||document.createElement("a"),r.setAttribute("href",li);const Je=r.pathname;return"/"===Je.charAt(0)?Je:`/${Je}`}(xe)}resetBaseElement(){n=null}getUserAgent(){return window.navigator.userAgent}getCookie(Je){return(0,C.Mx)(document.cookie,Je)}}let r,n=null;const h=new m.OlP("TRANSITION_ID"),L=[{provide:m.ip1,useFactory:function R(li,Je,xe){return()=>{xe.get(m.CZH).donePromise.then(()=>{const hi=(0,C.q)(),Oi=Je.querySelectorAll(`style[ng-transition="${li}"]`);for(let gn=0;gn<Oi.length;gn++)hi.remove(Oi[gn])})}},deps:[h,C.K0,m.zs3],multi:!0}];class W{static init(){(0,m.VLi)(new W)}addToWindow(Je){m.dqk.getAngularTestability=(hi,Oi=!0)=>{const gn=Je.findTestabilityInTree(hi,Oi);if(null==gn)throw new Error("Could not find testability for element.");return gn},m.dqk.getAllAngularTestabilities=()=>Je.getAllTestabilities(),m.dqk.getAllAngularRootElements=()=>Je.getAllRootElements(),m.dqk.frameworkStabilizers||(m.dqk.frameworkStabilizers=[]),m.dqk.frameworkStabilizers.push(hi=>{const Oi=m.dqk.getAllAngularTestabilities();let gn=Oi.length,kn=!1;const so=function(Do){kn=kn||Do,gn--,0==gn&&hi(kn)};Oi.forEach(function(Do){Do.whenStable(so)})})}findTestabilityInTree(Je,xe,hi){if(null==xe)return null;const Oi=Je.getTestability(xe);return null!=Oi?Oi:hi?(0,C.q)().isShadowRoot(xe)?this.findTestabilityInTree(Je,xe.host,!0):this.findTestabilityInTree(Je,xe.parentElement,!0):null}}let nt=(()=>{class li{build(){return new XMLHttpRequest}}return li.\u0275fac=function(xe){return new(xe||li)},li.\u0275prov=m.Yz7({token:li,factory:li.\u0275fac}),li})();const et=new m.OlP("EventManagerPlugins");let Et=(()=>{class li{constructor(xe,hi){this._zone=hi,this._eventNameToPlugin=new Map,xe.forEach(Oi=>Oi.manager=this),this._plugins=xe.slice().reverse()}addEventListener(xe,hi,Oi){return this._findPluginFor(hi).addEventListener(xe,hi,Oi)}addGlobalEventListener(xe,hi,Oi){return this._findPluginFor(hi).addGlobalEventListener(xe,hi,Oi)}getZone(){return this._zone}_findPluginFor(xe){const hi=this._eventNameToPlugin.get(xe);if(hi)return hi;const Oi=this._plugins;for(let gn=0;gn<Oi.length;gn++){const kn=Oi[gn];if(kn.supports(xe))return this._eventNameToPlugin.set(xe,kn),kn}throw new Error(`No event manager plugin found for event ${xe}`)}}return li.\u0275fac=function(xe){return new(xe||li)(m.LFG(et),m.LFG(m.R0b))},li.\u0275prov=m.Yz7({token:li,factory:li.\u0275fac}),li})();class It{constructor(Je){this._doc=Je}addGlobalEventListener(Je,xe,hi){const Oi=(0,C.q)().getGlobalEventTarget(this._doc,Je);if(!Oi)throw new Error(`Unsupported event target ${Oi} for event ${xe}`);return this.addEventListener(Oi,xe,hi)}}let gt=(()=>{class li{constructor(){this._stylesSet=new Set}addStyles(xe){const hi=new Set;xe.forEach(Oi=>{this._stylesSet.has(Oi)||(this._stylesSet.add(Oi),hi.add(Oi))}),this.onStylesAdded(hi)}onStylesAdded(xe){}getAllStyles(){return Array.from(this._stylesSet)}}return li.\u0275fac=function(xe){return new(xe||li)},li.\u0275prov=m.Yz7({token:li,factory:li.\u0275fac}),li})(),wt=(()=>{class li extends gt{constructor(xe){super(),this._doc=xe,this._hostNodes=new Map,this._hostNodes.set(xe.head,[])}_addStylesToHost(xe,hi,Oi){xe.forEach(gn=>{const kn=this._doc.createElement("style");kn.textContent=gn,Oi.push(hi.appendChild(kn))})}addHost(xe){const hi=[];this._addStylesToHost(this._stylesSet,xe,hi),this._hostNodes.set(xe,hi)}removeHost(xe){const hi=this._hostNodes.get(xe);hi&&hi.forEach(Ut),this._hostNodes.delete(xe)}onStylesAdded(xe){this._hostNodes.forEach((hi,Oi)=>{this._addStylesToHost(xe,Oi,hi)})}ngOnDestroy(){this._hostNodes.forEach(xe=>xe.forEach(Ut))}}return li.\u0275fac=function(xe){return new(xe||li)(m.LFG(C.K0))},li.\u0275prov=m.Yz7({token:li,factory:li.\u0275fac}),li})();function Ut(li){(0,C.q)().remove(li)}const Jt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Ct=/%COMP%/g;function yt(li,Je,xe){for(let hi=0;hi<Je.length;hi++){let Oi=Je[hi];Array.isArray(Oi)?yt(li,Oi,xe):(Oi=Oi.replace(Ct,li),xe.push(Oi))}return xe}function ct(li){return Je=>{if("__ngUnwrap__"===Je)return li;!1===li(Je)&&(Je.preventDefault(),Je.returnValue=!1)}}let se=(()=>{class li{constructor(xe,hi,Oi){this.eventManager=xe,this.sharedStylesHost=hi,this.appId=Oi,this.rendererByCompId=new Map,this.defaultRenderer=new xt(xe)}createRenderer(xe,hi){if(!xe||!hi)return this.defaultRenderer;switch(hi.encapsulation){case m.ifc.Emulated:{let Oi=this.rendererByCompId.get(hi.id);return Oi||(Oi=new _e(this.eventManager,this.sharedStylesHost,hi,this.appId),this.rendererByCompId.set(hi.id,Oi)),Oi.applyToHost(xe),Oi}case 1:case m.ifc.ShadowDom:return new ce(this.eventManager,this.sharedStylesHost,xe,hi);default:if(!this.rendererByCompId.has(hi.id)){const Oi=yt(hi.id,hi.styles,[]);this.sharedStylesHost.addStyles(Oi),this.rendererByCompId.set(hi.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return li.\u0275fac=function(xe){return new(xe||li)(m.LFG(Et),m.LFG(wt),m.LFG(m.AFp))},li.\u0275prov=m.Yz7({token:li,factory:li.\u0275fac}),li})();class xt{constructor(Je){this.eventManager=Je,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(Je,xe){return xe?document.createElementNS(Jt[xe]||xe,Je):document.createElement(Je)}createComment(Je){return document.createComment(Je)}createText(Je){return document.createTextNode(Je)}appendChild(Je,xe){Je.appendChild(xe)}insertBefore(Je,xe,hi){Je&&Je.insertBefore(xe,hi)}removeChild(Je,xe){Je&&Je.removeChild(xe)}selectRootElement(Je,xe){let hi="string"==typeof Je?document.querySelector(Je):Je;if(!hi)throw new Error(`The selector "${Je}" did not match any elements`);return xe||(hi.textContent=""),hi}parentNode(Je){return Je.parentNode}nextSibling(Je){return Je.nextSibling}setAttribute(Je,xe,hi,Oi){if(Oi){xe=Oi+":"+xe;const gn=Jt[Oi];gn?Je.setAttributeNS(gn,xe,hi):Je.setAttribute(xe,hi)}else Je.setAttribute(xe,hi)}removeAttribute(Je,xe,hi){if(hi){const Oi=Jt[hi];Oi?Je.removeAttributeNS(Oi,xe):Je.removeAttribute(`${hi}:${xe}`)}else Je.removeAttribute(xe)}addClass(Je,xe){Je.classList.add(xe)}removeClass(Je,xe){Je.classList.remove(xe)}setStyle(Je,xe,hi,Oi){Oi&(m.JOm.DashCase|m.JOm.Important)?Je.style.setProperty(xe,hi,Oi&m.JOm.Important?"important":""):Je.style[xe]=hi}removeStyle(Je,xe,hi){hi&m.JOm.DashCase?Je.style.removeProperty(xe):Je.style[xe]=""}setProperty(Je,xe,hi){Je[xe]=hi}setValue(Je,xe){Je.nodeValue=xe}listen(Je,xe,hi){return"string"==typeof Je?this.eventManager.addGlobalEventListener(Je,xe,ct(hi)):this.eventManager.addEventListener(Je,xe,ct(hi))}}class _e extends xt{constructor(Je,xe,hi,Oi){super(Je),this.component=hi;const gn=yt(Oi+"-"+hi.id,hi.styles,[]);xe.addStyles(gn),this.contentAttr=function Ft(li){return"_ngcontent-%COMP%".replace(Ct,li)}(Oi+"-"+hi.id),this.hostAttr=function Mt(li){return"_nghost-%COMP%".replace(Ct,li)}(Oi+"-"+hi.id)}applyToHost(Je){super.setAttribute(Je,this.hostAttr,"")}createElement(Je,xe){const hi=super.createElement(Je,xe);return super.setAttribute(hi,this.contentAttr,""),hi}}class ce extends xt{constructor(Je,xe,hi,Oi){super(Je),this.sharedStylesHost=xe,this.hostEl=hi,this.shadowRoot=hi.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const gn=yt(Oi.id,Oi.styles,[]);for(let kn=0;kn<gn.length;kn++){const so=document.createElement("style");so.textContent=gn[kn],this.shadowRoot.appendChild(so)}}nodeOrShadowRoot(Je){return Je===this.hostEl?this.shadowRoot:Je}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(Je,xe){return super.appendChild(this.nodeOrShadowRoot(Je),xe)}insertBefore(Je,xe,hi){return super.insertBefore(this.nodeOrShadowRoot(Je),xe,hi)}removeChild(Je,xe){return super.removeChild(this.nodeOrShadowRoot(Je),xe)}parentNode(Je){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(Je)))}}let Ae=(()=>{class li extends It{constructor(xe){super(xe)}supports(xe){return!0}addEventListener(xe,hi,Oi){return xe.addEventListener(hi,Oi,!1),()=>this.removeEventListener(xe,hi,Oi)}removeEventListener(xe,hi,Oi){return xe.removeEventListener(hi,Oi)}}return li.\u0275fac=function(xe){return new(xe||li)(m.LFG(C.K0))},li.\u0275prov=m.Yz7({token:li,factory:li.\u0275fac}),li})();const Ne=["alt","control","meta","shift"],Di={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ei={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Me={alt:li=>li.altKey,control:li=>li.ctrlKey,meta:li=>li.metaKey,shift:li=>li.shiftKey};let ri=(()=>{class li extends It{constructor(xe){super(xe)}supports(xe){return null!=li.parseEventName(xe)}addEventListener(xe,hi,Oi){const gn=li.parseEventName(hi),kn=li.eventCallback(gn.fullKey,Oi,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,C.q)().onAndCancel(xe,gn.domEventName,kn))}static parseEventName(xe){const hi=xe.toLowerCase().split("."),Oi=hi.shift();if(0===hi.length||"keydown"!==Oi&&"keyup"!==Oi)return null;const gn=li._normalizeKey(hi.pop());let kn="";if(Ne.forEach(Do=>{const Zo=hi.indexOf(Do);Zo>-1&&(hi.splice(Zo,1),kn+=Do+".")}),kn+=gn,0!=hi.length||0===gn.length)return null;const so={};return so.domEventName=Oi,so.fullKey=kn,so}static getEventFullKey(xe){let hi="",Oi=function Bt(li){let Je=li.key;if(null==Je){if(Je=li.keyIdentifier,null==Je)return"Unidentified";Je.startsWith("U+")&&(Je=String.fromCharCode(parseInt(Je.substring(2),16)),3===li.location&&ei.hasOwnProperty(Je)&&(Je=ei[Je]))}return Di[Je]||Je}(xe);return Oi=Oi.toLowerCase()," "===Oi?Oi="space":"."===Oi&&(Oi="dot"),Ne.forEach(gn=>{gn!=Oi&&Me[gn](xe)&&(hi+=gn+".")}),hi+=Oi,hi}static eventCallback(xe,hi,Oi){return gn=>{li.getEventFullKey(gn)===xe&&Oi.runGuarded(()=>hi(gn))}}static _normalizeKey(xe){return"esc"===xe?"escape":xe}}return li.\u0275fac=function(xe){return new(xe||li)(m.LFG(C.K0))},li.\u0275prov=m.Yz7({token:li,factory:li.\u0275fac}),li})();const ve=(0,m.eFA)(m._c5,"browser",[{provide:m.Lbi,useValue:C.bD},{provide:m.g9A,useValue:function Ie(){t.makeCurrent(),W.init()},multi:!0},{provide:C.K0,useFactory:function he(){return(0,m.RDi)(document),document},deps:[]}]),je=[{provide:m.zSh,useValue:"root"},{provide:m.qLn,useFactory:function Xt(){return new m.qLn},deps:[]},{provide:et,useClass:Ae,multi:!0,deps:[C.K0,m.R0b,m.Lbi]},{provide:et,useClass:ri,multi:!0,deps:[C.K0]},{provide:se,useClass:se,deps:[Et,wt,m.AFp]},{provide:m.FYo,useExisting:se},{provide:gt,useExisting:wt},{provide:wt,useClass:wt,deps:[C.K0]},{provide:m.dDg,useClass:m.dDg,deps:[m.R0b]},{provide:Et,useClass:Et,deps:[et,m.R0b]},{provide:C.JF,useClass:nt,deps:[]}];let gi=(()=>{class li{constructor(xe){if(xe)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(xe){return{ngModule:li,providers:[{provide:m.AFp,useValue:xe.appId},{provide:h,useExisting:m.AFp},L]}}}return li.\u0275fac=function(xe){return new(xe||li)(m.LFG(li,12))},li.\u0275mod=m.oAB({type:li}),li.\u0275inj=m.cJS({providers:je,imports:[C.ez,m.hGG]}),li})(),le=(()=>{class li{constructor(xe){this._doc=xe}getTitle(){return this._doc.title}setTitle(xe){this._doc.title=xe||""}}return li.\u0275fac=function(xe){return new(xe||li)(m.LFG(C.K0))},li.\u0275prov=m.Yz7({token:li,factory:function(xe){let hi=null;return hi=xe?new xe:function Oe(){return new le((0,m.LFG)(C.K0))}(),hi},providedIn:"root"}),li})();"undefined"!=typeof window&&window;let $i=(()=>{class li{}return li.\u0275fac=function(xe){return new(xe||li)},li.\u0275prov=m.Yz7({token:li,factory:function(xe){let hi=null;return hi=xe?new(xe||li):m.LFG(In),hi},providedIn:"root"}),li})(),In=(()=>{class li extends $i{constructor(xe){super(),this._doc=xe}sanitize(xe,hi){if(null==hi)return null;switch(xe){case m.q3G.NONE:return hi;case m.q3G.HTML:return(0,m.qzn)(hi,"HTML")?(0,m.z3N)(hi):(0,m.EiD)(this._doc,String(hi)).toString();case m.q3G.STYLE:return(0,m.qzn)(hi,"Style")?(0,m.z3N)(hi):hi;case m.q3G.SCRIPT:if((0,m.qzn)(hi,"Script"))return(0,m.z3N)(hi);throw new Error("unsafe value used in a script context");case m.q3G.URL:return(0,m.yhl)(hi),(0,m.qzn)(hi,"URL")?(0,m.z3N)(hi):(0,m.mCW)(String(hi));case m.q3G.RESOURCE_URL:if((0,m.qzn)(hi,"ResourceURL"))return(0,m.z3N)(hi);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${xe} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(xe){return(0,m.JVY)(xe)}bypassSecurityTrustStyle(xe){return(0,m.L6k)(xe)}bypassSecurityTrustScript(xe){return(0,m.eBb)(xe)}bypassSecurityTrustUrl(xe){return(0,m.LAX)(xe)}bypassSecurityTrustResourceUrl(xe){return(0,m.pB0)(xe)}}return li.\u0275fac=function(xe){return new(xe||li)(m.LFG(C.K0))},li.\u0275prov=m.Yz7({token:li,factory:function(xe){let hi=null;return hi=xe?new xe:function tn(li){return new In(li.get(C.K0))}(m.LFG(m.zs3)),hi},providedIn:"root"}),li})()},91083:(B,X,_)=>{"use strict";_.d(X,{gz:()=>Mi,sz:()=>Je,yS:()=>jr,Bz:()=>gl,lC:()=>As,Hx:()=>li});var C=_(5e3);const e=(0,_(83888).d)(dt=>function(){dt(this),this.name="EmptyError",this.message="no elements in sequence"});var t=_(68306),n=_(50727),o=_(54482),r=_(25403);function a(){return(0,o.e)((dt,ot)=>{let q=null;dt._refCount++;const At=new r.Q(ot,void 0,void 0,void 0,()=>{if(!dt||dt._refCount<=0||0<--dt._refCount)return void(q=null);const Wt=dt._connection,pe=q;q=null,Wt&&(!pe||Wt===pe)&&Wt.unsubscribe(),ot.unsubscribe()});dt.subscribe(At),At.closed||(q=dt.connect())})}class h extends t.y{constructor(ot,q){super(),this.source=ot,this.subjectFactory=q,this._subject=null,this._refCount=0,this._connection=null,(0,o.A)(ot)&&(this.lift=ot.lift)}_subscribe(ot){return this.getSubject().subscribe(ot)}getSubject(){const ot=this._subject;return(!ot||ot.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:ot}=this;this._subject=this._connection=null,null==ot||ot.unsubscribe()}connect(){let ot=this._connection;if(!ot){ot=this._connection=new n.w0;const q=this.getSubject();ot.add(this.source.subscribe(new r.Q(q,void 0,()=>{this._teardown(),q.complete()},At=>{this._teardown(),q.error(At)},()=>this._teardown()))),ot.closed&&(this._connection=null,ot=n.w0.EMPTY)}return ot}refCount(){return a()(this)}}var R=_(32076),L=_(39646),W=_(61135),nt=_(39841),et=_(97272),Et=_(49770),It=_(60515),gt=_(77579);function wt(dt,ot,q,At,Wt){return(pe,Ve)=>{let ti=q,Li=ot,wn=0;pe.subscribe(new r.Q(Ve,Co=>{const Kn=wn++;Li=ti?dt(Li,Co,Kn):(ti=!0,Co),At&&Ve.next(Li)},Wt&&(()=>{ti&&Ve.next(Li),Ve.complete()})))}}function Ut(dt,ot){return(0,o.e)(wt(dt,ot,arguments.length>=2,!0))}var Jt=_(39300);function Ct(dt){return dt<=0?()=>It.E:(0,o.e)((ot,q)=>{let At=[];ot.subscribe(new r.Q(q,Wt=>{At.push(Wt),dt<At.length&&At.shift()},()=>{for(const Wt of At)q.next(Wt);q.complete()},void 0,()=>{At=null}))})}function bt(dt=at){return(0,o.e)((ot,q)=>{let At=!1;ot.subscribe(new r.Q(q,Wt=>{At=!0,q.next(Wt)},()=>At?q.complete():q.error(dt())))})}function at(){return new e}function ft(dt){return(0,o.e)((ot,q)=>{let At=!1;ot.subscribe(new r.Q(q,Wt=>{At=!0,q.next(Wt)},()=>{At||q.next(dt),q.complete()}))})}var lt=_(44671),Mt=_(95698);function yt(dt,ot){const q=arguments.length>=2;return At=>At.pipe(dt?(0,Jt.h)((Wt,pe)=>dt(Wt,pe,At)):lt.y,(0,Mt.q)(1),q?ft(ot):bt(()=>new e))}var ct=_(54004),rt=_(63900),se=_(68675),xt=_(70262),Lt=_(24351),de=_(95577),_e=_(18505),ce=_(28746),Ae=_(8189),Ne=_(69808);class qe{constructor(ot,q){this.id=ot,this.url=q}}class Di extends qe{constructor(ot,q,At="imperative",Wt=null){super(ot,q),this.navigationTrigger=At,this.restoredState=Wt}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ei extends qe{constructor(ot,q,At){super(ot,q),this.urlAfterRedirects=At}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Me extends qe{constructor(ot,q,At){super(ot,q),this.reason=At}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ri extends qe{constructor(ot,q,At){super(ot,q),this.error=At}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Bt extends qe{constructor(ot,q,At,Wt){super(ot,q),this.urlAfterRedirects=At,this.state=Wt}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ie extends qe{constructor(ot,q,At,Wt){super(ot,q),this.urlAfterRedirects=At,this.state=Wt}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xt extends qe{constructor(ot,q,At,Wt,pe){super(ot,q),this.urlAfterRedirects=At,this.state=Wt,this.shouldActivate=pe}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class he extends qe{constructor(ot,q,At,Wt){super(ot,q),this.urlAfterRedirects=At,this.state=Wt}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Dt extends qe{constructor(ot,q,At,Wt){super(ot,q),this.urlAfterRedirects=At,this.state=Wt}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ve{constructor(ot){this.route=ot}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class je{constructor(ot){this.route=ot}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class gi{constructor(ot){this.snapshot=ot}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ee{constructor(ot){this.snapshot=ot}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ne{constructor(ot){this.snapshot=ot}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ee{constructor(ot){this.snapshot=ot}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Oe{constructor(ot,q,At){this.routerEvent=ot,this.position=q,this.anchor=At}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const le="primary";class me{constructor(ot){this.params=ot||{}}has(ot){return Object.prototype.hasOwnProperty.call(this.params,ot)}get(ot){if(this.has(ot)){const q=this.params[ot];return Array.isArray(q)?q[0]:q}return null}getAll(ot){if(this.has(ot)){const q=this.params[ot];return Array.isArray(q)?q:[q]}return[]}get keys(){return Object.keys(this.params)}}function ye(dt){return new me(dt)}const Kt="ngNavigationCancelingError";function Zt(dt){const ot=Error("NavigationCancelingError: "+dt);return ot[Kt]=!0,ot}function $e(dt,ot,q){const At=q.path.split("/");if(At.length>dt.length||"full"===q.pathMatch&&(ot.hasChildren()||At.length<dt.length))return null;const Wt={};for(let pe=0;pe<At.length;pe++){const Ve=At[pe],ti=dt[pe];if(Ve.startsWith(":"))Wt[Ve.substring(1)]=ti;else if(Ve!==ti.path)return null}return{consumed:dt.slice(0,At.length),posParams:Wt}}function vi(dt,ot){const q=dt?Object.keys(dt):void 0,At=ot?Object.keys(ot):void 0;if(!q||!At||q.length!=At.length)return!1;let Wt;for(let pe=0;pe<q.length;pe++)if(Wt=q[pe],!di(dt[Wt],ot[Wt]))return!1;return!0}function di(dt,ot){if(Array.isArray(dt)&&Array.isArray(ot)){if(dt.length!==ot.length)return!1;const q=[...dt].sort(),At=[...ot].sort();return q.every((Wt,pe)=>At[pe]===Wt)}return dt===ot}function Gi(dt){return Array.prototype.concat.apply([],dt)}function Ri(dt){return dt.length>0?dt[dt.length-1]:null}function ge(dt,ot){for(const q in dt)dt.hasOwnProperty(q)&&ot(dt[q],q)}function De(dt){return(0,C.CqO)(dt)?dt:(0,C.QGY)(dt)?(0,R.D)(Promise.resolve(dt)):(0,L.of)(dt)}const yi={exact:function si(dt,ot,q){if(!In(dt.segments,ot.segments)||!Gt(dt.segments,ot.segments,q)||dt.numberOfChildren!==ot.numberOfChildren)return!1;for(const At in ot.children)if(!dt.children[At]||!si(dt.children[At],ot.children[At],q))return!1;return!0},subset:Vt},Fi={exact:function mn(dt,ot){return vi(dt,ot)},subset:function Ce(dt,ot){return Object.keys(ot).length<=Object.keys(dt).length&&Object.keys(ot).every(q=>di(dt[q],ot[q]))},ignored:()=>!0};function Ni(dt,ot,q){return yi[q.paths](dt.root,ot.root,q.matrixParams)&&Fi[q.queryParams](dt.queryParams,ot.queryParams)&&!("exact"===q.fragment&&dt.fragment!==ot.fragment)}function Vt(dt,ot,q){return vt(dt,ot,ot.segments,q)}function vt(dt,ot,q,At){if(dt.segments.length>q.length){const Wt=dt.segments.slice(0,q.length);return!(!In(Wt,q)||ot.hasChildren()||!Gt(Wt,q,At))}if(dt.segments.length===q.length){if(!In(dt.segments,q)||!Gt(dt.segments,q,At))return!1;for(const Wt in ot.children)if(!dt.children[Wt]||!Vt(dt.children[Wt],ot.children[Wt],At))return!1;return!0}{const Wt=q.slice(0,dt.segments.length),pe=q.slice(dt.segments.length);return!!(In(dt.segments,Wt)&&Gt(dt.segments,Wt,At)&&dt.children[le])&&vt(dt.children[le],ot,pe,At)}}function Gt(dt,ot,q){return ot.every((At,Wt)=>Fi[q](dt[Wt].parameters,At.parameters))}class fe{constructor(ot,q,At){this.root=ot,this.queryParams=q,this.fragment=At}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ye(this.queryParams)),this._queryParamMap}toString(){return xe.serialize(this)}}class He{constructor(ot,q){this.segments=ot,this.children=q,this.parent=null,ge(q,(At,Wt)=>At.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return hi(this)}}class $i{constructor(ot,q){this.path=ot,this.parameters=q}get parameterMap(){return this._parameterMap||(this._parameterMap=ye(this.parameters)),this._parameterMap}toString(){return yr(this)}}function In(dt,ot){return dt.length===ot.length&&dt.every((q,At)=>q.path===ot[At].path)}class li{}class Je{parse(ot){const q=new yo(ot);return new fe(q.parseRootSegment(),q.parseQueryParams(),q.parseFragment())}serialize(ot){const q=`/${Oi(ot.root,!0)}`,At=function vo(dt){const ot=Object.keys(dt).map(q=>{const At=dt[q];return Array.isArray(At)?At.map(Wt=>`${kn(q)}=${kn(Wt)}`).join("&"):`${kn(q)}=${kn(At)}`}).filter(q=>!!q);return ot.length?`?${ot.join("&")}`:""}(ot.queryParams);return`${q}${At}${"string"==typeof ot.fragment?`#${function so(dt){return encodeURI(dt)}(ot.fragment)}`:""}`}}const xe=new Je;function hi(dt){return dt.segments.map(ot=>yr(ot)).join("/")}function Oi(dt,ot){if(!dt.hasChildren())return hi(dt);if(ot){const q=dt.children[le]?Oi(dt.children[le],!1):"",At=[];return ge(dt.children,(Wt,pe)=>{pe!==le&&At.push(`${pe}:${Oi(Wt,!1)}`)}),At.length>0?`${q}(${At.join("//")})`:q}{const q=function no(dt,ot){let q=[];return ge(dt.children,(At,Wt)=>{Wt===le&&(q=q.concat(ot(At,Wt)))}),ge(dt.children,(At,Wt)=>{Wt!==le&&(q=q.concat(ot(At,Wt)))}),q}(dt,(At,Wt)=>Wt===le?[Oi(dt.children[le],!1)]:[`${Wt}:${Oi(At,!1)}`]);return 1===Object.keys(dt.children).length&&null!=dt.children[le]?`${hi(dt)}/${q[0]}`:`${hi(dt)}/(${q.join("//")})`}}function gn(dt){return encodeURIComponent(dt).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function kn(dt){return gn(dt).replace(/%3B/gi,";")}function Do(dt){return gn(dt).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Zo(dt){return decodeURIComponent(dt)}function qo(dt){return Zo(dt.replace(/\+/g,"%20"))}function yr(dt){return`${Do(dt.path)}${function xo(dt){return Object.keys(dt).map(ot=>`;${Do(ot)}=${Do(dt[ot])}`).join("")}(dt.parameters)}`}const Fr=/^[^\/()?;=#]+/;function co(dt){const ot=dt.match(Fr);return ot?ot[0]:""}const Ii=/^[^=?&#]+/,To=/^[^&#]+/;class yo{constructor(ot){this.url=ot,this.remaining=ot}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new He([],{}):new He([],this.parseChildren())}parseQueryParams(){const ot={};if(this.consumeOptional("?"))do{this.parseQueryParam(ot)}while(this.consumeOptional("&"));return ot}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const ot=[];for(this.peekStartsWith("(")||ot.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),ot.push(this.parseSegment());let q={};this.peekStartsWith("/(")&&(this.capture("/"),q=this.parseParens(!0));let At={};return this.peekStartsWith("(")&&(At=this.parseParens(!1)),(ot.length>0||Object.keys(q).length>0)&&(At[le]=new He(ot,q)),At}parseSegment(){const ot=co(this.remaining);if(""===ot&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(ot),new $i(Zo(ot),this.parseMatrixParams())}parseMatrixParams(){const ot={};for(;this.consumeOptional(";");)this.parseParam(ot);return ot}parseParam(ot){const q=co(this.remaining);if(!q)return;this.capture(q);let At="";if(this.consumeOptional("=")){const Wt=co(this.remaining);Wt&&(At=Wt,this.capture(At))}ot[Zo(q)]=Zo(At)}parseQueryParam(ot){const q=function Gn(dt){const ot=dt.match(Ii);return ot?ot[0]:""}(this.remaining);if(!q)return;this.capture(q);let At="";if(this.consumeOptional("=")){const Ve=function Uo(dt){const ot=dt.match(To);return ot?ot[0]:""}(this.remaining);Ve&&(At=Ve,this.capture(At))}const Wt=qo(q),pe=qo(At);if(ot.hasOwnProperty(Wt)){let Ve=ot[Wt];Array.isArray(Ve)||(Ve=[Ve],ot[Wt]=Ve),Ve.push(pe)}else ot[Wt]=pe}parseParens(ot){const q={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const At=co(this.remaining),Wt=this.remaining[At.length];if("/"!==Wt&&")"!==Wt&&";"!==Wt)throw new Error(`Cannot parse url '${this.url}'`);let pe;At.indexOf(":")>-1?(pe=At.substr(0,At.indexOf(":")),this.capture(pe),this.capture(":")):ot&&(pe=le);const Ve=this.parseChildren();q[pe]=1===Object.keys(Ve).length?Ve[le]:new He([],Ve),this.consumeOptional("//")}return q}peekStartsWith(ot){return this.remaining.startsWith(ot)}consumeOptional(ot){return!!this.peekStartsWith(ot)&&(this.remaining=this.remaining.substring(ot.length),!0)}capture(ot){if(!this.consumeOptional(ot))throw new Error(`Expected "${ot}".`)}}class Mo{constructor(ot){this._root=ot}get root(){return this._root.value}parent(ot){const q=this.pathFromRoot(ot);return q.length>1?q[q.length-2]:null}children(ot){const q=Qo(ot,this._root);return q?q.children.map(At=>At.value):[]}firstChild(ot){const q=Qo(ot,this._root);return q&&q.children.length>0?q.children[0].value:null}siblings(ot){const q=Oo(ot,this._root);return q.length<2?[]:q[q.length-2].children.map(Wt=>Wt.value).filter(Wt=>Wt!==ot)}pathFromRoot(ot){return Oo(ot,this._root).map(q=>q.value)}}function Qo(dt,ot){if(dt===ot.value)return ot;for(const q of ot.children){const At=Qo(dt,q);if(At)return At}return null}function Oo(dt,ot){if(dt===ot.value)return[ot];for(const q of ot.children){const At=Oo(dt,q);if(At.length)return At.unshift(ot),At}return[]}class Bi{constructor(ot,q){this.value=ot,this.children=q}toString(){return`TreeNode(${this.value})`}}function On(dt){const ot={};return dt&&dt.children.forEach(q=>ot[q.value.outlet]=q),ot}class Wn extends Mo{constructor(ot,q){super(ot),this.snapshot=q,lo(this,ot)}toString(){return this.snapshot.toString()}}function ae(dt,ot){const q=function Fe(dt,ot){const Ve=new qn([],{},{},"",{},le,ot,null,dt.root,-1,{});return new ao("",new Bi(Ve,[]))}(dt,ot),At=new W.X([new $i("",{})]),Wt=new W.X({}),pe=new W.X({}),Ve=new W.X({}),ti=new W.X(""),Li=new Mi(At,Wt,Ve,ti,pe,le,ot,q.root);return Li.snapshot=q.root,new Wn(new Bi(Li,[]),q)}class Mi{constructor(ot,q,At,Wt,pe,Ve,ti,Li){this.url=ot,this.params=q,this.queryParams=At,this.fragment=Wt,this.data=pe,this.outlet=Ve,this.component=ti,this._futureSnapshot=Li}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ct.U)(ot=>ye(ot)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ct.U)(ot=>ye(ot)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Yi(dt,ot="emptyOnly"){const q=dt.pathFromRoot;let At=0;if("always"!==ot)for(At=q.length-1;At>=1;){const Wt=q[At],pe=q[At-1];if(Wt.routeConfig&&""===Wt.routeConfig.path)At--;else{if(pe.component)break;At--}}return function Ki(dt){return dt.reduce((ot,q)=>({params:Object.assign(Object.assign({},ot.params),q.params),data:Object.assign(Object.assign({},ot.data),q.data),resolve:Object.assign(Object.assign({},ot.resolve),q._resolvedData)}),{params:{},data:{},resolve:{}})}(q.slice(At))}class qn{constructor(ot,q,At,Wt,pe,Ve,ti,Li,wn,Co,Kn){this.url=ot,this.params=q,this.queryParams=At,this.fragment=Wt,this.data=pe,this.outlet=Ve,this.component=ti,this.routeConfig=Li,this._urlSegment=wn,this._lastPathIndex=Co,this._resolve=Kn}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ye(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ye(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(At=>At.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ao extends Mo{constructor(ot,q){super(q),this.url=ot,lo(this,q)}toString(){return Rn(this._root)}}function lo(dt,ot){ot.value._routerState=dt,ot.children.forEach(q=>lo(dt,q))}function Rn(dt){const ot=dt.children.length>0?` { ${dt.children.map(Rn).join(", ")} } `:"";return`${dt.value}${ot}`}function Kr(dt){if(dt.snapshot){const ot=dt.snapshot,q=dt._futureSnapshot;dt.snapshot=q,vi(ot.queryParams,q.queryParams)||dt.queryParams.next(q.queryParams),ot.fragment!==q.fragment&&dt.fragment.next(q.fragment),vi(ot.params,q.params)||dt.params.next(q.params),function Ti(dt,ot){if(dt.length!==ot.length)return!1;for(let q=0;q<dt.length;++q)if(!vi(dt[q],ot[q]))return!1;return!0}(ot.url,q.url)||dt.url.next(q.url),vi(ot.data,q.data)||dt.data.next(q.data)}else dt.snapshot=dt._futureSnapshot,dt.data.next(dt._futureSnapshot.data)}function _r(dt,ot){const q=vi(dt.params,ot.params)&&function tn(dt,ot){return In(dt,ot)&&dt.every((q,At)=>vi(q.parameters,ot[At].parameters))}(dt.url,ot.url);return q&&!(!dt.parent!=!ot.parent)&&(!dt.parent||_r(dt.parent,ot.parent))}function Or(dt,ot,q){if(q&&dt.shouldReuseRoute(ot.value,q.value.snapshot)){const At=q.value;At._futureSnapshot=ot.value;const Wt=function uo(dt,ot,q){return ot.children.map(At=>{for(const Wt of q.children)if(dt.shouldReuseRoute(At.value,Wt.value.snapshot))return Or(dt,At,Wt);return Or(dt,At)})}(dt,ot,q);return new Bi(At,Wt)}{if(dt.shouldAttach(ot.value)){const pe=dt.retrieve(ot.value);if(null!==pe){const Ve=pe.route;return Ve.value._futureSnapshot=ot.value,Ve.children=ot.children.map(ti=>Or(dt,ti)),Ve}}const At=function Os(dt){return new Mi(new W.X(dt.url),new W.X(dt.params),new W.X(dt.queryParams),new W.X(dt.fragment),new W.X(dt.data),dt.outlet,dt.component,dt)}(ot.value),Wt=ot.children.map(pe=>Or(dt,pe));return new Bi(At,Wt)}}function sr(dt){return"object"==typeof dt&&null!=dt&&!dt.outlets&&!dt.segmentPath}function wr(dt){return"object"==typeof dt&&null!=dt&&dt.outlets}function Ua(dt,ot,q,At,Wt){let pe={};return At&&ge(At,(Ve,ti)=>{pe[ti]=Array.isArray(Ve)?Ve.map(Li=>`${Li}`):`${Ve}`}),new fe(q.root===dt?ot:Cr(q.root,dt,ot),pe,Wt)}function Cr(dt,ot,q){const At={};return ge(dt.children,(Wt,pe)=>{At[pe]=Wt===ot?q:Cr(Wt,ot,q)}),new He(dt.segments,At)}class us{constructor(ot,q,At){if(this.isAbsolute=ot,this.numberOfDoubleDots=q,this.commands=At,ot&&At.length>0&&sr(At[0]))throw new Error("Root segment cannot have matrix parameters");const Wt=At.find(wr);if(Wt&&Wt!==Ri(At))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Vo{constructor(ot,q,At){this.segmentGroup=ot,this.processChildren=q,this.index=At}}function ia(dt,ot,q){if(dt||(dt=new He([],{})),0===dt.segments.length&&dt.hasChildren())return nl(dt,ot,q);const At=function Va(dt,ot,q){let At=0,Wt=ot;const pe={match:!1,pathIndex:0,commandIndex:0};for(;Wt<dt.segments.length;){if(At>=q.length)return pe;const Ve=dt.segments[Wt],ti=q[At];if(wr(ti))break;const Li=`${ti}`,wn=At<q.length-1?q[At+1]:null;if(Wt>0&&void 0===Li)break;if(Li&&wn&&"object"==typeof wn&&void 0===wn.outlets){if(!ts(Li,wn,Ve))return pe;At+=2}else{if(!ts(Li,{},Ve))return pe;At++}Wt++}return{match:!0,pathIndex:Wt,commandIndex:At}}(dt,ot,q),Wt=q.slice(At.commandIndex);if(At.match&&At.pathIndex<dt.segments.length){const pe=new He(dt.segments.slice(0,At.pathIndex),{});return pe.children[le]=new He(dt.segments.slice(At.pathIndex),dt.children),nl(pe,0,Wt)}return At.match&&0===Wt.length?new He(dt.segments,{}):At.match&&!dt.hasChildren()?Ys(dt,ot,q):At.match?nl(dt,0,Wt):Ys(dt,ot,q)}function nl(dt,ot,q){if(0===q.length)return new He(dt.segments,{});{const At=function js(dt){return wr(dt[0])?dt[0].outlets:{[le]:dt}}(q),Wt={};return ge(At,(pe,Ve)=>{"string"==typeof pe&&(pe=[pe]),null!==pe&&(Wt[Ve]=ia(dt.children[Ve],ot,pe))}),ge(dt.children,(pe,Ve)=>{void 0===At[Ve]&&(Wt[Ve]=pe)}),new He(dt.segments,Wt)}}function Ys(dt,ot,q){const At=dt.segments.slice(0,ot);let Wt=0;for(;Wt<q.length;){const pe=q[Wt];if(wr(pe)){const Li=ol(pe.outlets);return new He(At,Li)}if(0===Wt&&sr(q[0])){At.push(new $i(dt.segments[ot].path,Xs(q[0]))),Wt++;continue}const Ve=wr(pe)?pe.outlets[le]:`${pe}`,ti=Wt<q.length-1?q[Wt+1]:null;Ve&&ti&&sr(ti)?(At.push(new $i(Ve,Xs(ti))),Wt+=2):(At.push(new $i(Ve,{})),Wt++)}return new He(At,{})}function ol(dt){const ot={};return ge(dt,(q,At)=>{"string"==typeof q&&(q=[q]),null!==q&&(ot[At]=Ys(new He([],{}),0,q))}),ot}function Xs(dt){const ot={};return ge(dt,(q,At)=>ot[At]=`${q}`),ot}function ts(dt,ot,q){return dt==q.path&&vi(ot,q.parameters)}class Ga{constructor(ot,q,At,Wt){this.routeReuseStrategy=ot,this.futureState=q,this.currState=At,this.forwardEvent=Wt}activate(ot){const q=this.futureState._root,At=this.currState?this.currState._root:null;this.deactivateChildRoutes(q,At,ot),Kr(this.futureState.root),this.activateChildRoutes(q,At,ot)}deactivateChildRoutes(ot,q,At){const Wt=On(q);ot.children.forEach(pe=>{const Ve=pe.value.outlet;this.deactivateRoutes(pe,Wt[Ve],At),delete Wt[Ve]}),ge(Wt,(pe,Ve)=>{this.deactivateRouteAndItsChildren(pe,At)})}deactivateRoutes(ot,q,At){const Wt=ot.value,pe=q?q.value:null;if(Wt===pe)if(Wt.component){const Ve=At.getContext(Wt.outlet);Ve&&this.deactivateChildRoutes(ot,q,Ve.children)}else this.deactivateChildRoutes(ot,q,At);else pe&&this.deactivateRouteAndItsChildren(q,At)}deactivateRouteAndItsChildren(ot,q){ot.value.component&&this.routeReuseStrategy.shouldDetach(ot.value.snapshot)?this.detachAndStoreRouteSubtree(ot,q):this.deactivateRouteAndOutlet(ot,q)}detachAndStoreRouteSubtree(ot,q){const At=q.getContext(ot.value.outlet),Wt=At&&ot.value.component?At.children:q,pe=On(ot);for(const Ve of Object.keys(pe))this.deactivateRouteAndItsChildren(pe[Ve],Wt);if(At&&At.outlet){const Ve=At.outlet.detach(),ti=At.children.onOutletDeactivated();this.routeReuseStrategy.store(ot.value.snapshot,{componentRef:Ve,route:ot,contexts:ti})}}deactivateRouteAndOutlet(ot,q){const At=q.getContext(ot.value.outlet),Wt=At&&ot.value.component?At.children:q,pe=On(ot);for(const Ve of Object.keys(pe))this.deactivateRouteAndItsChildren(pe[Ve],Wt);At&&At.outlet&&(At.outlet.deactivate(),At.children.onOutletDeactivated(),At.attachRef=null,At.resolver=null,At.route=null)}activateChildRoutes(ot,q,At){const Wt=On(q);ot.children.forEach(pe=>{this.activateRoutes(pe,Wt[pe.value.outlet],At),this.forwardEvent(new ee(pe.value.snapshot))}),ot.children.length&&this.forwardEvent(new Ee(ot.value.snapshot))}activateRoutes(ot,q,At){const Wt=ot.value,pe=q?q.value:null;if(Kr(Wt),Wt===pe)if(Wt.component){const Ve=At.getOrCreateContext(Wt.outlet);this.activateChildRoutes(ot,q,Ve.children)}else this.activateChildRoutes(ot,q,At);else if(Wt.component){const Ve=At.getOrCreateContext(Wt.outlet);if(this.routeReuseStrategy.shouldAttach(Wt.snapshot)){const ti=this.routeReuseStrategy.retrieve(Wt.snapshot);this.routeReuseStrategy.store(Wt.snapshot,null),Ve.children.onOutletReAttached(ti.contexts),Ve.attachRef=ti.componentRef,Ve.route=ti.route.value,Ve.outlet&&Ve.outlet.attach(ti.componentRef,ti.route.value),Kr(ti.route.value),this.activateChildRoutes(ot,null,Ve.children)}else{const ti=function es(dt){for(let ot=dt.parent;ot;ot=ot.parent){const q=ot.routeConfig;if(q&&q._loadedConfig)return q._loadedConfig;if(q&&q.component)return null}return null}(Wt.snapshot),Li=ti?ti.module.componentFactoryResolver:null;Ve.attachRef=null,Ve.route=Wt,Ve.resolver=Li,Ve.outlet&&Ve.outlet.activateWith(Wt,Li),this.activateChildRoutes(ot,null,Ve.children)}}else this.activateChildRoutes(ot,null,At)}}class Go{constructor(ot,q){this.routes=ot,this.module=q}}function Bo(dt){return"function"==typeof dt}function Ar(dt){return dt instanceof fe}const kr=Symbol("INITIAL_VALUE");function tr(){return(0,rt.w)(dt=>(0,nt.a)(dt.map(ot=>ot.pipe((0,Mt.q)(1),(0,se.O)(kr)))).pipe(Ut((ot,q)=>{let At=!1;return q.reduce((Wt,pe,Ve)=>Wt!==kr?Wt:(pe===kr&&(At=!0),At||!1!==pe&&Ve!==q.length-1&&!Ar(pe)?Wt:pe),ot)},kr),(0,Jt.h)(ot=>ot!==kr),(0,ct.U)(ot=>Ar(ot)?ot:!0===ot),(0,Mt.q)(1)))}class Es{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new ar,this.attachRef=null}}class ar{constructor(){this.contexts=new Map}onChildOutletCreated(ot,q){const At=this.getOrCreateContext(ot);At.outlet=q,this.contexts.set(ot,At)}onChildOutletDestroyed(ot){const q=this.getContext(ot);q&&(q.outlet=null,q.attachRef=null)}onOutletDeactivated(){const ot=this.contexts;return this.contexts=new Map,ot}onOutletReAttached(ot){this.contexts=ot}getOrCreateContext(ot){let q=this.getContext(ot);return q||(q=new Es,this.contexts.set(ot,q)),q}getContext(ot){return this.contexts.get(ot)||null}}let As=(()=>{class dt{constructor(q,At,Wt,pe,Ve){this.parentContexts=q,this.location=At,this.resolver=Wt,this.changeDetector=Ve,this.activated=null,this._activatedRoute=null,this.activateEvents=new C.vpe,this.deactivateEvents=new C.vpe,this.attachEvents=new C.vpe,this.detachEvents=new C.vpe,this.name=pe||le,q.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const q=this.parentContexts.getContext(this.name);q&&q.route&&(q.attachRef?this.attach(q.attachRef,q.route):this.activateWith(q.route,q.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const q=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(q.instance),q}attach(q,At){this.activated=q,this._activatedRoute=At,this.location.insert(q.hostView),this.attachEvents.emit(q.instance)}deactivate(){if(this.activated){const q=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(q)}}activateWith(q,At){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=q;const Ve=(At=At||this.resolver).resolveComponentFactory(q._futureSnapshot.routeConfig.component),ti=this.parentContexts.getOrCreateContext(this.name).children,Li=new Lo(q,ti,this.location.injector);this.activated=this.location.createComponent(Ve,this.location.length,Li),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return dt.\u0275fac=function(q){return new(q||dt)(C.Y36(ar),C.Y36(C.s_b),C.Y36(C._Vd),C.$8M("name"),C.Y36(C.sBO))},dt.\u0275dir=C.lG2({type:dt,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),dt})();class Lo{constructor(ot,q,At){this.route=ot,this.childContexts=q,this.parent=At}get(ot,q){return ot===Mi?this.route:ot===ar?this.childContexts:this.parent.get(ot,q)}}let Cs=(()=>{class dt{}return dt.\u0275fac=function(q){return new(q||dt)},dt.\u0275cmp=C.Xpm({type:dt,selectors:[["ng-component"]],decls:1,vars:0,template:function(q,At){1&q&&C._UZ(0,"router-outlet")},directives:[As],encapsulation:2}),dt})();function hr(dt,ot=""){for(let q=0;q<dt.length;q++){const At=dt[q];Oa(At,Wa(ot,At))}}function Oa(dt,ot){dt.children&&hr(dt.children,ot)}function Wa(dt,ot){return ot?dt||ot.path?dt&&!ot.path?`${dt}/`:!dt&&ot.path?ot.path:`${dt}/${ot.path}`:"":dt}function hs(dt){const ot=dt.children&&dt.children.map(hs),q=ot?Object.assign(Object.assign({},dt),{children:ot}):Object.assign({},dt);return!q.component&&(ot||q.loadChildren)&&q.outlet&&q.outlet!==le&&(q.component=Cs),q}function Jr(dt){return dt.outlet||le}function ks(dt,ot){const q=dt.filter(At=>Jr(At)===ot);return q.push(...dt.filter(At=>Jr(At)!==ot)),q}const pl={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function No(dt,ot,q){var At;if(""===ot.path)return"full"===ot.pathMatch&&(dt.hasChildren()||q.length>0)?Object.assign({},pl):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const pe=(ot.matcher||$e)(q,dt,ot);if(!pe)return Object.assign({},pl);const Ve={};ge(pe.posParams,(Li,wn)=>{Ve[wn]=Li.path});const ti=pe.consumed.length>0?Object.assign(Object.assign({},Ve),pe.consumed[pe.consumed.length-1].parameters):Ve;return{matched:!0,consumedSegments:pe.consumed,lastChild:pe.consumed.length,parameters:ti,positionalParamSegments:null!==(At=pe.posParams)&&void 0!==At?At:{}}}function Pn(dt,ot,q,At,Wt="corrected"){if(q.length>0&&function Q(dt,ot,q){return q.some(At=>j(dt,ot,At)&&Jr(At)!==le)}(dt,q,At)){const Ve=new He(ot,function kt(dt,ot,q,At){const Wt={};Wt[le]=At,At._sourceSegment=dt,At._segmentIndexShift=ot.length;for(const pe of q)if(""===pe.path&&Jr(pe)!==le){const Ve=new He([],{});Ve._sourceSegment=dt,Ve._segmentIndexShift=ot.length,Wt[Jr(pe)]=Ve}return Wt}(dt,ot,At,new He(q,dt.children)));return Ve._sourceSegment=dt,Ve._segmentIndexShift=ot.length,{segmentGroup:Ve,slicedSegments:[]}}if(0===q.length&&function V(dt,ot,q){return q.some(At=>j(dt,ot,At))}(dt,q,At)){const Ve=new He(dt.segments,function fa(dt,ot,q,At,Wt,pe){const Ve={};for(const ti of At)if(j(dt,q,ti)&&!Wt[Jr(ti)]){const Li=new He([],{});Li._sourceSegment=dt,Li._segmentIndexShift="legacy"===pe?dt.segments.length:ot.length,Ve[Jr(ti)]=Li}return Object.assign(Object.assign({},Wt),Ve)}(dt,ot,q,At,dt.children,Wt));return Ve._sourceSegment=dt,Ve._segmentIndexShift=ot.length,{segmentGroup:Ve,slicedSegments:q}}const pe=new He(dt.segments,dt.children);return pe._sourceSegment=dt,pe._segmentIndexShift=ot.length,{segmentGroup:pe,slicedSegments:q}}function j(dt,ot,q){return(!(dt.hasChildren()||ot.length>0)||"full"!==q.pathMatch)&&""===q.path}function Ot(dt,ot,q,At){return!!(Jr(dt)===At||At!==le&&j(ot,q,dt))&&("**"===dt.path||No(ot,dt,q).matched)}function Be(dt,ot,q){return 0===ot.length&&!dt.children[q]}class bi{constructor(ot){this.segmentGroup=ot||null}}class un{constructor(ot){this.urlTree=ot}}function Hn(dt){return new t.y(ot=>ot.error(new bi(dt)))}function Po(dt){return new t.y(ot=>ot.error(new un(dt)))}function Yo(dt){return new t.y(ot=>ot.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${dt}'`)))}class fo{constructor(ot,q,At,Wt,pe){this.configLoader=q,this.urlSerializer=At,this.urlTree=Wt,this.config=pe,this.allowRedirects=!0,this.ngModule=ot.get(C.h0i)}apply(){const ot=Pn(this.urlTree.root,[],[],this.config).segmentGroup,q=new He(ot.segments,ot.children);return this.expandSegmentGroup(this.ngModule,this.config,q,le).pipe((0,ct.U)(pe=>this.createUrlTree(Jn(pe),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,xt.K)(pe=>{if(pe instanceof un)return this.allowRedirects=!1,this.match(pe.urlTree);throw pe instanceof bi?this.noMatchError(pe):pe}))}match(ot){return this.expandSegmentGroup(this.ngModule,this.config,ot.root,le).pipe((0,ct.U)(Wt=>this.createUrlTree(Jn(Wt),ot.queryParams,ot.fragment))).pipe((0,xt.K)(Wt=>{throw Wt instanceof bi?this.noMatchError(Wt):Wt}))}noMatchError(ot){return new Error(`Cannot match any routes. URL Segment: '${ot.segmentGroup}'`)}createUrlTree(ot,q,At){const Wt=ot.segments.length>0?new He([],{[le]:ot}):ot;return new fe(Wt,q,At)}expandSegmentGroup(ot,q,At,Wt){return 0===At.segments.length&&At.hasChildren()?this.expandChildren(ot,q,At).pipe((0,ct.U)(pe=>new He([],pe))):this.expandSegment(ot,At,q,At.segments,Wt,!0)}expandChildren(ot,q,At){const Wt=[];for(const pe of Object.keys(At.children))"primary"===pe?Wt.unshift(pe):Wt.push(pe);return(0,R.D)(Wt).pipe((0,Lt.b)(pe=>{const Ve=At.children[pe],ti=ks(q,pe);return this.expandSegmentGroup(ot,ti,Ve,pe).pipe((0,ct.U)(Li=>({segment:Li,outlet:pe})))}),Ut((pe,Ve)=>(pe[Ve.outlet]=Ve.segment,pe),{}),function Ft(dt,ot){const q=arguments.length>=2;return At=>At.pipe(dt?(0,Jt.h)((Wt,pe)=>dt(Wt,pe,At)):lt.y,Ct(1),q?ft(ot):bt(()=>new e))}())}expandSegment(ot,q,At,Wt,pe,Ve){return(0,R.D)(At).pipe((0,Lt.b)(ti=>this.expandSegmentAgainstRoute(ot,q,At,ti,Wt,pe,Ve).pipe((0,xt.K)(wn=>{if(wn instanceof bi)return(0,L.of)(null);throw wn}))),yt(ti=>!!ti),(0,xt.K)((ti,Li)=>{if(ti instanceof e||"EmptyError"===ti.name){if(Be(q,Wt,pe))return(0,L.of)(new He([],{}));throw new bi(q)}throw ti}))}expandSegmentAgainstRoute(ot,q,At,Wt,pe,Ve,ti){return Ot(Wt,q,pe,Ve)?void 0===Wt.redirectTo?this.matchSegmentAgainstRoute(ot,q,Wt,pe,Ve):ti&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(ot,q,At,Wt,pe,Ve):Hn(q):Hn(q)}expandSegmentAgainstRouteUsingRedirect(ot,q,At,Wt,pe,Ve){return"**"===Wt.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(ot,At,Wt,Ve):this.expandRegularSegmentAgainstRouteUsingRedirect(ot,q,At,Wt,pe,Ve)}expandWildCardWithParamsAgainstRouteUsingRedirect(ot,q,At,Wt){const pe=this.applyRedirectCommands([],At.redirectTo,{});return At.redirectTo.startsWith("/")?Po(pe):this.lineralizeSegments(At,pe).pipe((0,de.z)(Ve=>{const ti=new He(Ve,{});return this.expandSegment(ot,ti,q,Ve,Wt,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(ot,q,At,Wt,pe,Ve){const{matched:ti,consumedSegments:Li,lastChild:wn,positionalParamSegments:Co}=No(q,Wt,pe);if(!ti)return Hn(q);const Kn=this.applyRedirectCommands(Li,Wt.redirectTo,Co);return Wt.redirectTo.startsWith("/")?Po(Kn):this.lineralizeSegments(Wt,Kn).pipe((0,de.z)(Jo=>this.expandSegment(ot,q,At,Jo.concat(pe.slice(wn)),Ve,!1)))}matchSegmentAgainstRoute(ot,q,At,Wt,pe){if("**"===At.path)return At.loadChildren?(At._loadedConfig?(0,L.of)(At._loadedConfig):this.configLoader.load(ot.injector,At)).pipe((0,ct.U)(Jo=>(At._loadedConfig=Jo,new He(Wt,{})))):(0,L.of)(new He(Wt,{}));const{matched:Ve,consumedSegments:ti,lastChild:Li}=No(q,At,Wt);if(!Ve)return Hn(q);const wn=Wt.slice(Li);return this.getChildConfig(ot,At,Wt).pipe((0,de.z)(Kn=>{const Jo=Kn.module,pr=Kn.routes,{segmentGroup:Sl,slicedSegments:Us}=Pn(q,ti,wn,pr),fs=new He(Sl.segments,Sl.children);if(0===Us.length&&fs.hasChildren())return this.expandChildren(Jo,pr,fs).pipe((0,ct.U)(_l=>new He(ti,_l)));if(0===pr.length&&0===Us.length)return(0,L.of)(new He(ti,{}));const Vs=Jr(At)===pe;return this.expandSegment(Jo,fs,pr,Us,Vs?le:pe,!0).pipe((0,ct.U)(os=>new He(ti.concat(os.segments),os.children)))}))}getChildConfig(ot,q,At){return q.children?(0,L.of)(new Go(q.children,ot)):q.loadChildren?void 0!==q._loadedConfig?(0,L.of)(q._loadedConfig):this.runCanLoadGuards(ot.injector,q,At).pipe((0,de.z)(Wt=>Wt?this.configLoader.load(ot.injector,q).pipe((0,ct.U)(pe=>(q._loadedConfig=pe,pe))):function Fo(dt){return new t.y(ot=>ot.error(Zt(`Cannot load children because the guard of the route "path: '${dt.path}'" returned false`)))}(q))):(0,L.of)(new Go([],ot))}runCanLoadGuards(ot,q,At){const Wt=q.canLoad;if(!Wt||0===Wt.length)return(0,L.of)(!0);const pe=Wt.map(Ve=>{const ti=ot.get(Ve);let Li;if(function zr(dt){return dt&&Bo(dt.canLoad)}(ti))Li=ti.canLoad(q,At);else{if(!Bo(ti))throw new Error("Invalid CanLoad guard");Li=ti(q,At)}return De(Li)});return(0,L.of)(pe).pipe(tr(),(0,_e.b)(Ve=>{if(!Ar(Ve))return;const ti=Zt(`Redirecting to "${this.urlSerializer.serialize(Ve)}"`);throw ti.url=Ve,ti}),(0,ct.U)(Ve=>!0===Ve))}lineralizeSegments(ot,q){let At=[],Wt=q.root;for(;;){if(At=At.concat(Wt.segments),0===Wt.numberOfChildren)return(0,L.of)(At);if(Wt.numberOfChildren>1||!Wt.children[le])return Yo(ot.redirectTo);Wt=Wt.children[le]}}applyRedirectCommands(ot,q,At){return this.applyRedirectCreatreUrlTree(q,this.urlSerializer.parse(q),ot,At)}applyRedirectCreatreUrlTree(ot,q,At,Wt){const pe=this.createSegmentGroup(ot,q.root,At,Wt);return new fe(pe,this.createQueryParams(q.queryParams,this.urlTree.queryParams),q.fragment)}createQueryParams(ot,q){const At={};return ge(ot,(Wt,pe)=>{if("string"==typeof Wt&&Wt.startsWith(":")){const ti=Wt.substring(1);At[pe]=q[ti]}else At[pe]=Wt}),At}createSegmentGroup(ot,q,At,Wt){const pe=this.createSegments(ot,q.segments,At,Wt);let Ve={};return ge(q.children,(ti,Li)=>{Ve[Li]=this.createSegmentGroup(ot,ti,At,Wt)}),new He(pe,Ve)}createSegments(ot,q,At,Wt){return q.map(pe=>pe.path.startsWith(":")?this.findPosParam(ot,pe,Wt):this.findOrReturn(pe,At))}findPosParam(ot,q,At){const Wt=At[q.path.substring(1)];if(!Wt)throw new Error(`Cannot redirect to '${ot}'. Cannot find '${q.path}'.`);return Wt}findOrReturn(ot,q){let At=0;for(const Wt of q){if(Wt.path===ot.path)return q.splice(At),Wt;At++}return ot}}function Jn(dt){const ot={};for(const At of Object.keys(dt.children)){const pe=Jn(dt.children[At]);(pe.segments.length>0||pe.hasChildren())&&(ot[At]=pe)}return function xr(dt){if(1===dt.numberOfChildren&&dt.children[le]){const ot=dt.children[le];return new He(dt.segments.concat(ot.segments),ot.children)}return dt}(new He(dt.segments,ot))}class sl{constructor(ot){this.path=ot,this.route=this.path[this.path.length-1]}}class $r{constructor(ot,q){this.component=ot,this.route=q}}function za(dt,ot,q){const At=dt._root;return Xi(At,ot?ot._root:null,q,[At.value])}function Ta(dt,ot,q){const At=function yc(dt){if(!dt)return null;for(let ot=dt.parent;ot;ot=ot.parent){const q=ot.routeConfig;if(q&&q._loadedConfig)return q._loadedConfig}return null}(ot);return(At?At.module.injector:q).get(dt)}function Xi(dt,ot,q,At,Wt={canDeactivateChecks:[],canActivateChecks:[]}){const pe=On(ot);return dt.children.forEach(Ve=>{(function Ho(dt,ot,q,At,Wt={canDeactivateChecks:[],canActivateChecks:[]}){const pe=dt.value,Ve=ot?ot.value:null,ti=q?q.getContext(dt.value.outlet):null;if(Ve&&pe.routeConfig===Ve.routeConfig){const Li=function ie(dt,ot,q){if("function"==typeof q)return q(dt,ot);switch(q){case"pathParamsChange":return!In(dt.url,ot.url);case"pathParamsOrQueryParamsChange":return!In(dt.url,ot.url)||!vi(dt.queryParams,ot.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!_r(dt,ot)||!vi(dt.queryParams,ot.queryParams);default:return!_r(dt,ot)}}(Ve,pe,pe.routeConfig.runGuardsAndResolvers);Li?Wt.canActivateChecks.push(new sl(At)):(pe.data=Ve.data,pe._resolvedData=Ve._resolvedData),Xi(dt,ot,pe.component?ti?ti.children:null:q,At,Wt),Li&&ti&&ti.outlet&&ti.outlet.isActivated&&Wt.canDeactivateChecks.push(new $r(ti.outlet.component,Ve))}else Ve&&z(ot,ti,Wt),Wt.canActivateChecks.push(new sl(At)),Xi(dt,null,pe.component?ti?ti.children:null:q,At,Wt)})(Ve,pe[Ve.value.outlet],q,At.concat([Ve.value]),Wt),delete pe[Ve.value.outlet]}),ge(pe,(Ve,ti)=>z(Ve,q.getContext(ti),Wt)),Wt}function z(dt,ot,q){const At=On(dt),Wt=dt.value;ge(At,(pe,Ve)=>{z(pe,Wt.component?ot?ot.children.getContext(Ve):null:ot,q)}),q.canDeactivateChecks.push(new $r(Wt.component&&ot&&ot.outlet&&ot.outlet.isActivated?ot.outlet.component:null,Wt))}class hn{}function Tn(dt){return new t.y(ot=>ot.error(dt))}class po{constructor(ot,q,At,Wt,pe,Ve){this.rootComponentType=ot,this.config=q,this.urlTree=At,this.url=Wt,this.paramsInheritanceStrategy=pe,this.relativeLinkResolution=Ve}recognize(){const ot=Pn(this.urlTree.root,[],[],this.config.filter(Ve=>void 0===Ve.redirectTo),this.relativeLinkResolution).segmentGroup,q=this.processSegmentGroup(this.config,ot,le);if(null===q)return null;const At=new qn([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},le,this.rootComponentType,null,this.urlTree.root,-1,{}),Wt=new Bi(At,q),pe=new ao(this.url,Wt);return this.inheritParamsAndData(pe._root),pe}inheritParamsAndData(ot){const q=ot.value,At=Yi(q,this.paramsInheritanceStrategy);q.params=Object.freeze(At.params),q.data=Object.freeze(At.data),ot.children.forEach(Wt=>this.inheritParamsAndData(Wt))}processSegmentGroup(ot,q,At){return 0===q.segments.length&&q.hasChildren()?this.processChildren(ot,q):this.processSegment(ot,q,q.segments,At)}processChildren(ot,q){const At=[];for(const pe of Object.keys(q.children)){const Ve=q.children[pe],ti=ks(ot,pe),Li=this.processSegmentGroup(ti,Ve,pe);if(null===Li)return null;At.push(...Li)}const Wt=Ko(At);return function Un(dt){dt.sort((ot,q)=>ot.value.outlet===le?-1:q.value.outlet===le?1:ot.value.outlet.localeCompare(q.value.outlet))}(Wt),Wt}processSegment(ot,q,At,Wt){for(const pe of ot){const Ve=this.processSegmentAgainstRoute(pe,q,At,Wt);if(null!==Ve)return Ve}return Be(q,At,Wt)?[]:null}processSegmentAgainstRoute(ot,q,At,Wt){if(ot.redirectTo||!Ot(ot,q,At,Wt))return null;let pe,Ve=[],ti=[];if("**"===ot.path){const pr=At.length>0?Ri(At).parameters:{};pe=new qn(At,pr,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Ls(ot),Jr(ot),ot.component,ot,is(q),Hr(q)+At.length,ds(ot))}else{const pr=No(q,ot,At);if(!pr.matched)return null;Ve=pr.consumedSegments,ti=At.slice(pr.lastChild),pe=new qn(Ve,pr.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Ls(ot),Jr(ot),ot.component,ot,is(q),Hr(q)+Ve.length,ds(ot))}const Li=function jn(dt){return dt.children?dt.children:dt.loadChildren?dt._loadedConfig.routes:[]}(ot),{segmentGroup:wn,slicedSegments:Co}=Pn(q,Ve,ti,Li.filter(pr=>void 0===pr.redirectTo),this.relativeLinkResolution);if(0===Co.length&&wn.hasChildren()){const pr=this.processChildren(Li,wn);return null===pr?null:[new Bi(pe,pr)]}if(0===Li.length&&0===Co.length)return[new Bi(pe,[])];const Kn=Jr(ot)===Wt,Jo=this.processSegment(Li,wn,Co,Kn?le:Wt);return null===Jo?null:[new Bi(pe,Jo)]}}function oo(dt){const ot=dt.value.routeConfig;return ot&&""===ot.path&&void 0===ot.redirectTo}function Ko(dt){const ot=[],q=new Set;for(const At of dt){if(!oo(At)){ot.push(At);continue}const Wt=ot.find(pe=>At.value.routeConfig===pe.value.routeConfig);void 0!==Wt?(Wt.children.push(...At.children),q.add(Wt)):ot.push(At)}for(const At of q){const Wt=Ko(At.children);ot.push(new Bi(At.value,Wt))}return ot.filter(At=>!q.has(At))}function is(dt){let ot=dt;for(;ot._sourceSegment;)ot=ot._sourceSegment;return ot}function Hr(dt){let ot=dt,q=ot._segmentIndexShift?ot._segmentIndexShift:0;for(;ot._sourceSegment;)ot=ot._sourceSegment,q+=ot._segmentIndexShift?ot._segmentIndexShift:0;return q-1}function Ls(dt){return dt.data||{}}function ds(dt){return dt.resolve||{}}function ir(dt){return(0,rt.w)(ot=>{const q=dt(ot);return q?(0,R.D)(q).pipe((0,ct.U)(()=>ot)):(0,L.of)(ot)})}class ps extends class ja{shouldDetach(ot){return!1}store(ot,q){}shouldAttach(ot){return!1}retrieve(ot){return null}shouldReuseRoute(ot,q){return ot.routeConfig===q.routeConfig}}{}const Sn=new C.OlP("ROUTES");class Xn{constructor(ot,q,At,Wt){this.injector=ot,this.compiler=q,this.onLoadStartListener=At,this.onLoadEndListener=Wt}load(ot,q){if(q._loader$)return q._loader$;this.onLoadStartListener&&this.onLoadStartListener(q);const Wt=this.loadModuleFactory(q.loadChildren).pipe((0,ct.U)(pe=>{this.onLoadEndListener&&this.onLoadEndListener(q);const Ve=pe.create(ot);return new Go(Gi(Ve.injector.get(Sn,void 0,C.XFs.Self|C.XFs.Optional)).map(hs),Ve)}),(0,xt.K)(pe=>{throw q._loader$=void 0,pe}));return q._loader$=new h(Wt,()=>new gt.x).pipe(a()),q._loader$}loadModuleFactory(ot){return De(ot()).pipe((0,de.z)(q=>q instanceof C.YKP?(0,L.of)(q):(0,R.D)(this.compiler.compileModuleAsync(q))))}}class bo{shouldProcessUrl(ot){return!0}extract(ot){return ot}merge(ot,q){return ot}}function Eo(dt){throw dt}function Ns(dt,ot,q){return ot.parse("/")}function Ps(dt,ot){return(0,L.of)(null)}const ra={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},lr={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Lr=(()=>{class dt{constructor(q,At,Wt,pe,Ve,ti,Li){this.rootComponentType=q,this.urlSerializer=At,this.rootContexts=Wt,this.location=pe,this.config=Li,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new gt.x,this.errorHandler=Eo,this.malformedUriErrorHandler=Ns,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Ps,afterPreactivation:Ps},this.urlHandlingStrategy=new bo,this.routeReuseStrategy=new ps,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=Ve.get(C.h0i),this.console=Ve.get(C.c2e);const Kn=Ve.get(C.R0b);this.isNgZoneEnabled=Kn instanceof C.R0b&&C.R0b.isInAngularZone(),this.resetConfig(Li),this.currentUrlTree=function _i(){return new fe(new He([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Xn(Ve,ti,Jo=>this.triggerEvent(new ve(Jo)),Jo=>this.triggerEvent(new je(Jo))),this.routerState=ae(this.currentUrlTree,this.rootComponentType),this.transitions=new W.X({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var q;return null===(q=this.location.getState())||void 0===q?void 0:q.\u0275routerPageId}setupNavigations(q){const At=this.events;return q.pipe((0,Jt.h)(Wt=>0!==Wt.id),(0,ct.U)(Wt=>Object.assign(Object.assign({},Wt),{extractedUrl:this.urlHandlingStrategy.extract(Wt.rawUrl)})),(0,rt.w)(Wt=>{let pe=!1,Ve=!1;return(0,L.of)(Wt).pipe((0,_e.b)(ti=>{this.currentNavigation={id:ti.id,initialUrl:ti.currentRawUrl,extractedUrl:ti.extractedUrl,trigger:ti.source,extras:ti.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),(0,rt.w)(ti=>{const Li=this.browserUrlTree.toString(),wn=!this.navigated||ti.extractedUrl.toString()!==Li||Li!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||wn)&&this.urlHandlingStrategy.shouldProcessUrl(ti.rawUrl))return Ss(ti.source)&&(this.browserUrlTree=ti.extractedUrl),(0,L.of)(ti).pipe((0,rt.w)(Kn=>{const Jo=this.transitions.getValue();return At.next(new Di(Kn.id,this.serializeUrl(Kn.extractedUrl),Kn.source,Kn.restoredState)),Jo!==this.transitions.getValue()?It.E:Promise.resolve(Kn)}),function Ks(dt,ot,q,At){return(0,rt.w)(Wt=>function er(dt,ot,q,At,Wt){return new fo(dt,ot,q,At,Wt).apply()}(dt,ot,q,Wt.extractedUrl,At).pipe((0,ct.U)(pe=>Object.assign(Object.assign({},Wt),{urlAfterRedirects:pe}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,_e.b)(Kn=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:Kn.urlAfterRedirects})}),function Sr(dt,ot,q,At,Wt){return(0,de.z)(pe=>function $n(dt,ot,q,At,Wt="emptyOnly",pe="legacy"){try{const Ve=new po(dt,ot,q,At,Wt,pe).recognize();return null===Ve?Tn(new hn):(0,L.of)(Ve)}catch(Ve){return Tn(Ve)}}(dt,ot,pe.urlAfterRedirects,q(pe.urlAfterRedirects),At,Wt).pipe((0,ct.U)(Ve=>Object.assign(Object.assign({},pe),{targetSnapshot:Ve}))))}(this.rootComponentType,this.config,Kn=>this.serializeUrl(Kn),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,_e.b)(Kn=>{if("eager"===this.urlUpdateStrategy){if(!Kn.extras.skipLocationChange){const pr=this.urlHandlingStrategy.merge(Kn.urlAfterRedirects,Kn.rawUrl);this.setBrowserUrl(pr,Kn)}this.browserUrlTree=Kn.urlAfterRedirects}const Jo=new Bt(Kn.id,this.serializeUrl(Kn.extractedUrl),this.serializeUrl(Kn.urlAfterRedirects),Kn.targetSnapshot);At.next(Jo)}));if(wn&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Jo,extractedUrl:pr,source:Sl,restoredState:Us,extras:fs}=ti,Vs=new Di(Jo,this.serializeUrl(pr),Sl,Us);At.next(Vs);const Ka=ae(pr,this.rootComponentType).snapshot;return(0,L.of)(Object.assign(Object.assign({},ti),{targetSnapshot:Ka,urlAfterRedirects:pr,extras:Object.assign(Object.assign({},fs),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=ti.rawUrl,ti.resolve(null),It.E}),ir(ti=>{const{targetSnapshot:Li,id:wn,extractedUrl:Co,rawUrl:Kn,extras:{skipLocationChange:Jo,replaceUrl:pr}}=ti;return this.hooks.beforePreactivation(Li,{navigationId:wn,appliedUrlTree:Co,rawUrlTree:Kn,skipLocationChange:!!Jo,replaceUrl:!!pr})}),(0,_e.b)(ti=>{const Li=new Ie(ti.id,this.serializeUrl(ti.extractedUrl),this.serializeUrl(ti.urlAfterRedirects),ti.targetSnapshot);this.triggerEvent(Li)}),(0,ct.U)(ti=>Object.assign(Object.assign({},ti),{guards:za(ti.targetSnapshot,ti.currentSnapshot,this.rootContexts)})),function J(dt,ot){return(0,de.z)(q=>{const{targetSnapshot:At,currentSnapshot:Wt,guards:{canActivateChecks:pe,canDeactivateChecks:Ve}}=q;return 0===Ve.length&&0===pe.length?(0,L.of)(Object.assign(Object.assign({},q),{guardsResult:!0})):function _t(dt,ot,q,At){return(0,R.D)(dt).pipe((0,de.z)(Wt=>function Ui(dt,ot,q,At,Wt){const pe=ot&&ot.routeConfig?ot.routeConfig.canDeactivate:null;if(!pe||0===pe.length)return(0,L.of)(!0);const Ve=pe.map(ti=>{const Li=Ta(ti,ot,Wt);let wn;if(function pa(dt){return dt&&Bo(dt.canDeactivate)}(Li))wn=De(Li.canDeactivate(dt,ot,q,At));else{if(!Bo(Li))throw new Error("Invalid CanDeactivate guard");wn=De(Li(dt,ot,q,At))}return wn.pipe(yt())});return(0,L.of)(Ve).pipe(tr())}(Wt.component,Wt.route,q,ot,At)),yt(Wt=>!0!==Wt,!0))}(Ve,At,Wt,dt).pipe((0,de.z)(ti=>ti&&function na(dt){return"boolean"==typeof dt}(ti)?function Qt(dt,ot,q,At){return(0,R.D)(ot).pipe((0,Lt.b)(Wt=>(0,et.z)(function Ye(dt,ot){return null!==dt&&ot&&ot(new gi(dt)),(0,L.of)(!0)}(Wt.route.parent,At),function Te(dt,ot){return null!==dt&&ot&&ot(new ne(dt)),(0,L.of)(!0)}(Wt.route,At),function mi(dt,ot,q){const At=ot[ot.length-1],pe=ot.slice(0,ot.length-1).reverse().map(Ve=>function xs(dt){const ot=dt.routeConfig?dt.routeConfig.canActivateChild:null;return ot&&0!==ot.length?{node:dt,guards:ot}:null}(Ve)).filter(Ve=>null!==Ve).map(Ve=>(0,Et.P)(()=>{const ti=Ve.guards.map(Li=>{const wn=Ta(Li,Ve.node,q);let Co;if(function Br(dt){return dt&&Bo(dt.canActivateChild)}(wn))Co=De(wn.canActivateChild(At,dt));else{if(!Bo(wn))throw new Error("Invalid CanActivateChild guard");Co=De(wn(At,dt))}return Co.pipe(yt())});return(0,L.of)(ti).pipe(tr())}));return(0,L.of)(pe).pipe(tr())}(dt,Wt.path,q),function Qe(dt,ot,q){const At=ot.routeConfig?ot.routeConfig.canActivate:null;if(!At||0===At.length)return(0,L.of)(!0);const Wt=At.map(pe=>(0,Et.P)(()=>{const Ve=Ta(pe,ot,q);let ti;if(function oa(dt){return dt&&Bo(dt.canActivate)}(Ve))ti=De(Ve.canActivate(ot,dt));else{if(!Bo(Ve))throw new Error("Invalid CanActivate guard");ti=De(Ve(ot,dt))}return ti.pipe(yt())}));return(0,L.of)(Wt).pipe(tr())}(dt,Wt.route,q))),yt(Wt=>!0!==Wt,!0))}(At,pe,dt,ot):(0,L.of)(ti)),(0,ct.U)(ti=>Object.assign(Object.assign({},q),{guardsResult:ti})))})}(this.ngModule.injector,ti=>this.triggerEvent(ti)),(0,_e.b)(ti=>{if(Ar(ti.guardsResult)){const wn=Zt(`Redirecting to "${this.serializeUrl(ti.guardsResult)}"`);throw wn.url=ti.guardsResult,wn}const Li=new Xt(ti.id,this.serializeUrl(ti.extractedUrl),this.serializeUrl(ti.urlAfterRedirects),ti.targetSnapshot,!!ti.guardsResult);this.triggerEvent(Li)}),(0,Jt.h)(ti=>!!ti.guardsResult||(this.restoreHistory(ti),this.cancelNavigationTransition(ti,""),!1)),ir(ti=>{if(ti.guards.canActivateChecks.length)return(0,L.of)(ti).pipe((0,_e.b)(Li=>{const wn=new he(Li.id,this.serializeUrl(Li.extractedUrl),this.serializeUrl(Li.urlAfterRedirects),Li.targetSnapshot);this.triggerEvent(wn)}),(0,rt.w)(Li=>{let wn=!1;return(0,L.of)(Li).pipe(function Js(dt,ot){return(0,de.z)(q=>{const{targetSnapshot:At,guards:{canActivateChecks:Wt}}=q;if(!Wt.length)return(0,L.of)(q);let pe=0;return(0,R.D)(Wt).pipe((0,Lt.b)(Ve=>function $s(dt,ot,q,At){return function Zs(dt,ot,q,At){const Wt=Object.keys(dt);if(0===Wt.length)return(0,L.of)({});const pe={};return(0,R.D)(Wt).pipe((0,de.z)(Ve=>function Aa(dt,ot,q,At){const Wt=Ta(dt,ot,At);return De(Wt.resolve?Wt.resolve(ot,q):Wt(ot,q))}(dt[Ve],ot,q,At).pipe((0,_e.b)(ti=>{pe[Ve]=ti}))),Ct(1),(0,de.z)(()=>Object.keys(pe).length===Wt.length?(0,L.of)(pe):It.E))}(dt._resolve,dt,ot,At).pipe((0,ct.U)(pe=>(dt._resolvedData=pe,dt.data=Object.assign(Object.assign({},dt.data),Yi(dt,q).resolve),null)))}(Ve.route,At,dt,ot)),(0,_e.b)(()=>pe++),Ct(1),(0,de.z)(Ve=>pe===Wt.length?(0,L.of)(q):It.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,_e.b)({next:()=>wn=!0,complete:()=>{wn||(this.restoreHistory(Li),this.cancelNavigationTransition(Li,"At least one route resolver didn't emit any value."))}}))}),(0,_e.b)(Li=>{const wn=new Dt(Li.id,this.serializeUrl(Li.extractedUrl),this.serializeUrl(Li.urlAfterRedirects),Li.targetSnapshot);this.triggerEvent(wn)}))}),ir(ti=>{const{targetSnapshot:Li,id:wn,extractedUrl:Co,rawUrl:Kn,extras:{skipLocationChange:Jo,replaceUrl:pr}}=ti;return this.hooks.afterPreactivation(Li,{navigationId:wn,appliedUrlTree:Co,rawUrlTree:Kn,skipLocationChange:!!Jo,replaceUrl:!!pr})}),(0,ct.U)(ti=>{const Li=function rr(dt,ot,q){const At=Or(dt,ot._root,q?q._root:void 0);return new Wn(At,ot)}(this.routeReuseStrategy,ti.targetSnapshot,ti.currentRouterState);return Object.assign(Object.assign({},ti),{targetRouterState:Li})}),(0,_e.b)(ti=>{this.currentUrlTree=ti.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(ti.urlAfterRedirects,ti.rawUrl),this.routerState=ti.targetRouterState,"deferred"===this.urlUpdateStrategy&&(ti.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,ti),this.browserUrlTree=ti.urlAfterRedirects)}),((dt,ot,q)=>(0,ct.U)(At=>(new Ga(ot,At.targetRouterState,At.currentRouterState,q).activate(dt),At)))(this.rootContexts,this.routeReuseStrategy,ti=>this.triggerEvent(ti)),(0,_e.b)({next(){pe=!0},complete(){pe=!0}}),(0,ce.x)(()=>{var ti;pe||Ve||this.cancelNavigationTransition(Wt,`Navigation ID ${Wt.id} is not equal to the current navigation id ${this.navigationId}`),(null===(ti=this.currentNavigation)||void 0===ti?void 0:ti.id)===Wt.id&&(this.currentNavigation=null)}),(0,xt.K)(ti=>{if(Ve=!0,function We(dt){return dt&&dt[Kt]}(ti)){const Li=Ar(ti.url);Li||(this.navigated=!0,this.restoreHistory(Wt,!0));const wn=new Me(Wt.id,this.serializeUrl(Wt.extractedUrl),ti.message);At.next(wn),Li?setTimeout(()=>{const Co=this.urlHandlingStrategy.merge(ti.url,this.rawUrlTree),Kn={skipLocationChange:Wt.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Ss(Wt.source)};this.scheduleNavigation(Co,"imperative",null,Kn,{resolve:Wt.resolve,reject:Wt.reject,promise:Wt.promise})},0):Wt.resolve(!1)}else{this.restoreHistory(Wt,!0);const Li=new ri(Wt.id,this.serializeUrl(Wt.extractedUrl),ti);At.next(Li);try{Wt.resolve(this.errorHandler(ti))}catch(wn){Wt.reject(wn)}}return It.E}))}))}resetRootComponentType(q){this.rootComponentType=q,this.routerState.root.component=this.rootComponentType}setTransition(q){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),q))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(q=>{const At="popstate"===q.type?"popstate":"hashchange";"popstate"===At&&setTimeout(()=>{var Wt;const pe={replaceUrl:!0},Ve=(null===(Wt=q.state)||void 0===Wt?void 0:Wt.navigationId)?q.state:null;if(Ve){const Li=Object.assign({},Ve);delete Li.navigationId,delete Li.\u0275routerPageId,0!==Object.keys(Li).length&&(pe.state=Li)}const ti=this.parseUrl(q.url);this.scheduleNavigation(ti,At,Ve,pe)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(q){this.events.next(q)}resetConfig(q){hr(q),this.config=q.map(hs),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(q,At={}){const{relativeTo:Wt,queryParams:pe,fragment:Ve,queryParamsHandling:ti,preserveFragment:Li}=At,wn=Wt||this.routerState.root,Co=Li?this.currentUrlTree.fragment:Ve;let Kn=null;switch(ti){case"merge":Kn=Object.assign(Object.assign({},this.currentUrlTree.queryParams),pe);break;case"preserve":Kn=this.currentUrlTree.queryParams;break;default:Kn=pe||null}return null!==Kn&&(Kn=this.removeEmptyProps(Kn)),function Wr(dt,ot,q,At,Wt){if(0===q.length)return Ua(ot.root,ot.root,ot,At,Wt);const pe=function ya(dt){if("string"==typeof dt[0]&&1===dt.length&&"/"===dt[0])return new us(!0,0,dt);let ot=0,q=!1;const At=dt.reduce((Wt,pe,Ve)=>{if("object"==typeof pe&&null!=pe){if(pe.outlets){const ti={};return ge(pe.outlets,(Li,wn)=>{ti[wn]="string"==typeof Li?Li.split("/"):Li}),[...Wt,{outlets:ti}]}if(pe.segmentPath)return[...Wt,pe.segmentPath]}return"string"!=typeof pe?[...Wt,pe]:0===Ve?(pe.split("/").forEach((ti,Li)=>{0==Li&&"."===ti||(0==Li&&""===ti?q=!0:".."===ti?ot++:""!=ti&&Wt.push(ti))}),Wt):[...Wt,pe]},[]);return new us(q,ot,At)}(q);if(pe.toRoot())return Ua(ot.root,new He([],{}),ot,At,Wt);const Ve=function Ma(dt,ot,q){if(dt.isAbsolute)return new Vo(ot.root,!0,0);if(-1===q.snapshot._lastPathIndex){const pe=q.snapshot._urlSegment;return new Vo(pe,pe===ot.root,0)}const At=sr(dt.commands[0])?0:1;return function dl(dt,ot,q){let At=dt,Wt=ot,pe=q;for(;pe>Wt;){if(pe-=Wt,At=At.parent,!At)throw new Error("Invalid number of '../'");Wt=At.segments.length}return new Vo(At,!1,Wt-pe)}(q.snapshot._urlSegment,q.snapshot._lastPathIndex+At,dt.numberOfDoubleDots)}(pe,ot,dt),ti=Ve.processChildren?nl(Ve.segmentGroup,Ve.index,pe.commands):ia(Ve.segmentGroup,Ve.index,pe.commands);return Ua(Ve.segmentGroup,ti,ot,At,Wt)}(wn,this.currentUrlTree,q,Kn,null!=Co?Co:null)}navigateByUrl(q,At={skipLocationChange:!1}){const Wt=Ar(q)?q:this.parseUrl(q),pe=this.urlHandlingStrategy.merge(Wt,this.rawUrlTree);return this.scheduleNavigation(pe,"imperative",null,At)}navigate(q,At={skipLocationChange:!1}){return function ns(dt){for(let ot=0;ot<dt.length;ot++){const q=dt[ot];if(null==q)throw new Error(`The requested path contains ${q} segment at index ${ot}`)}}(q),this.navigateByUrl(this.createUrlTree(q,At),At)}serializeUrl(q){return this.urlSerializer.serialize(q)}parseUrl(q){let At;try{At=this.urlSerializer.parse(q)}catch(Wt){At=this.malformedUriErrorHandler(Wt,this.urlSerializer,q)}return At}isActive(q,At){let Wt;if(Wt=!0===At?Object.assign({},ra):!1===At?Object.assign({},lr):At,Ar(q))return Ni(this.currentUrlTree,q,Wt);const pe=this.parseUrl(q);return Ni(this.currentUrlTree,pe,Wt)}removeEmptyProps(q){return Object.keys(q).reduce((At,Wt)=>{const pe=q[Wt];return null!=pe&&(At[Wt]=pe),At},{})}processNavigations(){this.navigations.subscribe(q=>{this.navigated=!0,this.lastSuccessfulId=q.id,this.currentPageId=q.targetPageId,this.events.next(new ei(q.id,this.serializeUrl(q.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,q.resolve(!0)},q=>{this.console.warn(`Unhandled Navigation Error: ${q}`)})}scheduleNavigation(q,At,Wt,pe,Ve){var ti,Li,wn;if(this.disposed)return Promise.resolve(!1);const Co=this.transitions.value,Kn=Ss(At)&&Co&&!Ss(Co.source),Jo=Co.rawUrl.toString()===q.toString(),pr=Co.id===(null===(ti=this.currentNavigation)||void 0===ti?void 0:ti.id);if(Kn&&Jo&&pr)return Promise.resolve(!0);let Us,fs,Vs;Ve?(Us=Ve.resolve,fs=Ve.reject,Vs=Ve.promise):Vs=new Promise((_l,Ja)=>{Us=_l,fs=Ja});const Ka=++this.navigationId;let os;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(Wt=this.location.getState()),os=Wt&&Wt.\u0275routerPageId?Wt.\u0275routerPageId:pe.replaceUrl||pe.skipLocationChange?null!==(Li=this.browserPageId)&&void 0!==Li?Li:0:(null!==(wn=this.browserPageId)&&void 0!==wn?wn:0)+1):os=0,this.setTransition({id:Ka,targetPageId:os,source:At,restoredState:Wt,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:q,extras:pe,resolve:Us,reject:fs,promise:Vs,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Vs.catch(_l=>Promise.reject(_l))}setBrowserUrl(q,At){const Wt=this.urlSerializer.serialize(q),pe=Object.assign(Object.assign({},At.extras.state),this.generateNgRouterState(At.id,At.targetPageId));this.location.isCurrentPathEqualTo(Wt)||At.extras.replaceUrl?this.location.replaceState(Wt,"",pe):this.location.go(Wt,"",pe)}restoreHistory(q,At=!1){var Wt,pe;if("computed"===this.canceledNavigationResolution){const Ve=this.currentPageId-q.targetPageId;"popstate"!==q.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(Wt=this.currentNavigation)||void 0===Wt?void 0:Wt.finalUrl)||0===Ve?this.currentUrlTree===(null===(pe=this.currentNavigation)||void 0===pe?void 0:pe.finalUrl)&&0===Ve&&(this.resetState(q),this.browserUrlTree=q.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(Ve)}else"replace"===this.canceledNavigationResolution&&(At&&this.resetState(q),this.resetUrlToCurrentUrlTree())}resetState(q){this.routerState=q.currentRouterState,this.currentUrlTree=q.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,q.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(q,At){const Wt=new Me(q.id,this.serializeUrl(q.extractedUrl),At);this.triggerEvent(Wt),q.resolve(!1)}generateNgRouterState(q,At){return"computed"===this.canceledNavigationResolution?{navigationId:q,\u0275routerPageId:At}:{navigationId:q}}}return dt.\u0275fac=function(q){C.$Z()},dt.\u0275prov=C.Yz7({token:dt,factory:dt.\u0275fac}),dt})();function Ss(dt){return"imperative"!==dt}let jr=(()=>{class dt{constructor(q,At,Wt){this.router=q,this.route=At,this.locationStrategy=Wt,this.commands=null,this.href=null,this.onChanges=new gt.x,this.subscription=q.events.subscribe(pe=>{pe instanceof ei&&this.updateTargetUrlAndHref()})}set routerLink(q){this.commands=null!=q?Array.isArray(q)?q:[q]:null}ngOnChanges(q){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(q,At,Wt,pe,Ve){if(0!==q||At||Wt||pe||Ve||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const ti={skipLocationChange:Fs(this.skipLocationChange),replaceUrl:Fs(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,ti),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Fs(this.preserveFragment)})}}return dt.\u0275fac=function(q){return new(q||dt)(C.Y36(Lr),C.Y36(Mi),C.Y36(Ne.S$))},dt.\u0275dir=C.lG2({type:dt,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(q,At){1&q&&C.NdJ("click",function(pe){return At.onClick(pe.button,pe.ctrlKey,pe.shiftKey,pe.altKey,pe.metaKey)}),2&q&&C.uIk("target",At.target)("href",At.href,C.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[C.TTD]}),dt})();function Fs(dt){return""===dt||!!dt}class Bs{}class sa{preload(ot,q){return(0,L.of)(null)}}let Ya=(()=>{class dt{constructor(q,At,Wt,pe){this.router=q,this.injector=Wt,this.preloadingStrategy=pe,this.loader=new Xn(Wt,At,Li=>q.triggerEvent(new ve(Li)),Li=>q.triggerEvent(new je(Li)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,Jt.h)(q=>q instanceof ei),(0,Lt.b)(()=>this.preload())).subscribe(()=>{})}preload(){const q=this.injector.get(C.h0i);return this.processRoutes(q,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(q,At){const Wt=[];for(const pe of At)if(pe.loadChildren&&!pe.canLoad&&pe._loadedConfig){const Ve=pe._loadedConfig;Wt.push(this.processRoutes(Ve.module,Ve.routes))}else pe.loadChildren&&!pe.canLoad?Wt.push(this.preloadConfig(q,pe)):pe.children&&Wt.push(this.processRoutes(q,pe.children));return(0,R.D)(Wt).pipe((0,Ae.J)(),(0,ct.U)(pe=>{}))}preloadConfig(q,At){return this.preloadingStrategy.preload(At,()=>(At._loadedConfig?(0,L.of)(At._loadedConfig):this.loader.load(q.injector,At)).pipe((0,de.z)(pe=>(At._loadedConfig=pe,this.processRoutes(pe.module,pe.routes)))))}}return dt.\u0275fac=function(q){return new(q||dt)(C.LFG(Lr),C.LFG(C.Sil),C.LFG(C.zs3),C.LFG(Bs))},dt.\u0275prov=C.Yz7({token:dt,factory:dt.\u0275fac}),dt})(),ka=(()=>{class dt{constructor(q,At,Wt={}){this.router=q,this.viewportScroller=At,this.options=Wt,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},Wt.scrollPositionRestoration=Wt.scrollPositionRestoration||"disabled",Wt.anchorScrolling=Wt.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(q=>{q instanceof Di?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=q.navigationTrigger,this.restoredId=q.restoredState?q.restoredState.navigationId:0):q instanceof ei&&(this.lastId=q.id,this.scheduleScrollEvent(q,this.router.parseUrl(q.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(q=>{q instanceof Oe&&(q.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(q.position):q.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(q.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(q,At){this.router.triggerEvent(new Oe(q,"popstate"===this.lastSource?this.store[this.restoredId]:null,At))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return dt.\u0275fac=function(q){C.$Z()},dt.\u0275prov=C.Yz7({token:dt,factory:dt.\u0275fac}),dt})();const ll=new C.OlP("ROUTER_CONFIGURATION"),Ul=new C.OlP("ROUTER_FORROOT_GUARD"),cl=[Ne.Ye,{provide:li,useClass:Je},{provide:Lr,useFactory:function qs(dt,ot,q,At,Wt,pe,Ve={},ti,Li){const wn=new Lr(null,dt,ot,q,At,Wt,Gi(pe));return ti&&(wn.urlHandlingStrategy=ti),Li&&(wn.routeReuseStrategy=Li),function xa(dt,ot){dt.errorHandler&&(ot.errorHandler=dt.errorHandler),dt.malformedUriErrorHandler&&(ot.malformedUriErrorHandler=dt.malformedUriErrorHandler),dt.onSameUrlNavigation&&(ot.onSameUrlNavigation=dt.onSameUrlNavigation),dt.paramsInheritanceStrategy&&(ot.paramsInheritanceStrategy=dt.paramsInheritanceStrategy),dt.relativeLinkResolution&&(ot.relativeLinkResolution=dt.relativeLinkResolution),dt.urlUpdateStrategy&&(ot.urlUpdateStrategy=dt.urlUpdateStrategy),dt.canceledNavigationResolution&&(ot.canceledNavigationResolution=dt.canceledNavigationResolution)}(Ve,wn),Ve.enableTracing&&wn.events.subscribe(Co=>{var Kn,Jo;null===(Kn=console.group)||void 0===Kn||Kn.call(console,`Router Event: ${Co.constructor.name}`),console.log(Co.toString()),console.log(Co),null===(Jo=console.groupEnd)||void 0===Jo||Jo.call(console)}),wn},deps:[li,ar,Ne.Ye,C.zs3,C.Sil,Sn,ll,[class Nn{},new C.FiY],[class Qs{},new C.FiY]]},ar,{provide:Mi,useFactory:function Hs(dt){return dt.routerState.root},deps:[Lr]},Ya,sa,class Zr{preload(ot,q){return q().pipe((0,xt.K)(()=>(0,L.of)(null)))}},{provide:ll,useValue:{enableTracing:!1}}];function fl(){return new C.PXZ("Router",Lr)}let gl=(()=>{class dt{constructor(q,At){}static forRoot(q,At){return{ngModule:dt,providers:[cl,Xa(q),{provide:Ul,useFactory:ql,deps:[[Lr,new C.FiY,new C.tp0]]},{provide:ll,useValue:At||{}},{provide:Ne.S$,useFactory:ga,deps:[Ne.lw,[new C.tBr(Ne.mr),new C.FiY],ll]},{provide:ka,useFactory:Fc,deps:[Lr,Ne.EM,ll]},{provide:Bs,useExisting:At&&At.preloadingStrategy?At.preloadingStrategy:sa},{provide:C.PXZ,multi:!0,useFactory:fl},[Ea,{provide:C.ip1,multi:!0,useFactory:Cl,deps:[Ea]},{provide:sc,useFactory:tc,deps:[Ea]},{provide:C.tb,multi:!0,useExisting:sc}]]}}static forChild(q){return{ngModule:dt,providers:[Xa(q)]}}}return dt.\u0275fac=function(q){return new(q||dt)(C.LFG(Ul,8),C.LFG(Lr,8))},dt.\u0275mod=C.oAB({type:dt}),dt.\u0275inj=C.cJS({}),dt})();function Fc(dt,ot,q){return q.scrollOffset&&ot.setOffset(q.scrollOffset),new ka(dt,ot,q)}function ga(dt,ot,q={}){return q.useHash?new Ne.Do(dt,ot):new Ne.b0(dt,ot)}function ql(dt){return"guarded"}function Xa(dt){return[{provide:C.deG,multi:!0,useValue:dt},{provide:Sn,multi:!0,useValue:dt}]}let Ea=(()=>{class dt{constructor(q){this.injector=q,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new gt.x}appInitializer(){return this.injector.get(Ne.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let At=null;const Wt=new Promise(ti=>At=ti),pe=this.injector.get(Lr),Ve=this.injector.get(ll);return"disabled"===Ve.initialNavigation?(pe.setUpLocationChangeListener(),At(!0)):"enabled"===Ve.initialNavigation||"enabledBlocking"===Ve.initialNavigation?(pe.hooks.afterPreactivation=()=>this.initNavigation?(0,L.of)(null):(this.initNavigation=!0,At(!0),this.resultOfPreactivationDone),pe.initialNavigation()):At(!0),Wt})}bootstrapListener(q){const At=this.injector.get(ll),Wt=this.injector.get(Ya),pe=this.injector.get(ka),Ve=this.injector.get(Lr),ti=this.injector.get(C.z2F);q===ti.components[0]&&(("enabledNonBlocking"===At.initialNavigation||void 0===At.initialNavigation)&&Ve.initialNavigation(),Wt.setUpPreloading(),pe.init(),Ve.resetRootComponentType(ti.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return dt.\u0275fac=function(q){return new(q||dt)(C.LFG(C.zs3))},dt.\u0275prov=C.Yz7({token:dt,factory:dt.\u0275fac}),dt})();function Cl(dt){return dt.appInitializer.bind(dt)}function tc(dt){return dt.bootstrapListener.bind(dt)}const sc=new C.OlP("Router Initializer")},33:(B,X,_)=>{"use strict";_.d(X,{C:()=>se,k:()=>xt});var Mt=_(5e3),yt=_(93075);const ct=["ref"];function rt(Lt){return Lt&&Lt.replace(/\r\n|\r/g,"\n")}let se=(()=>{class Lt{constructor(_e,ce){this._differs=_e,this._ngZone=ce,this.className="",this.name="codemirror",this.autoFocus=!1,this.preserveScrollPosition=!1,this.cursorActivity=new Mt.vpe,this.focusChange=new Mt.vpe,this.scroll=new Mt.vpe,this.drop=new Mt.vpe,this.value="",this.disabled=!1,this.isFocused=!1,this.onChange=Ae=>{},this.onTouched=()=>{}}set options(_e){this._options=_e,!this._differ&&_e&&(this._differ=this._differs.find(_e).create())}get codeMirrorGlobal(){return this._codeMirror||(this._codeMirror="undefined"!=typeof CodeMirror?CodeMirror:Promise.resolve().then(_.t.bind(_,68266,19))),this._codeMirror}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>function a(Lt,de,_e,ce){return new(_e||(_e=Promise))(function(Ne,qe){function Di(ri){try{Me(ce.next(ri))}catch(Bt){qe(Bt)}}function ei(ri){try{Me(ce.throw(ri))}catch(Bt){qe(Bt)}}function Me(ri){ri.done?Ne(ri.value):function Ae(Ne){return Ne instanceof _e?Ne:new _e(function(qe){qe(Ne)})}(ri.value).then(Di,ei)}Me((ce=ce.apply(Lt,de||[])).next())})}(this,void 0,void 0,function*(){const _e=yield this.codeMirrorGlobal;this.codeMirror=((null==_e?void 0:_e.default)?_e.default:_e).fromTextArea(this.ref.nativeElement,this._options),this.codeMirror.on("cursorActivity",Ae=>this._ngZone.run(()=>this.cursorActive(Ae))),this.codeMirror.on("scroll",this.scrollChanged.bind(this)),this.codeMirror.on("blur",()=>this._ngZone.run(()=>this.focusChanged(!1))),this.codeMirror.on("focus",()=>this._ngZone.run(()=>this.focusChanged(!0))),this.codeMirror.on("change",(Ae,Ne)=>this._ngZone.run(()=>this.codemirrorValueChanged(Ae,Ne))),this.codeMirror.on("drop",(Ae,Ne)=>{this._ngZone.run(()=>this.dropFiles(Ae,Ne))}),this.codeMirror.setValue(this.value)}))}ngDoCheck(){if(!this._differ)return;const _e=this._differ.diff(this._options);_e&&(_e.forEachChangedItem(ce=>this.setOptionIfChanged(ce.key,ce.currentValue)),_e.forEachAddedItem(ce=>this.setOptionIfChanged(ce.key,ce.currentValue)),_e.forEachRemovedItem(ce=>this.setOptionIfChanged(ce.key,ce.currentValue)))}ngOnDestroy(){this.codeMirror&&this.codeMirror.toTextArea()}codemirrorValueChanged(_e,ce){const Ae=_e.getValue();this.value!==Ae&&(this.value=Ae,this.onChange(this.value))}setOptionIfChanged(_e,ce){!this.codeMirror||this.codeMirror.setOption(_e,ce)}focusChanged(_e){this.onTouched(),this.isFocused=_e,this.focusChange.emit(_e)}scrollChanged(_e){this.scroll.emit(_e.getScrollInfo())}cursorActive(_e){this.cursorActivity.emit(_e)}dropFiles(_e,ce){this.drop.emit([_e,ce])}writeValue(_e){if(null==_e)return;if(!this.codeMirror)return void(this.value=_e);const ce=this.codeMirror.getValue();if(_e!==ce&&rt(ce)!==rt(_e))if(this.value=_e,this.preserveScrollPosition){const Ae=this.codeMirror.getScrollInfo();this.codeMirror.setValue(this.value),this.codeMirror.scrollTo(Ae.left,Ae.top)}else this.codeMirror.setValue(this.value)}registerOnChange(_e){this.onChange=_e}registerOnTouched(_e){this.onTouched=_e}setDisabledState(_e){this.disabled=_e,this.setOptionIfChanged("readOnly",this.disabled)}}return Lt.\u0275fac=function(_e){return new(_e||Lt)(Mt.Y36(Mt.aQg),Mt.Y36(Mt.R0b))},Lt.\u0275cmp=Mt.Xpm({type:Lt,selectors:[["ngx-codemirror"]],viewQuery:function(_e,ce){if(1&_e&&Mt.Gf(ct,5),2&_e){let Ae;Mt.iGM(Ae=Mt.CRH())&&(ce.ref=Ae.first)}},inputs:{className:"className",name:"name",autoFocus:"autoFocus",options:"options",preserveScrollPosition:"preserveScrollPosition"},outputs:{cursorActivity:"cursorActivity",focusChange:"focusChange",scroll:"scroll",drop:"drop"},features:[Mt._Bn([{provide:yt.JU,useExisting:(0,Mt.Gpc)(()=>Lt),multi:!0}])],decls:3,vars:7,consts:[["autocomplete","off",3,"name","autofocus"],["ref",""]],template:function(_e,ce){1&_e&&(Mt.TgZ(0,"textarea",0,1),Mt._uU(2,"    "),Mt.qZA()),2&_e&&(Mt.Gre("ngx-codemirror ",ce.className,""),Mt.ekj("ngx-codemirror--focused",ce.isFocused),Mt.Q6J("name",ce.name)("autofocus",ce.autoFocus))},encapsulation:2,changeDetection:0}),Lt})(),xt=(()=>{class Lt{}return Lt.\u0275fac=function(_e){return new(_e||Lt)},Lt.\u0275mod=Mt.oAB({type:Lt}),Lt.\u0275inj=Mt.cJS({}),Lt})()},15861:(B,X,_)=>{"use strict";function C(e,t,n,o,r,a,h){try{var R=e[a](h),L=R.value}catch(W){return void n(W)}R.done?t(L):Promise.resolve(L).then(o,r)}function m(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function h(L){C(a,o,r,h,R,"next",L)}function R(L){C(a,o,r,h,R,"throw",L)}h(void 0)})}}_.d(X,{Z:()=>m})}},B=>{B(B.s=91677)}]);